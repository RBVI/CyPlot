(function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,t.Plotly=e()}})(function(){var a=Math.log2,o=String.prototype,r=Math.sign,g=Math.tan,_=Math.asin,v=Math.acos,w=Math.SQRT2,k=Math.atan,L=Math.atan2,E=Math.LN2,z=Math.LN10,P=Math.log,O=String.fromCharCode,R=Math.round,M=Math.sin,te=Math.cos,ae=Math.ceil,re=Math.sqrt,ie=Math.min,ea=Math.floor,_a=Math.pow,va=Math.max,wa=Math.abs,ka=Math.exp,Sa=Math.PI,Ca;return function(){function l(s,e,r){function t(d,i){if(!e[d]){if(!s[d]){var n="function"==typeof require&&require;if(!i&&n)return n(d,!0);if(o)return o(d,!0);var c=new Error("Cannot find module '"+d+"'");throw c.code="MODULE_NOT_FOUND",c}var a=e[d]={exports:{}};s[d][0].call(a.exports,function(e){var a=s[d][1][e];return t(a||e)},a,a.exports,l,s,e,r)}return e[d].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)t(r[a]);return t}return l}()({1:[function(e){"use strict";var t=e("../src/lib"),a={"X,X div":"direction:ltr;font-family:'Open Sans', verdana, arial, sans-serif;margin:0;padding:0;","X input,X button":"font-family:'Open Sans', verdana, arial, sans-serif;","X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;z-index:1001;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity 0.3s ease 0s;-moz-transition:opacity 0.3s ease 0s;-ms-transition:opacity 0.3s ease 0s;-o-transition:opacity 0.3s ease 0s;transition:opacity 0.3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;margin-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;margin-left:0px;margin-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":"content:'';position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;","X [data-title]:after":"content:attr(data-title);background:#69738a;color:white;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:white;","X .select-outline-2":"stroke:black;stroke-dasharray:2px 2px;",Y:"font-family:'Open Sans';position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;","Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,0.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:0.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var o in a){var r=o.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");t.addStyleRule(r,a[o])}},{"../src/lib":692}],2:[function(e,t){"use strict";t.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs><style>.cls-1 {fill: #119dff;} .cls-2 {fill: #25fefd;} .cls-3 {fill: #fff;}</style></defs><title>plotly-logomark</title><g id='symbol'><rect class='cls-1' width='132' height='132' rx='6' ry='6'/><circle class='cls-2' cx='78' cy='54' r='6'/><circle class='cls-2' cx='102' cy='30' r='6'/><circle class='cls-2' cx='78' cy='30' r='6'/><circle class='cls-2' cx='54' cy='30' r='6'/><circle class='cls-2' cx='30' cy='30' r='6'/><circle class='cls-2' cx='30' cy='54' r='6'/><path class='cls-3' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/><path class='cls-3' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/><path class='cls-3' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/><path class='cls-3' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/></g></svg>"}}},{}],3:[function(e,t){"use strict";t.exports=e("../src/transforms/aggregate")},{"../src/transforms/aggregate":1152}],4:[function(e,t){"use strict";t.exports=e("../src/traces/bar")},{"../src/traces/bar":840}],5:[function(e,t){"use strict";t.exports=e("../src/traces/barpolar")},{"../src/traces/barpolar":852}],6:[function(e,t){"use strict";t.exports=e("../src/traces/box")},{"../src/traces/box":862}],7:[function(e,t){"use strict";t.exports=e("../src/components/calendars")},{"../src/components/calendars":567}],8:[function(e,t){"use strict";t.exports=e("../src/traces/candlestick")},{"../src/traces/candlestick":871}],9:[function(e,t){"use strict";t.exports=e("../src/traces/carpet")},{"../src/traces/carpet":890}],10:[function(e,t){"use strict";t.exports=e("../src/traces/choropleth")},{"../src/traces/choropleth":904}],11:[function(e,t){"use strict";t.exports=e("../src/traces/cone")},{"../src/traces/cone":912}],12:[function(e,t){"use strict";t.exports=e("../src/traces/contour")},{"../src/traces/contour":927}],13:[function(e,t){"use strict";t.exports=e("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":938}],14:[function(e,t){"use strict";t.exports=e("../src/core")},{"../src/core":671}],15:[function(e,t){"use strict";t.exports=e("../src/transforms/filter")},{"../src/transforms/filter":1153}],16:[function(e,t){"use strict";t.exports=e("../src/transforms/groupby")},{"../src/transforms/groupby":1154}],17:[function(e,t){"use strict";t.exports=e("../src/traces/heatmap")},{"../src/traces/heatmap":950}],18:[function(e,t){"use strict";t.exports=e("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":959}],19:[function(e,t){"use strict";t.exports=e("../src/traces/histogram")},{"../src/traces/histogram":971}],20:[function(e,t){"use strict";t.exports=e("../src/traces/histogram2d")},{"../src/traces/histogram2d":978}],21:[function(e,t){"use strict";t.exports=e("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":982}],22:[function(e,t){"use strict";var a=e("./core");a.register([e("./bar"),e("./box"),e("./heatmap"),e("./histogram"),e("./histogram2d"),e("./histogram2dcontour"),e("./pie"),e("./contour"),e("./scatterternary"),e("./violin"),e("./scatter3d"),e("./surface"),e("./mesh3d"),e("./cone"),e("./streamtube"),e("./scattergeo"),e("./choropleth"),e("./scattergl"),e("./splom"),e("./pointcloud"),e("./heatmapgl"),e("./parcoords"),e("./parcats"),e("./scattermapbox"),e("./sankey"),e("./table"),e("./carpet"),e("./scattercarpet"),e("./contourcarpet"),e("./ohlc"),e("./candlestick"),e("./scatterpolar"),e("./scatterpolargl"),e("./barpolar")]),a.register([e("./aggregate"),e("./filter"),e("./groupby"),e("./sort")]),a.register([e("./calendars")]),t.exports=a},{"./aggregate":3,"./bar":4,"./barpolar":5,"./box":6,"./calendars":7,"./candlestick":8,"./carpet":9,"./choropleth":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./filter":15,"./groupby":16,"./heatmap":17,"./heatmapgl":18,"./histogram":19,"./histogram2d":20,"./histogram2dcontour":21,"./mesh3d":23,"./ohlc":24,"./parcats":25,"./parcoords":26,"./pie":27,"./pointcloud":28,"./sankey":29,"./scatter3d":30,"./scattercarpet":31,"./scattergeo":32,"./scattergl":33,"./scattermapbox":34,"./scatterpolar":35,"./scatterpolargl":36,"./scatterternary":37,"./sort":38,"./splom":39,"./streamtube":40,"./surface":41,"./table":42,"./violin":43}],23:[function(e,t){"use strict";t.exports=e("../src/traces/mesh3d")},{"../src/traces/mesh3d":987}],24:[function(e,t){"use strict";t.exports=e("../src/traces/ohlc")},{"../src/traces/ohlc":992}],25:[function(e,t){"use strict";t.exports=e("../src/traces/parcats")},{"../src/traces/parcats":1001}],26:[function(e,t){"use strict";t.exports=e("../src/traces/parcoords")},{"../src/traces/parcoords":1010}],27:[function(e,t){"use strict";t.exports=e("../src/traces/pie")},{"../src/traces/pie":1021}],28:[function(e,t){"use strict";t.exports=e("../src/traces/pointcloud")},{"../src/traces/pointcloud":1030}],29:[function(e,t){"use strict";t.exports=e("../src/traces/sankey")},{"../src/traces/sankey":1036}],30:[function(e,t){"use strict";t.exports=e("../src/traces/scatter3d")},{"../src/traces/scatter3d":1072}],31:[function(e,t){"use strict";t.exports=e("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":1078}],32:[function(e,t){"use strict";t.exports=e("../src/traces/scattergeo")},{"../src/traces/scattergeo":1085}],33:[function(e,t){"use strict";t.exports=e("../src/traces/scattergl")},{"../src/traces/scattergl":1093}],34:[function(e,t){"use strict";t.exports=e("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1099}],35:[function(e,t){"use strict";t.exports=e("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1106}],36:[function(e,t){"use strict";t.exports=e("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1110}],37:[function(e,t){"use strict";t.exports=e("../src/traces/scatterternary")},{"../src/traces/scatterternary":1116}],38:[function(e,t){"use strict";t.exports=e("../src/transforms/sort")},{"../src/transforms/sort":1156}],39:[function(e,t){"use strict";t.exports=e("../src/traces/splom")},{"../src/traces/splom":1121}],40:[function(e,t){"use strict";t.exports=e("../src/traces/streamtube")},{"../src/traces/streamtube":1126}],41:[function(e,t){"use strict";t.exports=e("../src/traces/surface")},{"../src/traces/surface":1131}],42:[function(e,t){"use strict";t.exports=e("../src/traces/table")},{"../src/traces/table":1139}],43:[function(e,t){"use strict";t.exports=e("../src/traces/violin")},{"../src/traces/violin":1147}],44:[function(e,t){"use strict";function a(e,t){function a(a,r,i,n){var l=1/e.clientHeight,s=l*(r-f),d=l*(i-b),p=m.flipX?1:-1,g=m.flipY?1:-1,h=Sa*m.rotateSpeed,y=o();if(1&a)n.shift?c.rotate(y,0,0,-s*h):c.rotate(y,p*h*s,-g*h*d,0);else if(2&a)c.pan(y,-m.translateSpeed*s*u,m.translateSpeed*d*u,0);else if(4&a){var t=50*(m.zoomSpeed*d/window.innerHeight*(y-c.lastT()));c.pan(y,0,0,u*(ka(t)-1))}f=r,b=i,_=n}e=e||document.body,t=t||{};var d=[.01,1/0];"distanceLimits"in t&&(d[0]=t.distanceLimits[0],d[1]=t.distanceLimits[1]),"zoomMin"in t&&(d[0]=t.zoomMin),"zoomMax"in t&&(d[1]=t.zoomMax);var c=r({center:t.center||[0,0,0],up:t.up||[0,1,0],eye:t.eye||[0,0,10],mode:t.mode||"orbit",distanceLimits:d}),p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],u=0,g=e.clientWidth,h=e.clientHeight,m={view:c,element:e,delay:t.delay||16,rotateSpeed:t.rotateSpeed||1,zoomSpeed:t.zoomSpeed||1,translateSpeed:t.translateSpeed||1,flipX:!!t.flipX,flipY:!!t.flipY,modes:c.modes,tick:function(){var a=o(),t=this.delay;c.idle(a-t),c.flush(a-(100+2*t));c.recalcMatrix(a-2*t);for(var r=!0,n=c.computedMatrix,l=0;16>l;++l)r=r&&p[l]===n[l],p[l]=n[l];var s=e.clientWidth===g&&e.clientHeight===h;return(g=e.clientWidth,h=e.clientHeight,r)?!s:(u=ka(c.computedRadius[0]),!0)},lookAt:function(e,t,a){c.lookAt(c.lastT(),e,t,a)},rotate:function(e,t,a){c.rotate(c.lastT(),e,t,a)},pan:function(e,t,a){c.pan(c.lastT(),e,t,a)},translate:function(e,t,a){c.translate(c.lastT(),e,t,a)}};Object.defineProperties(m,{matrix:{get:function(){return c.computedMatrix},set:function(e){return c.setMatrix(c.lastT(),e),c.computedMatrix},enumerable:!0},mode:{get:function(){return c.getMode()},set:function(e){return c.setMode(e),c.getMode()},enumerable:!0},center:{get:function(){return c.computedCenter},set:function(e){return c.lookAt(c.lastT(),e),c.computedCenter},enumerable:!0},eye:{get:function(){return c.computedEye},set:function(e){return c.lookAt(c.lastT(),null,e),c.computedEye},enumerable:!0},up:{get:function(){return c.computedUp},set:function(e){return c.lookAt(c.lastT(),null,null,e),c.computedUp},enumerable:!0},distance:{get:function(){return u},set:function(e){return c.setDistance(c.lastT(),e),e},enumerable:!0},distanceLimits:{get:function(){return c.getDistanceLimits(d)},set:function(e){return c.setDistanceLimits(e),e},enumerable:!0}}),e.addEventListener("contextmenu",function(e){return e.preventDefault(),!1});var f=0,b=0,_={shift:!1,control:!1,alt:!1,meta:!1};return i(e,a),e.addEventListener("touchstart",function(t){var o=l(t.changedTouches[0],e);a(0,o[0],o[1],_),a(1,o[0],o[1],_),t.preventDefault()},!!s&&{passive:!1}),e.addEventListener("touchmove",function(t){var o=l(t.changedTouches[0],e);a(1,o[0],o[1],_),t.preventDefault()},!!s&&{passive:!1}),e.addEventListener("touchend",function(t){l(t.changedTouches[0],e);a(0,f,b,_),t.preventDefault()},!!s&&{passive:!1}),n(e,function(e,a){var r=m.flipX?1:-1,i=m.flipY?1:-1,n=o();if(wa(e)>wa(a))c.rotate(n,0,0,-e*r*Sa*m.rotateSpeed/window.innerWidth);else{var t=m.zoomSpeed*i*a/window.innerHeight*(n-c.lastT())/100;c.pan(n,0,0,u*(ka(t)-1))}},!0),m}t.exports=a;var o=e("right-now"),r=e("3d-view"),i=e("mouse-change"),n=e("mouse-wheel"),l=e("mouse-event-offset"),s=e("has-passive-events")},{"3d-view":45,"has-passive-events":394,"mouse-change":418,"mouse-event-offset":419,"mouse-wheel":421,"right-now":480}],45:[function(e,t){"use strict";function a(e,t){this._controllerNames=Object.keys(e),this._controllerList=this._controllerNames.map(function(t){return e[t]}),this._mode=t,this._active=e[t],this._active||(this._mode="turntable",this._active=e.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}t.exports=function(e){e=e||{};var t=e.eye||[0,0,1],n=e.center||[0,0,0],l=e.up||[0,1,0],s=e.distanceLimits||[0,1/0],d=e.mode||"turntable",c=o(),p=r(),u=i();return c.setDistanceLimits(s[0],s[1]),c.lookAt(0,t,n,l),p.setDistanceLimits(s[0],s[1]),p.lookAt(0,t,n,l),u.setDistanceLimits(s[0],s[1]),u.lookAt(0,t,n,l),new a({turntable:c,orbit:p,matrix:u},d)};var o=e("turntable-camera-controller"),r=e("orbit-camera-controller"),i=e("matrix-camera-controller"),n=a.prototype;[["flush",1],["idle",1],["lookAt",4],["rotate",4],["pan",4],["translate",4],["setMatrix",2],["setDistanceLimits",2],["setDistance",2]].forEach(function(e){for(var t=e[0],a=[],o=0;o<e[1];++o)a.push("a"+o);var r="var cc=this._controllerList;for(var i=0;i<cc.length;++i){cc[i]."+e[0]+"("+a.join()+")}";n[t]=Function.apply(null,a.concat(r))}),n.recalcMatrix=function(e){this._active.recalcMatrix(e)},n.getDistance=function(e){return this._active.getDistance(e)},n.getDistanceLimits=function(e){return this._active.getDistanceLimits(e)},n.lastT=function(){return this._active.lastT()},n.setMode=function(e){if(e!==this._mode){var t=this._controllerNames.indexOf(e);if(!(0>t)){var a=this._active,o=this._controllerList[t],r=va(a.lastT(),o.lastT());a.recalcMatrix(r),o.setMatrix(r,a.computedMatrix),this._active=o,this._mode=e,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},n.getMode=function(){return this._mode}},{"matrix-camera-controller":416,"orbit-camera-controller":439,"turntable-camera-controller":518}],46:[function(e,t,a){(function(o,r){"object"==typeof a&&"undefined"!=typeof t?r(a,e("d3-array"),e("d3-collection"),e("d3-interpolate")):"function"==typeof Ca&&Ca.amd?Ca(["exports","d3-array","d3-collection","d3-interpolate"],r):r(o.d3=o.d3||{},o.d3,o.d3,o.d3)})(this,function(e,t,a,o){"use strict";e.sankey=function(){function e(){y.forEach(function(e){e.sourceLinks=[],e.targetLinks=[]}),f.forEach(function(e,t){var a=e.source,o=e.target;"number"==typeof a&&(a=e.source=y[e.source]),"number"==typeof o&&(o=e.target=y[e.target]),e.originalIndex=t,a.sourceLinks.push(e),o.targetLinks.push(e)})}function r(){y.forEach(function(e){e.value=va(t.sum(e.sourceLinks,p),t.sum(e.targetLinks,p))})}function i(){for(var e=y,t=0,a;e.length;)a=[],e.forEach(function(e){e.x=t,e.dx=g,e.sourceLinks.forEach(function(e){0>a.indexOf(e.target)&&a.push(e.target)})}),e=a,++t;n(t),l((m[0]-g)/(t-1))}function n(e){y.forEach(function(t){t.sourceLinks.length||(t.x=e-1)})}function l(e){y.forEach(function(t){t.x*=e})}function s(e){function o(){var e=t.max(s,function(e){return e.length}),a=x*m[1]/(e-1);h>a&&(h=a);var o=t.min(s,function(e){return(m[1]-(e.length-1)*h)/t.sum(e,p)});s.forEach(function(e){e.forEach(function(e,t){e.y=t,e.dy=e.value*o})}),f.forEach(function(e){e.dy=e.value*o})}function r(e){function a(e){return c(e.source)*e.value}s.forEach(function(o){o.forEach(function(o){if(o.targetLinks.length){var r=t.sum(o.targetLinks,a)/t.sum(o.targetLinks,p);o.y+=(r-c(o))*e}})})}function i(e){function a(e){return c(e.target)*e.value}s.slice().reverse().forEach(function(o){o.forEach(function(o){if(o.sourceLinks.length){var r=t.sum(o.sourceLinks,a)/t.sum(o.sourceLinks,p);o.y+=(r-c(o))*e}})})}function n(){s.forEach(function(e){var t=0,a=e.length,o,r,n;for(e.sort(l),n=0;n<a;++n)o=e[n],r=t-o.y,0<r&&(o.y+=r),t=o.y+o.dy+h;if(r=t-h-m[1],0<r)for(t=o.y-=r,n=a-2;0<=n;--n)o=e[n],r=o.y+o.dy+h-t,0<r&&(o.y-=r),t=o.y})}function l(e,t){return e.y-t.y}var s=a.nest().key(function(e){return e.x}).sortKeys(t.ascending).entries(y).map(function(e){return e.values});o(),n();for(var d=1;0<e;--e)i(d*=.99),n(),r(d),n()}function d(){function e(e,t){return e.source.y-t.source.y||e.originalIndex-t.originalIndex}function t(e,t){return e.target.y-t.target.y||e.originalIndex-t.originalIndex}y.forEach(function(a){a.sourceLinks.sort(t),a.targetLinks.sort(e)}),y.forEach(function(e){var t=0,a=0;e.sourceLinks.forEach(function(e){e.sy=t,t+=e.dy}),e.targetLinks.forEach(function(e){e.ty=a,a+=e.dy})})}function c(e){return e.y+e.dy/2}function p(e){return e.value}var u={},g=24,h=8,m=[1,1],y=[],f=[],x=2/3;return u.nodeWidth=function(e){return arguments.length?(g=+e,u):g},u.nodePadding=function(e){return arguments.length?(h=+e,u):h},u.nodes=function(e){return arguments.length?(y=e,u):y},u.links=function(e){return arguments.length?(f=e,u):f},u.size=function(e){return arguments.length?(m=e,u):m},u.layout=function(t){return e(),r(),i(),s(t),d(),u},u.relayout=function(){return d(),u},u.link=function(){function e(e){var a=e.source.x+e.source.dx,r=e.target.x,i=o.interpolateNumber(a,r),n=i(t),l=i(1-t),s=e.source.y+e.sy,d=s+e.dy,c=e.target.y+e.ty,p=c+e.dy;return"M"+a+","+s+"C"+n+","+s+" "+l+","+c+" "+r+","+c+"L"+r+","+p+"C"+l+","+p+" "+n+","+d+" "+a+","+d+"Z"}var t=.5;return e.curvature=function(a){return arguments.length?(t=+a,e):t},e},u},Object.defineProperty(e,"__esModule",{value:!0})})},{"d3-array":140,"d3-collection":141,"d3-interpolate":145}],47:[function(e,t){"use strict";var a="undefined"==typeof WeakMap?e("weak-map"):WeakMap,o=e("gl-buffer"),r=e("gl-vao"),i=new a;t.exports=function(e){var t=i.get(e),a=t&&(t._triangleBuffer.handle||t._triangleBuffer.buffer);if(!a||!e.isBuffer(a)){var n=o(e,new Float32Array([-1,-1,-1,4,4,-1]));t=r(e,[{buffer:n,type:e.FLOAT,size:2}]),t._triangleBuffer=n,i.set(e,t)}t.bind(),e.drawArrays(e.TRIANGLES,0,3),t.unbind()}},{"gl-buffer":230,"gl-vao":310,"weak-map":528}],48:[function(e,t){t.exports=function(e){var t=0,a=0,o=0,r=0;return e.map(function(e){e=e.slice();var n=e[0],l=n.toUpperCase();if(n!=l)switch(e[0]=l,n){case"a":e[6]+=o,e[7]+=r;break;case"v":e[1]+=r;break;case"h":e[1]+=o;break;default:for(var s=1;s<e.length;)e[s++]+=o,e[s++]+=r;}return"Z"===l?(o=t,r=a):"H"===l?o=e[1]:"V"===l?r=e[1]:"M"===l?(o=t=e[1],r=a=e[2]):(o=e[e.length-2],r=e[e.length-1]),e})}},{}],49:[function(e,t){var a=e("pad-left");t.exports=function(e,t,o){t="number"==typeof t?t:1,o=o||": ";var r=e.split(/\r?\n/),n=(r.length+t-1+"").length;return r.map(function(e,r){var i=r+t,l=(i+"").length,s=a(i,n-l);return s+o+e}).join("\n")}},{"pad-left":440}],50:[function(e,t){"use strict";function a(e,t){for(var a=Array(t+1),n=0;n<e.length;++n)a[n]=e[n];for(var n=0;n<=e.length;++n){for(var l=e.length,s;l<=t;++l){s=Array(t);for(var d=0;d<t;++d)s[d]=_a(l+1-n,d);a[l]=s}var c=r.apply(void 0,a);if(c)return!0}return!1}t.exports=function(e){var t=e.length;if(0===t)return[];if(1===t)return[0];for(var o=e[0].length,r=[e[0]],n=[0],l=1;l<t;++l){if(r.push(e[l]),!a(r,o)){r.pop();continue}if(n.push(l),n.length===o+1)return n}return n};var r=e("robust-orientation")},{"robust-orientation":486}],51:[function(e,t){"use strict";t.exports=function(e,t){return a(t).filter(function(a){for(var r=Array(a.length),n=0;n<a.length;++n)r[n]=t[a[n]];return 1>o(r)*e})};var a=e("delaunay-triangulate"),o=e("circumradius")},{circumradius:102,"delaunay-triangulate":150}],52:[function(e,t){t.exports=function(e,t){return o(a(e,t))};var a=e("alpha-complex"),o=e("simplicial-complex-boundary")},{"alpha-complex":51,"simplicial-complex-boundary":493}],53:[function(e,t){"use strict";t.exports=function(e,t){if(!e||null==e.length)throw Error("Argument should be an array");t=null==t?1:ea(t);for(var a=Array(2*t),o=0;o<t;o++){for(var r=-Infinity,n=1/0,s=o,d=e.length;s<d;s+=t)e[s]>r&&(r=e[s]),e[s]<n&&(n=e[s]);a[o]=n,a[t+o]=r}return a}},{}],54:[function(e,t){"use strict";var a=e("array-bounds");t.exports=function(e,t,o){if(!e||null==e.length)throw Error("Argument should be an array");null==t&&(t=1),null==o&&(o=a(e,t));for(var r=0;r<t;r++){var n=o[t+r],s=o[r],d=r,c=e.length;if(n===1/0&&s===-Infinity)for(d=r;d<c;d+=t)e[d]=e[d]===n?1:e[d]===s?0:.5;else if(n===1/0)for(d=r;d<c;d+=t)e[d]=e[d]===n?1:0;else if(s===-Infinity)for(d=r;d<c;d+=t)e[d]=e[d]===s?0:1;else{var l=n-s;for(d=r;d<c;d+=t)e[d]=0==l?.5:(e[d]-s)/l}}return e}},{"array-bounds":53}],55:[function(e,t){t.exports=function(e,t){var o="number"==typeof e,r="number"==typeof t;o&&!r?(t=e,e=0):!o&&!r&&(e=0,t=0),e|=0,t|=0;var n=t-e;if(0>n)throw new Error("array length must be positive");for(var l=Array(n),a=0,s=e;a<n;a++,s++)l[a]=s;return l}},{}],56:[function(e,t){(function(a){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function o(e,t){if(e===t)return 0;for(var a=e.length,o=t.length,r=0,n=ie(a,o);r<n;++r)if(e[r]!==t[r]){a=e[r],o=t[r];break}return a<o?-1:o<a?1:0}function r(e){return a.Buffer&&"function"==typeof a.Buffer.isBuffer?a.Buffer.isBuffer(e):!!(null!=e&&e._isBuffer)}function i(e){return Object.prototype.toString.call(e)}function n(e){return!r(e)&&!("function"!=typeof a.ArrayBuffer)&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(!!(e instanceof DataView)||!!(e.buffer&&e.buffer instanceof ArrayBuffer)))}function l(e){if(_.isFunction(e)){if(k)return e.name;var t=e.toString(),a=t.match(A);return a&&a[1]}}function s(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function d(e){if(k||!_.isFunction(e))return _.inspect(e);var t=l(e),a=t?": "+t:"";return"[Function"+a+"]"}function c(e){return s(d(e.actual),128)+" "+e.operator+" "+s(d(e.expected),128)}function p(e,t,a,o,r){throw new T.AssertionError({message:a,actual:e,expected:t,operator:o,stackStartFunction:r})}function u(e,t){e||p(e,!0,t,"==",T.ok)}function g(e,t,a,l){if(e===t)return!0;if(r(e)&&r(t))return 0===o(e,t);if(_.isDate(e)&&_.isDate(t))return e.getTime()===t.getTime();if(_.isRegExp(e)&&_.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if((null===e||"object"!=typeof e)&&(null===t||"object"!=typeof t))return a?e===t:e==t;if(n(e)&&n(t)&&i(e)===i(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===o(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(r(e)!==r(t))return!1;l=l||{actual:[],expected:[]};var s=l.actual.indexOf(e);return-1!==s&&s===l.expected.indexOf(t)||(l.actual.push(e),l.expected.push(t),m(e,t,a,l))}function h(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function m(e,t,o,r){if(null===e||e===void 0||null===t||t===void 0)return!1;if(_.isPrimitive(e)||_.isPrimitive(t))return e===t;if(o&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var n=h(e),l=h(t);if(n&&!l||!n&&l)return!1;if(n)return e=w.call(e),t=w.call(t),g(e,t,o);var s=S(e),d=S(t),c,p;if(s.length!==d.length)return!1;for(s.sort(),d.sort(),p=s.length-1;0<=p;p--)if(s[p]!==d[p])return!1;for(p=s.length-1;0<=p;p--)if(c=s[p],!g(e[c],t[c],o,r))return!1;return!0}function y(e,t,a){g(e,t,!0)&&p(e,t,a,"notDeepStrictEqual",y)}function f(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(t){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function x(e){var t;try{e()}catch(a){t=a}return t}function b(e,t,a,o){var r;if("function"!=typeof t)throw new TypeError("\"block\" argument must be a function");"string"==typeof a&&(o=a,a=null),r=x(t),o=(a&&a.name?" ("+a.name+").":".")+(o?" "+o:"."),e&&!r&&p(r,a,"Missing expected exception"+o);var i="string"==typeof o,n=!e&&_.isError(r),l=!e&&r&&!a;if((n&&i&&f(r,a)||l)&&p(r,a,"Got unwanted exception"+o),e&&r&&a&&!f(r,a)||!e&&r)throw r}var _=e("util/"),v=Object.prototype.hasOwnProperty,w=Array.prototype.slice,k=function(){return"foo"===function(){}.name}(),T=t.exports=u,A=/\s*function\s+([^\(\s]*)\s*/;T.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=c(this),this.generatedMessage=!0);var t=e.stackStartFunction||p;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var a=new Error;if(a.stack){var o=a.stack,r=l(t),i=o.indexOf("\n"+r);if(0<=i){var n=o.indexOf("\n",i+1);o=o.substring(n+1)}this.stack=o}}},_.inherits(T.AssertionError,Error),T.fail=p,T.ok=u,T.equal=function(e,t,a){e!=t&&p(e,t,a,"==",T.equal)},T.notEqual=function(e,t,a){e==t&&p(e,t,a,"!=",T.notEqual)},T.deepEqual=function(e,t,a){g(e,t,!1)||p(e,t,a,"deepEqual",T.deepEqual)},T.deepStrictEqual=function(e,t,a){g(e,t,!0)||p(e,t,a,"deepStrictEqual",T.deepStrictEqual)},T.notDeepEqual=function(e,t,a){g(e,t,!1)&&p(e,t,a,"notDeepEqual",T.notDeepEqual)},T.notDeepStrictEqual=y,T.strictEqual=function(e,t,a){e!==t&&p(e,t,a,"===",T.strictEqual)},T.notStrictEqual=function(e,t,a){e===t&&p(e,t,a,"!==",T.notStrictEqual)},T.throws=function(e,t,a){b(!0,e,t,a)},T.doesNotThrow=function(e,t,a){b(!1,e,t,a)},T.ifError=function(e){if(e)throw e};var S=Object.keys||function(e){var t=[];for(var a in e)v.call(e,a)&&t.push(a);return t}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"util/":59}],57:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var a=function(){};a.prototype=t.prototype,e.prototype=new a,e.prototype.constructor=e}},{}],58:[function(e,t){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],59:[function(e,t,a){(function(t,o){function r(e,t){var o={seen:[],stylize:n};return 3<=arguments.length&&(o.depth=arguments[2]),4<=arguments.length&&(o.colors=arguments[3]),m(t)?o.showHidden=t:t&&a._extend(o,t),_(o.showHidden)&&(o.showHidden=!1),_(o.depth)&&(o.depth=2),_(o.colors)&&(o.colors=!1),_(o.customInspect)&&(o.customInspect=!0),o.colors&&(o.stylize=i),s(o,e,o.depth)}function i(e,t){var a=r.styles[t];return a?"\x1B["+r.colors[a][0]+"m"+e+"\x1B["+r.colors[a][1]+"m":e}function n(e){return e}function l(e){var t={};return e.forEach(function(e){t[e]=!0}),t}function s(e,t,o){if(e.customInspect&&t&&A(t.inspect)&&t.inspect!==a.inspect&&!(t.constructor&&t.constructor.prototype===t)){var r=t.inspect(o,e);return b(r)||(r=s(e,r,o)),r}var i=d(e,t);if(i)return i;var m=Object.keys(t),y=l(m);if(e.showHidden&&(m=Object.getOwnPropertyNames(t)),T(t)&&(0<=m.indexOf("message")||0<=m.indexOf("description")))return c(t);if(0===m.length){if(A(t)){var f=t.name?": "+t.name:"";return e.stylize("[Function"+f+"]","special")}if(v(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(k(t))return e.stylize(Date.prototype.toString.call(t),"date");if(T(t))return c(t)}var x="",_=!1,w=["{","}"];if(h(t)&&(_=!0,w=["[","]"]),A(t)){var S=t.name?": "+t.name:"";x=" [Function"+S+"]"}if(v(t)&&(x=" "+RegExp.prototype.toString.call(t)),k(t)&&(x=" "+Date.prototype.toUTCString.call(t)),T(t)&&(x=" "+c(t)),0===m.length&&(!_||0==t.length))return w[0]+x+w[1];if(0>o)return v(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var n;return n=_?p(e,t,o,y,m):m.map(function(a){return u(e,t,o,y,a,_)}),e.seen.pop(),g(n,x,w)}function d(e,t){if(_(t))return e.stylize("undefined","undefined");if(b(t)){var a="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,"\"")+"'";return e.stylize(a,"string")}return f(t)?e.stylize(""+t,"number"):m(t)?e.stylize(""+t,"boolean"):y(t)?e.stylize("null","null"):void 0}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,a,o,r){for(var n=[],s=0,d=t.length;s<d;++s)E(t,s+"")?n.push(u(e,t,a,o,s+"",!0)):n.push("");return r.forEach(function(r){r.match(/^\d+$/)||n.push(u(e,t,a,o,r,!0))}),n}function u(e,t,a,o,r,i){var n,l,d;if(d=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]},d.get?d.set?l=e.stylize("[Getter/Setter]","special"):l=e.stylize("[Getter]","special"):d.set&&(l=e.stylize("[Setter]","special")),E(o,r)||(n="["+r+"]"),l||(0>e.seen.indexOf(d.value)?(l=y(a)?s(e,d.value,null):s(e,d.value,a-1),-1<l.indexOf("\n")&&(i?l=l.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):l="\n"+l.split("\n").map(function(e){return"   "+e}).join("\n"))):l=e.stylize("[Circular]","special")),_(n)){if(i&&r.match(/^\d+$/))return l;n=JSON.stringify(""+r),n.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=e.stylize(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,"\"").replace(/(^"|"$)/g,"'"),n=e.stylize(n,"string"))}return n+": "+l}function g(e,t,a){var o=0,r=e.reduce(function(e,t){return o++,0<=t.indexOf("\n")&&o++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return 60<r?a[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+a[1]:a[0]+t+" "+e.join(", ")+" "+a[1]}function h(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function y(e){return null===e}function f(e){return"number"==typeof e}function b(e){return"string"==typeof e}function _(e){return void 0===e}function v(e){return w(e)&&"[object RegExp]"===S(e)}function w(e){return"object"==typeof e&&null!==e}function k(e){return w(e)&&"[object Date]"===S(e)}function T(t){return w(t)&&("[object Error]"===S(t)||t instanceof Error)}function A(e){return"function"==typeof e}function S(e){return Object.prototype.toString.call(e)}function C(e){return 10>e?"0"+e.toString(10):e.toString(10)}function L(){var e=new Date,t=[C(e.getHours()),C(e.getMinutes()),C(e.getSeconds())].join(":");return[e.getDate(),P[e.getMonth()],t].join(" ")}function E(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var z=/%[sdj%]/g;a.format=function(e){if(!b(e)){for(var t=[],a=0;a<arguments.length;a++)t.push(r(arguments[a]));return t.join(" ")}for(var a=1,o=arguments,n=o.length,l=(e+"").replace(z,function(e){if("%%"===e)return"%";if(a>=n)return e;switch(e){case"%s":return o[a++]+"";case"%d":return+o[a++];case"%j":try{return JSON.stringify(o[a++])}catch(e){return"[Circular]"}default:return e;}}),s=o[a];a<n;s=o[++a])l+=y(s)||!w(s)?" "+s:" "+r(s);return l},a.deprecate=function(e,r){function i(){if(!n){if(t.throwDeprecation)throw new Error(r);else t.traceDeprecation?console.trace(r):console.error(r);n=!0}return e.apply(this,arguments)}if(_(o.process))return function(){return a.deprecate(e,r).apply(this,arguments)};if(!0===t.noDeprecation)return e;var n=!1;return i};var I={},D;a.debuglog=function(e){if(_(D)&&(D=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!I[e])if(new RegExp("\\b"+e+"\\b","i").test(D)){var o=t.pid;I[e]=function(){var t=a.format.apply(a,arguments);console.error("%s %d: %s",e,o,t)}}else I[e]=function(){};return I[e]},a.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},a.isArray=h,a.isBoolean=m,a.isNull=y,a.isNullOrUndefined=function(e){return null==e},a.isNumber=f,a.isString=b,a.isSymbol=function(e){return"symbol"==typeof e},a.isUndefined=_,a.isRegExp=v,a.isObject=w,a.isDate=k,a.isError=T,a.isFunction=A,a.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e},a.isBuffer=e("./support/isBuffer");var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];a.log=function(){console.log("%s - %s",L(),a.format.apply(a,arguments))},a.inherits=e("inherits"),a._extend=function(e,t){if(!t||!w(t))return e;for(var a=Object.keys(t),o=a.length;o--;)e[a[o]]=t[a[o]];return e}}).call(this,e("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./support/isBuffer":58,_process:465,inherits:57}],60:[function(e,t){t.exports=function(e){return atob(e)}},{}],61:[function(e,t){"use strict";function a(e){for(var t=0,a=0;a<e.length;++a)t+=e[a];return t}t.exports=function(e,t){for(var r=t.length,n=Array(r+1),l=0,s;l<r;++l){s=Array(r+1);for(var d=0;d<=r;++d)s[d]=e[d][l];n[l]=s}n[r]=Array(r+1);for(var l=0;l<=r;++l)n[r][l]=1;for(var c=Array(r+1),l=0;l<r;++l)c[l]=t[l];c[r]=1;var p=o(n,c),u=a(p[r+1]);0===u&&(u=1);for(var g=Array(r+1),l=0;l<=r;++l)g[l]=a(p[l])/u;return g};var o=e("robust-linear-solve")},{"robust-linear-solve":485}],62:[function(e,t,a){"use strict";function o(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");var a=e.indexOf("=");-1===a&&(a=t);var o=a===t?0:4-a%4;return[a,o]}function r(e,t,a){return 3*(t+a)/4-a}function n(e){for(var t=o(e),a=t[0],n=t[1],l=new u(r(e,a,n)),s=0,d=0<n?a-4:a,c=0,g;c<d;c+=4)g=p[e.charCodeAt(c)]<<18|p[e.charCodeAt(c+1)]<<12|p[e.charCodeAt(c+2)]<<6|p[e.charCodeAt(c+3)],l[s++]=255&g>>16,l[s++]=255&g>>8,l[s++]=255&g;return 2===n&&(g=p[e.charCodeAt(c)]<<2|p[e.charCodeAt(c+1)]>>4,l[s++]=255&g),1===n&&(g=p[e.charCodeAt(c)]<<10|p[e.charCodeAt(c+1)]<<4|p[e.charCodeAt(c+2)]>>2,l[s++]=255&g>>8,l[s++]=255&g),l}function l(e){return c[63&e>>18]+c[63&e>>12]+c[63&e>>6]+c[63&e]}function s(e,t,a){for(var o=[],r=t,n;r<a;r+=3)n=(16711680&e[r]<<16)+(65280&e[r+1]<<8)+(255&e[r+2]),o.push(l(n));return o.join("")}function d(e){for(var t=e.length,a=t%3,o=[],r=16383,n=0,l=t-a,d;n<l;n+=r)o.push(s(e,n,n+r>l?l:n+r));return 1===a?(d=e[t-1],o.push(c[d>>2]+c[63&d<<4]+"==")):2===a&&(d=(e[t-2]<<8)+e[t-1],o.push(c[d>>10]+c[63&d>>4]+c[63&d<<2]+"=")),o.join("")}a.byteLength=function(e){var t=o(e),a=t[0],r=t[1];return 3*(a+r)/4-r},a.toByteArray=n,a.fromByteArray=d;for(var c=[],p=[],u="undefined"==typeof Uint8Array?Array:Uint8Array,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,m=g.length;h<m;++h)c[h]=g[h],p[g.charCodeAt(h)]=h;p[45]=62,p[95]=63},{}],63:[function(e,t){"use strict";var o=e("./lib/rationalize");t.exports=function(e,t){return o(e[0].mul(t[1]).add(t[0].mul(e[1])),e[1].mul(t[1]))}},{"./lib/rationalize":73}],64:[function(e,t){"use strict";t.exports=function(e,t){return e[0].mul(t[1]).cmp(t[0].mul(e[1]))}},{}],65:[function(e,t){"use strict";var o=e("./lib/rationalize");t.exports=function(e,t){return o(e[0].mul(t[1]),e[1].mul(t[0]))}},{"./lib/rationalize":73}],66:[function(e,t){"use strict";function o(e,t){if(r(e))return t?d(e,o(t)):[e[0].clone(),e[1].clone()];var c=0,p,u;if(i(e))p=e.clone();else if("string"==typeof e)p=l(e);else{if(0===e)return[n(0),n(1)];if(e===ea(e))p=n(e);else{for(;e!==ea(e);)e*=_a(2,256),c-=256;p=n(e)}}if(r(t))p.mul(t[1]),u=t[0].clone();else if(i(t))u=t.clone();else if("string"==typeof t)u=l(t);else if(!t)u=n(1);else if(t===ea(t))u=n(t);else{for(;t!==ea(t);)t*=_a(2,256),c+=256;u=n(t)}return 0<c?p=p.ushln(c):0>c&&(u=u.ushln(-c)),s(p,u)}var r=e("./is-rat"),i=e("./lib/is-bn"),n=e("./lib/num-to-bn"),l=e("./lib/str-to-bn"),s=e("./lib/rationalize"),d=e("./div");t.exports=o},{"./div":65,"./is-rat":67,"./lib/is-bn":71,"./lib/num-to-bn":72,"./lib/rationalize":73,"./lib/str-to-bn":74}],67:[function(e,t){"use strict";var a=e("./lib/is-bn");t.exports=function(e){return Array.isArray(e)&&2===e.length&&a(e[0])&&a(e[1])}},{"./lib/is-bn":71}],68:[function(e,t){"use strict";var a=e("bn.js");t.exports=function(e){return e.cmp(new a(0))}},{"bn.js":82}],69:[function(e,t){"use strict";var a=e("./bn-sign");t.exports=function(e){var t=e.length,o=e.words,r=0;if(1===t)r=o[0];else if(2===t)r=o[0]+67108864*o[1];else for(var n=0,l;n<t;n++)l=o[n],r+=l*_a(67108864,n);return a(e)*r}},{"./bn-sign":68}],70:[function(e,t){"use strict";var a=e("double-bits"),o=e("bit-twiddle").countTrailingZeros;t.exports=function(e){var t=o(a.lo(e));if(32>t)return t;var r=o(a.hi(e));return 20<r?52:r+32}},{"bit-twiddle":80,"double-bits":152}],71:[function(e,t){"use strict";e("bn.js");t.exports=function(e){return e&&"object"==typeof e&&!!e.words}},{"bn.js":82}],72:[function(e,t){"use strict";var a=e("bn.js"),o=e("double-bits");t.exports=function(t){var r=o.exponent(t);return 52>r?new a(t):new a(t*_a(2,52-r)).ushln(r-52)}},{"bn.js":82,"double-bits":152}],73:[function(e,t){"use strict";var a=e("./num-to-bn"),o=e("./bn-sign");t.exports=function(e,t){var r=o(e),i=o(t);if(0===r)return[a(0),a(1)];if(0===i)return[a(0),a(0)];0>i&&(e=e.neg(),t=t.neg());var n=e.gcd(t);return n.cmpn(1)?[e.div(n),t.div(n)]:[e,t]}},{"./bn-sign":68,"./num-to-bn":72}],74:[function(e,t){"use strict";var a=e("bn.js");t.exports=function(e){return new a(e)}},{"bn.js":82}],75:[function(e,t){"use strict";var o=e("./lib/rationalize");t.exports=function(e,t){return o(e[0].mul(t[0]),e[1].mul(t[1]))}},{"./lib/rationalize":73}],76:[function(e,t){"use strict";var a=e("./lib/bn-sign");t.exports=function(e){return a(e[0])*a(e[1])}},{"./lib/bn-sign":68}],77:[function(e,t){"use strict";var o=e("./lib/rationalize");t.exports=function(e,t){return o(e[0].mul(t[1]).sub(e[1].mul(t[0])),e[1].mul(t[1]))}},{"./lib/rationalize":73}],78:[function(e,t){"use strict";var o=e("./lib/bn-to-num"),r=e("./lib/ctz");t.exports=function(e){var t=e[0],a=e[1];if(0===t.cmpn(0))return 0;var i=t.abs().divmod(a.abs()),n=i.div,l=o(n),d=i.mod,c=t.negative===a.negative?1:-1;if(0===d.cmpn(0))return c*l;if(l){var p=r(l)+4,s=o(d.ushln(p).divRound(a));return c*(l+s*_a(2,-p))}var u=a.bitLength()-d.bitLength()+53,s=o(d.ushln(u).divRound(a));return 1023>u?c*s*_a(2,-u):(s*=_a(2,-1023),c*s*_a(2,1023-u))}},{"./lib/bn-to-num":69,"./lib/ctz":70}],79:[function(e,t){"use strict";function a(e,t,a,o,r,i){var n=["function ",e,"(a,l,h,",o.join(","),"){",i?"":"var i=",a?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",r?".get(m)":"[m]"];return i?0>t.indexOf("c")?n.push(";if(x===y){return m}else if(x<=y){"):n.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):n.push(";if(",t,"){i=m;"),a?n.push("l=m+1}else{h=m-1}"):n.push("h=m-1}else{l=m+1}"),n.push("}"),i?n.push("return -1};"):n.push("return i};"),n.join("")}function o(e,t,o,r){var i=new Function([a("A","x"+e+"y",t,["y"],!1,r),a("B","x"+e+"y",t,["y"],!0,r),a("P","c(x,y)"+e+"0",t,["y","c"],!1,r),a("Q","c(x,y)"+e+"0",t,["y","c"],!0,r),"function dispatchBsearch",o,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",o].join(""));return i()}t.exports={ge:o(">=",!1,"GE"),gt:o(">",!1,"GT"),lt:o("<",!0,"LT"),le:o("<=",!0,"LE"),eq:o("-",!0,"EQ",!0)}},{}],80:[function(e,t,a){"use strict";"use restrict";function o(e){var t=32;return e&=-e,e&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}a.INT_BITS=32,a.INT_MAX=2147483647,a.INT_MIN=-2147483648,a.sign=function(e){return(0<e)-(0>e)},a.abs=function(e){var t=e>>31;return(e^t)-t},a.min=function(e,t){return t^(e^t)&-(e<t)},a.max=function(e,t){return e^(e^t)&-(e<t)},a.isPow2=function(e){return!(e&e-1)&&!!e},a.log2=function(e){var t,a;return t=(65535<e)<<4,e>>>=t,a=(255<e)<<3,e>>>=a,t|=a,a=(15<e)<<2,e>>>=a,t|=a,a=(3<e)<<1,e>>>=a,t|=a,t|e>>1},a.log10=function(e){return 1e9<=e?9:1e8<=e?8:1e7<=e?7:1e6<=e?6:1e5<=e?5:1e4<=e?4:1e3<=e?3:100<=e?2:10<=e?1:0},a.popCount=function(e){return e-=1431655765&e>>>1,e=(858993459&e)+(858993459&e>>>2),16843009*(252645135&e+(e>>>4))>>>24},a.countTrailingZeros=o,a.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+1},a.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e-(e>>>1)},a.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,e&=15,1&27030>>>e};var r=Array(256);(function(e){for(var t=0;256>t;++t){var a=t,o=t,n=7;for(a>>>=1;a;a>>>=1)o<<=1,o|=1&a,--n;e[t]=255&o<<n}})(r),a.reverse=function(e){return r[255&e]<<24|r[255&e>>>8]<<16|r[255&e>>>16]<<8|r[255&e>>>24]},a.interleave2=function(e,t){return e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},a.deinterleave2=function(e,t){return e=1431655765&e>>>t,e=858993459&(e|e>>>1),e=252645135&(e|e>>>2),e=16711935&(e|e>>>4),e=65535&(e|e>>>16),e<<16>>16},a.interleave3=function(e,t,a){return e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e|=t<<1,a&=1023,a=4278190335&(a|a<<16),a=251719695&(a|a<<8),a=3272356035&(a|a<<4),a=1227133513&(a|a<<2),e|a<<2},a.deinterleave3=function(e,t){return e=1227133513&e>>>t,e=3272356035&(e|e>>>2),e=251719695&(e|e>>>4),e=4278190335&(e|e>>>8),e=1023&(e|e>>>16),e<<22>>22},a.nextCombination=function(e){var a=e|e-1;return a+1|(~a&-~a)-1>>>o(e)+1}},{}],81:[function(e,t){"use strict";function o(e,t,a,o,i,n,l){for(var s=0;s<t;s++){for(var d=0;d<a;d++)o[d]=e[d*t+s];for(r(o,i,n,l,a),d=0;d<a;d++)e[d*t+s]=i[d]}for(d=0;d<a;d++){for(s=0;s<t;s++)o[s]=e[d*t+s];for(r(o,i,n,l,t),s=0;s<t;s++)e[d*t+s]=re(i[s])}}function r(e,t,a,o,r){a[0]=0,o[0]=-100000000000000000000,o[1]=100000000000000000000;for(var i=1,n=0,l;i<r;i++){for(l=(e[i]+i*i-(e[a[n]]+a[n]*a[n]))/(2*i-2*a[n]);l<=o[n];)n--,l=(e[i]+i*i-(e[a[n]]+a[n]*a[n]))/(2*i-2*a[n]);n++,a[n]=i,o[n]=l,o[n+1]=100000000000000000000}for(i=0,n=0;i<r;i++){for(;o[n+1]<i;)n++;t[i]=(i-a[n])*(i-a[n])+e[a[n]]}}var n=e("clamp");t.exports=function(e,t){t||(t={});var r=null==t.cutoff?.25:t.cutoff,s=null==t.radius?8:t.radius,c=t.channel||0,p,u,g,m,y,x,b,_,k,T,A;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!t.width||!t.height)throw Error("For raw data width and height should be provided by options");p=t.width,u=t.height,m=e,x=t.stride?t.stride:ea(e.length/p/u)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(_=e,b=_.getContext("2d"),p=_.width,u=_.height,k=b.getImageData(0,0,p,u),m=k.data,x=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(_=e.canvas,b=e,p=_.width,u=_.height,k=b.getImageData(0,0,p,u),m=k.data,x=4):window.ImageData&&e instanceof window.ImageData&&(k=e,p=e.width,u=e.height,m=k.data,x=4);if(g=va(p,u),window.Uint8ClampedArray&&m instanceof window.Uint8ClampedArray||window.Uint8Array&&m instanceof window.Uint8Array)for(y=m,m=Array(p*u),(T=0,A=y.length);T<A;T++)m[T]=y[T*x+c]/255;else if(1!==x)throw Error("Raw data can have only 1 value per pixel");var S=Array(p*u),C=Array(p*u),L=Array(g),f=Array(g),d=Array(g+1),E=Array(g);for(T=0,A=p*u;T<A;T++){var v=m[T];S[T]=1===v?0:0===v?100000000000000000000:_a(va(0,.5-v),2),C[T]=1===v?100000000000000000000:0===v?0:_a(va(0,v-.5),2)}o(S,p,u,L,f,E,d),o(C,p,u,L,f,E,d);var a=window.Float32Array?new Float32Array(p*u):Array(p*u);for(T=0,A=p*u;T<A;T++)a[T]=n(1-((S[T]-C[T])/s+r),0,1);return a}},{clamp:103}],82:[function(e,t){(function(t,a){"use strict";var v=Math.imul,k=Math.clz32;function o(e,t){if(!e)throw new Error(t||"Assertion failed")}function r(e,t){e.super_=t;var a=function(){};a.prototype=t.prototype,e.prototype=new a,e.prototype.constructor=e}function n(e,t,a){return n.isBN(e)?e:void(this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&(("le"===t||"be"===t)&&(a=t,t=10),this._init(e||0,t||10,a||"be")))}function l(e,t,a){for(var o=0,n=ie(e.length,a),l=t,s;l<n;l++)s=e.charCodeAt(l)-48,o<<=4,o|=49<=s&&54>=s?s-49+10:17<=s&&22>=s?s-17+10:15&s;return o}function s(e,t,a,o){for(var n=0,l=ie(e.length,a),s=t,d;s<l;s++)d=e.charCodeAt(s)-48,n*=o,n+=49<=d?d-49+10:17<=d?d-17+10:d;return n}function d(e){for(var t=Array(e.bitLength()),a=0;a<t.length;a++){var o=0|a/26,r=a%26;t[a]=(e.words[o]&1<<r)>>>r}return t}function c(e,t,o){o.negative=t.negative^e.negative;var n=0|e.length+t.length;o.length=n,n=0|n-1;var l=0|e.words[0],s=0|t.words[0],d=l*s,c=67108863&d,p=0|d/67108864;o.words[0]=c;for(var u=1;u<n;u++){for(var g=p>>>26,h=67108863&p,m=ie(u,t.length-1),y=va(0,u-e.length+1),f;y<=m;y++)f=0|u-y,l=0|e.words[f],s=0|t.words[y],d=l*s+h,g+=0|d/67108864,h=67108863&d;o.words[u]=0|h,p=0|g}return 0===p?o.length--:o.words[u]=0|p,o.strip()}function p(e,t,o){o.negative=t.negative^e.negative,o.length=e.length+t.length;for(var n=0,l=0,s=0,d;s<o.length-1;s++){d=l,l=0;for(var c=67108863&n,p=ie(s,t.length-1),u=va(0,s-e.length+1);u<=p;u++){var g=s-u,i=0|e.words[g],a=0|t.words[u],h=i*a,r=67108863&h;d=0|d+(0|h/67108864),r=0|r+c,c=67108863&r,d=0|d+(r>>>26),l+=d>>>26,d&=67108863}o.words[s]=c,n=d,d=l}return 0===n?o.length--:o.words[s]=n,o.strip()}function u(e,t,a){var o=new g;return o.mulp(e,t,a)}function g(e,t){this.x=e,this.y=t}function h(e,t){this.name=e,this.p=new n(t,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function m(){h.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function y(){h.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function f(){h.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function x(){h.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function b(e){if("string"==typeof e){var t=n._prime(e);this.m=t.p,this.prime=t}else o(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function _(e){b.call(this,e),this.shift=this.m.bitLength(),0!=this.shift%26&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}"object"==typeof t?t.exports=n:a.BN=n,n.BN=n,n.wordSize=26;var T;try{T=e("buffer").Buffer}catch(t){}n.isBN=function(e){return!!(e instanceof n)||null!==e&&"object"==typeof e&&e.constructor.wordSize===n.wordSize&&Array.isArray(e.words)},n.max=function(e,t){return 0<e.cmp(t)?e:t},n.min=function(e,t){return 0>e.cmp(t)?e:t},n.prototype._init=function(e,t,a){if("number"==typeof e)return this._initNumber(e,t,a);if("object"==typeof e)return this._initArray(e,t,a);"hex"===t&&(t=16),o(t===(0|t)&&2<=t&&36>=t),e=e.toString().replace(/\s+/g,"");var r=0;"-"===e[0]&&r++,16===t?this._parseHex(e,r):this._parseBase(e,t,r),"-"===e[0]&&(this.negative=1),this.strip();"le"!==a||this._initArray(this.toArray(),t,a)},n.prototype._initNumber=function(e,t,a){0>e&&(this.negative=1,e=-e),67108864>e?(this.words=[67108863&e],this.length=1):4503599627370496>e?(this.words=[67108863&e,67108863&e/67108864],this.length=2):(o(9007199254740992>e),this.words=[67108863&e,67108863&e/67108864,1],this.length=3);"le"!==a||this._initArray(this.toArray(),t,a)},n.prototype._initArray=function(e,t,a){if(o("number"==typeof e.length),0>=e.length)return this.words=[0],this.length=1,this;this.length=ae(e.length/3),this.words=Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var n=0,l,s;if("be"===a)for(r=e.length-1,l=0;0<=r;r-=3)s=e[r]|e[r-1]<<8|e[r-2]<<16,this.words[l]|=67108863&s<<n,this.words[l+1]=67108863&s>>>26-n,n+=24,26<=n&&(n-=26,l++);else if("le"===a)for(r=0,l=0;r<e.length;r+=3)s=e[r]|e[r+1]<<8|e[r+2]<<16,this.words[l]|=67108863&s<<n,this.words[l+1]=67108863&s>>>26-n,n+=24,26<=n&&(n-=26,l++);return this.strip()},n.prototype._parseHex=function(e,t){this.length=ae((e.length-t)/6),this.words=Array(this.length);for(var a=0;a<this.length;a++)this.words[a]=0;var o=0,r,n;for(a=e.length-6,r=0;a>=t;a-=6)n=l(e,a,a+6),this.words[r]|=67108863&n<<o,this.words[r+1]|=4194303&n>>>26-o,o+=24,26<=o&&(o-=26,r++);a+6!==t&&(n=l(e,t,a+6),this.words[r]|=67108863&n<<o,this.words[r+1]|=4194303&n>>>26-o),this.strip()},n.prototype._parseBase=function(e,t,a){this.words=[0],this.length=1;for(var o=0,r=1;67108863>=r;r*=t)o++;o--,r=0|r/t;for(var n=e.length-a,l=n%o,d=ie(n,n-l)+a,c=0,p=a;p<d;p+=o)c=s(e,p,p+o,t),this.imuln(r),67108864>this.words[0]+c?this.words[0]+=c:this._iaddn(c);if(0!==l){var u=1;for(c=s(e,p,e.length,t),p=0;p<l;p++)u*=t;this.imuln(u),67108864>this.words[0]+c?this.words[0]+=c:this._iaddn(c)}},n.prototype.copy=function(e){e.words=Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},n.prototype.clone=function(){var e=new n(null);return this.copy(e),e},n.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;1<this.length&&0===this.words[this.length-1];)this.length--;return this._normSign()},n.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var A=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],S=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],C=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(e,t){e=e||10,t=0|t||1;var a;if(16===e||"hex"===e){a="";for(var n=0,l=0,s=0;s<this.length;s++){var d=this.words[s],p=(16777215&(d<<n|l)).toString(16);l=16777215&d>>>24-n,a=0!==l||s!=this.length-1?A[6-p.length]+p+a:p+a,n+=2,26<=n&&(n-=26,s--)}for(0!==l&&(a=l.toString(16)+a);0!=a.length%t;)a="0"+a;return 0!==this.negative&&(a="-"+a),a}if(e===(0|e)&&2<=e&&36>=e){var u=S[e],g=C[e];a="";var h=this.clone();for(h.negative=0;!h.isZero();){var m=h.modn(g).toString(e);h=h.idivn(g),a=h.isZero()?m+a:A[u-m.length]+m+a}for(this.isZero()&&(a="0"+a);0!=a.length%t;)a="0"+a;return 0!==this.negative&&(a="-"+a),a}o(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:2<this.length&&o(!1,"Number can only safely store up to 53 bits"),0===this.negative?e:-e},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(e,t){return o("undefined"!=typeof T),this.toArrayLike(T,e,t)},n.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},n.prototype.toArrayLike=function(e,t,a){var r=this.byteLength(),n=a||va(1,r);o(r<=n,"byte array longer than desired length"),o(0<n,"Requested array length <= 0"),this.strip();var l=new e(n),s=this.clone(),d,c;if(!("le"===t)){for(c=0;c<n-r;c++)l[c]=0;for(c=0;!s.isZero();c++)d=s.andln(255),s.iushrn(8),l[n-c-1]=d}else{for(c=0;!s.isZero();c++)d=s.andln(255),s.iushrn(8),l[c]=d;for(;c<n;c++)l[c]=0}return l},n.prototype._countBits=k?function(e){return 32-k(e)}:function(e){var a=e,o=0;return 4096<=a&&(o+=13,a>>>=13),64<=a&&(o+=7,a>>>=7),8<=a&&(o+=4,a>>>=4),2<=a&&(o+=2,a>>>=2),o+a},n.prototype._zeroBits=function(e){if(0===e)return 26;var a=e,o=0;return 0==(8191&a)&&(o+=13,a>>>=13),0==(127&a)&&(o+=7,a>>>=7),0==(15&a)&&(o+=4,a>>>=4),0==(3&a)&&(o+=2,a>>>=2),0==(1&a)&&o++,o},n.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0,a;t<this.length&&(a=this._zeroBits(this.words[t]),e+=a,26===a);t++);return e},n.prototype.byteLength=function(){return ae(this.bitLength()/8)},n.prototype.toTwos=function(e){return 0===this.negative?this.clone():this.abs().inotn(e).iaddn(1)},n.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return 0!==this.negative},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]|=e.words[t];return this.strip()},n.prototype.ior=function(e){return o(0==(this.negative|e.negative)),this.iuor(e)},n.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},n.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},n.prototype.iuand=function(e){var t=this.length>e.length?e:this;for(var a=0;a<t.length;a++)this.words[a]&=e.words[a];return this.length=t.length,this.strip()},n.prototype.iand=function(e){return o(0==(this.negative|e.negative)),this.iuand(e)},n.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},n.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},n.prototype.iuxor=function(e){var t,o;this.length>e.length?(t=this,o=e):(t=e,o=this);for(var r=0;r<o.length;r++)this.words[r]=t.words[r]^o.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this.strip()},n.prototype.ixor=function(e){return o(0==(this.negative|e.negative)),this.iuxor(e)},n.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},n.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},n.prototype.inotn=function(e){o("number"==typeof e&&0<=e);var t=0|ae(e/26),a=e%26;this._expand(t),0<a&&t--;for(var r=0;r<t;r++)this.words[r]=67108863&~this.words[r];return 0<a&&(this.words[r]=~this.words[r]&67108863>>26-a),this.strip()},n.prototype.notn=function(e){return this.clone().inotn(e)},n.prototype.setn=function(e,t){o("number"==typeof e&&0<=e);var a=0|e/26,r=e%26;return this._expand(a+1),t?this.words[a]|=1<<r:this.words[a]&=~(1<<r),this.strip()},n.prototype.iadd=function(e){var t;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();var o,n;this.length>e.length?(o=this,n=e):(o=e,n=this);for(var l=0,s=0;s<n.length;s++)t=(0|o.words[s])+(0|n.words[s])+l,this.words[s]=67108863&t,l=t>>>26;for(;0!==l&&s<o.length;s++)t=(0|o.words[s])+l,this.words[s]=67108863&t,l=t>>>26;if(this.length=o.length,0!==l)this.words[this.length]=l,this.length++;else if(o!==this)for(;s<o.length;s++)this.words[s]=o.words[s];return this},n.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},n.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var o=this.cmp(e);if(0===o)return this.negative=0,this.length=1,this.words[0]=0,this;var n,l;0<o?(n=this,l=e):(n=e,l=this);for(var s=0,d=0;d<l.length;d++)t=(0|n.words[d])-(0|l.words[d])+s,s=t>>26,this.words[d]=67108863&t;for(;0!==s&&d<n.length;d++)t=(0|n.words[d])+s,s=t>>26,this.words[d]=67108863&t;if(0===s&&d<n.length&&n!==this)for(;d<n.length;d++)this.words[d]=n.words[d];return this.length=va(this.length,d),n!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(e){return this.clone().isub(e)};var L=function(e,t,r){var i=e.words,a=t.words,n=r.words,o=0,l=0|i[0],s=8191&l,d=l>>>13,p=0|i[1],u=8191&p,g=p>>>13,h=0|i[2],m=8191&h,y=h>>>13,f=0|i[3],x=8191&f,b=f>>>13,_=0|i[4],w=8191&_,k=_>>>13,T=0|i[5],A=8191&T,S=T>>>13,C=0|i[6],L=8191&C,E=C>>>13,z=0|i[7],I=8191&z,D=z>>>13,P=0|i[8],O=8191&P,R=P>>>13,M=0|i[9],j=8191&M,B=M>>>13,F=0|a[0],N=8191&F,V=F>>>13,U=0|a[1],H=8191&U,G=U>>>13,Y=0|a[2],q=8191&Y,W=Y>>>13,X=0|a[3],Z=8191&X,$=X>>>13,J=0|a[4],K=8191&J,Q=J>>>13,ee=0|a[5],te=8191&ee,ae=ee>>>13,oe=0|a[6],re=8191&oe,ie=oe>>>13,ne=0|a[7],le=8191&ne,se=ne>>>13,de=0|a[8],ce=8191&de,pe=de>>>13,ue=0|a[9],ge=8191&ue,he=ue>>>13,me,ye,fe;r.negative=e.negative^t.negative,r.length=19,me=v(s,N),ye=v(s,V),ye=0|ye+v(d,N),fe=v(d,V);var xe=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(xe>>>26),xe&=67108863,me=v(u,N),ye=v(u,V),ye=0|ye+v(g,N),fe=v(g,V),me=0|me+v(s,H),ye=0|ye+v(s,G),ye=0|ye+v(d,H),fe=0|fe+v(d,G);var be=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(be>>>26),be&=67108863,me=v(m,N),ye=v(m,V),ye=0|ye+v(y,N),fe=v(y,V),me=0|me+v(u,H),ye=0|ye+v(u,G),ye=0|ye+v(g,H),fe=0|fe+v(g,G),me=0|me+v(s,q),ye=0|ye+v(s,W),ye=0|ye+v(d,q),fe=0|fe+v(d,W);var _e=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(_e>>>26),_e&=67108863,me=v(x,N),ye=v(x,V),ye=0|ye+v(b,N),fe=v(b,V),me=0|me+v(m,H),ye=0|ye+v(m,G),ye=0|ye+v(y,H),fe=0|fe+v(y,G),me=0|me+v(u,q),ye=0|ye+v(u,W),ye=0|ye+v(g,q),fe=0|fe+v(g,W),me=0|me+v(s,Z),ye=0|ye+v(s,$),ye=0|ye+v(d,Z),fe=0|fe+v(d,$);var ve=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(ve>>>26),ve&=67108863,me=v(w,N),ye=v(w,V),ye=0|ye+v(k,N),fe=v(k,V),me=0|me+v(x,H),ye=0|ye+v(x,G),ye=0|ye+v(b,H),fe=0|fe+v(b,G),me=0|me+v(m,q),ye=0|ye+v(m,W),ye=0|ye+v(y,q),fe=0|fe+v(y,W),me=0|me+v(u,Z),ye=0|ye+v(u,$),ye=0|ye+v(g,Z),fe=0|fe+v(g,$),me=0|me+v(s,K),ye=0|ye+v(s,Q),ye=0|ye+v(d,K),fe=0|fe+v(d,Q);var we=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(we>>>26),we&=67108863,me=v(A,N),ye=v(A,V),ye=0|ye+v(S,N),fe=v(S,V),me=0|me+v(w,H),ye=0|ye+v(w,G),ye=0|ye+v(k,H),fe=0|fe+v(k,G),me=0|me+v(x,q),ye=0|ye+v(x,W),ye=0|ye+v(b,q),fe=0|fe+v(b,W),me=0|me+v(m,Z),ye=0|ye+v(m,$),ye=0|ye+v(y,Z),fe=0|fe+v(y,$),me=0|me+v(u,K),ye=0|ye+v(u,Q),ye=0|ye+v(g,K),fe=0|fe+v(g,Q),me=0|me+v(s,te),ye=0|ye+v(s,ae),ye=0|ye+v(d,te),fe=0|fe+v(d,ae);var ke=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(ke>>>26),ke&=67108863,me=v(L,N),ye=v(L,V),ye=0|ye+v(E,N),fe=v(E,V),me=0|me+v(A,H),ye=0|ye+v(A,G),ye=0|ye+v(S,H),fe=0|fe+v(S,G),me=0|me+v(w,q),ye=0|ye+v(w,W),ye=0|ye+v(k,q),fe=0|fe+v(k,W),me=0|me+v(x,Z),ye=0|ye+v(x,$),ye=0|ye+v(b,Z),fe=0|fe+v(b,$),me=0|me+v(m,K),ye=0|ye+v(m,Q),ye=0|ye+v(y,K),fe=0|fe+v(y,Q),me=0|me+v(u,te),ye=0|ye+v(u,ae),ye=0|ye+v(g,te),fe=0|fe+v(g,ae),me=0|me+v(s,re),ye=0|ye+v(s,ie),ye=0|ye+v(d,re),fe=0|fe+v(d,ie);var Te=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Te>>>26),Te&=67108863,me=v(I,N),ye=v(I,V),ye=0|ye+v(D,N),fe=v(D,V),me=0|me+v(L,H),ye=0|ye+v(L,G),ye=0|ye+v(E,H),fe=0|fe+v(E,G),me=0|me+v(A,q),ye=0|ye+v(A,W),ye=0|ye+v(S,q),fe=0|fe+v(S,W),me=0|me+v(w,Z),ye=0|ye+v(w,$),ye=0|ye+v(k,Z),fe=0|fe+v(k,$),me=0|me+v(x,K),ye=0|ye+v(x,Q),ye=0|ye+v(b,K),fe=0|fe+v(b,Q),me=0|me+v(m,te),ye=0|ye+v(m,ae),ye=0|ye+v(y,te),fe=0|fe+v(y,ae),me=0|me+v(u,re),ye=0|ye+v(u,ie),ye=0|ye+v(g,re),fe=0|fe+v(g,ie),me=0|me+v(s,le),ye=0|ye+v(s,se),ye=0|ye+v(d,le),fe=0|fe+v(d,se);var Ae=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Ae>>>26),Ae&=67108863,me=v(O,N),ye=v(O,V),ye=0|ye+v(R,N),fe=v(R,V),me=0|me+v(I,H),ye=0|ye+v(I,G),ye=0|ye+v(D,H),fe=0|fe+v(D,G),me=0|me+v(L,q),ye=0|ye+v(L,W),ye=0|ye+v(E,q),fe=0|fe+v(E,W),me=0|me+v(A,Z),ye=0|ye+v(A,$),ye=0|ye+v(S,Z),fe=0|fe+v(S,$),me=0|me+v(w,K),ye=0|ye+v(w,Q),ye=0|ye+v(k,K),fe=0|fe+v(k,Q),me=0|me+v(x,te),ye=0|ye+v(x,ae),ye=0|ye+v(b,te),fe=0|fe+v(b,ae),me=0|me+v(m,re),ye=0|ye+v(m,ie),ye=0|ye+v(y,re),fe=0|fe+v(y,ie),me=0|me+v(u,le),ye=0|ye+v(u,se),ye=0|ye+v(g,le),fe=0|fe+v(g,se),me=0|me+v(s,ce),ye=0|ye+v(s,pe),ye=0|ye+v(d,ce),fe=0|fe+v(d,pe);var Se=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Se>>>26),Se&=67108863,me=v(j,N),ye=v(j,V),ye=0|ye+v(B,N),fe=v(B,V),me=0|me+v(O,H),ye=0|ye+v(O,G),ye=0|ye+v(R,H),fe=0|fe+v(R,G),me=0|me+v(I,q),ye=0|ye+v(I,W),ye=0|ye+v(D,q),fe=0|fe+v(D,W),me=0|me+v(L,Z),ye=0|ye+v(L,$),ye=0|ye+v(E,Z),fe=0|fe+v(E,$),me=0|me+v(A,K),ye=0|ye+v(A,Q),ye=0|ye+v(S,K),fe=0|fe+v(S,Q),me=0|me+v(w,te),ye=0|ye+v(w,ae),ye=0|ye+v(k,te),fe=0|fe+v(k,ae),me=0|me+v(x,re),ye=0|ye+v(x,ie),ye=0|ye+v(b,re),fe=0|fe+v(b,ie),me=0|me+v(m,le),ye=0|ye+v(m,se),ye=0|ye+v(y,le),fe=0|fe+v(y,se),me=0|me+v(u,ce),ye=0|ye+v(u,pe),ye=0|ye+v(g,ce),fe=0|fe+v(g,pe),me=0|me+v(s,ge),ye=0|ye+v(s,he),ye=0|ye+v(d,ge),fe=0|fe+v(d,he);var Ce=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Ce>>>26),Ce&=67108863,me=v(j,H),ye=v(j,G),ye=0|ye+v(B,H),fe=v(B,G),me=0|me+v(O,q),ye=0|ye+v(O,W),ye=0|ye+v(R,q),fe=0|fe+v(R,W),me=0|me+v(I,Z),ye=0|ye+v(I,$),ye=0|ye+v(D,Z),fe=0|fe+v(D,$),me=0|me+v(L,K),ye=0|ye+v(L,Q),ye=0|ye+v(E,K),fe=0|fe+v(E,Q),me=0|me+v(A,te),ye=0|ye+v(A,ae),ye=0|ye+v(S,te),fe=0|fe+v(S,ae),me=0|me+v(w,re),ye=0|ye+v(w,ie),ye=0|ye+v(k,re),fe=0|fe+v(k,ie),me=0|me+v(x,le),ye=0|ye+v(x,se),ye=0|ye+v(b,le),fe=0|fe+v(b,se),me=0|me+v(m,ce),ye=0|ye+v(m,pe),ye=0|ye+v(y,ce),fe=0|fe+v(y,pe),me=0|me+v(u,ge),ye=0|ye+v(u,he),ye=0|ye+v(g,ge),fe=0|fe+v(g,he);var Le=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Le>>>26),Le&=67108863,me=v(j,q),ye=v(j,W),ye=0|ye+v(B,q),fe=v(B,W),me=0|me+v(O,Z),ye=0|ye+v(O,$),ye=0|ye+v(R,Z),fe=0|fe+v(R,$),me=0|me+v(I,K),ye=0|ye+v(I,Q),ye=0|ye+v(D,K),fe=0|fe+v(D,Q),me=0|me+v(L,te),ye=0|ye+v(L,ae),ye=0|ye+v(E,te),fe=0|fe+v(E,ae),me=0|me+v(A,re),ye=0|ye+v(A,ie),ye=0|ye+v(S,re),fe=0|fe+v(S,ie),me=0|me+v(w,le),ye=0|ye+v(w,se),ye=0|ye+v(k,le),fe=0|fe+v(k,se),me=0|me+v(x,ce),ye=0|ye+v(x,pe),ye=0|ye+v(b,ce),fe=0|fe+v(b,pe),me=0|me+v(m,ge),ye=0|ye+v(m,he),ye=0|ye+v(y,ge),fe=0|fe+v(y,he);var Ee=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Ee>>>26),Ee&=67108863,me=v(j,Z),ye=v(j,$),ye=0|ye+v(B,Z),fe=v(B,$),me=0|me+v(O,K),ye=0|ye+v(O,Q),ye=0|ye+v(R,K),fe=0|fe+v(R,Q),me=0|me+v(I,te),ye=0|ye+v(I,ae),ye=0|ye+v(D,te),fe=0|fe+v(D,ae),me=0|me+v(L,re),ye=0|ye+v(L,ie),ye=0|ye+v(E,re),fe=0|fe+v(E,ie),me=0|me+v(A,le),ye=0|ye+v(A,se),ye=0|ye+v(S,le),fe=0|fe+v(S,se),me=0|me+v(w,ce),ye=0|ye+v(w,pe),ye=0|ye+v(k,ce),fe=0|fe+v(k,pe),me=0|me+v(x,ge),ye=0|ye+v(x,he),ye=0|ye+v(b,ge),fe=0|fe+v(b,he);var ze=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(ze>>>26),ze&=67108863,me=v(j,K),ye=v(j,Q),ye=0|ye+v(B,K),fe=v(B,Q),me=0|me+v(O,te),ye=0|ye+v(O,ae),ye=0|ye+v(R,te),fe=0|fe+v(R,ae),me=0|me+v(I,re),ye=0|ye+v(I,ie),ye=0|ye+v(D,re),fe=0|fe+v(D,ie),me=0|me+v(L,le),ye=0|ye+v(L,se),ye=0|ye+v(E,le),fe=0|fe+v(E,se),me=0|me+v(A,ce),ye=0|ye+v(A,pe),ye=0|ye+v(S,ce),fe=0|fe+v(S,pe),me=0|me+v(w,ge),ye=0|ye+v(w,he),ye=0|ye+v(k,ge),fe=0|fe+v(k,he);var Ie=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Ie>>>26),Ie&=67108863,me=v(j,te),ye=v(j,ae),ye=0|ye+v(B,te),fe=v(B,ae),me=0|me+v(O,re),ye=0|ye+v(O,ie),ye=0|ye+v(R,re),fe=0|fe+v(R,ie),me=0|me+v(I,le),ye=0|ye+v(I,se),ye=0|ye+v(D,le),fe=0|fe+v(D,se),me=0|me+v(L,ce),ye=0|ye+v(L,pe),ye=0|ye+v(E,ce),fe=0|fe+v(E,pe),me=0|me+v(A,ge),ye=0|ye+v(A,he),ye=0|ye+v(S,ge),fe=0|fe+v(S,he);var De=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(De>>>26),De&=67108863,me=v(j,re),ye=v(j,ie),ye=0|ye+v(B,re),fe=v(B,ie),me=0|me+v(O,le),ye=0|ye+v(O,se),ye=0|ye+v(R,le),fe=0|fe+v(R,se),me=0|me+v(I,ce),ye=0|ye+v(I,pe),ye=0|ye+v(D,ce),fe=0|fe+v(D,pe),me=0|me+v(L,ge),ye=0|ye+v(L,he),ye=0|ye+v(E,ge),fe=0|fe+v(E,he);var Pe=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Pe>>>26),Pe&=67108863,me=v(j,le),ye=v(j,se),ye=0|ye+v(B,le),fe=v(B,se),me=0|me+v(O,ce),ye=0|ye+v(O,pe),ye=0|ye+v(R,ce),fe=0|fe+v(R,pe),me=0|me+v(I,ge),ye=0|ye+v(I,he),ye=0|ye+v(D,ge),fe=0|fe+v(D,he);var Oe=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Oe>>>26),Oe&=67108863,me=v(j,ce),ye=v(j,pe),ye=0|ye+v(B,ce),fe=v(B,pe),me=0|me+v(O,ge),ye=0|ye+v(O,he),ye=0|ye+v(R,ge),fe=0|fe+v(R,he);var Re=0|(0|o+me)+((8191&ye)<<13);o=0|(0|fe+(ye>>>13))+(Re>>>26),Re&=67108863,me=v(j,ge),ye=v(j,he),ye=0|ye+v(B,ge),fe=v(B,he);var Me=0|(0|o+me)+((8191&ye)<<13);return o=0|(0|fe+(ye>>>13))+(Me>>>26),Me&=67108863,n[0]=xe,n[1]=be,n[2]=_e,n[3]=ve,n[4]=we,n[5]=ke,n[6]=Te,n[7]=Ae,n[8]=Se,n[9]=Ce,n[10]=Le,n[11]=Ee,n[12]=ze,n[13]=Ie,n[14]=De,n[15]=Pe,n[16]=Oe,n[17]=Re,n[18]=Me,0!==o&&(n[19]=o,r.length++),r};v||(L=c),n.prototype.mulTo=function(e,t){var a=this.length+e.length,o;return o=10===this.length&&10===e.length?L(this,e,t):63>a?c(this,e,t):1024>a?p(this,e,t):u(this,e,t),o},g.prototype.makeRBT=function(e){for(var a=Array(e),t=n.prototype._countBits(e)-1,o=0;o<e;o++)a[o]=this.revBin(o,t,e);return a},g.prototype.revBin=function(e,t,a){if(0===e||e===a-1)return e;for(var o=0,r=0;r<t;r++)o|=(1&e)<<t-r-1,e>>=1;return o},g.prototype.permute=function(e,t,a,o,r,n){for(var l=0;l<n;l++)o[l]=t[e[l]],r[l]=a[e[l]]},g.prototype.transform=function(e,t,a,o,r,i){this.permute(i,e,t,a,o,r);for(var n=1;n<r;n<<=1)for(var d=n<<1,l=te(2*Sa/d),c=M(2*Sa/d),u=0;u<r;u+=d)for(var g=l,h=c,m=0;m<n;m++){var y=a[u+m],f=o[u+m],x=a[u+m+n],b=o[u+m+n],_=g*x-h*b;b=g*b+h*x,x=_,a[u+m]=y+x,o[u+m]=f+b,a[u+m+n]=y-x,o[u+m+n]=f-b,m!==d&&(_=l*g-c*h,h=l*h+c*g,g=_)}},g.prototype.guessLen13b=function(e,t){var a=1|va(t,e),o=1&a,r=0;for(a=0|a/2;a;a>>>=1)r++;return 1<<r+1+o},g.prototype.conjugate=function(e,a,o){if(!(1>=o))for(var r=0,n;r<o/2;r++)n=e[r],e[r]=e[o-r-1],e[o-r-1]=n,n=a[r],a[r]=-a[o-r-1],a[o-r-1]=-n},g.prototype.normalize13b=function(e,t){for(var a=0,o=0,r;o<t/2;o++)r=8192*R(e[2*o+1]/t)+R(e[2*o]/t)+a,e[o]=67108863&r,a=67108864>r?0:0|r/67108864;return e},g.prototype.convert13b=function(e,t,a,r){for(var n=0,l=0;l<t;l++)n+=0|e[l],a[2*l]=8191&n,n>>>=13,a[2*l+1]=8191&n,n>>>=13;for(l=2*t;l<r;++l)a[l]=0;o(0===n),o(0==(-8192&n))},g.prototype.stub=function(e){for(var t=Array(e),a=0;a<e;a++)t[a]=0;return t},g.prototype.mulp=function(e,t,a){var o=2*this.guessLen13b(e.length,t.length),r=this.makeRBT(o),n=this.stub(o),l=Array(o),s=Array(o),d=Array(o),c=Array(o),p=Array(o),u=Array(o),g=a.words;g.length=o,this.convert13b(e.words,e.length,l,o),this.convert13b(t.words,t.length,c,o),this.transform(l,n,s,d,o,r),this.transform(c,n,p,u,o,r);for(var h=0,m;h<o;h++)m=s[h]*p[h]-d[h]*u[h],d[h]=s[h]*u[h]+d[h]*p[h],s[h]=m;return this.conjugate(s,d,o),this.transform(s,d,g,n,o,r),this.conjugate(g,n,o),this.normalize13b(g,o),a.negative=e.negative^t.negative,a.length=e.length+t.length,a.strip()},n.prototype.mul=function(e){var t=new n(null);return t.words=Array(this.length+e.length),this.mulTo(e,t)},n.prototype.mulf=function(e){var t=new n(null);return t.words=Array(this.length+e.length),u(this,e,t)},n.prototype.imul=function(e){return this.clone().mulTo(e,this)},n.prototype.imuln=function(e){o("number"==typeof e),o(67108864>e);for(var t=0,a=0;a<this.length;a++){var r=(0|this.words[a])*e,n=(67108863&r)+(67108863&t);t>>=26,t+=0|r/67108864,t+=n>>>26,this.words[a]=67108863&n}return 0!==t&&(this.words[a]=t,this.length++),this},n.prototype.muln=function(e){return this.clone().imuln(e)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(e){var t=d(e);if(0===t.length)return new n(1);for(var a=this,o=0;o<t.length&&!(0!==t[o]);o++,a=a.sqr());if(++o<t.length)for(var r=a.sqr();o<t.length;o++,r=r.sqr())0!==t[o]&&(a=a.mul(r));return a},n.prototype.iushln=function(e){o("number"==typeof e&&0<=e);var t=e%26,a=(e-t)/26,r;if(0!=t){var n=0;for(r=0;r<this.length;r++){var l=this.words[r]&67108863>>>26-t<<26-t,s=(0|this.words[r])-l<<t;this.words[r]=s|n,n=l>>>26-t}n&&(this.words[r]=n,this.length++)}if(0!==a){for(r=this.length-1;0<=r;r--)this.words[r+a]=this.words[r];for(r=0;r<a;r++)this.words[r]=0;this.length+=a}return this.strip()},n.prototype.ishln=function(e){return o(0===this.negative),this.iushln(e)},n.prototype.iushrn=function(e,t,a){o("number"==typeof e&&0<=e);var n=t?(t-t%26)/26:0;var l=e%26,r=ie((e-l)/26,this.length),s=a;if(n-=r,n=va(0,n),s){for(var d=0;d<r;d++)s.words[d]=this.words[d];s.length=r}if(0===r);else if(this.length>r)for(this.length-=r,d=0;d<this.length;d++)this.words[d]=this.words[d+r];else this.words[0]=0,this.length=1;var c=0;for(d=this.length-1;0<=d&&(0!=c||d>=n);d--){var p=0|this.words[d];this.words[d]=c<<26-l|p>>>l,c=p&(67108863^67108863>>>l<<l)}return s&&0!=c&&(s.words[s.length++]=c),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(e,t,a){return o(0===this.negative),this.iushrn(e,t,a)},n.prototype.shln=function(e){return this.clone().ishln(e)},n.prototype.ushln=function(e){return this.clone().iushln(e)},n.prototype.shrn=function(e){return this.clone().ishrn(e)},n.prototype.ushrn=function(e){return this.clone().iushrn(e)},n.prototype.testn=function(e){o("number"==typeof e&&0<=e);var t=e%26,a=(e-t)/26;if(this.length<=a)return!1;var r=this.words[a];return!!(r&1<<t)},n.prototype.imaskn=function(e){o("number"==typeof e&&0<=e);var t=e%26,a=(e-t)/26;if(o(0===this.negative,"imaskn works only with positive numbers"),this.length<=a)return this;if(0!=t&&a++,this.length=ie(a,this.length),0!=t){this.words[this.length-1]&=67108863^67108863>>>t<<t}return this.strip()},n.prototype.maskn=function(e){return this.clone().imaskn(e)},n.prototype.iaddn=function(e){return o("number"==typeof e),o(67108864>e),0>e?this.isubn(-e):0===this.negative?this._iaddn(e):1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this)},n.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&67108864<=this.words[t];t++)this.words[t]-=67108864,t==this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=va(this.length,t+1),this},n.prototype.isubn=function(e){if(o("number"==typeof e),o(67108864>e),0>e)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&0>this.words[0])this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&0>this.words[t];t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},n.prototype.addn=function(e){return this.clone().iaddn(e)},n.prototype.subn=function(e){return this.clone().isubn(e)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(e,t,a){var r=e.length+a,n;this._expand(r);var l=0,s;for(n=0;n<e.length;n++){s=(0|this.words[n+a])+l;var d=(0|e.words[n])*t;s-=67108863&d,l=(s>>26)-(0|d/67108864),this.words[n+a]=67108863&s}for(;n<this.length-a;n++)s=(0|this.words[n+a])+l,l=s>>26,this.words[n+a]=67108863&s;if(0===l)return this.strip();for(o(-1===l),l=0,n=0;n<this.length;n++)s=-(0|this.words[n])+l,l=s>>26,this.words[n]=67108863&s;return this.negative=1,this.strip()},n.prototype._wordDiv=function(e,t){var o=this.length-e.length,r=this.clone(),l=e,s=0|l.words[l.length-1],d=this._countBits(s);o=26-d,0!=o&&(l=l.ushln(o),r.iushln(o),s=0|l.words[l.length-1]);var c=r.length-l.length,p;if("mod"!==t){p=new n(null),p.length=c+1,p.words=Array(p.length);for(var u=0;u<p.length;u++)p.words[u]=0}var g=r.clone()._ishlnsubmul(l,1,c);0===g.negative&&(r=g,p&&(p.words[c]=1));for(var h=c-1,m;0<=h;h--){for(m=67108864*(0|r.words[l.length+h])+(0|r.words[l.length+h-1]),m=ie(0|m/s,67108863),r._ishlnsubmul(l,m,h);0!==r.negative;)m--,r.negative=0,r._ishlnsubmul(l,1,h),r.isZero()||(r.negative^=1);p&&(p.words[h]=m)}return p&&p.strip(),r.strip(),"div"!==t&&0!=o&&r.iushrn(o),{div:p||null,mod:r}},n.prototype.divmod=function(e,t,a){if(o(!e.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var r,i,l;return 0!==this.negative&&0===e.negative?(l=this.neg().divmod(e,t),"mod"!==t&&(r=l.div.neg()),"div"!==t&&(i=l.mod.neg(),a&&0!==i.negative&&i.iadd(e)),{div:r,mod:i}):0===this.negative&&0!==e.negative?(l=this.divmod(e.neg(),t),"mod"!==t&&(r=l.div.neg()),{div:r,mod:l.mod}):0==(this.negative&e.negative)?e.length>this.length||0>this.cmp(e)?{div:new n(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new n(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new n(this.modn(e.words[0]))}:this._wordDiv(e,t):(l=this.neg().divmod(e.neg(),t),"div"!==t&&(i=l.mod.neg(),a&&0!==i.negative&&i.isub(e)),{div:l.div,mod:i})},n.prototype.div=function(e){return this.divmod(e,"div",!1).div},n.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},n.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},n.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var a=0===t.div.negative?t.mod:t.mod.isub(e),o=e.ushrn(1),r=e.andln(1),i=a.cmp(o);return 0>i||1===r&&0===i?t.div:0===t.div.negative?t.div.iaddn(1):t.div.isubn(1)},n.prototype.modn=function(e){o(67108863>=e);for(var t=0,a=this.length-1;0<=a;a--)t=(67108864%e*t+(0|this.words[a]))%e;return t},n.prototype.idivn=function(e){o(67108863>=e);for(var t=0,a=this.length-1,r;0<=a;a--)r=(0|this.words[a])+67108864*t,this.words[a]=0|r/e,t=r%e;return this.strip()},n.prototype.divn=function(e){return this.clone().idivn(e)},n.prototype.egcd=function(e){o(0===e.negative),o(!e.isZero());var t=this,a=e.clone();t=0===t.negative?t.clone():t.umod(e);for(var r=new n(1),l=new n(0),s=new n(0),d=new n(1),c=0;t.isEven()&&a.isEven();)t.iushrn(1),a.iushrn(1),++c;for(var p=a.clone(),u=t.clone();!t.isZero();){for(var h=0,m=1;0==(t.words[0]&m)&&26>h;++h,m<<=1);if(0<h)for(t.iushrn(h);0<h--;)(r.isOdd()||l.isOdd())&&(r.iadd(p),l.isub(u)),r.iushrn(1),l.iushrn(1);for(var y=0,f=1;0==(a.words[0]&f)&&26>y;++y,f<<=1);if(0<y)for(a.iushrn(y);0<y--;)(s.isOdd()||d.isOdd())&&(s.iadd(p),d.isub(u)),s.iushrn(1),d.iushrn(1);0<=t.cmp(a)?(t.isub(a),r.isub(s),l.isub(d)):(a.isub(t),s.isub(r),d.isub(l))}return{a:s,b:d,gcd:a.iushln(c)}},n.prototype._invmp=function(e){o(0===e.negative),o(!e.isZero());var t=this,r=e.clone();t=0===t.negative?t.clone():t.umod(e);for(var l=new n(1),s=new n(0),d=r.clone();0<t.cmpn(1)&&0<r.cmpn(1);){for(var c=0,p=1;0==(t.words[0]&p)&&26>c;++c,p<<=1);if(0<c)for(t.iushrn(c);0<c--;)l.isOdd()&&l.iadd(d),l.iushrn(1);for(var u=0,g=1;0==(r.words[0]&g)&&26>u;++u,g<<=1);if(0<u)for(r.iushrn(u);0<u--;)s.isOdd()&&s.iadd(d),s.iushrn(1);0<=t.cmp(r)?(t.isub(r),l.isub(s)):(r.isub(t),s.isub(l))}var h;return h=0===t.cmpn(1)?l:s,0>h.cmpn(0)&&h.iadd(e),h},n.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var o=this.clone(),i=e.clone();o.negative=0,i.negative=0;for(var n=0;o.isEven()&&i.isEven();n++)o.iushrn(1),i.iushrn(1);do{for(;o.isEven();)o.iushrn(1);for(;i.isEven();)i.iushrn(1);var l=o.cmp(i);if(0>l){var r=o;o=i,i=r}else if(0===l||0===i.cmpn(1))break;o.isub(i)}while(!0);return i.iushln(n)},n.prototype.invm=function(e){return this.egcd(e).a.umod(e)},n.prototype.isEven=function(){return 0==(1&this.words[0])},n.prototype.isOdd=function(){return 1==(1&this.words[0])},n.prototype.andln=function(e){return this.words[0]&e},n.prototype.bincn=function(e){o("number"==typeof e);var t=e%26,a=(e-t)/26,r=1<<t;if(this.length<=a)return this._expand(a+1),this.words[a]|=r,this;for(var n=r,l=a,s;0!==n&&l<this.length;l++)s=0|this.words[l],s+=n,n=s>>>26,s&=67108863,this.words[l]=s;return 0!==n&&(this.words[l]=n,this.length++),this},n.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},n.prototype.cmpn=function(e){var t=0>e;if(0!==this.negative&&!t)return-1;if(0===this.negative&&t)return 1;this.strip();var a;if(1<this.length)a=1;else{t&&(e=-e),o(67108863>=e,"Number is too big");var r=0|this.words[0];a=r===e?0:r<e?-1:1}return 0===this.negative?a:0|-a},n.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0===this.negative?t:0|-t},n.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,o=this.length-1;0<=o;o--){var r=0|this.words[o],a=0|e.words[o];if(r!==a){r<a?t=-1:r>a&&(t=1);break}}return t},n.prototype.gtn=function(e){return 1===this.cmpn(e)},n.prototype.gt=function(e){return 1===this.cmp(e)},n.prototype.gten=function(e){return 0<=this.cmpn(e)},n.prototype.gte=function(e){return 0<=this.cmp(e)},n.prototype.ltn=function(e){return-1===this.cmpn(e)},n.prototype.lt=function(e){return-1===this.cmp(e)},n.prototype.lten=function(e){return 0>=this.cmpn(e)},n.prototype.lte=function(e){return 0>=this.cmp(e)},n.prototype.eqn=function(e){return 0===this.cmpn(e)},n.prototype.eq=function(e){return 0===this.cmp(e)},n.red=function(e){return new b(e)},n.prototype.toRed=function(e){return o(!this.red,"Already a number in reduction context"),o(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},n.prototype.fromRed=function(){return o(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(e){return this.red=e,this},n.prototype.forceRed=function(e){return o(!this.red,"Already a number in reduction context"),this._forceRed(e)},n.prototype.redAdd=function(e){return o(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},n.prototype.redIAdd=function(e){return o(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},n.prototype.redSub=function(e){return o(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},n.prototype.redISub=function(e){return o(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},n.prototype.redShl=function(e){return o(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},n.prototype.redMul=function(e){return o(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},n.prototype.redIMul=function(e){return o(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},n.prototype.redSqr=function(){return o(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return o(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return o(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return o(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return o(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(e){return o(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var E={k256:null,p224:null,p192:null,p25519:null};h.prototype._tmp=function(){var e=new n(null);return e.words=Array(ae(this.n/13)),e},h.prototype.ireduce=function(e){var t=e,a;do this.split(t,this.tmp),t=this.imulK(t),t=t.iadd(this.tmp),a=t.bitLength();while(a>this.n);var o=a<this.n?-1:t.ucmp(this.p);return 0===o?(t.words[0]=0,t.length=1):0<o?t.isub(this.p):t.strip(),t},h.prototype.split=function(e,t){e.iushrn(this.n,0,t)},h.prototype.imulK=function(e){return e.imul(this.k)},r(m,h),m.prototype.split=function(e,t){for(var a=4194303,o=ie(e.length,9),r=0;r<o;r++)t.words[r]=e.words[r];if(t.length=o,9>=e.length)return e.words[0]=0,void(e.length=1);var n=e.words[9];for(t.words[t.length++]=n&a,r=10;r<e.length;r++){var l=0|e.words[r];e.words[r-10]=(l&a)<<4|n>>>22,n=l}n>>>=22,e.words[r-10]=n,e.length-=0===n&&10<e.length?10:9},m.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,a=0,o;a<e.length;a++)o=0|e.words[a],t+=977*o,e.words[a]=67108863&t,t=64*o+(0|t/67108864);return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},r(y,h),r(f,h),r(x,h),x.prototype.imulK=function(e){for(var t=0,a=0;a<e.length;a++){var o=19*(0|e.words[a])+t,r=67108863&o;o>>>=26,e.words[a]=r,t=o}return 0!==t&&(e.words[e.length++]=t),e},n._prime=function e(t){if(E[t])return E[t];var e;if("k256"===t)e=new m;else if("p224"===t)e=new y;else if("p192"===t)e=new f;else if("p25519"===t)e=new x;else throw new Error("Unknown prime "+t);return E[t]=e,e},b.prototype._verify1=function(e){o(0===e.negative,"red works only with positives"),o(e.red,"red works only with red numbers")},b.prototype._verify2=function(e,t){o(0==(e.negative|t.negative),"red works only with positives"),o(e.red&&e.red===t.red,"red works only with red numbers")},b.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},b.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},b.prototype.add=function(e,t){this._verify2(e,t);var a=e.add(t);return 0<=a.cmp(this.m)&&a.isub(this.m),a._forceRed(this)},b.prototype.iadd=function(e,t){this._verify2(e,t);var a=e.iadd(t);return 0<=a.cmp(this.m)&&a.isub(this.m),a},b.prototype.sub=function(e,t){this._verify2(e,t);var a=e.sub(t);return 0>a.cmpn(0)&&a.iadd(this.m),a._forceRed(this)},b.prototype.isub=function(e,t){this._verify2(e,t);var a=e.isub(t);return 0>a.cmpn(0)&&a.iadd(this.m),a},b.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},b.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},b.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},b.prototype.isqr=function(e){return this.imul(e,e.clone())},b.prototype.sqr=function(e){return this.mul(e,e)},b.prototype.sqrt=function(e){if(e.isZero())return e.clone();var a=this.m.andln(3);if(o(1==a%2),3===a){var l=this.m.add(new n(1)).iushrn(2);return this.pow(e,l)}for(var d=this.m.subn(1),p=0;!d.isZero()&&0===d.andln(1);)p++,d.iushrn(1);o(!d.isZero());var u=new n(1).toRed(this),g=u.redNeg(),h=this.m.subn(1).iushrn(1),y=this.m.bitLength();for(y=new n(2*y*y).toRed(this);0!==this.pow(y,h).cmp(g);)y.redIAdd(g);for(var f=this.pow(y,d),x=this.pow(e,d.addn(1).iushrn(1)),_=this.pow(e,d),v=p;0!==_.cmp(u);){for(var w=_,k=0;0!==w.cmp(u);k++)w=w.redSqr();o(k<v);var T=this.pow(f,new n(1).iushln(v-k-1));x=x.redMul(T),f=T.redSqr(),_=_.redMul(f),v=k}return x},b.prototype.invm=function(e){var t=e._invmp(this.m);return 0===t.negative?this.imod(t):(t.negative=0,this.imod(t).redNeg())},b.prototype.pow=function(e,t){if(t.isZero())return new n(1).toRed(this);if(0===t.cmpn(1))return e.clone();var a=Array(16);a[0]=new n(1).toRed(this),a[1]=e;for(var o=2;o<a.length;o++)a[o]=this.mul(a[o-1],e);var r=a[0],l=0,s=0,d=t.bitLength()%26;for(0===d&&(d=26),o=t.length-1;0<=o;o--){for(var c=t.words[o],p=d-1,u;0<=p;p--){if(u=1&c>>p,r!==a[0]&&(r=this.sqr(r)),0===u&&0===l){s=0;continue}l<<=1,l|=u,s++,4!==s&&(0!=o||0!=p)||(r=this.mul(r,a[l]),s=0,l=0)}d=26}return r},b.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},b.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},n.mont=function(e){return new _(e)},r(_,b),_.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},_.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},_.prototype.imul=function(e,a){if(e.isZero()||a.isZero())return e.words[0]=0,e.length=1,e;var o=e.imul(a),t=o.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=o.isub(t).iushrn(this.shift),i=r;return 0<=r.cmp(this.m)?i=r.isub(this.m):0>r.cmpn(0)&&(i=r.iadd(this.m)),i._forceRed(this)},_.prototype.mul=function(e,a){if(e.isZero()||a.isZero())return new n(0)._forceRed(this);var o=e.mul(a),t=o.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=o.isub(t).iushrn(this.shift),i=r;return 0<=r.cmp(this.m)?i=r.isub(this.m):0>r.cmpn(0)&&(i=r.iadd(this.m)),i._forceRed(this)},_.prototype.invm=function(e){var t=this.imod(e._invmp(this.m).mul(this.r2));return t._forceRed(this)}})("undefined"==typeof t||t,this)},{buffer:91}],83:[function(e,t){"use strict";t.exports=function(e){var t=e.length,a=0,o,r,n;for(o=0;o<t;++o)a+=e[o].length;var l=Array(a),s=0;for(o=0;o<t;++o){var u=e[o],c=u.length;for(r=0;r<c;++r){var d=l[s++]=Array(c-1),g=0;for(n=0;n<c;++n)n!==r&&(d[g++]=u[n]);if(1&r){var h=d[1];d[1]=d[0],d[0]=h}}}return l}},{}],84:[function(e,t){"use strict";function a(e,t){for(var a=0;a<e;++a)if(!(t[a]<=t[a+e]))return!0;return!1}function o(e,t,o,r){for(var l=0,s=0,d=0,c=e.length,n;d<c;++d)if(n=e[d],!a(t,n)){for(var p=0;p<2*t;++p)o[l++]=n[p];r[s++]=d}return s}function r(e,t,a,r){var i=e.length,l=t.length;if(!(0>=i||0>=l)){var u=e[0].length>>>1;if(!(0>=u)){var d=s.mallocDouble(2*u*i),g=s.mallocInt32(i),h;if(i=o(e,u,d,g),0<i){if(1==u&&r)c.init(i),h=c.sweepComplete(u,a,0,i,d,g,0,i,d,g);else{var y=s.mallocDouble(2*u*l),f=s.mallocInt32(l);l=o(t,u,y,f),0<l&&(c.init(i+l),h=1==u?c.sweepBipartite(u,a,0,i,d,g,0,l,y,f):p(u,a,r,i,d,g,l,y,f),s.free(y),s.free(f))}s.free(d),s.free(g)}return h}}}function i(e,t){u.push([e,t])}function n(e){return u=[],r(e,e,i,!0),u}function l(e,t){return u=[],r(e,t,i,!1),u}t.exports=function(e,t,a){switch(arguments.length){case 1:return n(e);case 2:return"function"==typeof t?r(e,e,t,!0):l(e,t);case 3:return r(e,t,a,!1);default:throw new Error("box-intersect: Invalid arguments");}};var s=e("typedarray-pool"),c=e("./lib/sweep"),p=e("./lib/intersect"),u},{"./lib/intersect":86,"./lib/sweep":90,"typedarray-pool":521}],85:[function(e,t,a){"use strict";function o(e,t,a){var o="bruteForce"+(e?"Red":"Blue")+(t?"Flip":"")+(a?"Full":""),r=["function ",o,"(",i.join(),"){","var ","es","=2*","d",";"],n="for(var i=rs,rp=es*rs;i<re;++i,rp+=es){var x0=rb[ax+rp],x1=rb[ax+rp+d],xi=ri[i];",l="for(var j=bs,bp=es*bs;j<be;++j,bp+=es){var y0=bb[ax+bp],"+(a?"y1=bb[ax+bp+d],":"")+"yi=bi[j];";return e?r.push(n,"Q",":",l):r.push(l,"Q",":",n),a?r.push("if(y1<x0||x1<y0)continue;"):t?r.push("if(y0<=x0||x1<y0)continue;"):r.push("if(y0<x0||x1<y0)continue;"),r.push("for(var k=ax+1;k<d;++k){var r0=rb[k+rp],r1=rb[k+d+rp],b0=bb[k+bp],b1=bb[k+d+bp];if(r1<b0||b1<r0)continue Q;}var rv=vv("),t?r.push("yi,xi"):r.push("xi,yi"),r.push(");if(rv!==void 0)return rv;}}}"),{name:o,code:r.join("")}}function r(e){function t(t,a){var n=o(t,a,e);r.push(n.code),l.push("return "+n.name+"("+i.join()+");")}var a="bruteForce"+(e?"Full":"Partial"),r=[],n=i.slice();e||n.splice(3,0,"fp");var l=["function "+a+"("+n.join()+"){"];l.push("if(re-rs>be-bs){"),e?(t(!0,!1),l.push("}else{"),t(!1,!1)):(l.push("if(fp){"),t(!0,!0),l.push("}else{"),t(!0,!1),l.push("}}else{if(fp){"),t(!1,!0),l.push("}else{"),t(!1,!1),l.push("}")),l.push("}}return "+a);var s=r.join("")+l.join(""),d=new Function(s);return d()}var i=["d","ax","vv","rs","re","rb","ri","bs","be","bb","bi"];a.partial=r(!1),a.full=r(!0)},{}],86:[function(e,t){"use strict";function a(e,t){var a=0|8*s.log2(t+1)*(e+1),o=s.nextPow2(6*a);w.length<o&&(l.free(w),w=l.mallocInt32(o));var r=s.nextPow2(2*a);k<r&&(l.free(k),k=l.mallocDouble(r))}function o(e,t,a,o,r,i,n,l,s){var d=6*e;w[d]=t,w[d+1]=a,w[d+2]=o,w[d+3]=r,w[d+4]=i,w[d+5]=n;var c=2*e;k[c]=l,k[c+1]=s}function r(e,t,a,o,r,n,l,s,d,c,p){var u=2*e,g=d*u,h=c[g+t];red_loop:for(var m=r,y=r*u;m<n;++m,y+=u){var f=l[y+t],x=l[y+t+e];if(!(h<f||x<h)&&!(o&&h===f)){for(var b=s[m],_=t+1;_<e;++_){var f=l[y+_],x=l[y+_+e],v=c[g+_],w=c[g+_+e];if(x<v||w<f)continue red_loop}var k;if(k=o?a(p,b):a(b,p),void 0!==k)return k}}}function i(e,t,a,o,r,n,l,s,d,c){var p=2*e,u=s*p,g=d[u+t];red_loop:for(var h=o,m=o*p,y;h<r;++h,m+=p)if(y=l[h],y!==c){var f=n[m+t],x=n[m+t+e];if(!(g<f||x<g)){for(var b=t+1;b<e;++b){var f=n[m+b],x=n[m+b+e],_=d[u+b],v=d[u+b+e];if(x<_||v<f)continue red_loop}var w=a(y,c);if(void 0!==w)return w}}}function n(e,t,n,l,s,d,h,v,T){a(e,l+h);var A=0,S;for(o(A++,0,0,l,0,h,n?16:0,-Infinity,1/0),n||o(A++,0,0,h,0,l,1,-Infinity,1/0);0<A;){A-=1;var C=6*A,L=w[C],E=w[C+1],z=w[C+2],I=w[C+3],D=w[C+4],P=w[C+5],O=2*A,R=k[O],M=k[O+1],j=1&P,B=!!(16&P),F=s,N=d,V=v,U=T;if((j&&(F=v,N=T,V=s,U=d),!(2&P&&(z=f(e,L,E,z,F,N,M),E>=z)))&&!(4&P&&(E=x(e,L,E,z,F,N,R),E>=z))){var H=z-E,G=D-I;if(B){if(4194304>e*H*(H+G)){if(S=u.scanComplete(e,L,t,E,z,F,N,I,D,V,U),void 0!==S)return S;continue}}else if(128>e*ie(H,G)){if(S=c(e,L,t,j,E,z,F,N,I,D,V,U),void 0!==S)return S;continue}else if(4194304>e*H*G){if(S=u.scanBipartite(e,L,t,j,E,z,F,N,I,D,V,U),void 0!==S)return S;continue}var Y=m(e,L,E,z,F,N,R,M);if(E<Y)if(128>e*(Y-E)){if(S=p(e,L+1,t,E,Y,F,N,I,D,V,U),void 0!==S)return S;}else if(L!==e-2)o(A++,L+1,E,Y,I,D,j,-Infinity,1/0),o(A++,L+1,I,D,E,Y,1^j,-Infinity,1/0);else if(S=j?u.sweepBipartite(e,t,I,D,V,U,E,Y,F,N):u.sweepBipartite(e,t,E,Y,F,N,I,D,V,U),void 0!==S)return S;if(Y<z){var q=g(e,L,I,D,V,U),W=V[2*e*q+L],X=y(e,L,q,D,V,U,W);if(X<D&&o(A++,L,Y,z,X,D,(4|j)+(B?16:0),W,M),I<q&&o(A++,L,Y,z,I,q,(2|j)+(B?16:0),R,W),q+1===X){if(S=B?i(e,L,t,Y,z,F,N,q,V,U[q]):r(e,L,t,j,Y,z,F,N,q,V,U[q]),void 0!==S)return S;}else if(q<X){var Z;if(!B)Z=j?_(e,L,Y,z,F,N,W):b(e,L,Y,z,F,N,W),Y<Z&&(L===e-2?j?S=u.sweepBipartite(e,t,q,X,V,U,Y,Z,F,N):S=u.sweepBipartite(e,t,Y,Z,F,N,q,X,V,U):(o(A++,L+1,Y,Z,q,X,j,-Infinity,1/0),o(A++,L+1,q,X,Y,Z,1^j,-Infinity,1/0)));else if(Z=b(e,L,Y,z,F,N,W),Y<Z){var $=y(e,L,Y,Z,F,N,W);if(L===e-2){if(Y<$&&(S=u.sweepComplete(e,t,Y,$,F,N,q,X,V,U),void 0!==S))return S;if($<Z&&(S=u.sweepBipartite(e,t,$,Z,F,N,q,X,V,U),void 0!==S))return S}else Y<$&&o(A++,L+1,Y,$,q,X,16,-Infinity,1/0),$<Z&&(o(A++,L+1,$,Z,q,X,0,-Infinity,1/0),o(A++,L+1,q,X,$,Z,1,-Infinity,1/0))}}}}}}t.exports=n;var l=e("typedarray-pool"),s=e("bit-twiddle"),d=e("./brute"),c=d.partial,p=d.full,u=e("./sweep"),g=e("./median"),h=e("./partition"),m=h("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),y=h("lo===p0",["p0"]),f=h("lo<p0",["p0"]),x=h("hi<=p0",["p0"]),b=h("lo<=p0&&p0<=hi",["p0"]),_=h("lo<p0&&p0<=hi",["p0"]),v=1024,w=l.mallocInt32(v),k=l.mallocDouble(v)},{"./brute":85,"./median":87,"./partition":88,"./sweep":90,"bit-twiddle":80,"typedarray-pool":521}],87:[function(e,t){"use strict";function a(e,t,a,o,r,n){for(var l=2*e,s=l*(a+1)+t,d=a+1,c;d<o;++d,s+=l){c=r[s];for(var p=d,u=l*(d-1);p>a&&r[u+t]>c;--p,u-=l){for(var g=u,h=u+l,m=0,f;m<l;++m,++g,++h)f=r[g],r[g]=r[h],r[h]=f;var b=n[p];n[p]=n[p-1],n[p-1]=b}}}t.exports=function(e,t,o,n,l,s){if(n<=o+1)return o;for(var d=o,c=n,p=n+o>>>1,u=2*e,g=p,h=l[u*p+t];d<c;){if(8>c-d){a(e,t,d,c,l,s),h=l[u*p+t];break}var m=c-d,f=0|Math.random()*m+d,b=l[u*f+t],_=0|Math.random()*m+d,v=l[u*_+t],w=0|Math.random()*m+d,k=l[u*w+t];b<=v?k>=v?(g=_,h=v):b>=k?(g=f,h=b):(g=w,h=k):v>=k?(g=_,h=v):k>=b?(g=f,h=b):(g=w,h=k);for(var T=u*(c-1),A=u*g,S=0,C;S<u;++S,++T,++A)C=l[T],l[T]=l[A],l[A]=C;var L=s[c-1];s[c-1]=s[g],s[g]=L,g=r(e,t,d,c-1,l,s,h);for(var T=u*(c-1),A=u*g,S=0,C;S<u;++S,++T,++A)C=l[T],l[T]=l[A],l[A]=C;var L=s[c-1];if(s[c-1]=s[g],s[g]=L,p<g){for(c=g-1;d<c&&l[u*(c-1)+t]===h;)c-=1;c+=1}else if(g<p)for(d=g+1;d<c&&l[u*d+t]===h;)d+=1;else break}return r(e,t,o,p,l,s,l[u*p+t])};var o=e("./partition"),r=o("lo<p0",["p0"])},{"./partition":88}],88:[function(e,t){"use strict";t.exports=function(e,t){var a=["a","b","c","d","e","f"].concat(t),o=[];return 0<=e.indexOf("lo")&&o.push("lo=e[k+n]"),0<=e.indexOf("hi")&&o.push("hi=e[k+o]"),a.push("for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m".replace("_",o.join()).replace("$",e)),Function.apply(void 0,a)}},{}],89:[function(e,t){"use strict";function a(e,t,o){for(var r=2*(e+1),n=e+1;n<=t;++n){for(var l=o[r++],a=o[r++],s=n,d=r-2;s-->e;){var c=o[d-2],p=o[d-1];if(c<l)break;else if(c===l&&p<a)break;o[d]=c,o[d+1]=p,d-=2}o[d]=l,o[d+1]=a}}function o(e,t,a){e*=2,t*=2;var o=a[e],r=a[e+1];a[e]=a[t],a[e+1]=a[t+1],a[t]=o,a[t+1]=r}function r(e,t,a){e*=2,t*=2,a[e]=a[t],a[e+1]=a[t+1]}function i(e,t,a,o){e*=2,t*=2,a*=2;var r=o[e],n=o[e+1];o[e]=o[t],o[e+1]=o[t+1],o[t]=o[a],o[t+1]=o[a+1],o[a]=r,o[a+1]=n}function n(e,t,a,o,r){e*=2,t*=2,r[e]=r[t],r[t]=a,r[e+1]=r[t+1],r[t+1]=o}function l(e,t,a){e*=2,t*=2;var o=a[e],r=a[t];if(o<r)return!1;return o!==r||a[e+1]>a[t+1]}function s(e,t,a,o){e*=2;var r=o[e];if(r<t)return!0;return!(r!==t)&&o[e+1]<a}function d(e,t,c){var p=0|(t-e+1)/6,u=e+p,g=t-p,h=e+t>>1,m=h-p,f=h+p,b=u,_=m,v=h,w=f,T=g,A=e+1,S=t-1,C=0;l(b,_,c)&&(C=b,b=_,_=C),l(w,T,c)&&(C=w,w=T,T=C),l(b,v,c)&&(C=b,b=v,v=C),l(_,v,c)&&(C=_,_=v,v=C),l(b,w,c)&&(C=b,b=w,w=C),l(v,w,c)&&(C=v,v=w,w=C),l(_,T,c)&&(C=_,_=T,T=C),l(_,v,c)&&(C=_,_=v,v=C),l(w,T,c)&&(C=w,w=T,T=C);for(var L=c[2*_],E=c[2*_+1],I=c[2*w],D=c[2*w+1],P=2*b,O=2*v,R=2*T,M=0;2>M;++M){var j=c[P+M],x=c[O+M],y=c[R+M];c[2*u+M]=j,c[2*h+M]=x,c[2*g+M]=y}r(m,e,c),r(f,t,c);for(var z=A;z<=S;++z)if(s(z,L,E,c))z!==A&&o(z,A,c),++A;else if(!s(z,I,D,c))for(;;)if(!s(S,I,D,c)){if(--S<z)break;continue}else{s(S,L,E,c)?(i(z,A,S,c),++A,--S):(o(z,S,c),--S);break}n(e,A-1,L,E,c),n(t,S+1,I,D,c),A-2-e<=32?a(e,A-2,c):d(e,A-2,c),t-(S+2)<=32?a(S+2,t,c):d(S+2,t,c),S-A<=32?a(A,S,c):d(A,S,c)}t.exports=function(e,t){t<=128?a(0,t-1,e):d(0,t-1,e)}},{}],90:[function(e,t){"use strict";function a(e){var t=c.nextPow2(e);g.length<t&&(d.free(g),g=d.mallocInt32(t)),h.length<t&&(d.free(h),h=d.mallocInt32(t)),m.length<t&&(d.free(m),m=d.mallocInt32(t)),y.length<t&&(d.free(y),y=d.mallocInt32(t)),f.length<t&&(d.free(f),f=d.mallocInt32(t)),x.length<t&&(d.free(x),x=d.mallocInt32(t));var a=8*t;b.length<a&&(d.free(b),b=d.mallocDouble(a))}function o(e,t,a,o){var r=t[o],i=e[a-1];e[r]=i,t[i]=r}function r(e,t,a,o){e[a]=o,t[o]=a}function i(t,a,l,s,d,c,u,f,x,_){for(var v=0,w=2*t,k=t-1,T=w-1,A=l;A<s;++A){var S=c[A],C=w*A;b[v++]=d[C+k],b[v++]=-(S+1),b[v++]=d[C+T],b[v++]=S}for(var A=u;A<f;++A){var S=_[A]+268435456,L=w*A;b[v++]=x[L+k],b[v++]=-S,b[v++]=x[L+T],b[v++]=S}var E=v>>>1;p(b,E);for(var n=0,z=0,A=0,I;A<E;++A)if(I=0|b[2*A+1],268435456<=I)I=0|I-268435456,o(m,y,z--,I);else if(0<=I)o(g,h,n--,I);else if(-268435456>=I){I=0|-I-268435456;for(var D=0,P;D<n;++D)if(P=a(g[D],I),void 0!==P)return P;r(m,y,z++,I)}else{I=0|-I-1;for(var D=0,P;D<z;++D)if(P=a(I,m[D]),void 0!==P)return P;r(g,h,n++,I)}}function n(t,a,l,s,d,c,u,_,v,w){for(var k=0,T=2*t,A=t-1,S=T-1,C=l;C<s;++C){var L=c[C]+1<<1,E=T*C;b[k++]=d[E+A],b[k++]=-L,b[k++]=d[E+S],b[k++]=L}for(var C=u;C<_;++C){var L=w[C]+1<<1,z=T*C;b[k++]=v[z+A],b[k++]=1|-L,b[k++]=v[z+S],b[k++]=1|L}var I=k>>>1;p(b,I);for(var n=0,D=0,P=0,C=0;C<I;++C){var O=0|b[2*C+1],e=1&O;if(C<I-1&&O>>1==b[2*C+3]>>1&&(e=2,C+=1),0>O){for(var R=-(O>>1)-1,M=0,B;M<P;++M)if(B=a(f[M],R),void 0!==B)return B;if(0!==e)for(var M=0,B;M<n;++M)if(B=a(g[M],R),void 0!==B)return B;if(1!==e)for(var M=0,B;M<D;++M)if(B=a(m[M],R),void 0!==B)return B;0===e?r(g,h,n++,R):1===e?r(m,y,D++,R):2===e&&r(f,x,P++,R)}else{var R=(O>>1)-1;0===e?o(g,h,n--,R):1===e?o(m,y,D--,R):2===e&&o(f,x,P--,R)}}}function l(t,a,l,s,d,c,u,m,y,f,x,_){var v=0,w=2*t,T=a,A=1,S=1;s?S=268435456:A=268435456;for(var C=d;C<c;++C){var L=C+A,E=w*C;b[v++]=u[E+T],b[v++]=-L,b[v++]=u[E+(a+t)],b[v++]=L}for(var C=y;C<f;++C){var L=C+S,z=w*C;b[v++]=x[z+T],b[v++]=-L}var I=v>>>1;p(b,I);for(var n=0,C=0,D;C<I;++C)if(D=0|b[2*C+1],0>D){var L=-D,P=!1;if(268435456<=L?(P=!s,L-=268435456):(P=!!s,L-=1),P)r(g,h,n++,L);else{var O=_[L],R=w*L,M=x[R+a+1],B=x[R+a+1+t];red_loop:for(var F=0;F<n;++F){var N=g[F],V=w*N;if(!(B<u[V+a+1]||u[V+a+1+t]<M)){for(var U=a+2;U<t;++U)if(x[R+U+t]<u[V+U]||u[V+U+t]<x[R+U])continue red_loop;var H=m[N],G;if(G=s?l(O,H):l(H,O),void 0!==G)return G}}}}else o(g,h,n--,D-A)}function s(t,a,o,r,l,s,d,c,u,h,m){for(var y=0,f=2*t,x=a,_=r;_<l;++_){var v=_+268435456,w=f*_;b[y++]=s[w+x],b[y++]=-v,b[y++]=s[w+(a+t)],b[y++]=v}for(var _=c;_<u;++_){var v=_+1,T=f*_;b[y++]=h[T+x],b[y++]=-v}var A=y>>>1;p(b,A);for(var n=0,_=0,S;_<A;++_)if(S=0|b[2*_+1],0>S){var v=-S;if(268435456<=v)g[n++]=v-268435456;else{v-=1;var C=m[v],L=f*v,E=h[L+a+1],z=h[L+a+1+t];red_loop:for(var I=0;I<n;++I){var D=g[I],P=d[D];if(P===C)break;var O=f*D;if(!(z<s[O+a+1]||s[O+a+1+t]<E)){for(var R=a+2;R<t;++R)if(h[L+R+t]<s[O+R]||s[O+R+t]<h[L+R])continue red_loop;var M=o(P,C);if(void 0!==M)return M}}}}else{for(var v=S-268435456,I=n-1;0<=I;--I)if(g[I]===v){for(var R=I+1;R<n;++R)g[R-1]=g[R];break}--n}}t.exports={init:a,sweepBipartite:i,sweepComplete:n,scanBipartite:l,scanComplete:s};var d=e("typedarray-pool"),c=e("bit-twiddle"),p=e("./sort"),u=1024,g=d.mallocInt32(u),h=d.mallocInt32(u),m=d.mallocInt32(u),y=d.mallocInt32(u),f=d.mallocInt32(u),x=d.mallocInt32(u),b=d.mallocDouble(8*u)},{"./sort":89,"bit-twiddle":80,"typedarray-pool":521}],91:[function(){},{}],92:[function(e,t){function a(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=b(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}function r(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function n(e,t,a){if(t)e.call(a);else for(var o=e.length,r=f(e,o),n=0;n<o;++n)r[n].call(a)}function l(e,t,a,o){if(t)e.call(a,o);else for(var r=e.length,n=f(e,r),l=0;l<r;++l)n[l].call(a,o)}function s(e,t,a,o,r){if(t)e.call(a,o,r);else for(var n=e.length,l=f(e,n),s=0;s<n;++s)l[s].call(a,o,r)}function d(e,t,a,o,r,n){if(t)e.call(a,o,r,n);else for(var l=e.length,s=f(e,l),d=0;d<l;++d)s[d].call(a,o,r,n)}function c(e,t,a,o){if(t)e.apply(a,o);else for(var r=e.length,n=f(e,r),l=0;l<r;++l)n[l].apply(a,o)}function p(e,t,a,o){var i,n,l;if("function"!=typeof a)throw new TypeError("\"listener\" argument must be a function");if(n=e._events,n?(n.newListener&&(e.emit("newListener",t,a.listener?a.listener:a),n=e._events),l=n[t]):(n=e._events=b(null),e._eventsCount=0),!l)l=n[t]=a,++e._eventsCount;else if("function"==typeof l?l=n[t]=o?[a,l]:[l,a]:o?l.unshift(a):l.push(a),!l.warned&&(i=r(e),i&&0<i&&l.length>i)){l.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+l.length+" \""+(t+"\" listeners added. Use emitter.setMaxListeners() to increase limit."));s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=l.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",s.name,s.message)}return e}function u(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e);}}function g(e,t,a){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:a},r=v.call(u,o);return r.listener=a,o.wrapFn=r,r}function h(e,t,a){var o=e._events;if(!o)return[];var r=o[t];return r?"function"==typeof r?a?[r.listener||r]:[r]:a?x(r):f(r,r.length):[]}function m(e){var t=this._events;if(t){var a=t[e];if("function"==typeof a)return 1;if(a)return a.length}return 0}function y(e,t){for(var a=t,o=a+1,r=e.length;o<r;a+=1,o+=1)e[a]=e[o];e.pop()}function f(e,t){for(var a=Array(t),o=0;o<t;++o)a[o]=e[o];return a}function x(e){for(var t=Array(e.length),a=0;a<t.length;++a)t[a]=e[a].listener||e[a];return t}var b=Object.create||function(e){var t=function(){};return t.prototype=e,new t},_=Object.keys||function(e){var t=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.push(a);return a},v=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};t.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._maxListeners=void 0;var w=10,k;try{var T={};Object.defineProperty&&Object.defineProperty(T,"x",{value:0}),k=0===T.x}catch(e){k=!1}k?Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return w},set:function(e){if("number"!=typeof e||0>e||e!==e)throw new TypeError("\"defaultMaxListeners\" must be a positive number");w=e}}):a.defaultMaxListeners=w,a.prototype.setMaxListeners=function(e){if("number"!=typeof e||0>e||isNaN(e))throw new TypeError("\"n\" argument must be a positive number");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return r(this)},a.prototype.emit=function(e){var t="error"===e,a,o,r,p,u,g;if(g=this._events,g)t=t&&null==g.error;else if(!t)return!1;if(t){if(1<arguments.length&&(a=arguments[1]),a instanceof Error)throw a;else{var h=new Error("Unhandled \"error\" event. ("+a+")");throw h.context=a,h}return!1}if(o=g[e],!o)return!1;var m="function"==typeof o;switch(r=arguments.length,r){case 1:n(o,m,this);break;case 2:l(o,m,this,arguments[1]);break;case 3:s(o,m,this,arguments[1],arguments[2]);break;case 4:d(o,m,this,arguments[1],arguments[2],arguments[3]);break;default:for(p=Array(r-1),u=1;u<r;u++)p[u-1]=arguments[u];c(o,m,this,p);}return!0},a.prototype.addListener=function(e,t){return p(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return p(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");return this.on(e,g(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");return this.prependListener(e,g(this,e,t)),this},a.prototype.removeListener=function(e,t){var a,o,r,n,l;if("function"!=typeof t)throw new TypeError("\"listener\" argument must be a function");if(o=this._events,!o)return this;if(a=o[e],!a)return this;if(a===t||a.listener===t)0==--this._eventsCount?this._events=b(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,a.listener||t));else if("function"!=typeof a){for(r=-1,n=a.length-1;0<=n;n--)if(a[n]===t||a[n].listener===t){l=a[n].listener,r=n;break}if(0>r)return this;0===r?a.shift():y(a,r),1===a.length&&(o[e]=a[0]),o.removeListener&&this.emit("removeListener",e,l||t)}return this},a.prototype.removeAllListeners=function(e){var t,a,o;if(a=this._events,!a)return this;if(!a.removeListener)return 0===arguments.length?(this._events=b(null),this._eventsCount=0):a[e]&&(0==--this._eventsCount?this._events=b(null):delete a[e]),this;if(0===arguments.length){var r=_(a),n;for(o=0;o<r.length;++o)n=r[o],"removeListener"===n||this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=b(null),this._eventsCount=0,this}if(t=a[e],"function"==typeof t)this.removeListener(e,t);else if(t)for(o=t.length-1;0<=o;o--)this.removeListener(e,t[o]);return this},a.prototype.listeners=function(e){return h(this,e,!0)},a.prototype.rawListeners=function(e){return h(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],93:[function(e,t,a){/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */"use strict";function o(e){if(2147483647<e)throw new RangeError("The value \""+e+"\" is invalid for option \"size\"");var t=new Uint8Array(e);return t.__proto__=r.prototype,t}function r(e,t,a){if("number"==typeof e){if("string"==typeof t)throw new TypeError("The \"string\" argument must be of type string. Received type number");return s(e)}return i(e,t,a)}function i(e,t,a){if("string"==typeof e)return d(e,t);if(ArrayBuffer.isView(e))return c(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Y(e,ArrayBuffer)||e&&Y(e.buffer,ArrayBuffer))return p(e,t,a);if("number"==typeof e)throw new TypeError("The \"value\" argument must not be of type number. Received type number");var o=e.valueOf&&e.valueOf();if(null!=o&&o!==e)return r.from(o,t,a);var i=u(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return r.from(e[Symbol.toPrimitive]("string"),t,a);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function n(e){if("number"!=typeof e)throw new TypeError("\"size\" argument must be of type number");else if(0>e)throw new RangeError("The value \""+e+"\" is invalid for option \"size\"")}function l(e,t,a){return n(e),0>=e?o(e):void 0===t?o(e):"string"==typeof a?o(e).fill(t,a):o(e).fill(t)}function s(e){return n(e),o(0>e?0:0|g(e))}function d(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!r.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var a=0|h(e,t),i=o(a),n=i.write(e,t);return n!==a&&(i=i.slice(0,n)),i}function c(e){for(var t=0>e.length?0:0|g(e.length),a=o(t),r=0;r<t;r+=1)a[r]=255&e[r];return a}function p(e,t,a){if(0>t||e.byteLength<t)throw new RangeError("\"offset\" is outside of buffer bounds");if(e.byteLength<t+(a||0))throw new RangeError("\"length\" is outside of buffer bounds");var o;return o=void 0===t&&void 0===a?new Uint8Array(e):void 0===a?new Uint8Array(e,t):new Uint8Array(e,t,a),o.__proto__=r.prototype,o}function u(e){if(r.isBuffer(e)){var t=0|g(e.length),a=o(t);return 0===a.length?a:(e.copy(a,0,0,t),a)}return void 0===e.length?"Buffer"===e.type&&Array.isArray(e.data)?c(e.data):void 0:"number"!=typeof e.length||q(e.length)?o(0):c(e)}function g(e){if(e>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|e}function h(e,t){if(r.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Y(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError("The \"string\" argument must be one of type string, Buffer, or ArrayBuffer. Received type "+typeof e);var a=e.length,o=2<arguments.length&&!0===arguments[2];if(!o&&0===a)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":return N(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*a;case"hex":return a>>>1;case"base64":return H(e).length;default:if(i)return o?-1:N(e).length;t=(""+t).toLowerCase(),i=!0;}}function m(e,t,a){var o=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return"";if((void 0===a||a>this.length)&&(a=this.length),0>=a)return"";if(a>>>=0,t>>>=0,a<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return z(this,t,a);case"utf8":case"utf-8":return S(this,t,a);case"ascii":return L(this,t,a);case"latin1":case"binary":return E(this,t,a);case"base64":return A(this,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,a);default:if(o)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0;}}function y(e,t,a){var o=e[t];e[t]=e[a],e[a]=o}function f(e,t,a,o,i){if(0===e.length)return-1;if("string"==typeof a?(o=a,a=0):2147483647<a?a=2147483647:-2147483648>a&&(a=-2147483648),a=+a,q(a)&&(a=i?0:e.length-1),0>a&&(a=e.length+a),a>=e.length){if(i)return-1;a=e.length-1}else if(0>a)if(i)a=0;else return-1;if("string"==typeof t&&(t=r.from(t,o)),r.isBuffer(t))return 0===t.length?-1:x(e,t,a,o,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,a):Uint8Array.prototype.lastIndexOf.call(e,t,a):x(e,[t],a,o,i);throw new TypeError("val must be string, number or Buffer")}function x(e,t,a,o,r){function n(e,t){return 1===l?e[t]:e.readUInt16BE(t*l)}var l=1,s=e.length,d=t.length;if(void 0!==o&&(o=(o+"").toLowerCase(),"ucs2"===o||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(2>e.length||2>t.length)return-1;l=2,s/=2,d/=2,a/=2}var c;if(r){var p=-1;for(c=a;c<s;c++)if(n(e,c)!==n(t,-1===p?0:c-p))-1!==p&&(c-=c-p),p=-1;else if(-1===p&&(p=c),c-p+1===d)return p*l}else for(a+d>s&&(a=s-d),c=a;0<=c;c--){for(var u=!0,g=0;g<d;g++)if(n(e,c+g)!==n(t,g)){u=!1;break}if(u)return c}return-1}function b(e,t,a,o){a=+a||0;var r=e.length-a;o?(o=+o,o>r&&(o=r)):o=r;var n=t.length;o>n/2&&(o=n/2);for(var l=0,s;l<o;++l){if(s=parseInt(t.substr(2*l,2),16),q(s))return l;e[a+l]=s}return l}function _(e,t,a,o){return G(N(t,e.length-a),e,a,o)}function v(e,t,a,o){return G(V(t),e,a,o)}function w(e,t,a,o){return v(e,t,a,o)}function k(e,t,a,o){return G(H(t),e,a,o)}function T(e,t,a,o){return G(U(t,e.length-a),e,a,o)}function A(e,t,a){return 0===t&&a===e.length?W.fromByteArray(e):W.fromByteArray(e.slice(t,a))}function S(e,t,a){a=ie(e.length,a);for(var o=[],r=t;r<a;){var n=e[r],l=null,s=239<n?4:223<n?3:191<n?2:1;if(r+s<=a){var d,c,p,u;1===s?128>n&&(l=n):2===s?(d=e[r+1],128==(192&d)&&(u=(31&n)<<6|63&d,127<u&&(l=u))):3===s?(d=e[r+1],c=e[r+2],128==(192&d)&&128==(192&c)&&(u=(15&n)<<12|(63&d)<<6|63&c,2047<u&&(55296>u||57343<u)&&(l=u))):4===s?(d=e[r+1],c=e[r+2],p=e[r+3],128==(192&d)&&128==(192&c)&&128==(192&p)&&(u=(15&n)<<18|(63&d)<<12|(63&c)<<6|63&p,65535<u&&1114112>u&&(l=u))):void 0}null===l?(l=65533,s=1):65535<l&&(l-=65536,o.push(55296|1023&l>>>10),l=56320|1023&l),o.push(l),r+=s}return C(o)}function C(e){var t=e.length;if(t<=4096)return O.apply(String,e);for(var a="",o=0;o<t;)a+=O.apply(String,e.slice(o,o+=4096));return a}function L(e,t,a){var o="";a=ie(e.length,a);for(var r=t;r<a;++r)o+=O(127&e[r]);return o}function E(e,t,a){var o="";a=ie(e.length,a);for(var r=t;r<a;++r)o+=O(e[r]);return o}function z(e,t,a){var o=e.length;(!t||0>t)&&(t=0),(!a||0>a||a>o)&&(a=o);for(var r="",n=t;n<a;++n)r+=F(e[n]);return r}function I(e,t,a){for(var o=e.slice(t,a),r="",n=0;n<o.length;n+=2)r+=O(o[n]+256*o[n+1]);return r}function D(e,t,a){if(0!=e%1||0>e)throw new RangeError("offset is not uint");if(e+t>a)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,a,o,i,n){if(!r.isBuffer(e))throw new TypeError("\"buffer\" argument must be a Buffer instance");if(t>i||t<n)throw new RangeError("\"value\" argument is out of bounds");if(a+o>e.length)throw new RangeError("Index out of range")}function R(e,t,a,o){if(a+o>e.length)throw new RangeError("Index out of range");if(0>a)throw new RangeError("Index out of range")}function M(e,t,a,o,r){return t=+t,a>>>=0,r||R(e,t,a,4,34028234663852886e22,-34028234663852886e22),X.write(e,t,a,o,23,4),a+4}function j(e,t,a,o,r){return t=+t,a>>>=0,r||R(e,t,a,8,17976931348623157e292,-17976931348623157e292),X.write(e,t,a,o,52,8),a+8}function B(e){if(e=e.split("=")[0],e=e.trim().replace(Z,""),2>e.length)return"";for(;0!=e.length%4;)e+="=";return e}function F(e){return 16>e?"0"+e.toString(16):e.toString(16)}function N(e,t){t=t||1/0;for(var a=e.length,o=null,r=[],n=0,l;n<a;++n){if(l=e.charCodeAt(n),55295<l&&57344>l){if(!o){if(56319<l){-1<(t-=3)&&r.push(239,191,189);continue}else if(n+1===a){-1<(t-=3)&&r.push(239,191,189);continue}o=l;continue}if(56320>l){-1<(t-=3)&&r.push(239,191,189),o=l;continue}l=(o-55296<<10|l-56320)+65536}else o&&-1<(t-=3)&&r.push(239,191,189);if(o=null,128>l){if(0>(t-=1))break;r.push(l)}else if(2048>l){if(0>(t-=2))break;r.push(192|l>>6,128|63&l)}else if(65536>l){if(0>(t-=3))break;r.push(224|l>>12,128|63&l>>6,128|63&l)}else if(1114112>l){if(0>(t-=4))break;r.push(240|l>>18,128|63&l>>12,128|63&l>>6,128|63&l)}else throw new Error("Invalid code point")}return r}function V(e){for(var t=[],a=0;a<e.length;++a)t.push(255&e.charCodeAt(a));return t}function U(e,t){for(var a=[],o=0,r,n,l;o<e.length&&!(0>(t-=2));++o)r=e.charCodeAt(o),n=r>>8,l=r%256,a.push(l),a.push(n);return a}function H(e){return W.toByteArray(B(e))}function G(e,t,a,o){for(var r=0;r<o&&!(r+a>=t.length||r>=e.length);++r)t[r+a]=e[r];return r}function Y(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function q(e){return e!==e}var W=e("base64-js"),X=e("ieee754");a.Buffer=r,a.SlowBuffer=function(e){return+e!=e&&(e=0),r.alloc(+e)},a.INSPECT_MAX_BYTES=50;a.kMaxLength=2147483647,r.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(t){return!1}}(),r.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(r.prototype,"parent",{enumerable:!0,get:function(){return r.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(r.prototype,"offset",{enumerable:!0,get:function(){return r.isBuffer(this)?this.byteOffset:void 0}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),r.poolSize=8192,r.from=function(e,t,a){return i(e,t,a)},r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,r.alloc=function(e,t,a){return l(e,t,a)},r.allocUnsafe=function(e){return s(e)},r.allocUnsafeSlow=function(e){return s(e)},r.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==r.prototype},r.compare=function(e,t){if(Y(e,Uint8Array)&&(e=r.from(e,e.offset,e.byteLength)),Y(t,Uint8Array)&&(t=r.from(t,t.offset,t.byteLength)),!r.isBuffer(e)||!r.isBuffer(t))throw new TypeError("The \"buf1\", \"buf2\" arguments must be one of type Buffer or Uint8Array");if(e===t)return 0;for(var o=e.length,n=t.length,l=0,s=ie(o,n);l<s;++l)if(e[l]!==t[l]){o=e[l],n=t[l];break}return o<n?-1:n<o?1:0},r.isEncoding=function(e){switch((e+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},r.concat=function(e,t){if(!Array.isArray(e))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===e.length)return r.alloc(0);var a;if(t===void 0)for(t=0,a=0;a<e.length;++a)t+=e[a].length;var o=r.allocUnsafe(t),n=0;for(a=0;a<e.length;++a){var l=e[a];if(Y(l,Uint8Array)&&(l=r.from(l)),!r.isBuffer(l))throw new TypeError("\"list\" argument must be an Array of Buffers");l.copy(o,n),n+=l.length}return o},r.byteLength=h,r.prototype._isBuffer=!0,r.prototype.swap16=function(){var e=this.length;if(0!=e%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},r.prototype.swap32=function(){var e=this.length;if(0!=e%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},r.prototype.swap64=function(){var e=this.length;if(0!=e%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},r.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?S(this,0,e):m.apply(this,arguments)},r.prototype.toLocaleString=r.prototype.toString,r.prototype.equals=function(e){if(!r.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===r.compare(this,e)},r.prototype.inspect=function(){var e="",t=a.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},r.prototype.compare=function(e,t,a,o,n){if(Y(e,Uint8Array)&&(e=r.from(e,e.offset,e.byteLength)),!r.isBuffer(e))throw new TypeError("The \"target\" argument must be one of type Buffer or Uint8Array. Received type "+typeof e);if(void 0===t&&(t=0),void 0===a&&(a=e?e.length:0),void 0===o&&(o=0),void 0===n&&(n=this.length),0>t||a>e.length||0>o||n>this.length)throw new RangeError("out of range index");if(o>=n&&t>=a)return 0;if(o>=n)return-1;if(t>=a)return 1;if(t>>>=0,a>>>=0,o>>>=0,n>>>=0,this===e)return 0;for(var l=n-o,s=a-t,d=ie(l,s),c=this.slice(o,n),p=e.slice(t,a),u=0;u<d;++u)if(c[u]!==p[u]){l=c[u],s=p[u];break}return l<s?-1:s<l?1:0},r.prototype.includes=function(e,t,a){return-1!==this.indexOf(e,t,a)},r.prototype.indexOf=function(e,t,a){return f(this,e,t,a,!0)},r.prototype.lastIndexOf=function(e,t,a){return f(this,e,t,a,!1)},r.prototype.write=function(e,t,a,o){if(void 0===t)o="utf8",a=this.length,t=0;else if(void 0===a&&"string"==typeof t)o=t,a=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(a)?(a>>>=0,void 0===o&&(o="utf8")):(o=a,a=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var r=this.length-t;if((void 0===a||a>r)&&(a=r),0<e.length&&(0>a||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var i=!1;;)switch(o){case"hex":return b(this,e,t,a);case"utf8":case"utf-8":return _(this,e,t,a);case"ascii":return v(this,e,t,a);case"latin1":case"binary":return w(this,e,t,a);case"base64":return k(this,e,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,a);default:if(i)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),i=!0;}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};r.prototype.slice=function(e,t){var a=this.length;e=~~e,t=void 0===t?a:~~t,0>e?(e+=a,0>e&&(e=0)):e>a&&(e=a),0>t?(t+=a,0>t&&(t=0)):t>a&&(t=a),t<e&&(t=e);var o=this.subarray(e,t);return o.__proto__=r.prototype,o},r.prototype.readUIntLE=function(e,t,a){e>>>=0,t>>>=0,a||D(e,t,this.length);for(var o=this[e],r=1,n=0;++n<t&&(r*=256);)o+=this[e+n]*r;return o},r.prototype.readUIntBE=function(e,t,a){e>>>=0,t>>>=0,a||D(e,t,this.length);for(var o=this[e+--t],r=1;0<t&&(r*=256);)o+=this[e+--t]*r;return o},r.prototype.readUInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),this[e]},r.prototype.readUInt16LE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]|this[e+1]<<8},r.prototype.readUInt16BE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]<<8|this[e+1]},r.prototype.readUInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},r.prototype.readUInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},r.prototype.readIntLE=function(e,t,a){e>>>=0,t>>>=0,a||D(e,t,this.length);for(var o=this[e],r=1,n=0;++n<t&&(r*=256);)o+=this[e+n]*r;return r*=128,o>=r&&(o-=_a(2,8*t)),o},r.prototype.readIntBE=function(e,t,a){e>>>=0,t>>>=0,a||D(e,t,this.length);for(var o=t,r=1,n=this[e+--o];0<o&&(r*=256);)n+=this[e+--o]*r;return r*=128,n>=r&&(n-=_a(2,8*t)),n},r.prototype.readInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},r.prototype.readInt16LE=function(e,t){e>>>=0,t||D(e,2,this.length);var a=this[e]|this[e+1]<<8;return 32768&a?4294901760|a:a},r.prototype.readInt16BE=function(e,t){e>>>=0,t||D(e,2,this.length);var a=this[e+1]|this[e]<<8;return 32768&a?4294901760|a:a},r.prototype.readInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},r.prototype.readInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},r.prototype.readFloatLE=function(e,t){return e>>>=0,t||D(e,4,this.length),X.read(this,e,!0,23,4)},r.prototype.readFloatBE=function(e,t){return e>>>=0,t||D(e,4,this.length),X.read(this,e,!1,23,4)},r.prototype.readDoubleLE=function(e,t){return e>>>=0,t||D(e,8,this.length),X.read(this,e,!0,52,8)},r.prototype.readDoubleBE=function(e,t){return e>>>=0,t||D(e,8,this.length),X.read(this,e,!1,52,8)},r.prototype.writeUIntLE=function(e,t,a,o){if(e=+e,t>>>=0,a>>>=0,!o){var r=_a(2,8*a)-1;P(this,e,t,a,r,0)}var n=1,l=0;for(this[t]=255&e;++l<a&&(n*=256);)this[t+l]=255&e/n;return t+a},r.prototype.writeUIntBE=function(e,t,a,o){if(e=+e,t>>>=0,a>>>=0,!o){var r=_a(2,8*a)-1;P(this,e,t,a,r,0)}var n=a-1,l=1;for(this[t+n]=255&e;0<=--n&&(l*=256);)this[t+n]=255&e/l;return t+a},r.prototype.writeUInt8=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,1,255,0),this[t]=255&e,t+1},r.prototype.writeUInt16LE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},r.prototype.writeUInt16BE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},r.prototype.writeUInt32LE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},r.prototype.writeUInt32BE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},r.prototype.writeIntLE=function(e,t,a,o){if(e=+e,t>>>=0,!o){var r=_a(2,8*a-1);P(this,e,t,a,r-1,-r)}var n=0,l=1,s=0;for(this[t]=255&e;++n<a&&(l*=256);)0>e&&0===s&&0!==this[t+n-1]&&(s=1),this[t+n]=255&(e/l>>0)-s;return t+a},r.prototype.writeIntBE=function(e,t,a,o){if(e=+e,t>>>=0,!o){var r=_a(2,8*a-1);P(this,e,t,a,r-1,-r)}var n=a-1,l=1,s=0;for(this[t+n]=255&e;0<=--n&&(l*=256);)0>e&&0===s&&0!==this[t+n+1]&&(s=1),this[t+n]=255&(e/l>>0)-s;return t+a},r.prototype.writeInt8=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,1,127,-128),0>e&&(e=255+e+1),this[t]=255&e,t+1},r.prototype.writeInt16LE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},r.prototype.writeInt16BE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},r.prototype.writeInt32LE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},r.prototype.writeInt32BE=function(e,t,a){return e=+e,t>>>=0,a||P(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},r.prototype.writeFloatLE=function(e,t,a){return M(this,e,t,!0,a)},r.prototype.writeFloatBE=function(e,t,a){return M(this,e,t,!1,a)},r.prototype.writeDoubleLE=function(e,t,a){return j(this,e,t,!0,a)},r.prototype.writeDoubleBE=function(e,t,a){return j(this,e,t,!1,a)},r.prototype.copy=function(e,t,a,o){if(!r.isBuffer(e))throw new TypeError("argument should be a Buffer");if(a||(a=0),o||0===o||(o=this.length),t>=e.length&&(t=e.length),t||(t=0),0<o&&o<a&&(o=a),o===a)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>a||a>=this.length)throw new RangeError("Index out of range");if(0>o)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),e.length-t<o-a&&(o=e.length-t+a);var n=o-a;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,a,o);else if(this===e&&a<t&&t<o)for(var l=n-1;0<=l;--l)e[l+t]=this[l+a];else Uint8Array.prototype.set.call(e,this.subarray(a,o),t);return n},r.prototype.fill=function(e,t,a,o){if("string"==typeof e){if("string"==typeof t?(o=t,t=0,a=this.length):"string"==typeof a&&(o=a,a=this.length),void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!r.isEncoding(o))throw new TypeError("Unknown encoding: "+o);if(1===e.length){var n=e.charCodeAt(0);("utf8"===o&&128>n||"latin1"===o)&&(e=n)}}else"number"==typeof e&&(e&=255);if(0>t||this.length<t||this.length<a)throw new RangeError("Out of range index");if(a<=t)return this;t>>>=0,a=a===void 0?this.length:a>>>0,e||(e=0);var l;if("number"==typeof e)for(l=t;l<a;++l)this[l]=e;else{var s=r.isBuffer(e)?e:r.from(e,o),d=s.length;if(0===d)throw new TypeError("The value \""+e+"\" is invalid for argument \"value\"");for(l=0;l<a-t;++l)this[l+t]=s[l%d]}return this};var Z=/[^+/0-9A-Za-z-_]/g},{"base64-js":62,ieee754:395}],94:[function(e,t){"use strict";function a(t){return[ie(t[0],t[1]),va(t[0],t[1])]}function o(e,t){return e[0]-t[0]||e[1]-t[1]}function r(e){return e.map(a).sort(o)}function n(e,t,a){return t in e?e[t]:a}var l=e("./lib/monotone"),s=e("./lib/triangulation"),d=e("./lib/delaunay"),c=e("./lib/filter");t.exports=function(e,t,a){Array.isArray(t)?(a=a||{},t=t||[]):(a=t||{},t=[]);var o=!!n(a,"delaunay",!0),p=!!n(a,"interior",!0),u=!!n(a,"exterior",!0),g=!!n(a,"infinity",!1);if(!p&&!u||0===e.length)return[];var h=l(e,t);if(o||p!==u||g){for(var m=s(e.length,r(t)),y=0,x;y<h.length;++y)x=h[y],m.addTriangle(x[0],x[1],x[2]);return o&&d(e,m),u?p?g?c(m,0,g):m.cells():c(m,1,g):c(m,-1)}return h}},{"./lib/delaunay":95,"./lib/filter":96,"./lib/monotone":97,"./lib/triangulation":98}],95:[function(e,t){"use strict";function o(e,t,o,i,n,l){var s=t.opposite(i,n);if(!(0>s)){if(n<i){var d=i;i=n,n=d,d=l,l=s,s=d}t.isConstraint(i,n)||0>r(e[i],e[n],e[l],e[s])&&o.push(i,n)}}var r=e("robust-in-sphere")[4],i=e("binary-search-bounds");t.exports=function(e,n){for(var l=[],d=e.length,c=n.stars,p=0,u;p<d;++p){u=c[p];for(var g=1,h;g<u.length;g+=2)if((h=u[g],!(h<p))&&!n.isConstraint(p,h)){for(var m=u[g-1],f=-1,_=1;_<u.length;_+=2)if(u[_-1]===h){f=u[_];break}0>f||0>r(e[p],e[h],e[m],e[f])&&l.push(p,h)}}for(;0<l.length;){for(var h=l.pop(),p=l.pop(),m=-1,f=-1,u=c[p],v=1;v<u.length;v+=2){var w=u[v-1],s=u[v];w===h?f=s:s===h&&(m=w)}0>m||0>f||0<=r(e[p],e[h],e[m],e[f])||(n.flip(p,h),o(e,n,l,m,p,f),o(e,n,l,p,f,m),o(e,n,l,f,h,m),o(e,n,l,h,m,f))}}},{"binary-search-bounds":99,"robust-in-sphere":484}],96:[function(e,t){"use strict";function o(e,t,a,o,r,i,n){this.cells=e,this.neighbor=t,this.flags=o,this.constraint=a,this.active=r,this.next=i,this.boundary=n}function r(e,t){return e[0]-t[0]||e[1]-t[1]||e[2]-t[2]}function i(e,t){for(var n=e.cells(),l=n.length,s=0;s<l;++s){var d=n[s],p=d[0],u=d[1],g=d[2];u<g?u<p&&(d[0]=u,d[1]=g,d[2]=p):g<p&&(d[0]=g,d[1]=p,d[2]=u)}n.sort(r);for(var h=Array(l),s=0;s<h.length;++s)h[s]=0;var m=[],f=[],_=Array(3*l),v=Array(3*l),w=null;t&&(w=[]);for(var k=new o(n,_,v,h,m,f,w),s=0,d;s<l;++s){d=n[s];for(var T=0;3>T;++T){var p=d[T],u=d[(T+1)%3],A=_[3*s+T]=k.locate(u,p,e.opposite(u,p)),a=v[3*s+T]=e.isConstraint(p,u);0>A&&(a?f.push(s):(m.push(s),h[s]=1),t&&w.push([u,p,-1]))}}return k}function n(e,t,a){for(var o=0,r=0;r<e.length;++r)t[r]===a&&(e[o++]=e[r]);return e.length=o,e}var l=e("binary-search-bounds");t.exports=function(e,a,o){var r=i(e,o);if(0===a)return o?r.cells.concat(r.boundary):r.cells;for(var l=1,s=r.active,d=r.next,p=r.flags,u=r.cells,g=r.constraint,h=r.neighbor;0<s.length||0<d.length;){for(;0<s.length;){var m=s.pop();if(p[m]!==-l){p[m]=l;for(var t=u[m],c=0,y;3>c;++c)y=h[3*m+c],0<=y&&0===p[y]&&(g[3*m+c]?d.push(y):(s.push(y),p[y]=l))}}var x=d;d=s,s=x,d.length=0,l=-l}var b=n(u,p,a);return o?b.concat(r.boundary):b};var s=o.prototype;s.locate=function(){var e=[0,0,0];return function(t,a,o){var i=t,n=a,s=o;return(a<o?a<t&&(i=a,n=o,s=t):o<t&&(i=o,n=t,s=a),0>i)?-1:(e[0]=i,e[1]=n,e[2]=s,l.eq(this.cells,e,r))}}()},{"binary-search-bounds":99}],97:[function(e,t){"use strict";function a(e,t,a,o,r){this.a=e,this.b=t,this.idx=a,this.lowerIds=o,this.upperIds=r}function o(e,t,a,o){this.a=e,this.b=t,this.type=a,this.idx=o}function r(e,t){var a=e.a[0]-t.a[0]||e.a[1]-t.a[1]||e.type-t.type;return a?a:0!==e.type&&(a=g(e.a,e.b,t.b),a)?a:e.idx-t.idx}function n(e,t){return g(e.a,e.b,t)}function l(e,t,a,o,r){for(var l=u.lt(t,o,n),s=u.gt(t,o,n),d=l;d<s;++d){for(var c=t[d],p=c.lowerIds,h=p.length;1<h&&0<g(a[p[h-2]],a[p[h-1]],o);)e.push([p[h-1],p[h-2],r]),h-=1;p.length=h,p.push(r);for(var y=c.upperIds,h=y.length;1<h&&0>g(a[y[h-2]],a[y[h-1]],o);)e.push([y[h-2],y[h-1],r]),h-=1;y.length=h,y.push(r)}}function s(e,t){var a;return(a=e.a[0]<t.a[0]?g(e.a,e.b,t.a):g(t.b,t.a,e.a),a)?a:(a=t.b[0]<e.b[0]?g(e.a,e.b,t.b):g(t.b,t.a,e.b),a||e.idx-t.idx)}function d(e,t,o){var r=u.le(e,o,s),i=e[r],n=i.upperIds,l=n[n.length-1];i.upperIds=[l],e.splice(r+1,0,new a(o.a,o.b,o.idx,[l],n))}function c(e,t,a){var o=a.a;a.a=a.b,a.b=o;var r=u.eq(e,a,s),i=e[r],n=e[r-1];n.upperIds=i.upperIds,e.splice(r,1)}var u=e("binary-search-bounds"),g=e("robust-orientation")[3];t.exports=function(t,n){for(var s=t.length,p=n.length,u=[],g=0;g<s;++g)u.push(new o(t[g],null,0,g));for(var g=0;g<p;++g){var h=n[g],e=t[h[0]],m=t[h[1]];e[0]<m[0]?u.push(new o(e,m,2,g),new o(m,e,1,g)):e[0]>m[0]&&u.push(new o(m,e,2,g),new o(e,m,1,g))}u.sort(r);for(var y=u[0].a[0]-(1+wa(u[0].a[0]))*_a(2,-52),f=[new a([y,1],[y,0],-1,[],[],[],[])],x=[],g=0,b=u.length;g<b;++g){var _=u[g],v=_.type;v===0?l(x,f,t,_.a,_.idx):v===2?d(f,t,_):c(f,t,_)}return x}},{"binary-search-bounds":99,"robust-orientation":486}],98:[function(e,t){"use strict";function a(e,t){this.stars=e,this.edges=t}function o(e,t,a){for(var o=1,r=e.length;o<r;o+=2)if(e[o-1]===t&&e[o]===a)return e[o-1]=e[r-2],e[o]=e[r-1],void(e.length=r-2)}var r=e("binary-search-bounds");t.exports=function(e,t){for(var o=Array(e),r=0;r<e;++r)o[r]=[];return new a(o,t)};var i=a.prototype;i.isConstraint=function(){function t(e,t){return e[0]-t[0]||e[1]-t[1]}var a=[0,0];return function(e,o){return a[0]=ie(e,o),a[1]=va(e,o),0<=r.eq(this.edges,a,t)}}(),i.removeTriangle=function(e,t,a){var r=this.stars;o(r[e],t,a),o(r[t],a,e),o(r[a],e,t)},i.addTriangle=function(e,t,a){var o=this.stars;o[e].push(t,a),o[t].push(a,e),o[a].push(e,t)},i.opposite=function(e,t){for(var a=this.stars[t],o=1,r=a.length;o<r;o+=2)if(a[o]===e)return a[o-1];return-1},i.flip=function(e,t){var o=this.opposite(e,t),a=this.opposite(t,e);this.removeTriangle(e,t,o),this.removeTriangle(t,e,a),this.addTriangle(e,a,o),this.addTriangle(t,o,a)},i.edges=function(){for(var e=this.stars,t=[],a=0,o=e.length,r;a<o;++a){r=e[a];for(var n=0,l=r.length;n<l;n+=2)t.push([r[n],r[n+1]])}return t},i.cells=function(){for(var e=this.stars,a=[],o=0,r=e.length,n;o<r;++o){n=e[o];for(var l=0,d=n.length;l<d;l+=2){var c=n[l],s=n[l+1];o<ie(c,s)&&a.push([o,c,s])}}return a}},{"binary-search-bounds":99}],99:[function(e,t){"use strict";function a(e,t,a,o,r){var i=["function ",e,"(a,l,h,",o.join(","),"){",r?"":"var i=",a?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];return r?0>t.indexOf("c")?i.push(";if(x===y){return m}else if(x<=y){"):i.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):i.push(";if(",t,"){i=m;"),a?i.push("l=m+1}else{h=m-1}"):i.push("h=m-1}else{l=m+1}"),i.push("}"),r?i.push("return -1};"):i.push("return i};"),i.join("")}function o(e,t,o,r){var i=new Function([a("A","x"+e+"y",t,["y"],r),a("P","c(x,y)"+e+"0",t,["y","c"],r),"function dispatchBsearch",o,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",o].join(""));return i()}t.exports={ge:o(">=",!1,"GE"),gt:o(">",!1,"GT"),lt:o("<",!0,"LT"),le:o("<=",!0,"LE"),eq:o("-",!0,"EQ",!0)}},{}],100:[function(e,t){"use strict";t.exports=function(e){for(var t=1,a=1;a<e.length;++a)for(var o=0;o<a;++o)if(e[a]<e[o])t=-t;else if(e[o]===e[a])return 0;return t}},{}],101:[function(e,t){"use strict";function a(e,t){for(var a=0,o=e.length,r=0;r<o;++r)a+=e[r]*t[r];return a}function o(e){var t=e.length;if(0===t)return[];var o=e[0].length,r=n([e.length+1,e.length+1],1),s=n([e.length+1],1);r[t][t]=0;for(var d=0;d<t;++d){for(var c=0;c<=d;++c)r[c][d]=r[d][c]=2*a(e[d],e[c]);s[d]=a(e[d],e[d])}for(var p=l(r,s),u=0,g=p[t+1],d=0;d<g.length;++d)u+=g[d];for(var m=Array(t),d=0;d<t;++d){for(var g=p[d],y=0,c=0;c<g.length;++c)y+=g[c];m[d]=y/u}return m}function r(e){if(0===e.length)return[];for(var t=e[0].length,a=n([t]),r=o(e),l=0;l<e.length;++l)for(var s=0;s<t;++s)a[s]+=e[l][s]*r[l];return a}var n=e("dup"),l=e("robust-linear-solve");r.barycenetric=o,t.exports=r},{dup:155,"robust-linear-solve":485}],102:[function(e,t){t.exports=function(e){for(var t=a(e),o=0,r=0,n;r<e.length;++r){n=e[r];for(var l=0;l<t.length;++l)o+=_a(n[l]-t[l],2)}return re(o/e.length)};var a=e("circumcenter")},{circumcenter:101}],103:[function(e,t){t.exports=function(e,t,a){return t<a?e<t?t:e>a?a:e:e<a?a:e>t?t:e}},{}],104:[function(e,t){"use strict";function a(e){var t=b(e);return[v(t,-Infinity),v(t,1/0)]}function o(t,o){for(var r=Array(o.length),n=0;n<o.length;++n){var l=o[n],e=t[l[0]],a=t[l[1]];r[n]=[v(ie(e[0],a[0]),-Infinity),v(ie(e[1],a[1]),-Infinity),v(va(e[0],a[0]),1/0),v(va(e[1],a[1]),1/0)]}return r}function r(e){for(var t=Array(e.length),a=0,o;a<e.length;++a)o=e[a],t[a]=[v(o[0],-Infinity),v(o[1],-Infinity),v(o[0],1/0),v(o[1],1/0)];return t}function i(t,o,r){var n=[];return m(r,function(r,i){var l=o[r],e=o[i];if(l[0]!==e[0]&&l[0]!==e[1]&&l[1]!==e[0]&&l[1]!==e[1]){var s=t[l[0]],a=t[l[1]],p=t[e[0]],c=t[e[1]];y(s,a,p,c)&&n.push([r,i])}}),n}function n(t,o,r,i){var n=[];return m(r,i,function(r,i){var l=o[r];if(l[0]!==i&&l[1]!==i){var e=t[i],s=t[l[0]],a=t[l[1]];y(s,a,e,e)&&n.push([r,i])}}),n}function l(o,r,n,l,d){var c=o.map(function(e){return[f(e[0]),f(e[1])]}),p,u;for(p=0;p<n.length;++p){var g=n[p];u=g[0];var h=g[1],m=r[u],y=r[h],v=w(_(o[m[0]]),_(o[m[1]]),_(o[y[0]]),_(o[y[1]]));if(v){var k=o.length;o.push([b(v[0]),b(v[1])]),c.push(v),l.push([u,k],[h,k])}}for(l.sort(function(e,t){if(e[0]!==t[0])return e[0]-t[0];var a=c[e[1]],o=c[t[1]];return x(a[0],o[0])||x(a[1],o[1])}),p=l.length-1;0<=p;--p){var T=l[p];u=T[0];var A=r[u],S=A[0],C=A[1],L=o[S],a=o[C];if(0>(L[0]-a[0]||L[1]-a[1])){var E=S;S=C,C=E}A[0]=S;var z=A[1]=T[1],I;for(d&&(I=A[2]);0<p&&l[p-1][0]===u;){var T=l[--p],D=T[1];d?r.push([z,D,I]):r.push([z,D]),z=D}d?r.push([z,C,I]):r.push([z,C])}return c}function s(e,t){for(var o=t.length,r=new h(o),n=[],l=0;l<t.length;++l){var s=t[l],d=a(s[0]),c=a(s[1]);n.push([v(d[0],-Infinity),v(c[0],-Infinity),v(d[1],1/0),v(c[1],1/0)])}m(n,function(e,t){r.link(e,t)});for(var p=!0,u=Array(o),l=0,g;l<o;++l)g=r.find(l),g!==l&&(p=!1,e[g]=[ie(e[l][0],e[g][0]),ie(e[l][1],e[g][1])]);if(p)return null;for(var y=0,l=0,g;l<o;++l)g=r.find(l),g===l?(u[l]=y,e[y++]=e[l]):u[l]=-1;e.length=y;for(var l=0;l<o;++l)0>u[l]&&(u[l]=u[r.find(l)]);return u}function d(e,t){return e[0]-t[0]||e[1]-t[1]}function c(e,t){var a=e[0]-t[0]||e[1]-t[1];if(a)return a;return e[2]<t[2]?-1:e[2]>t[2]?1:0}function p(t,o,r){if(0!==t.length){if(o)for(var n=0;n<t.length;++n){var l=t[n],s=o[l[0]],p=o[l[1]];l[0]=ie(s,p),l[1]=va(s,p)}else for(var n=0;n<t.length;++n){var l=t[n],s=l[0],p=l[1];l[0]=ie(s,p),l[1]=va(s,p)}r?t.sort(c):t.sort(d);for(var u=1,n=1;n<t.length;++n){var g=t[n-1],h=t[n];(h[0]!==g[0]||h[1]!==g[1]||r&&h[2]!==g[2])&&(t[u++]=h)}t.length=u}}function u(e,t,a){var o=s(e,[],r(e));return p(t,o,a),!!o}function g(e,t,a){var d=o(e,t),c=i(e,t,d),u=r(e),g=n(e,t,d,u),h=l(e,t,c,g,a),m=s(e,h,u);return p(t,m,a),!!m||0<c.length||0<g.length}t.exports=function(t,a,o){var r;if(o){r=a;for(var n=Array(a.length),l=0,s;l<a.length;++l)s=a[l],n[l]=[s[0],s[1],o[l]];a=n}for(var d=u(t,a,!!o);g(t,a,!!o);)d=!0;if(!!o&&d){r.length=0,o.length=0;for(var l=0,s;l<a.length;++l)s=a[l],r.push([s[0],s[1]]),o.push(s[2])}return d};var h=e("union-find"),m=e("box-intersect"),y=e("robust-segment-intersect"),f=e("big-rat"),x=e("big-rat/cmp"),b=e("big-rat/to-float"),_=e("rat-vec"),v=e("nextafter"),w=e("./lib/rat-seg-intersect")},{"./lib/rat-seg-intersect":105,"big-rat":66,"big-rat/cmp":64,"big-rat/to-float":78,"box-intersect":84,nextafter:434,"rat-vec":469,"robust-segment-intersect":489,"union-find":522}],105:[function(e,t){"use strict";function o(e,t){return n(r(e[0],t[1]),r(e[1],t[0]))}t.exports=function(e,a,n,c){var d=p(a,e),h=p(c,n),m=o(d,h);if(0===l(m))return null;var y=p(e,n),f=o(h,y),x=i(f,m),t=g(d,x),s=u(e,t);return s};var r=e("big-rat/mul"),i=e("big-rat/div"),n=e("big-rat/sub"),l=e("big-rat/sign"),p=e("rat-vec/sub"),u=e("rat-vec/add"),g=e("rat-vec/muls")},{"big-rat/div":65,"big-rat/mul":75,"big-rat/sign":76,"big-rat/sub":77,"rat-vec/add":468,"rat-vec/muls":470,"rat-vec/sub":471}],106:[function(e,t){"use strict";function a(e,t){null==t&&(t=!0);var i=e[0],l=e[1],s=e[2],d=e[3];null==d&&(d=t?1:255),t&&(i*=255,l*=255,s*=255,d*=255),i=255&o(i,0,255),l=255&o(l,0,255),s=255&o(s,0,255),d=255&o(d,0,255);var c=16777216*i+(l<<16)+(s<<8)+d;return c}var o=e("clamp");t.exports=a,t.exports.to=a,t.exports.from=function(e,t){e=+e;var o=e>>>24,r=(16711680&e)>>>16,i=(65280&e)>>>8,l=255&e;return!1===t?[o,r,i,l]:[o/255,r/255,i/255,l/255]}},{clamp:103}],107:[function(e,t){"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],108:[function(e,t){"use strict";function a(e){return!!(e instanceof Uint8Array||e instanceof Uint8ClampedArray)||!!(Array.isArray(e)&&(1<e[0]||0===e[0])&&(1<e[1]||0===e[1])&&(1<e[2]||0===e[2])&&(!e[3]||1<e[3]))}var o=e("color-rgba"),r=e("clamp"),i=e("dtype");t.exports=function e(t,n){"float"!==n&&n||(n="array"),"uint"===n&&(n="uint8"),"uint_clamped"===n&&(n="uint8_clamped");var l=i(n),s=new l(4),e="uint8"!==n&&"uint8_clamped"!==n;return(t.length&&"string"!=typeof t||(t=o(t),t[0]/=255,t[1]/=255,t[2]/=255),a(t))?(s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=null==t[3]?255:t[3],e&&(s[0]/=255,s[1]/=255,s[2]/=255,s[3]/=255),s):(e?(s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=null==t[3]?1:t[3]):(s[0]=r(ea(255*t[0]),0,255),s[1]=r(ea(255*t[1]),0,255),s[2]=r(ea(255*t[2]),0,255),s[3]=null==t[3]?255:r(ea(255*t[3]),0,255)),s)}},{clamp:103,"color-rgba":110,dtype:154}],109:[function(e,t){(function(a){"use strict";var o=e("color-name"),i=e("is-plain-obj"),n=e("defined");t.exports=function(e){var t=[],s=1,d,c;if("string"==typeof e){if(o[e])t=o[e].slice(),c="rgb";else if("transparent"===e)s=0,c="rgb",t=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(e)){var p=e.slice(1),u=p.length,g=4>=u;s=1,g?(t=[parseInt(p[0]+p[0],16),parseInt(p[1]+p[1],16),parseInt(p[2]+p[2],16)],4===u&&(s=parseInt(p[3]+p[3],16)/255)):(t=[parseInt(p[0]+p[1],16),parseInt(p[2]+p[3],16),parseInt(p[4]+p[5],16)],8===u&&(s=parseInt(p[6]+p[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),c="rgb"}else if(d=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(e)){var h=d[1],p=h.replace(/a$/,"");c=p;var u="cmyk"===p?4:"gray"===p?1:3;t=d[2].trim().split(/\s*,\s*/).map(function(e,t){if(/%$/.test(e))return t===u?parseFloat(e)/100:"rgb"===p?255*parseFloat(e)/100:parseFloat(e);if("h"===p[t]){if(/deg$/.test(e))return parseFloat(e);if(void 0!==l[e])return l[e]}return parseFloat(e)}),h===p&&t.push(1),s=void 0===t[u]?1:t[u],t=t.slice(0,u)}else 10<e.length&&/[0-9](?:\s|\/)/.test(e)&&(t=e.match(/([0-9]+)/g).map(function(e){return parseFloat(e)}),c=e.match(/([a-z])/ig).join("").toLowerCase());}else if(!isNaN(e))c="rgb",t=[e>>>16,(65280&e)>>>8,255&e];else if(i(e)){var y=n(e.r,e.red,e.R,null);null===y?(c="hsl",t=[n(e.h,e.hue,e.H),n(e.s,e.saturation,e.S),n(e.l,e.lightness,e.L,e.b,e.brightness)]):(c="rgb",t=[y,n(e.g,e.green,e.G),n(e.b,e.blue,e.B)]),s=n(e.a,e.alpha,e.opacity,1),null!=e.opacity&&(s/=100)}else(Array.isArray(e)||a.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(e))&&(t=[e[0],e[1],e[2]],c="rgb",s=4===e.length?e[3]:1);return{space:c,values:t,alpha:s}};var l={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"color-name":107,defined:149,"is-plain-obj":405}],110:[function(e,t){"use strict";var a=e("color-parse"),o=e("color-space/hsl"),r=e("clamp");t.exports=function(e){var t=a(e),i;return t.space?(i=[,,,],i[0]=r(t.values[0],0,255),i[1]=r(t.values[1],0,255),i[2]=r(t.values[2],0,255),"h"===t.space[0]&&(i=o.rgb(i)),i.push(r(t.alpha,0,1)),i):[]}},{clamp:103,"color-parse":109,"color-space/hsl":111}],111:[function(e,t){"use strict";var a=e("./rgb");t.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(e){var t=e[0]/360,a=e[1]/100,o=e[2]/100,r,n,l,s,d;if(0==a)return d=255*o,[d,d,d];n=.5>o?o*(1+a):o+a-o*a,r=2*o-n,s=[0,0,0];for(var c=0;3>c;c++)l=t+1/3*-(c-1),0>l?l++:1<l&&l--,d=1>6*l?r+6*(n-r)*l:1>2*l?n:2>3*l?r+6*((n-r)*(2/3-l)):r,s[c]=255*d;return s}},a.hsl=function(e){var t=e[0]/255,a=e[1]/255,o=e[2]/255,r=ie(t,a,o),i=va(t,a,o),n=i-r,d,c,p;return i===r?d=0:t===i?d=(a-o)/n:a===i?d=2+(o-t)/n:o===i&&(d=4+(t-a)/n),d=ie(60*d,360),0>d&&(d+=360),p=(r+i)/2,c=i===r?0:.5>=p?n/(i+r):n/(2-i-r),[d,100*c,100*p]}},{"./rgb":112}],112:[function(e,t){"use strict";t.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],113:[function(e,t){t.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],cool:[{index:0,rgb:[0,255,255]},{index:1,rgb:[255,0,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],114:[function(e,t){"use strict";function a(e){return[e[0]/255,e[1]/255,e[2]/255,e[3]]}function o(e){for(var t="#",a=0,o;3>a;++a)o=e[a],o=o.toString(16),t+=("00"+o).substr(o.length);return t}function r(e){return"rgba("+e.join(",")+")"}var i=e("./colorScale"),n=e("lerp");t.exports=function(e){var t,l,s,d,p,u,g,h,m,y,f;if(e||(e={}),h=(e.nshades||72)-1,g=e.format||"hex",u=e.colormap,u||(u="jet"),"string"==typeof u){if(u=u.toLowerCase(),!i[u])throw Error(u+" not a supported colorscale");p=i[u]}else if(Array.isArray(u))p=u.slice();else throw Error("unsupported colormap option",u);if(p.length>h)throw new Error(u+" map requires nshades to be at least size "+p.length);y=Array.isArray(e.alpha)?2===e.alpha.length?e.alpha.slice():[1,1]:"number"==typeof e.alpha?[e.alpha,e.alpha]:[1,1],t=p.map(function(e){return R(e.index*h)}),y[0]=ie(va(y[0],0),1),y[1]=ie(va(y[1],0),1);var c=p.map(function(e,t){var a=p[t].index,o=p[t].rgb.slice();return 4===o.length&&0<=o[3]&&1>=o[3]?o:(o[3]=y[0]+(y[1]-y[0])*a,o)}),m=[];for(f=0;f<t.length-1;++f){d=t[f+1]-t[f],l=c[f],s=c[f+1];for(var x=0,b;x<d;x++)b=x/d,m.push([R(n(l[0],s[0],b)),R(n(l[1],s[1],b)),R(n(l[2],s[2],b)),n(l[3],s[3],b)])}return m.push(p[p.length-1].rgb.concat(y[1])),"hex"===g?m=m.map(o):"rgbaString"===g?m=m.map(r):"float"===g&&(m=m.map(a)),m}},{"./colorScale":113,lerp:408}],115:[function(e,t){"use strict";function o(e,t,a){var o=n(e[0],-t[0]),r=n(e[1],-t[1]),i=n(a[0],-t[0]),c=n(a[1],-t[1]),p=s(l(o,i),l(r,c));return 0<=p[p.length-1]}t.exports=function(e,t,a,n){var l=r(t,a,n);if(0===l){var s=i(r(e,t,a)),d=i(r(e,t,n));if(s===d){if(0===s){var c=o(e,t,a),p=o(e,t,n);return c===p?0:c?1:-1}return 0}return 0===d?0<s?-1:o(e,t,n)?-1:1:0===s?0<d?1:o(e,t,a)?1:-1:i(d-s)}var u=r(e,t,a);if(0<u)return 0<l&&0<r(e,t,n)?1:-1;if(0>u)return 0<l||0<r(e,t,n)?1:-1;var g=r(e,t,n);return 0<g?1:o(e,t,a)?1:-1};var r=e("robust-orientation"),i=e("signum"),n=e("two-sum"),l=e("robust-product"),s=e("robust-sum")},{"robust-orientation":486,"robust-product":487,"robust-sum":491,signum:492,"two-sum":520}],116:[function(e,t){function o(e,t){return e-t}t.exports=function(e,a){var l=e.length,n=e.length-a.length;if(n)return n;switch(l){case 0:return 0;case 1:return e[0]-a[0];case 2:return e[0]+e[1]-a[0]-a[1]||r(e[0],e[1])-r(a[0],a[1]);case 3:var s=e[0]+e[1],d=a[0]+a[1];if(n=s+e[2]-(d+a[2]),n)return n;var c=r(e[0],e[1]),p=r(a[0],a[1]);return r(c,e[2])-r(p,a[2])||r(c+e[2],s)-r(p+a[2],d);case 4:var u=e[0],g=e[1],h=e[2],m=e[3],y=a[0],f=a[1],x=a[2],b=a[3];return u+g+h+m-(y+f+x+b)||r(u,g,h,m)-r(y,f,x,b,y)||r(u+g,u+h,u+m,g+h,g+m,h+m)-r(y+f,y+x,y+b,f+x,f+b,x+b)||r(u+g+h,u+g+m,u+h+m,g+h+m)-r(y+f+x,y+f+b,y+x+b,f+x+b);default:for(var _=e.slice().sort(o),v=a.slice().sort(o),w=0;w<l;++w)if(n=_[w]-v[w],n)return n;return 0;}};var r=ie},{}],117:[function(e,t){"use strict";var o=e("compare-cell"),r=e("cell-orientation");t.exports=function(e,t){return o(e,t)||r(e)-r(t)}},{"cell-orientation":100,"compare-cell":116}],118:[function(e,t){"use strict";var a=e("./lib/ch1d"),o=e("./lib/ch2d"),r=e("./lib/chnd");t.exports=function(e){var t=e.length;if(0===t)return[];if(1===t)return[[0]];var i=e[0].length;if(0===i)return[];return 1===i?a(e):2===i?o(e):r(e,i)}},{"./lib/ch1d":119,"./lib/ch2d":120,"./lib/chnd":121}],119:[function(e,t){"use strict";t.exports=function(e){for(var t=0,a=0,o=1;o<e.length;++o)e[o][0]<e[t][0]&&(t=o),e[o][0]>e[a][0]&&(a=o);return t<a?[[t],[a]]:t>a?[[a],[t]]:[[t]]}},{}],120:[function(e,t){"use strict";t.exports=function(e){var t=o(e),r=t.length;if(2>=r)return[];for(var n=Array(r),l=t[r-1],s=0,d;s<r;++s)d=t[s],n[s]=[l,d],l=d;return n};var o=e("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":417}],121:[function(e,t){"use strict";function a(e,t){for(var a=e.length,o=Array(a),r=0;r<t.length;++r)o[r]=e[t[r]];for(var n=t.length,r=0;r<a;++r)0>t.indexOf(r)&&(o[n++]=e[r]);return o}function o(e,t){for(var a=e.length,o=t.length,r=0,n;r<a;++r){n=e[r];for(var l=0,s;l<n.length;++l)if(s=n[l],s<o)n[l]=t[s];else{s-=o;for(var d=0;d<o;++d)s>=t[d]&&(s+=1);n[l]=s}}return e}t.exports=function(t,n){try{return r(t,!0)}catch(c){var l=i(t);if(l.length<=n)return[];var s=a(t,l),d=r(s,!0);return o(d,l)}};var r=e("incremental-convex-hull"),i=e("affine-hull")},{"affine-hull":50,"incremental-convex-hull":396}],122:[function(e,t){t.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xE7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xE9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xE9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xE3)o.?tom(e|\xE9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],123:[function(e,t){t.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],124:[function(e,t){t.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],125:[function(e,t){t.exports=["normal","italic","oblique"]},{}],126:[function(e,t){t.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],127:[function(e,t){"use strict";t.exports={parse:e("./parse"),stringify:e("./stringify")}},{"./parse":129,"./stringify":130}],128:[function(e,t){"use strict";var a=e("css-font-size-keywords");t.exports={isSize:function(e){return /^[\d\.]/.test(e)||-1!==e.indexOf("/")||-1!==a.indexOf(e)}}},{"css-font-size-keywords":123}],129:[function(e,t){"use strict";function a(e){if("string"!=typeof e)throw new Error("Font argument must be a string.");if(u[e])return u[e];if(""===e)throw new Error("Cannot parse an empty string.");if(-1!==n.indexOf(e))return u[e]={system:e};for(var t={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},a=c(e,/\s+/),g;g=a.shift();){if(-1!==i.indexOf(g))return["style","variant","weight","stretch"].forEach(function(e){t[e]=g}),u[e]=t;if(-1!==s.indexOf(g)){t.style=g;continue}if("normal"===g||"small-caps"===g){t.variant=g;continue}if(-1!==d.indexOf(g)){t.stretch=g;continue}if(-1!==l.indexOf(g)){t.weight=g;continue}if(p(g)){var h=c(g,"/");if(t.size=h[0],null==h[1]?"/"===a[0]&&(a.shift(),t.lineHeight=o(a.shift())):t.lineHeight=o(h[1]),!a.length)throw new Error("Missing required font-family.");return t.family=c(a.join(" "),/\s*,\s*/).map(r),u[e]=t}throw new Error("Unknown or unsupported font token: "+g)}throw new Error("Missing required font-size.")}function o(e){var t=parseFloat(e);return t.toString()===e?t:e}var r=e("unquote"),i=e("css-global-keywords"),n=e("css-system-font-keywords"),l=e("css-font-weight-keywords"),s=e("css-font-style-keywords"),d=e("css-font-stretch-keywords"),c=e("string-split-by"),p=e("./lib/util").isSize;t.exports=a;var u=a.cache={}},{"./lib/util":128,"css-font-stretch-keywords":124,"css-font-style-keywords":125,"css-font-weight-keywords":126,"css-global-keywords":131,"css-system-font-keywords":132,"string-split-by":505,unquote:524}],130:[function(e,t){"use strict";function a(e,t){if(e&&!t[e]&&!n[e])throw Error("Unknown keyword `"+e+"`");return e}function o(e){for(var t={},a=0;a<e.length;a++)t[e[a]]=1;return t}var r=e("pick-by-alias"),i=e("./lib/util").isSize,n=o(e("css-global-keywords")),l=o(e("css-system-font-keywords")),s=o(e("css-font-weight-keywords")),d=o(e("css-font-style-keywords")),c=o(e("css-font-stretch-keywords")),p={normal:1,"small-caps":1},u={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},g={style:"normal",variant:"normal",weight:"normal",stretch:"normal",size:"1rem",lineHeight:"normal",family:"serif"};t.exports=function(e){if(e=r(e,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"}),e.system)return e.system&&a(e.system,l),e.system;if(a(e.style,d),a(e.variant,p),a(e.weight,s),a(e.stretch,c),null==e.size&&(e.size=g.size),"number"==typeof e.size&&(e.size+="px"),!i)throw Error("Bad size value `"+e.size+"`");e.family||(e.family=g.family),Array.isArray(e.family)&&(!e.family.length&&(e.family=[g.family]),e.family=e.family.map(function(e){return u[e]?e:"\""+e+"\""}).join(", "));var t=[];return t.push(e.style),e.variant!==e.style&&t.push(e.variant),e.weight!==e.variant&&e.weight!==e.style&&t.push(e.weight),e.stretch!==e.weight&&e.stretch!==e.variant&&e.stretch!==e.style&&t.push(e.stretch),t.push(e.size+(null==e.lineHeight||"normal"===e.lineHeight||"1"==e.lineHeight+""?"":"/"+e.lineHeight)),t.push(e.family),t.filter(Boolean).join(" ")}},{"./lib/util":128,"css-font-stretch-keywords":124,"css-font-style-keywords":125,"css-font-weight-keywords":126,"css-global-keywords":131,"css-system-font-keywords":132,"pick-by-alias":448}],131:[function(e,t){t.exports=["inherit","initial","unset"]},{}],132:[function(e,t){t.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],133:[function(e,t){"use strict";t.exports=function(e,a,o,r,n,t){var l=n-1,s=n*n,d=l*l,c=(1+2*n)*d,p=n*d,u=s*(3-2*n),g=s*l;if(e.length){t||(t=Array(e.length));for(var h=e.length-1;0<=h;--h)t[h]=c*e[h]+p*a[h]+u*o[h]+g*r[h];return t}return c*e+p*a+u*o+g*r},t.exports.derivative=function(e,a,o,r,n,t){var l=6*n*n-6*n,s=3*n*n-4*n+1,d=-6*n*n+6*n,c=3*n*n-2*n;if(e.length){t||(t=Array(e.length));for(var p=e.length-1;0<=p;--p)t[p]=l*e[p]+s*a[p]+d*o[p]+c*r[p];return t}return l*e+s*a+d*o[p]+c*r}},{}],134:[function(e,t){"use strict";function a(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}var o=e("./lib/thunk.js");t.exports=function(e){var t=new a;t.pre=e.pre,t.body=e.body,t.post=e.post;var r=e.args.slice(0);t.argTypes=r;for(var n=0,l;n<r.length;++n)if(l=r[n],"array"===l||"object"==typeof l&&l.blockIndices){if(t.argTypes[n]="array",t.arrayArgs.push(n),t.arrayBlockIndices.push(l.blockIndices?l.blockIndices:0),t.shimArgs.push("array"+n),n<t.pre.args.length&&0<t.pre.args[n].count)throw new Error("cwise: pre() block may not reference array args");if(n<t.post.args.length&&0<t.post.args[n].count)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===l)t.scalarArgs.push(n),t.shimArgs.push("scalar"+n);else if("index"===l){if(t.indexArgs.push(n),n<t.pre.args.length&&0<t.pre.args[n].count)throw new Error("cwise: pre() block may not reference array index");if(n<t.body.args.length&&t.body.args[n].lvalue)throw new Error("cwise: body() block may not write to array index");if(n<t.post.args.length&&0<t.post.args[n].count)throw new Error("cwise: post() block may not reference array index")}else if("shape"===l){if(t.shapeArgs.push(n),n<t.pre.args.length&&t.pre.args[n].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(n<t.body.args.length&&t.body.args[n].lvalue)throw new Error("cwise: body() block may not write to array shape");if(n<t.post.args.length&&t.post.args[n].lvalue)throw new Error("cwise: post() block may not write to array shape")}else if("object"==typeof l&&l.offset)t.argTypes[n]="offset",t.offsetArgs.push({array:l.array,offset:l.offset}),t.offsetArgIndex.push(n);else throw new Error("cwise: Unknown argument type "+r[n]);if(0>=t.arrayArgs.length)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>r.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>r.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>r.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,o(t)}},{"./lib/thunk.js":136}],135:[function(e,t){"use strict";function a(e,t,a){var o=e.length,r=t.arrayArgs.length,n=0<t.indexArgs.length,l=[],s=[],d=0,c=0,p,u;for(p=0;p<o;++p)s.push(["i",p,"=0"].join(""));for(u=0;u<r;++u)for(p=0;p<o;++p)c=d,d=e[p],0===p?s.push(["d",u,"s",p,"=t",u,"p",d].join("")):s.push(["d",u,"s",p,"=(t",u,"p",d,"-s",c,"*t",u,"p",c,")"].join(""));for(0<s.length&&l.push("var "+s.join(",")),p=o-1;0<=p;--p)d=e[p],l.push(["for(i",p,"=0;i",p,"<s",d,";++i",p,"){"].join(""));for(l.push(a),p=0;p<o;++p){for(c=d,d=e[p],u=0;u<r;++u)l.push(["p",u,"+=d",u,"s",p].join(""));n&&(0<p&&l.push(["index[",c,"]-=s",c].join("")),l.push(["++index[",d,"]"].join(""))),l.push("}")}return l.join("\n")}function o(e,t,o,r){for(var n=t.length,l=o.arrayArgs.length,s=o.blockSize,d=0<o.indexArgs.length,c=[],p=0;p<l;++p)c.push(["var offset",p,"=p",p].join(""));for(var p=e;p<n;++p)c.push(["for(var j"+p+"=SS[",t[p],"]|0;j",p,">0;){"].join("")),c.push(["if(j",p,"<",s,"){"].join("")),c.push(["s",t[p],"=j",p].join("")),c.push(["j",p,"=0"].join("")),c.push(["}else{s",t[p],"=",s].join("")),c.push(["j",p,"-=",s,"}"].join("")),d&&c.push(["index[",t[p],"]=j",p].join(""));for(var p=0,u;p<l;++p){u=["offset"+p];for(var g=e;g<n;++g)u.push(["j",g,"*t",p,"p",t[g]].join(""));c.push(["p",p,"=(",u.join("+"),")"].join(""))}c.push(a(t,o,r));for(var p=e;p<n;++p)c.push("}");return c.join("\n")}function r(e){for(var t=0,a=e[0].length;t<a;){for(var o=1;o<e.length;++o)if(e[o][t]!==e[0][t])return t;++t}return t}function n(e,t,a){for(var o=e.body,r=[],n=[],l=0,s;l<e.args.length;++l)if(s=e.args[l],!(0>=s.count)){var d=new RegExp(s.name,"g"),c="",p=t.arrayArgs.indexOf(l);switch(t.argTypes[l]){case"offset":var u=t.offsetArgIndex.indexOf(l),g=t.offsetArgs[u];p=g.array,c="+q"+u;case"array":c="p"+p+c;var h="l"+l,m="a"+p;if(0===t.arrayBlockIndices[p])1===s.count?"generic"===a[p]?s.lvalue?(r.push(["var ",h,"=",m,".get(",c,")"].join("")),o=o.replace(d,h),n.push([m,".set(",c,",",h,")"].join(""))):o=o.replace(d,[m,".get(",c,")"].join("")):o=o.replace(d,[m,"[",c,"]"].join("")):"generic"===a[p]?(r.push(["var ",h,"=",m,".get(",c,")"].join("")),o=o.replace(d,h),s.lvalue&&n.push([m,".set(",c,",",h,")"].join(""))):(r.push(["var ",h,"=",m,"[",c,"]"].join("")),o=o.replace(d,h),s.lvalue&&n.push([m,"[",c,"]=",h].join("")));else{for(var y=[s.name],f=[c],x=0;x<wa(t.arrayBlockIndices[p]);x++)y.push("\\s*\\[([^\\]]+)\\]"),f.push("$"+(x+1)+"*t"+p+"b"+x);if(d=new RegExp(y.join(""),"g"),c=f.join("+"),"generic"===a[p])throw new Error("cwise: Generic arrays not supported in combination with blocks!");else o=o.replace(d,[m,"[",c,"]"].join(""))}break;case"scalar":o=o.replace(d,"Y"+t.scalarArgs.indexOf(l));break;case"index":o=o.replace(d,"index");break;case"shape":o=o.replace(d,"shape");}}return[r.join("\n"),o,n.join("\n")].join("\n").trim()}function l(e){for(var a=Array(e.length),o=!0,r=0;r<e.length;++r){var n=e[r],t=n.match(/\d+/);t=t?t[0]:"",a[r]=0===n.charAt(0)?"u"+n.charAt(1)+t:n.charAt(0)+t,0<r&&(o=o&&a[r]===a[r-1])}return o?a[0]:a.join("")}var s=e("uniq");t.exports=function(e,t){for(var d=0|t[1].length-wa(e.arrayBlockIndices[0]),c=Array(e.arrayArgs.length),p=Array(e.arrayArgs.length),u=0;u<e.arrayArgs.length;++u)p[u]=t[2*u],c[u]=t[2*u+1];for(var g=[],h=[],m=[],y=[],x=[],u=0;u<e.arrayArgs.length;++u){0>e.arrayBlockIndices[u]?(m.push(0),y.push(d),g.push(d),h.push(d+e.arrayBlockIndices[u])):(m.push(e.arrayBlockIndices[u]),y.push(e.arrayBlockIndices[u]+d),g.push(0),h.push(e.arrayBlockIndices[u]));for(var b=[],_=0;_<c[u].length;_++)m[u]<=c[u][_]&&c[u][_]<y[u]&&b.push(c[u][_]-m[u]);x.push(b)}for(var v=["SS"],w=["'use strict'"],k=[],_=0;_<d;++_)k.push(["s",_,"=SS[",_,"]"].join(""));for(var u=0;u<e.arrayArgs.length;++u){v.push("a"+u),v.push("t"+u),v.push("p"+u);for(var _=0;_<d;++_)k.push(["t",u,"p",_,"=t",u,"[",m[u]+_,"]"].join(""));for(var _=0;_<wa(e.arrayBlockIndices[u]);++_)k.push(["t",u,"b",_,"=t",u,"[",g[u]+_,"]"].join(""))}for(var u=0;u<e.scalarArgs.length;++u)v.push("Y"+u);if(0<e.shapeArgs.length&&k.push("shape=SS.slice(0)"),0<e.indexArgs.length){for(var T=Array(d),u=0;u<d;++u)T[u]="0";k.push(["index=[",T.join(","),"]"].join(""))}for(var u=0;u<e.offsetArgs.length;++u){for(var A=e.offsetArgs[u],S=[],_=0;_<A.offset.length;++_)if(0===A.offset[_])continue;else 1===A.offset[_]?S.push(["t",A.array,"p",_].join("")):S.push([A.offset[_],"*t",A.array,"p",_].join(""));0===S.length?k.push("q"+u+"=0"):k.push(["q",u,"=",S.join("+")].join(""))}var C=s([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));k=k.concat(C),0<k.length&&w.push("var "+k.join(","));for(var u=0;u<e.arrayArgs.length;++u)w.push("p"+u+"|=0");3<e.pre.body.length&&w.push(n(e.pre,e,p));var L=n(e.body,e,p),E=r(x);E<d?w.push(o(E,x[0],e,L)):w.push(a(x[0],e,L)),3<e.post.body.length&&w.push(n(e.post,e,p)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+w.join("\n")+"\n----------");var z=[e.funcName||"unnamed","_cwise_loop_",c[0].join("s"),"m",E,l(p)].join(""),I=new Function(["function ",z,"(",v.join(","),"){",w.join("\n"),"} return ",z].join(""));return I()}},{uniq:523}],136:[function(e,t){"use strict";var a=e("./compile.js");t.exports=function(e){var t=["'use strict'","var CACHED={}"],o=[],r=e.funcName+"_cwise_thunk";t.push(["return function ",r,"(",e.shimArgs.join(","),"){"].join(""));for(var n=[],l=[],s=[["array",e.arrayArgs[0],".shape.slice(",va(0,e.arrayBlockIndices[0]),0>e.arrayBlockIndices[0]?","+e.arrayBlockIndices[0]+")":")"].join("")],d=[],c=[],p=0,u;p<e.arrayArgs.length;++p)u=e.arrayArgs[p],o.push(["t",u,"=array",u,".dtype,","r",u,"=array",u,".order"].join("")),n.push("t"+u),n.push("r"+u),l.push("t"+u),l.push("r"+u+".join()"),s.push("array"+u+".data"),s.push("array"+u+".stride"),s.push("array"+u+".offset|0"),0<p&&(d.push("array"+e.arrayArgs[0]+".shape.length===array"+u+".shape.length+"+(wa(e.arrayBlockIndices[0])-wa(e.arrayBlockIndices[p]))),c.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+va(0,e.arrayBlockIndices[0])+"]===array"+u+".shape[shapeIndex+"+va(0,e.arrayBlockIndices[p])+"]"));1<e.arrayArgs.length&&(t.push("if (!("+d.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+wa(e.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),t.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}"));for(var p=0;p<e.scalarArgs.length;++p)s.push("scalar"+e.scalarArgs[p]);o.push(["type=[",l.join(","),"].join()"].join("")),o.push("proc=CACHED[type]"),t.push("var "+o.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",n.join(","),"])}","return proc(",s.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------");var g=new Function("compile",t.join("\n"));return g(a.bind(void 0,e))}},{"./compile.js":135}],137:[function(e,t){t.exports=e("cwise-compiler")},{"cwise-compiler":134}],138:[function(e,t){"use strict";var a=e("es5-ext/object/copy"),o=e("es5-ext/object/normalize-options"),r=e("es5-ext/object/valid-callable"),i=e("es5-ext/object/map"),n=e("es5-ext/object/valid-callable"),l=e("es5-ext/object/valid-value"),s=Function.prototype.bind,d=Object.defineProperty,c=Object.prototype.hasOwnProperty,p;p=function(e,t,o){var r=l(t)&&n(t.value),i;return i=a(t),delete i.writable,delete i.value,i.get=function(){return!o.overwriteDefinition&&c.call(this,e)?r:(t.value=s.call(r,o.resolveContext?o.resolveContext(this):this),d(this,e,t),this[e])},i},t.exports=function(e){var t=o(arguments[1]);return null!=t.resolveContext&&r(t.resolveContext),i(e,function(e,a){return p(a,e,t)})}},{"es5-ext/object/copy":174,"es5-ext/object/map":183,"es5-ext/object/normalize-options":184,"es5-ext/object/valid-callable":188,"es5-ext/object/valid-value":190}],139:[function(e,t){"use strict";var a=e("es5-ext/object/assign"),o=e("es5-ext/object/normalize-options"),r=e("es5-ext/object/is-callable"),i=e("es5-ext/string/#/contains"),n;n=t.exports=function(t,r){var n,l,s,d,p;return 2>arguments.length||"string"!=typeof t?(d=r,r=t,t=null):d=arguments[2],null==t?(n=s=!0,l=!1):(n=i.call(t,"c"),l=i.call(t,"e"),s=i.call(t,"w")),p={value:r,configurable:n,enumerable:l,writable:s},d?a(o(d),p):p},n.gs=function(t,n,l){var s,d,p,u;return"string"==typeof t?p=arguments[3]:(p=l,l=n,n=t,t=null),null==n?n=void 0:r(n)?null==l?l=void 0:!r(l)&&(p=l,l=void 0):(p=n,n=l=void 0),null==t?(s=!0,d=!1):(s=i.call(t,"c"),d=i.call(t,"e")),u={get:n,set:l,configurable:s,enumerable:d},p?a(o(p),u):u}},{"es5-ext/object/assign":171,"es5-ext/object/is-callable":177,"es5-ext/object/normalize-options":184,"es5-ext/string/#/contains":191}],140:[function(e,t,a){(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof Ca&&Ca.amd?Ca(["exports"],o):o(e.d3=e.d3||{})})(this,function(e){"use strict";function t(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function a(e){return 1===e.length&&(e=o(e)),{left:function(t,a,o,r){for(null==o&&(o=0),null==r&&(r=t.length);o<r;){var i=o+r>>>1;0>e(t[i],a)?o=i+1:r=i}return o},right:function(t,a,o,r){for(null==o&&(o=0),null==r&&(r=t.length);o<r;){var i=o+r>>>1;0<e(t[i],a)?r=i:o=i+1}return o}}}function o(e){return function(a,o){return t(e(a),o)}}function r(e,t){null==t&&(t=l);for(var a=0,o=e.length-1,r=e[0],n=Array(0>o?0:o);a<o;)n[a]=t(r,r=e[++a]);return n}function l(e,t){return[e,t]}function s(e){return null===e?NaN:+e}function d(e,t){var a=e.length,o=0,r=-1,n=0,l=0,d,c;if(null==t)for(;++r<a;)isNaN(d=s(e[r]))||(c=d-n,n+=c/++o,l+=c*(d-n));else for(;++r<a;)isNaN(d=s(t(e[r],r,e)))||(c=d-n,n+=c/++o,l+=c*(d-n));return 1<o?l/(o-1):void 0}function c(e,t){var a=d(e,t);return a?re(a):a}function p(e,t){var a=e.length,o=-1,r,n,l;if(null==t){for(;++o<a;)if(null!=(r=e[o])&&r>=r)for(n=l=r;++o<a;)null!=(r=e[o])&&(n>r&&(n=r),l<r&&(l=r));}else for(;++o<a;)if(null!=(r=t(e[o],o,e))&&r>=r)for(n=l=r;++o<a;)null!=(r=t(e[o],o,e))&&(n>r&&(n=r),l<r&&(l=r));return[n,l]}function u(e){return function(){return e}}function g(e){return e}function h(e,t,a){e=+e,t=+t,a=2>(r=arguments.length)?(t=e,e=0,1):3>r?1:+a;for(var o=-1,r=0|va(0,ae((t-e)/a)),l=Array(r);++o<r;)l[o]=e+o*a;return l}function m(e,t,a){var o=-1,r,l,s,d;if(t=+t,e=+e,a=+a,e===t&&0<a)return[e];if((r=t<e)&&(l=e,e=t,t=l),0===(d=y(e,t,a))||!isFinite(d))return[];if(0<d)for(e=ae(e/d),t=ea(t/d),s=Array(l=ae(t-e+1));++o<l;)s[o]=(e+o)*d;else for(e=ea(e*d),t=ae(t*d),s=Array(l=ae(e-t+1));++o<l;)s[o]=(e-o)/d;return r&&s.reverse(),s}function y(e,t,a){var o=(t-e)/va(0,a),r=ea(P(o)/z),n=o/_a(10,r);return 0<=r?(n>=R?10:n>=M?5:n>=i?2:1)*_a(10,r):-_a(10,-r)/(n>=R?10:n>=M?5:n>=i?2:1)}function f(e,t,a){var o=wa(t-e)/va(0,a),r=_a(10,ea(P(o)/z)),n=o/r;return n>=R?r*=10:n>=M?r*=5:n>=i&&(r*=2),t<e?-r:r}function x(e){return ae(P(e.length)/E)+1}function b(){function e(e){var r=e.length,n=Array(r),l,s;for(l=0;l<r;++l)n[l]=t(e[l],l,e);var d=a(n),c=d[0],p=d[1],u=o(n,c,p);Array.isArray(u)||(u=f(c,p,u),u=h(ae(c/u)*u,p,u));for(var g=u.length;u[0]<=c;)u.shift(),--g;for(;u[g-1]>p;)u.pop(),--g;var y=Array(g+1),b;for(l=0;l<=g;++l)b=y[l]=[],b.x0=0<l?u[l-1]:c,b.x1=l<g?u[l]:p;for(l=0;l<r;++l)s=n[l],c<=s&&s<=p&&y[C(u,s,0,g)].push(e[l]);return y}var t=g,a=p,o=x;return e.value=function(a){return arguments.length?(t="function"==typeof a?a:u(a),e):t},e.domain=function(t){return arguments.length?(a="function"==typeof t?t:u([t[0],t[1]]),e):a},e.thresholds=function(t){return arguments.length?(o="function"==typeof t?t:Array.isArray(t)?u(D.call(t)):u(t),e):o},e}function _(e,t,a){if(null==a&&(a=s),!!(d=e.length)){if(0>=(t=+t)||2>d)return+a(e[0],0,e);if(1<=t)return+a(e[d-1],d-1,e);var o=(d-1)*t,r=ea(o),i=+a(e[r],r,e),l=+a(e[r+1],r+1,e),d;return i+(l-i)*(o-r)}}function v(e,t){var a=e.length,o=-1,r,n;if(null==t){for(;++o<a;)if(null!=(r=e[o])&&r>=r)for(n=r;++o<a;)null!=(r=e[o])&&r>n&&(n=r);}else for(;++o<a;)if(null!=(r=t(e[o],o,e))&&r>=r)for(n=r;++o<a;)null!=(r=t(e[o],o,e))&&r>n&&(n=r);return n}function w(e,t){var a=e.length,o=-1,r,n;if(null==t){for(;++o<a;)if(null!=(r=e[o])&&r>=r)for(n=r;++o<a;)null!=(r=e[o])&&n>r&&(n=r);}else for(;++o<a;)if(null!=(r=t(e[o],o,e))&&r>=r)for(n=r;++o<a;)null!=(r=t(e[o],o,e))&&n>r&&(n=r);return n}function k(e,t){var a=e.length,o=-1,r=0,n;if(null==t)for(;++o<a;)(n=+e[o])&&(r+=n);else for(;++o<a;)(n=+t(e[o],o,e))&&(r+=n);return r}function T(e){if(!(s=e.length))return[];for(var t=-1,a=w(e,A),o=Array(a);++t<a;)for(var r=-1,l=o[t]=Array(s),s;++r<s;)l[r]=e[r][t];return o}function A(e){return e.length}var S=a(t),C=S.right,L=S.left,I=Array.prototype,D=I.slice,O=I.map,R=re(50),M=re(10),i=re(2);e.bisect=C,e.bisectRight=C,e.bisectLeft=L,e.ascending=t,e.bisector=a,e.cross=function(e,t,a){var o=e.length,r=t.length,n=Array(o*r),s,d,c,p;for(null==a&&(a=l),s=c=0;s<o;++s)for(p=e[s],d=0;d<r;++d,++c)n[c]=a(p,t[d]);return n},e.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},e.deviation=c,e.extent=p,e.histogram=b,e.thresholdFreedmanDiaconis=function(e,a,o){return e=O.call(e,s).sort(t),ae((o-a)/(2*(_(e,.75)-_(e,.25))*_a(e.length,-1/3)))},e.thresholdScott=function(e,t,a){return ae((a-t)/(3.5*c(e)*_a(e.length,-1/3)))},e.thresholdSturges=x,e.max=v,e.mean=function(e,t){var a=e.length,o=a,r=-1,n=0,l;if(null==t)for(;++r<a;)isNaN(l=s(e[r]))?--o:n+=l;else for(;++r<a;)isNaN(l=s(t(e[r],r,e)))?--o:n+=l;return o?n/o:void 0},e.median=function(e,a){var o=e.length,r=-1,n=[],l;if(null==a)for(;++r<o;)isNaN(l=s(e[r]))||n.push(l);else for(;++r<o;)isNaN(l=s(a(e[r],r,e)))||n.push(l);return _(n.sort(t),.5)},e.merge=function(e){for(var t=e.length,a=-1,o=0,r,l,s;++a<t;)o+=e[a].length;for(l=Array(o);0<=--t;)for(s=e[t],r=s.length;0<=--r;)l[--o]=s[r];return l},e.min=w,e.pairs=r,e.permute=function(e,t){for(var a=t.length,o=Array(a);a--;)o[a]=e[t[a]];return o},e.quantile=_,e.range=h,e.scan=function(e,a){if(s=e.length){var o=0,r=0,l=e[r],s,d;for(null==a&&(a=t);++o<s;)(0>a(d=e[o],l)||0!==a(l,l))&&(l=d,r=o);if(0===a(l,l))return r}},e.shuffle=function(e,a,o){for(var r=(null==o?e.length:o)-(a=null==a?0:+a),n,l;r;)l=0|Math.random()*r--,n=e[r+a],e[r+a]=e[l+a],e[l+a]=n;return e},e.sum=k,e.ticks=m,e.tickIncrement=y,e.tickStep=f,e.transpose=T,e.variance=d,e.zip=function(){return T(arguments)},Object.defineProperty(e,"__esModule",{value:!0})})},{}],141:[function(e,t,a){(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof Ca&&Ca.amd?Ca(["exports"],o):o(e.d3=e.d3||{})})(this,function(e){"use strict";function t(){}function a(e,a){var r=new t;if(e instanceof t)e.each(function(e,t){r.set(t,e)});else if(Array.isArray(e)){var l=-1,s=e.length,n;if(null==a)for(;++l<s;)r.set(l,e[l]);else for(;++l<s;)r.set(a(n=e[l],l,e),n)}else if(e)for(var d in e)r.set(d,e[d]);return r}function o(){return{}}function r(e,t,a){e[t]=a}function i(){return a()}function n(e,t,a){e.set(t,a)}function l(){}function s(e,t){var a=new l;if(e instanceof l)e.each(function(e){a.add(e)});else if(e){var o=-1,r=e.length;if(null==t)for(;++o<r;)a.add(e[o]);else for(;++o<r;)a.add(t(e[o],o,e))}return a}t.prototype=a.prototype={constructor:t,has:function(e){return"$"+e in this},get:function(e){return this["$"+e]},set:function(e,t){return this["$"+e]=t,this},remove:function(e){var t="$"+e;return t in this&&delete this[t]},clear:function(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)"$"===t[0]&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)"$"===t[0]&&++e;return e},empty:function(){for(var e in this)if(e[0]==="$")return!1;return!0},each:function(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var d=a.prototype;l.prototype=s.prototype={constructor:l,has:d.has,add:function(e){return e+="",this["$"+e]=e,this},remove:d.remove,clear:d.clear,values:d.keys,size:d.size,empty:d.empty,each:d.each};e.nest=function(){function e(t,o,r,s){if(o>=l.length)return null!=d&&t.sort(d),null==c?t:c(t);for(var p=-1,u=t.length,n=l[o++],g=a(),h=r(),m,y,f;++p<u;)(f=g.get(m=n(y=t[p])+""))?f.push(y):g.set(m,[y]);return g.each(function(t,a){s(h,a,e(t,o,r,s))}),h}function t(e,a){if(++a>l.length)return e;var o=s[a-1],r;return null!=c&&a>=l.length?r=e.entries():(r=[],e.each(function(e,o){r.push({key:o,values:t(e,a)})})),null==o?r:r.sort(function(e,t){return o(e.key,t.key)})}var l=[],s=[],d,c,p;return p={object:function(t){return e(t,0,o,r)},map:function(t){return e(t,0,i,n)},entries:function(a){return t(e(a,0,i,n),0)},key:function(e){return l.push(e),p},sortKeys:function(e){return s[l.length-1]=e,p},sortValues:function(e){return d=e,p},rollup:function(e){return c=e,p}}},e.set=s,e.map=a,e.keys=function(e){var t=[];for(var a in e)t.push(a);return t},e.values=function(e){var t=[];for(var a in e)t.push(e[a]);return t},e.entries=function(e){var t=[];for(var a in e)t.push({key:a,value:e[a]});return t},Object.defineProperty(e,"__esModule",{value:!0})})},{}],142:[function(e,t,a){(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof Ca&&Ca.amd?Ca(["exports"],o):o(e.d3=e.d3||{})})(this,function(e){"use strict";function t(e,t,a){e.prototype=t.prototype=a,a.constructor=e}function a(e,t){var a=Object.create(e.prototype);for(var o in t)a[o]=t[o];return a}function i(){}function n(e){var t;return e=(e+"").trim().toLowerCase(),(t=W.exec(e))?(t=parseInt(t[1],16),new p(15&t>>8|240&t>>4,15&t>>4|240&t,(15&t)<<4|15&t,1)):(t=X.exec(e))?l(parseInt(t[1],16)):(t=Z.exec(e))?new p(t[1],t[2],t[3],1):(t=$.exec(e))?new p(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=J.exec(e))?s(t[1],t[2],t[3],t[4]):(t=Q.exec(e))?s(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=ee.exec(e))?g(t[1],t[2]/100,t[3]/100,1):(t=ae.exec(e))?g(t[1],t[2]/100,t[3]/100,t[4]):oe.hasOwnProperty(e)?l(oe[e]):"transparent"===e?new p(NaN,NaN,NaN,0):null}function l(e){return new p(255&e>>16,255&e>>8,255&e,1)}function s(e,t,o,i){return 0>=i&&(e=t=o=NaN),new p(e,t,o,i)}function d(e){return(e instanceof i||(e=n(e)),!e)?new p:(e=e.rgb(),new p(e.r,e.g,e.b,e.opacity))}function c(e,t,a,o){return 1===arguments.length?d(e):new p(e,t,a,null==o?1:o)}function p(e,t,a,o){this.r=+e,this.g=+t,this.b=+a,this.opacity=+o}function u(e){return e=va(0,ie(255,R(e)||0)),(16>e?"0":"")+e.toString(16)}function g(e,t,o,r){return 0>=r?e=t=o=NaN:0>=o||1<=o?e=t=NaN:0>=t&&(e=NaN),new f(e,t,o,r)}function m(e){if(e instanceof f)return new f(e.h,e.s,e.l,e.opacity);if(e instanceof i||(e=n(e)),!e)return new f;if(e instanceof f)return e;e=e.rgb();var t=e.r/255,a=e.g/255,r=e.b/255,d=ie(t,a,r),c=va(t,a,r),p=NaN,u=c-d,g=(c+d)/2;return u?(p=t===c?(a-r)/u+6*(a<r):a===c?(r-t)/u+2:(t-a)/u+4,u/=.5>g?c+d:2-c-d,p*=60):u=0<g&&1>g?0:p,new f(p,u,g,e.opacity)}function y(e,t,a,o){return 1===arguments.length?m(e):new f(e,t,a,null==o?1:o)}function f(e,t,a,o){this.h=+e,this.s=+t,this.l=+a,this.opacity=+o}function x(e,t,a){return 255*(60>e?t+(a-t)*e/60:180>e?a:240>e?t+(a-t)*(240-e)/60:t)}function _(e){if(e instanceof w)return new w(e.l,e.a,e.b,e.opacity);if(e instanceof j){if(isNaN(e.h))return new w(e.l,0,0,e.opacity);var t=e.h*ne;return new w(e.l,te(t)*e.c,M(t)*e.c,e.opacity)}e instanceof p||(e=d(e));var a=I(e.r),r=I(e.g),i=I(e.b),n=k((.2225045*a+.7168786*r+.0606169*i)/1),l,s;return a===r&&r===i?l=s=n:(l=k((.4360747*a+.3850649*r+.1430804*i)/K),s=k((.0139322*a+.0971045*r+.7141733*i)/de)),new w(116*n-16,500*(l-n),200*(n-s),e.opacity)}function v(e,t,a,o){return 1===arguments.length?_(e):new w(e,t,a,null==o?1:o)}function w(e,t,a,o){this.l=+e,this.a=+t,this.b=+a,this.opacity=+o}function k(e){return e>b?_a(e,1/3):e/h+o}function T(e){return e>r?e*e*e:h*(e-o)}function S(e){return 255*(.0031308>=e?12.92*e:1.055*_a(e,1/2.4)-.055)}function I(e){return .04045>=(e/=255)?e/12.92:_a((e+.055)/1.055,2.4)}function P(e){if(e instanceof j)return new j(e.h,e.c,e.l,e.opacity);if(e instanceof w||(e=_(e)),0===e.a&&0===e.b)return new j(NaN,0,e.l,e.opacity);var t=L(e.b,e.a)*le;return new j(0>t?t+360:t,re(e.a*e.a+e.b*e.b),e.l,e.opacity)}function O(e,t,a,o){return 1===arguments.length?P(e):new j(e,t,a,null==o?1:o)}function j(e,t,a,o){this.h=+e,this.c=+t,this.l=+a,this.opacity=+o}function F(e){if(e instanceof V)return new V(e.h,e.s,e.l,e.opacity);e instanceof p||(e=d(e));var t=e.r/255,a=e.g/255,r=e.b/255,i=(pe*r+E*t-ce*a)/(pe+E-ce),n=r-i,l=(D*(a-i)-B*n)/C,c=re(l*l+n*n)/(D*i*(1-i)),s=c?L(l,n)*le-120:NaN;return new V(0>s?s+360:s,c,i,e.opacity)}function N(e,t,a,o){return 1===arguments.length?F(e):new V(e,t,a,null==o?1:o)}function V(e,t,a,o){this.h=+e,this.s=+t,this.l=+a,this.opacity=+o}var U=.7,H=1/U,G="\\s*([+-]?\\d+)\\s*",Y="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",q="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",W=/^#([0-9a-f]{3})$/,X=/^#([0-9a-f]{6})$/,Z=new RegExp("^rgb\\("+[G,G,G]+"\\)$"),$=new RegExp("^rgb\\("+[q,q,q]+"\\)$"),J=new RegExp("^rgba\\("+[G,G,G,Y]+"\\)$"),Q=new RegExp("^rgba\\("+[q,q,q,Y]+"\\)$"),ee=new RegExp("^hsl\\("+[Y,q,q]+"\\)$"),ae=new RegExp("^hsla\\("+[Y,q,q,Y]+"\\)$"),oe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};t(i,n,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),t(p,c,a(i,{brighter:function(e){return e=null==e?H:_a(H,e),new p(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?U:_a(U,e),new p(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&255>=this.r&&0<=this.g&&255>=this.g&&0<=this.b&&255>=this.b&&0<=this.opacity&&1>=this.opacity},hex:function(){return"#"+u(this.r)+u(this.g)+u(this.b)},toString:function(){var e=this.opacity;return e=isNaN(e)?1:va(0,ie(1,e)),(1===e?"rgb(":"rgba(")+va(0,ie(255,R(this.r)||0))+", "+va(0,ie(255,R(this.g)||0))+", "+va(0,ie(255,R(this.b)||0))+(1===e?")":", "+e+")")}})),t(f,y,a(i,{brighter:function(e){return e=null==e?H:_a(H,e),new f(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?U:_a(U,e),new f(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(0>this.h),t=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,o=a+(.5>a?a:1-a)*t,r=2*a-o;return new p(x(240<=e?e-240:e+120,r,o),x(e,r,o),x(120>e?e+240:e-120,r,o),this.opacity)},displayable:function(){return(0<=this.s&&1>=this.s||isNaN(this.s))&&0<=this.l&&1>=this.l&&0<=this.opacity&&1>=this.opacity}}));var ne=Sa/180,le=180/Sa,se=18,K=.96422,de=.82521,o=4/29,r=6/29,h=3*r*r,b=r*r*r;t(w,v,a(i,{brighter:function(e){return new w(this.l+se*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new w(this.l-se*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,a=isNaN(this.b)?e:e-this.b/200;return t=K*T(t),e=1*T(e),a=de*T(a),new p(S(3.1338561*t-1.6168667*e-.4906146*a),S(-.9787684*t+1.9161415*e+.033454*a),S(.0719453*t-.2289914*e+1.4052427*a),this.opacity)}})),t(j,O,a(i,{brighter:function(e){return new j(this.h,this.c,this.l+se*(null==e?1:e),this.opacity)},darker:function(e){return new j(this.h,this.c,this.l-se*(null==e?1:e),this.opacity)},rgb:function(){return _(this).rgb()}}));var z=-.14861,A=+1.78277,B=-.29227,C=-.90649,D=+1.97294,E=D*C,ce=D*A,pe=A*B-C*z;t(V,N,a(i,{brighter:function(e){return e=null==e?H:_a(H,e),new V(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?U:_a(U,e),new V(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*ne,t=+this.l,o=isNaN(this.s)?0:this.s*t*(1-t),a=te(e),r=M(e);return new p(255*(t+o*(z*a+A*r)),255*(t+o*(B*a+C*r)),255*(t+o*(D*a)),this.opacity)}})),e.color=n,e.rgb=c,e.hsl=y,e.lab=v,e.hcl=O,e.lch=function(e,t,a,o){return 1===arguments.length?P(e):new j(a,t,e,null==o?1:o)},e.gray=function(e,t){return new w(e,0,0,null==t?1:t)},e.cubehelix=N,Object.defineProperty(e,"__esModule",{value:!0})})},{}],143:[function(e,t,a){(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof Ca&&Ca.amd?Ca(["exports"],o):o(e.d3=e.d3||{})})(this,function(e){"use strict";function t(){for(var e=0,o=arguments.length,r={},n;e<o;++e){if(!(n=arguments[e]+"")||n in r)throw new Error("illegal type: "+n);r[n]=[]}return new a(r)}function a(e){this._=e}function o(e,a){return e.trim().split(/^|\s+/).map(function(e){var o="",r=e.indexOf(".");if(0<=r&&(o=e.slice(r+1),e=e.slice(0,r)),e&&!a.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:o}})}function r(e,t){for(var a=0,o=e.length,r;a<o;++a)if((r=e[a]).name===t)return r.value}function l(e,t,a){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=s,e=e.slice(0,o).concat(e.slice(o+1));break}return null!=a&&e.push({name:t,value:a}),e}var s={value:function(){}};a.prototype=t.prototype={constructor:a,on:function(e,a){var s=this._,d=o(e+"",s),c=-1,p=d.length,n;if(2>arguments.length){for(;++c<p;)if((n=(e=d[c]).type)&&(n=r(s[n],e.name)))return n;return}if(null!=a&&"function"!=typeof a)throw new Error("invalid callback: "+a);for(;++c<p;)if(n=(e=d[c]).type)s[n]=l(s[n],e.name,a);else if(null==a)for(n in s)s[n]=l(s[n],e.name,null);return this},copy:function(){var e={},o=this._;for(var r in o)e[r]=o[r].slice();return new a(e)},call:function(e,a){if(0<(l=arguments.length-2))for(var o=Array(l),r=0,l,s;r<l;++r)o[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,l=s.length;r<l;++r)s[r].value.apply(a,o)},apply:function(e,a,o){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],t=0,l=r.length;t<l;++t)r[t].value.apply(a,o)}},e.dispatch=t,Object.defineProperty(e,"__esModule",{value:!0})})},{}],144:[function(e,t,a){(function(o,r){"object"==typeof a&&"undefined"!=typeof t?r(a,e("d3-quadtree"),e("d3-collection"),e("d3-dispatch"),e("d3-timer")):"function"==typeof Ca&&Ca.amd?Ca(["exports","d3-quadtree","d3-collection","d3-dispatch","d3-timer"],r):r(o.d3=o.d3||{},o.d3,o.d3,o.d3,o.d3)})(this,function(e,t,a,o,r){"use strict";function l(e){return e.x+e.vx}function s(e){return e.y+e.vy}function i(e){return e.index}function d(e,t){var a=e.get(t);if(!a)throw new Error("missing: "+t);return a}function c(e){return e.x}function p(e){return e.y}var u=function(e){return function(){return e}},g=function(){return 1e-6*(Math.random()-.5)},h=Sa*(3-re(5));e.forceCenter=function(e,t){function a(){var a=o.length,r=0,n=0,l,s;for(l=0;l<a;++l)s=o[l],r+=s.x,n+=s.y;for(r=r/a-e,n=n/a-t,l=0;l<a;++l)s=o[l],s.x-=r,s.y-=n}var o;return null==e&&(e=0),null==t&&(t=0),a.initialize=function(e){o=e},a.x=function(t){return arguments.length?(e=+t,a):e},a.y=function(e){return arguments.length?(t=+e,a):t},a},e.forceCollide=function(e){function a(){function e(e,t,a,o,n){var s=e.data,d=e.r,c=b+d;if(s){if(s.index>h.index){var p=m-s.x-s.vx,u=f-s.y-s.vy,v=p*p+u*u;v<c*c&&(0===p&&(p=g(),v+=p*p),0===u&&(u=g(),v+=u*u),v=(c-(v=re(v)))/v*i,h.vx+=(p*=v)*(c=(d*=d)/(_+d)),h.vy+=(u*=v)*c,s.vx-=p*(c=1-c),s.vy-=u*c)}return}return t>m+c||o<m-c||a>f+c||n<f-c}for(var a=c.length,r=0,n,u,h,m,f,b,_;r<d;++r)for(u=t.quadtree(c,l,s).visitAfter(o),n=0;n<a;++n)h=c[n],b=p[h.index],_=b*b,m=h.x+h.vx,f=h.y+h.vy,u.visit(e)}function o(e){if(e.data)return e.r=p[e.data.index];for(var t=e.r=0;4>t;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function r(){if(c){var t=c.length,a,o;for(p=Array(t),a=0;a<t;++a)o=c[a],p[o.index]=+e(o,a,c)}}var i=1,d=1,c,p;return"function"!=typeof e&&(e=u(null==e?1:+e)),a.initialize=function(e){c=e,r()},a.iterations=function(e){return arguments.length?(d=+e,a):d},a.strength=function(e){return arguments.length?(i=+e,a):i},a.radius=function(t){return arguments.length?(e="function"==typeof t?t:u(+t),r(),a):e},a},e.forceLink=function(e){function t(e){return 1/ie(w[e.source.index],w[e.target.index])}function o(t){for(var a=0,o=e.length;a<m;++a)for(var r=0,n,s,d,c,p,u,h;r<o;++r)n=e[r],s=n.source,d=n.target,c=d.x+d.vx-s.x-s.vx||g(),p=d.y+d.vy-s.y-s.vy||g(),u=re(c*c+p*p),u=(u-_[r])/u*t*f[r],c*=u,p*=u,d.vx-=c*(h=k[r]),d.vy-=p*h,s.vx+=c*(h=1-h),s.vy+=p*h}function r(){if(v){var t=v.length,o=e.length,r=a.map(v,c),n,p;for(n=0,w=Array(t);n<o;++n)p=e[n],p.index=n,"object"!=typeof p.source&&(p.source=d(r,p.source)),"object"!=typeof p.target&&(p.target=d(r,p.target)),w[p.source.index]=(w[p.source.index]||0)+1,w[p.target.index]=(w[p.target.index]||0)+1;for(n=0,k=Array(o);n<o;++n)p=e[n],k[n]=w[p.source.index]/(w[p.source.index]+w[p.target.index]);f=Array(o),l(),_=Array(o),s()}}function l(){if(v)for(var t=0,a=e.length;t<a;++t)f[t]=+p(e[t],t,e)}function s(){if(v)for(var t=0,a=e.length;t<a;++t)_[t]=+h(e[t],t,e)}var c=i,p=t,h=u(30),m=1,f,_,v,w,k;return null==e&&(e=[]),o.initialize=function(e){v=e,r()},o.links=function(t){return arguments.length?(e=t,r(),o):e},o.id=function(e){return arguments.length?(c=e,o):c},o.iterations=function(e){return arguments.length?(m=+e,o):m},o.strength=function(e){return arguments.length?(p="function"==typeof e?e:u(+e),l(),o):p},o.distance=function(e){return arguments.length?(h="function"==typeof e?e:u(+e),s(),o):h},o},e.forceManyBody=function(){function e(e){var a=m.length,n=t.quadtree(m,c,p).visitAfter(o),l;for(b=e,l=0;l<a;++l)f=m[l],n.visit(r)}function a(){if(m){var e=m.length,t,a;for(_=Array(e),t=0;t<e;++t)a=m[t],_[a.index]=+l(a,t,m)}}function o(e){var t=0,a=0,o,r,n,l,s;if(e.length){for(n=l=s=0;4>s;++s)(o=e[s])&&(r=wa(o.value))&&(t+=o.value,a+=r,n+=r*o.x,l+=r*o.y);e.x=n/a,e.y=l/a}else{o=e,o.x=o.data.x,o.y=o.data.y;do t+=_[o.data.index];while(o=o.next)}e.value=t}function r(e,t,a,o){if(!e.value)return!0;var r=e.x-f.x,i=e.y-f.y,n=o-t,c=r*r+i*i;if(n*n/h<c)return c<d&&(0===r&&(r=g(),c+=r*r),0===i&&(i=g(),c+=i*i),c<s&&(c=re(s*c)),f.vx+=r*e.value*b/c,f.vy+=i*e.value*b/c),!0;if(!(e.length||c>=d)){(e.data!==f||e.next)&&(0===r&&(r=g(),c+=r*r),0===i&&(i=g(),c+=i*i),c<s&&(c=re(s*c)));do e.data!==f&&(n=_[e.data.index]*b/c,f.vx+=r*n,f.vy+=i*n);while(e=e.next)}}var l=u(-30),s=1,d=1/0,h=.81,m,f,b,_;return e.initialize=function(e){m=e,a()},e.strength=function(t){return arguments.length?(l="function"==typeof t?t:u(+t),a(),e):l},e.distanceMin=function(t){return arguments.length?(s=t*t,e):re(s)},e.distanceMax=function(t){return arguments.length?(d=t*t,e):re(d)},e.theta=function(t){return arguments.length?(h=t*t,e):re(h)},e},e.forceRadial=function(e,t,a){function o(e){for(var o=0,l=s.length;o<l;++o){var n=s[o],p=n.x-t||1e-6,u=n.y-a||1e-6,g=re(p*p+u*u),r=(c[o]-g)*d[o]*e/g;n.vx+=p*r,n.vy+=u*r}}function r(){if(s){var t=s.length,a;for(d=Array(t),c=Array(t),a=0;a<t;++a)c[a]=+e(s[a],a,s),d[a]=isNaN(c[a])?0:+l(s[a],a,s)}}var l=u(.1),s,d,c;return"function"!=typeof e&&(e=u(+e)),null==t&&(t=0),null==a&&(a=0),o.initialize=function(e){s=e,r()},o.strength=function(e){return arguments.length?(l="function"==typeof e?e:u(+e),r(),o):l},o.radius=function(t){return arguments.length?(e="function"==typeof t?t:u(+t),r(),o):e},o.x=function(e){return arguments.length?(t=+e,o):t},o.y=function(e){return arguments.length?(a=+e,o):a},o},e.forceSimulation=function(e){function t(){i(),y.call("tick",f),s<d&&(m.stop(),y.call("end",f))}function i(){var t=e.length,a,o;for(s+=(p-s)*c,g.each(function(e){e(s)}),a=0;a<t;++a)o=e[a],null==o.fx?o.x+=o.vx*=u:(o.x=o.fx,o.vx=0),null==o.fy?o.y+=o.vy*=u:(o.y=o.fy,o.vy=0)}function n(){for(var t=0,a=e.length,o;t<a;++t){if(o=e[t],o.index=t,isNaN(o.x)||isNaN(o.y)){var r=10*re(t),n=t*h;o.x=r*te(n),o.y=r*M(n)}(isNaN(o.vx)||isNaN(o.vy))&&(o.vx=o.vy=0)}}function l(t){return t.initialize&&t.initialize(e),t}var s=1,d=.001,c=1-_a(d,1/300),p=0,u=.6,g=a.map(),m=r.timer(t),y=o.dispatch("tick","end"),f;return null==e&&(e=[]),n(),f={tick:i,restart:function(){return m.restart(t),f},stop:function(){return m.stop(),f},nodes:function(t){return arguments.length?(e=t,n(),g.each(l),f):e},alpha:function(e){return arguments.length?(s=+e,f):s},alphaMin:function(e){return arguments.length?(d=+e,f):d},alphaDecay:function(e){return arguments.length?(c=+e,f):+c},alphaTarget:function(e){return arguments.length?(p=+e,f):p},velocityDecay:function(e){return arguments.length?(u=1-e,f):1-u},force:function(e,t){return 1<arguments.length?(null==t?g.remove(e):g.set(e,l(t)),f):g.get(e)},find:function(t,a,o){var r=0,l=e.length,n,s,d,c,p;for(null==o?o=1/0:o*=o,r=0;r<l;++r)c=e[r],n=t-c.x,s=a-c.y,d=n*n+s*s,d<o&&(p=c,o=d);return p},on:function(e,t){return 1<arguments.length?(y.on(e,t),f):y.on(e)}}},e.forceX=function(e){function t(e){for(var t=0,a=r.length,o;t<a;++t)o=r[t],o.vx+=(s[t]-o.x)*l[t]*e}function a(){if(r){var t=r.length,a;for(l=Array(t),s=Array(t),a=0;a<t;++a)l[a]=isNaN(s[a]=+e(r[a],a,r))?0:+o(r[a],a,r)}}var o=u(.1),r,l,s;return"function"!=typeof e&&(e=u(null==e?0:+e)),t.initialize=function(e){r=e,a()},t.strength=function(e){return arguments.length?(o="function"==typeof e?e:u(+e),a(),t):o},t.x=function(o){return arguments.length?(e="function"==typeof o?o:u(+o),a(),t):e},t},e.forceY=function(e){function t(e){for(var t=0,a=r.length,o;t<a;++t)o=r[t],o.vy+=(s[t]-o.y)*l[t]*e}function a(){if(r){var t=r.length,a;for(l=Array(t),s=Array(t),a=0;a<t;++a)l[a]=isNaN(s[a]=+e(r[a],a,r))?0:+o(r[a],a,r)}}var o=u(.1),r,l,s;return"function"!=typeof e&&(e=u(null==e?0:+e)),t.initialize=function(e){r=e,a()},t.strength=function(e){return arguments.length?(o="function"==typeof e?e:u(+e),a(),t):o},t.y=function(o){return arguments.length?(e="function"==typeof o?o:u(+o),a(),t):e},t},Object.defineProperty(e,"__esModule",{value:!0})})},{"d3-collection":141,"d3-dispatch":143,"d3-quadtree":146,"d3-timer":147}],145:[function(e,t,a){(function(o,r){"object"==typeof a&&"undefined"!=typeof t?r(a,e("d3-color")):"function"==typeof Ca&&Ca.amd?Ca(["exports","d3-color"],r):r(o.d3=o.d3||{},o.d3)})(this,function(e,o){"use strict";function r(e,t,a,o,r){var i=e*e,n=i*e;return((1-3*e+3*i-n)*t+(4-6*i+3*n)*a+(1+3*e+3*i-3*n)*o+n*r)/6}function i(e){var a=e.length-1;return function(o){var n=0>=o?o=0:1<=o?(o=1,a-1):ea(o*a),i=e[n],l=e[n+1],s=0<n?e[n-1]:2*i-l,d=n<a-1?e[n+2]:2*l-i;return r((o-n/a)*a,s,i,l,d)}}function n(e){var a=e.length;return function(o){var n=ea((0>(o%=1)?++o:o)*a),i=e[(n+a-1)%a],l=e[n%a],s=e[(n+1)%a],d=e[(n+2)%a];return r((o-n/a)*a,i,l,s,d)}}function l(e){return function(){return e}}function s(e,a){return function(o){return e+o*a}}function d(e,o,r){return e=_a(e,r),o=_a(o,r)-e,r=1/r,function(a){return _a(e+a*o,r)}}function c(e,t){var a=t-e;return a?s(e,180<a||-180>a?a-360*R(a/360):a):l(isNaN(e)?t:e)}function p(e){return 1==(e=+e)?u:function(t,a){return a-t?d(t,a,e):l(isNaN(t)?a:t)}}function u(e,t){var a=t-e;return a?s(e,a):l(isNaN(e)?t:e)}function g(e){return function(t){var a=t.length,n=Array(a),l=Array(a),s=Array(a),d,c;for(d=0;d<a;++d)c=o.rgb(t[d]),n[d]=c.r||0,l[d]=c.g||0,s[d]=c.b||0;return n=e(n),l=e(l),s=e(s),c.opacity=1,function(e){return c.r=n(e),c.g=l(e),c.b=s(e),c+""}}}function h(e,t){var a=t?t.length:0,o=e?ie(a,e.length):0,r=Array(o),n=Array(a),l;for(l=0;l<o;++l)r[l]=T(e[l],t[l]);for(;l<a;++l)n[l]=t[l];return function(e){for(l=0;l<o;++l)n[l]=r[l](e);return n}}function m(e,o){var r=new Date;return e=+e,o-=e,function(a){return r.setTime(e+o*a),r}}function y(e,o){return e=+e,o-=e,function(a){return e+o*a}}function f(e,t){var o={},r={},i;for(i in(null===e||"object"!=typeof e)&&(e={}),(null===t||"object"!=typeof t)&&(t={}),t)i in e?o[i]=T(e[i],t[i]):r[i]=t[i];return function(e){for(i in o)r[i]=o[i](e);return r}}function x(e){return function(){return e}}function _(e){return function(a){return e(a)+""}}function v(e,r){var t=V.lastIndex=U.lastIndex=0,o=-1,n=[],l=[],s,d,c;for(e+="",r+="";(s=V.exec(e))&&(d=U.exec(r));)(c=d.index)>t&&(c=r.slice(t,c),n[o]?n[o]+=c:n[++o]=c),(s=s[0])===(d=d[0])?n[o]?n[o]+=d:n[++o]=d:(n[++o]=null,l.push({i:o,x:y(s,d)})),t=U.lastIndex;return t<r.length&&(c=r.slice(t),n[o]?n[o]+=c:n[++o]=c),2>n.length?l[0]?_(l[0].x):x(r):(r=l.length,function(e){for(var t=0,a;t<r;++t)n[(a=l[t]).i]=a.x(e);return n.join("")})}function T(e,a){var r=typeof a,t;return null==a||"boolean"==r?l(a):("number"==r?y:"string"==r?(t=o.color(a))?(a=t,B):v:a instanceof o.color?B:a instanceof Date?m:Array.isArray(a)?h:"function"!=typeof a.valueOf&&"function"!=typeof a.toString||isNaN(a)?f:y)(e,a)}function A(t,o,r,i,n,e){var l,s,p;return(l=re(t*t+o*o))&&(t/=l,o/=l),(p=t*r+o*i)&&(r-=t*p,i-=o*p),(s=re(r*r+i*i))&&(r/=s,i/=s,p/=s),t*i<o*r&&(t=-t,o=-o,p=-p,l=-l),{translateX:n,translateY:e,rotate:L(o,t)*H,skewX:k(p)*H,scaleX:l,scaleY:s}}function S(e){return"none"===e?G:(ee||(ee=document.createElement("DIV"),te=document.documentElement,ae=document.defaultView),ee.style.transform=e,e=ae.getComputedStyle(te.appendChild(ee),null).getPropertyValue("transform"),te.removeChild(ee),e=e.slice(7,-1).split(","),A(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))}function C(e){return null==e?G:(oe||(oe=document.createElementNS("http://www.w3.org/2000/svg","g")),oe.setAttribute("transform",e),!(e=oe.transform.baseVal.consolidate()))?G:(e=e.matrix,A(e.a,e.b,e.c,e.d,e.e,e.f))}function E(e,t,a,o){function r(e){return e.length?e.pop()+" ":""}function i(e,o,r,n,l,s){if(e!==r||o!==n){var d=l.push("translate(",null,t,null,a);s.push({i:d-4,x:y(e,r)},{i:d-2,x:y(o,n)})}else(r||n)&&l.push("translate("+r+t+n+a)}function n(e,t,i,n){e===t?t&&i.push(r(i)+"rotate("+t+o):(180<e-t?t+=360:180<t-e&&(e+=360),n.push({i:i.push(r(i)+"rotate(",null,o)-2,x:y(e,t)}))}function l(e,t,a,i){e===t?t&&a.push(r(a)+"skewX("+t+o):i.push({i:a.push(r(a)+"skewX(",null,o)-2,x:y(e,t)})}function d(e,t,a,o,n,l){if(e!==a||t!==o){var s=n.push(r(n)+"scale(",null,",",null,")");l.push({i:s-4,x:y(e,a)},{i:s-2,x:y(t,o)})}else(1!==a||1!==o)&&n.push(r(n)+"scale("+a+","+o+")")}return function(t,o){var r=[],s=[];return t=e(t),o=e(o),i(t.translateX,t.translateY,o.translateX,o.translateY,r,s),n(t.rotate,o.rotate,r,s),l(t.skewX,o.skewX,r,s),d(t.scaleX,t.scaleY,o.scaleX,o.scaleY,r,s),t=o=null,function(e){for(var t=-1,a=s.length,n;++t<a;)r[(n=s[t]).i]=n.x(e);return r.join("")}}}function z(e){return((e=ka(e))+1/e)/2}function I(e){return((e=ka(e))-1/e)/2}function D(e){return((e=ka(2*e))-1)/(e+1)}function O(e){return function(a,r){var i=e((a=o.hsl(a)).h,(r=o.hsl(r)).h),n=u(a.s,r.s),s=u(a.l,r.l),l=u(a.opacity,r.opacity);return function(e){return a.h=i(e),a.s=n(e),a.l=s(e),a.opacity=l(e),a+""}}}function M(e){return function(a,r){var i=e((a=o.hcl(a)).h,(r=o.hcl(r)).h),n=u(a.c,r.c),s=u(a.l,r.l),l=u(a.opacity,r.opacity);return function(e){return a.h=i(e),a.c=n(e),a.l=s(e),a.opacity=l(e),a+""}}}function j(e){return function t(a){function r(r,i){var n=e((r=o.cubehelix(r)).h,(i=o.cubehelix(i)).h),d=u(r.s,i.s),s=u(r.l,i.l),l=u(r.opacity,i.opacity);return function(e){return r.h=n(e),r.s=d(e),r.l=s(_a(e,a)),r.opacity=l(e),r+""}}return a=+a,r.gamma=t,r}(1)}var B=function e(t){function a(e,t){var a=i((e=o.rgb(e)).r,(t=o.rgb(t)).r),r=i(e.g,t.g),n=i(e.b,t.b),l=u(e.opacity,t.opacity);return function(o){return e.r=a(o),e.g=r(o),e.b=n(o),e.opacity=l(o),e+""}}var i=p(t);return a.gamma=e,a}(1),F=g(i),N=g(n),V=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,U=new RegExp(V.source,"g"),H=180/Sa,G={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Y=E(S,"px, ","px)","deg)"),q=E(C,", ",")",")"),W=w,X=O(c),Z=O(u),$=M(c),J=M(u),K=j(c),Q=j(u),ee,te,ae,oe;e.interpolate=T,e.interpolateArray=h,e.interpolateBasis=i,e.interpolateBasisClosed=n,e.interpolateDate=m,e.interpolateDiscrete=function(e){var a=e.length;return function(o){return e[va(0,ie(a-1,ea(o*a)))]}},e.interpolateHue=function(e,t){var a=c(+e,+t);return function(e){var t=a(e);return t-360*ea(t/360)}},e.interpolateNumber=y,e.interpolateObject=f,e.interpolateRound=function(e,o){return e=+e,o-=e,function(a){return R(e+o*a)}},e.interpolateString=v,e.interpolateTransformCss=Y,e.interpolateTransformSvg=q,e.interpolateZoom=function(e,t){var a=e[0],o=e[1],r=e[2],n=t[0],l=t[1],s=t[2],d=n-a,c=l-o,p=d*d+c*c,u,g;if(p<1e-12)g=P(s/r)/W,u=function(e){return[a+e*d,o+e*c,r*ka(W*e*g)]};else{var h=re(p),m=(s*s-r*r+4*p)/(2*(2*r)*h),y=(s*s-r*r-4*p)/(2*(2*s)*h),f=P(re(m*m+1)-m),x=P(re(y*y+1)-y);g=(x-f)/W,u=function(e){var t=e*g,i=z(f),n=r/(2*h)*(i*D(W*t+f)-I(f));return[a+n*d,o+n*c,r*i/z(W*t+f)]}}return u.duration=1e3*g,u},e.interpolateRgb=B,e.interpolateRgbBasis=F,e.interpolateRgbBasisClosed=N,e.interpolateHsl=X,e.interpolateHslLong=Z,e.interpolateLab=function(e,t){var r=u((e=o.lab(e)).l,(t=o.lab(t)).l),i=u(e.a,t.a),a=u(e.b,t.b),n=u(e.opacity,t.opacity);return function(o){return e.l=r(o),e.a=i(o),e.b=a(o),e.opacity=n(o),e+""}},e.interpolateHcl=$,e.interpolateHclLong=J,e.interpolateCubehelix=K,e.interpolateCubehelixLong=Q,e.piecewise=function(e,t){for(var a=0,o=t.length-1,r=t[0],n=Array(0>o?0:o);a<o;)n[a]=e(r,r=t[++a]);return function(e){var a=va(0,ie(o-1,ea(e*=o)));return n[a](e-a)}},e.quantize=function(e,t){for(var a=Array(t),o=0;o<t;++o)a[o]=e(o/(t-1));return a},Object.defineProperty(e,"__esModule",{value:!0})})},{"d3-color":142}],146:[function(e,t,a){(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof Ca&&Ca.amd?Ca(["exports"],o):o(e.d3=e.d3||{})})(this,function(e){"use strict";function t(e,t,a,o){if(isNaN(t)||isNaN(a))return e;var r=e._root,n={data:o},l=e._x0,s=e._y0,d=e._x1,c=e._y1,p,u,g,h,m,y,f,x,b;if(!r)return e._root=n,e;for(;r.length;)if((y=t>=(u=(l+d)/2))?l=u:d=u,(f=a>=(g=(s+c)/2))?s=g:c=g,(p=r,!(r=r[x=f<<1|y])))return p[x]=n,e;if(h=+e._x.call(null,r.data),m=+e._y.call(null,r.data),t===h&&a===m)return n.next=r,p?p[x]=n:e._root=n,e;do p=p?p[x]=[,,,,]:e._root=[,,,,],(y=t>=(u=(l+d)/2))?l=u:d=u,(f=a>=(g=(s+c)/2))?s=g:c=g;while((x=f<<1|y)==(b=(m>=g)<<1|h>=u));return p[b]=r,p[x]=n,e}function a(e){return e[0]}function o(e){return e[1]}function r(e,t,r){var i=new n(null==t?a:t,null==r?o:r,NaN,NaN,NaN,NaN);return null==e?i:i.addAll(e)}function n(e,t,a,o,r,i){this._x=e,this._y=t,this._x0=a,this._y0=o,this._x1=r,this._y1=i,this._root=void 0}function l(e){for(var t={data:e.data},a=t;e=e.next;)a=a.next={data:e.data};return t}var s=function(e,t,a,o,r){this.node=e,this.x0=t,this.y0=a,this.x1=o,this.y1=r},d=r.prototype=n.prototype;d.copy=function(){var e=new n(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,a,o;if(!t)return e;if(!t.length)return e._root=l(t),e;for(a=[{source:t,target:e._root=[,,,,]}];t=a.pop();)for(var r=0;4>r;++r)(o=t.source[r])&&(o.length?a.push({source:o,target:t.target[r]=[,,,,]}):t.target[r]=l(o));return e},d.add=function(e){var a=+this._x.call(null,e),o=+this._y.call(null,e);return t(this.cover(a,o),a,o,e)},d.addAll=function(e){var a=e.length,o=Array(a),r=Array(a),n=1/0,l=1/0,s=-Infinity,c=-Infinity,p,u,g,h;for(u=0;u<a;++u)isNaN(g=+this._x.call(null,p=e[u]))||isNaN(h=+this._y.call(null,p))||(o[u]=g,r[u]=h,g<n&&(n=g),g>s&&(s=g),h<l&&(l=h),h>c&&(c=h));for(s<n&&(n=this._x0,s=this._x1),c<l&&(l=this._y0,c=this._y1),this.cover(n,l).cover(s,c),u=0;u<a;++u)t(this,o[u],r[u],e[u]);return this},d.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var a=this._x0,o=this._y0,r=this._x1,n=this._y1;if(isNaN(a))r=(a=ea(e))+1,n=(o=ea(t))+1;else if(a>e||e>r||o>t||t>n){var l=r-a,s=this._root,d,c;switch(c=(t<(o+n)/2)<<1|e<(a+r)/2){case 0:{do d=[,,,,],d[c]=s,s=d;while((l*=2,r=a+l,n=o+l,e>r||t>n));break}case 1:{do d=[,,,,],d[c]=s,s=d;while((l*=2,a=r-l,n=o+l,a>e||t>n));break}case 2:{do d=[,,,,],d[c]=s,s=d;while((l*=2,r=a+l,o=n-l,e>r||o>t));break}case 3:{do d=[,,,,],d[c]=s,s=d;while((l*=2,a=r-l,o=n-l,a>e||o>t));break}}this._root&&this._root.length&&(this._root=s)}else return this;return this._x0=a,this._y0=o,this._x1=r,this._y1=n,this},d.data=function(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e},d.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},d.find=function(e,t,a){var o=this._x0,r=this._y0,n=this._x1,l=this._y1,c=[],p=this._root,u,g,h,m,y,f,x;for(p&&c.push(new s(p,o,r,n,l)),null==a?a=1/0:(o=e-a,r=t-a,n=e+a,l=t+a,a*=a);f=c.pop();)if(!(!(p=f.node)||(g=f.x0)>n||(h=f.y0)>l||(m=f.x1)<o||(y=f.y1)<r))if(p.length){var b=(g+m)/2,_=(h+y)/2;c.push(new s(p[3],b,_,m,y),new s(p[2],g,_,b,y),new s(p[1],b,h,m,_),new s(p[0],g,h,b,_)),(x=(t>=_)<<1|e>=b)&&(f=c[c.length-1],c[c.length-1]=c[c.length-1-x],c[c.length-1-x]=f)}else{var v=e-+this._x.call(null,p.data),w=t-+this._y.call(null,p.data),k=v*v+w*w;if(k<a){var T=re(a=k);o=e-T,r=t-T,n=e+T,l=t+T,u=p.data}}return u},d.remove=function(e){if(isNaN(p=+this._x.call(null,e))||isNaN(u=+this._y.call(null,e)))return this;var t=this._root,a=this._x0,o=this._y0,r=this._x1,n=this._y1,l,s,d,c,p,u,g,h,m,f,b,_;if(!t)return this;if(t.length)for(;;){if((m=p>=(g=(a+r)/2))?a=g:r=g,(f=u>=(h=(o+n)/2))?o=h:n=h,(l=t,!(t=t[b=f<<1|m])))return this;if(!t.length)break;(l[3&b+1]||l[3&b+2]||l[3&b+3])&&(s=l,_=b)}for(;t.data!==e;)if(d=t,!(t=t.next))return this;return((c=t.next)&&delete t.next,d)?(c?d.next=c:delete d.next,this):l?(c?l[b]=c:delete l[b],(t=l[0]||l[1]||l[2]||l[3])&&t===(l[3]||l[2]||l[1]||l[0])&&!t.length&&(s?s[_]=t:this._root=t),this):(this._root=c,this)},d.removeAll=function(e){for(var t=0,a=e.length;t<a;++t)this.remove(e[t]);return this},d.root=function(){return this._root},d.size=function(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e},d.visit=function(e){var t=[],a=this._root,o,r,i,n,l,d;for(a&&t.push(new s(a,this._x0,this._y0,this._x1,this._y1));o=t.pop();)if(!e(a=o.node,i=o.x0,n=o.y0,l=o.x1,d=o.y1)&&a.length){var c=(i+l)/2,p=(n+d)/2;(r=a[3])&&t.push(new s(r,c,p,l,d)),(r=a[2])&&t.push(new s(r,i,p,c,d)),(r=a[1])&&t.push(new s(r,c,n,l,p)),(r=a[0])&&t.push(new s(r,i,n,c,p))}return this},d.visitAfter=function(e){var t=[],a=[],o;for(this._root&&t.push(new s(this._root,this._x0,this._y0,this._x1,this._y1));o=t.pop();){var r=o.node;if(r.length){var i=o.x0,n=o.y0,l=o.x1,d=o.y1,c=(i+l)/2,p=(n+d)/2,u;(u=r[0])&&t.push(new s(u,i,n,c,p)),(u=r[1])&&t.push(new s(u,c,n,l,p)),(u=r[2])&&t.push(new s(u,i,p,c,d)),(u=r[3])&&t.push(new s(u,c,p,l,d))}a.push(o)}for(;o=a.pop();)e(o.node,o.x0,o.y0,o.x1,o.y1);return this},d.x=function(e){return arguments.length?(this._x=e,this):this._x},d.y=function(e){return arguments.length?(this._y=e,this):this._y},e.quadtree=r,Object.defineProperty(e,"__esModule",{value:!0})})},{}],147:[function(e,t,a){(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof Ca&&Ca.amd?Ca(["exports"],o):o(e.d3=e.d3||{})})(this,function(e){"use strict";function a(){return m||(x(o),m=f.now()+y)}function o(){m=0}function r(){this._call=this._time=this._next=null}function i(e,a,o){var i=new r;return i.restart(e,a,o),i}function n(){a(),++p;for(var o=b,r;o;)0<=(r=m-o._time)&&o._call.call(null,r),o=o._next;--p}function l(){m=(h=f.now())+y,p=u=0;try{n()}finally{p=0,d(),m=0}}function s(){var e=f.now(),t=e-h;t>1000&&(y-=t,h=e)}function d(){for(var e=b,t=1/0,a,o;e;)e._call?(t>e._time&&(t=e._time),a=e,e=e._next):(o=e._next,e._next=null,e=a?a._next=o:b=o);_=a,c(t)}function c(e){if(!p){u&&(u=clearTimeout(u));var t=e-m;24<t?(e<1/0&&(u=setTimeout(l,e-f.now()-y)),g&&(g=clearInterval(g))):(!g&&(h=f.now(),g=setInterval(s,1000)),p=1,x(l))}}var p=0,u=0,g=0,h=0,m=0,y=0,f="object"==typeof performance&&performance.now?performance:Date,x="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)},b,_;r.prototype=i.prototype={constructor:r,restart:function(e,t,o){if("function"!=typeof e)throw new TypeError("callback is not a function");o=(null==o?a():+o)+(null==t?0:+t),this._next||_===this||(_?_._next=this:b=this,_=this),this._call=e,this._time=o,c()},stop:function(){this._call&&(this._call=null,this._time=1/0,c())}};e.now=a,e.timer=i,e.timerFlush=n,e.timeout=function(e,a,o){var i=new r;return a=null==a?0:+a,i.restart(function(t){i.stop(),e(t+a)},a,o),i},e.interval=function(e,o,i){var n=new r,t=o;return null==o?(n.restart(e,o,i),n):(o=+o,i=null==i?a():+i,n.restart(function a(r){r+=t,n.restart(a,t+=o,i),e(r)},o,i),n)},Object.defineProperty(e,"__esModule",{value:!0})})},{}],148:[function(e,t){!function(){function e(e){return e&&(e.ownerDocument||e.document||e).documentElement}function o(e){return e&&(e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView)}function r(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function l(e){return null===e?NaN:+e}function s(e){return!isNaN(e)}function d(e){return{left:function(t,a,o,r){for(3>arguments.length&&(o=0),4>arguments.length&&(r=t.length);o<r;){var i=o+r>>>1;0>e(t[i],a)?o=i+1:r=i}return o},right:function(t,a,o,r){for(3>arguments.length&&(o=0),4>arguments.length&&(r=t.length);o<r;){var i=o+r>>>1;0<e(t[i],a)?r=i:o=i+1}return o}}}function c(e){return e.length}function p(e){for(var t=1;e*t%1;)t*=10;return t}function u(e,t){for(var a in t)Object.defineProperty(e.prototype,a,{value:t[a],enumerable:!1})}function h(){this._=Object.create(null)}function m(e){return"__proto__"===(e+="")||"\0"===e[0]?"\0"+e:e}function y(e){return"\0"===(e+="")[0]?e.slice(1):e}function f(e){return m(e)in this._}function x(e){return(e=m(e))in this._&&delete this._[e]}function b(){var e=[];for(var t in this._)e.push(y(t));return e}function T(){var e=0;for(var t in this._)++e;return e}function A(){for(var e in this._)return!1;return!0}function S(){this._=Object.create(null)}function C(e){return e}function I(e,t,a){return function(){var o=a.apply(t,arguments);return o===t?e:o}}function D(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var a=0,o=Cn.length,r;a<o;++a)if(r=Cn[a]+t,r in e)return r}function j(){}function B(){}function F(e){function t(){for(var t=a,o=-1,r=t.length,n;++o<r;)(n=t[o].on)&&n.apply(this,arguments);return e}var a=[],o=new h;return t.on=function(t,r){var n=o.get(t),l;return 2>arguments.length?n&&n.on:(n&&(n.on=null,a=a.slice(0,l=a.indexOf(n)).concat(a.slice(l+1)),o.remove(t)),r&&a.push(o.set(t,{on:r})),e)},t}function N(){fn.event.preventDefault()}function V(){for(var t=fn.event,a;a=t.sourceEvent;)t=a;return t}function U(e){for(var t=new B,a=0,o=arguments.length;++a<o;)t[arguments[a]]=F(t);return t.of=function(a,o){return function(r){try{var i=r.sourceEvent=fn.event;r.target=e,fn.event=r,t[r.type].apply(a,o)}finally{fn.event=i}}},t}function H(e){return En(e,Pn),e}function G(e){return"function"==typeof e?e:function(){return zn(e,this)}}function Y(e){return"function"==typeof e?e:function(){return In(e,this)}}function q(e,t){function a(){this.removeAttribute(e)}function o(){this.removeAttributeNS(e.space,e.local)}function r(){this.setAttribute(e,t)}function i(){this.setAttributeNS(e.space,e.local,t)}function n(){var a=t.apply(this,arguments);null==a?this.removeAttribute(e):this.setAttribute(e,a)}function l(){var a=t.apply(this,arguments);null==a?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,a)}return e=fn.ns.qualify(e),null==t?e.local?o:a:"function"==typeof t?e.local?l:n:e.local?i:r}function W(e){return e.trim().replace(/\s+/g," ")}function X(e){return new RegExp("(?:^|\\s+)"+fn.requote(e)+"(?:\\s+|$)","g")}function Z(e){return(e+"").trim().split(/^|\s+/)}function $(e,t){function a(){for(var a=-1;++a<r;)e[a](this,t)}function o(){for(var a=-1,o=t.apply(this,arguments);++a<r;)e[a](this,o)}e=Z(e).map(J);var r=e.length;return"function"==typeof t?o:a}function J(e){var t=X(e);return function(a,o){if(r=a.classList)return o?r.add(e):r.remove(e);var r=a.getAttribute("class")||"";o?(t.lastIndex=0,!t.test(r)&&a.setAttribute("class",W(r+" "+e))):a.setAttribute("class",W(r.replace(t," ")))}}function K(e,t,a){return null==t?function(){this.style.removeProperty(e)}:"function"==typeof t?function(){var o=t.apply(this,arguments);null==o?this.style.removeProperty(e):this.style.setProperty(e,o,a)}:function(){this.style.setProperty(e,t,a)}}function Q(e,t){return null==t?function(){delete this[e]}:"function"==typeof t?function(){var a=t.apply(this,arguments);null==a?delete this[e]:this[e]=a}:function(){this[e]=t}}function ee(e){function t(){var t=this.ownerDocument,a=this.namespaceURI;return"http://www.w3.org/1999/xhtml"===a&&"http://www.w3.org/1999/xhtml"===t.documentElement.namespaceURI?t.createElement(e):t.createElementNS(a,e)}function a(){return this.ownerDocument.createElementNS(e.space,e.local)}return"function"==typeof e?e:(e=fn.ns.qualify(e)).local?a:t}function oe(){var e=this.parentNode;e&&e.removeChild(this)}function ne(e){return{__data__:e}}function le(e){return function(){return Dn(this,e)}}function se(e){return arguments.length||(e=r),function(t,a){return t&&a?e(t.__data__,a.__data__):!t-!a}}function de(e,t){for(var a=0,o=e.length;a<o;a++)for(var r=e[a],l=0,s=r.length,n;l<s;l++)(n=r[l])&&t(n,l,a);return e}function ce(e){return En(e,Rn),e}function pe(e){var t,a;return function(o,r,i){var l=e[i].update,s=l.length,n;for(i!=a&&(a=i,t=0),r>=t&&(t=r+1);!(n=l[t])&&++t<s;);return n}}function ue(e,t,a){function o(){var t=this[s];t&&(this.removeEventListener(e,t,t.$),delete this[s])}function r(){var r=i(t,xn(arguments));o.call(this),this.addEventListener(e,this[s]=r,r.$=a),r._=t}function n(){var t=new RegExp("^__on([^.]+)"+fn.requote(e)+"$"),a;for(var o in this)if(a=o.match(t)){var r=this[o];this.removeEventListener(a[1],r,r.$),delete this[o]}}var s="__on"+e,d=e.indexOf("."),i=ge;0<d&&(e=e.slice(0,d));var l=Mn.get(e);return l&&(e=l,i=he),d?t?r:o:t?j:n}function ge(e,t){return function(a){var r=fn.event;fn.event=a,t[0]=this.__data__;try{e.apply(this,t)}finally{fn.event=r}}}function he(e,t){var a=ge(e,t);return function(t){var e=this,o=t.relatedTarget;o&&(o===e||8&o.compareDocumentPosition(e))||a.call(e,t)}}function me(t){var a=".dragsuppress-"+ ++jn,r="click"+a,i=fn.select(o(t)).on("touchmove"+a,N).on("dragstart"+a,N).on("selectstart"+a,N);if(null==Bn&&(Bn=!("onselectstart"in t)&&D(t.style,"userSelect")),Bn){var n=e(t).style,l=n[Bn];n[Bn]="none"}return function(e){if(i.on(a,null),Bn&&(n[Bn]=l),e){var t=function(){i.on(r,null)};i.on(r,function(){N(),t()},!0),setTimeout(t,0)}}}function ye(t,a){a.changedTouches&&(a=a.changedTouches[0]);var r=t.ownerSVGElement||t;if(r.createSVGPoint){var i=r.createSVGPoint();if(0>Fn){var n=o(t);if(n.scrollX||n.scrollY){r=fn.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var l=r[0][0].getScreenCTM();Fn=!(l.f||l.e),r.remove()}}return Fn?(i.x=a.pageX,i.y=a.pageY):(i.x=a.clientX,i.y=a.clientY),i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}var s=t.getBoundingClientRect();return[a.clientX-s.left-t.clientLeft,a.clientY-s.top-t.clientTop]}function fe(){return fn.event.changedTouches[0].identifier}function xe(e){return 0<e?1:0>e?-1:0}function be(e,t,a){return(t[0]-e[0])*(a[1]-e[1])-(t[1]-e[1])*(a[0]-e[0])}function _e(e){return 1<e?0:-1>e?i:v(e)}function ve(e){return 1<e?Un:-1>e?-Un:_(e)}function we(e){return((e=ka(e))-1/e)/2}function ke(e){return((e=ka(e))+1/e)/2}function Te(e){return((e=ka(2*e))-1)/(e+1)}function Ae(e){return(e=M(e/2))*e}function Se(){}function Ce(e,t,a){return this instanceof Ce?void(this.h=+e,this.s=+t,this.l=+a):2>arguments.length?e instanceof Ce?new Ce(e.h,e.s,e.l):Ve(""+e,Ue,Ce):new Ce(e,t,a)}function Le(e,t,a){function o(e){return 360<e?e-=360:0>e&&(e+=360),60>e?i+(n-i)*e/60:180>e?n:240>e?i+(n-i)*(240-e)/60:i}function r(e){return R(255*o(e))}var i,n;return e=isNaN(e)?0:0>(e%=360)?e+360:e,t=isNaN(t)?0:0>t?0:1<t?1:t,a=0>a?0:1<a?1:a,n=.5>=a?a*(1+t):a+t-a*t,i=2*a-n,new je(r(e+120),r(e),r(e-120))}function Ee(e,t,a){return this instanceof Ee?void(this.h=+e,this.c=+t,this.l=+a):2>arguments.length?e instanceof Ee?new Ee(e.h,e.c,e.l):e instanceof Ie?Pe(e.l,e.a,e.b):Pe((e=He((e=fn.rgb(e)).r,e.g,e.b)).l,e.a,e.b):new Ee(e,t,a)}function ze(e,t,a){return isNaN(e)&&(e=0),isNaN(t)&&(t=0),new Ie(a,te(e*=Hn)*t,M(e)*t)}function Ie(e,t,a){return this instanceof Ie?void(this.l=+e,this.a=+t,this.b=+a):2>arguments.length?e instanceof Ie?new Ie(e.l,e.a,e.b):e instanceof Ee?ze(e.h,e.c,e.l):He((e=je(e)).r,e.g,e.b):new Ie(e,t,a)}function De(e,t,a){var o=(e+16)/116,r=o+t/500,i=o-a/200;return r=Oe(r)*el,o=1*Oe(o),i=Oe(i)*tl,new je(Me(3.2404542*r-1.5371385*o-.4985314*i),Me(-.969266*r+1.8760108*o+.041556*i),Me(.0556434*r-.2040259*o+1.0572252*i))}function Pe(e,t,a){return 0<e?new Ee(L(a,t)*Gn,re(t*t+a*a),e):new Ee(NaN,NaN,e)}function Oe(e){return .206893034<e?e*e*e:(e-4/29)/7.787037}function Re(e){return .008856<e?_a(e,1/3):7.787037*e+4/29}function Me(e){return R(255*(.00304>=e?12.92*e:1.055*_a(e,1/2.4)-.055))}function je(e,t,a){return this instanceof je?void(this.r=~~e,this.g=~~t,this.b=~~a):2>arguments.length?e instanceof je?new je(e.r,e.g,e.b):Ve(""+e,je,Le):new je(e,t,a)}function Be(e){return new je(e>>16,255&e>>8,255&e)}function Fe(e){return Be(e)+""}function Ne(e){return 16>e?"0"+va(0,e).toString(16):ie(255,e).toString(16)}function Ve(e,t,a){var o=0,i=0,n=0,l,s,d;if(l=/([a-z]+)\((.*)\)/.exec(e=e.toLowerCase()),l)switch(s=l[2].split(","),l[1]){case"hsl":return a(parseFloat(s[0]),parseFloat(s[1])/100,parseFloat(s[2])/100);case"rgb":return t(Ye(s[0]),Ye(s[1]),Ye(s[2]));}return(d=rl.get(e))?t(d.r,d.g,d.b):(null==e||"#"!==e.charAt(0)||isNaN(d=parseInt(e.slice(1),16))||(4===e.length?(o=(3840&d)>>4,o=o>>4|o,i=240&d,i=i>>4|i,n=15&d,n=n<<4|n):7===e.length&&(o=(16711680&d)>>16,i=(65280&d)>>8,n=255&d)),t(o,i,n))}function Ue(e,t,a){var o=ie(e/=255,t/=255,a/=255),i=va(e,t,a),n=i-o,d=(i+o)/2,l,c;return n?(c=.5>d?n/(i+o):n/(2-i-o),l=e==i?(t-a)/n+(t<a?6:0):t==i?(a-e)/n+2:(e-t)/n+4,l*=60):(l=NaN,c=0<d&&1>d?0:l),new Ce(l,c,d)}function He(e,t,a){e=Ge(e),t=Ge(t),a=Ge(a);var o=Re((.4124564*e+.3575761*t+.1804375*a)/el),i=Re((.2126729*e+.7151522*t+.072175*a)/1),n=Re((.0193339*e+.119192*t+.9503041*a)/tl);return Ie(116*i-16,500*(o-i),200*(i-n))}function Ge(e){return .04045>=(e/=255)?e/12.92:_a((e+.055)/1.055,2.4)}function Ye(e){var t=parseFloat(e);return"%"===e.charAt(e.length-1)?R(2.55*t):t}function qe(e){return"function"==typeof e?e:function(){return e}}function We(e){return function(t,a,o){return 2===arguments.length&&"function"==typeof a&&(o=a,a=null),Xe(t,a,e,o)}}function Xe(e,t,a,o){function r(){var e=s.status,t;if(!e&&$e(s)||200<=e&&300>e||304===e){try{t=a.call(i,s)}catch(t){return void n.error.call(i,t)}n.load.call(i,t)}else n.error.call(i,s)}var i={},n=fn.dispatch("beforesend","progress","load","error"),l={},s=new XMLHttpRequest,d=null;return this.XDomainRequest&&!("withCredentials"in s)&&/^(http(s)?:)?\/\//.test(e)&&(s=new XDomainRequest),"onload"in s?s.onload=s.onerror=r:s.onreadystatechange=function(){3<s.readyState&&r()},s.onprogress=function(e){var t=fn.event;fn.event=e;try{n.progress.call(i,s)}finally{fn.event=t}},i.header=function(e,t){return(e=(e+"").toLowerCase(),2>arguments.length)?l[e]:(null==t?delete l[e]:l[e]=t+"",i)},i.mimeType=function(e){return arguments.length?(t=null==e?null:e+"",i):t},i.responseType=function(e){return arguments.length?(d=e,i):d},i.response=function(e){return a=e,i},["get","post"].forEach(function(e){i[e]=function(){return i.send.apply(i,[e].concat(xn(arguments)))}}),i.send=function(a,o,r){if(2===arguments.length&&"function"==typeof o&&(r=o,o=null),s.open(a,e,!0),null==t||"accept"in l||(l.accept=t+",*/*"),s.setRequestHeader)for(var c in l)s.setRequestHeader(c,l[c]);return null!=t&&s.overrideMimeType&&s.overrideMimeType(t),null!=d&&(s.responseType=d),null!=r&&i.on("error",r).on("load",function(e){r(null,e)}),n.beforesend.call(i,s),s.send(null==o?null:o),i},i.abort=function(){return s.abort(),i},fn.rebind(i,n,"on"),null==o?i:i.get(Ze(o))}function Ze(e){return 1===e.length?function(t,a){e(null==t?a:null)}:e}function $e(e){var t=e.responseType;return t&&"text"!==t?e.response:e.responseText}function Je(e,t,a){var o=arguments.length;2>o&&(t=0),3>o&&(a=Date.now());var r=a+t,i={c:e,t:r,n:null};return ll?ll.n=i:nl=i,ll=i,sl||(dl=clearTimeout(dl),sl=1,il(Ke)),i}function Ke(){var e=Qe(),t=et()-e;24<t?(isFinite(t)&&(clearTimeout(dl),dl=setTimeout(Ke,t)),sl=0):(sl=1,il(Ke))}function Qe(){for(var e=Date.now(),t=nl;t;)e>=t.t&&t.c(e-t.t)&&(t.c=null),t=t.n;return e}function et(){for(var e=nl,t=1/0,a;e;)e.c?(e.t<t&&(t=e.t),e=(a=e).n):e=a?a.n=e.n:nl=e.n;return ll=a,t}function tt(e,t){return t-(e?ae(P(e)/z):1)}function at(e){var t=e.decimal,a=e.thousands,o=e.grouping,r=e.currency,n=o&&a?function(e,r){for(var n=e.length,l=[],t=0,s=o[0],d=0;0<n&&0<s&&(d+s+1>r&&(s=va(1,r-d)),l.push(e.substring(n-=s,n+s)),!((d+=s+1)>r));)s=o[t=(t+1)%o.length];return l.reverse().join(a)}:C;return function(e){var a=pl.exec(e),o=a[1]||" ",l=a[2]||">",s=a[3]||"-",d=a[4]||"",c=a[5],p=+a[6],u=a[7],g=a[8],h=a[9],m=1,y="",f="",x=!1,b=!0;switch(g&&(g=+g.substring(1)),(c||"0"===o&&"="===l)&&(c=o="0",l="="),h){case"n":u=!0,h="g";break;case"%":m=100,f="%",h="f";break;case"p":m=100,f="%",h="r";break;case"b":case"o":case"x":case"X":"#"===d&&(y="0"+h.toLowerCase());case"c":b=!1;case"d":x=!0,g=0;break;case"s":m=-1,h="r";}"$"===d&&(y=r[0],f=r[1]),"r"!=h||g||(h="g"),null!=g&&("g"==h?g=va(1,ie(21,g)):("e"==h||"f"==h)&&(g=va(0,ie(20,g)))),h=ul.get(h)||ot;var _=c&&u;return function(e){var a=f;if(x&&e%1)return"";var r=0>e||0===e&&0>1/e?(e=-e,"-"):"-"===s?"":s;if(0>m){var d=fn.formatPrefix(e,g);e=d.scale(e),a=d.symbol+f}else e*=m;e=h(e,g);var v=e.lastIndexOf("."),i,w;if(0>v){var k=b?e.lastIndexOf("e"):-1;0>k?(i=e,w=""):(i=e.substring(0,k),w=e.substring(k))}else i=e.substring(0,v),w=t+e.substring(v+1);!c&&u&&(i=n(i,1/0));var T=y.length+i.length+w.length+(_?0:r.length),A=T<p?Array(T=p-T+1).join(o):"";return _&&(i=n(A+i,A.length?p-w.length:1/0)),r+=y,e=i+w,("<"===l?r+e+A:">"===l?A+r+e:"^"===l?A.substring(0,T>>=1)+r+e+A.substring(T):r+(_?e:A+e))+a}}}function ot(e){return e+""}function rt(){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}function it(e,t,a){function o(t){var a=e(t),o=i(a,1);return t-a<o-t?a:o}function r(a){return t(a=e(new ml(a-1)),1),a}function i(e,a){return t(e=new ml(+e),a),e}function n(e,o,i){var n=r(e),l=[];if(1<i)for(;n<o;)a(n)%i||l.push(new Date(+n)),t(n,1);else for(;n<o;)l.push(new Date(+n)),t(n,1);return l}e.floor=e,e.round=o,e.ceil=r,e.offset=i,e.range=n;var l=e.utc=nt(e);return l.floor=l,l.round=nt(o),l.ceil=nt(r),l.offset=nt(i),l.range=function(e,t,a){try{ml=rt;var o=new rt;return o._=e,n(o,t,a)}finally{ml=Date}},e}function nt(e){return function(t,a){try{ml=rt;var o=new rt;return o._=t,e(o,a)._}finally{ml=Date}}}function lt(e){function t(e){function t(t){for(var a=[],r=-1,n=0,l,s,d;++r<o;)37===e.charCodeAt(r)&&(a.push(e.slice(n,r)),null!=(s=fl[l=e.charAt(++r)])&&(l=e.charAt(++r)),(d=v[l])&&(l=d(t,null==s?"e"===l?" ":"0":s)),a.push(l),n=r+1);return a.push(e.slice(n,r)),a.join("")}var o=e.length;return t.parse=function(t){var o={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},r=a(o,e,t,0);if(r!=t.length)return null;"p"in o&&(o.H=o.H%12+12*o.p);var i=null!=o.Z&&ml!==rt,n=new(i?rt:ml);return"j"in o?n.setFullYear(o.y,0,o.j):"W"in o||"U"in o?(!("w"in o)&&(o.w="W"in o?1:0),n.setFullYear(o.y,0,1),n.setFullYear(o.y,0,"W"in o?(o.w+6)%7+7*o.W-(n.getDay()+5)%7:o.w+7*o.U-(n.getDay()+6)%7)):n.setFullYear(o.y,o.m,o.d),n.setHours(o.H+(0|o.Z/100),o.M+o.Z%100,o.S,o.L),i?n._:n},t.toString=function(){return e},t}function a(e,a,o,r){for(var l=0,s=a.length,n=o.length,d,u,g;l<s;){if(r>=n)return-1;if(d=a.charCodeAt(l++),37===d){if(g=a.charAt(l++),u=w[g in fl?a.charAt(l++):g],!u||0>(r=u(e,o,r)))return-1;}else if(d!=o.charCodeAt(r++))return-1}return r}var o=e.dateTime,r=e.date,i=e.time,n=e.periods,l=e.days,s=e.shortDays,c=e.months,p=e.shortMonths;t.utc=function(e){function a(e){try{ml=rt;var t=new ml;return t._=e,o(t)}finally{ml=Date}}var o=t(e);return a.parse=function(e){try{ml=rt;var t=o.parse(e);return t&&t._}finally{ml=Date}},a.toString=o.toString,a},t.multi=t.utc.multi=Ct;var u=fn.map(),g=dt(l),h=ct(l),m=dt(s),y=ct(s),f=dt(c),x=ct(c),b=dt(p),_=ct(p);n.forEach(function(e,t){u.set(e.toLowerCase(),t)});var v={a:function(e){return s[e.getDay()]},A:function(e){return l[e.getDay()]},b:function(e){return p[e.getMonth()]},B:function(e){return c[e.getMonth()]},c:t(o),d:function(e,t){return st(e.getDate(),t,2)},e:function(e,t){return st(e.getDate(),t,2)},H:function(e,t){return st(e.getHours(),t,2)},I:function(e,t){return st(e.getHours()%12||12,t,2)},j:function(e,t){return st(1+hl.dayOfYear(e),t,3)},L:function(e,t){return st(e.getMilliseconds(),t,3)},m:function(e,t){return st(e.getMonth()+1,t,2)},M:function(e,t){return st(e.getMinutes(),t,2)},p:function(e){return n[+(12<=e.getHours())]},S:function(e,t){return st(e.getSeconds(),t,2)},U:function(e,t){return st(hl.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return st(hl.mondayOfYear(e),t,2)},x:t(r),X:t(i),y:function(e,t){return st(e.getFullYear()%100,t,2)},Y:function(e,t){return st(e.getFullYear()%1e4,t,4)},Z:At,"%":function(){return"%"}},w={a:function(e,t,a){m.lastIndex=0;var o=m.exec(t.slice(a));return o?(e.w=y.get(o[0].toLowerCase()),a+o[0].length):-1},A:function(e,t,a){g.lastIndex=0;var o=g.exec(t.slice(a));return o?(e.w=h.get(o[0].toLowerCase()),a+o[0].length):-1},b:function(e,t,a){b.lastIndex=0;var o=b.exec(t.slice(a));return o?(e.m=_.get(o[0].toLowerCase()),a+o[0].length):-1},B:function(e,t,a){f.lastIndex=0;var o=f.exec(t.slice(a));return o?(e.m=x.get(o[0].toLowerCase()),a+o[0].length):-1},c:function(e,t,o){return a(e,v.c.toString(),t,o)},d:bt,e:bt,H:vt,I:vt,j:_t,L:Tt,m:xt,M:wt,p:function(e,t,a){var o=u.get(t.slice(a,a+=2).toLowerCase());return null==o?-1:(e.p=o,a)},S:kt,U:ut,w:pt,W:gt,x:function(e,t,o){return a(e,v.x.toString(),t,o)},X:function(e,t,o){return a(e,v.X.toString(),t,o)},y:mt,Y:ht,Z:yt,"%":St};return t}function st(e,t,a){var o=0>e?"-":"",r=(o?-e:e)+"",i=r.length;return o+(i<a?Array(a-i+1).join(t)+r:r)}function dt(e){return new RegExp("^(?:"+e.map(fn.requote).join("|")+")","i")}function ct(e){for(var t=new h,a=-1,o=e.length;++a<o;)t.set(e[a].toLowerCase(),a);return t}function pt(e,t,a){xl.lastIndex=0;var o=xl.exec(t.slice(a,a+1));return o?(e.w=+o[0],a+o[0].length):-1}function ut(e,t,a){xl.lastIndex=0;var o=xl.exec(t.slice(a));return o?(e.U=+o[0],a+o[0].length):-1}function gt(e,t,a){xl.lastIndex=0;var o=xl.exec(t.slice(a));return o?(e.W=+o[0],a+o[0].length):-1}function ht(e,t,a){xl.lastIndex=0;var o=xl.exec(t.slice(a,a+4));return o?(e.y=+o[0],a+o[0].length):-1}function mt(e,t,a){xl.lastIndex=0;var o=xl.exec(t.slice(a,a+2));return o?(e.y=ft(+o[0]),a+o[0].length):-1}function yt(e,t,a){return /^[+-]\d{4}$/.test(t=t.slice(a,a+5))?(e.Z=-t,a+5):-1}function ft(e){return e+(68<e?1900:2e3)}function xt(e,t,a){xl.lastIndex=0;var o=xl.exec(t.slice(a,a+2));return o?(e.m=o[0]-1,a+o[0].length):-1}function bt(e,t,a){xl.lastIndex=0;var o=xl.exec(t.slice(a,a+2));return o?(e.d=+o[0],a+o[0].length):-1}function _t(e,t,a){xl.lastIndex=0;var o=xl.exec(t.slice(a,a+3));return o?(e.j=+o[0],a+o[0].length):-1}function vt(e,t,a){xl.lastIndex=0;var o=xl.exec(t.slice(a,a+2));return o?(e.H=+o[0],a+o[0].length):-1}function wt(e,t,a){xl.lastIndex=0;var o=xl.exec(t.slice(a,a+2));return o?(e.M=+o[0],a+o[0].length):-1}function kt(e,t,a){xl.lastIndex=0;var o=xl.exec(t.slice(a,a+2));return o?(e.S=+o[0],a+o[0].length):-1}function Tt(e,t,a){xl.lastIndex=0;var o=xl.exec(t.slice(a,a+3));return o?(e.L=+o[0],a+o[0].length):-1}function At(e){var t=e.getTimezoneOffset(),a=0<t?"-":"+",o=0|Sn(t)/60,r=Sn(t)%60;return a+st(o,"0",2)+st(r,"0",2)}function St(e,t,a){bl.lastIndex=0;var o=bl.exec(t.slice(a,a+1));return o?a+o[0].length:-1}function Ct(e){for(var t=e.length,a=-1;++a<t;)e[a][0]=this(e[a][0]);return function(t){for(var a=0,o=e[a];!o[1](t);)o=e[++a];return o[0](t)}}function Lt(){}function Et(e,t,a){var o=a.s=e+t,r=o-e;a.t=e-(o-r)+(t-r)}function zt(e,t){e&&kl.hasOwnProperty(e.type)&&kl[e.type](e,t)}function It(e,t,a){var o=-1,r=e.length-a,n;for(t.lineStart();++o<r;)n=e[o],t.point(n[0],n[1],n[2]);t.lineEnd()}function Dt(e,t){var a=-1,o=e.length;for(t.polygonStart();++a<o;)It(e[a],t,1);t.polygonEnd()}function Pt(){function e(e,t){e*=Hn,t=t*Hn/2+i/4;var a=e-o,l=0<=a?1:-1,s=l*a,d=te(t),c=M(t),p=n*c,g=r*d+p*te(s),u=p*l*M(s);Tl.add(L(u,g)),o=e,r=d,n=c}var t,a,o,r,n;Al.point=function(l,s){Al.point=e,o=(t=l)*Hn,r=te(s=(a=s)*Hn/2+i/4),n=M(s)},Al.lineEnd=function(){e(t,a)}}function Ot(e){var t=e[0],a=e[1],o=te(a);return[o*te(t),o*M(t),M(a)]}function Rt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Mt(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function jt(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Bt(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Ft(e){var t=re(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Nt(e){return[L(e[1],e[0]),ve(e[2])]}function Vt(e,t){return Sn(e[0]-t[0])<Nn&&Sn(e[1]-t[1])<Nn}function Ut(e,t){e*=Hn;var a=te(t*=Hn);Ht(a*te(e),a*M(e),M(t))}function Ht(e,t,a){++El,Il+=(e-Il)/El,Dl+=(t-Dl)/El,Pl+=(a-Pl)/El}function Gt(){function e(e,r){e*=Hn;var i=te(r*=Hn),n=i*te(e),l=i*M(e),s=M(r),d=L(re((d=a*s-o*l)*d+(d=o*n-t*s)*d+(d=t*l-a*n)*d),t*n+a*l+o*s);zl+=d,Ol+=d*(t+(t=n)),Rl+=d*(a+(a=l)),Ml+=d*(o+(o=s)),Ht(t,a,o)}var t,a,o;Cl.point=function(r,i){r*=Hn;var n=te(i*=Hn);t=n*te(r),a=n*M(r),o=M(i),Cl.point=e,Ht(t,a,o)}}function Yt(){Cl.point=Ut}function qt(){function e(e,t){e*=Hn;var a=te(t*=Hn),n=a*te(e),l=a*M(e),s=M(t),d=r*s-i*l,c=i*n-o*s,p=o*l-r*n,g=re(d*d+c*c+p*p),h=o*n+r*l+i*s,u=g&&-_e(h)/g,m=L(g,h);jl+=u*d,Bl+=u*c,Fl+=u*p,zl+=m,Ol+=m*(o+(o=n)),Rl+=m*(r+(r=l)),Ml+=m*(i+(i=s)),Ht(o,r,i)}var t,a,o,r,i;Cl.point=function(n,l){t=n,a=l,Cl.point=e,n*=Hn;var s=te(l*=Hn);o=s*te(n),r=s*M(n),i=M(l),Ht(o,r,i)},Cl.lineEnd=function(){e(t,a),Cl.lineEnd=Yt,Cl.point=Ut}}function Wt(e,t){function a(a,o){return a=e(a,o),t(a[0],a[1])}return e.invert&&t.invert&&(a.invert=function(a,o){return a=t.invert(a,o),a&&e.invert(a[0],a[1])}),a}function Xt(){return!0}function Zt(e,t,a,o,r){var l=[],s=[];if(e.forEach(function(e){if(!(0>=(d=e.length-1))){var t=e[0],o=e[d],d;if(Vt(t,o)){r.lineStart();for(var c=0;c<d;++c)r.point((t=e[c])[0],t[1]);return void r.lineEnd()}var p=new Jt(t,e,null,!0),u=new Jt(t,null,p,!1);p.o=u,l.push(p),s.push(u),p=new Jt(o,e,null,!1),u=new Jt(o,null,p,!0),p.o=u,l.push(p),s.push(u)}}),s.sort(t),$t(l),$t(s),!!l.length){for(var d=0,c=a,p=s.length;d<p;++d)s[d].e=c=!c;for(var u=l[0],g,h;;){for(var m=u,y=!0;m.v;)if((m=m.n)===u)return;g=m.z,r.lineStart();do{if(m.v=m.o.v=!0,m.e){if(y)for(var d=0,p=g.length;d<p;++d)r.point((h=g[d])[0],h[1]);else o(m.x,m.n.x,1,r);m=m.n}else{if(y){g=m.p.z;for(var d=g.length-1;0<=d;--d)r.point((h=g[d])[0],h[1])}else o(m.x,m.p.x,-1,r);m=m.p}m=m.o,g=m.z,y=!y}while(!m.v);r.lineEnd()}}}function $t(e){if(r=e.length){for(var t=0,o=e[0],r,l;++t<r;)o.n=l=e[t],l.p=o,o=l;o.n=l=e[0],l.p=o}}function Jt(e,t,a,o){this.x=e,this.z=t,this.o=a,this.e=o,this.v=!1,this.n=this.p=null}function Kt(e,t,a,o){return function(r,l){function s(t,a){var o=r(t,a);e(t=o[0],a=o[1])&&l.point(t,a)}function d(e,t){var a=r(e,t);m.point(a[0],a[1])}function c(){f.point=d,m.lineStart()}function p(){f.point=s,m.lineEnd()}function u(e,t){k.push([e,t]);var a=r(e,t);b.point(a[0],a[1])}function g(){b.lineStart(),k=[]}function h(){u(k[0][0],k[0][1]),b.lineEnd();var e=b.clean(),t=x.buffer(),a=t.length,o;if(k.pop(),w.push(k),k=null,!!a){if(1&e){o=t[0];var a=o.length-1,r=-1,s;if(0<a){for(_||(l.polygonStart(),_=!0),l.lineStart();++r<a;)l.point((s=o[r])[0],s[1]);l.lineEnd()}return}1<a&&2&e&&t.push(t.pop().concat(t.shift())),v.push(t.filter(Qt))}}var m=t(l),y=r.invert(o[0],o[1]),f={point:s,lineStart:c,lineEnd:p,polygonStart:function(){f.point=u,f.lineStart=g,f.lineEnd=h,v=[],w=[]},polygonEnd:function(){f.point=s,f.lineStart=c,f.lineEnd=p,v=fn.merge(v);var e=ra(y,w);v.length?(!_&&(l.polygonStart(),_=!0),Zt(v,aa,e,a,l)):e&&(!_&&(l.polygonStart(),_=!0),l.lineStart(),a(null,null,1,l),l.lineEnd()),_&&(l.polygonEnd(),_=!1),v=w=null},sphere:function(){l.polygonStart(),l.lineStart(),a(null,null,1,l),l.lineEnd(),l.polygonEnd()}},x=ta(),b=t(x),_=!1,v,w,k;return f}}function Qt(e){return 1<e.length}function ta(){var e=[],t;return{lineStart:function(){e.push(t=[])},point:function(e,a){t.push([e,a])},lineEnd:j,buffer:function(){var a=e;return e=[],t=null,a},rejoin:function(){1<e.length&&e.push(e.pop().concat(e.shift()))}}}function aa(e,t){return(0>(e=e.x)[0]?e[1]-Un-Nn:Un-e[1])-(0>(t=t.x)[0]?t[1]-Un-Nn:Un-t[1])}function oa(e,t,a,o){var r=M(e-a),i,n;return Sn(r)>Nn?k((M(t)*(n=te(o))*M(a)-M(o)*(i=te(t))*M(e))/(i*n*r)):(t+o)/2}function ra(e,t){var a=e[0],o=e[1],r=[M(a),-te(a),0],l=0,s=0;Tl.reset();for(var d=0,c=t.length;d<c;++d){var n=t[d],p=n.length;if(p)for(var u=n[0],g=u[0],h=u[1]/2+i/4,m=M(h),y=te(h),f=1;;){f===p&&(f=0),e=n[f];var x=e[0],b=e[1]/2+i/4,_=M(b),v=te(b),w=x-g,T=0<=w?1:-1,A=T*w,S=A>i,C=m*_;if(Tl.add(L(C*T*M(A),y*v+C*te(A))),l+=S?w+T*Vn:w,S^g>=a^x>=a){var k=Mt(Ot(u),Ot(e));Ft(k);var E=Mt(r,k);Ft(E);var z=(S^0<=w?-1:1)*ve(E[2]);(o>z||o===z&&(k[0]||k[1]))&&(s+=S^0<=w?1:-1)}if(!f++)break;g=x,m=_,y=v,u=e}}return(l<-Nn||l<Nn&&Tl<-Nn)^1&s}function ia(e){function a(e,t){return te(e)*te(t)>n}function o(e,a,o){var r=Ot(e),l=Ot(a),s=[1,0,0],d=Mt(r,l),c=Rt(d,d),p=d[0],g=c-p*p;if(!g)return!o&&e;var h=Mt(s,d),m=Bt(s,n*c/g),y=Bt(d,-n*p/g);jt(m,y);var f=h,u=Rt(m,f),x=Rt(f,f),b=u*u-x*(Rt(m,m)-1);if(!(0>b)){var _=re(b),t=Bt(f,(-u-_)/x);if(jt(t,m),t=Nt(t),!o)return t;var v=e[0],w=a[0],k=e[1],T=a[1],A;w<v&&(A=v,v=w,w=A);var S=w-v,C=Sn(S-i)<Nn;if(!C&&T<k&&(A=k,k=T,T=A),C||S<Nn?C?0<k+T^t[1]<(Sn(t[0]-v)<Nn?k:T):k<=t[1]&&t[1]<=T:S>i^(v<=t[0]&&t[0]<=w)){var L=Bt(f,(-u+_)/x);return jt(L,m),[t,Nt(L)]}}}function r(t,a){var o=l?e:i-e,r=0;return t<-o?r|=1:t>o&&(r|=2),a<-o?r|=4:a>o&&(r|=8),r}var n=te(e),l=0<n,s=Sn(n)>Nn,d=Ba(e,6*Hn);return Kt(a,function(e){var n,d,p,u,g;return{lineStart:function(){u=p=!1,g=1},point:function(h,m){var y=[h,m],f=a(h,m),x=l?f?0:r(h,m):f?r(h+(0>h?i:-i),m):0,c;if(!n&&(u=p=f)&&e.lineStart(),f!==p&&(c=o(n,y),(Vt(n,c)||Vt(y,c))&&(y[0]+=Nn,y[1]+=Nn,f=a(y[0],y[1]))),f!==p)g=0,f?(e.lineStart(),c=o(y,n),e.point(c[0],c[1])):(c=o(n,y),e.point(c[0],c[1]),e.lineEnd()),n=c;else if(s&&n&&l^f){var b;!(x&d)&&(b=o(y,n,!0))&&(g=0,l?(e.lineStart(),e.point(b[0][0],b[0][1]),e.point(b[1][0],b[1][1]),e.lineEnd()):(e.point(b[1][0],b[1][1]),e.lineEnd(),e.lineStart(),e.point(b[0][0],b[0][1])))}!f||n&&Vt(n,y)||e.point(y[0],y[1]),n=y,p=f,d=x},lineEnd:function(){p&&e.lineEnd(),n=null},clean:function(){return g|(u&&p)<<1}}},d,l?[0,-e]:[-i,e-i])}function na(e,t,a,o){return function(i){var n=i.a,l=i.b,s=n.x,d=n.y,c=l.x,p=l.y,u=0,g=1,h=c-s,m=p-d,y;if(y=e-s,h||!(0<y)){if(y/=h,0>h){if(y<u)return;y<g&&(g=y)}else if(0<h){if(y>g)return;y>u&&(u=y)}if(y=a-s,h||!(0>y)){if(y/=h,0>h){if(y>g)return;y>u&&(u=y)}else if(0<h){if(y<u)return;y<g&&(g=y)}if(y=t-d,m||!(0<y)){if(y/=m,0>m){if(y<u)return;y<g&&(g=y)}else if(0<m){if(y>g)return;y>u&&(u=y)}if(y=o-d,m||!(0>y)){if(y/=m,0>m){if(y>g)return;y>u&&(u=y)}else if(0<m){if(y<u)return;y<g&&(g=y)}return 0<u&&(i.a={x:s+u*h,y:d+u*m}),1>g&&(i.b={x:s+g*h,y:d+g*m}),i}}}}}}function la(e,t,o,r){function i(a,r){return Sn(a[0]-e)<Nn?0<r?0:3:Sn(a[0]-o)<Nn?0<r?2:1:Sn(a[1]-t)<Nn?0<r?1:0:0<r?3:2}function n(e,t){return l(e.x,t.x)}function l(e,t){var a=i(e,1),o=i(t,1);return a===o?0===a?t[1]-e[1]:1===a?e[0]-t[0]:2===a?e[1]-t[1]:t[0]-e[0]:a-o}return function(a){function s(e){for(var t=0,o=_.length,r=e[1],n=0;n<o;++n)for(var l=1,s=_[n],d=s.length,c=s[0],p;l<d;++l)p=s[l],c[1]<=r?p[1]>r&&0<be(c,p,e)&&++t:p[1]<=r&&0>be(c,p,e)&&--t,c=p;return 0!==t}function d(n,s,d,c){var p=0,u=0;if(null==n||(p=i(n,d))!==(u=i(s,d))||0>l(n,s)^0<d)do c.point(0===p||3===p?e:o,1<p?r:t);while((p=(p+d+4)%4)!==u);else c.point(s[0],s[1])}function c(a,i){return e<=a&&a<=o&&t<=i&&i<=r}function p(e,t){c(e,t)&&a.point(e,t)}function u(){x.point=h,_&&_.push(w=[]),E=!0,L=!1,S=C=NaN}function g(){b&&(h(k,T),A&&L&&y.rejoin(),b.push(y.buffer())),x.point=p,L&&a.lineEnd()}function h(e,t){e=va(-1000000000,ie(1000000000,e)),t=va(-1000000000,ie(1000000000,t));var o=c(e,t);if(_&&w.push([e,t]),E)k=e,T=t,A=o,E=!1,o&&(a.lineStart(),a.point(e,t));else if(o&&L)a.point(e,t);else{var r={a:{x:S,y:C},b:{x:e,y:t}};f(r)?(!L&&(a.lineStart(),a.point(r.a.x,r.a.y)),a.point(r.b.x,r.b.y),!o&&a.lineEnd(),z=!1):o&&(a.lineStart(),a.point(e,t),z=!1)}S=e,C=t,L=o}var m=a,y=ta(),f=na(e,t,o,r),x={point:p,lineStart:u,lineEnd:g,polygonStart:function(){a=y,b=[],_=[],z=!0},polygonEnd:function(){a=m,b=fn.merge(b);var t=s([e,r]),o=z&&t,i=b.length;(o||i)&&(a.polygonStart(),o&&(a.lineStart(),d(null,null,1,a),a.lineEnd()),i&&Zt(b,n,t,d,a),a.polygonEnd()),b=_=w=null}},b,_,w,k,T,A,S,C,L,E,z;return x}}function sa(e){var t=0,a=i/3,o=za(e),r=o(t,a);return r.parallels=function(e){return arguments.length?o(t=e[0]*i/180,a=e[1]*i/180):[180*(t/i),180*(a/i)]},r}function da(e,t){function a(e,t){var a=re(i-2*r*M(t))/r;return[a*M(e*=r),n-a*te(e)]}var o=M(e),r=(o+M(t))/2,i=1+o*(2*r-o),n=re(i)/r;return a.invert=function(e,t){var a=n-t;return[L(e,a)/r,ve((i-(e*e+a*a)*r*r)/(2*r))]},a}function ca(){function e(e,t){Gl+=r*e-o*t,o=e,r=t}var t,a,o,r;Nl.point=function(i,n){Nl.point=e,t=o=i,a=r=n},Nl.lineEnd=function(){e(t,a)}}function pa(e,t){e<Yl&&(Yl=e),e>Wl&&(Wl=e),t<ql&&(ql=t),t>Xl&&(Xl=t)}function ua(){function e(e,t){n.push("M",e,",",t,i)}function t(e,t){n.push("M",e,",",t),l.point=a}function a(e,t){n.push("L",e,",",t)}function o(){l.point=e}function r(){n.push("Z")}var i=ga(4.5),n=[],l={point:e,lineStart:function(){l.point=t},lineEnd:o,polygonStart:function(){l.lineEnd=r},polygonEnd:function(){l.lineEnd=o,l.point=e},pointRadius:function(e){return i=ga(e),l},result:function(){if(n.length){var e=n.join("");return n=[],e}}};return l}function ga(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function ha(e,t){Il+=e,Dl+=t,++Pl}function ma(){function e(e,o){var r=e-t,i=o-a,n=re(r*r+i*i);Ol+=n*(t+e)/2,Rl+=n*(a+o)/2,Ml+=n,ha(t=e,a=o)}var t,a;Ul.point=function(o,r){Ul.point=e,ha(t=o,a=r)}}function ya(){Ul.point=ha}function fa(){function e(e,t){var a=e-o,i=t-r,n=re(a*a+i*i);Ol+=n*(o+e)/2,Rl+=n*(r+t)/2,Ml+=n,n=r*e-o*t,jl+=n*(o+e),Bl+=n*(r+t),Fl+=3*n,ha(o=e,r=t)}var t,a,o,r;Ul.point=function(i,n){Ul.point=e,ha(t=o=i,a=r=n)},Ul.lineEnd=function(){e(t,a)}}function xa(e){function t(t,a){e.moveTo(t+n,a),e.arc(t,a,n,0,Vn)}function a(t,a){e.moveTo(t,a),l.point=o}function o(t,a){e.lineTo(t,a)}function r(){l.point=t}function i(){e.closePath()}var n=4.5,l={point:t,lineStart:function(){l.point=a},lineEnd:r,polygonStart:function(){l.lineEnd=i},polygonEnd:function(){l.lineEnd=r,l.point=t},pointRadius:function(e){return n=e,l},result:j};return l}function ba(e){function t(e){return(l?o:a)(e)}function a(t){return La(t,function(a,o){a=e(a,o),t.point(a[0],a[1])})}function o(t){function a(a,o){a=e(a,o),t.point(a[0],a[1])}function o(){_=NaN,p.point=i,t.lineStart()}function i(a,o){var i=Ot([a,o]),n=e(a,o);r(_,v,b,w,k,T,_=n[0],v=n[1],b=a,w=i[0],k=i[1],T=i[2],l,t),t.point(_,v)}function n(){p.point=a,t.lineEnd()}function s(){o(),p.point=d,p.lineEnd=c}function d(e,t){i(u=e,g=t),h=_,m=v,y=w,f=k,x=T,p.point=i}function c(){r(_,v,b,w,k,T,h,m,u,y,f,x,l,t),p.lineEnd=n,n()}var p={point:a,lineStart:o,lineEnd:n,polygonStart:function(){t.polygonStart(),p.lineStart=s},polygonEnd:function(){t.polygonEnd(),p.lineStart=o}},u,g,h,m,y,f,x,b,_,v,w,k,T;return p}function r(t,o,l,s,d,u,g,h,y,f,x,v,w,k){var T=g-t,A=h-o,S=T*T+A*A;if(S>4*i&&w--){var C=s+f,E=d+x,z=u+v,I=re(C*C+E*E+z*z),m=_(z/=I),D=Sn(Sn(z)-1)<Nn||Sn(l-y)<Nn?(l+y)/2:L(E,C),P=e(D,m),p=P[0],O=P[1],R=p-t,M=O-o,j=A*R-T*M;(j*j/S>i||.3<Sn((T*R+A*M)/S-.5)||s*f+d*x+u*v<n)&&(r(t,o,l,s,d,u,p,O,D,C/=I,E/=I,z,w,k),k.point(p,O),r(p,O,D,C,E,z,g,h,y,f,x,v,w,k))}}var i=.5,n=te(30*Hn),l=16;return t.precision=function(e){return arguments.length?(l=0<(i=e*e)&&16,t):re(i)},t}function Ta(e){var t=ba(function(t,a){return e([t*Gn,a*Gn])});return function(e){return Ia(t(e))}}function Aa(e){this.stream=e}function La(e,t){return{point:t,sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}function Ea(e){return za(function(){return e})()}function za(e){function t(e){return e=w(e[0]*Hn,e[1]*Hn),[e[0]*n+T,A-e[1]*n]}function a(e){return e=w.invert((e[0]-T)/n,(A-e[1])/n),e&&[e[0]*Gn,e[1]*Gn]}function o(){w=Wt(v=Oa(p,u,g),_);var e=_(d,c);return T=l-e[0]*n,A=s+e[1]*n,r()}function r(){return S&&(S.valid=!1,S=null),t}var i=ba(function(e,t){return e=_(e,t),[e[0]*n+T,A-e[1]*n]}),n=150,l=480,s=250,d=0,c=0,p=0,u=0,g=0,h=Ll,m=C,f=null,b=null,_,v,w,T,A,S;return t.stream=function(e){return S&&(S.valid=!1),S=Ia(h(v,i(m(e)))),S.valid=!0,S},t.clipAngle=function(e){return arguments.length?(h=null==e?(f=e,Ll):ia((f=+e)*Hn),r()):f},t.clipExtent=function(e){return arguments.length?(b=e,m=e?la(e[0][0],e[0][1],e[1][0],e[1][1]):C,r()):b},t.scale=function(e){return arguments.length?(n=+e,o()):n},t.translate=function(e){return arguments.length?(l=+e[0],s=+e[1],o()):[l,s]},t.center=function(e){return arguments.length?(d=e[0]%360*Hn,c=e[1]%360*Hn,o()):[d*Gn,c*Gn]},t.rotate=function(e){return arguments.length?(p=e[0]%360*Hn,u=e[1]%360*Hn,g=2<e.length?e[2]%360*Hn:0,o()):[p*Gn,u*Gn,g*Gn]},fn.rebind(t,i,"precision"),function(){return _=e.apply(this,arguments),t.invert=_.invert&&a,o()}}function Ia(e){return La(e,function(t,a){e.point(t*Hn,a*Hn)})}function Da(e,t){return[e,t]}function Pa(e,t){return[e>i?e-Vn:e<-i?e+Vn:e,t]}function Oa(e,t,a){return e?t||a?Wt(Ma(e),ja(t,a)):Ma(e):t||a?ja(t,a):Pa}function Ra(e){return function(t,a){return t+=e,[t>i?t-Vn:t<-i?t+Vn:t,a]}}function Ma(e){var t=Ra(e);return t.invert=Ra(-e),t}function ja(e,t){function a(e,t){var a=te(t),l=te(e)*a,s=M(e)*a,d=M(t),c=d*o+l*r;return[L(s*i-c*n,l*o-d*r),ve(c*i+s*n)]}var o=te(e),r=M(e),i=te(t),n=M(t);return a.invert=function(e,t){var a=te(t),l=te(e)*a,s=M(e)*a,d=M(t),c=d*i-s*n;return[L(s*i+d*n,l*o+c*r),ve(c*o-l*r)]},a}function Ba(e,a){var o=te(e),r=M(e);return function(i,n,l,s){var d=l*a;null==i?(i=e+l*Vn,n=e-.5*d):(i=Fa(o,i),n=Fa(o,n),(0<l?i<n:i>n)&&(i+=l*Vn));for(var c=i,p;0<l?c>n:c<n;c-=d)s.point((p=Nt([o,-r*te(c),-r*M(c)]))[0],p[1])}}function Fa(e,t){var o=Ot(t);o[0]-=e,Ft(o);var a=_e(-o[1]);return((0>-o[2]?-a:a)+2*Sa-Nn)%(2*Sa)}function Na(e,t,a){var o=fn.range(e,t-Nn,a).concat(t);return function(e){return o.map(function(t){return[e,t]})}}function Va(e,t,a){var o=fn.range(e,t-Nn,a).concat(t);return function(e){return o.map(function(t){return[t,e]})}}function Ua(e){return e.source}function Ha(e){return e.target}function Ga(e,t,a,o){var r=te(t),i=M(t),n=te(o),l=M(o),s=r*te(e),c=r*M(e),p=n*te(a),u=n*M(a),g=2*_(re(Ae(o-t)+r*n*Ae(a-e))),d=1/M(g),h=g?function(e){var a=M(e*=g)*d,o=M(g-e)*d,r=o*s+a*p,n=o*c+a*u;return[L(n,r)*Gn,L(o*i+a*l,re(r*r+n*n))*Gn]}:function(){return[e*Gn,t*Gn]};return h.distance=g,h}function Ya(e,t){function a(t,a){var o=te(t),r=te(a),i=e(o*r);return[i*r*M(t),i*M(a)]}return a.invert=function(e,a){var o=re(e*e+a*a),r=t(o),i=M(r),n=te(r);return[L(e*i,o*n),_(o&&a*i/o)]},a}function qa(e,a){function o(e,a){0<n?a<-Un+Nn&&(a=-Un+Nn):a>Un-Nn&&(a=Un-Nn);var o=n/_a(l(a),t);return[o*M(t*e),n-o*te(t*e)]}var r=te(e),l=function(e){return g(i/4+e/2)},t=e===a?M(e):P(r/te(a))/P(l(a)/l(e)),n=r*_a(l(e),t)/t;return t?(o.invert=function(e,a){var o=n-a,r=xe(t)*re(e*e+o*o);return[L(e,o)/t,2*k(_a(n/r,1/t))-Un]},o):Xa}function Wa(e,t){function a(e,t){var a=i-t;return[a*M(r*e),i-a*te(r*e)]}var o=te(e),r=e===t?M(e):(o-te(t))/(t-e),i=o/r+e;return Sn(r)<Nn?Da:(a.invert=function(e,t){var a=i-t;return[L(e,a)/r,i-xe(r)*re(e*e+a*a)]},a)}function Xa(e,t){return[e,P(g(i/4+t/2))]}function Za(e){var a=Ea(e),o=a.scale,r=a.translate,n=a.clipExtent,l;return a.scale=function(){var e=o.apply(a,arguments);return e===a?l?a.clipExtent(null):a:e},a.translate=function(){var e=r.apply(a,arguments);return e===a?l?a.clipExtent(null):a:e},a.clipExtent=function(e){var s=n.apply(a,arguments);if(s!==a)l&&(s=null);else if(l=null==e){var d=i*o(),c=r();n([[c[0]-d,c[1]-d],[c[0]+d,c[1]+d]])}return s},a.clipExtent(null)}function $a(e,t){return[P(g(i/4+t/2)),-e]}function Ja(e){return e[0]}function Ka(e){return e[1]}function Qa(e){for(var t=e.length,a=[0,1],o=2,r=2;r<t;r++){for(;1<o&&0>=be(e[a[o-2]],e[a[o-1]],e[r]);)--o;a[o++]=r}return a.slice(0,o)}function eo(e,t){return e[0]-t[0]||e[1]-t[1]}function to(e,t,a){return(a[0]-t[0])*(e[1]-t[1])<(a[1]-t[1])*(e[0]-t[0])}function ao(e,t,o,a){var r=e[0],i=o[0],n=t[0]-r,l=a[0]-i,s=e[1],d=o[1],c=t[1]-s,p=a[1]-d,u=(l*(s-d)-p*(r-i))/(p*n-l*c);return[r+u*n,s+u*c]}function oo(e){var t=e[0],a=e[e.length-1];return!(t[0]-a[0]||t[1]-a[1])}function ro(){So(this),this.edge=this.site=this.circle=null}function io(e){var t=os.pop()||new ro;return t.site=e,t}function no(e){fo(e),ls.remove(e),os.push(e),So(e)}function lo(e){var t=e.circle,a=t.x,o=t.cy,r={x:a,y:o},i=e.P,n=e.N,l=[e];no(e);for(var s=i;s.circle&&Sn(a-s.circle.x)<Nn&&Sn(o-s.circle.cy)<Nn;)i=s.P,l.unshift(s),no(s),s=i;l.unshift(s),fo(s);for(var d=n;d.circle&&Sn(a-d.circle.x)<Nn&&Sn(o-d.circle.cy)<Nn;)n=d.N,l.push(d),no(d),d=n;l.push(d),fo(d);var c=l.length,p;for(p=1;p<c;++p)d=l[p],s=l[p-1],ko(d.edge,s.site,d.site,r);s=l[0],d=l[c-1],d.edge=vo(s.site,d.site,null,r),yo(s),yo(d)}function so(e){for(var t=e.x,a=e.y,o=ls._,r,i,n,l;o;)if(n=co(o,a)-t,n>Nn)o=o.L;else if(l=t-po(o,a),l>Nn){if(!o.R){r=o;break}o=o.R}else{n>-Nn?(r=o.P,i=o):l>-Nn?(r=o,i=o.N):r=i=o;break}var s=io(e);if(ls.insert(r,s),r||i){if(r===i)return fo(r),i=io(r.site),ls.insert(s,i),s.edge=i.edge=vo(r.site,s.site),yo(r),void yo(i);if(!i)return void(s.edge=vo(r.site,s.site));fo(r),fo(i);var c=r.site,p=c.x,u=c.y,g=e.x-p,h=e.y-u,m=i.site,y=m.x-p,f=m.y-u,x=2*(g*f-h*y),d=g*g+h*h,b=y*y+f*f,_={x:(f*d-h*b)/x+p,y:(g*b-y*d)/x+u};ko(i.edge,c,m,_),s.edge=vo(c,e,null,_),i.edge=vo(e,m,null,_),yo(r),yo(i)}}function co(e,t){var a=e.site,o=a.x,r=a.y,i=r-t;if(!i)return o;var n=e.P;if(!n)return-Infinity;a=n.site;var l=a.x,s=a.y,d=s-t;if(!d)return l;var c=l-o,p=1/i-1/d,u=c/d;return p?(-u+re(u*u-2*p*(c*c/(-2*d)-s+d/2+r-i/2)))/p+o:(o+l)/2}function po(e,t){var a=e.N;if(a)return co(a,t);var o=e.site;return o.y===t?o.x:1/0}function uo(e){this.site=e,this.edges=[]}function go(e){for(var t=e[0][0],a=e[1][0],o=e[0][1],r=e[1][1],i=ns,n=i.length,l,s,d,c,p,u,g,h,m,y;n--;)if(p=i[n],p&&p.prepare())for(g=p.edges,h=g.length,u=0;u<h;)y=g[u].end(),d=y.x,c=y.y,m=g[++u%h].start(),l=m.x,s=m.y,(Sn(d-l)>Nn||Sn(c-s)>Nn)&&(g.splice(u,0,new To(wo(p.site,y,Sn(d-t)<Nn&&r-c>Nn?{x:t,y:Sn(l-t)<Nn?s:r}:Sn(c-r)<Nn&&a-d>Nn?{x:Sn(s-r)<Nn?l:a,y:r}:Sn(d-a)<Nn&&c-o>Nn?{x:a,y:Sn(l-a)<Nn?s:o}:Sn(c-o)<Nn&&d-t>Nn?{x:Sn(s-o)<Nn?l:t,y:o}:null),p.site,null)),++h)}function ho(e,t){return t.angle-e.angle}function mo(){So(this),this.x=this.y=this.arc=this.site=this.cy=null}function yo(e){var t=e.P,a=e.N;if(t&&a){var o=t.site,r=e.site,i=a.site;if(o!==i){var l=r.x,s=r.y,c=o.x-l,p=o.y-s,u=i.x-l,g=i.y-s,h=2*(c*g-p*u);if(!(h>=-n)){var d=c*c+p*p,m=u*u+g*g,f=(g*d-p*m)/h,x=(c*m-u*d)/h,g=x+s,y=rs.pop()||new mo;y.arc=e,y.site=r,y.x=f+l,y.y=g+re(f*f+x*x),y.cy=g,e.circle=y;for(var b=null,_=ds._;_;)if(y.y<_.y||y.y===_.y&&y.x<=_.x){if(_.L)_=_.L;else{b=_.P;break}}else if(_.R)_=_.R;else{b=_;break}ds.insert(b,y),b||(ss=y)}}}}function fo(e){var t=e.circle;t&&(!t.P&&(ss=t.N),ds.remove(t),rs.push(t),So(t),e.circle=null)}function xo(t){for(var a=is,o=na(t[0][0],t[0][1],t[1][0],t[1][1]),r=a.length,n;r--;)n=a[r],(!bo(n,t)||!o(n)||Sn(n.a.x-n.b.x)<Nn&&Sn(n.a.y-n.b.y)<Nn)&&(n.a=n.b=null,a.splice(r,1))}function bo(e,t){var a=e.b;if(a)return!0;var o=e.a,r=t[0][0],i=t[1][0],n=t[0][1],l=t[1][1],s=e.l,d=e.r,c=s.x,p=s.y,u=d.x,g=d.y,h=(c+u)/2,m,y;if(g===p){if(h<r||h>=i)return;if(c>u){if(!o)o={x:h,y:n};else if(o.y>=l)return;a={x:h,y:l}}else{if(!o)o={x:h,y:l};else if(o.y<n)return;a={x:h,y:n}}}else if(m=(c-u)/(g-p),y=(p+g)/2-m*h,-1>m||1<m){if(c>u){if(!o)o={x:(n-y)/m,y:n};else if(o.y>=l)return;a={x:(l-y)/m,y:l}}else{if(!o)o={x:(l-y)/m,y:l};else if(o.y<n)return;a={x:(n-y)/m,y:n}}}else if(p<g){if(!o)o={x:r,y:m*r+y};else if(o.x>=i)return;a={x:i,y:m*i+y}}else{if(!o)o={x:i,y:m*i+y};else if(o.x<r)return;a={x:r,y:m*r+y}}return e.a=o,e.b=a,!0}function _o(e,t){this.l=e,this.r=t,this.a=this.b=null}function vo(e,t,a,o){var r=new _o(e,t);return is.push(r),a&&ko(r,e,t,a),o&&ko(r,t,e,o),ns[e.i].edges.push(new To(r,e,t)),ns[t.i].edges.push(new To(r,t,e)),r}function wo(e,t,a){var o=new _o(e,null);return o.a=t,o.b=a,is.push(o),o}function ko(e,t,a,o){e.a||e.b?e.l===a?e.b=o:e.a=o:(e.a=o,e.l=t,e.r=a)}function To(e,t,a){var o=e.a,r=e.b;this.edge=e,this.site=t,this.angle=a?L(a.y-t.y,a.x-t.x):e.l===t?L(r.x-o.x,o.y-r.y):L(o.x-r.x,r.y-o.y)}function Ao(){this._=null}function So(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function Co(e,t){var a=t,o=t.R,r=a.U;r?r.L===a?r.L=o:r.R=o:e._=o,o.U=r,a.U=o,a.R=o.L,a.R&&(a.R.U=a),o.L=a}function Lo(e,t){var a=t,o=t.L,r=a.U;r?r.L===a?r.L=o:r.R=o:e._=o,o.U=r,a.U=o,a.L=o.R,a.L&&(a.L.U=a),o.R=a}function Eo(e){for(;e.L;)e=e.L;return e}function zo(e,t){var a=e.sort(Io).pop(),o,r,i;for(is=[],ns=Array(e.length),ls=new Ao,ds=new Ao;;)if(i=ss,a&&(!i||a.y<i.y||a.y===i.y&&a.x<i.x))(a.x!==o||a.y!==r)&&(ns[a.i]=new uo(a),so(a),o=a.x,r=a.y),a=e.pop();else if(i)lo(i.arc);else break;t&&(xo(t),go(t));var n={cells:ns,edges:is};return ls=ds=is=ns=null,n}function Io(e,t){return t.y-e.y||t.x-e.x}function Do(e,t,a){return(e.x-a.x)*(t.y-e.y)-(e.x-t.x)*(a.y-e.y)}function Po(e){return e.x}function Oo(e){return e.y}function Ro(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Mo(e,t,a,o,r,i){if(!e(t,a,o,r,i)){var n=.5*(a+r),l=.5*(o+i),s=t.nodes;s[0]&&Mo(e,s[0],a,o,n,l),s[1]&&Mo(e,s[1],n,o,r,l),s[2]&&Mo(e,s[2],a,l,n,i),s[3]&&Mo(e,s[3],n,l,r,i)}}function jo(e,t,a,o,r,n,l){var i=1/0,s;return function e(d,c,p,u,g){if(!(c>n||p>l||u<o||g<r)){if(f=d.point){var h=t-d.x,m=a-d.y,y=h*h+m*m,f;if(y<i){var x=re(i=y);o=t-x,r=a-x,n=t+x,l=a+x,s=f}}for(var b=d.nodes,_=.5*(c+u),v=.5*(p+g),w=(a>=v)<<1|t>=_;void 0>w;++w)if(d=b[3&w])switch(3&w){case 0:e(d,c,p,_,v);break;case 1:e(d,_,p,u,v);break;case 2:e(d,c,v,_,g);break;case 3:e(d,_,v,u,g);}}}(e,o,r,n,l),s}function Bo(e,t){e=fn.rgb(e),t=fn.rgb(t);var o=e.r,r=e.g,i=e.b,n=t.r-o,l=t.g-r,s=t.b-i;return function(e){return"#"+Ne(R(o+n*e))+Ne(R(r+l*e))+Ne(R(i+s*e))}}function Fo(e,t){var a={},o={},r;for(r in e)r in t?a[r]=Uo(e[r],t[r]):o[r]=e[r];for(r in t)r in e||(o[r]=t[r]);return function(e){for(r in a)o[r]=a[r](e);return o}}function No(e,o){return e=+e,o=+o,function(a){return e*(1-a)+o*a}}function Vo(e,r){var t=ps.lastIndex=us.lastIndex=0,o=-1,n=[],l=[],s,d,c;for(e+="",r+="";(s=ps.exec(e))&&(d=us.exec(r));)(c=d.index)>t&&(c=r.slice(t,c),n[o]?n[o]+=c:n[++o]=c),(s=s[0])===(d=d[0])?n[o]?n[o]+=d:n[++o]=d:(n[++o]=null,l.push({i:o,x:No(s,d)})),t=us.lastIndex;return t<r.length&&(c=r.slice(t),n[o]?n[o]+=c:n[++o]=c),2>n.length?l[0]?(r=l[0].x,function(e){return r(e)+""}):function(){return r}:(r=l.length,function(e){for(var t=0,a;t<r;++t)n[(a=l[t]).i]=a.x(e);return n.join("")})}function Uo(e,t){for(var a=fn.interpolators.length,o;0<=--a&&!(o=fn.interpolators[a](e,t)););return o}function Ho(e,t){var a=[],o=[],r=e.length,n=t.length,l=ie(e.length,t.length),s;for(s=0;s<l;++s)a.push(Uo(e[s],t[s]));for(;s<r;++s)o[s]=e[s];for(;s<n;++s)o[s]=t[s];return function(e){for(s=0;s<l;++s)o[s]=a[s](e);return o}}function Go(e){return function(a){return 0>=a?0:1<=a?1:e(a)}}function Yo(e){return function(a){return 1-e(1-a)}}function qo(e){return function(a){return .5*(.5>a?e(2*a):2-e(2-2*a))}}function Wo(e){return e*e}function Xo(e){return e*e*e}function Zo(e){if(0>=e)return 0;if(1<=e)return 1;var t=e*e,a=t*e;return 4*(.5>e?a:3*(e-t)+a-.75)}function $o(e){return 1-te(e*Un)}function Jo(e){return _a(2,10*(e-1))}function Ko(e){return 1-re(1-e*e)}function Qo(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function er(e,a){return a-=e,function(o){return R(e+a*o)}}function tr(e){var t=[e.a,e.b],a=[e.c,e.d],o=or(t),r=ar(t,a),i=or(rr(a,t,-r))||0;t[0]*a[1]<a[0]*t[1]&&(t[0]*=-1,t[1]*=-1,o*=-1,r*=-1),this.rotate=(o?L(t[1],t[0]):L(-a[0],a[1]))*Gn,this.translate=[e.e,e.f],this.scale=[o,i],this.skew=i?L(r,i)*Gn:0}function ar(e,t){return e[0]*t[0]+e[1]*t[1]}function or(e){var t=re(ar(e,e));return t&&(e[0]/=t,e[1]/=t),t}function rr(e,t,a){return e[0]+=a*t[0],e[1]+=a*t[1],e}function ir(e){return e.length?e.pop()+",":""}function nr(e,t,a,o){if(e[0]!==t[0]||e[1]!==t[1]){var r=a.push("translate(",null,",",null,")");o.push({i:r-4,x:No(e[0],t[0])},{i:r-2,x:No(e[1],t[1])})}else(t[0]||t[1])&&a.push("translate("+t+")")}function lr(e,t,a,o){e===t?t&&a.push(ir(a)+"rotate("+t+")"):(180<e-t?t+=360:180<t-e&&(e+=360),o.push({i:a.push(ir(a)+"rotate(",null,")")-2,x:No(e,t)}))}function sr(e,t,a,o){e===t?t&&a.push(ir(a)+"skewX("+t+")"):o.push({i:a.push(ir(a)+"skewX(",null,")")-2,x:No(e,t)})}function dr(e,t,a,o){if(e[0]!==t[0]||e[1]!==t[1]){var r=a.push(ir(a)+"scale(",null,",",null,")");o.push({i:r-4,x:No(e[0],t[0])},{i:r-2,x:No(e[1],t[1])})}else(1!==t[0]||1!==t[1])&&a.push(ir(a)+"scale("+t+")")}function cr(e,t){var r=[],l=[];return e=fn.transform(e),t=fn.transform(t),nr(e.translate,t.translate,r,l),lr(e.rotate,t.rotate,r,l),sr(e.skew,t.skew,r,l),dr(e.scale,t.scale,r,l),e=t=null,function(e){for(var t=-1,a=l.length,n;++t<a;)r[(n=l[t]).i]=n.x(e);return r.join("")}}function pr(e,t){return t=(t-=e=+e)||1/t,function(a){return(a-e)/t}}function ur(e,t){return t=(t-=e=+e)||1/t,function(a){return va(0,ie(1,(a-e)/t))}}function gr(e){for(var t=e.source,a=e.target,o=mr(t,a),r=[t];t!==o;)t=t.parent,r.push(t);for(var i=r.length;a!==o;)r.splice(i,0,a),a=a.parent;return r}function hr(e){for(var t=[],a=e.parent;null!=a;)t.push(e),e=a,a=a.parent;return t.push(e),t}function mr(e,t){if(e===t)return e;for(var a=hr(e),o=hr(t),r=a.pop(),i=o.pop(),n=null;r===i;)n=r,r=a.pop(),i=o.pop();return n}function yr(e){e.fixed|=2}function fr(e){e.fixed&=-7}function xr(e){e.fixed|=4,e.px=e.x,e.py=e.y}function br(e){e.fixed&=-5}function _r(e,t,a){var o=0,r=0;if(e.charge=0,!e.leaf)for(var l=e.nodes,s=l.length,n=-1,d;++n<s;)d=l[n],null==d||(_r(d,t,a),e.charge+=d.charge,o+=d.charge*d.cx,r+=d.charge*d.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var p=t*a[e.point.index];e.charge+=e.pointCharge=p,o+=p*e.point.x,r+=p*e.point.y}e.cx=o/e.charge,e.cy=r/e.charge}function vr(e,t){return fn.rebind(e,t,"sort","children","value"),e.nodes=e,e.links=Cr,e}function wr(e,t){for(var a=[e];null!=(e=a.pop());)if(t(e),(r=e.children)&&(o=r.length))for(var o,r;0<=--o;)a.push(r[o])}function kr(e,t){for(var a=[e],o=[];null!=(e=a.pop());)if(o.push(e),(s=e.children)&&(l=s.length))for(var r=-1,l,s;++r<l;)a.push(s[r]);for(;null!=(e=o.pop());)t(e)}function Tr(e){return e.children}function Ar(e){return e.value}function Sr(e,t){return t.value-e.value}function Cr(e){return fn.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function Lr(e){return e.x}function Er(e){return e.y}function zr(e,t,a){e.y0=t,e.y=a}function Ir(e){return fn.range(e.length)}function Dr(e){for(var t=-1,a=e[0].length,o=[];++t<a;)o[t]=0;return o}function Pr(e){for(var t=1,a=0,o=e[0][1],r=e.length,n;t<r;++t)(n=e[t][1])>o&&(a=t,o=n);return a}function Or(e){return e.reduce(Rr,0)}function Rr(e,t){return e+t[1]}function Mr(e,t){return jr(e,ae(P(t.length)/E+1))}function jr(e,t){for(var a=-1,o=+e[0],r=(e[1]-o)/t,i=[];++a<=t;)i[a]=r*a+o;return i}function Br(e){return[fn.min(e),fn.max(e)]}function Fr(e,t){return e.value-t.value}function Nr(e,t){var a=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=a,a._pack_prev=t}function Vr(e,t){e._pack_next=t,t._pack_prev=e}function Ur(e,t){var a=t.x-e.x,o=t.y-e.y,r=e.r+t.r;return .999*r*r>a*a+o*o}function Hr(e){function t(e){o=ie(e.x-e.r,o),r=va(e.x+e.r,r),l=ie(e.y-e.r,l),s=va(e.y+e.r,s)}if((d=e.children)&&(f=d.length)){var o=1/0,r=-Infinity,l=1/0,s=-Infinity,d,p,u,g,h,m,y,f;if(d.forEach(Gr),p=d[0],p.x=-p.r,p.y=0,t(p),1<f&&(u=d[1],u.x=u.r,u.y=0,t(u),2<f))for(g=d[2],Wr(p,u,g),t(g),Nr(p,g),p._pack_prev=g,Nr(g,u),u=p._pack_next,h=3;h<f;h++){Wr(p,u,g=d[h]);var x=0,_=1,v=1;for(m=u._pack_next;m!==u;m=m._pack_next,_++)if(Ur(m,g)){x=1;break}if(1==x)for(y=p._pack_prev;y!==m._pack_prev&&!Ur(y,g);y=y._pack_prev,v++);x?(_<v||_==v&&u.r<p.r?Vr(p,u=m):Vr(p=y,u),h--):(Nr(p,g),u=g,t(g))}var w=(o+r)/2,T=(l+s)/2,A=0;for(h=0;h<f;h++)g=d[h],g.x-=w,g.y-=T,A=va(A,g.r+re(g.x*g.x+g.y*g.y));e.r=A,d.forEach(Yr)}}function Gr(e){e._pack_next=e._pack_prev=e}function Yr(e){delete e._pack_next,delete e._pack_prev}function qr(e,t,a,o){var r=e.children;if(e.x=t+=o*e.x,e.y=a+=o*e.y,e.r*=o,r)for(var l=-1,s=r.length;++l<s;)qr(r[l],t,a,o)}function Wr(e,t,a){var o=e.r+a.r,r=t.x-e.x,i=t.y-e.y;if(o&&(r||i)){var n=t.r+a.r,l=r*r+i*i;n*=n,o*=o;var s=.5+(o-n)/(2*l),d=re(va(0,2*n*(o+l)-(o-=l)*o-n*n))/(2*l);a.x=e.x+s*r+d*i,a.y=e.y+s*i-d*r}else a.x=e.x+o,a.y=e.y}function Xr(e,t){return e.parent==t.parent?1:2}function Zr(e){var t=e.children;return t.length?t[0]:e.t}function $r(e){var t=e.children,a;return(a=t.length)?t[a-1]:e.t}function Jr(e,t,a){var o=a/(t.i-e.i);t.c-=o,t.s+=a,e.c+=o,t.z+=a,t.m+=a}function Kr(e){for(var t=0,a=0,o=e.children,r=o.length,n;0<=--r;)n=o[r],n.z+=t,n.m+=t,t+=n.s+(a+=n.c)}function Qr(e,t,a){return e.a.parent===t.parent?e.a:a}function ei(e){return 1+fn.max(e,function(e){return e.y})}function ti(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function ai(e){var t=e.children;return t&&t.length?ai(t[0]):e}function oi(e){var t=e.children,a;return t&&(a=t.length)?oi(t[a-1]):e}function ri(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function ii(e,t){var a=e.x+t[3],o=e.y+t[0],r=e.dx-t[1]-t[3],i=e.dy-t[0]-t[2];return 0>r&&(a+=r/2,r=0),0>i&&(o+=i/2,i=0),{x:a,y:o,dx:r,dy:i}}function ni(e){var t=e[0],a=e[e.length-1];return t<a?[t,a]:[a,t]}function li(e){return e.rangeExtent?e.rangeExtent():ni(e.range())}function si(e,t,a,o){var r=a(e[0],e[1]),n=o(t[0],t[1]);return function(e){return n(r(e))}}function di(e,t){var a=0,o=e.length-1,r=e[a],i=e[o],n;return i<r&&(n=a,a=o,o=n,n=r,r=i,i=n),e[a]=t.floor(r),e[o]=t.ceil(i),e}function ci(e){return e?{floor:function(t){return ea(t/e)*e},ceil:function(t){return ae(t/e)*e}}:ks}function pi(e,t,a,o){var r=[],n=[],i=0,l=ie(e.length,t.length)-1;for(e[l]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<=l;)r.push(a(e[i-1],e[i])),n.push(o(t[i-1],t[i]));return function(t){var a=fn.bisect(e,t,1,l)-1;return n[a](r[a](t))}}function ui(e,t,a,o){function r(){var r=2<ie(e.length,t.length)?pi:si,s=o?ur:pr;return n=r(e,t,s,a),l=r(t,e,s,Uo),i}function i(e){return n(e)}var n,l;return i.invert=function(e){return l(e)},i.domain=function(t){return arguments.length?(e=t.map(Number),r()):e},i.range=function(e){return arguments.length?(t=e,r()):t},i.rangeRound=function(e){return i.range(e).interpolate(er)},i.clamp=function(e){return arguments.length?(o=e,r()):o},i.interpolate=function(e){return arguments.length?(a=e,r()):a},i.ticks=function(t){return yi(e,t)},i.tickFormat=function(t,a){return fi(e,t,a)},i.nice=function(t){return hi(e,t),r()},i.copy=function(){return ui(e,t,a,o)},r()}function gi(e,t){return fn.rebind(e,t,"range","rangeRound","interpolate","clamp")}function hi(e,t){return di(e,ci(mi(e,t)[2])),di(e,ci(mi(e,t)[2])),e}function mi(e,t){null==t&&(t=10);var a=ni(e),o=a[1]-a[0],r=_a(10,ea(P(o/t)/z)),i=t/o*r;return .15>=i?r*=10:.35>=i?r*=5:.75>=i&&(r*=2),a[0]=ae(a[0]/r)*r,a[1]=ea(a[1]/r)*r+.5*r,a[2]=r,a}function yi(e,t){return fn.range.apply(fn,mi(e,t))}function fi(e,t,a){var o=mi(e,t);if(a){var r=pl.exec(a);if(r.shift(),"s"===r[8]){var i=fn.formatPrefix(va(Sn(o[0]),Sn(o[1])));return r[7]||(r[7]="."+xi(i.scale(o[2]))),r[8]="f",a=fn.format(r.join("")),function(e){return a(i.scale(e))+i.symbol}}r[7]||(r[7]="."+bi(r[8],o)),a=r.join("")}else a=",."+xi(o[2])+"f";return fn.format(a)}function xi(e){return-ea(P(e)/z+.01)}function bi(e,t){var a=xi(t[2]);return e in Ts?wa(a-xi(va(Sn(t[0]),Sn(t[1]))))+ +("e"!==e):a-2*("%"===e)}function _i(e,t,a,o){function r(e){return(a?P(0>e?0:e):-P(0<e?0:-e))/P(t)}function l(e){return a?_a(t,e):-_a(t,-e)}function s(t){return e(r(t))}return s.invert=function(t){return l(e.invert(t))},s.domain=function(t){return arguments.length?(a=0<=t[0],e.domain((o=t.map(Number)).map(r)),s):o},s.base=function(a){return arguments.length?(t=+a,e.domain(o.map(r)),s):t},s.nice=function(){var t=di(o.map(r),a?Math:Ss);return e.domain(t),o=t.map(l),s},s.ticks=function(){var e=ni(o),s=[],d=e[0],c=e[1],p=ea(r(d)),u=ae(r(c)),g=t%1?2:t;if(isFinite(u-p)){if(a){for(;p<u;p++)for(var n=1;n<g;n++)s.push(l(p)*n);s.push(l(p))}else for(s.push(l(p));p++<u;)for(var n=g-1;0<n;n--)s.push(l(p)*n);for(p=0;s[p]<d;p++);for(u=s.length;s[u-1]>c;u--);s=s.slice(p,u)}return s},s.tickFormat=function(e,a){if(!arguments.length)return As;2>arguments.length?a=As:"function"!=typeof a&&(a=fn.format(a));var o=va(1,t*e/s.ticks().length);return function(e){var n=e/l(R(r(e)));return n*t<t-.5&&(n*=t),n<=o?a(e):""}},s.copy=function(){return _i(e.copy(),t,a,o)},gi(s,e)}function vi(e,t,a){function o(t){return e(r(t))}var r=wi(t),i=wi(1/t);return o.invert=function(t){return i(e.invert(t))},o.domain=function(t){return arguments.length?(e.domain((a=t.map(Number)).map(r)),o):a},o.ticks=function(e){return yi(a,e)},o.tickFormat=function(e,t){return fi(a,e,t)},o.nice=function(e){return o.domain(hi(a,e))},o.exponent=function(n){return arguments.length?(r=wi(t=n),i=wi(1/t),e.domain(a.map(r)),o):t},o.copy=function(){return vi(e.copy(),t,a)},gi(o,e)}function wi(t){return function(e){return 0>e?-_a(-e,t):_a(e,t)}}function ki(e,t){function a(a){return i[((r.get(a)||("range"===t.t?r.set(a,e.push(a)):NaN))-1)%i.length]}function o(t,a){return fn.range(e.length).map(function(e){return t+a*e})}var r,i,n;return a.domain=function(o){if(!arguments.length)return e;e=[],r=new h;for(var l=-1,s=o.length,n;++l<s;)r.has(n=o[l])||r.set(n,e.push(n));return a[t.t].apply(a,t.a)},a.range=function(e){return arguments.length?(i=e,n=0,t={t:"range",a:arguments},a):i},a.rangePoints=function(r,l){2>arguments.length&&(l=0);var s=r[0],d=r[1],c=2>e.length?(s=(s+d)/2,0):(d-s)/(e.length-1+l);return i=o(s+c*l/2,c),n=0,t={t:"rangePoints",a:arguments},a},a.rangeRoundPoints=function(r,l){2>arguments.length&&(l=0);var s=r[0],d=r[1],c=2>e.length?(s=d=R((s+d)/2),0):0|(d-s)/(e.length-1+l);return i=o(s+R(c*l/2+(d-s-(e.length-1+l)*c)/2),c),n=0,t={t:"rangeRoundPoints",a:arguments},a},a.rangeBands=function(r,l,s){2>arguments.length&&(l=0),3>arguments.length&&(s=l);var d=r[1]<r[0],c=r[d-0],p=r[1-d],u=(p-c)/(e.length-l+2*s);return i=o(c+u*s,u),d&&i.reverse(),n=u*(1-l),t={t:"rangeBands",a:arguments},a},a.rangeRoundBands=function(r,l,s){2>arguments.length&&(l=0),3>arguments.length&&(s=l);var d=r[1]<r[0],c=r[d-0],p=r[1-d],u=ea((p-c)/(e.length-l+2*s));return i=o(c+R((p-c-(e.length-l)*u)/2),u),d&&i.reverse(),n=R(u*(1-l)),t={t:"rangeRoundBands",a:arguments},a},a.rangeBand=function(){return n},a.rangeExtent=function(){return ni(t.a[0])},a.copy=function(){return ki(e,t)},a.domain(e)}function Ti(e,t){function a(){var a=0,r=t.length;for(i=[];++a<r;)i[a-1]=fn.quantile(e,a/r);return o}function o(e){if(!isNaN(e=+e))return t[fn.bisect(i,e)]}var i;return o.domain=function(t){return arguments.length?(e=t.map(l).filter(s).sort(r),a()):e},o.range=function(e){return arguments.length?(t=e,a()):t},o.quantiles=function(){return i},o.invertExtent=function(a){return a=t.indexOf(a),0>a?[NaN,NaN]:[0<a?i[a-1]:e[0],a<i.length?i[a]:e[e.length-1]]},o.copy=function(){return Ti(e,t)},a()}function Ai(e,t,a){function o(t){return a[va(0,ie(l,ea(n*(t-e))))]}function r(){return n=a.length/(t-e),l=a.length-1,o}var n,l;return o.domain=function(a){return arguments.length?(e=+a[0],t=+a[a.length-1],r()):[e,t]},o.range=function(e){return arguments.length?(a=e,r()):a},o.invertExtent=function(t){return t=a.indexOf(t),t=0>t?NaN:t/n+e,[t,t+1/n]},o.copy=function(){return Ai(e,t,a)},r()}function Si(e,t){function a(a){if(a<=a)return t[fn.bisect(e,a)]}return a.domain=function(t){return arguments.length?(e=t,a):e},a.range=function(e){return arguments.length?(t=e,a):t},a.invertExtent=function(a){return a=t.indexOf(a),[e[a-1],e[a]]},a.copy=function(){return Si(e,t)},a}function Ci(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(a){return arguments.length?(e=a.map(t),t):e},t.ticks=function(t){return yi(e,t)},t.tickFormat=function(t,a){return fi(e,t,a)},t.copy=function(){return Ci(e)},t}function Li(){return 0}function Ei(e){return e.innerRadius}function zi(e){return e.outerRadius}function Ii(e){return e.startAngle}function Di(e){return e.endAngle}function Pi(e){return e&&e.padAngle}function Oi(e,t,a,o){return 0<(e-a)*t-(t-o)*e?0:1}function Ri(e,t,a,o,i){var n=e[0]-t[0],l=e[1]-t[1],s=(i?o:-o)/re(n*n+l*l),c=s*l,p=-s*n,u=e[0]+c,g=e[1]+p,h=t[0]+c,m=t[1]+p,y=(u+h)/2,f=(g+m)/2,x=h-u,b=m-g,_=x*x+b*b,v=a-o,r=u*m-h*g,w=(0>b?-1:1)*re(va(0,v*v*_-r*r)),d=(r*b-x*w)/_,k=(-r*x-b*w)/_,T=(r*b+x*w)/_,A=(-r*x+b*w)/_,S=d-y,C=k-f,L=T-y,E=A-f;return S*S+C*C>L*L+E*E&&(d=T,k=A),[[d-c,k-p],[d*a/v,k*a/v]]}function Mi(e){function t(t){function s(){c.push("M",i(e(p),l))}for(var c=[],p=[],u=-1,g=t.length,n=qe(a),h=qe(o),m;++u<g;)r.call(this,m=t[u],u)?p.push([+n.call(this,m,u),+h.call(this,m,u)]):p.length&&(s(),p=[]);return p.length&&s(),c.length?c.join(""):null}var a=Ja,o=Ka,r=Xt,i=ji,n=i.key,l=.7;return t.x=function(e){return arguments.length?(a=e,t):a},t.y=function(e){return arguments.length?(o=e,t):o},t.defined=function(e){return arguments.length?(r=e,t):r},t.interpolate=function(e){return arguments.length?(n="function"==typeof e?i=e:(i=Ds.get(e)||ji).key,t):n},t.tension=function(e){return arguments.length?(l=e,t):l},t}function ji(e){return 1<e.length?e.join("L"):e+"Z"}function Bi(e){return e.join("L")+"Z"}function Fi(e){for(var t=0,a=e.length,o=e[0],r=[o[0],",",o[1]];++t<a;)r.push("V",(o=e[t])[1],"H",o[0]);return r.join("")}function Ni(e){for(var t=0,a=e.length,o=e[0],r=[o[0],",",o[1]];++t<a;)r.push("H",(o=e[t])[0],"V",o[1]);return r.join("")}function Vi(e,a){if(1>a.length||e.length!=a.length&&e.length!=a.length+2)return ji(e);var o=e.length!=a.length,r="",n=e[0],l=e[1],s=a[0],d=s,c=1;if(o&&(r+="Q"+(l[0]-2*s[0]/3)+","+(l[1]-2*s[1]/3)+","+l[0]+","+l[1],n=e[1],c=2),1<a.length){d=a[1],l=e[c],c++,r+="C"+(n[0]+s[0])+","+(n[1]+s[1])+","+(l[0]-d[0])+","+(l[1]-d[1])+","+l[0]+","+l[1];for(var u=2;u<a.length;u++,c++)l=e[c],d=a[u],r+="S"+(l[0]-d[0])+","+(l[1]-d[1])+","+l[0]+","+l[1]}if(o){var g=e[c];r+="Q"+(l[0]+2*d[0]/3)+","+(l[1]+2*d[1]/3)+","+g[0]+","+g[1]}return r}function Ui(e,t){for(var o=[],r=(1-t)/2,a=e[0],l=e[1],s=1,d=e.length,n;++s<d;)n=a,a=l,l=e[s],o.push([r*(l[0]-n[0]),r*(l[1]-n[1])]);return o}function Hi(e){if(3>e.length)return ji(e);var t=1,a=e.length,o=e[0],r=o[0],n=o[1],l=[r,r,r,(o=e[1])[0]],s=[n,n,n,o[1]],d=[r,",",n,"L",Gi(Rs,l),",",Gi(Rs,s)];for(e.push(e[a-1]);++t<=a;)o=e[t],l.shift(),l.push(o[0]),s.shift(),s.push(o[1]),Yi(d,l,s);return e.pop(),d.push("L",o),d.join("")}function Gi(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Yi(e,t,a){e.push("C",Gi(Ps,t),",",Gi(Ps,a),",",Gi(Os,t),",",Gi(Os,a),",",Gi(Rs,t),",",Gi(Rs,a))}function qi(e,t){return(t[1]-e[1])/(t[0]-e[0])}function Wi(e){for(var t=0,a=e.length-1,o=[],r=e[0],n=e[1],l=o[0]=qi(r,n);++t<a;)o[t]=(l+(l=qi(r=n,n=e[t+1])))/2;return o[t]=l,o}function Xi(e){for(var t=[],o=Wi(e),r=-1,n=e.length-1,l,c,p,u;++r<n;)l=qi(e[r],e[r+1]),Sn(l)<Nn?o[r]=o[r+1]=0:(c=o[r]/l,p=o[r+1]/l,u=c*c+p*p,9<u&&(u=3*l/re(u),o[r]=u*c,o[r+1]=u*p));for(r=-1;++r<=n;)u=(e[ie(n,r+1)][0]-e[va(0,r-1)][0])/(6*(1+o[r]*o[r])),t.push([u||0,o[r]*u||0]);return t}function Zi(e){for(var t=-1,o=e.length,n,l,s;++t<o;)n=e[t],l=n[0],s=n[1]-Un,n[0]=l*te(s),n[1]=l*M(s);return e}function $i(e){function t(t){function c(){g.push("M",d(e(m),i),u,p(e(h.reverse()),i),"Z")}for(var g=[],h=[],m=[],f=-1,b=t.length,n=qe(a),_=qe(r),v=a===o?function(){return T}:qe(o),w=r===l?function(){return A}:qe(l),k,T,A;++f<b;)s.call(this,k=t[f],f)?(h.push([T=+n.call(this,k,f),A=+_.call(this,k,f)]),m.push([+v.call(this,k,f),+w.call(this,k,f)])):h.length&&(c(),h=[],m=[]);return h.length&&c(),g.length?g.join(""):null}var a=Ja,o=Ja,r=0,l=Ka,s=Xt,d=ji,c=d.key,p=d,u="L",i=.7;return t.x=function(e){return arguments.length?(a=o=e,t):o},t.x0=function(e){return arguments.length?(a=e,t):a},t.x1=function(e){return arguments.length?(o=e,t):o},t.y=function(e){return arguments.length?(r=l=e,t):l},t.y0=function(e){return arguments.length?(r=e,t):r},t.y1=function(e){return arguments.length?(l=e,t):l},t.defined=function(e){return arguments.length?(s=e,t):s},t.interpolate=function(e){return arguments.length?(c="function"==typeof e?d=e:(d=Ds.get(e)||ji).key,p=d.reverse||d,u=d.closed?"M":"L",t):c},t.tension=function(e){return arguments.length?(i=e,t):i},t}function Ji(e){return e.radius}function Ki(e){return[e.x,e.y]}function Qi(e){return function(){var t=e.apply(this,arguments),o=t[0],r=t[1]-Un;return[o*te(r),o*M(r)]}}function en(){return 64}function tn(){return"circle"}function an(e){var t=re(e/i);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function on(e){return function(){var t,a,o;(t=this[e])&&(o=t[a=t.active])&&(o.timer.c=null,o.timer.t=NaN,--t.count?delete t[a]:delete this[e],t.active+=.5,o.event&&o.event.interrupt.call(this,this.__data__,o.index))}}function rn(e,t,a){return En(e,Ns),e.namespace=t,e.id=a,e}function nn(e,t,a,o){var r=e.id,n=e.namespace;return de(e,"function"==typeof a?function(e,l,i){e[n][r].tween.set(t,o(a.call(e,e.__data__,l,i)))}:(a=o(a),function(e){e[n][r].tween.set(t,a)}))}function ln(e){return null==e&&(e=""),function(){this.textContent=e}}function sn(e){return null==e?"__transition__":"__transition_"+e+"__"}function dn(a,o,r,i,e){function t(e){var t=d.delay;return p.t=t+c,t<=e?n(e-t):void(p.c=n)}function n(e){var t=s.active,r=s[t];for(var n in r&&(r.timer.c=null,r.timer.t=NaN,--s.count,delete s[t],r.event&&r.event.interrupt.call(a,a.__data__,r.index)),s)if(+n<i){var h=s[n];h.timer.c=null,h.timer.t=NaN,--s.count,delete s[n]}p.c=l,Je(function(){return p.c&&l(e||1)&&(p.c=null,p.t=NaN),1},0,c),s.active=i,d.event&&d.event.start.call(a,a.__data__,o),m=[],d.tween.forEach(function(e,t){(t=t.call(a,a.__data__,o))&&m.push(t)}),g=d.ease,u=d.duration}function l(l){for(var c=l/u,t=g(c),e=m.length;0<e;)m[--e].call(a,t);if(1<=c)return d.event&&d.event.end.call(a,a.__data__,o),--s.count?delete s[i]:delete a[r],1}var s=a[r]||(a[r]={active:0,count:0}),d=s[i],c,p,u,g,m;d||(c=e.time,p=Je(t,0,c),d=s[i]={tween:new h,time:c,timer:p,delay:e.delay,duration:e.duration,ease:e.ease,index:o},e=null,++s.count)}function cn(e,t,a){e.attr("transform",function(e){var o=t(e);return"translate("+(isFinite(o)?o:a(e))+",0)"})}function pn(e,t,a){e.attr("transform",function(e){var o=t(e);return"translate(0,"+(isFinite(o)?o:a(e))+")"})}function un(e){return e.toISOString()}function gn(e,t,a){function o(t){return e(t)}function r(e,a){var o=e[1]-e[0],r=o/a,n=fn.bisect(Js,r);return n==Js.length?[t.year,mi(e.map(function(e){return e/31536e6}),a)[2]]:n?t[r/Js[n-1]<Js[n]/r?n-1:n]:[ed,mi(e,a)[2]]}return o.invert=function(t){return hn(e.invert(t))},o.domain=function(t){return arguments.length?(e.domain(t),o):e.domain().map(hn)},o.nice=function(e,t){function a(a){return!isNaN(a)&&!e.range(a,hn(+a+1),t).length}var i=o.domain(),n=ni(i),l=null==e?r(n,10):"number"==typeof e&&r(n,e);return l&&(e=l[0],t=l[1]),o.domain(di(i,1<t?{floor:function(t){for(;a(t=e.floor(t));)t=hn(t-1);return t},ceil:function(t){for(;a(t=e.ceil(t));)t=hn(+t+1);return t}}:e))},o.ticks=function(e,t){var a=ni(o.domain()),i=null==e?r(a,10):"number"==typeof e?r(a,e):!e.range&&[{range:e},t];return i&&(e=i[0],t=i[1]),e.range(a[0],hn(+a[1]+1),1>t?1:t)},o.tickFormat=function(){return a},o.copy=function(){return gn(e.copy(),t,a)},gi(o,e)}function hn(e){return new Date(e)}function mn(e){return JSON.parse(e.responseText)}function yn(e){var t=bn.createRange();return t.selectNode(bn.body),t.createContextualFragment(e.responseText)}var fn={version:"3.5.17"},a=[].slice,xn=function(e){return a.call(e)},bn=this.document;if(bn)try{xn(bn.documentElement.childNodes)[0].nodeType}catch(t){xn=function(e){for(var t=e.length,a=Array(t);t--;)a[t]=e[t];return a}}if(Date.now||(Date.now=function(){return+new Date}),bn)try{bn.createElement("DIV").style.setProperty("opacity",0,"")}catch(e){var _n=this.Element.prototype,vn=_n.setAttribute,wn=_n.setAttributeNS,kn=this.CSSStyleDeclaration.prototype,Tn=kn.setProperty;_n.setAttribute=function(e,t){vn.call(this,e,t+"")},_n.setAttributeNS=function(e,t,a){wn.call(this,e,t,a+"")},kn.setProperty=function(e,t,a){Tn.call(this,e,t+"",a)}}fn.ascending=r,fn.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},fn.min=function(e,t){var o=-1,r=e.length,n,l;if(1===arguments.length){for(;++o<r;)if(null!=(l=e[o])&&l>=l){n=l;break}for(;++o<r;)null!=(l=e[o])&&n>l&&(n=l)}else{for(;++o<r;)if(null!=(l=t.call(e,e[o],o))&&l>=l){n=l;break}for(;++o<r;)null!=(l=t.call(e,e[o],o))&&n>l&&(n=l)}return n},fn.max=function(e,t){var o=-1,r=e.length,n,l;if(1===arguments.length){for(;++o<r;)if(null!=(l=e[o])&&l>=l){n=l;break}for(;++o<r;)null!=(l=e[o])&&l>n&&(n=l)}else{for(;++o<r;)if(null!=(l=t.call(e,e[o],o))&&l>=l){n=l;break}for(;++o<r;)null!=(l=t.call(e,e[o],o))&&l>n&&(n=l)}return n},fn.extent=function(e,t){var o=-1,r=e.length,n,l,s;if(1===arguments.length){for(;++o<r;)if(null!=(l=e[o])&&l>=l){n=s=l;break}for(;++o<r;)null!=(l=e[o])&&(n>l&&(n=l),s<l&&(s=l))}else{for(;++o<r;)if(null!=(l=t.call(e,e[o],o))&&l>=l){n=s=l;break}for(;++o<r;)null!=(l=t.call(e,e[o],o))&&(n>l&&(n=l),s<l&&(s=l))}return[n,s]},fn.sum=function(e,t){var o=0,r=e.length,n=-1,l;if(1===arguments.length)for(;++n<r;)s(l=+e[n])&&(o+=l);else for(;++n<r;)s(l=+t.call(e,e[n],n))&&(o+=l);return o},fn.mean=function(e,t){var o=0,r=e.length,n=-1,d=r,c;if(1===arguments.length)for(;++n<r;)s(c=l(e[n]))?o+=c:--d;else for(;++n<r;)s(c=l(t.call(e,e[n],n)))?o+=c:--d;return d?o/d:void 0},fn.quantile=function(t,a){var o=(t.length-1)*a+1,r=ea(o),i=+t[r-1],n=o-r;return n?i+n*(t[r]-i):i},fn.median=function(e,t){var o=[],d=e.length,n=-1,c;if(1===arguments.length)for(;++n<d;)s(c=l(e[n]))&&o.push(c);else for(;++n<d;)s(c=l(t.call(e,e[n],n)))&&o.push(c);return o.length?fn.quantile(o.sort(r),.5):void 0},fn.variance=function(e,t){var o=e.length,r=0,n=0,c=-1,p=0,u,g;if(1===arguments.length)for(;++c<o;)s(u=l(e[c]))&&(g=u-r,r+=g/++p,n+=g*(u-r));else for(;++c<o;)s(u=l(t.call(e,e[c],c)))&&(g=u-r,r+=g/++p,n+=g*(u-r));return 1<p?n/(p-1):void 0},fn.deviation=function(){var e=fn.variance.apply(this,arguments);return e?re(e):e};var An=d(r);fn.bisectLeft=An.left,fn.bisect=fn.bisectRight=An.right,fn.bisector=function(e){return d(1===e.length?function(t,a){return r(e(t),a)}:e)},fn.shuffle=function(e,a,o){3>(r=arguments.length)&&(o=e.length,2>r&&(a=0));for(var r=o-a,n,l;r;)l=0|Math.random()*r--,n=e[r+a],e[r+a]=e[l+a],e[l+a]=n;return e},fn.permute=function(e,t){for(var a=t.length,o=Array(a);a--;)o[a]=e[t[a]];return o},fn.pairs=function(e){for(var t=0,a=e.length-1,o=e[0],r=Array(0>a?0:a),n;t<a;)r[t]=[n=o,o=e[++t]];return r},fn.transpose=function(e){if(!(s=e.length))return[];for(var t=-1,a=fn.min(e,c),o=Array(a);++t<a;)for(var r=-1,l=o[t]=Array(s),s;++r<s;)l[r]=e[r][t];return o},fn.zip=function(){return fn.transpose(arguments)},fn.keys=function(e){var t=[];for(var a in e)t.push(a);return t},fn.values=function(e){var t=[];for(var a in e)t.push(e[a]);return t},fn.entries=function(e){var t=[];for(var a in e)t.push({key:a,value:e[a]});return t},fn.merge=function(e){for(var t=e.length,a=-1,o=0,r,l,s;++a<t;)o+=e[a].length;for(l=Array(o);0<=--t;)for(s=e[t],r=s.length;0<=--r;)l[--o]=s[r];return l};var Sn=wa;fn.range=function(e,t,a){if(3>arguments.length&&(a=1,2>arguments.length&&(t=e,e=0)),(t-e)/a==1/0)throw new Error("infinite range");var o=[],r=p(Sn(a)),n=-1,l;if(e*=r,t*=r,a*=r,0>a)for(;(l=e+a*++n)>t;)o.push(l/r);else for(;(l=e+a*++n)<t;)o.push(l/r);return o},fn.map=function(e,t){var a=new h;if(e instanceof h)e.forEach(function(e,t){a.set(e,t)});else if(Array.isArray(e)){var r=-1,l=e.length,n;if(1===arguments.length)for(;++r<l;)a.set(r,e[r]);else for(;++r<l;)a.set(t.call(e,n=e[r],r),n)}else for(var s in e)a.set(s,e[s]);return a};u(h,{has:f,get:function(e){return this._[m(e)]},set:function(e,t){return this._[m(e)]=t},remove:x,keys:b,values:function(){var e=[];for(var t in this._)e.push(this._[t]);return e},entries:function(){var e=[];for(var t in this._)e.push({key:y(t),value:this._[t]});return e},size:T,empty:A,forEach:function(e){for(var t in this._)e.call(this,y(t),this._[t])}}),fn.nest=function(){function e(t,r,d){if(d>=o.length)return s?s.call(a,r):l?r.sort(l):r;for(var c=-1,p=r.length,n=o[d++],u=new h,g,m,y,f;++c<p;)(f=u.get(g=n(m=r[c])))?f.push(m):u.set(g,[m]);return t?(m=t(),y=function(a,o){m.set(a,e(t,o,d))}):(m={},y=function(a,o){m[a]=e(t,o,d)}),u.forEach(y),m}function t(e,a){if(a>=o.length)return e;var i=[],n=r[a++];return e.forEach(function(e,o){i.push({key:e,values:t(o,a)})}),n?i.sort(function(e,t){return n(e.key,t.key)}):i}var a={},o=[],r=[],l,s;return a.map=function(t,a){return e(a,t,0)},a.entries=function(a){return t(e(fn.map,a,0),0)},a.key=function(e){return o.push(e),a},a.sortKeys=function(e){return r[o.length-1]=e,a},a.sortValues=function(e){return l=e,a},a.rollup=function(e){return s=e,a},a},fn.set=function(e){var t=new S;if(e)for(var a=0,o=e.length;a<o;++a)t.add(e[a]);return t},u(S,{has:f,add:function(e){return this._[m(e+="")]=!0,e},remove:x,values:b,size:T,empty:A,forEach:function(e){for(var t in this._)e.call(this,y(t))}}),fn.behavior={},fn.rebind=function(e,t){for(var a=1,o=arguments.length,r;++a<o;)e[r=arguments[a]]=I(e,t,t[r]);return e};var Cn=["webkit","ms","moz","Moz","o","O"];fn.dispatch=function(){for(var e=new B,t=-1,a=arguments.length;++t<a;)e[arguments[t]]=F(e);return e},B.prototype.on=function(e,t){var a=e.indexOf("."),o="";if(0<=a&&(o=e.slice(a+1),e=e.slice(0,a)),e)return 2>arguments.length?this[e].on(o):this[e].on(o,t);if(2===arguments.length){if(null==t)for(e in this)this.hasOwnProperty(e)&&this[e].on(o,null);return this}},fn.event=null,fn.requote=function(e){return e.replace(Ln,"\\$&")};var Ln=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,En={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var a in t)e[a]=t[a]},zn=function(e,t){return t.querySelector(e)},In=function(e,t){return t.querySelectorAll(e)},Dn=function(e,t){var a=e.matches||e[D(e,"matchesSelector")];return Dn=function(e,t){return a.call(e,t)},Dn(e,t)};"function"==typeof Sizzle&&(zn=function(e,t){return Sizzle(e,t)[0]||null},In=Sizzle,Dn=Sizzle.matchesSelector),fn.selection=function(){return fn.select(bn.documentElement)};var Pn=fn.selection.prototype=[];Pn.select=function(e){var t=[],a,o,r,l;e=G(e);for(var s=-1,d=this.length;++s<d;){t.push(a=[]),a.parentNode=(r=this[s]).parentNode;for(var c=-1,p=r.length;++c<p;)(l=r[c])?(a.push(o=e.call(l,l.__data__,c,s)),o&&"__data__"in l&&(o.__data__=l.__data__)):a.push(null)}return H(t)},Pn.selectAll=function(e){var t=[],a,o;e=Y(e);for(var r=-1,l=this.length;++r<l;)for(var s=this[r],d=-1,c=s.length;++d<c;)(o=s[d])&&(t.push(a=xn(e.call(o,o.__data__,d,r))),a.parentNode=o);return H(t)};var On={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};fn.ns={prefix:On,qualify:function(e){var t=e.indexOf(":"),a=e;return 0<=t&&"xmlns"!==(a=e.slice(0,t))&&(e=e.slice(t+1)),On.hasOwnProperty(a)?{space:On[a],local:e}:e}},Pn.attr=function(e,t){if(2>arguments.length){if("string"==typeof e){var a=this.node();return e=fn.ns.qualify(e),e.local?a.getAttributeNS(e.space,e.local):a.getAttribute(e)}for(t in e)this.each(q(t,e[t]));return this}return this.each(q(e,t))},Pn.classed=function(e,t){if(2>arguments.length){if("string"==typeof e){var a=this.node(),o=(e=Z(e)).length,r=-1;if(t=a.classList){for(;++r<o;)if(!t.contains(e[r]))return!1;}else for(t=a.getAttribute("class");++r<o;)if(!X(e[r]).test(t))return!1;return!0}for(t in e)this.each($(t,e[t]));return this}return this.each($(e,t))},Pn.style=function(e,t,a){var r=arguments.length;if(3>r){if("string"!=typeof e){for(a in 2>r&&(t=""),e)this.each(K(a,e[a],t));return this}if(2>r){var i=this.node();return o(i).getComputedStyle(i,null).getPropertyValue(e)}a=""}return this.each(K(e,t,a))},Pn.property=function(e,t){if(2>arguments.length){if("string"==typeof e)return this.node()[e];for(t in e)this.each(Q(t,e[t]));return this}return this.each(Q(e,t))},Pn.text=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}:null==e?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},Pn.html=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}:null==e?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},Pn.append=function(e){return e=ee(e),this.select(function(){return this.appendChild(e.apply(this,arguments))})},Pn.insert=function(e,t){return e=ee(e),t=G(t),this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)})},Pn.remove=function(){return this.each(oe)},Pn.data=function(e,t){function a(e,a){var o=e.length,r=a.length,n=ie(o,r),l=Array(r),s=Array(r),u=Array(o),g,m,y;if(t){var f=new h,x=Array(o),b;for(g=-1;++g<o;)(m=e[g])&&(f.has(b=t.call(m,m.__data__,g))?u[g]=m:f.set(b,m),x[g]=b);for(g=-1;++g<r;)(m=f.get(b=t.call(a,y=a[g],g)))?!0!==m&&(l[g]=m,m.__data__=y):s[g]=ne(y),f.set(b,!0);for(g=-1;++g<o;)g in x&&!0!==f.get(x[g])&&(u[g]=e[g])}else{for(g=-1;++g<n;)m=e[g],y=a[g],m?(m.__data__=y,l[g]=m):s[g]=ne(y);for(;g<r;++g)s[g]=ne(a[g]);for(;g<o;++g)u[g]=e[g]}s.update=l,s.parentNode=l.parentNode=u.parentNode=e.parentNode,d.push(s),c.push(l),p.push(u)}var o=-1,r=this.length,l,s;if(!arguments.length){for(e=Array(r=(l=this[0]).length);++o<r;)(s=l[o])&&(e[o]=s.__data__);return e}var d=ce([]),c=H([]),p=H([]);if("function"==typeof e)for(;++o<r;)a(l=this[o],e.call(l,l.parentNode.__data__,o));else for(;++o<r;)a(l=this[o],e);return c.enter=function(){return d},c.exit=function(){return p},c},Pn.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")},Pn.filter=function(e){var t=[],a,o,r;"function"!=typeof e&&(e=le(e));for(var l=0,s=this.length;l<s;l++){t.push(a=[]),a.parentNode=(o=this[l]).parentNode;for(var d=0,c=o.length;d<c;d++)(r=o[d])&&e.call(r,r.__data__,d,l)&&a.push(r)}return H(t)},Pn.order=function(){for(var e=-1,t=this.length;++e<t;)for(var a=this[e],o=a.length-1,r=a[o],n;0<=--o;)(n=a[o])&&(r&&r!==n.nextSibling&&r.parentNode.insertBefore(n,r),r=n);return this},Pn.sort=function(e){e=se.apply(this,arguments);for(var t=-1,a=this.length;++t<a;)this[t].sort(e);return this.order()},Pn.each=function(e){return de(this,function(t,a,o){e.call(t,t.__data__,a,o)})},Pn.call=function(e){var t=xn(arguments);return e.apply(t[0]=this,t),this},Pn.empty=function(){return!this.node()},Pn.node=function(){for(var e=0,t=this.length;e<t;e++)for(var a=this[e],o=0,r=a.length,n;o<r;o++)if(n=a[o],n)return n;return null},Pn.size=function(){var e=0;return de(this,function(){++e}),e};var Rn=[];fn.selection.enter=ce,fn.selection.enter.prototype=Rn,Rn.append=Pn.append,Rn.empty=Pn.empty,Rn.node=Pn.node,Rn.call=Pn.call,Rn.size=Pn.size,Rn.select=function(e){for(var t=[],a=-1,o=this.length,r,l,s,d,c;++a<o;){s=(d=this[a]).update,t.push(r=[]),r.parentNode=d.parentNode;for(var p=-1,u=d.length;++p<u;)(c=d[p])?(r.push(s[p]=l=e.call(d.parentNode,c.__data__,p,a)),l.__data__=c.__data__):r.push(null)}return H(t)},Rn.insert=function(e,t){return 2>arguments.length&&(t=pe(this)),Pn.insert.call(this,e,t)},fn.select=function(t){var a;return"string"==typeof t?(a=[zn(t,bn)],a.parentNode=bn.documentElement):(a=[t],a.parentNode=e(t)),H([a])},fn.selectAll=function(e){var t;return"string"==typeof e?(t=xn(In(e,bn)),t.parentNode=bn.documentElement):(t=xn(e),t.parentNode=null),H([t])},Pn.on=function(e,t,a){var o=arguments.length;if(3>o){if("string"!=typeof e){for(a in 2>o&&(t=!1),e)this.each(ue(a,e[a],t));return this}if(2>o)return(o=this.node()["__on"+e])&&o._;a=!1}return this.each(ue(e,t,a))};var Mn=fn.map({mouseenter:"mouseover",mouseleave:"mouseout"});bn&&Mn.forEach(function(e){"on"+e in bn&&Mn.remove(e)});var jn=0,Bn;fn.mouse=function(e){return ye(e,V())};var Fn=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;fn.touch=function(e,t,a){if(3>arguments.length&&(a=t,t=V().changedTouches),t)for(var o=0,r=t.length,n;o<r;++o)if((n=t[o]).identifier===a)return ye(e,n)},fn.behavior.drag=function(){function e(){this.on("mousedown.drag",i).on("touchstart.drag",n)}function t(e,t,o,i,n){return function(){function l(){var e=t(p,h),a,o;e&&(a=e[0]-x[0],o=e[1]-x[1],g|=a|o,x=e,u({type:"drag",x:e[0]+b[0],y:e[1]+b[1],dx:a,dy:o}))}function s(){t(p,h)&&(y.on(i+m,null).on(n+m,null),f(g),u({type:"dragend"}))}var d=this,c=fn.event.target.correspondingElement||fn.event.target,p=d.parentNode,u=a.of(d,arguments),g=0,h=e(),m=".drag"+(null==h?"":"-"+h),y=fn.select(o(c)).on(i+m,l).on(n+m,s),f=me(c),x=t(p,h),b;r?(b=r.apply(d,arguments),b=[b.x-x[0],b.y-x[1]]):b=[0,0],u({type:"dragstart"})}}var a=U(e,"drag","dragstart","dragend"),r=null,i=t(j,fn.mouse,o,"mousemove","mouseup"),n=t(fe,fn.touch,C,"touchmove","touchend");return e.origin=function(t){return arguments.length?(r=t,e):r},fn.rebind(e,a,"on")},fn.touches=function(e,t){return 2>arguments.length&&(t=V().touches),t?xn(t).map(function(t){var a=ye(e,t);return a.identifier=t.identifier,a}):[]};var Nn=1e-6,n=Nn*Nn,i=Sa,Vn=2*i,Un=i/2,Hn=i/180,Gn=180/i,Yn=w,qn=2,Wn=4;fn.interpolateZoom=function(e,t){var a=e[0],o=e[1],r=e[2],l=t[0],s=t[1],d=t[2],c=l-a,p=s-o,u=c*c+p*p,g,h;if(u<n)h=P(d/r)/Yn,g=function(e){return[a+e*c,o+e*p,r*ka(Yn*e*h)]};else{var m=re(u),y=(d*d-r*r+Wn*u)/(2*r*qn*m),f=(d*d-r*r-Wn*u)/(2*d*qn*m),x=P(re(y*y+1)-y),b=P(re(f*f+1)-f);h=(b-x)/Yn,g=function(e){var t=e*h,i=ke(x),n=r/(qn*m)*(i*Te(Yn*t+x)-we(x));return[a+n*c,o+n*p,r*i/ke(Yn*t+x)]}}return g.duration=1e3*h,g},fn.behavior.zoom=function(){function e(e){e.on("mousedown.zoom",h).on($n+".zoom",y).on("dblclick.zoom",f).on("touchstart.zoom",m)}function a(e){return[(e[0]-b.x)/b.k,(e[1]-b.y)/b.k]}function r(e){return[e[0]*b.k+b.x,e[1]*b.k+b.y]}function i(e){b.k=va(w[0],ie(w[1],e))}function s(e,t){t=r(t),b.x+=e[0]-t[0],b.y+=e[1]-t[1]}function d(t,a,o,r){t.__chart__={x:b.x,y:b.y,k:b.k},i(_a(2,r)),s(L=a,o),t=fn.select(t),0<T&&(t=t.transition().duration(T)),t.call(e.event)}function c(){t&&t.domain(O.range().map(function(e){return(e-b.x)/b.k}).map(O.invert)),l&&l.domain(n.range().map(function(e){return(e-b.y)/b.k}).map(n.invert))}function p(e){A++||e({type:"zoomstart"})}function u(e){c(),e({type:"zoom",scale:b.k,translate:[b.x,b.y]})}function g(e){--A||(e({type:"zoomend"}),L=null)}function h(){function e(){n.on("mousemove.zoom",null).on("mouseup.zoom",null),d(i),g(r)}var t=this,r=S.of(t,arguments),i=0,n=fn.select(o(t)).on("mousemove.zoom",function(){i=1,s(fn.mouse(t),l),u(r)}).on("mouseup.zoom",e),l=a(fn.mouse(t)),d=me(t);Fs.call(t),p(r)}function m(){function e(){var e=fn.touches(l);return A=b.k,e.forEach(function(e){e.identifier in y&&(y[e.identifier]=a(e))}),e}function t(){var t=fn.event.target;fn.select(t).on(_,o).on(v,r),w.push(t);for(var a=fn.event.changedTouches,s=0,c=a.length;s<c;++s)y[a[s].identifier]=null;var n=e(),u=Date.now();if(1===n.length){if(500>u-D){var g=n[0];d(l,g,y[g.identifier],ea(P(b.k)/E)+1),N()}D=u}else if(1<n.length){var g=n[0],h=n[1],m=g[0]-h[0],x=g[1]-h[1];f=m*m+x*x}}function o(){var e=fn.touches(l),t,a,o,r;Fs.call(l);for(var d=0,p=e.length;d<p;++d,r=null)if(o=e[d],r=y[o.identifier]){if(a)break;t=o,a=r}if(r){var n=(n=o[0]-t[0])*n+(n=o[1]-t[1])*n,g=f&&re(n/f);t=[(t[0]+o[0])/2,(t[1]+o[1])/2],a=[(a[0]+r[0])/2,(a[1]+r[1])/2],i(g*A)}D=null,s(t,a),u(c)}function r(){if(fn.event.touches.length){for(var t=fn.event.changedTouches,a=0,o=t.length;a<o;++a)delete y[t[a].identifier];for(var r in y)return void e()}fn.selectAll(w).on(x,null),k.on("mousedown.zoom",h).on("touchstart.zoom",m),T(),g(c)}var l=this,c=S.of(l,arguments),y={},f=0,x=".zoom-"+fn.event.changedTouches[0].identifier,_="touchmove"+x,v="touchend"+x,w=[],k=fn.select(l),T=me(l),A;t(),p(c),k.on("mousedown.zoom",null).on("touchstart.zoom",t)}function y(){var e=S.of(this,arguments);I?clearTimeout(I):(Fs.call(this),C=a(L=z||fn.mouse(this)),p(e)),I=setTimeout(function(){I=null,g(e)},50),N(),i(_a(2,.002*Zn())*b.k),s(L,C),u(e)}function f(){var e=fn.mouse(this),t=P(b.k)/E;d(this,e,a(e),fn.event.shiftKey?ae(t)-1:ea(t)+1)}var b={x:0,y:0,k:1},v=[960,500],w=Xn,T=250,A=0,S=U(e,"zoomstart","zoom","zoomend"),C,L,z,I,D,O,t,n,l;return $n||($n="onwheel"in bn?(Zn=function(){return-fn.event.deltaY*(fn.event.deltaMode?120:1)},"wheel"):"onmousewheel"in bn?(Zn=function(){return fn.event.wheelDelta},"mousewheel"):(Zn=function(){return-fn.event.detail},"MozMousePixelScroll")),e.event=function(e){e.each(function(){var e=S.of(this,arguments),t=b;Us?fn.select(this).transition().each("start.zoom",function(){b=this.__chart__||{x:0,y:0,k:1},p(e)}).tween("zoom:zoom",function(){var a=v[0],o=v[1],r=L?L[0]:a/2,n=L?L[1]:o/2,s=fn.interpolateZoom([(r-b.x)/b.k,(n-b.y)/b.k,a/b.k],[(r-t.x)/t.k,(n-t.y)/t.k,a/t.k]);return function(o){var t=s(o),i=a/t[2];this.__chart__=b={x:r-t[0]*i,y:n-t[1]*i,k:i},u(e)}}).each("interrupt.zoom",function(){g(e)}).each("end.zoom",function(){g(e)}):(this.__chart__=b,p(e),u(e),g(e))})},e.translate=function(t){return arguments.length?(b={x:+t[0],y:+t[1],k:b.k},c(),e):[b.x,b.y]},e.scale=function(t){return arguments.length?(b={x:b.x,y:b.y,k:null},i(+t),c(),e):b.k},e.scaleExtent=function(t){return arguments.length?(w=null==t?Xn:[+t[0],+t[1]],e):w},e.center=function(t){return arguments.length?(z=t&&[+t[0],+t[1]],e):z},e.size=function(t){return arguments.length?(v=t&&[+t[0],+t[1]],e):v},e.duration=function(t){return arguments.length?(T=+t,e):T},e.x=function(a){return arguments.length?(t=a,O=a.copy(),b={x:0,y:0,k:1},e):t},e.y=function(t){return arguments.length?(l=t,n=t.copy(),b={x:0,y:0,k:1},e):l},fn.rebind(e,S,"on")};var Xn=[0,1/0],Zn,$n;fn.color=Se,Se.prototype.toString=function(){return this.rgb()+""},fn.hsl=Ce;var Jn=Ce.prototype=new Se;Jn.brighter=function(e){return e=_a(.7,arguments.length?e:1),new Ce(this.h,this.s,this.l/e)},Jn.darker=function(e){return e=_a(.7,arguments.length?e:1),new Ce(this.h,this.s,e*this.l)},Jn.rgb=function(){return Le(this.h,this.s,this.l)},fn.hcl=Ee;var Kn=Ee.prototype=new Se;Kn.brighter=function(e){return new Ee(this.h,this.c,ie(100,this.l+Qn*(arguments.length?e:1)))},Kn.darker=function(e){return new Ee(this.h,this.c,va(0,this.l-Qn*(arguments.length?e:1)))},Kn.rgb=function(){return ze(this.h,this.c,this.l).rgb()},fn.lab=Ie;var Qn=18,el=.95047,tl=1.08883,al=Ie.prototype=new Se;al.brighter=function(e){return new Ie(ie(100,this.l+18*(arguments.length?e:1)),this.a,this.b)},al.darker=function(e){return new Ie(va(0,this.l-18*(arguments.length?e:1)),this.a,this.b)},al.rgb=function(){return De(this.l,this.a,this.b)},fn.rgb=je;var ol=je.prototype=new Se;ol.brighter=function(e){e=_a(.7,arguments.length?e:1);var t=this.r,a=this.g,o=this.b;return t||a||o?(t&&30>t&&(t=30),a&&30>a&&(a=30),o&&30>o&&(o=30),new je(ie(255,t/e),ie(255,a/e),ie(255,o/e))):new je(30,30,30)},ol.darker=function(e){return e=_a(.7,arguments.length?e:1),new je(e*this.r,e*this.g,e*this.b)},ol.hsl=function(){return Ue(this.r,this.g,this.b)},ol.toString=function(){return"#"+Ne(this.r)+Ne(this.g)+Ne(this.b)};var rl=fn.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});rl.forEach(function(e,t){rl.set(e,Be(t))}),fn.functor=qe,fn.xhr=We(C),fn.dsv=function(e,t){function a(e,a,i){3>arguments.length&&(i=a,a=null);var n=Xe(e,t,null==a?o:r(a),i);return n.row=function(e){return arguments.length?n.response(null==(a=e)?o:r(e)):a},n}function o(e){return a.parse(e.responseText)}function r(e){return function(t){return a.parse(t.responseText,e)}}function i(t){return t.map(n).join(e)}function n(e){return l.test(e)?"\""+e.replace(/\"/g,"\"\"")+"\"":e}var l=new RegExp("[\""+e+"\n]"),s=e.charCodeAt(0);return a.parse=function(e,t){var r;return a.parseRows(e,function(e,o){if(r)return r(e,o-1);var n=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");r=t?function(e,a){return t(n(e),a)}:n})},a.parseRows=function(e,o){function r(){if(u>=p)return d;if(h)return h=!1,l;var t=u;if(34===e.charCodeAt(t)){for(var a=t;a++<p;)if(34===e.charCodeAt(a)){if(34!==e.charCodeAt(a+1))break;++a}u=a+2;var o=e.charCodeAt(a+1);return 13===o?(h=!0,10===e.charCodeAt(a+2)&&++u):10===o&&(h=!0),e.slice(t+1,a).replace(/""/g,"\"")}for(;u<p;){var o=e.charCodeAt(u++),r=1;if(10===o)h=!0;else if(13===o)h=!0,10===e.charCodeAt(u)&&(++u,++r);else if(o!==s)continue;return e.slice(t,u-r)}return e.slice(t)}for(var l={},d={},c=[],p=e.length,u=0,i=0,g,h;(g=r())!==d;){for(var m=[];g!==l&&g!==d;)m.push(g),g=r();o&&null==(m=o(m,i++))||c.push(m)}return c},a.format=function(t){if(Array.isArray(t[0]))return a.formatRows(t);var o=new S,r=[];return t.forEach(function(e){for(var t in e)o.has(t)||r.push(o.add(t))}),[r.map(n).join(e)].concat(t.map(function(t){return r.map(function(e){return n(t[e])}).join(e)})).join("\n")},a.formatRows=function(e){return e.map(i).join("\n")},a},fn.csv=fn.dsv(",","text/csv"),fn.tsv=fn.dsv("\t","text/tab-separated-values");var il=this[D(this,"requestAnimationFrame")]||function(e){setTimeout(e,17)},nl,ll,sl,dl;fn.timer=function(){Je.apply(this,arguments)},fn.timer.flush=function(){Qe(),et()},fn.round=function(e,t){return t?R(e*(t=_a(10,t)))/t:R(e)};var cl=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"].map(function(e,t){var a=_a(10,3*Sn(8-t));return{scale:8<t?function(e){return e/a}:function(e){return e*a},symbol:e}});fn.formatPrefix=function(e,t){var a=0;return(e=+e)&&(0>e&&(e*=-1),t&&(e=fn.round(e,tt(e,t))),a=1+ea(1e-12+P(e)/z),a=va(-24,ie(24,3*ea((a-1)/3)))),cl[8+a/3]};var pl=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ul=fn.map({b:function(e){return e.toString(2)},c:function(e){return O(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return(e=fn.round(e,tt(e,t))).toFixed(va(0,ie(20,tt(e*(1+1e-15),t))))}}),hl=fn.time={},ml=Date;rt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){yl.setUTCDate.apply(this._,arguments)},setDay:function(){yl.setUTCDay.apply(this._,arguments)},setFullYear:function(){yl.setUTCFullYear.apply(this._,arguments)},setHours:function(){yl.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){yl.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){yl.setUTCMinutes.apply(this._,arguments)},setMonth:function(){yl.setUTCMonth.apply(this._,arguments)},setSeconds:function(){yl.setUTCSeconds.apply(this._,arguments)},setTime:function(){yl.setTime.apply(this._,arguments)}};var yl=Date.prototype;hl.year=it(function(e){return e=hl.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),hl.years=hl.year.range,hl.years.utc=hl.year.utc.range,hl.day=it(function(e){var t=new ml(2e3,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),hl.days=hl.day.range,hl.days.utc=hl.day.utc.range,hl.dayOfYear=function(e){var t=hl.year(e);return ea((e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(e,t){t=7-t;var a=hl[e]=it(function(e){return(e=hl.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+7*ea(t))},function(e){var a=hl.year(e).getDay();return ea((hl.dayOfYear(e)+(a+t)%7)/7)-(a!==t)});hl[e+"s"]=a.range,hl[e+"s"].utc=a.utc.range,hl[e+"OfYear"]=function(e){var a=hl.year(e).getDay();return ea((hl.dayOfYear(e)+(a+t)%7)/7)}}),hl.week=hl.sunday,hl.weeks=hl.sunday.range,hl.weeks.utc=hl.sunday.utc.range,hl.weekOfYear=hl.sundayOfYear;var fl={"-":"",_:" ",0:"0"},xl=/^\s*\d+/,bl=/^%/;fn.locale=function(e){return{numberFormat:at(e),timeFormat:lt(e)}};var _l=fn.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});fn.format=_l.numberFormat,fn.geo={},Lt.prototype={s:0,t:0,add:function(e){Et(e,this.t,vl),Et(vl.s,this.s,this),this.s?this.t+=vl.t:this.s=vl.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var vl=new Lt;fn.geo.stream=function(e,t){e&&wl.hasOwnProperty(e.type)?wl[e.type](e,t):zt(e,t)};var wl={Feature:function(e,t){zt(e.geometry,t)},FeatureCollection:function(e,t){for(var a=e.features,o=-1,r=a.length;++o<r;)zt(a[o].geometry,t)}},kl={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var a=e.coordinates,o=-1,r=a.length;++o<r;)e=a[o],t.point(e[0],e[1],e[2])},LineString:function(e,t){It(e.coordinates,t,0)},MultiLineString:function(e,t){for(var a=e.coordinates,o=-1,r=a.length;++o<r;)It(a[o],t,0)},Polygon:function(e,t){Dt(e.coordinates,t)},MultiPolygon:function(e,t){for(var a=e.coordinates,o=-1,r=a.length;++o<r;)Dt(a[o],t)},GeometryCollection:function(e,t){for(var a=e.geometries,o=-1,r=a.length;++o<r;)zt(a[o],t)}};fn.geo.area=function(e){return Sl=0,fn.geo.stream(e,Al),Sl};var Tl=new Lt,Al={sphere:function(){Sl+=4*i},point:j,lineStart:j,lineEnd:j,polygonStart:function(){Tl.reset(),Al.lineStart=Pt},polygonEnd:function(){var e=2*Tl;Sl+=0>e?4*i+e:e,Al.lineStart=Al.lineEnd=Al.point=j}},Sl;fn.geo.bounds=function(){function e(e,t){_.push(v=[u=e,h=e]),t<g&&(g=t),t>m&&(m=t)}function t(t,a){var o=Ot([t*Hn,a*Hn]);if(x){var r=Mt(x,o),i=[r[1],-r[0],0],n=Mt(i,r);Ft(n),n=Nt(n);var d=t-y,c=0<d?1:-1,s=n[0]*Gn*c,p=180<Sn(d);if(p^(c*y<s&&s<c*t)){var f=n[1]*Gn;f>m&&(m=f)}else if(s=(s+360)%360-180,p^(c*y<s&&s<c*t)){var f=-n[1]*Gn;f<g&&(g=f)}else a<g&&(g=a),a>m&&(m=a);p?t<y?l(u,t)>l(u,h)&&(h=t):l(t,h)>l(u,h)&&(u=t):h>=u?(t<u&&(u=t),t>h&&(h=t)):t>y?l(u,t)>l(u,h)&&(h=t):l(t,h)>l(u,h)&&(u=t)}else e(t,a);x=o,y=t}function a(){c.point=t}function o(){v[0]=u,v[1]=h,c.point=e,x=null}function r(e,a){if(x){var o=e-y;b+=180<Sn(o)?o+(0<o?360:-360):o}else p=e,f=a;Al.point(e,a),t(e,a)}function i(){Al.lineStart()}function n(){r(p,f),Al.lineEnd(),Sn(b)>Nn&&(u=-(h=180)),v[0]=u,v[1]=h,x=null}function l(e,t){return 0>(t-=e)?t+360:t}function s(e,t){return e[0]-t[0]}function d(e,t){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var c={point:e,lineStart:a,lineEnd:o,polygonStart:function(){c.point=r,c.lineStart=i,c.lineEnd=n,b=0,Al.polygonStart()},polygonEnd:function(){Al.polygonEnd(),c.point=e,c.lineStart=a,c.lineEnd=o,0>Tl?(u=-(h=180),g=-(m=90)):b>Nn?m=90:b<-Nn&&(g=-90),v[0]=u,v[1]=h}},u,g,h,m,y,p,f,x,b,_,v;return function(e){m=h=-(u=g=1/0),_=[],fn.geo.stream(e,c);var t=_.length;if(t){_.sort(s);for(var o=1,r=_[0],p=[r],y;o<t;++o)y=_[o],d(y[0],r)||d(y[1],r)?(l(r[0],y[1])>l(r[0],r[1])&&(r[1]=y[1]),l(y[0],r[1])>l(r[0],r[1])&&(r[0]=y[0])):p.push(r=y);for(var f=-Infinity,t=p.length-1,o=0,r=p[t],x,y;o<=t;r=y,++o)y=p[o],(x=l(r[1],y[0]))>f&&(f=x,u=y[0],h=r[1])}return _=v=null,u===1/0||g===1/0?[[NaN,NaN],[NaN,NaN]]:[[u,g],[h,m]]}}(),fn.geo.centroid=function(e){El=zl=Il=Dl=Pl=Ol=Rl=Ml=jl=Bl=Fl=0,fn.geo.stream(e,Cl);var t=jl,a=Bl,o=Fl,r=t*t+a*a+o*o;return r<n&&(t=Ol,a=Rl,o=Ml,zl<Nn&&(t=Il,a=Dl,o=Pl),r=t*t+a*a+o*o,r<n)?[NaN,NaN]:[L(a,t)*Gn,ve(o/re(r))*Gn]};var Cl={sphere:j,point:Ut,lineStart:Gt,lineEnd:Yt,polygonStart:function(){Cl.lineStart=qt},polygonEnd:function(){Cl.lineStart=Gt}},Ll=Kt(Xt,function(e){var t=NaN,a=NaN,o=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(n,l){var s=0<n?i:-i,d=Sn(n-t);Sn(d-i)<Nn?(e.point(t,a=0<(a+l)/2?Un:-Un),e.point(o,a),e.lineEnd(),e.lineStart(),e.point(s,a),e.point(n,a),r=0):o!==s&&d>=i&&(Sn(t-o)<Nn&&(t-=o*Nn),Sn(n-s)<Nn&&(n-=s*Nn),a=oa(t,a,n,l),e.point(o,a),e.lineEnd(),e.lineStart(),e.point(s,a),r=0),e.point(t=n,a=l),o=s},lineEnd:function(){e.lineEnd(),t=a=NaN},clean:function(){return 2-r}}},function(e,t,a,o){var r;if(null==e)r=a*Un,o.point(-i,r),o.point(0,r),o.point(i,r),o.point(i,0),o.point(i,-r),o.point(0,-r),o.point(-i,-r),o.point(-i,0),o.point(-i,r);else if(Sn(e[0]-t[0])>Nn){var n=e[0]<t[0]?i:-i;r=a*n/2,o.point(-n,r),o.point(0,r),o.point(n,r)}else o.point(t[0],t[1])},[-i,-i/2]),El,zl,Il,Dl,Pl,Ol,Rl,Ml,jl,Bl,Fl;fn.geo.clipExtent=function(){var e={stream:function(e){return i&&(i.valid=!1),i=n(e),i.valid=!0,i},extent:function(l){return arguments.length?(n=la(t=+l[0][0],a=+l[0][1],o=+l[1][0],r=+l[1][1]),i&&(i.valid=!1,i=null),e):[[t,a],[o,r]]}},t,a,o,r,i,n;return e.extent([[0,0],[960,500]])},(fn.geo.conicEqualArea=function(){return sa(da)}).raw=da,fn.geo.albers=function(){return fn.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},fn.geo.albersUsa=function(){function e(e){var t=e[0],a=e[1];return n=null,(l(t,a),n)||(s(t,a),n)||d(t,a),n}var a=fn.geo.albers(),o=fn.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),r=fn.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),i={point:function(e,t){n=[e,t]}},n,l,s,d;return e.invert=function(e){var i=a.scale(),n=a.translate(),t=(e[0]-n[0])/i,l=(e[1]-n[1])/i;return(.12<=l&&.234>l&&-.425<=t&&-.214>t?o:.166<=l&&.234>l&&-.214<=t&&-.115>t?r:a).invert(e)},e.stream=function(e){var t=a.stream(e),i=o.stream(e),n=r.stream(e);return{point:function(e,a){t.point(e,a),i.point(e,a),n.point(e,a)},sphere:function(){t.sphere(),i.sphere(),n.sphere()},lineStart:function(){t.lineStart(),i.lineStart(),n.lineStart()},lineEnd:function(){t.lineEnd(),i.lineEnd(),n.lineEnd()},polygonStart:function(){t.polygonStart(),i.polygonStart(),n.polygonStart()},polygonEnd:function(){t.polygonEnd(),i.polygonEnd(),n.polygonEnd()}}},e.precision=function(t){return arguments.length?(a.precision(t),o.precision(t),r.precision(t),e):a.precision()},e.scale=function(t){return arguments.length?(a.scale(t),o.scale(.35*t),r.scale(t),e.translate(a.translate())):a.scale()},e.translate=function(t){if(!arguments.length)return a.translate();var n=a.scale(),c=+t[0],p=+t[1];return l=a.translate(t).clipExtent([[c-.455*n,p-.238*n],[c+.455*n,p+.238*n]]).stream(i).point,s=o.translate([c-.307*n,p+.201*n]).clipExtent([[c-.425*n+Nn,p+.12*n+Nn],[c-.214*n-Nn,p+.234*n-Nn]]).stream(i).point,d=r.translate([c-.205*n,p+.212*n]).clipExtent([[c-.214*n+Nn,p+.166*n+Nn],[c-.115*n-Nn,p+.234*n-Nn]]).stream(i).point,e},e.scale(1070)};var Nl={point:j,lineStart:j,lineEnd:j,polygonStart:function(){Gl=0,Nl.lineStart=ca},polygonEnd:function(){Nl.lineStart=Nl.lineEnd=Nl.point=j,Hl+=Sn(Gl/2)}},Vl={point:pa,lineStart:j,lineEnd:j,polygonStart:j,polygonEnd:j},Ul={point:ha,lineStart:ma,lineEnd:ya,polygonStart:function(){Ul.lineStart=fa},polygonEnd:function(){Ul.point=ha,Ul.lineStart=ma,Ul.lineEnd=ya}},Hl,Gl,Yl,ql,Wl,Xl;fn.geo.path=function(){function e(e){return e&&("function"==typeof a&&n.pointRadius(+a.apply(this,arguments)),(!l||!l.valid)&&(l=i(n)),fn.geo.stream(e,l)),n.result()}function t(){return l=null,e}var a=4.5,o,r,i,n,l;return e.area=function(e){return Hl=0,fn.geo.stream(e,i(Nl)),Hl},e.centroid=function(e){return Il=Dl=Pl=Ol=Rl=Ml=jl=Bl=Fl=0,fn.geo.stream(e,i(Ul)),Fl?[jl/Fl,Bl/Fl]:Ml?[Ol/Ml,Rl/Ml]:Pl?[Il/Pl,Dl/Pl]:[NaN,NaN]},e.bounds=function(e){return Wl=Xl=-(Yl=ql=1/0),fn.geo.stream(e,i(Vl)),[[Yl,ql],[Wl,Xl]]},e.projection=function(e){return arguments.length?(i=(o=e)?e.stream||Ta(e):C,t()):o},e.context=function(e){return arguments.length?(n=null==(r=e)?new ua:new xa(e),"function"!=typeof a&&n.pointRadius(a),t()):r},e.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(n.pointRadius(+t),+t),e):a},e.projection(fn.geo.albersUsa()).context(null)},fn.geo.transform=function(e){return{stream:function(t){var a=new Aa(t);for(var o in e)a[o]=e[o];return a}}},Aa.prototype={point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},fn.geo.projection=Ea,fn.geo.projectionMutator=za,(fn.geo.equirectangular=function(){return Ea(Da)}).raw=Da.invert=Da,fn.geo.rotation=function(e){function t(t){return t=e(t[0]*Hn,t[1]*Hn),t[0]*=Gn,t[1]*=Gn,t}return e=Oa(e[0]%360*Hn,e[1]*Hn,2<e.length?e[2]*Hn:0),t.invert=function(t){return t=e.invert(t[0]*Hn,t[1]*Hn),t[0]*=Gn,t[1]*=Gn,t},t},Pa.invert=Da,fn.geo.circle=function(){function e(){var e="function"==typeof t?t.apply(this,arguments):t,a=Oa(-e[0]*Hn,-e[1]*Hn,0).invert,o=[];return r(null,null,1,{point:function(e,t){o.push(e=a(e,t)),e[0]*=Gn,e[1]*=Gn}}),{type:"Polygon",coordinates:[o]}}var t=[0,0],a=6,o,r;return e.origin=function(a){return arguments.length?(t=a,e):t},e.angle=function(t){return arguments.length?(r=Ba((o=+t)*Hn,a*Hn),e):o},e.precision=function(t){return arguments.length?(r=Ba(o*Hn,(a=+t)*Hn),e):a},e.angle(90)},fn.geo.distance=function(e,a){var o=(a[0]-e[0])*Hn,r=e[1]*Hn,i=a[1]*Hn,n=M(o),l=te(o),s=M(r),d=te(r),c=M(i),p=te(i),u;return L(re((u=p*n)*u+(u=d*c-s*p*l)*u),s*c+d*p*l)},fn.geo.graticule=function(){function e(){return{type:"MultiLineString",coordinates:t()}}function t(){return fn.range(ae(c/r)*r,d,r).map(b).concat(fn.range(ae(h/i)*i,g,i).map(v)).concat(fn.range(ae(s/a)*a,l,a).filter(function(e){return Sn(e%r)>Nn}).map(m)).concat(fn.range(ae(u/o)*o,p,o).filter(function(e){return Sn(e%i)>Nn}).map(f))}var a=10,o=a,r=90,i=360,n=2.5,l,s,d,c,p,u,g,h,m,f,b,v;return e.lines=function(){return t().map(function(e){return{type:"LineString",coordinates:e}})},e.outline=function(){return{type:"Polygon",coordinates:[b(c).concat(v(g).slice(1),b(d).reverse().slice(1),v(h).reverse().slice(1))]}},e.extent=function(t){return arguments.length?e.majorExtent(t).minorExtent(t):e.minorExtent()},e.majorExtent=function(t){return arguments.length?(c=+t[0][0],d=+t[1][0],h=+t[0][1],g=+t[1][1],c>d&&(t=c,c=d,d=t),h>g&&(t=h,h=g,g=t),e.precision(n)):[[c,h],[d,g]]},e.minorExtent=function(t){return arguments.length?(s=+t[0][0],l=+t[1][0],u=+t[0][1],p=+t[1][1],s>l&&(t=s,s=l,l=t),u>p&&(t=u,u=p,p=t),e.precision(n)):[[s,u],[l,p]]},e.step=function(t){return arguments.length?e.majorStep(t).minorStep(t):e.minorStep()},e.majorStep=function(t){return arguments.length?(r=+t[0],i=+t[1],e):[r,i]},e.minorStep=function(t){return arguments.length?(a=+t[0],o=+t[1],e):[a,o]},e.precision=function(t){return arguments.length?(n=+t,m=Na(u,p,90),f=Va(s,l,n),b=Na(h,g,90),v=Va(c,d,n),e):n},e.majorExtent([[-180,-90+Nn],[180,90-Nn]]).minorExtent([[-180,-80-Nn],[180,80+Nn]])},fn.geo.greatArc=function(){function e(){return{type:"LineString",coordinates:[o||t.apply(this,arguments),r||a.apply(this,arguments)]}}var t=Ua,a=Ha,o,r;return e.distance=function(){return fn.geo.distance(o||t.apply(this,arguments),r||a.apply(this,arguments))},e.source=function(a){return arguments.length?(t=a,o="function"==typeof a?null:a,e):t},e.target=function(t){return arguments.length?(a=t,r="function"==typeof t?null:t,e):a},e.precision=function(){return arguments.length?e:0},e},fn.geo.interpolate=function(e,t){return Ga(e[0]*Hn,e[1]*Hn,t[0]*Hn,t[1]*Hn)},fn.geo.length=function(e){return Jl=0,fn.geo.stream(e,Zl),Jl};var Zl={sphere:j,point:j,lineStart:function(){function e(e,i){var n=M(i*=Hn),l=te(i),s=Sn((e*=Hn)-a),d=te(s);Jl+=L(re((s=l*M(s))*s+(s=r*n-o*l*d)*s),o*n+r*l*d),a=e,o=n,r=l}var a,o,r;Zl.point=function(t,i){a=t*Hn,o=M(i*=Hn),r=te(i),Zl.point=e},Zl.lineEnd=function(){Zl.point=Zl.lineEnd=j}},lineEnd:j,polygonStart:j,polygonEnd:j},$l=Ya(function(e){return re(2/(1+e))},function(e){return 2*_(e/2)}),Jl;(fn.geo.azimuthalEqualArea=function(){return Ea($l)}).raw=$l;var Kl=Ya(function(e){var t=v(e);return t&&t/M(t)},C);(fn.geo.azimuthalEquidistant=function(){return Ea(Kl)}).raw=Kl,(fn.geo.conicConformal=function(){return sa(qa)}).raw=qa,(fn.geo.conicEquidistant=function(){return sa(Wa)}).raw=Wa;var Ql=Ya(function(e){return 1/e},Math.atan);(fn.geo.gnomonic=function(){return Ea(Ql)}).raw=Ql,Xa.invert=function(e,t){return[e,2*k(ka(t))-Un]},(fn.geo.mercator=function(){return Za(Xa)}).raw=Xa;var es=Ya(function(){return 1},Math.asin);(fn.geo.orthographic=function(){return Ea(es)}).raw=es;var ts=Ya(function(e){return 1/(1+e)},function(e){return 2*k(e)});(fn.geo.stereographic=function(){return Ea(ts)}).raw=ts,$a.invert=function(e,t){return[-t,2*k(ka(e))-Un]},(fn.geo.transverseMercator=function(){var e=Za($a),t=e.center,a=e.rotate;return e.center=function(e){return e?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])},e.rotate=function(e){return e?a([e[0],e[1],2<e.length?e[2]+90:90]):(e=a(),[e[0],e[1],e[2]-90])},a([0,0,90])}).raw=$a,fn.geom={},fn.geom.hull=function(e){function t(e){if(3>e.length)return[];var t=qe(a),r=qe(o),l=e.length,n=[],s=[],d;for(d=0;d<l;d++)n.push([+t.call(this,e[d],d),+r.call(this,e[d],d),d]);for(n.sort(eo),d=0;d<l;d++)s.push([n[d][0],-n[d][1]]);var c=Qa(n),p=Qa(s),u=p[0]===c[0],g=p[p.length-1]===c[c.length-1],h=[];for(d=c.length-1;0<=d;--d)h.push(e[n[c[d]][2]]);for(d=+u;d<p.length-g;++d)h.push(e[n[p[d]][2]]);return h}var a=Ja,o=Ka;return arguments.length?t(e):(t.x=function(e){return arguments.length?(a=e,t):a},t.y=function(e){return arguments.length?(o=e,t):o},t)},fn.geom.polygon=function(e){return En(e,as),e};var as=fn.geom.polygon.prototype=[];as.area=function(){for(var e=-1,t=this.length,o=this[t-1],r=0,n;++e<t;)n=o,o=this[e],r+=n[1]*o[0]-n[0]*o[1];return .5*r},as.centroid=function(e){var t=-1,o=this.length,r=0,n=0,l=this[o-1],s,d;for(arguments.length||(e=-1/(6*this.area()));++t<o;)s=l,l=this[t],d=s[0]*l[1]-l[0]*s[1],r+=(s[0]+l[0])*d,n+=(s[1]+l[1])*d;return[r*e,n*e]},as.clip=function(e){for(var t=oo(e),o=-1,r=this.length-oo(this),n=this[r-1],l,s,p,u,g,h;++o<r;){for(l=e.slice(),e.length=0,u=this[o],g=l[(p=l.length-t)-1],s=-1;++s<p;)h=l[s],to(h,n,u)?(!to(g,n,u)&&e.push(ao(g,h,n,u)),e.push(h)):to(g,n,u)&&e.push(ao(g,h,n,u)),g=h;t&&e.push(e[0]),n=u}return e};var os=[],rs=[],is,ns,ls,ss,ds;uo.prototype.prepare=function(){for(var e=this.edges,t=e.length,a;t--;)a=e[t].edge,a.b&&a.a||e.splice(t,1);return e.sort(ho),e.length},To.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Ao.prototype={insert:function(e,t){var a,o,r;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;a=e}else this._?(e=Eo(this._),t.P=null,t.N=e,e.P=e.L=t,a=e):(t.P=t.N=null,this._=t,a=null);for(t.L=t.R=null,t.U=a,t.C=!0,e=t;a&&a.C;)o=a.U,a===o.L?(r=o.R,r&&r.C?(a.C=r.C=!1,o.C=!0,e=o):(e===a.R&&(Co(this,a),e=a,a=e.U),a.C=!1,o.C=!0,Lo(this,o))):(r=o.L,r&&r.C?(a.C=r.C=!1,o.C=!0,e=o):(e===a.L&&(Lo(this,a),e=a,a=e.U),a.C=!1,o.C=!0,Co(this,o))),a=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t=e.U,a=e.L,o=e.R,r,i,n;if(i=a?o?Eo(o):a:o,t?t.L===e?t.L=i:t.R=i:this._=i,a&&o?(n=i.C,i.C=e.C,i.L=a,a.U=i,i===o?(i.U=t,t=i,e=i.R):(t=i.U,i.U=e.U,e=i.R,t.L=e,i.R=o,o.U=i)):(n=e.C,e=i),e&&(e.U=t),!n){if(e&&e.C)return void(e.C=!1);do{if(e===this._)break;if(e===t.L){if(r=t.R,r.C&&(r.C=!1,t.C=!0,Co(this,t),r=t.R),r.L&&r.L.C||r.R&&r.R.C){r.R&&r.R.C||(r.L.C=!1,r.C=!0,Lo(this,r),r=t.R),r.C=t.C,t.C=r.R.C=!1,Co(this,t),e=this._;break}}else if(r=t.L,r.C&&(r.C=!1,t.C=!0,Lo(this,t),r=t.L),r.L&&r.L.C||r.R&&r.R.C){r.L&&r.L.C||(r.R.C=!1,r.C=!0,Co(this,r),r=t.L),r.C=t.C,t.C=r.L.C=!1,Lo(this,t),e=this._;break}r.C=!0,e=t,t=t.U}while(!e.C);e&&(e.C=!1)}}},fn.geom.voronoi=function(e){function t(e){var t=Array(e.length),o=i[0][0],r=i[0][1],n=i[1][0],l=i[1][1];return zo(a(e),i).cells.forEach(function(a,s){var i=a.edges,d=a.site,c=t[s]=i.length?i.map(function(t){var e=t.start();return[e.x,e.y]}):d.x>=o&&d.x<=n&&d.y>=r&&d.y<=l?[[o,l],[n,l],[n,r],[o,r]]:[];c.point=e[s]}),t}function a(e){return e.map(function(e,t){return{x:R(n(e,t)/Nn)*Nn,y:R(l(e,t)/Nn)*Nn,i:t}})}var o=Ja,r=Ka,n=o,l=r,i=cs;return e?t(e):(t.links=function(e){return zo(a(e)).edges.filter(function(e){return e.l&&e.r}).map(function(t){return{source:e[t.l.i],target:e[t.r.i]}})},t.triangles=function(e){var t=[];return zo(a(e)).cells.forEach(function(a,o){for(var r=a.site,i=a.edges.sort(ho),n=-1,l=i.length,s=i[l-1].edge,d=s.l===r?s.r:s.l,c,p;++n<l;)c=s,p=d,s=i[n].edge,d=s.l===r?s.r:s.l,o<p.i&&o<d.i&&0>Do(r,p,d)&&t.push([e[o],e[p.i],e[d.i]])}),t},t.x=function(e){return arguments.length?(n=qe(o=e),t):o},t.y=function(e){return arguments.length?(l=qe(r=e),t):r},t.clipExtent=function(e){return arguments.length?(i=null==e?cs:e,t):i===cs?null:i},t.size=function(e){return arguments.length?t.clipExtent(e&&[[0,0],e]):i===cs?null:i&&i[1]},t)};var cs=[[-1e6,-1e6],[1e6,1e6]];fn.geom.delaunay=function(e){return fn.geom.voronoi().triangles(e)},fn.geom.quadtree=function(e,t,a,o,r){function i(e){function p(e,t,a,o,r,i,n,l){if(!(isNaN(a)||isNaN(o)))if(e.leaf){var s=e.x,d=e.y;if(null==s)e.x=a,e.y=o,e.point=t;else if(.01>Sn(s-a)+Sn(d-o))u(e,t,a,o,r,i,n,l);else{var c=e.point;e.x=e.y=e.point=null,u(e,c,s,d,r,i,n,l),u(e,t,a,o,r,i,n,l)}}else u(e,t,a,o,r,i,n,l)}function u(e,t,a,o,r,l,s,d){var c=.5*(r+s),u=.5*(l+d),g=a>=c,h=o>=u,m=h<<1|g;e.leaf=!1,e=e.nodes[m]||(e.nodes[m]=Ro()),g?r=c:s=c,h?l=u:d=u,p(e,t,a,o,r,l,s,d)}var g=qe(l),h=qe(s),m,y,f,x,b,_,v,w,k;if(null!=t)_=t,v=a,w=o,k=r;else if(w=k=-(_=v=1/0),y=[],f=[],b=e.length,c)for(x=0;x<b;++x)m=e[x],m.x<_&&(_=m.x),m.y<v&&(v=m.y),m.x>w&&(w=m.x),m.y>k&&(k=m.y),y.push(m.x),f.push(m.y);else for(x=0;x<b;++x){var T=+g(m=e[x],x),A=+h(m,x);T<_&&(_=T),A<v&&(v=A),T>w&&(w=T),A>k&&(k=A),y.push(T),f.push(A)}var S=w-_,C=k-v;S>C?k=v+S:w=_+C;var L=Ro();if(L.add=function(e){p(L,e,+g(e,++x),+h(e,x),_,v,w,k)},L.visit=function(e){Mo(e,L,_,v,w,k)},L.find=function(e){return jo(L,e[0],e[1],_,v,w,k)},x=-1,null==t){for(;++x<b;)p(L,e[x],y[x],f[x],_,v,w,k);--x}else e.forEach(L.add);return y=f=e=m=null,L}var l=Ja,s=Ka,c;return(c=arguments.length)?(l=Po,s=Oo,3===c&&(r=a,o=t,a=t=0),i(e)):(i.x=function(e){return arguments.length?(l=e,i):l},i.y=function(e){return arguments.length?(s=e,i):s},i.extent=function(e){return arguments.length?(null==e?t=a=o=r=null:(t=+e[0][0],a=+e[0][1],o=+e[1][0],r=+e[1][1]),i):null==t?null:[[t,a],[o,r]]},i.size=function(e){return arguments.length?(null==e?t=a=o=r=null:(t=a=0,o=+e[0],r=+e[1]),i):null==t?null:[o-t,r-a]},i)},fn.interpolateRgb=Bo,fn.interpolateObject=Fo,fn.interpolateNumber=No,fn.interpolateString=Vo;var ps=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,us=new RegExp(ps.source,"g");fn.interpolate=Uo,fn.interpolators=[function(e,a){var o=typeof a;return("string"==o?rl.has(a.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(a)?Bo:Vo:a instanceof Se?Bo:Array.isArray(a)?Ho:"object"==o&&isNaN(a)?Fo:No)(e,a)}],fn.interpolateArray=Ho;var gs=function(){return C},hs=fn.map({linear:gs,poly:function(a){return function(e){return _a(e,a)}},quad:function(){return Wo},cubic:function(){return Xo},sin:function(){return $o},exp:function(){return Jo},circle:function(){return Ko},elastic:function(e,o){var r;return 2>arguments.length&&(o=.45),arguments.length?r=o/Vn*_(1/e):(e=1,r=o/4),function(a){return 1+e*_a(2,-10*a)*M((a-r)*Vn/o)}},back:function(e){return e||(e=1.70158),function(a){return a*a*((e+1)*a-e)}},bounce:function(){return Qo}}),ms=fn.map({in:C,out:Yo,"in-out":qo,"out-in":function(e){return qo(Yo(e))}});fn.ease=function(e){var o=e.indexOf("-"),r=0<=o?e.slice(0,o):e,i=0<=o?e.slice(o+1):"in";return r=hs.get(r)||gs,i=ms.get(i)||C,Go(i(r.apply(null,a.call(arguments,1))))},fn.interpolateHcl=function(e,t){e=fn.hcl(e),t=fn.hcl(t);var o=e.h,r=e.c,i=e.l,n=t.h-o,l=t.c-r,s=t.l-i;return isNaN(l)&&(l=0,r=isNaN(r)?t.c:r),isNaN(n)?(n=0,o=isNaN(o)?t.h:o):180<n?n-=360:-180>n&&(n+=360),function(e){return ze(o+n*e,r+l*e,i+s*e)+""}},fn.interpolateHsl=function(e,t){e=fn.hsl(e),t=fn.hsl(t);var o=e.h,r=e.s,i=e.l,n=t.h-o,l=t.s-r,s=t.l-i;return isNaN(l)&&(l=0,r=isNaN(r)?t.s:r),isNaN(n)?(n=0,o=isNaN(o)?t.h:o):180<n?n-=360:-180>n&&(n+=360),function(e){return Le(o+n*e,r+l*e,i+s*e)+""}},fn.interpolateLab=function(e,t){e=fn.lab(e),t=fn.lab(t);var o=e.l,r=e.a,i=e.b,n=t.l-o,l=t.a-r,s=t.b-i;return function(e){return De(o+n*e,r+l*e,i+s*e)+""}},fn.interpolateRound=er,fn.transform=function(e){var t=bn.createElementNS(fn.ns.prefix.svg,"g");return(fn.transform=function(e){if(null!=e){t.setAttribute("transform",e);var a=t.transform.baseVal.consolidate()}return new tr(a?a.matrix:ys)})(e)},tr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ys={a:1,b:0,c:0,d:1,e:0,f:0};fn.interpolateTransform=cr,fn.layout={},fn.layout.bundle=function(){return function(e){for(var t=[],a=-1,o=e.length;++a<o;)t.push(gr(e[a]));return t}},fn.layout.chord=function(){function e(){var e={},n=[],g=fn.range(d),h=[],m,a,y,f,b;for(r=[],l=[],m=0,f=-1;++f<d;){for(a=0,b=-1;++b<d;)a+=s[f][b];n.push(a),h.push(fn.range(d)),m+=a}for(c&&g.sort(function(e,t){return c(n[e],n[t])}),p&&h.forEach(function(e,t){e.sort(function(e,a){return p(s[t][e],s[t][a])})}),m=(Vn-o*d)/m,a=0,f=-1;++f<d;){for(y=a,b=-1;++b<d;){var _=g[f],w=h[_][b],T=s[_][w],v=a,A=a+=T*m;e[_+"-"+w]={index:_,subindex:w,startAngle:v,endAngle:A,value:T}}l[_]={index:_,startAngle:y,endAngle:a,value:n[_]},a+=o}for(f=-1;++f<d;)for(b=f-1;++b<d;){var S=e[f+"-"+b],C=e[b+"-"+f];(S.value||C.value)&&r.push(S.value<C.value?{source:C,target:S}:{source:S,target:C})}u&&t()}function t(){r.sort(function(e,t){return u((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var a={},o=0,r,l,s,d,c,p,u;return a.matrix=function(e){return arguments.length?(d=(s=e)&&s.length,r=l=null,a):s},a.padding=function(e){return arguments.length?(o=e,r=l=null,a):o},a.sortGroups=function(e){return arguments.length?(c=e,r=l=null,a):c},a.sortSubgroups=function(e){return arguments.length?(p=e,r=null,a):p},a.sortChords=function(e){return arguments.length?(u=e,r&&t(),a):u},a.chords=function(){return r||e(),r},a.groups=function(){return l||e(),l},a},fn.layout.force=function(){function e(e){return function(t,a,o,r){if(t.point!==e){var i=t.cx-e.x,n=t.cy-e.y,l=r-a,s=i*i+n*n;if(l*l/b<s){if(s<h){var d=t.charge/s;e.px-=i*d,e.py-=n*d}return!0}if(t.point&&s&&s<h){var d=t.pointCharge/s;e.px-=i*d,e.py-=n*d}}return!t.charge}}function t(e){e.px=fn.event.x,e.py=fn.event.y,a.resume()}var a={},r=fn.dispatch("start","tick","end"),d=[1,1],c=.9,p=fs,u=xs,g=-30,h=bs,f=.1,b=.64,_=[],v=[],w,k,T,A,S,L;return a.tick=function(){if(.005>(T*=.99))return w=null,r.end({type:"end",alpha:T=0}),!0;var a=_.length,n=v.length,p,u,h,m,b,C,E,z,I;for(u=0;u<n;++u)h=v[u],m=h.source,b=h.target,z=b.x-m.x,I=b.y-m.y,(C=z*z+I*I)&&(C=T*S[u]*((C=re(C))-A[u])/C,z*=C,I*=C,b.x-=z*(E=m.weight+b.weight?m.weight/(m.weight+b.weight):.5),b.y-=I*E,m.x+=z*(E=1-E),m.y+=I*E);if((E=T*f)&&(z=d[0]/2,I=d[1]/2,u=-1,E))for(;++u<a;)h=_[u],h.x+=(z-h.x)*E,h.y+=(I-h.y)*E;if(g)for(_r(p=fn.geom.quadtree(_),T,L),u=-1;++u<a;)(h=_[u]).fixed||p.visit(e(h));for(u=-1;++u<a;)h=_[u],h.fixed?(h.x=h.px,h.y=h.py):(h.x-=(h.px-(h.px=h.x))*c,h.y-=(h.py-(h.py=h.y))*c);r.tick({type:"tick",alpha:T})},a.nodes=function(e){return arguments.length?(_=e,a):_},a.links=function(e){return arguments.length?(v=e,a):v},a.size=function(e){return arguments.length?(d=e,a):d},a.linkDistance=function(e){return arguments.length?(p="function"==typeof e?e:+e,a):p},a.distance=a.linkDistance,a.linkStrength=function(e){return arguments.length?(u="function"==typeof e?e:+e,a):u},a.friction=function(e){return arguments.length?(c=+e,a):c},a.charge=function(e){return arguments.length?(g="function"==typeof e?e:+e,a):g},a.chargeDistance=function(e){return arguments.length?(h=e*e,a):re(h)},a.gravity=function(e){return arguments.length?(f=+e,a):f},a.theta=function(e){return arguments.length?(b=e*e,a):re(b)},a.alpha=function(e){return arguments.length?(e=+e,T?0<e?T=e:(w.c=null,w.t=NaN,w=null,r.end({type:"end",alpha:T=0})):0<e&&(r.start({type:"start",alpha:T=e}),w=Je(a.tick)),a):T},a.start=function(){function e(e,a){if(!c){for(c=Array(t),n=0;n<t;++n)c[n]=[];for(n=0;n<r;++n){var i=v[n];c[i.source.index].push(i.target),c[i.target.index].push(i.source)}}for(var o=c[s],n=-1,d=o.length,l;++n<d;)if(!isNaN(l=o[n][e]))return l;return Math.random()*a}var t=_.length,r=v.length,n=d[0],l=d[1],s,c,h;for(s=0;s<t;++s)(h=_[s]).index=s,h.weight=0;for(s=0;s<r;++s)h=v[s],"number"==typeof h.source&&(h.source=_[h.source]),"number"==typeof h.target&&(h.target=_[h.target]),++h.source.weight,++h.target.weight;for(s=0;s<t;++s)h=_[s],isNaN(h.x)&&(h.x=e("x",n)),isNaN(h.y)&&(h.y=e("y",l)),isNaN(h.px)&&(h.px=h.x),isNaN(h.py)&&(h.py=h.y);if(A=[],"function"==typeof p)for(s=0;s<r;++s)A[s]=+p.call(this,v[s],s);else for(s=0;s<r;++s)A[s]=p;if(S=[],"function"==typeof u)for(s=0;s<r;++s)S[s]=+u.call(this,v[s],s);else for(s=0;s<r;++s)S[s]=u;if(L=[],"function"==typeof g)for(s=0;s<t;++s)L[s]=+g.call(this,_[s],s);else for(s=0;s<t;++s)L[s]=g;return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){return k||(k=fn.behavior.drag().origin(C).on("dragstart.force",yr).on("drag.force",t).on("dragend.force",fr)),arguments.length?void this.on("mouseover.force",xr).on("mouseout.force",br).call(k):k},fn.rebind(a,r,"on")};var fs=20,xs=1,bs=1/0;fn.layout.hierarchy=function(){function e(r){var i=[r],l=[],s;for(r.depth=0;null!=(s=i.pop());)if(l.push(s),(c=a.call(e,s,s.depth))&&(d=c.length)){for(var d,c,p;0<=--d;)i.push(p=c[d]),p.parent=s,p.depth=s.depth+1;o&&(s.value=0),s.children=c}else o&&(s.value=+o.call(e,s,s.depth)||0),delete s.children;return kr(r,function(e){var a,r;t&&(a=e.children)&&a.sort(t),o&&(r=e.parent)&&(r.value+=e.value)}),l}var t=Sr,a=Tr,o=Ar;return e.sort=function(a){return arguments.length?(t=a,e):t},e.children=function(t){return arguments.length?(a=t,e):a},e.value=function(t){return arguments.length?(o=t,e):o},e.revalue=function(t){return o&&(wr(t,function(e){e.children&&(e.value=0)}),kr(t,function(t){var a;t.children||(t.value=+o.call(e,t,t.depth)||0),(a=t.parent)&&(a.value+=t.value)})),t},e},fn.layout.partition=function(){function e(t,a,o,r){var l=t.children;if(t.x=a,t.y=t.depth*r,t.dx=o,t.dy=r,l&&(p=l.length)){var s=-1,p,u,g;for(o=t.value?o/t.value:0;++s<p;)e(u=l[s],a,g=u.value*o,r),a+=g}}function t(e){var a=e.children,o=0;if(a&&(l=a.length))for(var r=-1,l;++r<l;)o=va(o,t(a[r]));return 1+o}function a(a,n){var i=o.call(this,a,n);return e(i[0],0,r[0],r[1]/t(i[0])),i}var o=fn.layout.hierarchy(),r=[1,1];return a.size=function(e){return arguments.length?(r=e,a):r},vr(a,o)},fn.layout.pie=function(){function e(s){var d=s.length,n=s.map(function(a,o){return+t.call(e,a,o)}),c=+("function"==typeof r?r.apply(this,arguments):r),u=("function"==typeof i?i.apply(this,arguments):i)-c,g=ie(wa(u)/d,+("function"==typeof l?l.apply(this,arguments):l)),p=g*(0>u?-1:1),h=fn.sum(n),m=h?(u-d*p)/h:0,y=fn.range(d),f=[],x;return null!=o&&y.sort(o===_s?function(e,t){return n[t]-n[e]}:function(e,t){return o(s[e],s[t])}),y.forEach(function(e){f[e]={data:s[e],value:x=n[e],startAngle:c,endAngle:c+=x*m+p,padAngle:g}}),f}var t=Number,o=_s,r=0,i=Vn,l=0;return e.value=function(a){return arguments.length?(t=a,e):t},e.sort=function(t){return arguments.length?(o=t,e):o},e.startAngle=function(t){return arguments.length?(r=t,e):r},e.endAngle=function(t){return arguments.length?(i=t,e):i},e.padAngle=function(t){return arguments.length?(l=t,e):l},e};var _s={};fn.layout.stack=function(){function e(d,c){if(!(m=d.length))return d;var p=d.map(function(a,o){return t.call(e,a,o)}),u=p.map(function(t){return t.map(function(t,a){return[s.call(e,t,a),o.call(e,t,a)]})}),g=a.call(e,u,c);p=fn.permute(p,g),u=fn.permute(u,g);var h=r.call(e,u,c),y=p[0].length,m,f,x,b;for(x=0;x<y;++x)for(l.call(e,p[0][x],b=h[x],u[0][x][1]),f=1;f<m;++f)l.call(e,p[f][x],b+=u[f-1][x][1],u[f][x][1]);return d}var t=C,a=Ir,r=Dr,l=zr,s=Lr,o=Er;return e.values=function(a){return arguments.length?(t=a,e):t},e.order=function(t){return arguments.length?(a="function"==typeof t?t:vs.get(t)||Ir,e):a},e.offset=function(t){return arguments.length?(r="function"==typeof t?t:ws.get(t)||Dr,e):r},e.x=function(t){return arguments.length?(s=t,e):s},e.y=function(t){return arguments.length?(o=t,e):o},e.out=function(t){return arguments.length?(l=t,e):l},e};var vs=fn.map({"inside-out":function(e){var t=e.length,o=e.map(Pr),r=e.map(Or),n=fn.range(t).sort(function(e,t){return o[e]-o[t]}),l=0,s=0,d=[],c=[],p,a;for(p=0;p<t;++p)a=n[p],l<s?(l+=r[a],d.push(a)):(s+=r[a],c.push(a));return c.reverse().concat(d)},reverse:function(e){return fn.range(e.length).reverse()},default:Ir}),ws=fn.map({silhouette:function(e){var t=e.length,a=e[0].length,r=[],n=0,l=[],s,d,c;for(d=0;d<a;++d){for(s=0,c=0;s<t;s++)c+=e[s][d][1];c>n&&(n=c),r.push(c)}for(d=0;d<a;++d)l[d]=(n-r[d])/2;return l},wiggle:function(e){var t=e.length,a=e[0],r=a.length,n=[],l,s,d,c,p,u,g,h,m;for(n[0]=h=m=0,s=1;s<r;++s){for(l=0,c=0;l<t;++l)c+=e[l][s][1];for(l=0,p=0,g=a[s][0]-a[s-1][0];l<t;++l){for(d=0,u=(e[l][s][1]-e[l][s-1][1])/(2*g);d<l;++d)u+=(e[d][s][1]-e[d][s-1][1])/g;p+=u*e[l][s][1]}n[s]=h-=c?p/c*g:0,h<m&&(m=h)}for(s=0;s<r;++s)n[s]-=m;return n},expand:function(e){var t=e.length,a=e[0].length,r=[],n,l,s;for(l=0;l<a;++l){for(n=0,s=0;n<t;n++)s+=e[n][l][1];if(s)for(n=0;n<t;n++)e[n][l][1]/=s;else for(n=0;n<t;n++)e[n][l][1]=1/t}for(l=0;l<a;++l)r[l]=0;return r},zero:Dr});fn.layout.histogram=function(){function e(e,l){for(var s=[],d=e.map(a,this),c=o.call(this,d,l),p=r.call(this,c,d,l),l=-1,u=d.length,n=p.length-1,g=t?1:1/u,h,m;++l<n;)h=s[l]=[],h.dx=p[l+1]-(h.x=p[l]),h.y=0;if(0<n)for(l=-1;++l<u;)m=d[l],m>=c[0]&&m<=c[1]&&(h=s[fn.bisect(p,m,1,n)-1],h.y+=g,h.push(e[l]));return s}var t=!0,a=Number,o=Br,r=Mr;return e.value=function(t){return arguments.length?(a=t,e):a},e.range=function(t){return arguments.length?(o=qe(t),e):o},e.bins=function(t){return arguments.length?(r="number"==typeof t?function(e){return jr(e,t)}:qe(t),e):r},e.frequency=function(a){return arguments.length?(t=!!a,e):t},e},fn.layout.pack=function(){function e(e,l){var i=t.call(this,e,l),s=i[0],d=o[0],c=o[1],p=null==n?re:"function"==typeof n?n:function(){return n};if(s.x=s.y=0,kr(s,function(e){e.r=+p(e.value)}),kr(s,Hr),a){var r=a*(n?1:va(2*s.r/d,2*s.r/c))/2;kr(s,function(e){e.r+=r}),kr(s,Hr),kr(s,function(e){e.r-=r})}return qr(s,d/2,c/2,n?1:1/va(2*s.r/d,2*s.r/c)),i}var t=fn.layout.hierarchy().sort(Fr),a=0,o=[1,1],n;return e.size=function(t){return arguments.length?(o=t,e):o},e.radius=function(t){return arguments.length?(n=null==t||"function"==typeof t?t:+t,e):n},e.padding=function(t){return arguments.length?(a=+t,e):a},vr(e,t)},fn.layout.tree=function(){function e(e,r){var i=l.call(this,e,r),p=i[0],u=t(p);if(kr(u,a),u.parent.m=-u.z,wr(u,o),c)wr(p,n);else{var g=p,h=p,m=p;wr(p,function(e){e.x<g.x&&(g=e),e.x>h.x&&(h=e),e.depth>m.depth&&(m=e)});var y=s(g,h)/2-g.x,f=d[0]/(h.x+s(h,g)/2+y),x=d[1]/(m.depth||1);wr(p,function(e){e.x=(e.x+y)*f,e.y=e.depth*x})}return i}function t(e){for(var t={A:null,children:[e]},a=[t],o;null!=(o=a.pop());)for(var r=o.children,l=0,s=r.length,n;l<s;++l)a.push((r[l]=n={_:r[l],parent:o,children:(n=r[l].children)&&n.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:l}).a=n);return t.children[0]}function a(e){var t=e.children,a=e.parent.children,o=e.i?a[e.i-1]:null;if(t.length){Kr(e);var i=(t[0].z+t[t.length-1].z)/2;o?(e.z=o.z+s(e._,o._),e.m=e.z-i):e.z=i}else o&&(e.z=o.z+s(e._,o._));e.parent.A=r(e,o,e.parent.A||a[0])}function o(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function r(e,t,a){if(t){for(var o=e,r=e,i=t,n=o.parent.children[0],l=o.m,d=r.m,c=i.m,p=n.m,u;i=$r(i),o=Zr(o),i&&o;)n=Zr(n),r=$r(r),r.a=e,u=i.z+c-o.z-l+s(i._,o._),0<u&&(Jr(Qr(i,e,a),e,u),l+=u,d+=u),c+=i.m,l+=o.m,p+=n.m,d+=r.m;i&&!$r(r)&&(r.t=i,r.m+=c-d),o&&!Zr(n)&&(n.t=o,n.m+=l-p,a=e)}return a}function n(e){e.x*=d[0],e.y=e.depth*d[1]}var l=fn.layout.hierarchy().sort(null).value(null),s=Xr,d=[1,1],c=null;return e.separation=function(t){return arguments.length?(s=t,e):s},e.size=function(t){return arguments.length?(c=null==(d=t)?n:null,e):c?null:d},e.nodeSize=function(t){return arguments.length?(c=null==(d=t)?null:n,e):c?d:null},vr(e,l)},fn.layout.cluster=function(){function e(e,n){var i=t.call(this,e,n),l=i[0],s=0,d;kr(l,function(e){var t=e.children;t&&t.length?(e.x=ti(t),e.y=ei(t)):(e.x=d?s+=a(e,d):0,e.y=0,d=e)});var c=ai(l),p=oi(l),u=c.x-a(c,p)/2,g=p.x+a(p,c)/2;return kr(l,r?function(e){e.x=(e.x-l.x)*o[0],e.y=(l.y-e.y)*o[1]}:function(e){e.x=(e.x-u)/(g-u)*o[0],e.y=(1-(l.y?e.y/l.y:1))*o[1]}),i}var t=fn.layout.hierarchy().sort(null).value(null),a=Xr,o=[1,1],r=!1;return e.separation=function(t){return arguments.length?(a=t,e):a},e.size=function(t){return arguments.length?(r=null==(o=t),e):r?null:o},e.nodeSize=function(t){return arguments.length?(r=null!=(o=t),e):r?o:null},vr(e,t)},fn.layout.treemap=function(){function e(e,t){for(var a=-1,o=e.length,r,n;++a<o;)n=(r=e[a]).value*(0>t?0:t),r.area=isNaN(n)||0>=n?0:n}function t(a){var i=a.children;if(i&&i.length){var l=c(a),s=[],d=i.slice(),p=1/0,h="slice"===g?l.dx:"dice"===g?l.dy:"slice-dice"===g?1&a.depth?l.dy:l.dx:ie(l.dx,l.dy),m,y,f;for(e(d,l.dx*l.dy/a.value),s.area=0;0<(f=d.length);)s.push(m=d[f-1]),s.area+=m.area,"squarify"!==g||(y=o(s,h))<=p?(d.pop(),p=y):(s.area-=s.pop().area,r(s,h,l,!1),h=ie(l.dx,l.dy),s.length=s.area=0,p=1/0);s.length&&(r(s,h,l,!0),s.length=s.area=0),i.forEach(t)}}function a(t){var o=t.children;if(o&&o.length){var i=c(t),n=o.slice(),l=[],s;for(e(n,i.dx*i.dy/t.value),l.area=0;s=n.pop();)l.push(s),l.area+=s.area,null!=s.z&&(r(l,s.z?i.dx:i.dy,i,!n.length),l.length=l.area=0);o.forEach(a)}}function o(e,t){for(var a=e.area,o=0,l=1/0,d=-1,c=e.length,n;++d<c;)(n=e[d].area)&&(n<l&&(l=n),n>o&&(o=n));return a*=a,t*=t,a?va(t*o*h/a,a/(t*l*h)):1/0}function r(e,t,a,r){var s=-1,d=e.length,n=a.x,c=a.y,p=t?l(e.area/t):0,u;if(t==a.dx){for((r||p>a.dy)&&(p=a.dy);++s<d;)u=e[s],u.x=n,u.y=c,u.dy=p,n+=u.dx=ie(a.x+a.dx-n,p?l(u.area/p):0);u.z=!0,u.dx+=a.x+a.dx-n,a.y+=p,a.dy-=p}else{for((r||p>a.dx)&&(p=a.dx);++s<d;)u=e[s],u.x=n,u.y=c,u.dx=p,c+=u.dy=ie(a.y+a.dy-c,p?l(u.area/p):0);u.z=!1,u.dy+=a.y+a.dy-c,a.x+=p,a.dx-=p}}function i(o){var r=m||n(o),i=r[0];return i.x=i.y=0,i.value?(i.dx=s[0],i.dy=s[1]):i.dx=i.dy=0,m&&n.revalue(i),e([i],i.dx*i.dy/i.value),(m?a:t)(i),p&&(m=r),r}var n=fn.layout.hierarchy(),l=R,s=[1,1],d=null,c=ri,p=!1,g="squarify",h=.5*(1+re(5)),m;return i.size=function(e){return arguments.length?(s=e,i):s},i.padding=function(e){function t(t){var a=e.call(i,t,t.depth);return null==a?ri(t):ii(t,"number"==typeof a?[a,a,a,a]:a)}function a(t){return ii(t,e)}if(!arguments.length)return d;var o;return c=null==(d=e)?ri:"function"==(o=typeof e)?t:"number"===o?(e=[e,e,e,e],a):a,i},i.round=function(e){return arguments.length?(l=e?R:Number,i):l!=Number},i.sticky=function(e){return arguments.length?(p=e,m=null,i):p},i.ratio=function(e){return arguments.length?(h=e,i):h},i.mode=function(e){return arguments.length?(g=e+"",i):g},vr(i,n)},fn.random={normal:function(e,t){var a=arguments.length;return 2>a&&(t=1),1>a&&(e=0),function(){var a,o,i;do a=2*Math.random()-1,o=2*Math.random()-1,i=a*a+o*o;while(!i||1<i);return e+t*a*re(-2*P(i)/i)}},logNormal:function(){var e=fn.random.normal.apply(fn,arguments);return function(){return ka(e())}},bates:function(e){var t=fn.random.irwinHall(e);return function(){return t()/e}},irwinHall:function(e){return function(){for(var t=0,a=0;a<e;a++)t+=Math.random();return t}}},fn.scale={};var ks={floor:C,ceil:C};fn.scale.linear=function(){return ui([0,1],[0,1],Uo,!1)};var Ts={s:1,g:1,p:1,r:1,e:1};fn.scale.log=function(){return _i(fn.scale.linear().domain([0,1]),10,!0,[1,10])};var As=fn.format(".0e"),Ss={floor:function(e){return-ae(-e)},ceil:function(e){return-ea(-e)}};fn.scale.pow=function(){return vi(fn.scale.linear(),1,[0,1])},fn.scale.sqrt=function(){return fn.scale.pow().exponent(.5)},fn.scale.ordinal=function(){return ki([],{t:"range",a:[[]]})},fn.scale.category10=function(){return fn.scale.ordinal().range(Cs)},fn.scale.category20=function(){return fn.scale.ordinal().range(Ls)},fn.scale.category20b=function(){return fn.scale.ordinal().range(Es)},fn.scale.category20c=function(){return fn.scale.ordinal().range(zs)};var Cs=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Fe),Ls=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Fe),Es=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Fe),zs=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Fe);fn.scale.quantile=function(){return Ti([],[])},fn.scale.quantize=function(){return Ai(0,1,[0,1])},fn.scale.threshold=function(){return Si([.5],[0,1])},fn.scale.identity=function(){return Ci([0,1])},fn.svg={},fn.svg.arc=function(){function e(){var e=va(0,+o.apply(this,arguments)),a=va(0,+n.apply(this,arguments)),r=d.apply(this,arguments)-Un,u=c.apply(this,arguments)-Un,g=wa(u-r),h=r>u?0:1;if(a<e&&(x=a,a=e,e=x),g>=Vn-Nn)return t(a,h)+(e?t(e,1-h):"")+"Z";var m=0,y=0,f=[],x,b,_,w,k,T,A,S,C,L,E,z;if((w=(+p.apply(this,arguments)||0)/2)&&(_=s===Is?re(e*e+a*a):+s.apply(this,arguments),!h&&(y*=-1),a&&(y=ve(_/a*M(w))),e&&(m=ve(_/e*M(w)))),a){k=a*te(r+y),T=a*M(r+y),A=a*te(u-y),S=a*M(u-y);var I=wa(u-r-2*y)<=i?0:1;if(y&&Oi(k,T,A,S)===h^I){var D=(r+u)/2;k=a*te(D),T=a*M(D),A=S=null}}else k=T=0;if(e){C=e*te(u-m),L=e*M(u-m),E=e*te(r+m),z=e*M(r+m);var P=wa(r-u+2*m)<=i?0:1;if(m&&Oi(C,L,E,z)===1-h^P){var O=(r+u)/2;C=e*te(O),L=e*M(O),E=z=null}}else C=L=0;if(g>Nn&&.001<(x=ie(wa(a-e)/2,+l.apply(this,arguments)))){b=e<a^h?0:1;var R=x,j=x;if(g<i){var B=null==E?[C,L]:null==A?[k,T]:ao([k,T],[E,z],[A,S],[C,L]),F=k-B[0],N=T-B[1],V=A-B[0],U=S-B[1],H=1/M(v((F*V+N*U)/(re(F*F+N*N)*re(V*V+U*U)))/2),G=re(B[0]*B[0]+B[1]*B[1]);j=ie(x,(e-G)/(H-1)),R=ie(x,(a-G)/(H+1))}if(null!=A){var Y=Ri(null==E?[C,L]:[E,z],[k,T],a,R,h),q=Ri([A,S],[C,L],a,R,h);x===R?f.push("M",Y[0],"A",R,",",R," 0 0,",b," ",Y[1],"A",a,",",a," 0 ",1-h^Oi(Y[1][0],Y[1][1],q[1][0],q[1][1]),",",h," ",q[1],"A",R,",",R," 0 0,",b," ",q[0]):f.push("M",Y[0],"A",R,",",R," 0 1,",b," ",q[0])}else f.push("M",k,",",T);if(null!=E){var W=Ri([k,T],[E,z],e,-j,h),X=Ri([C,L],null==A?[k,T]:[A,S],e,-j,h);x===j?f.push("L",X[0],"A",j,",",j," 0 0,",b," ",X[1],"A",e,",",e," 0 ",h^Oi(X[1][0],X[1][1],W[1][0],W[1][1]),",",1-h," ",W[1],"A",j,",",j," 0 0,",b," ",W[0]):f.push("L",X[0],"A",j,",",j," 0 0,",b," ",W[0])}else f.push("L",C,",",L)}else f.push("M",k,",",T),null!=A&&f.push("A",a,",",a," 0 ",I,",",h," ",A,",",S),f.push("L",C,",",L),null!=E&&f.push("A",e,",",e," 0 ",P,",",1-h," ",E,",",z);return f.push("Z"),f.join("")}function t(e,t){return"M0,"+e+"A"+e+","+e+" 0 1,"+t+" 0,"+-e+"A"+e+","+e+" 0 1,"+t+" 0,"+e}var o=Ei,n=zi,l=Li,s=Is,d=Ii,c=Di,p=Pi;return e.innerRadius=function(t){return arguments.length?(o=qe(t),e):o},e.outerRadius=function(t){return arguments.length?(n=qe(t),e):n},e.cornerRadius=function(t){return arguments.length?(l=qe(t),e):l},e.padRadius=function(t){return arguments.length?(s=t==Is?Is:qe(t),e):s},e.startAngle=function(t){return arguments.length?(d=qe(t),e):d},e.endAngle=function(t){return arguments.length?(c=qe(t),e):c},e.padAngle=function(t){return arguments.length?(p=qe(t),e):p},e.centroid=function(){var e=(+o.apply(this,arguments)+ +n.apply(this,arguments))/2,t=(+d.apply(this,arguments)+ +c.apply(this,arguments))/2-Un;return[te(t)*e,M(t)*e]},e};var Is="auto";fn.svg.line=function(){return Mi(C)};var Ds=fn.map({linear:ji,"linear-closed":Bi,step:function(e){for(var t=0,a=e.length,o=e[0],r=[o[0],",",o[1]];++t<a;)r.push("H",(o[0]+(o=e[t])[0])/2,"V",o[1]);return 1<a&&r.push("H",o[0]),r.join("")},"step-before":Fi,"step-after":Ni,basis:Hi,"basis-open":function(e){if(4>e.length)return ji(e);for(var t=[],a=-1,o=e.length,r=[0],n=[0],l;3>++a;)l=e[a],r.push(l[0]),n.push(l[1]);for(t.push(Gi(Rs,r)+","+Gi(Rs,n)),--a;++a<o;)l=e[a],r.shift(),r.push(l[0]),n.shift(),n.push(l[1]),Yi(t,r,n);return t.join("")},"basis-closed":function(e){for(var t=-1,a=e.length,o=a+4,r=[],n=[],l,s;4>++t;)s=e[t%a],r.push(s[0]),n.push(s[1]);for(l=[Gi(Rs,r),",",Gi(Rs,n)],--t;++t<o;)s=e[t%a],r.shift(),r.push(s[0]),n.shift(),n.push(s[1]),Yi(l,r,n);return l.join("")},bundle:function(e,a){var o=e.length-1;if(o)for(var r=e[0][0],n=e[0][1],l=e[o][0]-r,s=e[o][1]-n,d=-1,c,u;++d<=o;)c=e[d],u=d/o,c[0]=a*c[0]+(1-a)*(r+u*l),c[1]=a*c[1]+(1-a)*(n+u*s);return Hi(e)},cardinal:function(e,t){return 3>e.length?ji(e):e[0]+Vi(e,Ui(e,t))},"cardinal-open":function(e,t){return 4>e.length?ji(e):e[1]+Vi(e.slice(1,-1),Ui(e,t))},"cardinal-closed":function(e,t){return 3>e.length?Bi(e):e[0]+Vi((e.push(e[0]),e),Ui([e[e.length-2]].concat(e,[e[1]]),t))},monotone:function(e){return 3>e.length?ji(e):e[0]+Vi(e,Xi(e))}});Ds.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var Ps=[0,2/3,1/3,0],Os=[0,1/3,2/3,0],Rs=[0,1/6,2/3,1/6];fn.svg.line.radial=function(){var e=Mi(Zi);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},Fi.reverse=Ni,Ni.reverse=Fi,fn.svg.area=function(){return $i(C)},fn.svg.area.radial=function(){var e=$i(Zi);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},fn.svg.chord=function(){function e(e,d){var i=a(this,l,e,d),s=a(this,c,e,d);return"M"+i.p0+r(i.r,i.p1,i.a1-i.a0)+(o(i,s)?n(i.r,i.p1,i.r,i.p0):n(i.r,i.p1,s.r,s.p0)+r(s.r,s.p1,s.a1-s.a0)+n(s.r,s.p1,i.r,i.p0))+"Z"}function a(e,t,a,o){var i=t.call(e,a,o),n=p.call(e,i,o),r=u.call(e,i,o)-Un,l=g.call(e,i,o)-Un;return{r:n,a0:r,a1:l,p0:[n*te(r),n*M(r)],p1:[n*te(l),n*M(l)]}}function o(e,t){return e.a0==t.a0&&e.a1==t.a1}function r(e,t,o){return"A"+e+","+e+" 0 "+ +(o>i)+",1 "+t}function n(e,t,a,o){return"Q 0,0 "+o}var l=Ua,c=Ha,p=Ji,u=Ii,g=Di;return e.radius=function(t){return arguments.length?(p=qe(t),e):p},e.source=function(t){return arguments.length?(l=qe(t),e):l},e.target=function(t){return arguments.length?(c=qe(t),e):c},e.startAngle=function(t){return arguments.length?(u=qe(t),e):u},e.endAngle=function(t){return arguments.length?(g=qe(t),e):g},e},fn.svg.diagonal=function(){function e(e,r){var i=t.call(this,e,r),n=a.call(this,e,r),l=(i.y+n.y)/2,s=[i,{x:i.x,y:l},{x:n.x,y:l},n];return s=s.map(o),"M"+s[0]+"C"+s[1]+" "+s[2]+" "+s[3]}var t=Ua,a=Ha,o=Ki;return e.source=function(a){return arguments.length?(t=qe(a),e):t},e.target=function(t){return arguments.length?(a=qe(t),e):a},e.projection=function(t){return arguments.length?(o=t,e):o},e},fn.svg.diagonal.radial=function(){var e=fn.svg.diagonal(),t=Ki,a=e.projection;return e.projection=function(e){return arguments.length?a(Qi(t=e)):t},e},fn.svg.symbol=function(){function e(e,o){return(Ms.get(t.call(this,e,o))||an)(a.call(this,e,o))}var t=tn,a=en;return e.type=function(a){return arguments.length?(t=qe(a),e):t},e.size=function(t){return arguments.length?(a=qe(t),e):a},e};var Ms=fn.map({circle:an,cross:function(e){var t=re(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=re(e/(2*Bs)),a=t*Bs;return"M0,"+-t+"L"+a+",0 0,"+t+" "+-a+",0Z"},square:function(e){var t=re(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=re(e/js),a=t*js/2;return"M0,"+a+"L"+t+","+-a+" "+-t+","+-a+"Z"},"triangle-up":function(e){var t=re(e/js),a=t*js/2;return"M0,"+-a+"L"+t+","+a+" "+-t+","+a+"Z"}});fn.svg.symbolTypes=Ms.keys();var js=re(3),Bs=g(30*Hn);Pn.transition=function(e){for(var t=Us||++Vs,a=sn(e),o=[],r=Hs||{time:Date.now(),ease:Zo,delay:0,duration:250},l=-1,s=this.length,d,c;++l<s;){o.push(d=[]);for(var p=this[l],u=-1,g=p.length;++u<g;)(c=p[u])&&dn(c,u,a,t,r),d.push(c)}return rn(o,a,t)},Pn.interrupt=function(e){return this.each(null==e?Fs:on(sn(e)))};var Fs=on(sn()),Ns=[],Vs=0,Us,Hs;Ns.call=Pn.call,Ns.empty=Pn.empty,Ns.node=Pn.node,Ns.size=Pn.size,fn.transition=function(e,t){return e&&e.transition?Us?e.transition(t):e:fn.selection().transition(e)},fn.transition.prototype=Ns,Ns.select=function(e){var t=this.id,a=this.namespace,o=[],r,l,s;e=G(e);for(var d=-1,c=this.length;++d<c;){o.push(r=[]);for(var p=this[d],u=-1,g=p.length;++u<g;)(s=p[u])&&(l=e.call(s,s.__data__,u,d))?("__data__"in s&&(l.__data__=s.__data__),dn(l,u,a,t,s[a][t]),r.push(l)):r.push(null)}return rn(o,a,t)},Ns.selectAll=function(e){var t=this.id,a=this.namespace,r=[],l,s,d,c,p;e=Y(e);for(var u=-1,g=this.length;++u<g;)for(var h=this[u],m=-1,y=h.length;++m<y;)if(d=h[m]){p=d[a][t],s=e.call(d,d.__data__,m,u),r.push(l=[]);for(var n=-1,f=s.length;++n<f;)(c=s[n])&&dn(c,n,a,t,p),l.push(c)}return rn(r,a,t)},Ns.filter=function(e){var t=[],a,o,r;"function"!=typeof e&&(e=le(e));for(var l=0,s=this.length;l<s;l++){t.push(a=[]);for(var o=this[l],d=0,c=o.length;d<c;d++)(r=o[d])&&e.call(r,r.__data__,d,l)&&a.push(r)}return rn(t,this.namespace,this.id)},Ns.tween=function(e,t){var a=this.id,o=this.namespace;return 2>arguments.length?this.node()[o][a].tween.get(e):de(this,null==t?function(t){t[o][a].tween.remove(e)}:function(r){r[o][a].tween.set(e,t)})},Ns.attr=function(e,t){function a(){this.removeAttribute(n)}function o(){this.removeAttributeNS(n.space,n.local)}if(2>arguments.length){for(t in e)this.attr(t,e[t]);return this}var r="transform"==e?cr:Uo,n=fn.ns.qualify(e);return nn(this,"attr."+e,t,n.local?function(e){return null==e?o:(e+="",function(){var t=this.getAttributeNS(n.space,n.local),a;return t!==e&&(a=r(t,e),function(e){this.setAttributeNS(n.space,n.local,a(e))})})}:function(e){return null==e?a:(e+="",function(){var t=this.getAttribute(n),a;return t!==e&&(a=r(t,e),function(e){this.setAttribute(n,a(e))})})})},Ns.attrTween=function(e,t){var a=fn.ns.qualify(e);return this.tween("attr."+e,a.local?function(e,o){var r=t.call(this,e,o,this.getAttributeNS(a.space,a.local));return r&&function(e){this.setAttributeNS(a.space,a.local,r(e))}}:function(e,o){var r=t.call(this,e,o,this.getAttribute(a));return r&&function(e){this.setAttribute(a,r(e))}})},Ns.style=function(e,t,a){function r(){this.style.removeProperty(e)}var i=arguments.length;if(3>i){if("string"!=typeof e){for(a in 2>i&&(t=""),e)this.style(a,e[a],t);return this}a=""}return nn(this,"style."+e,t,function(t){return null==t?r:(t+="",function(){var r=o(this).getComputedStyle(this,null).getPropertyValue(e),n;return r!==t&&(n=Uo(r,t),function(o){this.style.setProperty(e,n(o),a)})})})},Ns.styleTween=function(e,t,a){return 3>arguments.length&&(a=""),this.tween("style."+e,function(r,n){var i=t.call(this,r,n,o(this).getComputedStyle(this,null).getPropertyValue(e));return i&&function(o){this.style.setProperty(e,i(o),a)}})},Ns.text=function(e){return nn(this,"text",e,ln)},Ns.remove=function(){var e=this.namespace;return this.each("end.transition",function(){var t;2>this[e].count&&(t=this.parentNode)&&t.removeChild(this)})},Ns.ease=function(e){var t=this.id,a=this.namespace;return 1>arguments.length?this.node()[a][t].ease:("function"!=typeof e&&(e=fn.ease.apply(fn,arguments)),de(this,function(o){o[a][t].ease=e}))},Ns.delay=function(e){var t=this.id,a=this.namespace;return 1>arguments.length?this.node()[a][t].delay:de(this,"function"==typeof e?function(o,r,i){o[a][t].delay=+e.call(o,o.__data__,r,i)}:(e=+e,function(o){o[a][t].delay=e}))},Ns.duration=function(e){var t=this.id,a=this.namespace;return 1>arguments.length?this.node()[a][t].duration:de(this,"function"==typeof e?function(o,r,i){o[a][t].duration=va(1,e.call(o,o.__data__,r,i))}:(e=va(1,e),function(o){o[a][t].duration=e}))},Ns.each=function(e,t){var a=this.id,o=this.namespace;if(2>arguments.length){var r=Hs,i=Us;try{Us=a,de(this,function(t,r,i){Hs=t[o][a],e.call(t,t.__data__,r,i)})}finally{Hs=r,Us=i}}else de(this,function(r){var i=r[o][a];(i.event||(i.event=fn.dispatch("start","end","interrupt"))).on(e,t)});return this},Ns.transition=function(){for(var e=this.id,t=++Vs,a=this.namespace,o=[],r=0,l=this.length,s,d,c,p;r<l;r++){o.push(s=[]);for(var d=this[r],u=0,g=d.length;u<g;u++)(c=d[u])&&(p=c[a][e],dn(c,u,a,t,{time:p.time,ease:p.ease,delay:p.delay+p.duration,duration:p.duration})),s.push(c)}return rn(o,a,t)},fn.svg.axis=function(){function e(e){e.each(function(){var e=fn.select(this),d=this.__chart__||t,c=this.__chart__=t.copy(),p=null==l?c.ticks?c.ticks.apply(c,n):c.domain():l,u=null==s?c.tickFormat?c.tickFormat.apply(c,n):C:s,g=e.selectAll(".tick").data(p,c),h=g.enter().insert("g",".domain").attr("class","tick").style("opacity",Nn),m=fn.transition(g.exit()).style("opacity",Nn).remove(),y=fn.transition(g.order()).style("opacity",1),f=va(o,0)+i,b=li(c),_=e.selectAll(".domain").data([0]),v=(_.enter().append("path").attr("class","domain"),fn.transition(_)),w;h.append("line"),h.append("text");var k=h.select("line"),T=y.select("line"),A=g.select("text").text(u),S=h.select("text"),L=y.select("text"),E="top"===a||"left"===a?-1:1,z,I,D,P;if("bottom"===a||"top"===a?(w=cn,z="x",D="y",I="x2",P="y2",A.attr("dy",0>E?"0em":".71em").style("text-anchor","middle"),v.attr("d","M"+b[0]+","+E*r+"V0H"+b[1]+"V"+E*r)):(w=pn,z="y",D="x",I="y2",P="x2",A.attr("dy",".32em").style("text-anchor",0>E?"end":"start"),v.attr("d","M"+E*r+","+b[0]+"H0V"+b[1]+"H"+E*r)),k.attr(P,E*o),S.attr(D,E*f),T.attr(I,0).attr(P,E*o),L.attr(z,0).attr(D,E*f),c.rangeBand){var O=c,x=O.rangeBand()/2;d=c=function(e){return O(e)+x}}else d.rangeBand?d=c:m.call(w,c,d);h.call(w,d,c),y.call(w,c,c)})}var t=fn.scale.linear(),a=Gs,o=6,r=6,i=3,n=[10],l=null,s;return e.scale=function(a){return arguments.length?(t=a,e):t},e.orient=function(t){return arguments.length?(a=t in Ys?t+"":Gs,e):a},e.ticks=function(){return arguments.length?(n=xn(arguments),e):n},e.tickValues=function(t){return arguments.length?(l=t,e):l},e.tickFormat=function(t){return arguments.length?(s=t,e):s},e.tickSize=function(t){var a=arguments.length;return a?(o=+t,r=+arguments[a-1],e):o},e.innerTickSize=function(t){return arguments.length?(o=+t,e):o},e.outerTickSize=function(t){return arguments.length?(r=+t,e):r},e.tickPadding=function(t){return arguments.length?(i=+t,e):i},e.tickSubdivide=function(){return arguments.length&&e},e};var Gs="bottom",Ys={top:1,right:1,bottom:1,left:1};fn.svg.brush=function(){function e(o){o.each(function(){var o=fn.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",i).on("touchstart.brush",i),n=o.selectAll(".background").data([0]);n.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),o.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var d=o.selectAll(".resize").data(h,C);d.exit().remove(),d.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return qs[e]}).append("rect").attr("x",function(e){return /[ew]$/.test(e)?-3:null}).attr("y",function(e){return /^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),d.style("display",e.empty()?"none":null);var c=fn.transition(o),p=fn.transition(n),u;l&&(u=li(l),p.attr("x",u[0]).attr("width",u[1]-u[0]),a(c)),s&&(u=li(s),p.attr("y",u[0]).attr("height",u[1]-u[0]),r(c)),t(c)})}function t(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+c[+/e$/.test(e)]+","+p[+/^s/.test(e)]+")"})}function a(e){e.select(".extent").attr("x",c[0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",c[1]-c[0])}function r(e){e.select(".extent").attr("y",p[0]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",p[1]-p[0])}function i(){function i(){32==fn.event.keyCode&&(!C&&(w=null,E[0]-=c[1],E[1]-=p[1],C=2),N())}function d(){32==fn.event.keyCode&&2==C&&(E[0]+=c[1],E[1]+=p[1],C=0,N())}function h(){var e=fn.mouse(b),o=!1;I&&(e[0]+=I[0],e[1]+=I[1]),C||(fn.event.altKey?(!w&&(w=[(c[0]+c[1])/2,(p[0]+p[1])/2]),E[0]=c[+(e[0]<w[0])],E[1]=p[+(e[1]<w[1])]):w=null),A&&y(e,l,0)&&(a(k),o=!0),S&&y(e,s,1)&&(r(k),o=!0),o&&(t(k),v({type:"brush",mode:C?"move":"resize"}))}function y(e,t,a){var o=li(t),r=o[0],i=o[1],n=E[a],l=a?p:c,s=l[1]-l[0],d,h;if(C&&(r-=n,i-=s+n),d=(a?g:u)?va(r,ie(i,e[a])):e[a],C?h=(d+=n)+s:(w&&(n=va(r,ie(i,2*w[a]-d))),n<d?(h=d,d=n):h=n),l[0]!=d||l[1]!=h)return a?f=null:m=null,l[0]=d,l[1]=h,!0}function x(){h(),k.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),fn.select("body").style("cursor",null),z.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),L(),v({type:"brushend"})}var b=this,_=fn.select(fn.event.target),v=n.of(b,arguments),k=fn.select(b),T=_.datum(),A=!/^(n|s)$/.test(T)&&l,S=!/^(e|w)$/.test(T)&&s,C=_.classed("extent"),L=me(b),E=fn.mouse(b),z=fn.select(o(b)).on("keydown.brush",i).on("keyup.brush",d),w,I;if(fn.event.changedTouches?z.on("touchmove.brush",h).on("touchend.brush",x):z.on("mousemove.brush",h).on("mouseup.brush",x),k.interrupt().selectAll("*").interrupt(),C)E[0]=c[0]-E[0],E[1]=p[0]-E[1];else if(T){var D=+/w$/.test(T),P=+/^n/.test(T);I=[c[1-D]-E[0],p[1-P]-E[1]],E[0]=c[D],E[1]=p[P]}else fn.event.altKey&&(w=E.slice());k.style("pointer-events","none").selectAll(".resize").style("display",null),fn.select("body").style("cursor",_.style("cursor")),v({type:"brushstart"}),h()}var n=U(e,"brushstart","brush","brushend"),l=null,s=null,c=[0,0],p=[0,0],u=!0,g=!0,h=Ws[0],m,f;return e.event=function(e){e.each(function(){var e=n.of(this,arguments),a={x:c,y:p,i:m,j:f},o=this.__chart__||a;this.__chart__=a,Us?fn.select(this).transition().each("start.brush",function(){m=o.i,f=o.j,c=o.x,p=o.y,e({type:"brushstart"})}).tween("brush:brush",function(){var o=Ho(c,a.x),r=Ho(p,a.y);return m=f=null,function(i){c=a.x=o(i),p=a.y=r(i),e({type:"brush",mode:"resize"})}}).each("end.brush",function(){m=a.i,f=a.j,e({type:"brush",mode:"resize"}),e({type:"brushend"})}):(e({type:"brushstart"}),e({type:"brush",mode:"resize"}),e({type:"brushend"}))})},e.x=function(t){return arguments.length?(l=t,h=Ws[!l<<1|!s],e):l},e.y=function(t){return arguments.length?(s=t,h=Ws[!l<<1|!s],e):s},e.clamp=function(t){return arguments.length?(l&&s?(u=!!t[0],g=!!t[1]):l?u=!!t:s&&(g=!!t),e):l&&s?[u,g]:l?u:s?g:null},e.extent=function(a){var o,r,i,n,d;return arguments.length?(l&&(o=a[0],r=a[1],s&&(o=o[0],r=r[0]),m=[o,r],l.invert&&(o=l(o),r=l(r)),r<o&&(d=o,o=r,r=d),(o!=c[0]||r!=c[1])&&(c=[o,r])),s&&(i=a[0],n=a[1],l&&(i=i[1],n=n[1]),f=[i,n],s.invert&&(i=s(i),n=s(n)),n<i&&(d=i,i=n,n=d),(i!=p[0]||n!=p[1])&&(p=[i,n])),e):(l&&(m?(o=m[0],r=m[1]):(o=c[0],r=c[1],l.invert&&(o=l.invert(o),r=l.invert(r)),r<o&&(d=o,o=r,r=d))),s&&(f?(i=f[0],n=f[1]):(i=p[0],n=p[1],s.invert&&(i=s.invert(i),n=s.invert(n)),n<i&&(d=i,i=n,n=d))),l&&s?[[o,i],[r,n]]:l?[o,r]:s&&[i,n])},e.clear=function(){return e.empty()||(c=[0,0],p=[0,0],m=f=null),e},e.empty=function(){return!!l&&c[0]==c[1]||!!s&&p[0]==p[1]},fn.rebind(e,n,"on")};var qs={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ws=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Xs=hl.format=_l.timeFormat,Zs=Xs.utc,$s=Zs("%Y-%m-%dT%H:%M:%S.%LZ");Xs.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?un:$s,un.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},un.toString=$s.toString,hl.second=it(function(e){return new ml(1e3*ea(e/1e3))},function(e,t){e.setTime(e.getTime()+1e3*ea(t))},function(e){return e.getSeconds()}),hl.seconds=hl.second.range,hl.seconds.utc=hl.second.utc.range,hl.minute=it(function(e){return new ml(6e4*ea(e/6e4))},function(e,t){e.setTime(e.getTime()+6e4*ea(t))},function(e){return e.getMinutes()}),hl.minutes=hl.minute.range,hl.minutes.utc=hl.minute.utc.range,hl.hour=it(function(e){var t=e.getTimezoneOffset()/60;return new ml(36e5*(ea(e/36e5-t)+t))},function(e,t){e.setTime(e.getTime()+36e5*ea(t))},function(e){return e.getHours()}),hl.hours=hl.hour.range,hl.hours.utc=hl.hour.utc.range,hl.month=it(function(e){return e=hl.day(e),e.setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),hl.months=hl.month.range,hl.months.utc=hl.month.utc.range;var Js=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Ks=[[hl.second,1],[hl.second,5],[hl.second,15],[hl.second,30],[hl.minute,1],[hl.minute,5],[hl.minute,15],[hl.minute,30],[hl.hour,1],[hl.hour,3],[hl.hour,6],[hl.hour,12],[hl.day,1],[hl.day,2],[hl.week,1],[hl.month,1],[hl.month,3],[hl.year,1]],Qs=Xs.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%a %d",function(e){return e.getDay()&&1!=e.getDate()}],["%b %d",function(e){return 1!=e.getDate()}],["%B",function(e){return e.getMonth()}],["%Y",Xt]]),ed={range:function(e,t,a){return fn.range(ae(e/a)*a,+t,a).map(hn)},floor:C,ceil:C};Ks.year=hl.year,hl.scale=function(){return gn(fn.scale.linear(),Ks,Qs)};var td=Ks.map(function(e){return[e[0].utc,e[1]]}),ad=Zs.multi([[".%L",function(e){return e.getUTCMilliseconds()}],[":%S",function(e){return e.getUTCSeconds()}],["%I:%M",function(e){return e.getUTCMinutes()}],["%I %p",function(e){return e.getUTCHours()}],["%a %d",function(e){return e.getUTCDay()&&1!=e.getUTCDate()}],["%b %d",function(e){return 1!=e.getUTCDate()}],["%B",function(e){return e.getUTCMonth()}],["%Y",Xt]]);td.year=hl.year.utc,hl.scale.utc=function(){return gn(fn.scale.linear(),td,ad)},fn.text=We(function(e){return e.responseText}),fn.json=function(e,t){return Xe(e,"application/json",mn,t)},fn.html=function(e,t){return Xe(e,"text/html",yn,t)},fn.xml=We(function(e){return e.responseXML}),"function"==typeof Ca&&Ca.amd?(this.d3=fn,Ca(fn)):"object"==typeof t&&t.exports?t.exports=fn:this.d3=fn}()},{}],149:[function(e,t){t.exports=function(){for(var e=0;e<arguments.length;e++)if(arguments[e]!==void 0)return arguments[e]}},{}],150:[function(e,t){"use strict";function a(e,t){this.point=e,this.index=t}function o(e,t){for(var a=e.point,o=t.point,r=a.length,n=0,l;n<r;++n)if(l=o[n]-a[n],l)return l;return 0}function r(e,t,o){if(1===e)return o?[[-1,0]]:[];var r=t.map(function(e,t){return[e[0],t]});r.sort(function(e,t){return e[0]-t[0]});for(var n=Array(e-1),l=1;l<e;++l){var s=r[l-1],a=r[l];n[l-1]=[s[1],a[1]]}return o&&n.push([-1,n[0][1]],[n[e-1][1],-1]),n}var s=e("incremental-convex-hull"),c=e("uniq");t.exports=function(e,t){var g=e.length;if(0===g)return[];var m=e[0].length;if(1>m)return[];if(1===m)return r(g,e,t);for(var d=Array(g),f=1,b=0;b<g;++b){for(var _=e[b],p=Array(m+1),w=0,k=0,T;k<m;++k)T=_[k],p[k]=T,w+=T*T;p[m]=w,d[b]=new a(p,b),f=va(w,f)}c(d,o),g=d.length;for(var A=Array(g+m+1),S=Array(g+m+1),C=(m+1)*(m+1)*f,u=Array(m+1),b=0;b<=m;++b)u[b]=0;u[m]=C,A[0]=u.slice(),S[0]=-1;for(var b=0,p;b<=m;++b)p=u.slice(),p[b]=1,A[b+1]=p,S[b+1]=-1;for(var b=0,y;b<g;++b)y=d[b],A[b+m+1]=y.point,S[b+m+1]=y.index;var L=s(A,!1);if(L=t?L.filter(function(e){for(var t=0,a=0,o;a<=m;++a){if(o=S[e[a]],0>o&&2<=++t)return!1;e[a]=o}return!0}):L.filter(function(e){for(var t=0,a;t<=m;++t){if(a=S[e[t]],0>a)return!1;e[t]=a}return!0}),1&m)for(var b=0;b<L.length;++b){var y=L[b],p=y[0];y[0]=y[1],y[1]=p}return L}},{"incremental-convex-hull":396,uniq:523}],151:[function(e,t){"use strict";function a(e,t){Array.isArray(e)&&(e=e.join(", "));var a={},o=16,s=.05,d;t&&(2===t.length&&"number"==typeof t[0]?d=r(t):Array.isArray(t)?d=t:(t.o?d=r(t.o):t.pairs&&(d=t.pairs),t.fontSize&&(o=t.fontSize),null!=t.threshold&&(s=t.threshold))),d||(d=l),n.font=o+"px "+e;for(var c=0;c<d.length;c++){var p=d[c],u=n.measureText(p[0]).width+n.measureText(p[1]).width,g=n.measureText(p).width;if(wa(u-g)>o*s){var h=(g-u)/o;a[p]=1e3*h}}return a}function r(e){for(var t=[],a=e[0],o;a<=e[1];a++){o=O(a);for(var r=e[0];r<e[1];r++){var n=O(r),l=o+n;t.push(l)}}return t}t.exports=a;var i=a.canvas=document.createElement("canvas"),n=i.getContext("2d"),l=r([32,126]);a.createPairs=r,a.ascii=l},{}],152:[function(e,t){(function(e){var a=!1;if("undefined"!=typeof Float64Array){var o=new Float64Array(1),r=new Uint32Array(o.buffer);if(o[0]=1,a=!0,1072693248===r[1]){t.exports=function(e){return o[0]=e,[r[0],r[1]]},t.exports.pack=function(e,t){return r[0]=e,r[1]=t,o[0]},t.exports.lo=function(e){return o[0]=e,r[0]},t.exports.hi=function(e){return o[0]=e,r[1]}}else if(1072693248===r[0]){t.exports=function(e){return o[0]=e,[r[1],r[0]]},t.exports.pack=function(e,t){return r[1]=e,r[0]=t,o[0]},t.exports.lo=function(e){return o[0]=e,r[1]},t.exports.hi=function(e){return o[0]=e,r[0]}}else a=!1}if(!a){var i=new e(8);t.exports=function(e){return i.writeDoubleLE(e,0,!0),[i.readUInt32LE(0,!0),i.readUInt32LE(4,!0)]},t.exports.pack=function(e,t){return i.writeUInt32LE(e,0,!0),i.writeUInt32LE(t,4,!0),i.readDoubleLE(0,!0)},t.exports.lo=function(e){return i.writeDoubleLE(e,0,!0),i.readUInt32LE(0,!0)},t.exports.hi=function(e){return i.writeDoubleLE(e,0,!0),i.readUInt32LE(4,!0)}}t.exports.sign=function(e){return t.exports.hi(e)>>>31},t.exports.exponent=function(e){var a=t.exports.hi(e);return(a<<1>>>21)-1023},t.exports.fraction=function(e){var a=t.exports.lo(e),o=t.exports.hi(e),r=1048575&o;return 2146435072&o&&(r+=1048576),[a,r]},t.exports.denormalized=function(e){var a=t.exports.hi(e);return!(2146435072&a)}}).call(this,e("buffer").Buffer)},{buffer:93}],153:[function(e,t){var a=e("abs-svg-path"),o=e("normalize-svg-path"),r={M:"moveTo",C:"bezierCurveTo"};t.exports=function(e,t){e.beginPath(),o(a(t)).forEach(function(t){var a=t[0],o=t.slice(1);e[r[a]].apply(e,o)}),e.closePath()}},{"abs-svg-path":48,"normalize-svg-path":435}],154:[function(e,t){t.exports=function(e){return"int8"===e?Int8Array:"int16"===e?Int16Array:"int32"===e?Int32Array:"uint8"===e?Uint8Array:"uint16"===e?Uint16Array:"uint32"===e?Uint32Array:"float32"===e?Float32Array:"float64"===e?Float64Array:"array"===e?Array:"uint8_clamped"===e?Uint8ClampedArray:void 0}},{}],155:[function(e,t){"use strict";function a(e,t,o){var r=0|e[o];if(0>=r)return[];var i=Array(r),n;if(o===e.length-1)for(n=0;n<r;++n)i[n]=t;else for(n=0;n<r;++n)i[n]=a(e,t,o+1);return i}function o(e,t){var a,o;for(a=Array(e),o=0;o<e;++o)a[o]=t;return a}t.exports=function(e,t){switch("undefined"==typeof t&&(t=0),typeof e){case"number":if(0<e)return o(0|e,t);break;case"object":if("number"==typeof e.length)return a(e,t,0);}return[]}},{}],156:[function(e,t){"use strict";function a(e,t,a){a=a||2;var r=t&&t.length,l=r?t[0]*a:e.length,s=o(e,0,l,a,!0),d=[];if(!s)return d;var c,u,g,h,m,f,b;if(r&&(s=p(e,t,s,a)),e.length>80*a){c=g=e[0],u=h=e[1];for(var _=a;_<l;_+=a)m=e[_],f=e[_+1],m<c&&(c=m),f<u&&(u=f),m>g&&(g=m),f>h&&(h=f);b=va(g-c,h-u),b=0===b?0:1/b}return n(s,d,a,c,u,b),d}function o(e,t,a,o,r){var n,l;if(r===0<D(e,t,a,o))for(n=t;n<a;n+=o)l=E(n,e[n],e[n+1],l);else for(n=a-o;n>=t;n-=o)l=E(n,e[n],e[n+1],l);return l&&k(l,l.next)&&(z(l),l=l.next),l}function r(e,t){if(!e)return e;t||(t=e);var a=e,o;do if(o=!1,!a.steiner&&(k(a,a.next)||0===w(a.prev,a,a.next))){if(z(a),a=t=a.prev,a===a.next)break;o=!0}else a=a.next;while(o||a!==t);return t}function n(e,t,a,o,i,p,u){if(e){!u&&p&&m(e,o,i,p);for(var g=e,h,y;e.prev!==e.next;){if(h=e.prev,y=e.next,p?s(e,o,i,p):l(e)){t.push(h.i/a),t.push(e.i/a),t.push(y.i/a),z(e),e=y.next,g=y.next;continue}if(e=y,e===g){u?1===u?(e=d(e,t,a),n(e,t,a,o,i,p,2)):2==u&&c(e,t,a,o,i,p):n(r(e),t,a,o,i,p,1);break}}}}function l(e){var t=e.prev,a=e,o=e.next;if(0<=w(t,a,o))return!1;for(var r=e.next.next;r!==e.prev;){if(_(t.x,t.y,a.x,a.y,o.x,o.y,r.x,r.y)&&0<=w(r.prev,r,r.next))return!1;r=r.next}return!0}function s(e,t,o,r){var i=e.prev,a=e,l=e.next;if(0<=w(i,a,l))return!1;for(var s=i.x<a.x?i.x<l.x?i.x:l.x:a.x<l.x?a.x:l.x,d=i.y<a.y?i.y<l.y?i.y:l.y:a.y<l.y?a.y:l.y,c=i.x>a.x?i.x>l.x?i.x:l.x:a.x>l.x?a.x:l.x,u=i.y>a.y?i.y>l.y?i.y:l.y:a.y>l.y?a.y:l.y,g=f(s,d,t,o,r),h=f(c,u,t,o,r),m=e.prevZ,y=e.nextZ;m&&m.z>=g&&y&&y.z<=h;){if(m!==e.prev&&m!==e.next&&_(i.x,i.y,a.x,a.y,l.x,l.y,m.x,m.y)&&0<=w(m.prev,m,m.next))return!1;if(m=m.prevZ,y!==e.prev&&y!==e.next&&_(i.x,i.y,a.x,a.y,l.x,l.y,y.x,y.y)&&0<=w(y.prev,y,y.next))return!1;y=y.nextZ}for(;m&&m.z>=g;){if(m!==e.prev&&m!==e.next&&_(i.x,i.y,a.x,a.y,l.x,l.y,m.x,m.y)&&0<=w(m.prev,m,m.next))return!1;m=m.prevZ}for(;y&&y.z<=h;){if(y!==e.prev&&y!==e.next&&_(i.x,i.y,a.x,a.y,l.x,l.y,y.x,y.y)&&0<=w(y.prev,y,y.next))return!1;y=y.nextZ}return!0}function d(e,t,o){var r=e;do{var i=r.prev,a=r.next.next;!k(i,a)&&T(i,r,r.next,a)&&S(i,a)&&S(a,i)&&(t.push(i.i/o),t.push(r.i/o),t.push(a.i/o),z(r),z(r.next),r=e=a),r=r.next}while(r!==e);return r}function c(e,t,o,i,l,s){var d=e;do{for(var p=d.next.next;p!==d.prev;){if(d.i!==p.i&&v(d,p)){var u=L(d,p);return d=r(d,d.next),u=r(u,u.next),n(d,t,o,i,l,s),void n(u,t,o,i,l,s)}p=p.next}d=d.next}while(d!==e)}function p(e,t,a,n){var l=[],s,d,c,p,h;for(s=0,d=t.length;s<d;s++)c=t[s]*n,p=s<d-1?t[s+1]*n:e.length,h=o(e,c,p,n,!1),h===h.next&&(h.steiner=!0),l.push(x(h));for(l.sort(u),s=0;s<l.length;s++)g(l[s],a),a=r(a,a.next);return a}function u(e,t){return e.x-t.x}function g(e,t){if(t=h(e,t),t){var a=L(t,e);r(a,a.next)}}function h(e,t){var a=t,o=e.x,r=e.y,i=-Infinity,n;do{if(r<=a.y&&r>=a.next.y&&a.next.y!==a.y){var l=a.x+(r-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(l<=o&&l>i){if(i=l,l===o){if(r===a.y)return a;if(r===a.next.y)return a.next}n=a.x<a.next.x?a:a.next}}a=a.next}while(a!==t);if(!n)return null;if(o===i)return n.prev;var s=n,d=n.x,c=n.y,u=1/0,g;for(a=n.next;a!==s;)o>=a.x&&a.x>=d&&o!==a.x&&_(r<c?o:i,r,d,c,r<c?i:o,r,a.x,a.y)&&(g=wa(r-a.y)/(o-a.x),(g<u||g===u&&a.x>n.x)&&S(a,e)&&(n=a,u=g)),a=a.next;return n}function m(e,t,a,o){var r=e;do null===r.z&&(r.z=f(r.x,r.y,t,a,o)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,y(r)}function y(t){var a=1,o,r,n,l,s,d,c,u;do{for(r=t,t=null,s=null,d=0;r;){for(d++,n=r,c=0,o=0;o<a&&(c++,n=n.nextZ,!!n);o++);for(u=a;0<c||0<u&&n;)0!==c&&(0===u||!n||r.z<=n.z)?(l=r,r=r.nextZ,c--):(l=n,n=n.nextZ,u--),s?s.nextZ=l:t=l,l.prevZ=s,s=l;r=n}s.nextZ=null,a*=2}while(1<d);return t}function f(e,t,a,o,r){return e=32767*(e-a)*r,t=32767*(t-o)*r,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1}function x(e){var t=e,a=e;do t.x<a.x&&(a=t),t=t.next;while(t!==e);return a}function _(e,t,a,o,r,i,n,l){return 0<=(r-n)*(t-l)-(e-n)*(i-l)&&0<=(e-n)*(o-l)-(a-n)*(t-l)&&0<=(a-n)*(i-l)-(r-n)*(o-l)}function v(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!A(e,t)&&S(e,t)&&S(t,e)&&C(e,t)}function w(e,t,a){return(t.y-e.y)*(a.x-t.x)-(t.x-e.x)*(a.y-t.y)}function k(e,t){return e.x===t.x&&e.y===t.y}function T(e,t,a,o){return!!(k(e,t)&&k(a,o)||k(e,o)&&k(a,t))||0<w(e,t,a)!=0<w(e,t,o)&&0<w(a,o,e)!=0<w(a,o,t)}function A(e,t){var a=e;do{if(a.i!==e.i&&a.next.i!==e.i&&a.i!==t.i&&a.next.i!==t.i&&T(a,a.next,e,t))return!0;a=a.next}while(a!==e);return!1}function S(e,t){return 0>w(e.prev,e,e.next)?0<=w(e,t,e.next)&&0<=w(e,e.prev,t):0>w(e,t,e.prev)||0>w(e,e.next,t)}function C(e,t){var a=e,o=!1,r=(e.x+t.x)/2,i=(e.y+t.y)/2;do a.y>i!=a.next.y>i&&a.next.y!==a.y&&r<(a.next.x-a.x)*(i-a.y)/(a.next.y-a.y)+a.x&&(o=!o),a=a.next;while(a!==e);return o}function L(e,t){var a=new I(e.i,e.x,e.y),o=new I(t.i,t.x,t.y),r=e.next,i=t.prev;return e.next=t,t.prev=e,a.next=r,r.prev=a,o.next=a,a.prev=o,i.next=o,o.prev=i,o}function E(e,t,a,o){var r=new I(e,t,a);return o?(r.next=o.next,r.prev=o,o.next.prev=r,o.next=r):(r.prev=r,r.next=r),r}function z(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function I(e,t,a){this.i=e,this.x=t,this.y=a,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function D(e,t,a,o){for(var r=0,n=t,l=a-o;n<a;n+=o)r+=(e[l]-e[n])*(e[n+1]+e[l+1]),l=n;return r}t.exports=a,t.exports.default=a,a.deviation=function(e,t,o,r){var n=t&&t.length,l=n?t[0]*o:e.length,s=wa(D(e,0,l,o));if(n)for(var d=0,p=t.length;d<p;d++){var u=t[d]*o,g=d<p-1?t[d+1]*o:e.length;s-=wa(D(e,u,g,o))}var h=0;for(d=0;d<r.length;d+=3){var m=r[d]*o,a=r[d+1]*o,y=r[d+2]*o;h+=wa((e[m]-e[y])*(e[a+1]-e[m+1])-(e[m]-e[a])*(e[y+1]-e[m+1]))}return 0===s&&0===h?0:wa((h-s)/s)},a.flatten=function(e){for(var t=e[0][0].length,a={vertices:[],holes:[],dimensions:t},o=0,r=0;r<e.length;r++){for(var n=0;n<e[r].length;n++)for(var l=0;l<t;l++)a.vertices.push(e[r][n][l]);0<r&&(o+=e[r-1].length,a.holes.push(o))}return a}},{}],157:[function(e,t){"use strict";t.exports=function(t,o){var r=t.length;if("number"!=typeof o){o=0;for(var n=0,l;n<r;++n)l=t[n],o=va(o,l[0],l[1]);o=(0|o)+1}o|=0;for(var s=Array(o),n=0;n<o;++n)s[n]=[];for(var n=0,l;n<r;++n)l=t[n],s[l[0]].push(l[1]),s[l[1]].push(l[0]);for(var d=0;d<o;++d)a(s[d],function(e,t){return e-t});return s};var a=e("uniq")},{uniq:523}],158:[function(e,t){"use strict";var a=e("../../object/valid-value");t.exports=function(){return a(this).length=0,this}},{"../../object/valid-value":190}],159:[function(e,t){"use strict";t.exports=e("./is-implemented")()?Array.from:e("./shim")},{"./is-implemented":160,"./shim":161}],160:[function(e,t){"use strict";t.exports=function(){var e=Array.from,t,a;return!("function"!=typeof e)&&(t=["raz","dwa"],a=e(t),!!(a&&a!==t&&"dwa"===a[1]))}},{}],161:[function(e,t){"use strict";var a=e("es6-symbol").iterator,o=e("../../function/is-arguments"),r=e("../../function/is-function"),n=e("../../number/to-pos-integer"),l=e("../../object/valid-callable"),s=e("../../object/valid-value"),d=e("../../object/is-value"),c=e("../../string/is-string"),p=Array.isArray,u=Function.prototype.call,g={configurable:!0,enumerable:!0,writable:!0,value:null},h=Object.defineProperty;t.exports=function(e){var t=arguments[1],m=arguments[2],y,f,x,b,_,v,w,k,T,A;if(e=Object(s(e)),d(t)&&l(t),!this||this===Array||!r(this)){if(!t){if(o(e))return(_=e.length,1!==_)?Array.apply(null,e):(b=[,],b[0]=e[0],b);if(p(e)){for(b=Array(_=e.length),f=0;f<_;++f)b[f]=e[f];return b}}b=[]}else y=this;if(!p(e))if(void 0!==(T=e[a])){for(w=l(T).call(e),y&&(b=new y),k=w.next(),f=0;!k.done;)A=t?u.call(t,m,k.value,f):k.value,y?(g.value=A,h(b,f,g)):b[f]=A,k=w.next(),++f;_=f}else if(c(e)){for(_=e.length,y&&(b=new y),(f=0,x=0);f<_;++f)A=e[f],f+1<_&&(v=A.charCodeAt(0),55296<=v&&56319>=v&&(A+=e[++f])),A=t?u.call(t,m,A,x):A,y?(g.value=A,h(b,x,g)):b[x]=A,++x;_=x}if(void 0===_)for(_=n(e.length),y&&(b=new y(_)),f=0;f<_;++f)A=t?u.call(t,m,e[f],f):e[f],y?(g.value=A,h(b,f,g)):b[f]=A;return y&&(g.value=null,b.length=_),b}},{"../../function/is-arguments":162,"../../function/is-function":163,"../../number/to-pos-integer":169,"../../object/is-value":179,"../../object/valid-callable":188,"../../object/valid-value":190,"../../string/is-string":194,"es6-symbol":204}],162:[function(e,t){"use strict";var a=Object.prototype.toString,o=a.call(function(){return arguments}());t.exports=function(e){return a.call(e)===o}},{}],163:[function(e,t){"use strict";var a=Object.prototype.toString,o=a.call(e("./noop"));t.exports=function(e){return"function"==typeof e&&a.call(e)===o}},{"./noop":164}],164:[function(e,t){"use strict";t.exports=function(){}},{}],165:[function(e,t){"use strict";t.exports=e("./is-implemented")()?r:e("./shim")},{"./is-implemented":166,"./shim":167}],166:[function(e,t){"use strict";t.exports=function(){var e=r;return!("function"!=typeof e)&&1===e(10)&&-1===e(-20)}},{}],167:[function(e,t){"use strict";t.exports=function(e){return e=+e,isNaN(e)||0===e?e:0<e?1:-1}},{}],168:[function(e,t){"use strict";var a=e("../math/sign");t.exports=function(e){return isNaN(e)?0:(e=+e,0!==e&&isFinite(e)?a(e)*ea(wa(e)):e)}},{"../math/sign":165}],169:[function(e,t){"use strict";var a=e("./to-integer");t.exports=function(e){return va(0,a(e))}},{"./to-integer":168}],170:[function(e,t){"use strict";var a=e("./valid-callable"),o=e("./valid-value"),r=Function.prototype.bind,i=Function.prototype.call,n=Object.keys,l=Object.prototype.propertyIsEnumerable;t.exports=function(e,t){return function(s,d){var c=arguments[2],p=arguments[3],u;return s=Object(o(s)),a(d),u=n(s),p&&u.sort("function"==typeof p?r.call(p,s):void 0),"function"!=typeof e&&(e=u[e]),i.call(e,u,function(e,a){return l.call(s,e)?i.call(d,c,s[e],e,s,a):t})}}},{"./valid-callable":188,"./valid-value":190}],171:[function(e,t){"use strict";t.exports=e("./is-implemented")()?Object.assign:e("./shim")},{"./is-implemented":172,"./shim":173}],172:[function(e,t){"use strict";t.exports=function(){var e=Object.assign,t;return!("function"!=typeof e)&&(t={foo:"raz"},e(t,{bar:"dwa"},{trzy:"trzy"}),"razdwatrzy"===t.foo+t.bar+t.trzy)}},{}],173:[function(e,t){"use strict";var a=e("../keys"),o=e("../valid-value");t.exports=function(e,t){var r=va(arguments.length,2),n,l,s;for(e=Object(o(e)),s=function(a){try{e[a]=t[a]}catch(t){n||(n=t)}},l=1;l<r;++l)t=arguments[l],a(t).forEach(s);if(n!==void 0)throw n;return e}},{"../keys":180,"../valid-value":190}],174:[function(e,t){"use strict";var a=e("../array/from"),o=e("./assign"),r=e("./valid-value");t.exports=function(e){var t=Object(r(e)),i=arguments[1],n=Object(arguments[2]);if(t!==e&&!i)return t;var l={};return i?a(i,function(t){(n.ensure||t in e)&&(l[t]=e[t])}):o(l,e),l}},{"../array/from":159,"./assign":171,"./valid-value":190}],175:[function(e,t){"use strict";var a=Object.create,o;e("./set-prototype-of/is-implemented")()||(o=e("./set-prototype-of/shim")),t.exports=function(){var e,t,r;return o?1===o.level?(e={},t={},r={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(e){return"__proto__"===e?void(t[e]={configurable:!0,enumerable:!1,writable:!0,value:void 0}):void(t[e]=r)}),Object.defineProperties(e,t),Object.defineProperty(o,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:e}),function(t,o){return a(null===t?e:t,o)}):a:a}()},{"./set-prototype-of/is-implemented":186,"./set-prototype-of/shim":187}],176:[function(e,t){"use strict";t.exports=e("./_iterate")("forEach")},{"./_iterate":170}],177:[function(e,t){"use strict";t.exports=function(e){return"function"==typeof e}},{}],178:[function(e,t){"use strict";var a=e("./is-value"),o={function:!0,object:!0};t.exports=function(e){return a(e)&&o[typeof e]||!1}},{"./is-value":179}],179:[function(e,t){"use strict";var a=e("../function/noop")();t.exports=function(e){return e!==a&&null!==e}},{"../function/noop":164}],180:[function(e,t){"use strict";t.exports=e("./is-implemented")()?Object.keys:e("./shim")},{"./is-implemented":181,"./shim":182}],181:[function(e,t){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},{}],182:[function(e,t){"use strict";var a=e("../is-value"),o=Object.keys;t.exports=function(e){return o(a(e)?Object(e):e)}},{"../is-value":179}],183:[function(e,t){"use strict";var a=e("./valid-callable"),o=e("./for-each"),r=Function.prototype.call;t.exports=function(e,t){var i={},n=arguments[2];return a(t),o(e,function(e,a,o,l){i[a]=r.call(t,n,e,a,o,l)}),i}},{"./for-each":176,"./valid-callable":188}],184:[function(e,t){"use strict";var a=e("./is-value"),o=Array.prototype.forEach,r=Object.create,i=function(e,t){for(var a in e)t[a]=e[a]};t.exports=function(){var e=r(null);return o.call(arguments,function(t){a(t)&&i(Object(t),e)}),e}},{"./is-value":179}],185:[function(e,t){"use strict";t.exports=e("./is-implemented")()?Object.setPrototypeOf:e("./shim")},{"./is-implemented":186,"./shim":187}],186:[function(e,t){"use strict";var a=Object.create,o=Object.getPrototypeOf,r={};t.exports=function(){var e=Object.setPrototypeOf,t=arguments[0]||a;return!("function"!=typeof e)&&o(e(t(null),r))===r}},{}],187:[function(e,t){"use strict";var a=e("../is-object"),o=e("../valid-value"),r=Object.prototype.isPrototypeOf,i=Object.defineProperty,n={configurable:!0,enumerable:!1,writable:!0,value:void 0},l;l=function(e,t){if(o(e),null===t||a(t))return e;throw new TypeError("Prototype must be null or an object")},t.exports=function(e){var t,a;return e?(2===e.level?e.set?(a=e.set,t=function(e,t){return a.call(l(e,t),t),e}):t=function(e,t){return l(e,t).__proto__=t,e}:t=function e(t,a){var o;return l(t,a),o=r.call(e.nullPolyfill,t),o&&delete e.nullPolyfill.__proto__,null===a&&(a=e.nullPolyfill),t.__proto__=a,o&&i(e.nullPolyfill,"__proto__",n),t},Object.defineProperty(t,"level",{configurable:!1,enumerable:!1,writable:!1,value:e.level})):null}(function(){var e=Object.create(null),t={},a=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__"),o;if(a){try{o=a.set,o.call(e,t)}catch(e){}if(Object.getPrototypeOf(e)===t)return{set:o,level:2}}return(e.__proto__=t,Object.getPrototypeOf(e)===t)?{level:2}:(e={},e.__proto__=t,Object.getPrototypeOf(e)===t&&{level:1})}()),e("../create")},{"../create":175,"../is-object":178,"../valid-value":190}],188:[function(e,t){"use strict";t.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},{}],189:[function(e,t){"use strict";var a=e("./is-object");t.exports=function(e){if(!a(e))throw new TypeError(e+" is not an Object");return e}},{"./is-object":178}],190:[function(e,t){"use strict";var a=e("./is-value");t.exports=function(e){if(!a(e))throw new TypeError("Cannot use null or undefined");return e}},{"./is-value":179}],191:[function(e,t){"use strict";t.exports=e("./is-implemented")()?o.contains:e("./shim")},{"./is-implemented":192,"./shim":193}],192:[function(e,t){"use strict";t.exports=function(){return!1}},{}],193:[function(e,t){"use strict";var a=o.indexOf;t.exports=function(e){return-1<a.call(this,e,arguments[1])}},{}],194:[function(e,t){"use strict";var a=Object.prototype.toString,o=a.call("");t.exports=function(e){return"string"==typeof e||e&&"object"==typeof e&&(e instanceof String||a.call(e)===o)||!1}},{}],195:[function(e,t){"use strict";var a=Object.create(null),o=Math.random;t.exports=function(){var e;do e=o().toString(36).slice(2);while(a[e]);return e}},{}],196:[function(e,t){"use strict";var a=e("es5-ext/object/set-prototype-of"),o=e("es5-ext/string/#/contains"),r=e("d"),i=e("es6-symbol"),n=e("./"),l=Object.defineProperty,s;s=t.exports=function(e,t){if(!(this instanceof s))throw new TypeError("Constructor requires 'new'");n.call(this,e),t=t?o.call(t,"key+value")?"key+value":o.call(t,"key")?"key":"value":"value",l(this,"__kind__",r("",t))},a&&a(s,n),delete s.prototype.constructor,s.prototype=Object.create(n.prototype,{_resolve:r(function(e){return"value"===this.__kind__?this.__list__[e]:"key+value"===this.__kind__?[e,this.__list__[e]]:e})}),l(s.prototype,i.toStringTag,r("c","Array Iterator"))},{"./":199,d:139,"es5-ext/object/set-prototype-of":185,"es5-ext/string/#/contains":191,"es6-symbol":204}],197:[function(e,t){"use strict";var a=e("es5-ext/function/is-arguments"),o=e("es5-ext/object/valid-callable"),r=e("es5-ext/string/is-string"),n=e("./get"),l=Array.isArray,s=Function.prototype.call,d=Array.prototype.some;t.exports=function(e,t){var c=arguments[2],p,u,g,h,m,y,f,x;if(l(e)||a(e)?p="array":r(e)?p="string":e=n(e),o(t),g=function(){h=!0},"array"===p)return void d.call(e,function(e){return s.call(t,c,e,g),h});if("string"===p){for(y=e.length,m=0;m<y&&(f=e[m],m+1<y&&(x=f.charCodeAt(0),55296<=x&&56319>=x&&(f+=e[++m])),s.call(t,c,f,g),!h);++m);return}for(u=e.next();!u.done;){if(s.call(t,c,u.value,g),h)return;u=e.next()}}},{"./get":198,"es5-ext/function/is-arguments":162,"es5-ext/object/valid-callable":188,"es5-ext/string/is-string":194}],198:[function(e,t){"use strict";var a=e("es5-ext/function/is-arguments"),o=e("es5-ext/string/is-string"),r=e("./array"),i=e("./string"),n=e("./valid-iterable"),l=e("es6-symbol").iterator;t.exports=function(e){return"function"==typeof n(e)[l]?e[l]():a(e)?new r(e):o(e)?new i(e):new r(e)}},{"./array":196,"./string":201,"./valid-iterable":202,"es5-ext/function/is-arguments":162,"es5-ext/string/is-string":194,"es6-symbol":204}],199:[function(e,t){"use strict";var a=e("es5-ext/array/#/clear"),o=e("es5-ext/object/assign"),r=e("es5-ext/object/valid-callable"),i=e("es5-ext/object/valid-value"),n=e("d"),l=e("d/auto-bind"),s=e("es6-symbol"),d=Object.defineProperty,c=Object.defineProperties,p;t.exports=p=function(e,t){if(!(this instanceof p))throw new TypeError("Constructor requires 'new'");c(this,{__list__:n("w",i(e)),__context__:n("w",t),__nextIndex__:n("w",0)});t&&(r(t.on),t.on("_add",this._onAdd),t.on("_delete",this._onDelete),t.on("_clear",this._onClear))},delete p.prototype.constructor,c(p.prototype,o({_next:n(function(){var e;if(this.__list__){if(this.__redo__&&(e=this.__redo__.shift(),void 0!==e))return e;if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind()}}),next:n(function(){return this._createResult(this._next())}),_createResult:n(function(e){return void 0===e?{done:!0,value:void 0}:{done:!1,value:this._resolve(e)}}),_resolve:n(function(e){return this.__list__[e]}),_unBind:n(function(){this.__list__=null,delete this.__redo__;this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:n(function(){return"[object "+(this[s.toStringTag]||"Object")+"]"})},l({_onAdd:n(function(e){if(!(e>=this.__nextIndex__))return++this.__nextIndex__,this.__redo__?void(this.__redo__.forEach(function(t,a){t>=e&&(this.__redo__[a]=++t)},this),this.__redo__.push(e)):void d(this,"__redo__",n("c",[e]))}),_onDelete:n(function(e){var t;e>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(t=this.__redo__.indexOf(e),-1!==t&&this.__redo__.splice(t,1),this.__redo__.forEach(function(t,a){t>e&&(this.__redo__[a]=--t)},this)))}),_onClear:n(function(){this.__redo__&&a.call(this.__redo__),this.__nextIndex__=0})}))),d(p.prototype,s.iterator,n(function(){return this}))},{d:139,"d/auto-bind":138,"es5-ext/array/#/clear":158,"es5-ext/object/assign":171,"es5-ext/object/valid-callable":188,"es5-ext/object/valid-value":190,"es6-symbol":204}],200:[function(e,t){"use strict";var a=e("es5-ext/function/is-arguments"),o=e("es5-ext/object/is-value"),r=e("es5-ext/string/is-string"),i=e("es6-symbol").iterator,n=Array.isArray;t.exports=function(e){return!!o(e)&&(!!n(e)||!!r(e)||!!a(e)||"function"==typeof e[i])}},{"es5-ext/function/is-arguments":162,"es5-ext/object/is-value":179,"es5-ext/string/is-string":194,"es6-symbol":204}],201:[function(e,t){"use strict";var a=e("es5-ext/object/set-prototype-of"),o=e("d"),r=e("es6-symbol"),i=e("./"),n=Object.defineProperty,l;l=t.exports=function(e){if(!(this instanceof l))throw new TypeError("Constructor requires 'new'");e=e+"",i.call(this,e),n(this,"__length__",o("",e.length))},a&&a(l,i),delete l.prototype.constructor,l.prototype=Object.create(i.prototype,{_next:o(function(){if(this.__list__){if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind()}}),_resolve:o(function(e){var t=this.__list__[e],a;return this.__nextIndex__===this.__length__?t:(a=t.charCodeAt(0),55296<=a&&56319>=a?t+this.__list__[this.__nextIndex__++]:t)})}),n(l.prototype,r.toStringTag,o("c","String Iterator"))},{"./":199,d:139,"es5-ext/object/set-prototype-of":185,"es6-symbol":204}],202:[function(e,t){"use strict";var a=e("./is-iterable");t.exports=function(e){if(!a(e))throw new TypeError(e+" is not iterable");return e}},{"./is-iterable":200}],203:[function(e,t,a){(function(o,r){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   3.3.1
 */(function(e,o){"object"==typeof a&&"undefined"!=typeof t?t.exports=o():"function"==typeof Ca&&Ca.amd?Ca(o):e.ES6Promise=o()})(this,function(){"use strict";function t(e){return"function"==typeof e||"object"==typeof e&&null!==e}function a(e){return"function"==typeof e}function i(){return function(){N(l)}}function n(){var e=setTimeout;return function(){return e(l,1)}}function l(){for(var e=0;e<F;e+=2){var t=X[e],a=X[e+1];t(a),X[e]=void 0,X[e+1]=void 0}F=0}function s(e,t){var a=arguments,o=this,r=new this.constructor(p);void 0===r[$]&&z(r);var i=o._state;return i?function(){var e=a[i-1];U(function(){return C(i,r,e,o._result)})}():k(o,r,e,t),r}function d(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var a=new t(p);return b(a,e),a}function p(){}function u(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function h(e){try{return e.then}catch(e){return Q.error=e,Q}}function m(e,t,a,o){try{e.call(t,a,o)}catch(t){return t}}function y(e,t,a){U(function(e){var o=!1,r=m(a,t,function(a){o||(o=!0,t===a?v(e,a):b(e,a))},function(t){o||(o=!0,w(e,t))},"Settle: "+(e._label||" unknown promise"));!o&&r&&(o=!0,w(e,r))},e)}function f(e,t){1===t._state?v(e,t._result):2===t._state?w(e,t._result):k(t,void 0,function(t){return b(e,t)},function(t){return w(e,t)})}function x(e,t,o){t.constructor===e.constructor&&o===s&&t.constructor.resolve===d?f(e,t):o===Q?w(e,Q.error):void 0===o?v(e,t):a(o)?y(e,t,o):v(e,t)}function b(e,a){e===a?w(e,u()):t(a)?x(e,a,h(a)):v(e,a)}function _(e){e._onerror&&e._onerror(e._result),T(e)}function v(e,t){void 0!==e._state||(e._result=t,e._state=1,0!==e._subscribers.length&&U(T,e))}function w(e,t){void 0!==e._state||(e._state=2,e._result=t,U(_,e))}function k(e,t,a,o){var r=e._subscribers,i=r.length;e._onerror=null,r[i]=t,r[i+1]=a,r[i+2]=o,0===i&&e._state&&U(T,e)}function T(e){var t=e._subscribers,a=e._state;if(0!==t.length){for(var o=void 0,r=void 0,n=e._result,l=0;l<t.length;l+=3)o=t[l],r=t[l+a],o?C(a,o,r,n):r(n);e._subscribers.length=0}}function A(){this.error=null}function S(e,t){try{return e(t)}catch(t){return ee.error=t,ee}}function C(e,t,o,r){var i=a(o),n,l,s,d;if(!i)n=r,s=!0;else if(n=S(o,r),n===ee?(d=!0,l=n.error,n=null):s=!0,t===n)return void w(t,g());void 0!==t._state||(i&&s?b(t,n):d?w(t,l):1===e?v(t,n):2===e&&w(t,n))}function L(t,a){try{a(function(e){b(t,e)},function(e){w(t,e)})}catch(a){w(t,a)}}function E(){return te++}function z(e){e[$]=te++,e._state=void 0,e._result=void 0,e._subscribers=[]}function I(e,t){this._instanceConstructor=e,this.promise=new e(p),this.promise[$]||z(this.promise),B(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=Array(this.length),0===this.length?v(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&v(this.promise,this._result))):w(this.promise,D())}function D(){return new Error("Array Methods must be provided an Array")}function P(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function O(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function R(e){this[$]=E(),this._result=this._state=void 0,this._subscribers=[],p!==e&&("function"!=typeof e&&P(),this instanceof R?L(this,e):O())}function M(){var e;if("undefined"!=typeof r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var a=null;try{a=Object.prototype.toString.call(t.resolve())}catch(t){}if("[object Promise]"===a&&!t.cast)return}e.Promise=R}var j=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var B=j,F=0,N=void 0,V=void 0,U=function(e,t){X[F]=e,X[F+1]=t,F+=2,2===F&&(V?V(l):Z())},H="undefined"==typeof window?void 0:window,G=H||{},Y=G.MutationObserver||G.WebKitMutationObserver,q="undefined"==typeof self&&"undefined"!=typeof o&&"[object process]"==={}.toString.call(o),W="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,X=Array(1e3),Z=void 0;Z=q?function(){return function(){return o.nextTick(l)}}():Y?function(){var e=0,t=new Y(l),a=document.createTextNode("");return t.observe(a,{characterData:!0}),function(){a.data=e=++e%2}}():W?function(){var e=new MessageChannel;return e.port1.onmessage=l,function(){return e.port2.postMessage(0)}}():void 0===H&&"function"==typeof e?function(){try{var t=e("vertx");return N=t.runOnLoop||t.runOnContext,i()}catch(t){return n()}}():n();var $=Math.random().toString(36).substring(16),J=void 0,K=2,Q=new A,ee=new A,te=0;return I.prototype._enumerate=function(){for(var e=this.length,t=this._input,a=0;this._state===J&&a<e;a++)this._eachEntry(t[a],a)},I.prototype._eachEntry=function(e,t){var a=this._instanceConstructor,o=a.resolve;if(o===d){var r=h(e);if(r===s&&e._state!==J)this._settledAt(e._state,t,e._result);else if("function"!=typeof r)this._remaining--,this._result[t]=e;else if(a===R){var i=new a(p);x(i,e,r),this._willSettleAt(i,t)}else this._willSettleAt(new a(function(t){return t(e)}),t)}else this._willSettleAt(o(e),t)},I.prototype._settledAt=function(e,t,a){var o=this.promise;o._state===J&&(this._remaining--,e===K?w(o,a):this._result[t]=a),0===this._remaining&&v(o,this._result)},I.prototype._willSettleAt=function(e,t){var a=this;k(e,void 0,function(e){return a._settledAt(1,t,e)},function(e){return a._settledAt(K,t,e)})},R.all=function(e){return new I(this,e).promise},R.race=function(e){var t=this;return B(e)?new t(function(a,o){for(var r=e.length,n=0;n<r;n++)t.resolve(e[n]).then(a,o)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},R.resolve=d,R.reject=function(e){var t=this,a=new t(p);return w(a,e),a},R._setScheduler=function(e){V=e},R._setAsap=function(e){U=e},R._asap=U,R.prototype={constructor:R,then:s,catch:function(e){return this.then(null,e)}},M(),R.polyfill=M,R.Promise=R,R})}).call(this,e("_process"),"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{_process:465}],204:[function(e,t){"use strict";t.exports=e("./is-implemented")()?Symbol:e("./polyfill")},{"./is-implemented":205,"./polyfill":207}],205:[function(e,t){"use strict";var a={object:!0,symbol:!0};t.exports=function(){var e;if("function"!=typeof Symbol)return!1;e=Symbol("test symbol");try{}catch(t){return!1}return!!a[typeof Symbol.iterator]&&!!a[typeof Symbol.toPrimitive]&&!!a[typeof Symbol.toStringTag]}},{}],206:[function(e,t){"use strict";t.exports=function(e){return!!e&&(!("symbol"!=typeof e)||!!e.constructor&&!("Symbol"!==e.constructor.name)&&"Symbol"===e[e.constructor.toStringTag])}},{}],207:[function(e,t){"use strict";var a=e("d"),o=e("./validate-symbol"),r=Object.create,i=Object.defineProperties,n=Object.defineProperty,l=Object.prototype,d=r(null),c,p,u,g;if("function"==typeof Symbol){c=Symbol;try{c()+"",g=!0}catch(e){}}var h=function(){var e=r(null);return function(t){for(var o=0,r,i;e[t+(o||"")];)++o;return t+=o||"",e[t]=!0,r="@@"+t,n(l,r,a.gs(null,function(e){i||(i=!0,n(this,r,a(e)),i=!1)})),r}}();u=function(e){if(this instanceof u)throw new TypeError("Symbol is not a constructor");return p(e)},t.exports=p=function e(t){var o;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return g?c(t):(o=r(u.prototype),t=void 0===t?"":t+"",i(o,{__description__:a("",t),__name__:a("",h(t))}))},i(p,{for:a(function(e){return d[e]?d[e]:d[e]=p(e+"")}),keyFor:a(function(e){for(var t in o(e),d)if(d[t]===e)return t}),hasInstance:a("",c&&c.hasInstance||p("hasInstance")),isConcatSpreadable:a("",c&&c.isConcatSpreadable||p("isConcatSpreadable")),iterator:a("",c&&c.iterator||p("iterator")),match:a("",c&&c.match||p("match")),replace:a("",c&&c.replace||p("replace")),search:a("",c&&c.search||p("search")),species:a("",c&&c.species||p("species")),split:a("",c&&c.split||p("split")),toPrimitive:a("",c&&c.toPrimitive||p("toPrimitive")),toStringTag:a("",c&&c.toStringTag||p("toStringTag")),unscopables:a("",c&&c.unscopables||p("unscopables"))}),i(u.prototype,{constructor:a(p),toString:a("",function(){return this.__name__})}),i(p.prototype,{toString:a(function(){return"Symbol ("+o(this).__description__+")"}),valueOf:a(function(){return o(this)})}),n(p.prototype,p.toPrimitive,a("",function(){var e=o(this);return"symbol"==typeof e?e:e.toString()})),n(p.prototype,p.toStringTag,a("c","Symbol")),n(u.prototype,p.toStringTag,a("c",p.prototype[p.toStringTag])),n(u.prototype,p.toPrimitive,a("c",p.prototype[p.toPrimitive]))},{"./validate-symbol":208,d:139}],208:[function(e,t){"use strict";var a=e("./is-symbol");t.exports=function(e){if(!a(e))throw new TypeError(e+" is not a symbol");return e}},{"./is-symbol":206}],209:[function(e,t){"use strict";t.exports=e("./is-implemented")()?WeakMap:e("./polyfill")},{"./is-implemented":210,"./polyfill":212}],210:[function(e,t){"use strict";t.exports=function(){var e,t;if("function"!=typeof WeakMap)return!1;try{e=new WeakMap([[t={},"one"],[{},"two"],[{},"three"]])}catch(t){return!1}return!("[object WeakMap]"!==e+"")&&!("function"!=typeof e.set)&&!(e.set({},1)!==e)&&!("function"!=typeof e.delete)&&!("function"!=typeof e.has)&&!("one"!==e.get(t))}},{}],211:[function(e,t){"use strict";t.exports=function(){return!("function"!=typeof WeakMap)&&"[object WeakMap]"===Object.prototype.toString.call(new WeakMap)}()},{}],212:[function(e,t){"use strict";var a=e("es5-ext/object/set-prototype-of"),o=e("es5-ext/object/valid-object"),r=e("es5-ext/object/valid-value"),i=e("es5-ext/string/random-uniq"),n=e("d"),l=e("es6-iterator/get"),s=e("es6-iterator/for-of"),d=e("es6-symbol").toStringTag,c=e("./is-native-implemented"),p=Array.isArray,u=Object.defineProperty,g=Object.prototype.hasOwnProperty,h=Object.getPrototypeOf,m;t.exports=m=function(){var e=arguments[0],t;if(!(this instanceof m))throw new TypeError("Constructor requires 'new'");return(t=c&&a&&WeakMap!==m?a(new WeakMap,h(this)):this,null==e||p(e)||(e=l(e)),u(t,"__weakMapData__",n("c","$weakMap$"+i())),!e)?t:(s(e,function(e){r(e),t.set(e[0],e[1])}),t)},c&&(a&&a(m,WeakMap),m.prototype=Object.create(WeakMap.prototype,{constructor:n(m)})),Object.defineProperties(m.prototype,{delete:n(function(e){return!!g.call(o(e),this.__weakMapData__)&&(delete e[this.__weakMapData__],!0)}),get:n(function(e){if(g.call(o(e),this.__weakMapData__))return e[this.__weakMapData__]}),has:n(function(e){return g.call(o(e),this.__weakMapData__)}),set:n(function(e,t){return u(o(e),this.__weakMapData__,n("c",t)),this}),toString:n(function(){return"[object WeakMap]"})}),u(m.prototype,d,n("c","WeakMap"))},{"./is-native-implemented":211,d:139,"es5-ext/object/set-prototype-of":185,"es5-ext/object/valid-object":189,"es5-ext/object/valid-value":190,"es5-ext/string/random-uniq":195,"es6-iterator/for-of":197,"es6-iterator/get":198,"es6-symbol":204}],213:[function(e,t){"use strict";t.exports=function(e,t,a){var o=t||0,r=a||1;return[[e[12]+e[0],e[13]+e[1],e[14]+e[2],e[15]+e[3]],[e[12]-e[0],e[13]-e[1],e[14]-e[2],e[15]-e[3]],[e[12]+e[4],e[13]+e[5],e[14]+e[6],e[15]+e[7]],[e[12]-e[4],e[13]-e[5],e[14]-e[6],e[15]-e[7]],[o*e[12]+e[8],o*e[13]+e[9],o*e[14]+e[10],o*e[15]+e[11]],[r*e[12]-e[8],r*e[13]-e[9],r*e[14]-e[10],r*e[15]-e[11]]]}},{}],214:[function(e,t){"use strict";var a=e("is-string-blank");t.exports=function(e){var t=typeof e;if("string"==t){var o=e;if(e=+e,0===e&&a(o))return!1}else if("number"!=t)return!1;return 1>e-e}},{"is-string-blank":406}],215:[function(e,t){"use strict";function a(e,t,a){return ie(t,va(e,a))}function o(e,t,a){this.dimension=e.length,this.bounds=[Array(this.dimension),Array(this.dimension)];for(var o=0;o<this.dimension;++o)this.bounds[0][o]=-Infinity,this.bounds[1][o]=1/0;this._state=e.slice().reverse(),this._velocity=t.slice().reverse(),this._time=[a],this._scratch=[e.slice(),e.slice(),e.slice(),e.slice(),e.slice()]}function r(e){for(var t=Array(e),a=0;a<e;++a)t[a]=0;return t}t.exports=function(e,t,a){switch(arguments.length){case 0:return new o([0],[0],0);case 1:if("number"==typeof e){var i=r(e);return new o(i,i,0)}return new o(e,r(e.length),0);case 2:if("number"==typeof t){var i=r(e.length);return new o(e,i,+t)}a=0;case 3:if(e.length!==t.length)throw new Error("state and velocity lengths must match");return new o(e,t,a);}};var n=e("cubic-hermite"),l=e("binary-search-bounds"),s=o.prototype;s.flush=function(e){var t=l.gt(this._time,e)-1;0>=t||(this._time.splice(0,t),this._state.splice(0,t*this.dimension),this._velocity.splice(0,t*this.dimension))},s.curve=function(e){var t=this._time,o=t.length,r=l.le(t,e),s=this._scratch[0],c=this._state,p=this._velocity,u=this.dimension,d=this.bounds;if(0>r)for(var g=u-1,h=0;h<u;++h,--g)s[h]=c[g];else if(r>=o-1)for(var g=c.length-1,m=e-t[o-1],h=0;h<u;++h,--g)s[h]=c[g]+m*p[g];else{for(var g=u*(r+1)-1,y=t[r],f=t[r+1],x=f-y||1,b=this._scratch[1],_=this._scratch[2],v=this._scratch[3],w=this._scratch[4],k=!0,h=0;h<u;++h,--g)b[h]=c[g],v[h]=p[g]*x,_[h]=c[g+u],w[h]=p[g+u]*x,k=k&&b[h]===_[h]&&v[h]===w[h]&&0===v[h];if(k)for(var h=0;h<u;++h)s[h]=b[h];else n(b,v,_,w,(e-y)/x,s)}for(var T=d[0],A=d[1],h=0;h<u;++h)s[h]=a(T[h],A[h],s[h]);return s},s.dcurve=function(e){var t=this._time,a=t.length,o=l.le(t,e),r=this._scratch[0],s=this._state,c=this._velocity,p=this.dimension;if(o>=a-1)for(var d=s.length-1,u=e-t[a-1],g=0;g<p;++g,--d)r[g]=c[d];else{for(var d=p*(o+1)-1,h=t[o],m=t[o+1],y=m-h||1,f=this._scratch[1],x=this._scratch[2],b=this._scratch[3],_=this._scratch[4],v=!0,g=0;g<p;++g,--d)f[g]=s[d],b[g]=c[d]*y,x[g]=s[d+p],_[g]=c[d+p]*y,v=v&&f[g]===x[g]&&b[g]===_[g]&&0===b[g];if(v)for(var g=0;g<p;++g)r[g]=0;else{n.derivative(f,b,x,_,(e-h)/y,r);for(var g=0;g<p;++g)r[g]/=y}}return r},s.lastT=function(){var e=this._time;return e[e.length-1]},s.stable=function(){for(var e=this._velocity,t=e.length,a=this.dimension-1;0<=a;--a)if(e[--t])return!1;return!0},s.jump=function(e){var t=this.lastT(),o=this.dimension;if(!(e<t||arguments.length!==o+1)){var r=this._state,n=this._velocity,l=r.length-this.dimension,s=this.bounds,d=s[0],c=s[1];this._time.push(t,e);for(var p=0;2>p;++p)for(var u=0;u<o;++u)r.push(r[l++]),n.push(0);this._time.push(e);for(var u=o;0<u;--u)r.push(a(d[u-1],c[u-1],arguments[u])),n.push(0)}},s.push=function(e){var t=this.lastT(),o=this.dimension;if(!(e<t||arguments.length!==o+1)){var r=this._state,n=this._velocity,l=r.length-this.dimension,s=e-t,d=this.bounds,c=d[0],p=d[1],u=1e-6<s?1/s:0;this._time.push(e);for(var g=o,h;0<g;--g)h=a(c[g-1],p[g-1],arguments[g]),r.push(h),n.push((h-r[l++])*u)}},s.set=function(e){var t=this.dimension;if(!(e<this.lastT()||arguments.length!==t+1)){var o=this._state,r=this._velocity,n=this.bounds,l=n[0],s=n[1];this._time.push(e);for(var d=t;0<d;--d)o.push(a(l[d-1],s[d-1],arguments[d])),r.push(0)}},s.move=function(e){var t=this.lastT(),o=this.dimension;if(!(e<=t||arguments.length!==o+1)){var r=this._state,n=this._velocity,l=r.length-this.dimension,s=this.bounds,d=s[0],c=s[1],p=e-t,u=1e-6<p?1/p:0;this._time.push(e);for(var g=o,h;0<g;--g)h=arguments[g],r.push(a(d[g-1],c[g-1],r[l++]+h)),n.push(h*u)}},s.idle=function(e){var t=this.lastT();if(!(e<t)){var o=this.dimension,r=this._state,n=this._velocity,l=r.length-o,s=this.bounds,d=s[0],c=s[1];this._time.push(e);for(var p=o-1;0<=p;--p)r.push(a(d[p],c[p],r[l]+(e-t)*n[l])),n.push(0),l+=1}}},{"binary-search-bounds":79,"cubic-hermite":133}],216:[function(e,t){var a=e("dtype");t.exports=function(e,t,o){if(!e)throw new TypeError("must specify data as first parameter");if(o=0|+(o||0),Array.isArray(e)&&e[0]&&"number"==typeof e[0][0]){var r=e[0].length,n=e.length*r,s,d,c,p;t&&"string"!=typeof t||(t=new(a(t||"float32"))(n+o));var u=t.length-o;if(n!==u)throw new Error("source length "+n+" ("+r+"x"+e.length+") does not match destination length "+u);for(s=0,c=o;s<e.length;s++)for(d=0;d<r;d++)t[c++]=null===e[s][d]?NaN:e[s][d]}else if(!t||"string"==typeof t){var g=a(t||"float32");if(Array.isArray(e)||"array"===t)for(t=new g(e.length+o),s=0,c=o,p=t.length;c<p;c++,s++)t[c]=null===e[s]?NaN:e[s];else 0===o?t=new g(e):(t=new g(e.length+o),t.set(e,o))}else t.set(e,o);return t}},{dtype:154}],217:[function(e,t){"use strict";var a=e("css-font/stringify"),o=[32,126];t.exports=function(e){e=e||{};var t=e.shape?e.shape:e.canvas?[e.canvas.width,e.canvas.height]:[512,512],r=e.canvas||document.createElement("canvas"),n=e.font,l="number"==typeof e.step?[e.step,e.step]:e.step||[32,32],s=e.chars||o;if(n&&"string"!=typeof n&&(n=a(n)),!Array.isArray(s))s=(s+"").split("");else if(2===s.length&&"number"==typeof s[0]&&"number"==typeof s[1]){for(var d=[],c=s[0],p=0;c<=s[1];c++)d[p++]=O(c);s=d}t=t.slice(),r.width=t[0],r.height=t[1];var u=r.getContext("2d");u.fillStyle="#000",u.fillRect(0,0,r.width,r.height),u.font=n,u.textAlign="center",u.textBaseline="middle",u.fillStyle="#fff";for(var g=l[0]/2,h=l[1]/2,c=0;c<s.length;c++)u.fillText(s[c],g,h),(g+=l[0])>t[0]-l[0]/2&&(g=l[0]/2,h+=l[1]);return r}},{"css-font/stringify":130}],218:[function(e,t){"use strict";function a(e,t){t||(t={}),("string"==typeof e||Array.isArray(e))&&(t.family=e);var s=Array.isArray(t.family)?t.family.join(", "):t.family;if(!s)throw Error("`family` must be defined");var d=t.size||t.fontSize||t.em||48,c=t.weight||t.fontWeight||"",p=t.style||t.fontStyle||"",e=[p,c,d].join(" ")+"px "+s,u=t.origin||"top";if(a.cache[s]&&d<=a.cache[s].em)return r(a.cache[s],u);var g=t.canvas||a.canvas,h=g.getContext("2d"),m={upper:void 0===t.upper?"H":t.upper,lower:void 0===t.lower?"x":t.lower,descent:void 0===t.descent?"p":t.descent,ascent:void 0===t.ascent?"h":t.ascent,tittle:void 0===t.tittle?"i":t.tittle,overshoot:void 0===t.overshoot?"O":t.overshoot},y=ae(1.5*d);g.height=y,g.width=.5*y,h.font=e;var l={top:0};h.clearRect(0,0,y,y),h.textBaseline="top",h.fillStyle="black",h.fillText("H",0,0);var f=i(h.getImageData(0,0,y,y));h.clearRect(0,0,y,y),h.textBaseline="bottom",h.fillText("H",0,y);var x=i(h.getImageData(0,0,y,y));l.lineHeight=l.bottom=y-x+f,h.clearRect(0,0,y,y),h.textBaseline="alphabetic",h.fillText("H",0,y);var b=i(h.getImageData(0,0,y,y)),_=y-b-1+f;l.baseline=l.alphabetic=_,h.clearRect(0,0,y,y),h.textBaseline="middle",h.fillText("H",0,.5*y);var v=i(h.getImageData(0,0,y,y));l.median=l.middle=y-v-1+f-.5*y,h.clearRect(0,0,y,y),h.textBaseline="hanging",h.fillText("H",0,.5*y);var w=i(h.getImageData(0,0,y,y));l.hanging=y-w-1+f-.5*y,h.clearRect(0,0,y,y),h.textBaseline="ideographic",h.fillText("H",0,y);var k=i(h.getImageData(0,0,y,y));if(l.ideographic=y-k-1+f,m.upper&&(h.clearRect(0,0,y,y),h.textBaseline="top",h.fillText(m.upper,0,0),l.upper=i(h.getImageData(0,0,y,y)),l.capHeight=l.baseline-l.upper),m.lower&&(h.clearRect(0,0,y,y),h.textBaseline="top",h.fillText(m.lower,0,0),l.lower=i(h.getImageData(0,0,y,y)),l.xHeight=l.baseline-l.lower),m.tittle&&(h.clearRect(0,0,y,y),h.textBaseline="top",h.fillText(m.tittle,0,0),l.tittle=i(h.getImageData(0,0,y,y))),m.ascent&&(h.clearRect(0,0,y,y),h.textBaseline="top",h.fillText(m.ascent,0,0),l.ascent=i(h.getImageData(0,0,y,y))),m.descent&&(h.clearRect(0,0,y,y),h.textBaseline="top",h.fillText(m.descent,0,0),l.descent=n(h.getImageData(0,0,y,y))),m.overshoot){h.clearRect(0,0,y,y),h.textBaseline="top",h.fillText(m.overshoot,0,0);var T=n(h.getImageData(0,0,y,y));l.overshoot=T-_}for(var A in l)l[A]/=d;return l.em=d,a.cache[s]=l,r(l,u)}function r(e,t){var a={};for(var o in"string"==typeof t&&(t=e[t]),e)"em"!=o&&(a[o]=e[o]-t);return a}function i(e){for(var t=e.height,a=e.data,o=3;o<a.length;o+=4)if(0!==a[o])return ea(.25*(o-3)/t)}function n(e){for(var t=e.height,a=e.data,o=a.length-1;0<o;o-=4)if(0!==a[o])return ea(.25*(o-3)/t)}t.exports=a,a.canvas=document.createElement("canvas"),a.cache={}},{}],219:[function(e,t){"use strict";function a(e,t,a,o,r,i){this._color=e,this.key=t,this.value=a,this.left=o,this.right=r,this._count=i}function o(e){return new a(e._color,e.key,e.value,e.left,e.right,e._count)}function r(e,t){return new a(e,t.key,t.value,t.left,t.right,t._count)}function l(e){e._count=1+(e.left?e.left._count:0)+(e.right?e.right._count:0)}function c(e,t){this._compare=e,this.root=t}function p(e,t){if(t.left){var a=p(e,t.left);if(a)return a}var a=e(t.key,t.value);return a?a:t.right?p(e,t.right):void 0}function u(e,t,a,o){var r=t(e,o.key);if(0>=r){if(o.left){var i=u(e,t,a,o.left);if(i)return i}var i=a(o.key,o.value);if(i)return i}return o.right?u(e,t,a,o.right):void 0}function g(e,t,a,o,r){var i=a(e,r.key),n=a(t,r.key),l;if(0>=i){if(r.left&&(l=g(e,t,a,o,r.left),l))return l;if(0<n&&(l=o(r.key,r.value),l))return l}return 0<n&&r.right?g(e,t,a,o,r.right):void 0}function h(e,t){this.tree=e,this._stack=t}function m(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e._color=t._color,e._count=t._count}function y(e){for(var t=e.length-1,a,d,c,u;0<=t;--t){if(a=e[t],0==t)return void(a._color=1);if(d=e[t-1],d.left===a){if(c=d.right,c.right&&0===c.right._color){if(c=d.right=o(c),u=c.right=o(c.right),d.right=c.left,c.left=d,c.right=u,c._color=d._color,a._color=1,d._color=1,u._color=1,l(d),l(c),1<t){var g=e[t-2];g.left===d?g.left=c:g.right=c}return void(e[t-1]=c)}if(c.left&&0===c.left._color){if(c=d.right=o(c),u=c.left=o(c.left),d.right=u.left,c.left=u.right,u.left=d,u.right=c,u._color=d._color,d._color=1,c._color=1,a._color=1,l(d),l(c),l(u),1<t){var g=e[t-2];g.left===d?g.left=u:g.right=u}return void(e[t-1]=u)}if(1===c._color){if(0===d._color)return d._color=1,void(d.right=r(0,c));d.right=r(0,c);continue}else{if(c=o(c),d.right=c.left,c.left=d,c._color=d._color,d._color=0,l(d),l(c),1<t){var g=e[t-2];g.left===d?g.left=c:g.right=c}e[t-1]=c,e[t]=d,t+1<e.length?e[t+1]=a:e.push(a),t+=2}}else{if(c=d.left,c.left&&0===c.left._color){if(c=d.left=o(c),u=c.left=o(c.left),d.left=c.right,c.right=d,c.left=u,c._color=d._color,a._color=1,d._color=1,u._color=1,l(d),l(c),1<t){var g=e[t-2];g.right===d?g.right=c:g.left=c}return void(e[t-1]=c)}if(c.right&&0===c.right._color){if(c=d.left=o(c),u=c.right=o(c.right),d.left=u.right,c.right=u.left,u.right=d,u.left=c,u._color=d._color,d._color=1,c._color=1,a._color=1,l(d),l(c),l(u),1<t){var g=e[t-2];g.right===d?g.right=u:g.left=u}return void(e[t-1]=u)}if(1===c._color){if(0===d._color)return d._color=1,void(d.left=r(0,c));d.left=r(0,c);continue}else{if(c=o(c),d.left=c.right,c.right=d,c._color=d._color,d._color=0,l(d),l(c),1<t){var g=e[t-2];g.right===d?g.right=c:g.left=c}e[t-1]=c,e[t]=d,t+1<e.length?e[t+1]=a:e.push(a),t+=2}}}}function f(e,t){return e<t?-1:e>t?1:0}t.exports=function(e){return new c(e||f,null)};var x=1,b=c.prototype;Object.defineProperty(b,"keys",{get:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}}),Object.defineProperty(b,"values",{get:function(){var e=[];return this.forEach(function(t,a){e.push(a)}),e}}),Object.defineProperty(b,"length",{get:function(){return this.root?this.root._count:0}}),b.insert=function(e,t){for(var o=this._compare,i=this.root,u=[],g=[],h;i;)h=o(e,i.key),u.push(i),g.push(h),i=0>=h?i.left:i.right;u.push(new a(0,e,t,null,null,1));for(var m=u.length-2,i;0<=m;--m)i=u[m],u[m]=0>=g[m]?new a(i._color,i.key,i.value,u[m+1],i.right,i._count+1):new a(i._color,i.key,i.value,i.left,u[m+1],i._count+1);for(var m=u.length-1;1<m;--m){var f=u[m-1],i=u[m];if(f._color===x||i._color===x)break;var p=u[m-2];if(p.left===f){if(f.left===i){var b=p.right;if(b&&0===b._color)f._color=x,p.right=r(x,b),p._color=0,m-=1;else{if(p._color=0,p.left=f.right,f._color=x,f.right=p,u[m-2]=f,u[m-1]=i,l(p),l(f),3<=m){var _=u[m-3];_.left===p?_.left=f:_.right=f}break}}else{var b=p.right;if(b&&0===b._color)f._color=x,p.right=r(x,b),p._color=0,m-=1;else{if(f.right=i.left,p._color=0,p.left=i.right,i._color=x,i.left=f,i.right=p,u[m-2]=i,u[m-1]=f,l(p),l(f),l(i),3<=m){var _=u[m-3];_.left===p?_.left=i:_.right=i}break}}}else if(f.right===i){var b=p.left;if(b&&0===b._color)f._color=x,p.left=r(x,b),p._color=0,m-=1;else{if(p._color=0,p.right=f.left,f._color=x,f.left=p,u[m-2]=f,u[m-1]=i,l(p),l(f),3<=m){var _=u[m-3];_.right===p?_.right=f:_.left=f}break}}else{var b=p.left;if(b&&0===b._color)f._color=x,p.left=r(x,b),p._color=0,m-=1;else{if(f.left=i.right,p._color=0,p.right=i.left,i._color=x,i.right=f,i.left=p,u[m-2]=i,u[m-1]=f,l(p),l(f),l(i),3<=m){var _=u[m-3];_.right===p?_.right=i:_.left=i}break}}}return u[0]._color=x,new c(o,u[0])},b.forEach=function(e,t,a){if(this.root)switch(arguments.length){case 1:return p(e,this.root);break;case 2:return u(t,this._compare,e,this.root);break;case 3:return 0<=this._compare(t,a)?void 0:g(t,a,this._compare,e,this.root);}},Object.defineProperty(b,"begin",{get:function(){for(var e=[],t=this.root;t;)e.push(t),t=t.left;return new h(this,e)}}),Object.defineProperty(b,"end",{get:function(){for(var e=[],t=this.root;t;)e.push(t),t=t.right;return new h(this,e)}}),b.at=function(e){if(0>e)return new h(this,[]);for(var t=this.root,a=[];;){if(a.push(t),t.left){if(e<t.left._count){t=t.left;continue}e-=t.left._count}if(!e)return new h(this,a);if(e-=1,t.right){if(e>=t.right._count)break;t=t.right}else break}return new h(this,[])},b.ge=function(e){for(var t=this._compare,a=this.root,o=[],r=0,i;a;)i=t(e,a.key),o.push(a),0>=i&&(r=o.length),a=0>=i?a.left:a.right;return o.length=r,new h(this,o)},b.gt=function(e){for(var t=this._compare,a=this.root,o=[],r=0,i;a;)i=t(e,a.key),o.push(a),0>i&&(r=o.length),a=0>i?a.left:a.right;return o.length=r,new h(this,o)},b.lt=function(e){for(var t=this._compare,a=this.root,o=[],r=0,i;a;)i=t(e,a.key),o.push(a),0<i&&(r=o.length),a=0>=i?a.left:a.right;return o.length=r,new h(this,o)},b.le=function(e){for(var t=this._compare,a=this.root,o=[],r=0,i;a;)i=t(e,a.key),o.push(a),0<=i&&(r=o.length),a=0>i?a.left:a.right;return o.length=r,new h(this,o)},b.find=function(e){for(var t=this._compare,a=this.root,o=[],r;a;){if(r=t(e,a.key),o.push(a),0===r)return new h(this,o);a=0>=r?a.left:a.right}return new h(this,[])},b.remove=function(e){var t=this.find(e);return t?t.remove():this},b.get=function(e){for(var t=this._compare,a=this.root;a;){var o=t(e,a.key);if(0===o)return a.value;a=0>=o?a.left:a.right}};var _=h.prototype;Object.defineProperty(_,"valid",{get:function(){return 0<this._stack.length}}),Object.defineProperty(_,"node",{get:function(){return 0<this._stack.length?this._stack[this._stack.length-1]:null},enumerable:!0}),_.clone=function(){return new h(this.tree,this._stack.slice())},_.remove=function(){var e=this._stack;if(0===e.length)return this.tree;var t=Array(e.length),o=e[e.length-1];t[t.length-1]=new a(o._color,o.key,o.value,o.left,o.right,o._count);for(var r=e.length-2,o;0<=r;--r)o=e[r],t[r]=o.left===e[r+1]?new a(o._color,o.key,o.value,t[r+1],o.right,o._count):new a(o._color,o.key,o.value,o.left,t[r+1],o._count);if(o=t[t.length-1],o.left&&o.right){var l=t.length;for(o=o.left;o.right;)t.push(o),o=o.right;var s=t[l-1];t.push(new a(o._color,s.key,s.value,o.left,o.right,o._count)),t[l-1].key=o.key,t[l-1].value=o.value;for(var r=t.length-2;r>=l;--r)o=t[r],t[r]=new a(o._color,o.key,o.value,o.left,t[r+1],o._count);t[l-1].left=t[l]}if(o=t[t.length-1],0===o._color){var d=t[t.length-2];d.left===o?d.left=null:d.right===o&&(d.right=null),t.pop();for(var r=0;r<t.length;++r)t[r]._count--;return new c(this.tree._compare,t[0])}if(o.left||o.right){o.left?m(o,o.left):o.right&&m(o,o.right),o._color=x;for(var r=0;r<t.length-1;++r)t[r]._count--;return new c(this.tree._compare,t[0])}if(1===t.length)return new c(this.tree._compare,null);for(var r=0;r<t.length;++r)t[r]._count--;var p=t[t.length-2];return y(t),p.left===o?p.left=null:p.right=null,new c(this.tree._compare,t[0])},Object.defineProperty(_,"key",{get:function(){return 0<this._stack.length?this._stack[this._stack.length-1].key:void 0},enumerable:!0}),Object.defineProperty(_,"value",{get:function(){return 0<this._stack.length?this._stack[this._stack.length-1].value:void 0},enumerable:!0}),Object.defineProperty(_,"index",{get:function(){var e=0,t=this._stack;if(0===t.length){var a=this.tree.root;return a?a._count:0}t[t.length-1].left&&(e=t[t.length-1].left._count);for(var o=t.length-2;0<=o;--o)t[o+1]===t[o].right&&(++e,t[o].left&&(e+=t[o].left._count));return e},enumerable:!0}),_.next=function(){var e=this._stack;if(0!==e.length){var t=e[e.length-1];if(t.right)for(t=t.right;t;)e.push(t),t=t.left;else for(e.pop();0<e.length&&e[e.length-1].right===t;)t=e[e.length-1],e.pop()}},Object.defineProperty(_,"hasNext",{get:function(){var e=this._stack;if(0===e.length)return!1;if(e[e.length-1].right)return!0;for(var t=e.length-1;0<t;--t)if(e[t-1].left===e[t])return!0;return!1}}),_.update=function(e){var t=this._stack;if(0===t.length)throw new Error("Can't update empty node!");var o=Array(t.length),r=t[t.length-1];o[o.length-1]=new a(r._color,r.key,e,r.left,r.right,r._count);for(var l=t.length-2;0<=l;--l)r=t[l],o[l]=r.left===t[l+1]?new a(r._color,r.key,r.value,o[l+1],r.right,r._count):new a(r._color,r.key,r.value,r.left,o[l+1],r._count);return new c(this.tree._compare,o[0])},_.prev=function(){var e=this._stack;if(0!==e.length){var t=e[e.length-1];if(t.left)for(t=t.left;t;)e.push(t),t=t.right;else for(e.pop();0<e.length&&e[e.length-1].left===t;)t=e[e.length-1],e.pop()}},Object.defineProperty(_,"hasPrev",{get:function(){var e=this._stack;if(0===e.length)return!1;if(e[e.length-1].left)return!0;for(var t=e.length-1;0<t;--t)if(e[t-1].right===e[t])return!0;return!1}})},{}],220:[function(e,t){function a(e){if(0>e)return+"0/0";for(var a=n[0],o=n.length-1;0<o;--o)a+=n[o]/(e+o);var l=e+r+.5;return .5*P(2*Sa)+(e+.5)*P(l)-l+P(a)-P(e)}var o=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7],r=607/128,n=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];t.exports=function e(r){if(.5>r)return Sa/(M(Sa*r)*e(1-r));if(100<r)return ka(a(r));r-=1;for(var n=o[0],l=1;9>l;l++)n+=o[l]/(r+l);var s=r+7+.5;return re(2*Sa)*_a(s,r+.5)*ka(-s)*n},t.exports.log=a},{}],221:[function(e,t){t.exports=function(e,t){if("string"!=typeof e)throw new TypeError("must specify type string");if(t=t||{},"undefined"==typeof document&&!t.canvas)return null;var a=t.canvas||document.createElement("canvas");"number"==typeof t.width&&(a.width=t.width),"number"==typeof t.height&&(a.height=t.height);var o=t,r;try{var n=[e];0===e.indexOf("webgl")&&n.push("experimental-"+e);for(var l=0;l<n.length;l++)if(r=a.getContext(n[l],o),r)return r}catch(t){r=null}return r||null}},{}],222:[function(e,t){"use strict";function a(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function o(e){this.gl=e,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this._tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=d(e)}function r(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}function n(t,o,r,i,n){for(var l=t.primalOffset,s=t.primalMinor,p=t.mirrorOffset,u=t.mirrorMinor,g=i[o],e=0;3>e;++e)if(o!==e){var h=l,m=p,y=s,f=u;g&1<<e&&(h=p,m=l,y=u,f=s),h[e]=r[0][e],m[e]=r[1][e],0<n[e]?(y[e]=-1,f[e]=0):(y[e]=0,f[e]=1)}}t.exports=function(e,t){var a=new o(e);return a.update(t),a};var l=e("./lib/text.js"),s=e("./lib/lines.js"),d=e("./lib/background.js"),c=e("./lib/cube.js"),p=e("./lib/ticks.js"),u=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),g=o.prototype;g.update=function(e){function t(t,a,o){if(o in e){var r=e[o],n=this[o],l;this[o]=(t?Array.isArray(r)&&Array.isArray(r[0]):Array.isArray(r))?l=[a(r[0]),a(r[1]),a(r[2])]:l=[a(r),a(r),a(r)];for(var s=0;3>s;++s)if(l[s]!==n[s])return!0}return!1}e=e||{};var a=t.bind(this,!1,Number),o=t.bind(this,!1,Boolean),r=t.bind(this,!1,String),n=t.bind(this,!0,function(e){if(Array.isArray(e)){if(3===e.length)return[+e[0],+e[1],+e[2],1];if(4===e.length)return[+e[0],+e[1],+e[2],+e[3]]}return[0,0,0,1]}),d=!1,c=!1,u;if("bounds"in e){var g=e.bounds;i_loop:for(var h=0;2>h;++h)for(var m=0;3>m;++m)g[h][m]!==this.bounds[h][m]&&(c=!0),this.bounds[h][m]=g[h][m]}if("ticks"in e){u=e.ticks,d=!0,this.autoTicks=!1;for(var h=0;3>h;++h)this.tickSpacing[h]=0}else a("tickSpacing")&&(this.autoTicks=!0,c=!0);if(this._firstInit&&(!("ticks"in e||"tickSpacing"in e)&&(this.autoTicks=!0),c=!0,d=!0,this._firstInit=!1),c&&this.autoTicks&&(u=p.create(this.bounds,this.tickSpacing),d=!0),d){for(var h=0;3>h;++h)u[h].sort(function(e,t){return e.x-t.x});p.equal(u,this.ticks)?d=!1:this.ticks=u}o("tickEnable"),r("tickFont")&&(d=!0),a("tickSize"),a("tickAngle"),a("tickPad"),n("tickColor");var y=r("labels");r("labelFont")&&(y=!0),o("labelEnable"),a("labelSize"),a("labelPad"),n("labelColor"),o("lineEnable"),o("lineMirror"),a("lineWidth"),n("lineColor"),o("lineTickEnable"),o("lineTickMirror"),a("lineTickLength"),a("lineTickWidth"),n("lineTickColor"),o("gridEnable"),a("gridWidth"),n("gridColor"),o("zeroEnable"),n("zeroLineColor"),a("zeroLineWidth"),o("backgroundEnable"),n("backgroundColor"),this._text?this._text&&(y||d)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=l(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&d&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=s(this.gl,this.bounds,this.ticks))};var h=[new r,new r,new r],m=[0,0,0],y={model:u,view:u,projection:u};g.isOpaque=function(){return!0},g.isTransparent=function(){return!1},g.drawTransparent=function(){};var f=[0,0,0],x=[0,0,0],b=[0,0,0];g.draw=function(e){function t(e){H=[0,0,0],H[e]=1}function o(e,a,o){var r=(e+1)%3,i=(e+2)%3,n=a[r],l=a[i],s=o[r],d=o[i];return 0<n&&0<d?void t(r):0<n&&0>d?void t(r):0>n&&0<d?void t(r):0>n&&0>d?void t(r):0<l&&0<s?void t(i):0<l&&0>s?void t(i):0>l&&0<s?void t(i):0>l&&0>s?void t(i):void 0}e=e||y;for(var r=this.gl,l=e.model||u,s=e.view||u,d=e.projection||u,p=this.bounds,g=c(l,s,d,p),_=g.cubeEdges,w=g.axis,k=s[12],T=s[13],A=s[14],S=s[15],C=this.pixelRatio*(d[3]*k+d[7]*T+d[11]*A+d[15]*S)/r.drawingBufferHeight,L=0;3>L;++L)this.lastCubeProps.cubeEdges[L]=_[L],this.lastCubeProps.axis[L]=w[L];for(var E=h,L=0;3>L;++L)n(h[L],L,this.bounds,_,w);for(var r=this.gl,z=m,L=0;3>L;++L)z[L]=this.backgroundEnable[L]?w[L]:0;this._background.draw(l,s,d,p,z,this.backgroundColor),this._lines.bind(l,s,d,this);for(var L=0,I;3>L;++L){I=[0,0,0],I[L]=0<w[L]?p[1][L]:p[0][L];for(var D=0;2>D;++D){var P=(L+1+D)%3,O=(L+1+(1^D))%3;this.gridEnable[P]&&this._lines.drawGrid(P,O,this.bounds,I,this.gridColor[P],this.gridWidth[P]*this.pixelRatio)}for(var D=0;2>D;++D){var P=(L+1+D)%3,O=(L+1+(1^D))%3;this.zeroEnable[O]&&0>=ie(p[0][O],p[1][O])&&0<=va(p[0][O],p[1][O])&&this._lines.drawZero(P,O,this.bounds,I,this.zeroLineColor[O],this.zeroLineWidth[O]*this.pixelRatio)}}for(var L=0;3>L;++L){this.lineEnable[L]&&this._lines.drawAxisLine(L,this.bounds,E[L].primalOffset,this.lineColor[L],this.lineWidth[L]*this.pixelRatio),this.lineMirror[L]&&this._lines.drawAxisLine(L,this.bounds,E[L].mirrorOffset,this.lineColor[L],this.lineWidth[L]*this.pixelRatio);for(var R=a(f,E[L].primalMinor),M=a(x,E[L].mirrorMinor),B=this.lineTickLength,D=0,F;3>D;++D)F=C/l[5*D],R[D]*=B[D]*F,M[D]*=B[D]*F;this.lineTickEnable[L]&&this._lines.drawAxisTicks(L,E[L].primalOffset,R,this.lineTickColor[L],this.lineTickWidth[L]*this.pixelRatio),this.lineTickMirror[L]&&this._lines.drawAxisTicks(L,E[L].mirrorOffset,M,this.lineTickColor[L],this.lineTickWidth[L]*this.pixelRatio)}this._lines.unbind(),this._text.bind(l,s,d,this.pixelRatio);for(var N=.5,L=0,V,U,H;3>L;++L){for(var G=E[L].primalMinor,Y=E[L].mirrorMinor,q=a(b,E[L].primalOffset),D=0;3>D;++D)this.lineTickEnable[L]&&(q[D]+=C*G[D]*va(this.lineTickLength[D],0)/l[5*D]);var W=[0,0,0];if(W[L]=1,this.tickEnable[L]){-3600===this.tickAngle[L]?(this.tickAngle[L]=0,this._tickAlign[L]="auto"):this._tickAlign[L]=-1,U=1,V=[this._tickAlign[L],N,U],V[0]="auto"===V[0]?0:parseInt(""+V[0]),H=[0,0,0],o(L,G,Y);for(var D=0;3>D;++D)q[D]+=C*G[D]*this.tickPad[D]/l[5*D];this._text.drawTicks(L,this.tickSize[L],this.tickAngle[L],q,this.tickColor[L],W,H,V)}if(this.labelEnable[L]){U=0,H=[0,0,0],4<this.labels[L].length&&(t(L),U=1),V=[this.labelAlign[L],N,U],V[0]="auto"===V[0]?0:parseInt(""+V[0]);for(var D=0;3>D;++D)q[D]+=C*G[D]*this.labelPad[D]/l[5*D];q[L]+=.5*(p[0][L]+p[1][L]),this._text.drawLabel(L,this.labelSize[L],this.labelAngle[L],q,this.labelColor[L],[0,0,0],H,V)}}this._text.unbind()},g.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":223,"./lib/cube.js":224,"./lib/lines.js":225,"./lib/text.js":227,"./lib/ticks.js":228}],223:[function(e,t){"use strict";function a(e,t,a,o){this.gl=e,this.buffer=t,this.vao=a,this.shader=o}t.exports=function(e){for(var t=[],l=[],p=0,g=0;3>g;++g)for(var h=(g+1)%3,m=(g+2)%3,y=[0,0,0],f=[0,0,0],c=-1;1>=c;c+=2){l.push(p,p+2,p+1,p+1,p+2,p+3),y[g]=c,f[g]=c;for(var x=-1;1>=x;x+=2){y[h]=x;for(var b=-1;1>=b;b+=2)y[m]=b,t.push(y[0],y[1],y[2],f[0],f[1],f[2]),p+=1}var _=h;h=m,m=_}var w=o(e,new Float32Array(t)),k=o(e,new Uint16Array(l),e.ELEMENT_ARRAY_BUFFER),T=r(e,[{buffer:w,type:e.FLOAT,size:3,offset:0,stride:24},{buffer:w,type:e.FLOAT,size:3,offset:12,stride:24}],k),A=n(e);return A.attributes.position.location=0,A.attributes.normal.location=1,new a(e,w,T,A)};var o=e("gl-buffer"),r=e("gl-vao"),n=e("./shaders").bg,l=a.prototype;l.draw=function(e,t,a,o,r,n){for(var l=!1,s=0;3>s;++s)l=l||r[s];if(l){var d=this.gl;d.enable(d.POLYGON_OFFSET_FILL),d.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:e,view:t,projection:a,bounds:o,enable:r,colors:n},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),d.disable(d.POLYGON_OFFSET_FILL)}},l.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":226,"gl-buffer":230,"gl-vao":310}],224:[function(e,t){"use strict";function a(e,t,a){for(var o=0;4>o;++o){e[o]=a[12+o];for(var r=0;3>r;++r)e[o]+=t[r]*a[4*r+o]}}function r(e){for(var t=0;t<l.length;++t)if(e=u.positive(e,l[t]),3>e.length)return 0;for(var a=e[0],o=a[0]/a[3],r=a[1]/a[3],n=0,t=1;t+1<e.length;++t){var s=e[t],d=e[t+1],c=s[0]/s[3],g=s[1]/s[3],h=d[0]/d[3],m=d[1]/d[3];n+=wa((c-o)*(m-r)-(g-r)*(h-o))}return n}t.exports=function(e,t,_,T){c(h,t,e),c(h,_,h);for(var A=0,S=0;2>S;++S){f[2]=T[S][2];for(var C=0;2>C;++C){f[1]=T[C][1];for(var L=0;2>L;++L)f[0]=T[L][0],a(m[A],f,h),A+=1}}for(var E=-1,S=0,z;8>S;++S){z=m[S][3];for(var I=0;3>I;++I)y[S][I]=m[S][I]/z;0>z&&(0>E?E=S:y[S][2]<y[E][2]&&(E=S))}if(0>E){E=0;for(var D=0;3>D;++D){for(var P=(D+2)%3,u=(D+1)%3,O=-1,R=-1,M=0;2>M;++M){var B=M<<D,F=B+(M<<P)+(1-M<<u),N=B+(1-M<<P)+(M<<u);0>g(y[B],y[F],y[N],o)||(M?O=1:R=1)}if(0>O||0>R){R>O&&(E|=1<<D);continue}for(var M=0;2>M;++M){var B=M<<D,F=B+(M<<P)+(1-M<<u),N=B+(1-M<<P)+(M<<u),V=r([m[B],m[F],m[N],m[B+(1<<P)+(1<<u)]]);M?O=V:R=V}if(R>O){E|=1<<D;continue}}}for(var U=7^E,H=-1,S=0;8>S;++S)S!==E&&S!==U&&(0>H?H=S:y[H][1]>y[S][1]&&(H=S));for(var G=-1,S=0,Y;3>S;++S)if(Y=H^1<<S,Y!==E&&Y!==U){0>G&&(G=Y);var u=y[Y];u[0]<y[G][0]&&(G=Y)}for(var q=-1,S=0,Y;3>S;++S)if(Y=H^1<<S,Y!==E&&Y!==U&&Y!==G){0>q&&(q=Y);var u=y[Y];u[0]>y[q][0]&&(q=Y)}var W=p;W[0]=W[1]=W[2]=0,W[n.log2(G^H)]=H&G,W[n.log2(H^q)]=H&q;var X=7^q;X===E||X===U?(X=7^G,W[n.log2(q^X)]=X&q):W[n.log2(G^X)]=X&G;for(var Z=E,D=0;3>D;++D)x[D]=Z&1<<D?-1:1;return b};var n=e("bit-twiddle"),c=e("gl-mat4/multiply"),u=e("split-polygon"),g=e("robust-orientation"),h=Array(16),m=Array(8),y=Array(8),f=[,,,],o=[0,0,0];(function(){for(var e=0;8>e;++e)m[e]=[1,1,1,1],y[e]=[1,1,1]})();var l=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]],p=[1,1,1],x=[0,0,0],b={cubeEdges:p,axis:x}},{"bit-twiddle":80,"gl-mat4/multiply":256,"robust-orientation":486,"split-polygon":503}],225:[function(e,t){"use strict";function a(e){return e[0]=e[1]=e[2]=0,e}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function r(e,t,a,o,r,i,n,l){this.gl=e,this.vertBuffer=t,this.vao=a,this.shader=o,this.tickCount=r,this.tickOffset=i,this.gridCount=n,this.gridOffset=l}t.exports=function(e,t,a){var o=[],d=[0,0,0],c=[0,0,0],p=[0,0,0],u=[0,0,0];o.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var g=0,h;3>g;++g){h=0|o.length/3;for(var m=0,y;m<a[g].length;++m)y=+a[g][m].x,o.push(y,0,1,y,1,1,y,0,-1,y,0,-1,y,1,1,y,1,-1);var f=0|o.length/3;d[g]=h,c[g]=f-h;for(var h=0|o.length/3,b=0,y;b<a[g].length;++b)y=+a[g][b].x,o.push(y,0,1,y,1,1,y,0,-1,y,0,-1,y,1,1,y,1,-1);var f=0|o.length/3;p[g]=h,u[g]=f-h}var _=n(e,new Float32Array(o)),v=l(e,[{buffer:_,type:e.FLOAT,size:3,stride:0,offset:0}]),w=s(e);return w.attributes.position.location=0,new r(e,_,v,w,c,d,u,p)};var n=e("gl-buffer"),l=e("gl-vao"),s=e("./shaders").line,d=[0,0,0],c=[0,0,0],p=[0,0,0],u=[0,0,0],g=[1,1],h=r.prototype;h.bind=function(e,t,a){this.shader.bind(),this.shader.uniforms.model=e,this.shader.uniforms.view=t,this.shader.uniforms.projection=a,g[0]=this.gl.drawingBufferWidth,g[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=g,this.vao.bind()},h.unbind=function(){this.vao.unbind()},h.drawAxisLine=function(e,t,r,i,n){var l=a(c);this.shader.uniforms.majorAxis=c,l[e]=t[1][e]-t[0][e],this.shader.uniforms.minorAxis=l;var s=o(u,r);s[e]+=t[0][e],this.shader.uniforms.offset=s,this.shader.uniforms.lineWidth=n,this.shader.uniforms.color=i;var d=a(p);d[(e+2)%3]=1,this.shader.uniforms.screenAxis=d,this.vao.draw(this.gl.TRIANGLES,6);var d=a(p);d[(e+1)%3]=1,this.shader.uniforms.screenAxis=d,this.vao.draw(this.gl.TRIANGLES,6)},h.drawAxisTicks=function(e,t,o,r,i){if(this.tickCount[e]){var n=a(d);n[e]=1,this.shader.uniforms.majorAxis=n,this.shader.uniforms.offset=t,this.shader.uniforms.minorAxis=o,this.shader.uniforms.color=r,this.shader.uniforms.lineWidth=i;var l=a(p);l[e]=1,this.shader.uniforms.screenAxis=l,this.vao.draw(this.gl.TRIANGLES,this.tickCount[e],this.tickOffset[e])}},h.drawGrid=function(e,t,r,i,n,l){if(this.gridCount[e]){var s=a(c);s[t]=r[1][t]-r[0][t],this.shader.uniforms.minorAxis=s;var g=o(u,i);g[t]+=r[0][t],this.shader.uniforms.offset=g;var h=a(d);h[e]=1,this.shader.uniforms.majorAxis=h;var m=a(p);m[e]=1,this.shader.uniforms.screenAxis=m,this.shader.uniforms.lineWidth=l,this.shader.uniforms.color=n,this.vao.draw(this.gl.TRIANGLES,this.gridCount[e],this.gridOffset[e])}},h.drawZero=function(e,t,r,i,n,l){var s=a(c);this.shader.uniforms.majorAxis=s,s[e]=r[1][e]-r[0][e],this.shader.uniforms.minorAxis=s;var d=o(u,i);d[e]+=r[0][e],this.shader.uniforms.offset=d;var g=a(p);g[t]=1,this.shader.uniforms.screenAxis=g,this.shader.uniforms.lineWidth=l,this.shader.uniforms.color=n,this.vao.draw(this.gl.TRIANGLES,6)},h.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":226,"gl-buffer":230,"gl-vao":310}],226:[function(e,t,a){"use strict";var o=e("glslify"),r=e("gl-shader"),i=o(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n"]),n=o(["precision mediump float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);a.line=function(e){return r(e,i,n,null,[{name:"position",type:"vec3"}])};var l=o(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis, alignDir, alignOpt;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nfloat computeViewAngle(vec3 a, vec3 b) {\n  vec3 A = project(a);\n  vec3 B = project(b);\n\n  return atan(\n    (B.y - A.y) * resolution.y,\n    (B.x - A.x) * resolution.x\n  );\n}\n\nconst float PI = 3.141592;\nconst float TWO_PI = 2.0 * PI;\nconst float HALF_PI = 0.5 * PI;\nconst float ONE_AND_HALF_PI = 1.5 * PI;\n\nint option = int(floor(alignOpt.x + 0.001));\nfloat hv_ratio =       alignOpt.y;\nbool enableAlign =    (alignOpt.z != 0.0);\n\nfloat mod_angle(float a) {\n  return mod(a, PI);\n}\n\nfloat positive_angle(float a) {\n  return mod_angle((a < 0.0) ?\n    a + TWO_PI :\n    a\n  );\n}\n\nfloat look_upwards(float a) {\n  float b = positive_angle(a);\n  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?\n    b - PI :\n    b;\n}\n\nfloat look_horizontal_or_vertical(float a, float ratio) {\n  // ratio controls the ratio between being horizontal to (vertical + horizontal)\n  // if ratio is set to 0.5 then it is 50%, 50%.\n  // when using a higher ratio e.g. 0.75 the result would\n  // likely be more horizontal than vertical.\n\n  float b = positive_angle(a);\n\n  return\n    (b < (      ratio) * HALF_PI) ? 0.0 :\n    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :\n    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :\n    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :\n                                    0.0;\n}\n\nfloat roundTo(float a, float b) {\n  return float(b * floor((a + 0.5 * b) / b));\n}\n\nfloat look_round_n_directions(float a, int n) {\n  float b = positive_angle(a);\n  float div = TWO_PI / float(n);\n  float c = roundTo(b, div);\n  return look_upwards(c);\n}\n\nfloat applyAlignOption(float rawAngle, float delta) {\n  return\n    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions\n    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical\n    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis\n    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards\n    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal\n                    rawAngle;                // otherwise return back raw input angle\n}\n\nbool isAxisTitle = (axis.x == 0.0) &&\n                   (axis.y == 0.0) &&\n                   (axis.z == 0.0);\n\nvoid main() {\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n\n  float beta = angle; // i.e. user defined attributes for each tick\n\n  float axisAngle;\n  float clipAngle;\n  float flip;\n\n  if (enableAlign) {\n    axisAngle = (isAxisTitle) ? HALF_PI :\n                      computeViewAngle(dataPosition, dataPosition + axis);\n    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);\n\n    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;\n    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;\n\n    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),\n                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;\n\n    beta += applyAlignOption(clipAngle, flip * PI);\n  }\n\n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n\n  mat2 planeXform = scale * mat2(\n     cos(beta), sin(beta),\n    -sin(beta), cos(beta)\n  );\n\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute clip position\n  vec3 clipPosition = project(dataPosition);\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec3(viewOffset, 0.0);\n\n  //Done\n  gl_Position = vec4(clipPosition, 1.0);\n}"]),s=o(["precision mediump float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);a.text=function(e){return r(e,l,s,null,[{name:"position",type:"vec3"}])};var d=o(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n\n  vec3 signAxis = sign(bounds[1] - bounds[0]);\n\n  vec3 realNormal = signAxis * normal;\n\n  if(dot(realNormal, enable) > 0.0) {\n    vec3 minRange = min(bounds[0], bounds[1]);\n    vec3 maxRange = max(bounds[0], bounds[1]);\n    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n\n  colorChannel = abs(realNormal);\n}"]),c=o(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] +\n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}"]);a.bg=function(e){return r(e,d,c,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":288,glslify:392}],227:[function(e,t){(function(a){"use strict";function o(e,t,a,o){this.gl=e,this.shader=t,this.buffer=a,this.vao=o,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}function r(t,a){try{return l(t,a)}catch(a){return console.warn("error vectorizing text:\""+t+"\" error:",a),{cells:[],positions:[]}}}t.exports=function(e,t,a,r,l,d){var c=i(e),p=n(e,[{buffer:c,size:3}]),u=s(e);u.attributes.position.location=0;var g=new o(e,u,c,p);return g.update(t,a,r,l,d),g};var i=e("gl-buffer"),n=e("gl-vao"),l=e("vectorize-text"),s=e("./shaders").text,d=window||a.global||{},u=d.__TEXT_CACHE||{};d.__TEXT_CACHE={};var g=o.prototype,h=[0,0];g.bind=function(e,t,a,o){this.vao.bind(),this.shader.bind();var r=this.shader.uniforms;r.model=e,r.view=t,r.projection=a,r.pixelScale=o,h[0]=this.gl.drawingBufferWidth,h[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=h},g.unbind=function(){this.vao.unbind()},g.update=function(e,t,a,o,n){function l(e,t,a,o,n,l){var d=u[a];d||(d=u[a]={});var g=d[t];g||(g=d[t]=r(t,{triangles:!0,font:a,textAlign:"center",textBaseline:"middle",lineSpacing:n,styletags:l}));for(var h=(o||12)/12,m=g.positions,y=g.cells,f=0,x=y.length,b;f<x;++f){b=y[f];for(var _=2,v;0<=_;--_)v=m[b[_]],s.push(h*v[0],-h*v[1],e)}}for(var s=[],c=[0,0,0],p=[0,0,0],g=[0,0,0],h=[0,0,0],m=1.25,y={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},f=0;3>f;++f){g[f]=0|s.length/3,l(.5*(e[0][f]+e[1][f]),t[f],a[f],12,m,y),h[f]=(0|s.length/3)-g[f],c[f]=0|s.length/3;for(var x=0;x<o[f].length;++x)o[f][x].text&&l(o[f][x].x,o[f][x].text,o[f][x].font||n,o[f][x].fontSize||12,m,y);p[f]=(0|s.length/3)-c[f]}this.buffer.update(s),this.tickOffset=c,this.tickCount=p,this.labelOffset=g,this.labelCount=h},g.drawTicks=function(e,t,a,o,r,i,n,l){this.tickCount[e]&&(this.shader.uniforms.axis=i,this.shader.uniforms.color=r,this.shader.uniforms.angle=a,this.shader.uniforms.scale=t,this.shader.uniforms.offset=o,this.shader.uniforms.alignDir=n,this.shader.uniforms.alignOpt=l,this.vao.draw(this.gl.TRIANGLES,this.tickCount[e],this.tickOffset[e]))},g.drawLabel=function(e,t,a,o,r,i,n,l){this.labelCount[e]&&(this.shader.uniforms.axis=i,this.shader.uniforms.color=r,this.shader.uniforms.angle=a,this.shader.uniforms.scale=t,this.shader.uniforms.offset=o,this.shader.uniforms.alignDir=n,this.shader.uniforms.alignOpt=l,this.vao.draw(this.gl.TRIANGLES,this.labelCount[e],this.labelOffset[e]))},g.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this,e("_process"))},{"./shaders":226,_process:465,"gl-buffer":230,"gl-vao":310,"vectorize-text":526}],228:[function(e,t,a){"use strict";function o(e,t){var a=e+"",o=a.indexOf("."),r=0;0<=o&&(r=a.length-o-1);var i=_a(10,r),n=R(e*t*i),l=n+"";if(0<=l.indexOf("e"))return l;var s=n/i,d=n%i;0>n?(s=0|-ae(s),d=0|-d):(s=0|ea(s),d|=0);var c=""+s;if(0>n&&(c="-"+c),r){for(var p=""+d;p.length<r;)p="0"+p;return c+"."+p}return c}a.create=function(e,a){for(var r=[],i=0;3>i;++i){for(var n=[],l=.5*(e[0][i]+e[1][i]),s=0;s*a[i]<=e[1][i];++s)n.push({x:s*a[i],text:o(a[i],s)});for(var s=-1;s*a[i]>=e[0][i];--s)n.push({x:s*a[i],text:o(a[i],s)});r.push(n)}return r},a.equal=function(e,t){for(var o=0;3>o;++o){if(e[o].length!==t[o].length)return!1;for(var r=0;r<e[o].length;++r){var n=e[o][r],a=t[o][r];if(n.x!==a.x||n.text!==a.text||n.font!==a.font||n.fontColor!==a.fontColor||n.fontSize!==a.fontSize||n.dx!==a.dx||n.dy!==a.dy)return!1}}return!0}},{}],229:[function(e,t){"use strict";function a(e,t,a){this.lo=e,this.hi=t,this.pixelsPerDataUnit=a}function o(e,t,a,o,r){for(var n=0;3>n;++n){for(var l=u,s=g,c=0;3>c;++c)s[c]=l[c]=a[c];s[3]=l[3]=1,s[n]+=1,d(s,s,t),0>s[3]&&(e[n]=1/0),l[n]-=1,d(l,l,t),0>l[3]&&(e[n]=1/0);var p=(l[0]/l[3]-s[0]/s[3])*o,h=(l[1]/l[3]-s[1]/s[3])*r;e[n]=.25*re(p*p+h*h)}return e}t.exports=function(e,t,a,g,y){var f=t.model||c,b=t.view||c,_=t.projection||c,w=e.bounds,y=y||n(f,b,_,w),T=y.axis,A=y.edges;l(p,b,f),l(p,_,p);for(var S=h,C=0;3>C;++C)S[C].lo=1/0,S[C].hi=-Infinity,S[C].pixelsPerDataUnit=1/0;var L=r(s(p,p));s(p,p);for(var E=0;3>E;++E){var z=(E+1)%3,u=(E+2)%3,I=m;i_loop:for(var C=0,x;2>C;++C)if(x=[],0>T[E]!=!!C){I[E]=w[C][E];for(var D=0;2>D;++D){I[z]=w[D^C][z];for(var P=0;2>P;++P)I[u]=w[P^D^C][u],x.push(I.slice())}for(var D=4;4==D;++D){if(0===x.length)continue i_loop;x=i.positive(x,L[D])}for(var D=0;D<x.length;++D)for(var u=x[D],O=o(m,p,u,a,g),P=0;3>P;++P)S[P].lo=ie(S[P].lo,u[P]),S[P].hi=va(S[P].hi,u[P]),P!=E&&(S[P].pixelsPerDataUnit=ie(S[P].pixelsPerDataUnit,wa(O[P])))}}return S};var r=e("extract-frustum-planes"),i=e("split-polygon"),n=e("./lib/cube.js"),l=e("gl-mat4/multiply"),s=e("gl-mat4/transpose"),d=e("gl-vec4/transformMat4"),c=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),p=new Float32Array(16),u=[0,0,0,1],g=[0,0,0,1],h=[new a(1/0,-Infinity,1/0),new a(1/0,-Infinity,1/0),new a(1/0,-Infinity,1/0)],m=[0,0,0]},{"./lib/cube.js":224,"extract-frustum-planes":213,"gl-mat4/multiply":256,"gl-mat4/transpose":264,"gl-vec4/transformMat4":381,"split-polygon":503}],230:[function(e,t){"use strict";function a(e,t,a,o,r){this.gl=e,this.type=t,this.handle=a,this.length=o,this.usage=r}function o(e,t,a,o,r,i){var n=r.length*r.BYTES_PER_ELEMENT;if(0>i)return e.bufferData(t,r,o),n;if(n+i>a)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return e.bufferSubData(t,i,r),a}function r(e,t){for(var a=l.malloc(e.length,t),o=e.length,r=0;r<o;++r)a[r]=e[r];return a}function i(e,t){for(var a=1,o=t.length-1;0<=o;--o){if(t[o]!==a)return!1;a*=e[o]}return!0}var l=e("typedarray-pool"),s=e("ndarray-ops"),d=e("ndarray"),c=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"],p=a.prototype;p.bind=function(){this.gl.bindBuffer(this.type,this.handle)},p.unbind=function(){this.gl.bindBuffer(this.type,null)},p.dispose=function(){this.gl.deleteBuffer(this.handle)},p.update=function(e,a){if("number"!=typeof a&&(a=-1),this.bind(),"object"==typeof e&&"undefined"!=typeof e.shape){var n=e.dtype;if(0>c.indexOf(n)&&(n="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER){var p=gl.getExtension("OES_element_index_uint");n=p&&"uint16"!==n?"uint32":"uint16"}if(n===e.dtype&&i(e.shape,e.stride))this.length=0===e.offset&&e.data.length===e.shape[0]?o(this.gl,this.type,this.length,this.usage,e.data,a):o(this.gl,this.type,this.length,this.usage,e.data.subarray(e.offset,e.shape[0]),a);else{var u=l.malloc(e.size,n),g=d(u,e.shape);s.assign(g,e),this.length=0>a?o(this.gl,this.type,this.length,this.usage,u,a):o(this.gl,this.type,this.length,this.usage,u.subarray(0,e.size),a),l.free(u)}}else if(Array.isArray(e)){var h;h=this.type===this.gl.ELEMENT_ARRAY_BUFFER?r(e,"uint16"):r(e,"float32"),this.length=0>a?o(this.gl,this.type,this.length,this.usage,h,a):o(this.gl,this.type,this.length,this.usage,h.subarray(0,e.length),a),l.free(h)}else if("object"==typeof e&&"number"==typeof e.length)this.length=o(this.gl,this.type,this.length,this.usage,e,a);else if("number"==typeof e||void 0===e){if(0<=a)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");e|=0,0>=e&&(e=1),this.gl.bufferData(this.type,0|e,this.usage),this.length=e}else throw new Error("gl-buffer: Invalid data type")},t.exports=function(e,t,o,r){if(o=o||e.ARRAY_BUFFER,r=r||e.DYNAMIC_DRAW,o!==e.ARRAY_BUFFER&&o!==e.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(r!==e.DYNAMIC_DRAW&&r!==e.STATIC_DRAW&&r!==e.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var i=e.createBuffer(),n=new a(e,o,i,0,r);return n.update(t),n}},{ndarray:433,"ndarray-ops":427,"typedarray-pool":521}],231:[function(e,t){"use strict";var a=e("gl-vec3"),o=e("gl-vec4"),r=function(e,t,o){var r=a.create();return void 0!==e&&a.set(r,e,t,o),r},n=function(e){for(var t=e[0],a=e[1],o=e[2],r=[],i=0;i<o.length;i++)for(var n=0;n<a.length;n++)for(var l=0;l<t.length;l++)r.push([o[i],a[n],t[l]]);return r},l=function(e,t){for(var a=0;a<e.length;a++)if(e[a]>=t)return a-1;return a},s=a.create(),c=a.create(),p=function(e,t,a){return e<t?t:e>a?a:e},g=function(e,t,o,r){var i=e[0],n=e[1],u=e[2],g=o[0].length,m=o[1].length,h=o[2].length,d=l(o[0],i),y=l(o[1],n),f=l(o[2],u),x=d+1,b=y+1,_=f+1;if(r&&(d=p(d,0,g-1),x=p(x,0,g-1),y=p(y,0,m-1),b=p(b,0,m-1),f=p(f,0,h-1),_=p(_,0,h-1)),0>d||0>y||0>f||x>=g||b>=m||_>=h)return a.create();var v=(i-o[0][d])/(o[0][x]-o[0][d]),w=(n-o[1][y])/(o[1][b]-o[1][y]),k=(u-o[2][f])/(o[2][_]-o[2][f]);(0>v||1<v||isNaN(v))&&(v=0),(0>w||1<w||isNaN(w))&&(w=0),(0>k||1<k||isNaN(k))&&(k=0);var T=f*g*m,A=_*g*m,S=y*g,C=b*g,L=d,E=x,z=t[S+T+L],I=t[S+T+E],D=t[C+T+L],P=t[C+T+E],O=t[S+A+L],R=t[S+A+E],M=t[C+A+L],j=t[C+A+E],B=a.create();return a.lerp(B,z,I,v),a.lerp(s,D,P,v),a.lerp(B,B,s,w),a.lerp(s,O,R,v),a.lerp(c,M,j,v),a.lerp(s,s,c,w),a.lerp(B,B,s,k),B};t.exports=function(e,t){var o=e.positions?e.positions:n(e.meshgrid);var l=e.meshgrid,s=e.vectors,c={positions:[],vertexIntensity:[],vertexIntensityBounds:e.vertexIntensityBounds,vertexNormals:[],vectors:[],cells:[],coneOffset:e.coneOffset,colormap:e.colormap};if(0===e.positions.length)return t&&(t[0]=[0,0,0],t[1]=[0,0,0]),c;for(var h=0,f=1/0,b=-1/0,_=1/0,v=-1/0,w=1/0,T=-1/0,A=null,S=null,C=[],L=1/0,E=0,I;E<o.length;E++){I=o[E],f=ie(I[0],f),b=va(I[0],b),_=ie(I[1],_),v=va(I[1],v),w=ie(I[2],w),T=va(I[2],T);var D;D=l?g(I,s,l,!0):s[E],a.length(D)>h&&(h=a.length(D)),E&&(L=ie(L,2*a.distance(A,I)/(a.length(S)+a.length(D)))),A=I,S=D,C.push(D)}var P=[f,_,w],O=[b,v,T];t&&(t[0]=P,t[1]=O),0===h&&(h=1);var R=1/h;(!isFinite(L)||isNaN(L))&&(L=1),c.vectorScale=L;var M=r(0,1,0),B=e.coneSize||.5;e.absoluteConeSize&&(B=e.absoluteConeSize*R),c.coneScale=B;for(var E=0,F=0;E<o.length;E++)for(var I=o[E],N=I[0],x=I[1],y=I[2],z=C[E],d=a.length(z)*R,V=0;V<8;V++){c.positions.push([N,x,y,F++]),c.positions.push([N,x,y,F++]),c.positions.push([N,x,y,F++]),c.positions.push([N,x,y,F++]),c.positions.push([N,x,y,F++]),c.positions.push([N,x,y,F++]),c.vectors.push(z),c.vectors.push(z),c.vectors.push(z),c.vectors.push(z),c.vectors.push(z),c.vectors.push(z),c.vertexIntensity.push(d,d,d),c.vertexIntensity.push(d,d,d),c.vertexNormals.push(M,M,M),c.vertexNormals.push(M,M,M);var U=c.positions.length;c.cells.push([U-6,U-5,U-4],[U-3,U-2,U-1])}return c},t.exports.createConeMesh=e("./lib/conemesh")},{"./lib/conemesh":233,"gl-vec3":329,"gl-vec4":365}],232:[function(e,t){"use strict";function a(e,t){for(var a=[0,0,0,0],o=0;4>o;++o)for(var r=0;4>r;++r)a[r]+=e[4*o+r]*t[o];return a}function o(e,t,o,r,n){for(var l=a(r,a(o,a(t,[e[0],e[1],e[2],1]))),s=0;3>s;++s)l[s]/=l[3];return[.5*n[0]*(1+l[0]),.5*n[1]*(1-l[1])]}function r(e,t){if(2===e.length){for(var a=0,o=0,r=0;2>r;++r)a+=_a(t[r]-e[0][r],2),o+=_a(t[r]-e[1][r],2);return a=re(a),o=re(o),1e-6>a+o?[1,0]:[o/(a+o),a/(o+a)]}if(3===e.length){var n=[0,0];return s(e[0],e[1],e[2],t,n),l(e,n)}return[]}function n(e,t){for(var a=[0,0,0],o=0;o<e.length;++o)for(var r=e[o],n=t[o],l=0;3>l;++l)a[l]+=n*r[l];return a}var l=e("barycentric"),s=e("polytope-closest-point/lib/closest_point_2d.js");t.exports=function(e,t,a,l,d,c){if(1===e.length)return[0,e[0].slice()];for(var p=Array(e.length),u=0;u<e.length;++u)p[u]=o(e[u],a,l,d,c);for(var g=0,h=1/0,u=0,m;u<p.length;++u){m=0;for(var y=0;2>y;++y)m+=_a(p[u][y]-t[y],2);m<h&&(h=m,g=u)}for(var f=r(p,t),x=0,u=0;3>u;++u){if(-.001>f[u]||1.0001<f[u])return null;x+=f[u]}return .001<wa(x-1)?null:[g,n(e,f),f]}},{barycentric:61,"polytope-closest-point/lib/closest_point_2d.js":464}],233:[function(e,t){"use strict";function a(e,t,a,o,r,i,n,l,s,d,c,p,u,g,h,m,y,f,x,b,_,v,w,k,T,S,C,L){this.gl=e,this.cells=[],this.positions=[],this.intensity=[],this.texture=t,this.dirty=!0,this.triShader=a,this.lineShader=o,this.pointShader=r,this.pickShader=i,this.pointPickShader=n,this.contourShader=l,this.trianglePositions=s,this.triangleVectors=d,this.triangleColors=p,this.triangleNormals=g,this.triangleUVs=u,this.triangleIds=c,this.triangleVAO=h,this.triangleCount=0,this.lineWidth=1,this.edgePositions=m,this.edgeColors=f,this.edgeUVs=x,this.edgeIds=y,this.edgeVAO=b,this.edgeCount=0,this.pointPositions=_,this.pointColors=w,this.pointUVs=k,this.pointSizes=T,this.pointIds=v,this.pointVAO=S,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=C,this.contourVAO=L,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=1/4,this._model=A,this._view=A,this._projection=A,this._resolution=[1,1]}function o(e){for(var t=f({colormap:e,nshades:256,format:"rgba"}),a=new Uint8Array(1024),o=0,r;256>o;++o){r=t[o];for(var n=0;3>n;++n)a[4*o+n]=r[n];a[4*o+3]=255*r[3]}return y(a,[256,256,4],[4,0,1])}function r(e,t,a){for(var o=Array(t),r=0;r<t;++r)o[r]=0;for(var n=e.length,r=0,l;r<n;++r){l=e[r];for(var s=0;s<l.length;++s)o[l[s]]=a[r]}return o}function n(e){for(var t=e.length,a=Array(t),o=0;o<t;++o)a[o]=e[o][2];return a}function l(e){var t=d(e,k.vertex,k.fragment,null,k.attributes);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t.attributes.vector.location=5,t}function s(e){var t=d(e,T.vertex,T.fragment,null,T.attributes);return t.attributes.position.location=0,t.attributes.id.location=1,t.attributes.vector.location=5,t}var d=e("gl-shader"),c=e("gl-buffer"),p=e("gl-vao"),u=e("gl-texture2d"),g=e("normals"),h=e("gl-mat4/multiply"),m=e("gl-mat4/invert"),y=e("ndarray"),f=e("colormap"),x=e("simplicial-complex-contour"),_=e("typedarray-pool"),v=e("./shaders"),w=e("./closest-point"),k=v.meshShader,T=v.pickShader,A=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],S=a.prototype;S.isOpaque=function(){return 1<=this.opacity},S.isTransparent=function(){return 1>this.opacity},S.pickSlots=1,S.setPickBase=function(e){this.pickId=e},S.highlight=function(e){if(!e||!this.contourEnable)return void(this.contourCount=0);for(var t=x(this.cells,this.intensity,e.intensity),o=t.cells,r=t.vertexIds,n=t.vertexWeights,l=o.length,s=_.mallocFloat32(6*l),d=0,p=0,u;p<l;++p){u=o[p];for(var g=0,h;2>g;++g){h=u[0],2===u.length&&(h=u[g]);for(var m=r[h][0],a=r[h][1],y=n[h],f=this.positions[m],b=this.positions[a],w=0;3>w;++w)s[d++]=y*f[w]+(1-y)*b[w]}}this.contourCount=0|d/3,this.contourPositions.update(s.subarray(0,d)),_.free(s)},S.update=function(e){e=e||{};var t=this.gl;this.dirty=!0,"contourEnable"in e&&(this.contourEnable=e.contourEnable),"contourColor"in e&&(this.contourColor=e.contourColor),"lineWidth"in e&&(this.lineWidth=e.lineWidth),"lightPosition"in e&&(this.lightPosition=e.lightPosition),"opacity"in e&&(this.opacity=e.opacity),"ambient"in e&&(this.ambientLight=e.ambient),"diffuse"in e&&(this.diffuseLight=e.diffuse),"specular"in e&&(this.specularLight=e.specular),"roughness"in e&&(this.roughness=e.roughness),"fresnel"in e&&(this.fresnel=e.fresnel),e.vectorScale!==void 0&&(this.vectorScale=e.vectorScale),e.coneScale!==void 0&&(this.coneScale=e.coneScale),e.coneOffset!==void 0&&(this.coneOffset=e.coneOffset),e.texture?(this.texture.dispose(),this.texture=u(t,e.texture)):e.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=t.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=t.LINEAR,this.texture.setPixels(o(e.colormap)),this.texture.generateMipmap());var a=e.cells,l=e.positions,s=e.vectors;if(l&&a&&s){var d=[],h=[],m=[],y=[],x=[],b=[],_=[],T=[],A=[],S=[],C=[],L=[],E=[],z=[],I=[];this.cells=a,this.positions=l;var D=e.vertexNormals,P=e.cellNormals,O=void 0===e.vertexNormalsEpsilon?1e-6:e.vertexNormalsEpsilon,R=void 0===e.faceNormalsEpsilon?1e-6:e.faceNormalsEpsilon;e.useFacetNormals&&!P&&(P=g.faceNormals(a,l,R)),P||D||(D=g.vertexNormals(a,l,O));var M=e.vertexColors,B=e.cellColors,F=e.meshColor||[1,1,1,1],N=e.vertexUVs,V=e.vertexIntensity,U=e.cellUVs,H=e.cellIntensity,G=1/0,Y=-Infinity;if(!N&&!U)if(V){if(e.vertexIntensityBounds)G=+e.vertexIntensityBounds[0],Y=+e.vertexIntensityBounds[1];else for(var W=0,X;W<V.length;++W)X=V[W],G=ie(G,X),Y=va(Y,X);}else if(H)for(var W=0,X;W<H.length;++W)X=H[W],G=ie(G,X),Y=va(Y,X);else for(var W=0,X;W<l.length;++W)X=l[W][2],G=ie(G,X),Y=va(Y,X);this.intensity=V?V:H?r(a,l.length,H):n(l);var Z=e.pointSizes,$=e.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]];for(var W=0,J;W<l.length;++W){J=l[W];for(var K=0;3>K;++K)!isNaN(J[K])&&isFinite(J[K])&&(this.bounds[0][K]=ie(this.bounds[0][K],J[K]),this.bounds[1][K]=va(this.bounds[1][K],J[K]))}var Q=0,ee=0,te=0;fill_loop:for(var W=0,ae;W<a.length;++W)switch(ae=a[W],ae.length){case 1:for(var oe=ae[0],J=l[oe],K=0;3>K;++K)if(isNaN(J[K])||!isFinite(J[K]))continue fill_loop;C.push(J[0],J[1],J[2],J[3]);var re;re=M?M[oe]:B?B[W]:F,3===re.length?L.push(re[0],re[1],re[2],1):L.push(re[0],re[1],re[2],re[3]);var ne;ne=N?N[oe]:V?[(V[oe]-G)/(Y-G),0]:U?U[W]:H?[(H[W]-G)/(Y-G),0]:[(J[2]-G)/(Y-G),0],E.push(ne[0],ne[1]),Z?z.push(Z[oe]):z.push($),I.push(W),te+=1;break;case 2:for(var K=0;2>K;++K)for(var oe=ae[K],J=l[oe],le=0;3>le;++le)if(isNaN(J[le])||!isFinite(J[le]))continue fill_loop;for(var K=0;2>K;++K){var oe=ae[K],J=l[oe];_.push(J[0],J[1],J[2]);var re;re=M?M[oe]:B?B[W]:F,3===re.length?T.push(re[0],re[1],re[2],1):T.push(re[0],re[1],re[2],re[3]);var ne;ne=N?N[oe]:V?[(V[oe]-G)/(Y-G),0]:U?U[W]:H?[(H[W]-G)/(Y-G),0]:[(J[2]-G)/(Y-G),0],A.push(ne[0],ne[1]),S.push(W)}ee+=1;break;case 3:for(var K=0;3>K;++K)for(var oe=ae[K],J=l[oe],le=0;3>le;++le)if(isNaN(J[le])||!isFinite(J[le]))continue fill_loop;for(var K=0;3>K;++K){var oe=ae[K],J=l[oe];d.push(J[0],J[1],J[2],J[3]);var se=s[oe];h.push(se[0],se[1],se[2]);var re;re=M?M[oe]:B?B[W]:F,3===re.length?m.push(re[0],re[1],re[2],1):m.push(re[0],re[1],re[2],re[3]);var ne;ne=N?N[oe]:V?[(V[oe]-G)/(Y-G),0]:U?U[W]:H?[(H[W]-G)/(Y-G),0]:[(J[2]-G)/(Y-G),0],x.push(ne[0],ne[1]);var w;w=D?D[oe]:P[W],y.push(w[0],w[1],w[2]),b.push(W)}Q+=1;break;default:}this.pointCount=te,this.edgeCount=ee,this.triangleCount=Q,this.pointPositions.update(C),this.pointColors.update(L),this.pointUVs.update(E),this.pointSizes.update(z),this.pointIds.update(new Uint32Array(I)),this.edgePositions.update(_),this.edgeColors.update(T),this.edgeUVs.update(A),this.edgeIds.update(new Uint32Array(S)),this.trianglePositions.update(d),this.triangleVectors.update(h),this.triangleColors.update(m),this.triangleUVs.update(x),this.triangleNormals.update(y),this.triangleIds.update(new Uint32Array(b))}},S.drawTransparent=S.draw=function(e){e=e||{};for(var t=this.gl,a=e.model||A,o=e.view||A,r=e.projection||A,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;3>l;++l)n[0][l]=va(n[0][l],this.clipBounds[0][l]),n[1][l]=ie(n[1][l],this.clipBounds[1][l]);var d={model:a,view:o,projection:r,clipBounds:n,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,contourColor:this.contourColor,texture:0};this.texture.bind(0);var c=Array(16);h(c,d.view,d.model),h(c,d.projection,c),m(c,c);for(var l=0;3>l;++l)d.eyePosition[l]=c[12+l]/c[15];for(var p=c[15],l=0;3>l;++l)p+=this.lightPosition[l]*c[4*l+3];for(var l=0,u;3>l;++l){u=c[12+l];for(var g=0;3>g;++g)u+=c[4*g+l]*this.lightPosition[g];d.lightPosition[l]=u/p}if(0<this.triangleCount){var y=this.triShader;y.bind(),y.uniforms=d,this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}if(0<this.edgeCount&&0<this.lineWidth){var y=this.lineShader;y.bind(),y.uniforms=d,this.edgeVAO.bind(),t.lineWidth(this.lineWidth),t.drawArrays(t.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()}if(0<this.pointCount){var y=this.pointShader;y.bind(),y.uniforms=d,this.pointVAO.bind(),t.drawArrays(t.POINTS,0,this.pointCount),this.pointVAO.unbind()}if(this.contourEnable&&0<this.contourCount&&0<this.contourLineWidth){var y=this.contourShader;y.bind(),y.uniforms=d,this.contourVAO.bind(),t.drawArrays(t.LINES,0,this.contourCount),this.contourVAO.unbind()}},S.drawPick=function(e){e=e||{};for(var t=this.gl,a=e.model||A,o=e.view||A,r=e.projection||A,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;3>l;++l)n[0][l]=va(n[0][l],this.clipBounds[0][l]),n[1][l]=ie(n[1][l],this.clipBounds[1][l]);this._model=[].slice.call(a),this._view=[].slice.call(o),this._projection=[].slice.call(r),this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];var s={model:a,view:o,projection:r,clipBounds:n,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},d=this.pickShader;if(d.bind(),d.uniforms=s,0<this.triangleCount&&(this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),0<this.edgeCount&&(this.edgeVAO.bind(),t.lineWidth(this.lineWidth),t.drawArrays(t.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),0<this.pointCount){var d=this.pointPickShader;d.bind(),d.uniforms=s,this.pointVAO.bind(),t.drawArrays(t.POINTS,0,this.pointCount),this.pointVAO.unbind()}},S.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;var t=e.value[0]+256*e.value[1]+65536*e.value[2],a=this.cells[t],o=this.positions[a[1]].slice(0,3);return{index:ea(a[1]/48),position:o,dataCoordinate:o}},S.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose()},t.exports=function(e,t){1===arguments.length&&(t=e,e=t.gl);var o=t.triShader||l(e),r=s(e),i=u(e,y(new Uint8Array([255,255,255,255]),[1,1,4]));i.generateMipmap(),i.minFilter=e.LINEAR_MIPMAP_LINEAR,i.magFilter=e.LINEAR;var n=c(e),d=c(e),g=c(e),h=c(e),m=c(e),f=c(e),x=p(e,[{buffer:n,type:e.FLOAT,size:4},{buffer:f,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:g,type:e.FLOAT,size:4},{buffer:h,type:e.FLOAT,size:2},{buffer:m,type:e.FLOAT,size:3},{buffer:d,type:e.FLOAT,size:3}]),b=c(e),_=c(e),v=c(e),w=c(e),k=p(e,[{buffer:b,type:e.FLOAT,size:3},{buffer:w,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:_,type:e.FLOAT,size:4},{buffer:v,type:e.FLOAT,size:2}]),T=c(e),A=c(e),S=c(e),C=c(e),L=c(e),E=p(e,[{buffer:T,type:e.FLOAT,size:3},{buffer:L,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:A,type:e.FLOAT,size:4},{buffer:S,type:e.FLOAT,size:2},{buffer:C,type:e.FLOAT,size:1}]),z=c(e),I=p(e,[{buffer:z,type:e.FLOAT,size:3}]),D=new a(e,i,o,null,null,r,null,null,n,d,f,g,h,m,x,b,w,_,v,k,T,L,A,S,C,E,z,I);return D.update(t),D}},{"./closest-point":232,"./shaders":234,colormap:114,"gl-buffer":230,"gl-mat4/invert":254,"gl-mat4/multiply":256,"gl-shader":288,"gl-texture2d":305,"gl-vao":310,ndarray:433,normals:436,"simplicial-complex-contour":494,"typedarray-pool":521}],234:[function(e,t,a){var o=e("glslify"),r=o(["precision mediump float;\n#define GLSLIFY 1\n\nfloat inverse(float m) {\n  return 1.0 / m;\n}\n\nmat2 inverse(mat2 m) {\n  return mat2(m[1][1],-m[0][1],\n             -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\n}\n\nmat3 inverse(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n              b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n              b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nmat4 inverse(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float index, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  index = mod(index, segmentCount * 6.0);\n\n  float segment = floor(index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex == 3.0) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  // angle = 2pi * ((segment + ((segmentIndex == 1.0 || segmentIndex == 5.0) ? 1.0 : 0.0)) / segmentCount)\n  float nextAngle = float(segmentIndex == 1.0 || segmentIndex == 5.0);\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex <= 2.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\nuniform float vectorScale;\nuniform float coneScale;\n\nuniform float coneOffset;\n\nuniform mat4 model\n           , view\n           , projection;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data\n           , f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n  normal = normalize(normal * inverse(mat3(model)));\n\n  // vec4 m_position  = model * vec4(conePosition, 1.0);\n  vec4 t_position  = view * conePosition;\n  gl_Position      = projection * t_position;\n  f_color          = color; //vec4(position.w, color.r, 0, 0);\n  f_normal         = normal;\n  f_data           = conePosition.xyz;\n  f_position       = position.xyz;\n  f_eyeDirection   = eyePosition   - conePosition.xyz;\n  f_lightDirection = lightPosition - conePosition.xyz;\n  f_uv             = uv;\n}\n"]),i=o(["precision mediump float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular\n            , opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data\n           , f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(!gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = cookTorranceSpecular(L, V, N, roughness, fresnel);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor =  texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}"]),n=o(["precision mediump float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float index, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  index = mod(index, segmentCount * 6.0);\n\n  float segment = floor(index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex == 3.0) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  // angle = 2pi * ((segment + ((segmentIndex == 1.0 || segmentIndex == 5.0) ? 1.0 : 0.0)) / segmentCount)\n  float nextAngle = float(segmentIndex == 1.0 || segmentIndex == 5.0);\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex <= 2.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nuniform float vectorScale;\nuniform float coneScale;\nuniform float coneOffset;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n  gl_Position = projection * view * conePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),l=o(["precision mediump float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);a.meshShader={vertex:r,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},a.pickShader={vertex:n,fragment:l,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:392}],235:[function(e,t){t.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],236:[function(e,t){var a=e("./1.0/numbers");t.exports=function(e){return a[e]}},{"./1.0/numbers":235}],237:[function(e,t){"use strict";function a(e,t,a,o){this.gl=e,this.shader=o,this.buffer=t,this.vao=a,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1}function o(e,t){for(var a=0;3>a;++a)e[0][a]=ie(e[0][a],t[a]),e[1][a]=va(e[1][a],t[a])}function r(e,t,a,r){for(var n=p[r],l=0,s;l<n.length;++l)s=n[l],e.push(t[0],t[1],t[2],a[0],a[1],a[2],a[3],s[0],s[1],s[2]);return n.length}t.exports=function(e){var t=e.gl,o=i(t),r=n(t,[{buffer:o,type:t.FLOAT,size:3,offset:0,stride:40},{buffer:o,type:t.FLOAT,size:4,offset:12,stride:40},{buffer:o,type:t.FLOAT,size:3,offset:28,stride:40}]),s=l(t);s.attributes.position.location=0,s.attributes.color.location=1,s.attributes.offset.location=2;var d=new a(t,o,r,s);return d.update(e),d};var i=e("gl-buffer"),n=e("gl-vao"),l=e("./shaders/index"),s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],d=a.prototype;d.isOpaque=function(){return 1<=this.opacity},d.isTransparent=function(){return 1>this.opacity},d.drawTransparent=d.draw=function(e){var t=this.gl,a=this.shader.uniforms;this.shader.bind();var o=a.view=e.view||s,r=a.projection=e.projection||s;a.model=e.model||s,a.clipBounds=this.clipBounds,a.opacity=this.opacity;var n=o[12],l=o[13],d=o[14],c=o[15],p=this.pixelRatio*(r[3]*n+r[7]*l+r[11]*d+r[15]*c)/t.drawingBufferHeight;this.vao.bind();for(var u=0;3>u;++u)t.lineWidth(this.lineWidth[u]),a.capSize=this.capSize[u]*p,this.lineCount[u]&&t.drawArrays(t.LINES,this.lineOffset[u],this.lineCount[u]);this.vao.unbind()};var p=function(){for(var e=[,,,],t=0,a;3>t;++t){a=[];for(var o=1;2>=o;++o)for(var r=-1;1>=r;r+=2){var i=(o+t)%3,n=[0,0,0];n[i]=r,a.push(n)}e[t]=a}return e}();d.update=function(t){t=t||{},"lineWidth"in t&&(this.lineWidth=t.lineWidth,!Array.isArray(this.lineWidth)&&(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in t&&(this.capSize=t.capSize,!Array.isArray(this.capSize)&&(this.capSize=[this.capSize,this.capSize,this.capSize])),"opacity"in t&&(this.opacity=t.opacity);var a=t.color||[[0,0,0],[0,0,0],[0,0,0]],l=t.position,s=t.error;if(Array.isArray(a[0])||(a=[a,a,a]),l&&s){var d=[],u=l.length,n=0;this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.lineCount=[0,0,0];for(var g=0;3>g;++g){this.lineOffset[g]=n;i_loop:for(var h=0,m;h<u;++h){m=l[h];for(var y=0;3>y;++y)if(isNaN(m[y])||!isFinite(m[y]))continue i_loop;var f=s[h],e=a[g];if(Array.isArray(e[0])&&(e=a[h]),3===e.length&&(e=[e[0],e[1],e[2],1]),!(isNaN(f[0][g])||isNaN(f[1][g]))){if(0>f[0][g]){var b=m.slice();b[g]+=f[0][g],d.push(m[0],m[1],m[2],e[0],e[1],e[2],e[3],0,0,0,b[0],b[1],b[2],e[0],e[1],e[2],e[3],0,0,0),o(this.bounds,b),n+=2+r(d,b,e,g)}if(0<f[1][g]){var b=m.slice();b[g]+=f[1][g],d.push(m[0],m[1],m[2],e[0],e[1],e[2],e[3],0,0,0,b[0],b[1],b[2],e[0],e[1],e[2],e[3],0,0,0),o(this.bounds,b),n+=2+r(d,b,e,g)}}}this.lineCount[g]=n-this.lineOffset[g]}this.buffer.update(d)}},d.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":238,"gl-buffer":230,"gl-vao":310}],238:[function(e,t){"use strict";var a=e("glslify"),o=e("gl-shader"),r=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}"]),i=a(["precision mediump float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], fragPosition)) discard;\n\n  gl_FragColor = opacity * fragColor;\n}"]);t.exports=function(e){return o(e,r,i,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":288,glslify:392}],239:[function(e,t){"use strict";function a(e){var t=e.getParameter(e.FRAMEBUFFER_BINDING),a=e.getParameter(e.RENDERBUFFER_BINDING),o=e.getParameter(e.TEXTURE_BINDING_2D);return[t,a,o]}function o(e,t){e.bindFramebuffer(e.FRAMEBUFFER,t[0]),e.bindRenderbuffer(e.RENDERBUFFER,t[1]),e.bindTexture(e.TEXTURE_2D,t[2])}function r(e,t){var a=e.getParameter(t.MAX_COLOR_ATTACHMENTS_WEBGL);h=Array(a+1);for(var o=0,r;o<=a;++o){r=Array(a);for(var n=0;n<o;++n)r[n]=e.COLOR_ATTACHMENT0+n;for(var n=o;n<a;++n)r[n]=e.NONE;h[o]=r}}function n(e){switch(e){case y:throw new Error("gl-fbo: Framebuffer unsupported");case f:throw new Error("gl-fbo: Framebuffer incomplete attachment");case x:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case b:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason");}}function l(e,t,a,o,r,i){if(!o)return null;var n=g(e,t,a,r,o);return n.magFilter=e.NEAREST,n.minFilter=e.NEAREST,n.mipSamples=1,n.bind(),e.framebufferTexture2D(e.FRAMEBUFFER,i,e.TEXTURE_2D,n.handle,0),n}function s(e,t,a,o,r){var i=e.createRenderbuffer();return e.bindRenderbuffer(e.RENDERBUFFER,i),e.renderbufferStorage(e.RENDERBUFFER,o,t,a),e.framebufferRenderbuffer(e.FRAMEBUFFER,r,e.RENDERBUFFER,i),i}function d(e){var t=a(e.gl),r=e.gl,d=e.handle=r.createFramebuffer(),c=e._shape[0],p=e._shape[1],u=e.color.length,g=e._ext,m=e._useStencil,y=e._useDepth,f=e._colorType;r.bindFramebuffer(r.FRAMEBUFFER,d);for(var x=0;x<u;++x)e.color[x]=l(r,c,p,f,r.RGBA,r.COLOR_ATTACHMENT0+x);0===u?(e._color_rb=s(r,c,p,r.RGBA4,r.COLOR_ATTACHMENT0),g&&g.drawBuffersWEBGL(h[0])):1<u&&g.drawBuffersWEBGL(h[u]);var b=r.getExtension("WEBGL_depth_texture");b?m?e.depth=l(r,c,p,b.UNSIGNED_INT_24_8_WEBGL,r.DEPTH_STENCIL,r.DEPTH_STENCIL_ATTACHMENT):y&&(e.depth=l(r,c,p,r.UNSIGNED_SHORT,r.DEPTH_COMPONENT,r.DEPTH_ATTACHMENT)):y&&m?e._depth_rb=s(r,c,p,r.DEPTH_STENCIL,r.DEPTH_STENCIL_ATTACHMENT):y?e._depth_rb=s(r,c,p,r.DEPTH_COMPONENT16,r.DEPTH_ATTACHMENT):m&&(e._depth_rb=s(r,c,p,r.STENCIL_INDEX,r.STENCIL_ATTACHMENT));var _=r.checkFramebufferStatus(r.FRAMEBUFFER);if(_!==r.FRAMEBUFFER_COMPLETE){e._destroyed=!0,r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteFramebuffer(e.handle),e.handle=null,e.depth&&(e.depth.dispose(),e.depth=null),e._depth_rb&&(r.deleteRenderbuffer(e._depth_rb),e._depth_rb=null);for(var x=0;x<e.color.length;++x)e.color[x].dispose(),e.color[x]=null;e._color_rb&&(r.deleteRenderbuffer(e._color_rb),e._color_rb=null),o(r,t),n(_)}o(r,t)}function c(e,t,a,o,r,n,l,s){this.gl=e,this._shape=[0|t,0|a],this._destroyed=!1,this._ext=s,this.color=Array(r);for(var c=0;c<r;++c)this.color[c]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=o,this._useDepth=n,this._useStencil=l;var p=this,u=[0|t,0|a];Object.defineProperties(u,{0:{get:function(){return p._shape[0]},set:function(e){return p.width=e}},1:{get:function(){return p._shape[1]},set:function(e){return p.height=e}}}),this._shapeVector=u,d(this)}function p(e,t,r){if(e._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(e._shape[0]!==t||e._shape[1]!==r){var l=e.gl,s=l.getParameter(l.MAX_RENDERBUFFER_SIZE);if(0>t||t>s||0>r||r>s)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");e._shape[0]=t,e._shape[1]=r;for(var d=a(l),c=0;c<e.color.length;++c)e.color[c].shape=e._shape;e._color_rb&&(l.bindRenderbuffer(l.RENDERBUFFER,e._color_rb),l.renderbufferStorage(l.RENDERBUFFER,l.RGBA4,e._shape[0],e._shape[1])),e.depth&&(e.depth.shape=e._shape),e._depth_rb&&(l.bindRenderbuffer(l.RENDERBUFFER,e._depth_rb),e._useDepth&&e._useStencil?l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_STENCIL,e._shape[0],e._shape[1]):e._useDepth?l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,e._shape[0],e._shape[1]):e._useStencil&&l.renderbufferStorage(l.RENDERBUFFER,l.STENCIL_INDEX,e._shape[0],e._shape[1])),l.bindFramebuffer(l.FRAMEBUFFER,e.handle);var p=l.checkFramebufferStatus(l.FRAMEBUFFER);p!==l.FRAMEBUFFER_COMPLETE&&(e.dispose(),o(l,d),n(p)),o(l,d)}}function u(e,t,a,o){y||(y=e.FRAMEBUFFER_UNSUPPORTED,f=e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,x=e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,b=e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var i=e.getExtension("WEBGL_draw_buffers");if(!h&&i&&r(e,i),Array.isArray(t)&&(o=a,a=0|t[1],t=0|t[0]),"number"!=typeof t)throw new Error("gl-fbo: Missing shape parameter");var n=e.getParameter(e.MAX_RENDERBUFFER_SIZE);if(0>t||t>n||0>a||a>n)throw new Error("gl-fbo: Parameters are too large for FBO");o=o||{};var l=1;if("color"in o){if(l=va(0|o.color,0),0>l)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(1<l)if(!i)throw new Error("gl-fbo: Multiple draw buffer extension not supported");else if(l>e.getParameter(i.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+l+" draw buffers")}var s=e.UNSIGNED_BYTE,d=e.getExtension("OES_texture_float");if(o.float&&0<l){if(!d)throw new Error("gl-fbo: Context does not support floating point textures");s=e.FLOAT}else o.preferFloat&&0<l&&d&&(s=e.FLOAT);var p=!0;"depth"in o&&(p=!!o.depth);var u=!1;return"stencil"in o&&(u=!!o.stencil),new c(e,t,a,s,l,p,u,i)}var g=e("gl-texture2d");t.exports=u;var h=null,m=c.prototype,y,f,x,b;Object.defineProperties(m,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(e){if(Array.isArray(e)||(e=[0|e,0|e]),2!==e.length)throw new Error("gl-fbo: Shape vector must be length 2");var t=0|e[0],a=0|e[1];return p(this,t,a),[t,a]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(e){return e|=0,p(this,e,this._shape[1]),e},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(e){return e|=0,p(this,this._shape[0],e),e},enumerable:!1}}),m.bind=function(){if(!this._destroyed){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.handle),e.viewport(0,0,this._shape[0],this._shape[1])}},m.dispose=function(){if(!this._destroyed){this._destroyed=!0;var e=this.gl;e.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(e.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var t=0;t<this.color.length;++t)this.color[t].dispose(),this.color[t]=null;this._color_rb&&(e.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":305}],240:[function(e,t){var a=e("sprintf-js").sprintf,o=e("gl-constants/lookup"),r=e("glsl-shader-name"),n=e("add-line-numbers");t.exports=function(t,l,s){"use strict";var d=r(l)||"of unknown name (see npm glsl-shader-name)",c="unknown type";s!==void 0&&(c=s===o.FRAGMENT_SHADER?"fragment":"vertex");for(var p=a("Error compiling %s shader %s:\n",c,d),u=a("%s%s",p,t),g=t.split("\n"),h={},m=0,y;m<g.length;m++)if(y=g[m],""!==y&&"\0"!==y){var f=parseInt(y.split(":")[2]);if(isNaN(f))throw new Error(a("Could not parse error: %s",y));h[f]=y}for(var x=n(l).split("\n"),m=0;m<x.length;m++)if(h[m+3]||h[m+2]||h[m+1]){var b=x[m];if(p+=b+"\n",h[m+1]){var _=h[m+1];_=_.substr(_.split(":",3).join(":").length+1).trim(),p+=a("^^^ %s\n\n",_)}}return{long:p.trim(),short:u.trim()}}},{"add-line-numbers":49,"gl-constants/lookup":236,"glsl-shader-name":384,"sprintf-js":504}],241:[function(e,t){"use strict";function a(e,t,a,o,r,i,n){this.plot=e,this.shader=t,this.pickShader=a,this.positionBuffer=o,this.weightBuffer=r,this.colorBuffer=i,this.idBuffer=n,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-Infinity,-Infinity],this.pickOffset=0}t.exports=function(e,t){var o=e.gl,r=s(o,c.vertex,c.fragment),i=s(o,c.pickVertex,c.pickFragment),n=d(o),l=d(o),p=d(o),u=d(o),g=new a(e,r,i,n,l,p,u);return g.update(t),e.addObject(g),g};var o=e("binary-search-bounds"),n=e("iota-array"),l=e("typedarray-pool"),s=e("gl-shader"),d=e("gl-buffer"),c=e("./lib/shaders"),p=a.prototype,u=[0,0,1,0,0,1,1,0,1,1,0,1];p.draw=function(){var e=[1,0,0,0,1,0,0,0,1];return function(){var t=this.plot,a=this.shader,o=this.bounds,r=this.numVertices;if(!(0>=r)){var i=t.gl,n=t.dataBox,l=o[2]-o[0],s=o[3]-o[1],d=n[2]-n[0],c=n[3]-n[1];e[0]=2*l/d,e[4]=2*s/c,e[6]=2*(o[0]-n[0])/d-1,e[7]=2*(o[1]-n[1])/c-1,a.bind();var p=a.uniforms;p.viewTransform=e,p.shape=this.shape;var u=a.attributes;this.positionBuffer.bind(),u.position.pointer(),this.weightBuffer.bind(),u.weight.pointer(i.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),u.color.pointer(i.UNSIGNED_BYTE,!0),i.drawArrays(i.TRIANGLES,0,r)}}}(),p.drawPick=function(){var e=[1,0,0,0,1,0,0,0,1],t=[0,0,0,0];return function(a){var o=this.plot,r=this.pickShader,n=this.bounds,l=this.numVertices;if(!(0>=l)){var s=o.gl,d=o.dataBox,c=n[2]-n[0],p=n[3]-n[1],u=d[2]-d[0],g=d[3]-d[1];e[0]=2*c/u,e[4]=2*p/g,e[6]=2*(n[0]-d[0])/u-1,e[7]=2*(n[1]-d[1])/g-1;for(var h=0;4>h;++h)t[h]=255&a>>8*h;this.pickOffset=a,r.bind();var m=r.uniforms;m.viewTransform=e,m.pickOffset=t,m.shape=this.shape;var y=r.attributes;return this.positionBuffer.bind(),y.position.pointer(),this.weightBuffer.bind(),y.weight.pointer(s.UNSIGNED_BYTE,!1),this.idBuffer.bind(),y.pickId.pointer(s.UNSIGNED_BYTE,!1),s.drawArrays(s.TRIANGLES,0,l),a+this.shape[0]*this.shape[1]}}}(),p.pick=function(e,t,a){var o=this.pickOffset,r=this.shape[0]*this.shape[1];if(a<o||a>=o+r)return null;var i=a-o,n=this.xData,l=this.yData;return{object:this,pointId:i,dataCoord:[n[i%this.shape[0]],l[0|i/this.shape[0]]]}},p.update=function(e){e=e||{};var s=e.shape||[0,0],d=e.x||n(s[0]),c=e.y||n(s[1]),p=e.z||new Float32Array(s[0]*s[1]);this.xData=d,this.yData=c;var h=e.colorLevels||[0],m=e.colorValues||[0,0,0,1],y=h.length,f=this.bounds,x=f[0]=d[0],_=f[1]=c[0],v=f[2]=d[d.length-1],w=f[3]=c[c.length-1],k=1/(v-x),T=1/(w-_),A=s[0],S=s[1];this.shape=[A,S];var C=(A-1)*(S-1)*(u.length>>>1);this.numVertices=C;for(var L=l.mallocUint8(4*C),E=l.mallocFloat32(2*C),z=l.mallocUint8(2*C),I=l.mallocUint32(C),D=0,P=0;P<S-1;++P)for(var O=T*(c[P]-_),R=T*(c[P+1]-_),M=0;M<A-1;++M)for(var B=k*(d[M]-x),F=k*(d[M+1]-x),N=0;N<u.length;N+=2){var V=u[N],U=u[N+1],H=(P+U)*A+(M+V),G=p[H],Y=o.le(h,G),q,W,X,Z;if(0>Y)q=m[0],W=m[1],X=m[2],Z=m[3];else if(Y===y-1)q=m[4*y-4],W=m[4*y-3],X=m[4*y-2],Z=m[4*y-1];else{var $=(G-h[Y])/(h[Y+1]-h[Y]),t=1-$,J=4*Y,K=4*(Y+1);q=t*m[J]+$*m[K],W=t*m[J+1]+$*m[K+1],X=t*m[J+2]+$*m[K+2],Z=t*m[J+3]+$*m[K+3]}L[4*D]=255*q,L[4*D+1]=255*W,L[4*D+2]=255*X,L[4*D+3]=255*Z,E[2*D]=.5*B+.5*F,E[2*D+1]=.5*O+.5*R,z[2*D]=V,z[2*D+1]=U,I[D]=P*A+M,D+=1}this.positionBuffer.update(E),this.weightBuffer.update(z),this.colorBuffer.update(L),this.idBuffer.update(I),l.free(E),l.free(L),l.free(z),l.free(I)},p.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":242,"binary-search-bounds":243,"gl-buffer":230,"gl-shader":288,"iota-array":399,"typedarray-pool":521}],242:[function(e,t){"use strict";var a=e("glslify");t.exports={fragment:a(["precision lowp float;\n#define GLSLIFY 1\nvarying vec4 fragColor;\nvoid main() {\n  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);\n}\n"]),vertex:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 color;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  fragColor = color;\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"]),pickFragment:a(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nuniform vec2 shape;\nuniform vec4 pickOffset;\n\nvoid main() {\n  vec2 d = step(.5, vWeight);\n  vec4 id = fragId + pickOffset;\n  id.x += d.x + d.y*shape.x;\n\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  gl_FragColor = id/255.;\n}\n"]),pickVertex:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nvoid main() {\n  vWeight = weight;\n\n  fragId = pickId;\n\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"])}},{glslify:392}],243:[function(e,t,a){arguments[4][99][0].apply(a,arguments)},{dup:99}],244:[function(e,t,a){var o=e("glslify"),r=e("gl-shader"),i=o(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  vec4 startPoint = project(position);\n  vec4 endPoint   = project(nextPosition);\n\n  vec2 A = startPoint.xy / startPoint.w;\n  vec2 B =   endPoint.xy /   endPoint.w;\n\n  float clipAngle = atan(\n    (B.y - A.y) * screenShape.y,\n    (B.x - A.x) * screenShape.x\n  );\n\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(\n    sin(clipAngle),\n    -cos(clipAngle)\n  ) / screenShape;\n\n  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n"]),n=o(["precision mediump float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;\n\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n"]),l=o(["precision mediump float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\nlowp vec4 encode_float_1604150559(highp float v) {\n  highp float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  highp vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  highp float e = floor(log2(av));\n  highp float m = av * pow(2.0, -e) - 1.0;\n  \n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n  \n  //Unpack exponent\n  highp float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0; \n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;\n\n  gl_FragColor = vec4(pickId/255.0, encode_float_1604150559(pixelArcLength).xyz);\n}"]),s=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];a.createShader=function(e){return r(e,i,n,null,s)},a.createPickShader=function(e){return r(e,i,l,null,s)}},{"gl-shader":288,glslify:392}],245:[function(e,t){"use strict";function o(e,t){for(var a=0,o=0,r;3>o;++o)r=e[o]-t[o],a+=r*r;return re(a)}function r(e){for(var t=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],a=0;3>a;++a)t[0][a]=va(e[0][a],t[0][a]),t[1][a]=ie(e[1][a],t[1][a]);return t}function n(e,t,a,o){this.arcLength=e,this.position=t,this.index=a,this.dataCoordinate=o}function l(e,t,a,o,r,i){this.gl=e,this.shader=t,this.pickShader=a,this.buffer=o,this.vao=r,this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=i,this.dashScale=1,this.opacity=1,this.dirty=!0,this.pixelRatio=1}t.exports=function(e){var t=e.gl||e.scene&&e.scene.gl,a=m(t);a.attributes.position.location=0,a.attributes.nextPosition.location=1,a.attributes.arcLength.location=2,a.attributes.lineWidth.location=3,a.attributes.color.location=4;var o=y(t);o.attributes.position.location=0,o.attributes.nextPosition.location=1,o.attributes.arcLength.location=2,o.attributes.lineWidth.location=3,o.attributes.color.location=4;for(var r=s(t),n=d(t,[{buffer:r,size:3,offset:0,stride:48},{buffer:r,size:3,offset:12,stride:48},{buffer:r,size:1,offset:24,stride:48},{buffer:r,size:1,offset:28,stride:48},{buffer:r,size:4,offset:32,stride:48}]),p=g(Array(1024),[256,1,4]),u=0;1024>u;++u)p.data[u]=255;var h=c(t,p);h.wrap=t.REPEAT;var f=new l(t,a,o,r,n,h);return f.update(e),f};var s=e("gl-buffer"),d=e("gl-vao"),c=e("gl-texture2d"),p=e("glsl-read-float"),u=e("binary-search-bounds"),g=e("ndarray"),h=e("./lib/shaders"),m=h.createShader,y=h.createPickShader,f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],x=l.prototype;x.isTransparent=function(){return 1>this.opacity},x.isOpaque=function(){return 1<=this.opacity},x.pickSlots=1,x.setPickBase=function(e){this.pickId=e},x.drawTransparent=x.draw=function(e){if(this.vertexCount){var t=this.gl,a=this.shader,o=this.vao;a.bind(),a.uniforms={model:e.model||f,view:e.view||f,projection:e.projection||f,clipBounds:r(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[t.drawingBufferWidth,t.drawingBufferHeight],pixelRatio:this.pixelRatio},o.bind(),o.draw(t.TRIANGLE_STRIP,this.vertexCount),o.unbind()}},x.drawPick=function(e){if(this.vertexCount){var t=this.gl,a=this.pickShader,o=this.vao;a.bind(),a.uniforms={model:e.model||f,view:e.view||f,projection:e.projection||f,pickId:this.pickId,clipBounds:r(this.clipBounds),screenShape:[t.drawingBufferWidth,t.drawingBufferHeight],pixelRatio:this.pixelRatio},o.bind(),o.draw(t.TRIANGLE_STRIP,this.vertexCount),o.unbind()}},x.update=function(e){var t,r;this.dirty=!0;var n=!!e.connectGaps;"dashScale"in e&&(this.dashScale=e.dashScale),"opacity"in e&&(this.opacity=+e.opacity);var l=[],s=[],d=[],c=0,p=0,h=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],m=e.position||e.positions;if(m){var y=e.color||e.colors||[0,0,0,1],f=e.lineWidth||1,x=!1;fill_loop:for(t=1;t<m.length;++t){var _=m[t-1],a=m[t];for(s.push(c),d.push(_.slice()),r=0;3>r;++r){if(isNaN(_[r])||isNaN(a[r])||!isFinite(_[r])||!isFinite(a[r])){if(!n&&0<l.length){for(var b=0;24>b;++b)l.push(l[l.length-12]);p+=2,x=!0}continue fill_loop}h[0][r]=ie(h[0][r],_[r],a[r]),h[1][r]=va(h[1][r],_[r],a[r])}var v,w;Array.isArray(y[0])?(v=y.length>t-1?y[t-1]:0<y.length?y[y.length-1]:[0,0,0,1],w=y.length>t?y[t]:0<y.length?y[y.length-1]:[0,0,0,1]):v=w=y,3===v.length&&(v=[v[0],v[1],v[2],1]),3===w.length&&(w=[w[0],w[1],w[2],1]);var T=Array.isArray(f)?f.length>t-1?f[t-1]:0<f.length?f[f.length-1]:[0,0,0,1]:f;var A=c;if(c+=o(_,a),x){for(r=0;2>r;++r)l.push(_[0],_[1],_[2],a[0],a[1],a[2],A,T,v[0],v[1],v[2],v[3]);p+=2,x=!1}l.push(_[0],_[1],_[2],a[0],a[1],a[2],A,T,v[0],v[1],v[2],v[3],_[0],_[1],_[2],a[0],a[1],a[2],A,-T,v[0],v[1],v[2],v[3],a[0],a[1],a[2],_[0],_[1],_[2],c,-T,w[0],w[1],w[2],w[3],a[0],a[1],a[2],_[0],_[1],_[2],c,T,w[0],w[1],w[2],w[3]),p+=4}}if(this.buffer.update(l),s.push(c),d.push(m[m.length-1].slice()),this.bounds=h,this.vertexCount=p,this.points=d,this.arcLength=s,"dashes"in e){var S=e.dashes,C=S.slice();for(C.unshift(0),t=1;t<C.length;++t)C[t]=C[t-1]+C[t];var L=g(Array(1024),[256,1,4]);for(t=0;256>t;++t){for(r=0;4>r;++r)L.set(t,0,r,0);1&u.le(C,C[C.length-1]*t/255)?L.set(t,0,0,0):L.set(t,0,0,255)}this.texture.setPixels(L)}},x.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},x.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;var o=p(e.value[0],e.value[1],e.value[2],0),r=u.le(this.arcLength,o);if(0>r)return null;if(r===this.arcLength.length-1)return new n(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),r);for(var l=this.points[r],a=this.points[ie(r+1,this.points.length-1)],s=(o-this.arcLength[r])/(this.arcLength[r+1]-this.arcLength[r]),t=[0,0,0],d=0;3>d;++d)t[d]=(1-s)*l[d]+s*a[d];var c=ie(.5>s?r:r+1,this.points.length-1);return new n(o,t,c,this.points[c])}},{"./lib/shaders":244,"binary-search-bounds":79,"gl-buffer":230,"gl-texture2d":305,"gl-vao":310,"glsl-read-float":383,ndarray:433}],246:[function(e,t){t.exports=function(e,t){var a=t[0],o=t[1],r=t[2],i=t[3],n=a*i-r*o;return n?(n=1/n,e[0]=i*n,e[1]=-o*n,e[2]=-r*n,e[3]=a*n,e):null}},{}],247:[function(e,t){t.exports=function(e,t){var a=t[0],o=t[1],r=t[2],i=t[3],n=t[4],l=t[5],s=t[6],d=t[7],c=t[8],p=c*n-l*d,u=-c*i+l*s,g=d*i-n*s,h=a*p+o*u+r*g;return h?(h=1/h,e[0]=p*h,e[1]=(-c*o+r*d)*h,e[2]=(l*o-r*n)*h,e[3]=u*h,e[4]=(c*a-r*s)*h,e[5]=(-l*a+r*i)*h,e[6]=g*h,e[7]=(-d*a+o*s)*h,e[8]=(n*a-o*i)*h,e):null}},{}],248:[function(e,t){t.exports=function(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},{}],249:[function(e,t){t.exports=function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],250:[function(e,t){t.exports=function(e){var t=e[0],a=e[1],o=e[2],r=e[3],i=e[4],n=e[5],l=e[6],s=e[7],d=e[8],c=e[9],p=e[10],u=e[11],g=e[12],h=e[13],m=e[14],y=e[15];return(t*n-a*i)*(p*y-u*m)-(t*l-o*i)*(c*y-u*h)+(t*s-r*i)*(c*m-p*h)+(a*l-o*n)*(d*y-u*g)-(a*s-r*n)*(d*m-p*g)+(o*s-r*l)*(d*h-c*g)}},{}],251:[function(e,t){t.exports=function(e,t){var a=t[0],o=t[1],r=t[2],i=t[3],n=a+a,l=o+o,s=r+r,d=a*n,c=o*n,p=o*l,u=r*n,g=r*l,h=r*s,m=i*n,y=i*l,f=i*s;return e[0]=1-p-h,e[1]=c+f,e[2]=u-y,e[3]=0,e[4]=c-f,e[5]=1-d-h,e[6]=g+m,e[7]=0,e[8]=u+y,e[9]=g-m,e[10]=1-d-p,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],252:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2],n=t[3],l=o+o,s=r+r,d=i+i,c=o*l,p=o*s,u=o*d,g=r*s,h=r*d,m=i*d,y=n*l,f=n*s,x=n*d;return e[0]=1-(g+m),e[1]=p+x,e[2]=u-f,e[3]=0,e[4]=p-x,e[5]=1-(c+m),e[6]=h+y,e[7]=0,e[8]=u+f,e[9]=h-y,e[10]=1-(c+g),e[11]=0,e[12]=a[0],e[13]=a[1],e[14]=a[2],e[15]=1,e}},{}],253:[function(e,t){t.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],254:[function(e,t){t.exports=function(e,t){var a=t[0],o=t[1],r=t[2],i=t[3],n=t[4],l=t[5],s=t[6],d=t[7],c=t[8],p=t[9],u=t[10],g=t[11],h=t[12],m=t[13],y=t[14],f=t[15],x=a*l-o*n,b=a*s-r*n,_=a*d-i*n,v=o*s-r*l,w=o*d-i*l,k=r*d-i*s,T=c*m-p*h,A=c*y-u*h,S=c*f-g*h,C=p*y-u*m,L=p*f-g*m,E=u*f-g*y,z=x*E-b*L+_*C+v*S-w*A+k*T;return z?(z=1/z,e[0]=(l*E-s*L+d*C)*z,e[1]=(r*L-o*E-i*C)*z,e[2]=(m*k-y*w+f*v)*z,e[3]=(u*w-p*k-g*v)*z,e[4]=(s*S-n*E-d*A)*z,e[5]=(a*E-r*S+i*A)*z,e[6]=(y*_-h*k-f*b)*z,e[7]=(c*k-u*_+g*b)*z,e[8]=(n*L-l*S+d*T)*z,e[9]=(o*S-a*L-i*T)*z,e[10]=(h*w-m*_+f*x)*z,e[11]=(p*_-c*w-g*x)*z,e[12]=(l*A-n*C-s*T)*z,e[13]=(a*C-o*A+r*T)*z,e[14]=(m*b-h*v-y*x)*z,e[15]=(c*v-p*b+u*x)*z,e):null}},{}],255:[function(e,t){var a=e("./identity");t.exports=function(e,t,o,r){var i=t[0],n=t[1],l=t[2],s=r[0],d=r[1],c=r[2],p=o[0],u=o[1],g=o[2],h,m,y,f,x,b,_,v,w,k;return 1e-6>wa(i-p)&&1e-6>wa(n-u)&&1e-6>wa(l-g)?a(e):(_=i-p,v=n-u,w=l-g,k=1/re(_*_+v*v+w*w),_*=k,v*=k,w*=k,h=d*w-c*v,m=c*_-s*w,y=s*v-d*_,k=re(h*h+m*m+y*y),k?(k=1/k,h*=k,m*=k,y*=k):(h=0,m=0,y=0),f=v*y-w*m,x=w*h-_*y,b=_*m-v*h,k=re(f*f+x*x+b*b),k?(k=1/k,f*=k,x*=k,b*=k):(f=0,x=0,b=0),e[0]=h,e[1]=f,e[2]=_,e[3]=0,e[4]=m,e[5]=x,e[6]=v,e[7]=0,e[8]=y,e[9]=b,e[10]=w,e[11]=0,e[12]=-(h*i+m*n+y*l),e[13]=-(f*i+x*n+b*l),e[14]=-(_*i+v*n+w*l),e[15]=1,e)}},{"./identity":253}],256:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2],n=t[3],l=t[4],s=t[5],d=t[6],c=t[7],p=t[8],u=t[9],g=t[10],h=t[11],m=t[12],y=t[13],f=t[14],x=t[15],b=a[0],_=a[1],v=a[2],w=a[3];return e[0]=b*o+_*l+v*p+w*m,e[1]=b*r+_*s+v*u+w*y,e[2]=b*i+_*d+v*g+w*f,e[3]=b*n+_*c+v*h+w*x,b=a[4],_=a[5],v=a[6],w=a[7],e[4]=b*o+_*l+v*p+w*m,e[5]=b*r+_*s+v*u+w*y,e[6]=b*i+_*d+v*g+w*f,e[7]=b*n+_*c+v*h+w*x,b=a[8],_=a[9],v=a[10],w=a[11],e[8]=b*o+_*l+v*p+w*m,e[9]=b*r+_*s+v*u+w*y,e[10]=b*i+_*d+v*g+w*f,e[11]=b*n+_*c+v*h+w*x,b=a[12],_=a[13],v=a[14],w=a[15],e[12]=b*o+_*l+v*p+w*m,e[13]=b*r+_*s+v*u+w*y,e[14]=b*i+_*d+v*g+w*f,e[15]=b*n+_*c+v*h+w*x,e}},{}],257:[function(e,t){t.exports=function(e,t,a,o,r){var i=1/g(t/2),n=1/(o-r);return e[0]=i/a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+o)*n,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*o*n,e[15]=0,e}},{}],258:[function(e,t){t.exports=function(e,o,a,r){var i=r[0],n=r[1],l=r[2],d=re(i*i+n*n+l*l),p,u,g,h,m,f,b,_,v,w,k,T,A,S,C,L,E,I,D,P,O,R,j,B;return 1e-6>wa(d)?null:(d=1/d,i*=d,n*=d,l*=d,p=M(a),u=te(a),g=1-u,h=o[0],m=o[1],f=o[2],b=o[3],_=o[4],v=o[5],w=o[6],k=o[7],T=o[8],A=o[9],S=o[10],C=o[11],L=i*i*g+u,E=n*i*g+l*p,I=l*i*g-n*p,D=i*n*g-l*p,P=n*n*g+u,O=l*n*g+i*p,R=i*l*g+n*p,j=n*l*g-i*p,B=l*l*g+u,e[0]=h*L+_*E+T*I,e[1]=m*L+v*E+A*I,e[2]=f*L+w*E+S*I,e[3]=b*L+k*E+C*I,e[4]=h*D+_*P+T*O,e[5]=m*D+v*P+A*O,e[6]=f*D+w*P+S*O,e[7]=b*D+k*P+C*O,e[8]=h*R+_*j+T*B,e[9]=m*R+v*j+A*B,e[10]=f*R+w*j+S*B,e[11]=b*R+k*j+C*B,o!==e&&(e[12]=o[12],e[13]=o[13],e[14]=o[14],e[15]=o[15]),e)}},{}],259:[function(e,t){t.exports=function(e,t,a){var o=M(a),r=te(a),i=t[4],n=t[5],l=t[6],s=t[7],d=t[8],c=t[9],p=t[10],u=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*r+d*o,e[5]=n*r+c*o,e[6]=l*r+p*o,e[7]=s*r+u*o,e[8]=d*r-i*o,e[9]=c*r-n*o,e[10]=p*r-l*o,e[11]=u*r-s*o,e}},{}],260:[function(e,t){t.exports=function(e,t,a){var o=M(a),r=te(a),i=t[0],n=t[1],l=t[2],s=t[3],d=t[8],c=t[9],p=t[10],u=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*r-d*o,e[1]=n*r-c*o,e[2]=l*r-p*o,e[3]=s*r-u*o,e[8]=i*o+d*r,e[9]=n*o+c*r,e[10]=l*o+p*r,e[11]=s*o+u*r,e}},{}],261:[function(e,t){t.exports=function(e,t,a){var o=M(a),r=te(a),i=t[0],n=t[1],l=t[2],s=t[3],d=t[4],c=t[5],p=t[6],u=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*r+d*o,e[1]=n*r+c*o,e[2]=l*r+p*o,e[3]=s*r+u*o,e[4]=d*r-i*o,e[5]=c*r-n*o,e[6]=p*r-l*o,e[7]=u*r-s*o,e}},{}],262:[function(e,t){t.exports=function(e,t,a){var o=a[0],r=a[1],i=a[2];return e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e[3]=t[3]*o,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},{}],263:[function(e,t){t.exports=function(e,t,a){var o=a[0],r=a[1],i=a[2],n,l,s,d,c,p,u,g,h,m,y,f;return t===e?(e[12]=t[0]*o+t[4]*r+t[8]*i+t[12],e[13]=t[1]*o+t[5]*r+t[9]*i+t[13],e[14]=t[2]*o+t[6]*r+t[10]*i+t[14],e[15]=t[3]*o+t[7]*r+t[11]*i+t[15]):(n=t[0],l=t[1],s=t[2],d=t[3],c=t[4],p=t[5],u=t[6],g=t[7],h=t[8],m=t[9],y=t[10],f=t[11],e[0]=n,e[1]=l,e[2]=s,e[3]=d,e[4]=c,e[5]=p,e[6]=u,e[7]=g,e[8]=h,e[9]=m,e[10]=y,e[11]=f,e[12]=n*o+c*r+h*i+t[12],e[13]=l*o+p*r+m*i+t[13],e[14]=s*o+u*r+y*i+t[14],e[15]=d*o+g*r+f*i+t[15]),e}},{}],264:[function(e,t){t.exports=function(e,t){if(e===t){var a=t[1],o=t[2],r=t[3],i=t[6],n=t[7],l=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=a,e[6]=t[9],e[7]=t[13],e[8]=o,e[9]=i,e[11]=t[14],e[12]=r,e[13]=n,e[14]=l}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}},{}],265:[function(e,t){"use strict";t.exports=function(e,t){switch(t.length){case 0:break;case 1:e[0]=1/t[0];break;case 4:a(e,t);break;case 9:o(e,t);break;case 16:r(e,t);break;default:throw new Error("currently supports matrices up to 4x4");}return e};var a=e("gl-mat2/invert"),o=e("gl-mat3/invert"),r=e("gl-mat4/invert")},{"gl-mat2/invert":246,"gl-mat3/invert":247,"gl-mat4/invert":254}],266:[function(e,t,a){arguments[4][232][0].apply(a,arguments)},{barycentric:61,dup:232,"polytope-closest-point/lib/closest_point_2d.js":464}],267:[function(e,t,a){var o=e("glslify"),r=o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec4 m_position  = model * vec4(position, 1.0);\n  vec4 t_position  = view * m_position;\n  gl_Position      = projection * t_position;\n  f_color          = color;\n  f_normal         = normal;\n  f_data           = position;\n  f_eyeDirection   = eyePosition   - position;\n  f_lightDirection = lightPosition - position;\n  f_uv             = uv;\n}\n"]),i=o(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nvec3 normals(vec3 pos) {\n  vec3 fdx = dFdx(pos);\n  vec3 fdy = dFdy(pos);\n  return normalize(cross(fdx, fdy));\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular\n            , opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  vec3 normal = normals(f_data);\n\n  if (dot(N, normal) < 0.0) {\n    N = -N;\n  }\n\n  float specular = cookTorranceSpecular(L, V, N, roughness, fresnel);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),n=o(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}"]),l=o(["precision mediump float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),s=o(["precision mediump float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}"]),d=o(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5,0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),c=o(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}"]),p=o(["precision mediump float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]),u=o(["precision mediump float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}"]),g=o(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}"]),h=o(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor,1);\n}\n"]);a.meshShader={vertex:r,fragment:i,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},a.wireShader={vertex:n,fragment:l,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},a.pointShader={vertex:s,fragment:d,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},a.pickShader={vertex:c,fragment:p,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},a.pointPickShader={vertex:u,fragment:p,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},a.contourShader={vertex:g,fragment:h,attributes:[{name:"position",type:"vec3"}]}},{glslify:392}],268:[function(e,t){"use strict";function a(e,t,a,o,r,i,n,l,s,d,c,p,u,g,h,m,y,f,x,b,_,v,w,k,T,A,S){this.gl=e,this.cells=[],this.positions=[],this.intensity=[],this.texture=t,this.dirty=!0,this.triShader=a,this.lineShader=o,this.pointShader=r,this.pickShader=i,this.pointPickShader=n,this.contourShader=l,this.trianglePositions=s,this.triangleColors=c,this.triangleNormals=u,this.triangleUVs=p,this.triangleIds=d,this.triangleVAO=g,this.triangleCount=0,this.lineWidth=1,this.edgePositions=h,this.edgeColors=y,this.edgeUVs=f,this.edgeIds=m,this.edgeVAO=x,this.edgeCount=0,this.pointPositions=b,this.pointColors=v,this.pointUVs=w,this.pointSizes=k,this.pointIds=_,this.pointVAO=T,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=A,this.contourVAO=S,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this._model=O,this._view=O,this._projection=O,this._resolution=[1,1]}function o(e){for(var t=w({colormap:e,nshades:256,format:"rgba"}),a=new Uint8Array(1024),o=0,r;256>o;++o){r=t[o];for(var n=0;3>n;++n)a[4*o+n]=r[n];a[4*o+3]=255*r[3]}return v(a,[256,256,4],[4,0,1])}function r(e,t,a){for(var o=Array(t),r=0;r<t;++r)o[r]=0;for(var n=e.length,r=0,l;r<n;++r){l=e[r];for(var s=0;s<l.length;++s)o[l[s]]=a[r]}return o}function n(e){for(var t=e.length,a=Array(t),o=0;o<t;++o)a[o]=e[o][2];return a}function l(e){var t=g(e,L.vertex,L.fragment);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t.attributes.normal.location=4,t}function s(e){var t=g(e,E.vertex,E.fragment);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t}function d(e){var t=g(e,z.vertex,z.fragment);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t.attributes.pointSize.location=4,t}function c(e){var t=g(e,I.vertex,I.fragment);return t.attributes.position.location=0,t.attributes.id.location=1,t}function p(e){var t=g(e,D.vertex,D.fragment);return t.attributes.position.location=0,t.attributes.id.location=1,t.attributes.pointSize.location=4,t}function u(e){var t=g(e,P.vertex,P.fragment);return t.attributes.position.location=0,t}var g=e("gl-shader"),h=e("gl-buffer"),m=e("gl-vao"),y=e("gl-texture2d"),x=e("normals"),b=e("gl-mat4/multiply"),_=e("gl-mat4/invert"),v=e("ndarray"),w=e("colormap"),T=e("simplicial-complex-contour"),A=e("typedarray-pool"),S=e("./lib/shaders"),C=e("./lib/closest-point"),L=S.meshShader,E=S.wireShader,z=S.pointShader,I=S.pickShader,D=S.pointPickShader,P=S.contourShader,O=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],R=a.prototype;R.isOpaque=function(){return 1<=this.opacity},R.isTransparent=function(){return 1>this.opacity},R.pickSlots=1,R.setPickBase=function(e){this.pickId=e},R.highlight=function(e){if(!e||!this.contourEnable)return void(this.contourCount=0);for(var t=T(this.cells,this.intensity,e.intensity),o=t.cells,r=t.vertexIds,n=t.vertexWeights,l=o.length,s=A.mallocFloat32(6*l),d=0,p=0,u;p<l;++p){u=o[p];for(var g=0,h;2>g;++g){h=u[0],2===u.length&&(h=u[g]);for(var m=r[h][0],a=r[h][1],y=n[h],f=this.positions[m],x=this.positions[a],b=0;3>b;++b)s[d++]=y*f[b]+(1-y)*x[b]}}this.contourCount=0|d/3,this.contourPositions.update(s.subarray(0,d)),A.free(s)},R.update=function(e){e=e||{};var t=this.gl;this.dirty=!0,"contourEnable"in e&&(this.contourEnable=e.contourEnable),"contourColor"in e&&(this.contourColor=e.contourColor),"lineWidth"in e&&(this.lineWidth=e.lineWidth),"lightPosition"in e&&(this.lightPosition=e.lightPosition),"opacity"in e&&(this.opacity=e.opacity),"ambient"in e&&(this.ambientLight=e.ambient),"diffuse"in e&&(this.diffuseLight=e.diffuse),"specular"in e&&(this.specularLight=e.specular),"roughness"in e&&(this.roughness=e.roughness),"fresnel"in e&&(this.fresnel=e.fresnel),e.texture?(this.texture.dispose(),this.texture=y(t,e.texture)):e.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=t.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=t.LINEAR,this.texture.setPixels(o(e.colormap)),this.texture.generateMipmap());var a=e.cells,l=e.positions;if(l&&a){var s=[],d=[],u=[],g=[],h=[],m=[],b=[],_=[],w=[],T=[],A=[],S=[],C=[],L=[];this.cells=a,this.positions=l;var E=e.vertexNormals,z=e.cellNormals,I=void 0===e.vertexNormalsEpsilon?1e-6:e.vertexNormalsEpsilon,D=void 0===e.faceNormalsEpsilon?1e-6:e.faceNormalsEpsilon;e.useFacetNormals&&!z&&(z=x.faceNormals(a,l,D)),z||E||(E=x.vertexNormals(a,l,I));var P=e.vertexColors,O=e.cellColors,R=e.meshColor||[1,1,1,1],M=e.vertexUVs,B=e.vertexIntensity,F=e.cellUVs,N=e.cellIntensity,V=1/0,U=-Infinity;if(!M&&!F)if(B){if(e.vertexIntensityBounds)V=+e.vertexIntensityBounds[0],U=+e.vertexIntensityBounds[1];else for(var H=0,G;H<B.length;++H)G=B[H],V=ie(V,G),U=va(U,G);}else if(N)for(var H=0,G;H<N.length;++H)G=N[H],V=ie(V,G),U=va(U,G);else for(var H=0,G;H<l.length;++H)G=l[H][2],V=ie(V,G),U=va(U,G);this.intensity=B?B:N?r(a,l.length,N):n(l);var Y=e.pointSizes,W=e.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]];for(var H=0,X;H<l.length;++H){X=l[H];for(var Z=0;3>Z;++Z)!isNaN(X[Z])&&isFinite(X[Z])&&(this.bounds[0][Z]=ie(this.bounds[0][Z],X[Z]),this.bounds[1][Z]=va(this.bounds[1][Z],X[Z]))}var $=0,J=0,K=0;fill_loop:for(var H=0,Q;H<a.length;++H)switch(Q=a[H],Q.length){case 1:for(var ee=Q[0],X=l[ee],Z=0;3>Z;++Z)if(isNaN(X[Z])||!isFinite(X[Z]))continue fill_loop;T.push(X[0],X[1],X[2]);var te;te=P?P[ee]:O?O[H]:R,3===te.length?A.push(te[0],te[1],te[2],1):A.push(te[0],te[1],te[2],te[3]);var ae;ae=M?M[ee]:B?[(B[ee]-V)/(U-V),0]:F?F[H]:N?[(N[H]-V)/(U-V),0]:[(X[2]-V)/(U-V),0],S.push(ae[0],ae[1]),Y?C.push(Y[ee]):C.push(W),L.push(H),K+=1;break;case 2:for(var Z=0;2>Z;++Z)for(var ee=Q[Z],X=l[ee],oe=0;3>oe;++oe)if(isNaN(X[oe])||!isFinite(X[oe]))continue fill_loop;for(var Z=0;2>Z;++Z){var ee=Q[Z],X=l[ee];m.push(X[0],X[1],X[2]);var te;te=P?P[ee]:O?O[H]:R,3===te.length?b.push(te[0],te[1],te[2],1):b.push(te[0],te[1],te[2],te[3]);var ae;ae=M?M[ee]:B?[(B[ee]-V)/(U-V),0]:F?F[H]:N?[(N[H]-V)/(U-V),0]:[(X[2]-V)/(U-V),0],_.push(ae[0],ae[1]),w.push(H)}J+=1;break;case 3:for(var Z=0;3>Z;++Z)for(var ee=Q[Z],X=l[ee],oe=0;3>oe;++oe)if(isNaN(X[oe])||!isFinite(X[oe]))continue fill_loop;for(var Z=0;3>Z;++Z){var ee=Q[Z],X=l[ee];s.push(X[0],X[1],X[2]);var te;te=P?P[ee]:O?O[H]:R,3===te.length?d.push(te[0],te[1],te[2],1):d.push(te[0],te[1],te[2],te[3]);var ae;ae=M?M[ee]:B?[(B[ee]-V)/(U-V),0]:F?F[H]:N?[(N[H]-V)/(U-V),0]:[(X[2]-V)/(U-V),0],g.push(ae[0],ae[1]);var re;re=E?E[ee]:z[H],u.push(re[0],re[1],re[2]),h.push(H)}$+=1;break;default:}this.pointCount=K,this.edgeCount=J,this.triangleCount=$,this.pointPositions.update(T),this.pointColors.update(A),this.pointUVs.update(S),this.pointSizes.update(C),this.pointIds.update(new Uint32Array(L)),this.edgePositions.update(m),this.edgeColors.update(b),this.edgeUVs.update(_),this.edgeIds.update(new Uint32Array(w)),this.trianglePositions.update(s),this.triangleColors.update(d),this.triangleUVs.update(g),this.triangleNormals.update(u),this.triangleIds.update(new Uint32Array(h))}},R.drawTransparent=R.draw=function(e){e=e||{};for(var t=this.gl,a=e.model||O,o=e.view||O,r=e.projection||O,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;3>l;++l)n[0][l]=va(n[0][l],this.clipBounds[0][l]),n[1][l]=ie(n[1][l],this.clipBounds[1][l]);var d={model:a,view:o,projection:r,clipBounds:n,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,contourColor:this.contourColor,texture:0};this.texture.bind(0);var c=Array(16);b(c,d.view,d.model),b(c,d.projection,c),_(c,c);for(var l=0;3>l;++l)d.eyePosition[l]=c[12+l]/c[15];for(var p=c[15],l=0;3>l;++l)p+=this.lightPosition[l]*c[4*l+3];for(var l=0,u;3>l;++l){u=c[12+l];for(var g=0;3>g;++g)u+=c[4*g+l]*this.lightPosition[g];d.lightPosition[l]=u/p}if(0<this.triangleCount){var h=this.triShader;h.bind(),h.uniforms=d,this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}if(0<this.edgeCount&&0<this.lineWidth){var h=this.lineShader;h.bind(),h.uniforms=d,this.edgeVAO.bind(),t.lineWidth(this.lineWidth),t.drawArrays(t.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()}if(0<this.pointCount){var h=this.pointShader;h.bind(),h.uniforms=d,this.pointVAO.bind(),t.drawArrays(t.POINTS,0,this.pointCount),this.pointVAO.unbind()}if(this.contourEnable&&0<this.contourCount&&0<this.contourLineWidth){var h=this.contourShader;h.bind(),h.uniforms=d,this.contourVAO.bind(),t.drawArrays(t.LINES,0,this.contourCount),this.contourVAO.unbind()}},R.drawPick=function(e){e=e||{};for(var t=this.gl,a=e.model||O,o=e.view||O,r=e.projection||O,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;3>l;++l)n[0][l]=va(n[0][l],this.clipBounds[0][l]),n[1][l]=ie(n[1][l],this.clipBounds[1][l]);this._model=[].slice.call(a),this._view=[].slice.call(o),this._projection=[].slice.call(r),this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];var s={model:a,view:o,projection:r,clipBounds:n,pickId:this.pickId/255},d=this.pickShader;if(d.bind(),d.uniforms=s,0<this.triangleCount&&(this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),0<this.edgeCount&&(this.edgeVAO.bind(),t.lineWidth(this.lineWidth),t.drawArrays(t.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),0<this.pointCount){var d=this.pointPickShader;d.bind(),d.uniforms=s,this.pointVAO.bind(),t.drawArrays(t.POINTS,0,this.pointCount),this.pointVAO.unbind()}},R.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;for(var t=e.value[0]+256*e.value[1]+65536*e.value[2],a=this.cells[t],o=this.positions,r=Array(a.length),n=0;n<a.length;++n)r[n]=o[a[n]];var l=C(r,[e.coord[0],this._resolution[1]-e.coord[1]],this._model,this._view,this._projection,this._resolution);if(!l)return null;for(var s=l[2],d=0,n=0;n<a.length;++n)d+=s[n]*this.intensity[a[n]];return{position:l[1],index:a[l[0]],cell:a,cellId:t,intensity:d,dataCoordinate:this.positions[a[l[0]]]}},R.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},t.exports=function(e,t){1===arguments.length&&(t=e,e=t.gl);var o=e.getExtension("OES_standard_derivatives")||e.getExtension("MOZ_OES_standard_derivatives")||e.getExtension("WEBKIT_OES_standard_derivatives");if(!o)throw new Error("derivatives not supported");var r=l(e),i=s(e),n=d(e),g=c(e),f=p(e),x=u(e),b=y(e,v(new Uint8Array([255,255,255,255]),[1,1,4]));b.generateMipmap(),b.minFilter=e.LINEAR_MIPMAP_LINEAR,b.magFilter=e.LINEAR;var _=h(e),w=h(e),k=h(e),T=h(e),A=h(e),S=m(e,[{buffer:_,type:e.FLOAT,size:3},{buffer:A,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:w,type:e.FLOAT,size:4},{buffer:k,type:e.FLOAT,size:2},{buffer:T,type:e.FLOAT,size:3}]),C=h(e),L=h(e),E=h(e),z=h(e),I=m(e,[{buffer:C,type:e.FLOAT,size:3},{buffer:z,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:L,type:e.FLOAT,size:4},{buffer:E,type:e.FLOAT,size:2}]),D=h(e),P=h(e),O=h(e),R=h(e),M=h(e),j=m(e,[{buffer:D,type:e.FLOAT,size:3},{buffer:M,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:P,type:e.FLOAT,size:4},{buffer:O,type:e.FLOAT,size:2},{buffer:R,type:e.FLOAT,size:1}]),B=h(e),F=m(e,[{buffer:B,type:e.FLOAT,size:3}]),N=new a(e,b,r,i,n,g,f,x,_,A,w,k,T,S,C,z,L,E,I,D,M,P,O,R,j,B,F);return N.update(t),N}},{"./lib/closest-point":266,"./lib/shaders":267,colormap:114,"gl-buffer":230,"gl-mat4/invert":254,"gl-mat4/multiply":256,"gl-shader":288,"gl-texture2d":305,"gl-vao":310,ndarray:433,normals:436,"simplicial-complex-contour":494,"typedarray-pool":521}],269:[function(e,t){"use strict";function a(e,t,a){this.plot=e,this.vbo=t,this.shader=a}t.exports=function(e){var t=e.gl,n=o(t,[0,0,0,1,1,0,1,1]),l=r(t,i.boxVert,i.lineFrag);return new a(e,n,l)};var o=e("gl-buffer"),r=e("gl-shader"),i=e("./shaders"),n=a.prototype;n.bind=function(){var e=this.shader;this.vbo.bind(),this.shader.bind(),e.attributes.coord.pointer(),e.uniforms.screenBox=this.plot.screenBox},n.drawBox=function(){var e=[0,0],t=[0,0];return function(a,o,r,i,n){var l=this.plot,s=this.shader,d=l.gl;e[0]=a,e[1]=o,t[0]=r,t[1]=i,s.uniforms.lo=e,s.uniforms.hi=t,s.uniforms.color=n,d.drawArrays(d.TRIANGLE_STRIP,0,4)}}(),n.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":272,"gl-buffer":230,"gl-shader":288}],270:[function(e,t){"use strict";function a(e,t,a,o){this.plot=e,this.vbo=t,this.shader=a,this.tickShader=o,this.ticks=[[],[]]}function o(e,t){return e-t}t.exports=function(e){var t=e.gl,o=r(t),n=i(t,l.gridVert,l.gridFrag),s=i(t,l.tickVert,l.gridFrag),d=new a(e,o,n,s);return d};var r=e("gl-buffer"),i=e("gl-shader"),n=e("binary-search-bounds"),l=e("./shaders"),s=a.prototype;s.draw=function(){var e=[0,0],t=[0,0],a=[0,0];return function(){for(var o=this.plot,r=this.vbo,n=this.shader,l=this.ticks,s=o.gl,d=o._tickBounds,c=o.dataBox,p=o.viewBox,u=o.gridLineWidth,g=o.gridLineColor,h=o.gridLineEnable,m=o.pixelRatio,y=0;2>y;++y){var f=d[y],x=d[y+2],b=.5*(c[y+2]+c[y]),_=c[y+2]-c[y];t[y]=2*(x-f)/_,e[y]=2*(f-b)/_}n.bind(),r.bind(),n.attributes.dataCoord.pointer(),n.uniforms.dataShift=e,n.uniforms.dataScale=t;for(var v=0,y=0;2>y;++y){a[0]=a[1]=0,a[y]=1,n.uniforms.dataAxis=a,n.uniforms.lineWidth=u[y]/(p[y+2]-p[y])*m,n.uniforms.color=g[y];var w=6*l[y].length;h[y]&&w&&s.drawArrays(s.TRIANGLES,v,w),v+=w}}}(),s.drawTickMarks=function(){var e=[0,0],t=[0,0],a=[1,0],r=[0,1],l=[0,0],s=[0,0];return function(){for(var d=this.plot,c=this.vbo,p=this.tickShader,u=this.ticks,g=d.gl,h=d._tickBounds,m=d.dataBox,y=d.viewBox,f=d.pixelRatio,x=d.screenBox,b=x[2]-x[0],_=x[3]-x[1],v=y[2]-y[0],w=y[3]-y[1],k=0;2>k;++k){var T=h[k],A=h[k+2],S=.5*(m[k+2]+m[k]),C=m[k+2]-m[k];t[k]=2*(A-T)/C,e[k]=2*(T-S)/C}t[0]*=v/b,e[0]*=v/b,t[1]*=w/_,e[1]*=w/_,p.bind(),c.bind(),p.attributes.dataCoord.pointer();var L=p.uniforms;L.dataShift=e,L.dataScale=t;var E=d.tickMarkLength,z=d.tickMarkWidth,I=d.tickMarkColor,D=6*u[0].length,P=ie(n.ge(u[0],(m[0]-h[0])/(h[2]-h[0]),o),u[0].length),O=ie(n.gt(u[0],(m[2]-h[0])/(h[2]-h[0]),o),u[0].length),R=0+6*P,M=6*va(0,O-P),j=ie(n.ge(u[1],(m[1]-h[1])/(h[3]-h[1]),o),u[1].length),B=ie(n.gt(u[1],(m[3]-h[1])/(h[3]-h[1]),o),u[1].length),F=D+6*j,N=6*va(0,B-j);l[0]=2*(y[0]-E[1])/b-1,l[1]=(y[3]+y[1])/_-1,s[0]=E[1]*f/b,s[1]=z[1]*f/_,N&&(L.color=I[1],L.tickScale=s,L.dataAxis=r,L.screenOffset=l,g.drawArrays(g.TRIANGLES,F,N)),l[0]=(y[2]+y[0])/b-1,l[1]=2*(y[1]-E[0])/_-1,s[0]=z[0]*f/b,s[1]=E[0]*f/_,M&&(L.color=I[0],L.tickScale=s,L.dataAxis=a,L.screenOffset=l,g.drawArrays(g.TRIANGLES,R,M)),l[0]=2*(y[2]+E[3])/b-1,l[1]=(y[3]+y[1])/_-1,s[0]=E[3]*f/b,s[1]=z[3]*f/_,N&&(L.color=I[3],L.tickScale=s,L.dataAxis=r,L.screenOffset=l,g.drawArrays(g.TRIANGLES,F,N)),l[0]=(y[2]+y[0])/b-1,l[1]=2*(y[3]+E[2])/_-1,s[0]=z[2]*f/b,s[1]=E[2]*f/_,M&&(L.color=I[2],L.tickScale=s,L.dataAxis=a,L.screenOffset=l,g.drawArrays(g.TRIANGLES,R,M))}}(),s.update=function(){var e=[1,1,-1,-1,1,-1],t=[1,-1,1,1,-1,-1];return function(a){for(var o=a.ticks,r=a.bounds,n=new Float32Array(18*(o[0].length+o[1].length)),l=this.plot.zeroLineEnable,s=0,d=[[],[]],c=0;2>c;++c)for(var p=d[c],u=o[c],g=r[c],h=r[c+2],m=0,y;m<u.length;++m){y=(u[m].x-g)/(h-g),p.push(y);for(var f=0;6>f;++f)n[s++]=y,n[s++]=e[f],n[s++]=t[f]}this.ticks=d,this.vbo.update(n)}}(),s.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":272,"binary-search-bounds":274,"gl-buffer":230,"gl-shader":288}],271:[function(e,t){"use strict";function a(e,t,a){this.plot=e,this.vbo=t,this.shader=a}t.exports=function(e){var t=e.gl,n=o(t,[-1,-1,-1,1,1,-1,1,1]),l=r(t,i.lineVert,i.lineFrag),s=new a(e,n,l);return s};var o=e("gl-buffer"),r=e("gl-shader"),i=e("./shaders"),n=a.prototype;n.bind=function(){var e=this.shader;this.vbo.bind(),this.shader.bind(),e.attributes.coord.pointer(),e.uniforms.screenBox=this.plot.screenBox},n.drawLine=function(){var e=[0,0],t=[0,0];return function(a,o,r,i,n,l){var s=this.plot,d=this.shader,c=s.gl;e[0]=a,e[1]=o,t[0]=r,t[1]=i,d.uniforms.start=e,d.uniforms.end=t,d.uniforms.width=n*s.pixelRatio,d.uniforms.color=l,c.drawArrays(c.TRIANGLE_STRIP,0,4)}}(),n.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":272,"gl-buffer":230,"gl-shader":288}],272:[function(e,t){"use strict";var a=e("glslify"),o=a(["precision lowp float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = vec4(color.xyz * color.w, color.w);\n}\n"]);t.exports={lineVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 start, end;\nuniform float width;\n\nvec2 perp(vec2 v) {\n  return vec2(v.y, -v.x);\n}\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  vec2 delta = normalize(perp(start - end));\n  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));\n  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);\n}\n"]),lineFrag:o,textVert:a(["#define GLSLIFY 1\nattribute vec3 textCoordinate;\n\nuniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;\nuniform float angle;\n\nvoid main() {\n  float dataOffset  = textCoordinate.z;\n  vec2 glyphOffset  = textCoordinate.xy;\n  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +\n    glyphMatrix * glyphOffset * textScale + screenOffset;\n  gl_Position = vec4(screenCoordinate, 0, 1);\n}\n"]),textFrag:o,gridVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale;\nuniform float lineWidth;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;\n  gl_Position = vec4(pos, 0, 1);\n}\n"]),gridFrag:o,boxVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 lo, hi;\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);\n}\n"]),tickVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);\n}\n"])}},{glslify:392}],273:[function(e,t){"use strict";function a(e,t,a){this.plot=e,this.vbo=t,this.shader=a,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}t.exports=function(e){var t=e.gl,i=o(t),n=r(t,s.textVert,s.textFrag),l=new a(e,i,n);return l};var o=e("gl-buffer"),r=e("gl-shader"),n=e("text-cache"),l=e("binary-search-bounds"),s=e("./shaders"),d=a.prototype;d.drawTicks=function(){var e=[0,0],t=[0,0],a=[0,0];return function(o){var r=this.plot,i=this.shader,n=this.tickX[o],s=this.tickOffset[o],d=r.gl,c=r.viewBox,p=r.dataBox,u=r.screenBox,g=r.pixelRatio,h=r.tickEnable,m=r.tickPad,y=r.tickColor,f=r.tickAngle,x=r.labelEnable,b=r.labelPad,_=r.labelColor,v=r.labelAngle,w=this.labelOffset[o],k=this.labelCount[o],T=l.lt(n,p[o]),A=l.le(n,p[o+2]);e[0]=e[1]=0,e[o]=1,t[o]=(c[2+o]+c[o])/(u[2+o]-u[o])-1;var S=2/u[2+(1^o)]-u[1^o];t[1^o]=S*c[1^o]-1,h[o]&&(t[1^o]-=S*g*m[o],T<A&&s[A]>s[T]&&(i.uniforms.dataAxis=e,i.uniforms.screenOffset=t,i.uniforms.color=y[o],i.uniforms.angle=f[o],d.drawArrays(d.TRIANGLES,s[T],s[A]-s[T]))),x[o]&&k&&(t[1^o]-=S*g*b[o],i.uniforms.dataAxis=a,i.uniforms.screenOffset=t,i.uniforms.color=_[o],i.uniforms.angle=v[o],d.drawArrays(d.TRIANGLES,w,k)),t[1^o]=S*c[2+(1^o)]-1,h[o+2]&&(t[1^o]+=S*g*m[o+2],T<A&&s[A]>s[T]&&(i.uniforms.dataAxis=e,i.uniforms.screenOffset=t,i.uniforms.color=y[o+2],i.uniforms.angle=f[o+2],d.drawArrays(d.TRIANGLES,s[T],s[A]-s[T]))),x[o+2]&&k&&(t[1^o]+=S*g*b[o+2],i.uniforms.dataAxis=a,i.uniforms.screenOffset=t,i.uniforms.color=_[o+2],i.uniforms.angle=v[o+2],d.drawArrays(d.TRIANGLES,w,k))}}(),d.drawTitle=function(){var e=[0,0],t=[0,0];return function(){var a=this.plot,o=this.shader,r=a.gl,n=a.screenBox,l=a.titleCenter,s=a.titleAngle,d=a.titleColor,c=a.pixelRatio;if(this.titleCount){for(var p=0;2>p;++p)t[p]=2*(l[p]*c-n[p])/(n[2+p]-n[p])-1;o.bind(),o.uniforms.dataAxis=e,o.uniforms.screenOffset=t,o.uniforms.angle=s,o.uniforms.color=d,r.drawArrays(r.TRIANGLES,this.titleOffset,this.titleCount)}}}(),d.bind=function(){var e=[0,0],t=[0,0],a=[0,0];return function(){var o=this.plot,r=this.shader,n=o._tickBounds,l=o.dataBox,s=o.screenBox,d=o.viewBox;r.bind();for(var c=0;2>c;++c){var p=n[c],u=n[c+2],g=.5*(l[c+2]+l[c]),h=l[c+2]-l[c],m=d[c],y=d[c+2],f=y-m,x=s[c],b=s[c+2],_=b-x;t[c]=2*(u-p)/h*f/_,e[c]=2*(p-g)/h*f/_}a[1]=2*o.pixelRatio/(s[3]-s[1]),a[0]=a[1]*(s[3]-s[1])/(s[2]-s[0]),r.uniforms.dataScale=t,r.uniforms.dataShift=e,r.uniforms.textScale=a,this.vbo.bind(),r.attributes.textCoordinate.pointer()}}(),d.update=function(e){var t=[],a=e.ticks,o=e.bounds,l,s,d,c,p;for(p=0;2>p;++p){var u=[ea(t.length/3)],g=[-Infinity],h=a[p];for(l=0;l<h.length;++l){var m=h[l],y=m.x,f=m.text,x=m.font||"sans-serif";c=m.fontSize||12;for(var b=1/(o[p+2]-o[p]),_=o[p],v=f.split("\n"),w=0;w<v.length;w++)for(d=n(x,v[w]).data,s=0;s<d.length;s+=2)t.push(d[s]*c,-d[s+1]*c-1.2*(w*c),(y-_)*b);u.push(ea(t.length/3)),g.push(y)}this.tickOffset[p]=u,this.tickX[p]=g}for(p=0;2>p;++p){for(this.labelOffset[p]=ea(t.length/3),d=n(e.labelFont[p],e.labels[p],{textAlign:"center"}).data,c=e.labelSize[p],l=0;l<d.length;l+=2)t.push(d[l]*c,-d[l+1]*c,0);this.labelCount[p]=ea(t.length/3)-this.labelOffset[p]}for(this.titleOffset=ea(t.length/3),d=n(e.titleFont,e.title).data,c=e.titleSize,l=0;l<d.length;l+=2)t.push(d[l]*c,-d[l+1]*c,0);this.titleCount=ea(t.length/3)-this.titleOffset,this.vbo.update(t)},d.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":272,"binary-search-bounds":274,"gl-buffer":230,"gl-shader":288,"text-cache":512}],274:[function(e,t,a){arguments[4][99][0].apply(a,arguments)},{dup:99}],275:[function(e,t){"use strict";function a(e,t){this.gl=e,this.pickBuffer=t,this.screenBox=[0,0,e.drawingBufferWidth,e.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Sa/2,0,3*Sa/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-Infinity,-Infinity],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}function o(e){for(var t=e.slice(),a=0;a<t.length;++a)t[a]=t[a].slice();return t}function r(e,t){return e.x-t.x}t.exports=function(e){var t=e.gl,o=i(t,[t.drawingBufferWidth,t.drawingBufferHeight]),r=new a(t,o);return r.grid=n(r),r.text=l(r),r.line=s(r),r.box=d(r),r.update(e),r};var i=e("gl-select-static"),n=e("./lib/grid"),l=e("./lib/text"),s=e("./lib/line"),d=e("./lib/box"),c=a.prototype;c.setDirty=function(){this.dirty=this.pickDirty=!0},c.setOverlayDirty=function(){this.dirty=!0},c.nextDepthValue=function(){return this._depthCounter++/65536},c.draw=function(){return function(){var e=this.gl,t=this.screenBox,a=this.viewBox,o=this.dataBox,r=this.pixelRatio,n=this.grid,l=this.line,s=this.text,d=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),!!this.dirty){if(this.dirty=!1,e.bindFramebuffer(e.FRAMEBUFFER,null),e.enable(e.SCISSOR_TEST),e.disable(e.DEPTH_TEST),e.depthFunc(e.LESS),e.depthMask(!1),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD,e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this.borderColor){e.scissor(t[0],t[1],t[2]-t[0],t[3]-t[1]);var c=this.borderColor;e.clearColor(c[0]*c[3],c[1]*c[3],c[2]*c[3],c[3]),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}e.scissor(a[0],a[1],a[2]-a[0],a[3]-a[1]),e.viewport(a[0],a[1],a[2]-a[0],a[3]-a[1]);var p=this.backgroundColor;e.clearColor(p[0]*p[3],p[1]*p[3],p[2]*p[3],p[3]),e.clear(e.COLOR_BUFFER_BIT),n.draw();var u=this.zeroLineEnable,g=this.zeroLineColor,h=this.zeroLineWidth;if(u[0]||u[1]){l.bind();for(var m=0;2>m;++m)if(u[m]&&0>=o[m]&&0<=o[m+2]){var y=t[m]-o[m]*(t[m+2]-t[m])/(o[m+2]-o[m]);0==m?l.drawLine(y,t[1],y,t[3],h[m],g[m]):l.drawLine(t[0],y,t[2],y,h[m],g[m])}}for(var m=0;m<d.length;++m)d[m].draw();e.viewport(t[0],t[1],t[2]-t[0],t[3]-t[1]),e.scissor(t[0],t[1],t[2]-t[0],t[3]-t[1]),this.grid.drawTickMarks(),l.bind();var f=this.borderLineEnable,x=this.borderLineWidth,b=this.borderLineColor;f[1]&&l.drawLine(a[0],a[1]-.5*x[1]*r,a[0],a[3]+.5*x[3]*r,x[1],b[1]),f[0]&&l.drawLine(a[0]-.5*x[0]*r,a[1],a[2]+.5*x[2]*r,a[1],x[0],b[0]),f[3]&&l.drawLine(a[2],a[1]-.5*x[1]*r,a[2],a[3]+.5*x[3]*r,x[3],b[3]),f[2]&&l.drawLine(a[0]-.5*x[0]*r,a[3],a[2]+.5*x[2]*r,a[3],x[2],b[2]),s.bind();for(var m=0;2>m;++m)s.drawTicks(m);this.titleEnable&&s.drawTitle();for(var _=this.overlays,m=0;m<_.length;++m)_[m].draw();e.disable(e.SCISSOR_TEST),e.disable(e.BLEND),e.depthMask(!0)}}}(),c.drawPick=function(){return function(){if(!this.static){var e=this.pickBuffer,t=this.gl;this._pickTimeout=null,e.begin();for(var a=1,o=this.objects,r=0;r<o.length;++r)a=o[r].drawPick(a);e.end()}}}(),c.pick=function(){return function(e,t){if(!this.static){var a=this.pixelRatio,o=this.pickPixelRatio,r=this.viewBox,n=0|R((e-r[0]/a)*o),l=0|R((t-r[1]/a)*o),s=this.pickBuffer.query(n,l,this.pickRadius);if(!s)return null;for(var d=s.id+(s.value[0]<<8)+(s.value[1]<<16)+(s.value[2]<<24),c=this.objects,p=0,u;p<c.length;++p)if(u=c[p].pick(n,l,d),u)return u;return null}}}(),c.setScreenBox=function(e){var t=this.screenBox,a=this.pixelRatio;t[0]=0|R(e[0]*a),t[1]=0|R(e[1]*a),t[2]=0|R(e[2]*a),t[3]=0|R(e[3]*a),this.setDirty()},c.setDataBox=function(e){var t=this.dataBox,a=t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3];a&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],this.setDirty())},c.setViewBox=function(e){var t=this.pixelRatio,a=this.viewBox;a[0]=0|R(e[0]*t),a[1]=0|R(e[1]*t),a[2]=0|R(e[2]*t),a[3]=0|R(e[3]*t);var o=this.pickPixelRatio;this.pickBuffer.shape=[0|R((e[2]-e[0])*o),0|R((e[3]-e[1])*o)],this.setDirty()},c.update=function(e){e=e||{};var t=this.gl;this.pixelRatio=e.pixelRatio||1;var a=this.pixelRatio;this.pickPixelRatio=va(a,1),this.setScreenBox(e.screenBox||[0,0,t.drawingBufferWidth/a,t.drawingBufferHeight/a]);this.screenBox;this.setViewBox(e.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/a,.125*(this.screenBox[3]-this.screenBox[1])/a,.875*(this.screenBox[2]-this.screenBox[0])/a,.875*(this.screenBox[3]-this.screenBox[1])/a]);var n=this.viewBox,l=(n[2]-n[0])/(n[3]-n[1]);this.setDataBox(e.dataBox||[-10,-10/l,10,10/l]),this.borderColor=!1!==e.borderColor&&(e.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(e.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(e.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(e.gridLineWidth||[1,1]).slice(),this.gridLineColor=o(e.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(e.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(e.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=o(e.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(e.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(e.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=o(e.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(e.titleCenter||[.5*(n[0]+n[2])/a,(n[3]+120)/a]).slice(),this.titleEnable=!("titleEnable"in e)||!!e.titleEnable,this.titleAngle=e.titleAngle||0,this.titleColor=(e.titleColor||[0,0,0,1]).slice(),this.labelPad=(e.labelPad||[15,15,15,15]).slice(),this.labelAngle=(e.labelAngle||[0,Sa/2,0,3*Sa/2]).slice(),this.labelEnable=(e.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=o(e.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(e.tickPad||[15,15,15,15]).slice(),this.tickAngle=(e.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(e.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=o(e.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(e.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(e.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=o(e.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var s=e.ticks||[[],[]],d=this._tickBounds;d[0]=d[1]=1/0,d[2]=d[3]=-Infinity;for(var c=0,p;2>c;++c)(p=s[c].slice(0),0!==p.length)&&(p.sort(r),d[c]=ie(d[c],p[0].x),d[c+2]=va(d[c+2],p[p.length-1].x));this.grid.update({bounds:d,ticks:s}),this.text.update({bounds:d,ticks:s,labels:e.labels||["x","y"],labelSize:e.labelSize||[12,12],labelFont:e.labelFont||["sans-serif","sans-serif"],title:e.title||"",titleSize:e.titleSize||18,titleFont:e.titleFont||"sans-serif"}),this.static=!!e.static,this.setDirty()},c.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var e=this.objects.length-1;0<=e;--e)this.objects[e].dispose();this.objects.length=0;for(var e=this.overlays.length-1;0<=e;--e)this.overlays[e].dispose();this.overlays.length=0,this.gl=null},c.addObject=function(e){0>this.objects.indexOf(e)&&(this.objects.push(e),this.setDirty())},c.removeObject=function(e){for(var t=this.objects,a=0;a<t.length;++a)if(t[a]===e){t.splice(a,1),this.setDirty();break}},c.addOverlay=function(e){0>this.overlays.indexOf(e)&&(this.overlays.push(e),this.setOverlayDirty())},c.removeOverlay=function(e){for(var t=this.overlays,a=0;a<t.length;++a)if(t[a]===e){t.splice(a,1),this.setOverlayDirty();break}}},{"./lib/box":269,"./lib/grid":270,"./lib/line":271,"./lib/text":273,"gl-select-static":287}],276:[function(e,t){var a=e("glslify"),o=e("gl-shader"),r=a(["precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}"]),i=a(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}"]);t.exports=function(e){return o(e,r,i,null,[{name:"position",type:"vec2"}])}},{"gl-shader":288,glslify:392}],277:[function(e,t){"use strict";function a(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function o(e,t){var a=null;try{a=e.getContext("webgl",t),a||(a=e.getContext("experimental-webgl",t))}catch(t){return null}return a}function r(e){var t=R(P(wa(e))/P(10));if(0>t){var a=R(_a(10,-t));return ae(e*a)/a}if(0<t){var a=R(_a(10,t));return ae(e/a)*a}return ae(e)}function i(e){return"boolean"!=typeof e||e}t.exports=function(e){function t(){if(!w&&W.autoResize){var e=T.parentNode,t=1,a=1;e&&e!==document.body?(t=e.clientWidth,a=e.clientHeight):(t=window.innerWidth,a=window.innerHeight);var o=0|ae(t*W.pixelRatio),r=0|ae(a*W.pixelRatio);if(o!==T.width||r!==T.height){T.width=o,T.height=r;var i=T.style;i.position=i.position||"absolute",i.left="0px",i.top="0px",i.width=t+"px",i.height=a+"px",V=!0}}}function f(){for(var e=M.length,t=N.length,a=0;a<t;++a)F[a]=0;obj_loop:for(var a=0;a<e;++a){var o=M[a],r=o.pickSlots;if(!r){B[a]=-1;continue}for(var n=0;n<t;++n)if(255>F[n]+r){B[a]=n,o.setPickBase(F[n]+1),F[n]+=r;continue obj_loop}var l=c(S,q);B[a]=t,N.push(l),F.push(r),o.setPickBase(1),t+=1}for(;0<t&&0===F[t-1];)F.pop(),N.pop().dispose()}function x(){return!!W.contextLost||void(S.isContextLost()&&(W.contextLost=!0,W.mouseListener.enabled=!1,W.selection.object=null,W.oncontextloss&&W.oncontextloss()))}function b(){if(!x()){S.colorMask(!0,!0,!0,!0),S.depthMask(!0),S.disable(S.BLEND),S.enable(S.DEPTH_TEST);for(var e=M.length,t=N.length,a=0,o;a<t;++a){o=N[a],o.shape=X,o.begin();for(var r=0;r<e;++r)if(B[r]===a){var n=M[r];n.drawPick&&(n.pixelRatio=1,n.drawPick(Y))}o.end()}}}function _(){if(!x()){t();var e=W.camera.tick();Y.view=W.camera.matrix,V=V||e,U=U||e,P.pixelRatio=W.pixelRatio,R.pixelRatio=W.pixelRatio;var a=M.length,o=J[0],n=J[1];o[0]=o[1]=o[2]=1/0,n[0]=n[1]=n[2]=-Infinity;for(var l=0,d;l<a;++l){d=M[l],d.pixelRatio=W.pixelRatio,d.axes=W.axes,V=V||!!d.dirty,U=U||!!d.dirty;var c=d.bounds;if(c)for(var p=c[0],g=c[1],m=0;3>m;++m)o[m]=ie(o[m],p[m]),n[m]=va(n[m],g[m])}var y=W.bounds;if(W.autoBounds)for(var m=0;3>m;++m){if(n[m]<o[m])o[m]=-1,n[m]=1;else{o[m]===n[m]&&(o[m]-=1,n[m]+=1);var f=.05*(n[m]-o[m]);o[m]-=f,n[m]+=f}y[0][m]=o[m],y[1][m]=n[m]}for(var _=!1,m=0;3>m;++m)_=_||K[0][m]!==y[0][m]||K[1][m]!==y[1][m],K[0][m]=y[0][m],K[1][m]=y[1][m];if(U=U||_,V=V||_,!!V){if(_){for(var v=[0,0,0],l=0;3>l;++l)v[l]=r((y[1][l]-y[0][l])/10);P.autoTicks?P.update({bounds:y,tickSpacing:v}):P.update({bounds:y})}var w=S.drawingBufferWidth,k=S.drawingBufferHeight;q[0]=w,q[1]=k,X[0]=0|va(w/W.pixelRatio,1),X[1]=0|va(k/W.pixelRatio,1),h(H,W.fovy,w/k,W.zNear,W.zFar);for(var l=0;16>l;++l)G[l]=0;G[15]=1;for(var T=0,l=0;3>l;++l)T=va(T,y[1][l]-y[0][l]);for(var l=0;3>l;++l)G[5*l]=W.autoScale?W.aspect[l]/(y[1][l]-y[0][l]):1/T,W.autoCenter&&(G[12+l]=.5*-G[5*l]*(y[0][l]+y[1][l]));for(var l=0,d;l<a;++l)d=M[l],d.axesBounds=y,W.clipToBounds&&(d.clipBounds=y);L.object&&(R.position=W.snapToData?L.dataCoordinate:L.dataPosition,R.bounds=y),U&&(U=!1,b()),W.axesPixels=s(W.axes,Y,w,k),W.onrender&&W.onrender(),S.bindFramebuffer(S.FRAMEBUFFER,null),S.viewport(0,0,w,k);var A=W.clearColor;S.clearColor(A[0],A[1],A[2],A[3]),S.clear(S.COLOR_BUFFER_BIT|S.DEPTH_BUFFER_BIT),S.depthMask(!0),S.colorMask(!0,!0,!0,!0),S.enable(S.DEPTH_TEST),S.depthFunc(S.LEQUAL),S.disable(S.BLEND),S.disable(S.CULL_FACE);var C=!1;P.enable&&(C=C||P.isTransparent(),P.draw(Y)),R.axes=P,L.object&&R.draw(Y),S.disable(S.CULL_FACE);for(var l=0,d;l<a;++l)d=M[l],d.axes=P,d.pixelRatio=W.pixelRatio,d.isOpaque&&d.isOpaque()&&d.draw(Y),d.isTransparent&&d.isTransparent()&&(C=!0);if(C){E.shape=q,E.bind(),S.clear(S.DEPTH_BUFFER_BIT),S.colorMask(!1,!1,!1,!1),S.depthMask(!0),S.depthFunc(S.LESS),P.enable&&P.isTransparent()&&P.drawTransparent(Y);for(var l=0,d;l<a;++l)d=M[l],d.isOpaque&&d.isOpaque()&&d.draw(Y);S.enable(S.BLEND),S.blendEquation(S.FUNC_ADD),S.blendFunc(S.ONE,S.ONE_MINUS_SRC_ALPHA),S.colorMask(!0,!0,!0,!0),S.depthMask(!1),S.clearColor(0,0,0,0),S.clear(S.COLOR_BUFFER_BIT),P.isTransparent()&&P.drawTransparent(Y);for(var l=0,d;l<a;++l)d=M[l],d.isTransparent&&d.isTransparent()&&d.drawTransparent(Y);S.bindFramebuffer(S.FRAMEBUFFER,null),S.blendFunc(S.ONE,S.ONE_MINUS_SRC_ALPHA),S.disable(S.DEPTH_TEST),z.bind(),E.color[0].bind(0),z.uniforms.accumBuffer=0,u(S),S.disable(S.BLEND)}V=!1;for(var l=0;l<a;++l)M[l].dirty=!1}}}function v(){w||W.contextLost||(_(),requestAnimationFrame(v))}e=e||{};var w=!1,k=e.pixelRatio||parseFloat(window.devicePixelRatio),T=e.canvas;if(!T)if(T=document.createElement("canvas"),e.container){var A=e.container;A.appendChild(T)}else document.body.appendChild(T);var S=e.gl;if(S||(S=o(T,e.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:y})),!S)throw new Error("webgl not supported");var C=e.bounds||[[-10,-10,-10],[10,10,10]],L=new a,E=p(S,[S.drawingBufferWidth,S.drawingBufferHeight],{preferFloat:!y}),z=m(S),I=e.camera||{eye:[2,0,0],center:[0,0,0],up:[0,1,0],zoomMin:.1,zoomMax:100,mode:"turntable"},D=e.axes||{},P=l(S,D);P.enable=!D.disable;var O=e.spikes||{},R=d(S,O),M=[],B=[],F=[],N=[],V=!0,U=!0,H=Array(16),G=Array(16),Y={view:null,projection:H,model:G},U=!0,q=[S.drawingBufferWidth,S.drawingBufferHeight],W={gl:S,contextLost:!1,pixelRatio:e.pixelRatio||parseFloat(window.devicePixelRatio),canvas:T,selection:L,camera:n(T,I),axes:P,axesPixels:null,spikes:R,bounds:C,objects:M,shape:q,aspect:e.aspectRatio||[1,1,1],pickRadius:e.pickRadius||10,zNear:e.zNear||.01,zFar:e.zFar||1e3,fovy:e.fovy||Sa/4,clearColor:e.clearColor||[0,0,0,0],autoResize:i(e.autoResize),autoBounds:i(e.autoBounds),autoScale:!!e.autoScale,autoCenter:i(e.autoCenter),clipToBounds:i(e.clipToBounds),snapToData:!!e.snapToData,onselect:e.onselect||null,onrender:e.onrender||null,onclick:e.onclick||null,cameraParams:Y,oncontextloss:null,mouseListener:null},X=[0|S.drawingBufferWidth/W.pixelRatio,0|S.drawingBufferHeight/W.pixelRatio];W.autoResize&&t(),window.addEventListener("resize",t),W.update=function(e){w||(e=e||{},V=!0,U=!0)},W.add=function(e){w||(e.axes=P,M.push(e),B.push(-1),V=!0,U=!0,f())},W.remove=function(e){if(!w){var t=M.indexOf(e);0>t||(M.splice(t,1),B.pop(),V=!0,U=!0,f())}},W.dispose=function(){if(!w&&(w=!0,window.removeEventListener("resize",t),T.removeEventListener("webglcontextlost",x),W.mouseListener.enabled=!1,!W.contextLost)){P.dispose(),R.dispose();for(var e=0;e<M.length;++e)M[e].dispose();E.dispose();for(var e=0;e<N.length;++e)N[e].dispose();z.dispose(),S=null,P=null,R=null,M=[]}};var Z=!1,$=0;W.mouseListener=g(T,function(e,t,a){if(!w){var o=N.length,r=M.length,n=L.object;L.distance=1/0,L.mouse[0]=t,L.mouse[1]=a,L.object=null,L.screen=null,L.dataCoordinate=L.dataPosition=null;var l=!1;if(e&&$)Z=!0;else{Z&&(U=!0),Z=!1;for(var s=0,d;s<o;++s)if(d=N[s].query(t,X[1]-a-1,W.pickRadius),d){if(d.distance>L.distance)continue;for(var c=0,p;c<r;++c)if(p=M[c],B[c]===s){var u=p.pick(d);u&&(L.buttons=e,L.screen=d.coord,L.distance=d.distance,L.object=p,L.index=u.distance,L.dataPosition=u.position,L.dataCoordinate=u.dataCoordinate,L.data=u,l=!0)}}}n&&n!==L.object&&(n.highlight&&n.highlight(null),V=!0),L.object&&(L.object.highlight&&L.object.highlight(L.data),V=!0),l=l||L.object!==n,l&&W.onselect&&W.onselect(L),1&e&&!(1&$)&&W.onclick&&W.onclick(L),$=e}}),T.addEventListener("webglcontextlost",x);var J=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],K=[J[0].slice(),J[1].slice()];return v(),W.redraw=function(){w||(V=!0,_())},W};var n=e("3d-view-controls"),l=e("gl-axes3d"),s=e("gl-axes3d/properties"),d=e("gl-spikes3d"),c=e("gl-select-static"),p=e("gl-fbo"),u=e("a-big-triangle"),g=e("mouse-change"),h=e("gl-mat4/perspective"),m=e("./lib/shader"),y=e("is-mobile")({tablet:!0})},{"./lib/shader":276,"3d-view-controls":44,"a-big-triangle":47,"gl-axes3d":222,"gl-axes3d/properties":229,"gl-fbo":239,"gl-mat4/perspective":257,"gl-select-static":287,"gl-spikes3d":297,"is-mobile":403,"mouse-change":418}],278:[function(e,t,a){var o=e("glslify");a.pointVertex=o(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform float pointCloud;\n\nhighp float rand(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float d = dot(co.xy, vec2(a, b));\n  highp float e = mod(d, 3.14);\n  return fract(sin(e) * c);\n}\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n    // if we don't jitter the point size a bit, overall point cloud\n    // saturation 'jumps' on zooming, which is disturbing and confusing\n  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    // get the same square surface as circle would be\n    gl_PointSize *= 0.886;\n  }\n}"]),a.pointFragment=o(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\nuniform float pointCloud;\n\nvoid main() {\n  float radius;\n  vec4 baseColor;\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    if(centerFraction == 1.0) {\n      gl_FragColor = color;\n    } else {\n      gl_FragColor = mix(borderColor, color, centerFraction);\n    }\n  } else {\n    radius = length(2.0 * gl_PointCoord.xy - 1.0);\n    if(radius > 1.0) {\n      discard;\n    }\n    baseColor = mix(borderColor, color, step(radius, centerFraction));\n    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);\n  }\n}\n"]),a.pickVertex=o(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n"]),a.pickFragment=o(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0 * gl_PointCoord.xy - 1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"])},{glslify:392}],279:[function(e,t){"use strict";function a(e,t,a,o,r){this.plot=e,this.offsetBuffer=t,this.pickBuffer=a,this.shader=o,this.pickShader=r,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}function o(e,t){var a=0,o=e.length>>>1,r;for(r=0;r<o;r++){var n=e[2*r],l=e[2*r+1];n>=t[0]&&n<=t[2]&&l>=t[1]&&l<=t[3]&&a++}return a}var r=e("gl-shader"),i=e("gl-buffer"),n=e("typedarray-pool"),l=e("./lib/shader");t.exports=function(e,t){var o=e.gl,n=i(o),s=i(o),d=r(o,l.pointVertex,l.pointFragment),c=r(o,l.pickVertex,l.pickFragment),p=new a(e,n,s,d,c);return p.update(t),e.addObject(p),p};var s=a.prototype;s.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},s.update=function(e){function t(t,a){return t in e?e[t]:a}var a;e=e||{},this.sizeMin=t("sizeMin",.5),this.sizeMax=t("sizeMax",20),this.color=t("color",[1,0,0,1]).slice(),this.areaRatio=t("areaRatio",1),this.borderColor=t("borderColor",[0,0,0,1]).slice(),this.blend=t("blend",!1);var o=e.positions.length>>>1,r=e.positions instanceof Float32Array,l=e.idToIndex instanceof Int32Array&&e.idToIndex.length>=o,s=e.positions,d=r?s:n.mallocFloat32(s.length),c=l?e.idToIndex:n.mallocInt32(o);if(r||d.set(s),!l)for(d.set(s),a=0;a<o;a++)c[a]=a;this.points=s,this.offsetBuffer.update(d),this.pickBuffer.update(c),r||n.free(d),l||n.free(c),this.pointCount=o,this.pickOffset=0},s.unifiedDraw=function(){var e=[1,0,0,0,1,0,0,0,1],t=[0,0,0,0];return function(a){var r=void 0!==a,i=r?this.pickShader:this.shader,n=this.plot.gl,l=this.plot.dataBox;if(0===this.pointCount)return a;var s=l[2]-l[0],d=l[3]-l[1],c=o(this.points,l),p=this.plot.pickPixelRatio*va(ie(this.sizeMinCap,this.sizeMin),ie(this.sizeMax,this.sizeMax/_a(c,.33333)));e[0]=2/s,e[4]=2/d,e[6]=-2*l[0]/s-1,e[7]=-2*l[1]/d-1,this.offsetBuffer.bind(),i.bind(),i.attributes.position.pointer(),i.uniforms.matrix=e,i.uniforms.color=this.color,i.uniforms.borderColor=this.borderColor,i.uniforms.pointCloud=5>p,i.uniforms.pointSize=p,i.uniforms.centerFraction=ie(1,va(0,re(1-this.areaRatio))),r&&(t[0]=255&a,t[1]=255&a>>8,t[2]=255&a>>16,t[3]=255&a>>24,this.pickBuffer.bind(),i.attributes.pickId.pointer(n.UNSIGNED_BYTE),i.uniforms.pickOffset=t,this.pickOffset=a);var u=n.getParameter(n.BLEND),g=n.getParameter(n.DITHER);return u&&!this.blend&&n.disable(n.BLEND),g&&n.disable(n.DITHER),n.drawArrays(n.POINTS,0,this.pointCount),u&&!this.blend&&n.enable(n.BLEND),g&&n.enable(n.DITHER),a+this.pointCount}}(),s.draw=s.unifiedDraw,s.drawPick=s.unifiedDraw,s.pick=function(e,t,a){var o=this.pickOffset,r=this.pointCount;if(a<o||a>=o+r)return null;var i=a-o,n=this.points;return{object:this,pointId:i,dataCoord:[n[2*i],n[2*i+1]]}}},{"./lib/shader":278,"gl-buffer":230,"gl-shader":288,"typedarray-pool":521}],280:[function(e,t){t.exports=function(e,o,a,r){var t=o[0],i=o[1],n=o[2],l=o[3],s=a[0],d=a[1],c=a[2],p=a[3],u,g,h,m,y;return g=t*s+i*d+n*c+l*p,0>g&&(g=-g,s=-s,d=-d,c=-c,p=-p),1e-6<1-g?(u=v(g),h=M(u),m=M((1-r)*u)/h,y=M(r*u)/h):(m=1-r,y=r),e[0]=m*t+y*s,e[1]=m*i+y*d,e[2]=m*n+y*c,e[3]=m*l+y*p,e}},{}],281:[function(e,t){"use strict";t.exports=function(e){return e||0===e?e.toString():""}},{}],282:[function(e,t){"use strict";function a(e,t){var a=r[t];if(a||(a=r[t]={}),e in a)return a[e];var l={textAlign:"center",textBaseline:"middle",lineHeight:1,font:t,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},s=o(e,l);l.triangles=!1;for(var d=o(e,l),c=[[1/0,1/0],[-Infinity,-Infinity]],u=d.positions.length,n=0,g;n<u;++n){g=d.positions[n];for(var h=0;2>h;++h)c[0][h]=ie(c[0][h],g[h]),c[1][h]=va(c[1][h],g[h])}return a[e]=[s,d,c]}var o=e("vectorize-text");t.exports=a;var r={}},{"vectorize-text":526}],283:[function(e,t,a){function o(e,t){var a=r(e,t),o=a.attributes;return o.position.location=0,o.color.location=1,o.glyph.location=2,o.id.location=3,a}var r=e("gl-shader"),i=e("glslify"),n=i(["precision mediump float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),l=i(["precision mediump float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n\n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),s=i(["precision mediump float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n"]),d=i(["precision mediump float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;\n\n  gl_FragColor = interpColor * opacity;\n}\n"]),c=i(["precision mediump float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;\n\n  gl_FragColor = vec4(pickGroup, pickId.bgr);\n}"]),p=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],u={vertex:n,fragment:d,attributes:p},g={vertex:l,fragment:d,attributes:p},h={vertex:s,fragment:d,attributes:p},m={vertex:n,fragment:c,attributes:p},y={vertex:l,fragment:c,attributes:p},f={vertex:s,fragment:c,attributes:p};a.createPerspective=function(e){return o(e,u)},a.createOrtho=function(e){return o(e,g)},a.createProject=function(e){return o(e,h)},a.createPickPerspective=function(e){return o(e,m)},a.createPickOrtho=function(e){return o(e,y)},a.createPickProject=function(e){return o(e,f)}},{"gl-shader":288,glslify:392}],284:[function(e,t){"use strict";function a(e,t){var a=e[0],o=e[1],r=e[2],i=e[3];return e[0]=t[0]*a+t[4]*o+t[8]*r+t[12]*i,e[1]=t[1]*a+t[5]*o+t[9]*r+t[13]*i,e[2]=t[2]*a+t[6]*o+t[10]*r+t[14]*i,e[3]=t[3]*a+t[7]*o+t[11]*r+t[15]*i,e}function o(e,t,o,r){return a(r,r,o),a(r,r,t),a(r,r,e)}function r(e,t){this.index=e,this.dataCoordinate=this.position=t}function n(e){return!0===e?1:1<e?1:e}function l(e,t,a,o,i,n,l,s,d,c,p,u){this.gl=e,this.pixelRatio=1,this.shader=t,this.orthoShader=a,this.projectShader=o,this.pointBuffer=i,this.colorBuffer=n,this.glyphBuffer=l,this.idBuffer=s,this.vao=d,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.pickId=0,this.pickPerspectiveShader=c,this.pickOrthoShader=p,this.pickProjectShader=u,this.points=[],this._selectResult=new r(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.dirty=!0}function s(e){return e[0]=e[1]=e[2]=0,e}function d(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=1,e}function c(e,t,a,o){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[a]=o,e}function p(e){for(var t=P,a=0;2>a;++a)for(var o=0;3>o;++o)t[a][o]=va(ie(e[a][o],1e8),-1e8);return t}function u(e,a,r){var n=a.axesProject,l=a.gl,g=e.uniforms,h=r.model||T,m=r.view||T,y=r.projection||T,f=a.axesBounds,x=p(a.clipBounds),b;b=a.axes&&a.axes.lastCubeProps?a.axes.lastCubeProps.axis:[1,1,1],S[0]=2/l.drawingBufferWidth,S[1]=2/l.drawingBufferHeight,e.bind(),g.view=m,g.projection=y,g.screenSize=S,g.highlightId=a.highlightId,g.highlightScale=a.highlightScale,g.clipBounds=x,g.pickGroup=a.pickId/255,g.pixelRatio=a.pixelRatio;for(var w=0;3>w;++w)if(n[w]){g.scale=a.projectScale[w],g.opacity=a.projectOpacity[w];for(var k=I,A=0;16>A;++A)k[A]=0;for(var A=0;4>A;++A)k[5*A]=1;k[5*w]=0,k[12+w]=0>b[w]?f[0][w]:f[1][w],_(k,h,k),g.model=k;var P=(w+1)%3,O=(w+2)%3,R=s(C),M=s(L);R[P]=1,M[O]=1;var B=o(y,m,h,d(E,R)),F=o(y,m,h,d(z,M));if(wa(B[1])>wa(F[1])){var N=B;B=F,F=N,N=R,R=M,M=N;var V=P;P=O,O=V}0>B[0]&&(R[P]=-1),0<F[1]&&(M[O]=-1);for(var t=0,U=0,A=0;4>A;++A)t+=_a(h[4*P+A],2),U+=_a(h[4*O+A],2);R[P]/=re(t),M[O]/=re(U),g.axes[0]=R,g.axes[1]=M,g.fragClipBounds[0]=c(D,x[0],w,-1e8),g.fragClipBounds[1]=c(D,x[1],w,1e8),a.vao.bind(),a.vao.draw(l.TRIANGLES,a.vertexCount),0<a.lineWidth&&(l.lineWidth(a.lineWidth),a.vao.draw(l.LINES,a.lineVertexCount,a.vertexCount)),a.vao.unbind()}}function g(e,t,a,o,r,i){var n=a.gl;if((r===1>a.projectOpacity||i)&&u(t,a,o),r===1>a.opacity||i){e.bind();var l=e.uniforms;l.model=o.model||T,l.view=o.view||T,l.projection=o.projection||T,S[0]=2/n.drawingBufferWidth,S[1]=2/n.drawingBufferHeight,l.screenSize=S,l.highlightId=a.highlightId,l.highlightScale=a.highlightScale,l.fragClipBounds=O,l.clipBounds=a.axes.bounds,l.opacity=a.opacity,l.pickGroup=a.pickId/255,l.pixelRatio=a.pixelRatio,a.vao.bind(),a.vao.draw(n.TRIANGLES,a.vertexCount),0<a.lineWidth&&(n.lineWidth(a.lineWidth),a.vao.draw(n.LINES,a.lineVertexCount,a.vertexCount)),a.vao.unbind()}}function h(e,t,a){var o;o=Array.isArray(e)?t<e.length?e[t]:void 0:e,o=k(o);var r=!0;m(o)&&(o="\u25BC",r=!1);var i=w(o,a);return{mesh:i[0],lines:i[1],bounds:i[2],visible:r}}var m=e("is-string-blank"),y=e("gl-buffer"),f=e("gl-vao"),b=e("typedarray-pool"),_=e("gl-mat4/multiply"),v=e("./lib/shaders"),w=e("./lib/glyphs"),k=e("./lib/get-simple-string"),T=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];t.exports=function(e){var t=e.gl,a=v.createPerspective(t),o=v.createOrtho(t),r=v.createProject(t),i=v.createPickPerspective(t),n=v.createPickOrtho(t),s=v.createPickProject(t),d=y(t),c=y(t),p=y(t),u=y(t),g=f(t,[{buffer:d,size:3,type:t.FLOAT},{buffer:c,size:4,type:t.FLOAT},{buffer:p,size:2,type:t.FLOAT},{buffer:u,size:4,type:t.UNSIGNED_BYTE,normalized:!0}]),h=new l(t,a,o,r,d,c,p,u,g,i,n,s);return h.update(e),h};var A=l.prototype;A.pickSlots=1,A.setPickBase=function(e){this.pickId=e},A.isTransparent=function(){if(this.opacity<1)return!0;for(var e=0;3>e;++e)if(this.axesProject[e]&&this.projectOpacity[e]<1)return!0;return!1},A.isOpaque=function(){if(this.opacity>=1)return!0;for(var e=0;3>e;++e)if(this.axesProject[e]&&this.projectOpacity[e]>=1)return!0;return!1};var S=[0,0],C=[0,0,0],L=[0,0,0],E=[0,0,0,1],z=[0,0,0,1],I=T.slice(),D=[0,0,0],P=[[0,0,0],[0,0,0]],O=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];A.draw=function(e){var t=this.useOrtho?this.orthoShader:this.shader;g(t,this.projectShader,this,e,!1,!1)},A.drawTransparent=function(e){var t=this.useOrtho?this.orthoShader:this.shader;g(t,this.projectShader,this,e,!0,!1)},A.drawPick=function(e){var t=this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader;g(t,this.pickProjectShader,this,e,!0,!0)},A.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;var t=e.value[2]+(e.value[1]<<8)+(e.value[0]<<16);if(t>=this.pointCount||0>t)return null;var a=this.points[t],o=this._selectResult;o.index=t;for(var r=0;3>r;++r)o.position[r]=o.dataCoordinate[r]=a[r];return o},A.highlight=function(e){if(!e)this.highlightId=[1,1,1,1];else{var t=e.index;this.highlightId=[(255&t)/255,(255&t>>8)/255,(255&t>>16)/255,0]}},A.update=function(e){if(e=e||{},"perspective"in e&&(this.useOrtho=!e.perspective),"orthographic"in e&&(this.useOrtho=!!e.orthographic),"lineWidth"in e&&(this.lineWidth=e.lineWidth),"project"in e)if(Array.isArray(e.project))this.axesProject=e.project;else{var t=!!e.project;this.axesProject=[t,t,t]}if("projectScale"in e)if(Array.isArray(e.projectScale))this.projectScale=e.projectScale.slice();else{var a=+e.projectScale;this.projectScale=[a,a,a]}if("projectOpacity"in e){if(Array.isArray(e.projectOpacity))this.projectOpacity=e.projectOpacity.slice();else{var a=+e.projectOpacity;this.projectOpacity=[a,a,a]}for(var o=0;3>o;++o)this.projectOpacity[o]=n(this.projectOpacity[o])}"opacity"in e&&(this.opacity=n(e.opacity)),this.dirty=!0;var r=e.position,d=e.font||"normal",u=e.alignment||[0,0],g,m;if(2===u.length)g=u[0],m=u[1];else{g=[],m=[];for(var o=0;o<u.length;++o)g[o]=u[o][0],m[o]=u[o][1]}var y=[1/0,1/0,1/0],f=[-Infinity,-Infinity,-Infinity],_=e.glyph,v=e.color,w=e.size,T=e.angle,A=e.lineColor,S=-1,C=0,L=0,E=0;if(r.length){E=r.length;count_loop:for(var o=0,z;o<E;++o){z=r[o];for(var I=0;3>I;++I)if(isNaN(z[I])||!isFinite(z[I]))continue count_loop;var D=h(_,o,d),P=D.mesh,O=D.lines,R=D.bounds;C+=3*P.cells.length,L+=2*O.edges.length}}var B=C+L,F=b.mallocFloat(3*B),N=b.mallocFloat(4*B),V=b.mallocFloat(2*B),U=b.mallocUint32(B);if(0<B){var H=0,G=C,Y=[0,0,0,1],q=[0,0,0,1],W=Array.isArray(v)&&Array.isArray(v[0]),X=Array.isArray(A)&&Array.isArray(A[0]);fill_loop:for(var o=0;o<E;++o){S+=1;for(var z=r[o],I=0;3>I;++I){if(isNaN(z[I])||!isFinite(z[I]))continue fill_loop;f[I]=va(f[I],z[I]),y[I]=ie(y[I],z[I])}var D=h(_,o,d),P=D.mesh,O=D.lines,R=D.bounds,Z=D.visible;if(!Z)Y=[1,1,1,0];else if(Array.isArray(v)){var $;if($=W?o<v.length?v[o]:[0,0,0,0]:v,3===$.length){for(var I=0;3>I;++I)Y[I]=$[I];Y[3]=1}else if(4===$.length)for(var I=0;4>I;++I)Y[I]=$[I]}else Y[0]=Y[1]=Y[2]=0,Y[3]=1;if(!Z)q=[1,1,1,0];else if(Array.isArray(A)){var $;if($=X?o<A.length?A[o]:[0,0,0,0]:A,3===$.length){for(var I=0;3>I;++I)q[I]=$[I];q[I]=1}else if(4===$.length)for(var I=0;4>I;++I)q[I]=$[I]}else q[0]=q[1]=q[2]=0,q[3]=1;var J=.5;Z?Array.isArray(w)?o<w.length?J=+w[o]:J=12:w?J=+w:this.useOrtho&&(J=12):J=0;var K=0;Array.isArray(T)?o<T.length?K=+T[o]:K=0:T&&(K=+T);for(var Q=te(K),ee=M(K),z=r[o],I=0;3>I;++I)f[I]=va(f[I],z[I]),y[I]=ie(y[I],z[I]);var ae=g,oe=m,ae=0;Array.isArray(g)?o<g.length?ae=g[o]:ae=0:g&&(ae=g);var oe=0;Array.isArray(m)?o<m.length?oe=m[o]:oe=0:m&&(oe=m),ae*=0<ae?1-R[0][0]:0>ae?1+R[1][0]:1,oe*=0<oe?1-R[0][1]:0>oe?1+R[1][1]:1;for(var re=[ae,oe],ne=P.cells||[],le=P.positions||[],I=0,se;I<ne.length;++I){se=ne[I];for(var de=0;3>de;++de){for(var ce=0;3>ce;++ce)F[3*H+ce]=z[ce];for(var ce=0;4>ce;++ce)N[4*H+ce]=Y[ce];U[H]=S;var pe=le[se[de]];V[2*H]=J*(Q*pe[0]-ee*pe[1]+re[0]),V[2*H+1]=J*(ee*pe[0]+Q*pe[1]+re[1]),H+=1}}for(var ne=O.edges,le=O.positions,I=0,se;I<ne.length;++I){se=ne[I];for(var de=0;2>de;++de){for(var ce=0;3>ce;++ce)F[3*G+ce]=z[ce];for(var ce=0;4>ce;++ce)N[4*G+ce]=q[ce];U[G]=S;var pe=le[se[de]];V[2*G]=J*(Q*pe[0]-ee*pe[1]+re[0]),V[2*G+1]=J*(ee*pe[0]+Q*pe[1]+re[1]),G+=1}}}}this.bounds=[y,f],this.points=r,this.pointCount=r.length,this.vertexCount=C,this.lineVertexCount=L,this.pointBuffer.update(F),this.colorBuffer.update(N),this.glyphBuffer.update(V),this.idBuffer.update(U),b.free(F),b.free(N),b.free(V),b.free(U)},A.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":281,"./lib/glyphs":282,"./lib/shaders":283,"gl-buffer":230,"gl-mat4/multiply":256,"gl-vao":310,"is-string-blank":406,"typedarray-pool":521}],285:[function(e,t,a){"use strict";var o=e("glslify");a.boxVertex=o(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertex;\n\nuniform vec2 cornerA, cornerB;\n\nvoid main() {\n  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);\n}\n"]),a.boxFragment=o(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"])},{glslify:392}],286:[function(e,t){"use strict";function a(e,t,a){this.plot=e,this.boxBuffer=t,this.boxShader=a,this.enabled=!0,this.selectBox=[1/0,1/0,-Infinity,-Infinity],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}var o=e("gl-shader"),r=e("gl-buffer"),i=e("./lib/shaders");t.exports=function(e,t){var n=e.gl,l=r(n,[0,0,0,1,1,0,1,1]),s=o(n,i.boxVertex,i.boxFragment),d=new a(e,l,s);return d.update(t),e.addOverlay(d),d};var n=a.prototype;n.draw=function(){if(this.enabled){var e=this.plot,t=this.selectBox,a=this.borderWidth,o=this.innerFill,r=this.innerColor,i=this.outerFill,n=this.outerColor,l=this.borderColor,s=e.box,d=e.screenBox,c=e.dataBox,p=e.viewBox,u=e.pixelRatio,g=(t[0]-c[0])*(p[2]-p[0])/(c[2]-c[0])+p[0],h=(t[1]-c[1])*(p[3]-p[1])/(c[3]-c[1])+p[1],m=(t[2]-c[0])*(p[2]-p[0])/(c[2]-c[0])+p[0],y=(t[3]-c[1])*(p[3]-p[1])/(c[3]-c[1])+p[1];if(g=va(g,p[0]),h=va(h,p[1]),m=ie(m,p[2]),y=ie(y,p[3]),!(m<g||y<h)){s.bind();var f=d[2]-d[0],x=d[3]-d[1];if(this.outerFill&&(s.drawBox(0,0,f,h,n),s.drawBox(0,h,g,y,n),s.drawBox(0,y,f,x,n),s.drawBox(m,h,f,y,n)),this.innerFill&&s.drawBox(g,h,m,y,r),0<a){var b=a*u;s.drawBox(g-b,h-b,m+b,h+b,l),s.drawBox(g-b,y-b,m+b,y+b,l),s.drawBox(g-b,h-b,g+b,y+b,l),s.drawBox(m-b,h-b,m+b,y+b,l)}}}},n.update=function(e){e=e||{},this.innerFill=!!e.innerFill,this.outerFill=!!e.outerFill,this.innerColor=(e.innerColor||[0,0,0,.5]).slice(),this.outerColor=(e.outerColor||[0,0,0,.5]).slice(),this.borderColor=(e.borderColor||[0,0,0,1]).slice(),this.borderWidth=e.borderWidth||0,this.selectBox=(e.selectBox||this.selectBox).slice()},n.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":285,"gl-buffer":230,"gl-shader":288}],287:[function(e,t){"use strict";function a(e,t,a,o,r){this.coord=[e,t],this.id=a,this.value=o,this.distance=r}function o(e,t,a){this.gl=e,this.fbo=t,this.buffer=a,this._readTimeout=null;var o=this;this._readCallback=function(){o.gl&&(t.bind(),e.readPixels(0,0,t.shape[0],t.shape[1],e.RGBA,e.UNSIGNED_BYTE,o.buffer),o._readTimeout=null)}}t.exports=function(e,t){var a=r(e,t),i=n.mallocUint8(4*(t[0]*t[1]));return new o(e,a,i)};var r=e("gl-fbo"),n=e("typedarray-pool"),l=e("ndarray"),s=e("bit-twiddle").nextPow2,d=e("cwise/lib/wrapper")({args:["array",{offset:[0,0,1],array:0},{offset:[0,0,2],array:0},{offset:[0,0,3],array:0},"scalar","scalar","index"],pre:{body:"{this_closestD2=1e8,this_closestX=-1,this_closestY=-1}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},body:{body:"{if(_inline_16_arg0_<255||_inline_16_arg1_<255||_inline_16_arg2_<255||_inline_16_arg3_<255){var _inline_16_l=_inline_16_arg4_-_inline_16_arg6_[0],_inline_16_a=_inline_16_arg5_-_inline_16_arg6_[1],_inline_16_f=_inline_16_l*_inline_16_l+_inline_16_a*_inline_16_a;_inline_16_f<this_closestD2&&(this_closestD2=_inline_16_f,this_closestX=_inline_16_arg6_[0],this_closestY=_inline_16_arg6_[1])}}",args:[{name:"_inline_16_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg4_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg5_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_16_arg6_",lvalue:!1,rvalue:!0,count:4}],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:["_inline_16_a","_inline_16_f","_inline_16_l"]},post:{body:"{return[this_closestX,this_closestY,this_closestD2]}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},debug:!1,funcName:"cwise",blockSize:64}),c=o.prototype;Object.defineProperty(c,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(e){if(this.gl){this.fbo.shape=e;var t=this.fbo.shape[0],a=this.fbo.shape[1];if(4*(a*t)>this.buffer.length){n.free(this.buffer);for(var o=this.buffer=n.mallocUint8(s(4*(a*t))),r=0;r<4*(a*t);++r)o[r]=255}return e}}}),c.begin=function(){var e=this.gl,t=this.shape;e&&(this.fbo.bind(),e.clearColor(1,1,1,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT))},c.end=function(){var e=this.gl;e&&(e.bindFramebuffer(e.FRAMEBUFFER,null),!this._readTimeout&&clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},c.query=function(e,t,o){if(!this.gl)return null;var r=this.fbo.shape.slice();e|=0,t|=0,"number"!=typeof o&&(o=1);var i=0|ie(va(e-o,0),r[0]),n=0|ie(va(e+o,0),r[0]),s=0|ie(va(t-o,0),r[1]),c=0|ie(va(t+o,0),r[1]);if(n<=i||c<=s)return null;var p=[n-i,c-s],u=l(this.buffer,[p[0],p[1],4],[4,4*r[0],1],4*(i+r[0]*s)),g=d(u.hi(p[0],p[1],1),o,o),h=g[0],m=g[1];if(0>h||_a(this.radius,2)<g[2])return null;var f=u.get(h,m,0),b=u.get(h,m,1),_=u.get(h,m,2),v=u.get(h,m,3);return new a(0|h+i,0|m+s,f,[b,_,v],re(g[2]))},c.dispose=function(){this.gl&&(this.fbo.dispose(),n.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":80,"cwise/lib/wrapper":137,"gl-fbo":239,ndarray:433,"typedarray-pool":521}],288:[function(e,t){"use strict";function a(e){this.gl=e,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}function o(e,t){return e.name<t.name?-1:1}var r=e("./lib/create-uniforms"),n=e("./lib/create-attributes"),l=e("./lib/reflect"),s=e("./lib/shader-cache"),d=e("./lib/runtime-reflect"),c=e("./lib/GLError"),p=a.prototype;p.bind=function(){this.program||this._relink();var e=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),t=this.gl.lastAttribCount,a;if(e>t)for(a=t;a<e;a++)this.gl.enableVertexAttribArray(a);else if(t>e)for(a=e;a<t;a++)this.gl.disableVertexAttribArray(a);this.gl.lastAttribCount=e,this.gl.useProgram(this.program)},p.dispose=function(){for(var e=this.gl.lastAttribCount,t=0;t<e;t++)this.gl.disableVertexAttribArray(t);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},p.update=function(e,t,a,p){function u(){h.program=s.program(m,h._vref,h._fref,v,w);for(var e=0;e<a.length;++e)E[e]=m.getUniformLocation(h.program,a[e].name)}if(!t||1===arguments.length){var g=e;e=g.vertex,t=g.fragment,a=g.uniforms,p=g.attributes}var h=this,m=h.gl,y=h._vref;h._vref=s.shader(m,m.VERTEX_SHADER,e),y&&y.dispose(),h.vertShader=h._vref.shader;var f=this._fref;if(h._fref=s.shader(m,m.FRAGMENT_SHADER,t),f&&f.dispose(),h.fragShader=h._fref.shader,!a||!p){var x=m.createProgram();if(m.attachShader(x,h.fragShader),m.attachShader(x,h.vertShader),m.linkProgram(x),!m.getProgramParameter(x,m.LINK_STATUS)){var b=m.getProgramInfoLog(x);throw new c(b,"Error linking program:"+b)}a=a||d.uniforms(m,x),p=p||d.attributes(m,x),m.deleteProgram(x)}p=p.slice(),p.sort(o);var _=[],v=[],w=[],k;for(k=0;k<p.length;++k){var T=p[k];if(0<=T.type.indexOf("mat")){for(var A=0|T.type.charAt(T.type.length-1),S=Array(A),C=0;C<A;++C)S[C]=w.length,v.push(T.name+"["+C+"]"),"number"==typeof T.location?w.push(T.location+C):Array.isArray(T.location)&&T.location.length===A&&"number"==typeof T.location[C]?w.push(0|T.location[C]):w.push(-1);_.push({name:T.name,type:T.type,locations:S})}else _.push({name:T.name,type:T.type,locations:[w.length]}),v.push(T.name),"number"==typeof T.location?w.push(0|T.location):w.push(-1)}var L=0;for(k=0;k<w.length;++k)if(0>w[k]){for(;0<=w.indexOf(L);)L+=1;w[k]=L}var E=Array(a.length);u(),h._relink=u,h.types={uniforms:l(a),attributes:l(p)},h.attributes=n(m,h,_,w),Object.defineProperty(h,"uniforms",r(m,h,a,E))},t.exports=function(e,t,o,r,i){var n=new a(e);return n.update(t,o,r,i),n}},{"./lib/GLError":289,"./lib/create-attributes":290,"./lib/create-uniforms":291,"./lib/reflect":292,"./lib/runtime-reflect":293,"./lib/shader-cache":294}],289:[function(e,t){function a(e,t,a){this.shortMessage=t||"",this.longMessage=a||"",this.rawError=e||"",this.message="gl-shader: "+(t||e||"")+(a?"\n"+a:""),this.stack=new Error().stack}a.prototype=new Error,a.prototype.name="GLError",a.prototype.constructor=a,t.exports=a},{}],290:[function(e,t){"use strict";function a(e,t,a,o,r,i){this._gl=e,this._wrapper=t,this._index=a,this._locations=o,this._dimension=r,this._constFunc=i}function o(e,t,o,r,n,l,s){for(var d=["gl","v"],c=[],p=0;p<n;++p)d.push("x"+p),c.push("x"+p);d.push("if(x0.length===void 0){return gl.vertexAttrib"+n+"f(v,"+c.join()+")}else{return gl.vertexAttrib"+n+"fv(v,x0)}");var u=Function.apply(null,d),g=new a(e,t,o,r,n,u);Object.defineProperty(l,s,{set:function(t){return e.disableVertexAttribArray(r[o]),u(e,r[o],t),t},get:function(){return g},enumerable:!0})}function r(e,t,a,r,n,l,s){for(var d=Array(n),c=Array(n),p=0;p<n;++p)o(e,t,a[p],r,n,d,p),c[p]=d[p];Object.defineProperty(d,"location",{set:function(e){if(Array.isArray(e))for(var t=0;t<n;++t)c[t].location=e[t];else for(var t=0;t<n;++t)c[t].location=e+t;return e},get:function(){for(var e=Array(n),t=0;t<n;++t)e[t]=r[a[t]];return e},enumerable:!0}),d.pointer=function(t,o,l,s){t=t||e.FLOAT,o=!!o,l=l||n*n,s=s||0;for(var d=0,c;d<n;++d)c=r[a[d]],e.vertexAttribPointer(c,n,t,o,l,s+d*n),e.enableVertexAttribArray(c)};var u=Array(n),g=e["vertexAttrib"+n+"fv"];Object.defineProperty(l,s,{set:function(t){for(var o=0,l;o<n;++o)if(l=r[a[o]],e.disableVertexAttribArray(l),Array.isArray(t[0]))g.call(e,l,t[o]);else{for(var s=0;s<n;++s)u[s]=t[n*o+s];g.call(e,l,u)}return t},get:function(){return d},enumerable:!0})}t.exports=function(e,t,l,s){for(var c={},p=0,u=l.length;p<u;++p){var n=l[p],a=n.name,g=n.type,h=n.locations;switch(g){case"bool":case"int":case"float":o(e,t,h[0],s,1,c,a);break;default:if(0<=g.indexOf("vec")){var m=g.charCodeAt(g.length-1)-48;if(2>m||4<m)throw new i("","Invalid data type for attribute "+a+": "+g);o(e,t,h[0],s,m,c,a)}else if(0<=g.indexOf("mat")){var m=g.charCodeAt(g.length-1)-48;if(2>m||4<m)throw new i("","Invalid data type for attribute "+a+": "+g);r(e,t,h,s,m,c,a)}else throw new i("","Unknown data type for attribute "+a+": "+g);}}return c};var i=e("./GLError"),n=a.prototype;n.pointer=function(e,t,a,o){var r=this,i=r._gl,n=r._locations[r._index];i.vertexAttribPointer(n,r._dimension,e||i.FLOAT,!!t,a||0,o||0),i.enableVertexAttribArray(n)},n.set=function(e,t,a,o){return this._constFunc(this._locations[this._index],e,t,a,o)},Object.defineProperty(n,"location",{get:function(){return this._locations[this._index]},set:function(e){return e!==this._locations[this._index]&&(this._locations[this._index]=0|e,this._wrapper.program=null),0|e}})},{"./GLError":289}],291:[function(e,t){"use strict";function a(e){var t=new Function("y","return function(){return y}");return t(e)}function o(e,t){for(var a=Array(e),o=0;o<e;++o)a[o]=t;return a}var r=e("./reflect"),i=e("./GLError");t.exports=function(e,t,n,l){function s(a){var o=new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+a+"])}");return o(e,t,l)}function d(e,t,a){switch(a){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+t+"],obj"+e+")";case"float":return"gl.uniform1f(locations["+t+"],obj"+e+")";default:var o=a.indexOf("vec");if(0<=o&&1>=o&&a.length===4+o){var r=a.charCodeAt(a.length-1)-48;if(2>r||4<r)throw new i("","Invalid data type");switch(a.charAt(0)){case"b":case"i":return"gl.uniform"+r+"iv(locations["+t+"],obj"+e+")";case"v":return"gl.uniform"+r+"fv(locations["+t+"],obj"+e+")";default:throw new i("","Unrecognized data type for vector "+name+": "+a);}}else{if(0===a.indexOf("mat")&&4===a.length){var r=a.charCodeAt(a.length-1)-48;if(2>r||4<r)throw new i("","Invalid uniform dimension type for matrix "+name+": "+a);return"gl.uniformMatrix"+r+"fv(locations["+t+"],false,obj"+e+")"}throw new i("","Unknown uniform data type for "+name+": "+a)}}}function c(e,t){if("object"!=typeof t)return[[e,t]];var a=[];for(var o in t){var r=t[o],i=e;i+=parseInt(o)+""==o?"["+o+"]":"."+o,"object"==typeof r?a.push.apply(a,c(i,r)):a.push([i,r])}return a}function p(t){for(var a=["return function updateProperty(obj){"],o=c("",t),r=0;r<o.length;++r){var s=o[r],p=s[0],u=s[1];l[u]&&a.push(d(p,u,n[u].type))}a.push("return obj}");var g=new Function("gl","locations",a.join("\n"));return g(e,l)}function u(e){switch(e){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var t=e.indexOf("vec");if(0<=t&&1>=t&&e.length===4+t){var a=e.charCodeAt(e.length-1)-48;if(2>a||4<a)throw new i("","Invalid data type");return"b"===e.charAt(0)?o(a,!1):o(a,0)}if(0===e.indexOf("mat")&&4===e.length){var a=e.charCodeAt(e.length-1)-48;if(2>a||4<a)throw new i("","Invalid uniform dimension type for matrix "+name+": "+e);return o(a*a,0)}throw new i("","Unknown uniform data type for "+name+": "+e);}}function g(e,t,o){if("object"==typeof o){var r=h(o);Object.defineProperty(e,t,{get:a(r),set:p(o),enumerable:!0,configurable:!1})}else l[o]?Object.defineProperty(e,t,{get:s(o),set:p(o),enumerable:!0,configurable:!1}):e[t]=u(n[o].type)}function h(e){var t;if(Array.isArray(e)){t=Array(e.length);for(var a=0;a<e.length;++a)g(t,a,e[a])}else for(var o in t={},e)g(t,o,e[o]);return t}var m=r(n,!0);return{get:a(h(m)),set:p(m),enumerable:!0,configurable:!0}}},{"./GLError":289,"./reflect":292}],292:[function(e,t){"use strict";function a(e,t){for(var a={},r=0;r<e.length;++r)for(var l=e[r].name,n=l.split("."),s=a,d=0,c;d<n.length;++d)if(c=n[d].split("["),1<c.length){c[0]in s||(s[c[0]]=[]),s=s[c[0]];for(var p=1,u;p<c.length;++p)u=parseInt(c[p]),p<c.length-1||d<n.length-1?(!(u in s)&&(p<c.length-1?s[u]=[]:s[u]={}),s=s[u]):t?s[u]=r:s[u]=e[r].type}else d<n.length-1?(c[0]in s||(s[c[0]]={}),s=s[c[0]]):s[c[0]]=t?r:e[r].type;return a}t.exports=a},{}],293:[function(e,t,a){"use strict";function o(e,t){if(!n){var a=Object.keys(r);n={};for(var o=0,l;o<a.length;++o)l=a[o],n[e[l]]=r[l]}return n[t]}a.uniforms=function(e,t){for(var a=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),r=[],n=0,l;n<a;++n)if(l=e.getActiveUniform(t,n),l){var s=o(e,l.type);if(1<l.size)for(var d=0;d<l.size;++d)r.push({name:l.name.replace("[0]","["+d+"]"),type:s});else r.push({name:l.name,type:s})}return r},a.attributes=function(e,t){for(var a=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),r=[],n=0,l;n<a;++n)l=e.getActiveAttrib(t,n),l&&r.push({name:l.name,type:o(e,l.type)});return r};var r={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},n=null},{}],294:[function(e,t,a){"use strict";function o(e,t,a,o,r,i,n){this.id=e,this.src=t,this.type=a,this.shader=o,this.count=i,this.programs=[],this.cache=n}function r(e){this.gl=e,this.shaders=[{},{}],this.programs={}}function i(e,t,a){var o=e.createShader(t);if(e.shaderSource(o,a),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS)){var r=e.getShaderInfoLog(o);try{var i=d(r,a,t)}catch(t){throw console.warn("Failed to format compiler error: "+t),new s(r,"Error compiling shader:\n"+r)}throw new s(r,i.short,i.long)}return o}function n(e,t,a,o,r){var n=e.createProgram();e.attachShader(n,t),e.attachShader(n,a);for(var l=0;l<o.length;++l)e.bindAttribLocation(n,r[l],o[l]);if(e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){var d=e.getProgramInfoLog(n);throw new s(d,"Error linking program: "+d)}return n}function l(e){var t=p.get(e);return t||(t=new r(e),p.set(e,t)),t}a.shader=function(e,t,a){return l(e).getShaderReference(t,a)},a.program=function(e,t,a,o,r){return l(e).getProgram(t,a,o,r)};var s=e("./GLError"),d=e("gl-format-compiler-error"),c="undefined"==typeof WeakMap?e("weakmap-shim"):WeakMap,p=new c,u=0;o.prototype.dispose=function(){if(0==--this.count){for(var e=this.cache,t=e.gl,a=this.programs,o=0,r=a.length,n;o<r;++o)n=e.programs[a[o]],n&&(delete e.programs[o],t.deleteProgram(n));t.deleteShader(this.shader),delete e.shaders[0|this.type===t.FRAGMENT_SHADER][this.src]}};var g=r.prototype;g.getShaderReference=function(e,t){var a=this.gl,r=this.shaders[0|e===a.FRAGMENT_SHADER],n=r[t];if(!n||!a.isShader(n.shader)){var l=i(a,e,t);n=r[t]=new o(u++,t,e,l,[],1,this)}else n.count+=1;return n},g.getProgram=function(e,t,a,o){var r=[e.id,t.id,a.join(":"),o.join(":")].join("@"),i=this.programs[r];return i&&this.gl.isProgram(i)||(this.programs[r]=i=n(this.gl,e.shader,t.shader,a,o),e.programs.push(r),t.programs.push(r)),i}},{"./GLError":289,"gl-format-compiler-error":240,"weakmap-shim":531}],295:[function(e,t){"use strict";function a(e){this.plot=e,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}t.exports=function(e,t){var o=new a(e);return o.update(t),e.addOverlay(o),o};var o=a.prototype;o.update=function(e){e=e||{},this.enable=(e.enable||[!0,!0,!1,!1]).slice(),this.width=(e.width||[1,1,1,1]).slice(),this.color=(e.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(e){return e.slice()}),this.center=(e.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},o.draw=function(){var e=this.enable,t=this.width,a=this.color,o=this.center,r=this.plot,i=r.line,n=r.dataBox,l=r.viewBox;if(i.bind(),n[0]<=o[0]&&o[0]<=n[2]&&n[1]<=o[1]&&o[1]<=n[3]){var s=l[0]+(o[0]-n[0])/(n[2]-n[0])*(l[2]-l[0]),d=l[1]+(o[1]-n[1])/(n[3]-n[1])*(l[3]-l[1]);e[0]&&i.drawLine(s,d,l[0],d,t[0],a[0]),e[1]&&i.drawLine(s,d,s,l[1],t[1],a[1]),e[2]&&i.drawLine(s,d,l[2],d,t[2],a[2]),e[3]&&i.drawLine(s,d,s,l[3],t[3],a[3])}},o.dispose=function(){this.plot.removeOverlay(this)}},{}],296:[function(e,t){"use strict";var a=e("glslify"),o=e("gl-shader"),r=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n"]),i=a(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}"]);t.exports=function(e){return o(e,r,i,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":288,glslify:392}],297:[function(e,t){"use strict";function a(e,t,a,o){this.gl=e,this.buffer=t,this.vao=a,this.shader=o,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var o=e("gl-buffer"),r=e("gl-vao"),i=e("./shaders/index");t.exports=function(e,t){function n(e,t,a,o,r,i){var n=[e,t,a,0,0,0,1];n[o+3]=1,n[o]=r,s.push.apply(s,n),n[6]=-1,s.push.apply(s,n),n[o]=i,s.push.apply(s,n),s.push.apply(s,n),n[6]=1,s.push.apply(s,n),n[o]=r,s.push.apply(s,n)}var s=[];n(0,0,0,0,0,1),n(0,0,0,1,0,1),n(0,0,0,2,0,1),n(1,0,0,1,-1,1),n(1,0,0,2,-1,1),n(0,1,0,0,-1,1),n(0,1,0,2,-1,1),n(0,0,1,0,-1,1),n(0,0,1,1,-1,1);var d=o(e,s),c=r(e,[{type:e.FLOAT,buffer:d,size:3,offset:0,stride:28},{type:e.FLOAT,buffer:d,size:3,offset:12,stride:28},{type:e.FLOAT,buffer:d,size:1,offset:24,stride:28}]),p=i(e);p.attributes.position.location=0,p.attributes.color.location=1,p.attributes.weight.location=2;var u=new a(e,d,c,p);return u.update(t),u};var n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l=a.prototype,s=[0,0,0],d=[0,0,0],c=[0,0];l.isTransparent=function(){return!1},l.drawTransparent=function(){},l.draw=function(e){var t=this.gl,a=this.vao,o=this.shader;a.bind(),o.bind();var r=e.model||n,l=e.view||n,p=e.projection||n,u;this.axes&&(u=this.axes.lastCubeProps.axis);for(var g=s,h=d,m=0;3>m;++m)u&&0>u[m]?(g[m]=this.bounds[0][m],h[m]=this.bounds[1][m]):(g[m]=this.bounds[1][m],h[m]=this.bounds[0][m]);c[0]=t.drawingBufferWidth,c[1]=t.drawingBufferHeight,o.uniforms.model=r,o.uniforms.view=l,o.uniforms.projection=p,o.uniforms.coordinates=[this.position,g,h],o.uniforms.colors=this.colors,o.uniforms.screenShape=c;for(var m=0;3>m;++m)o.uniforms.lineWidth=this.lineWidth[m]*this.pixelRatio,this.enabled[m]&&(a.draw(t.TRIANGLES,6,6*m),this.drawSides[m]&&a.draw(t.TRIANGLES,12,18+12*m));a.unbind()},l.update=function(e){e&&("bounds"in e&&(this.bounds=e.bounds),"position"in e&&(this.position=e.position),"lineWidth"in e&&(this.lineWidth=e.lineWidth),"colors"in e&&(this.colors=e.colors),"enabled"in e&&(this.enabled=e.enabled),"drawSides"in e&&(this.drawSides=e.drawSides))},l.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":296,"gl-buffer":230,"gl-vao":310}],298:[function(e,t,a){arguments[4][232][0].apply(a,arguments)},{barycentric:61,dup:232,"polytope-closest-point/lib/closest_point_2d.js":464}],299:[function(e,t,a){var o=e("glslify"),r=o(["precision mediump float;\n#define GLSLIFY 1\n\nfloat inverse(float m) {\n  return 1.0 / m;\n}\n\nmat2 inverse(mat2 m) {\n  return mat2(m[1][1],-m[0][1],\n             -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\n}\n\nmat3 inverse(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n              b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n              b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nmat4 inverse(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\nuniform float tubeScale;\n\nuniform mat4 model\n           , view\n           , projection;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data\n           , f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n  normal = normalize(normal * inverse(mat3(model)));\n\n  gl_Position      = projection * view * tubePosition;\n  f_color          = color;\n  f_normal         = normal;\n  f_data           = tubePosition.xyz;\n  f_position       = position.xyz;\n  f_eyeDirection   = eyePosition   - tubePosition.xyz;\n  f_lightDirection = lightPosition - tubePosition.xyz;\n  f_uv             = uv;\n}\n"]),i=o(["precision mediump float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular\n            , opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data\n           , f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(!gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = cookTorranceSpecular(L, V, N, roughness, fresnel);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor =  texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}"]),n=o(["precision mediump float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float tubeScale;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  gl_Position = projection * view * tubePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),l=o(["precision mediump float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);a.meshShader={vertex:r,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},a.pickShader={vertex:n,fragment:l,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:392}],300:[function(e,t){"use strict";function a(e,t,a,o,r,i,n,l,s,d,c,p,u,g,h,m,y,f,x,b,_,v,w,k,T,S,C,L){this.gl=e,this.cells=[],this.positions=[],this.intensity=[],this.texture=t,this.dirty=!0,this.triShader=a,this.lineShader=o,this.pointShader=r,this.pickShader=i,this.pointPickShader=n,this.contourShader=l,this.trianglePositions=s,this.triangleVectors=d,this.triangleColors=p,this.triangleNormals=g,this.triangleUVs=u,this.triangleIds=c,this.triangleVAO=h,this.triangleCount=0,this.lineWidth=1,this.edgePositions=m,this.edgeColors=f,this.edgeUVs=x,this.edgeIds=y,this.edgeVAO=b,this.edgeCount=0,this.pointPositions=_,this.pointColors=w,this.pointUVs=k,this.pointSizes=T,this.pointIds=v,this.pointVAO=S,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=C,this.contourVAO=L,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!1,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.tubeScale=1,this._model=A,this._view=A,this._projection=A,this._resolution=[1,1]}function o(e){for(var t=f({colormap:e,nshades:256,format:"rgba"}),a=new Uint8Array(1024),o=0,r;256>o;++o){r=t[o];for(var n=0;3>n;++n)a[4*o+n]=r[n];a[4*o+3]=255*r[3]}return y(a,[256,256,4],[4,0,1])}function r(e,t,a){for(var o=Array(t),r=0;r<t;++r)o[r]=0;for(var n=e.length,r=0,l;r<n;++r){l=e[r];for(var s=0;s<l.length;++s)o[l[s]]=a[r]}return o}function n(e){for(var t=e.length,a=Array(t),o=0;o<t;++o)a[o]=e[o][2];return a}function l(e){var t=d(e,k.vertex,k.fragment,null,k.attributes);return t.attributes.position.location=0,t.attributes.color.location=2,t.attributes.uv.location=3,t.attributes.vector.location=5,t}function s(e){var t=d(e,T.vertex,T.fragment,null,T.attributes);return t.attributes.position.location=0,t.attributes.id.location=1,t.attributes.vector.location=5,t}var d=e("gl-shader"),c=e("gl-buffer"),p=e("gl-vao"),u=e("gl-texture2d"),g=e("normals"),h=e("gl-mat4/multiply"),m=e("gl-mat4/invert"),y=e("ndarray"),f=e("colormap"),x=e("simplicial-complex-contour"),_=e("typedarray-pool"),v=e("./shaders"),w=e("./closest-point"),k=v.meshShader,T=v.pickShader,A=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],S=a.prototype;S.isOpaque=function(){return 1<=this.opacity},S.isTransparent=function(){return 1>this.opacity},S.pickSlots=1,S.setPickBase=function(e){this.pickId=e},S.highlight=function(e){if(!e||!this.contourEnable)return void(this.contourCount=0);for(var t=x(this.cells,this.intensity,e.intensity),o=t.cells,r=t.vertexIds,n=t.vertexWeights,l=o.length,s=_.mallocFloat32(6*l),d=0,p=0,u;p<l;++p){u=o[p];for(var g=0,h;2>g;++g){h=u[0],2===u.length&&(h=u[g]);for(var m=r[h][0],a=r[h][1],y=n[h],f=this.positions[m],b=this.positions[a],w=0;3>w;++w)s[d++]=y*f[w]+(1-y)*b[w]}}this.contourCount=0|d/3,this.contourPositions.update(s.subarray(0,d)),_.free(s)},S.update=function(e){e=e||{};var t=this.gl;this.dirty=!0,"contourEnable"in e&&(this.contourEnable=e.contourEnable),"contourColor"in e&&(this.contourColor=e.contourColor),"lineWidth"in e&&(this.lineWidth=e.lineWidth),"lightPosition"in e&&(this.lightPosition=e.lightPosition),"opacity"in e&&(this.opacity=e.opacity),"ambient"in e&&(this.ambientLight=e.ambient),"diffuse"in e&&(this.diffuseLight=e.diffuse),"specular"in e&&(this.specularLight=e.specular),"roughness"in e&&(this.roughness=e.roughness),"fresnel"in e&&(this.fresnel=e.fresnel),e.texture?(this.texture.dispose(),this.texture=u(t,e.texture)):e.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=t.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=t.LINEAR,this.texture.setPixels(o(e.colormap)),this.texture.generateMipmap());var a=e.cells,l=e.positions,s=e.vectors;if(l&&a&&s){void 0!==e.tubeScale&&(this.tubeScale=e.tubeScale);var d=[],h=[],m=[],y=[],x=[],b=[],_=[],T=[],A=[],S=[],C=[],L=[],E=[],z=[],I=[];this.cells=a,this.positions=l,this.vectors=s;var D=e.vertexNormals,P=e.cellNormals,O=void 0===e.vertexNormalsEpsilon?1e-6:e.vertexNormalsEpsilon,R=void 0===e.faceNormalsEpsilon?1e-6:e.faceNormalsEpsilon;e.useFacetNormals&&!P&&(P=g.faceNormals(a,l,R)),P||D||(D=g.vertexNormals(a,l,O));var M=e.vertexColors,B=e.cellColors,F=e.meshColor||[1,1,1,1],N=e.vertexUVs,V=e.vertexIntensity,U=e.cellUVs,H=e.cellIntensity,G=1/0,Y=-Infinity;if(!N&&!U)if(V){if(e.vertexIntensityBounds)G=+e.vertexIntensityBounds[0],Y=+e.vertexIntensityBounds[1];else for(var W=0,X;W<V.length;++W)X=V[W],G=ie(G,X),Y=va(Y,X);}else if(H)for(var W=0,X;W<H.length;++W)X=H[W],G=ie(G,X),Y=va(Y,X);else for(var W=0,X;W<l.length;++W)X=l[W][2],G=ie(G,X),Y=va(Y,X);this.intensity=V?V:H?r(a,l.length,H):n(l);var Z=e.pointSizes,$=e.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]];for(var W=0,J;W<l.length;++W){J=l[W];for(var K=0;3>K;++K)!isNaN(J[K])&&isFinite(J[K])&&(this.bounds[0][K]=ie(this.bounds[0][K],J[K]),this.bounds[1][K]=va(this.bounds[1][K],J[K]))}var Q=0,ee=0,te=0;fill_loop:for(var W=0,ae;W<a.length;++W)switch(ae=a[W],ae.length){case 1:for(var oe=ae[0],J=l[oe],K=0;3>K;++K)if(isNaN(J[K])||!isFinite(J[K]))continue fill_loop;C.push(J[0],J[1],J[2],J[3]);var re;re=M?M[oe]:B?B[W]:F,3===re.length?L.push(re[0],re[1],re[2],1):L.push(re[0],re[1],re[2],re[3]);var ne;ne=N?N[oe]:V?[(V[oe]-G)/(Y-G),0]:U?U[W]:H?[(H[W]-G)/(Y-G),0]:[(J[2]-G)/(Y-G),0],E.push(ne[0],ne[1]),Z?z.push(Z[oe]):z.push($),I.push(W),te+=1;break;case 2:for(var K=0;2>K;++K)for(var oe=ae[K],J=l[oe],le=0;3>le;++le)if(isNaN(J[le])||!isFinite(J[le]))continue fill_loop;for(var K=0;2>K;++K){var oe=ae[K],J=l[oe];_.push(J[0],J[1],J[2]);var re;re=M?M[oe]:B?B[W]:F,3===re.length?T.push(re[0],re[1],re[2],1):T.push(re[0],re[1],re[2],re[3]);var ne;ne=N?N[oe]:V?[(V[oe]-G)/(Y-G),0]:U?U[W]:H?[(H[W]-G)/(Y-G),0]:[(J[2]-G)/(Y-G),0],A.push(ne[0],ne[1]),S.push(W)}ee+=1;break;case 3:for(var K=0;3>K;++K)for(var oe=ae[K],J=l[oe],le=0;3>le;++le)if(isNaN(J[le])||!isFinite(J[le]))continue fill_loop;for(var K=0;3>K;++K){var oe=ae[K],J=l[oe];d.push(J[0],J[1],J[2],J[3]);var se=s[oe];h.push(se[0],se[1],se[2],se[3]);var re;re=M?M[oe]:B?B[W]:F,3===re.length?m.push(re[0],re[1],re[2],1):m.push(re[0],re[1],re[2],re[3]);var ne;ne=N?N[oe]:V?[(V[oe]-G)/(Y-G),0]:U?U[W]:H?[(H[W]-G)/(Y-G),0]:[(J[2]-G)/(Y-G),0],x.push(ne[0],ne[1]);var w;w=D?D[oe]:P[W],y.push(w[0],w[1],w[2]),b.push(W)}Q+=1;break;default:}this.pointCount=te,this.edgeCount=ee,this.triangleCount=Q,this.pointPositions.update(C),this.pointColors.update(L),this.pointUVs.update(E),this.pointSizes.update(z),this.pointIds.update(new Uint32Array(I)),this.edgePositions.update(_),this.edgeColors.update(T),this.edgeUVs.update(A),this.edgeIds.update(new Uint32Array(S)),this.trianglePositions.update(d),this.triangleVectors.update(h),this.triangleColors.update(m),this.triangleUVs.update(x),this.triangleNormals.update(y),this.triangleIds.update(new Uint32Array(b))}},S.drawTransparent=S.draw=function(e){e=e||{};for(var t=this.gl,a=e.model||A,o=e.view||A,r=e.projection||A,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;3>l;++l)n[0][l]=va(n[0][l],this.clipBounds[0][l]),n[1][l]=ie(n[1][l],this.clipBounds[1][l]);var d={model:a,view:o,projection:r,clipBounds:n,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,contourColor:this.contourColor,texture:0};this.texture.bind(0);var c=Array(16);h(c,d.view,d.model),h(c,d.projection,c),m(c,c);for(var l=0;3>l;++l)d.eyePosition[l]=c[12+l]/c[15];for(var p=c[15],l=0;3>l;++l)p+=this.lightPosition[l]*c[4*l+3];for(var l=0,u;3>l;++l){u=c[12+l];for(var g=0;3>g;++g)u+=c[4*g+l]*this.lightPosition[g];d.lightPosition[l]=u/p}if(0<this.triangleCount){var y=this.triShader;y.bind(),y.uniforms=d,this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}if(0<this.edgeCount&&0<this.lineWidth){var y=this.lineShader;y.bind(),y.uniforms=d,this.edgeVAO.bind(),t.lineWidth(this.lineWidth),t.drawArrays(t.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()}if(0<this.pointCount){var y=this.pointShader;y.bind(),y.uniforms=d,this.pointVAO.bind(),t.drawArrays(t.POINTS,0,this.pointCount),this.pointVAO.unbind()}if(this.contourEnable&&0<this.contourCount&&0<this.contourLineWidth){var y=this.contourShader;y.bind(),y.uniforms=d,this.contourVAO.bind(),t.drawArrays(t.LINES,0,this.contourCount),this.contourVAO.unbind()}},S.drawPick=function(e){e=e||{};for(var t=this.gl,a=e.model||A,o=e.view||A,r=e.projection||A,n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;3>l;++l)n[0][l]=va(n[0][l],this.clipBounds[0][l]),n[1][l]=ie(n[1][l],this.clipBounds[1][l]);this._model=[].slice.call(a),this._view=[].slice.call(o),this._projection=[].slice.call(r),this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];var s={model:a,view:o,projection:r,clipBounds:n,tubeScale:this.tubeScale,pickId:this.pickId/255},d=this.pickShader;if(d.bind(),d.uniforms=s,0<this.triangleCount&&(this.triangleVAO.bind(),t.drawArrays(t.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),0<this.edgeCount&&(this.edgeVAO.bind(),t.lineWidth(this.lineWidth),t.drawArrays(t.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),0<this.pointCount){var d=this.pointPickShader;d.bind(),d.uniforms=s,this.pointVAO.bind(),t.drawArrays(t.POINTS,0,this.pointCount),this.pointVAO.unbind()}},S.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;var t=e.value[0]+256*e.value[1]+65536*e.value[2],a=this.cells[t],o=this.positions[a[1]].slice(0,3),r=this.intensity[a[1]],i=this.vectors[a[1]].slice(0,3),n=this.vectors[a[1]][3];return{index:t,position:o,intensity:r,velocity:i,divergence:n,dataCoordinate:o}},S.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose()},t.exports=function(e,t){1===arguments.length&&(t=e,e=t.gl);var o=t.triShader||l(e),r=s(e),i=u(e,y(new Uint8Array([255,255,255,255]),[1,1,4]));i.generateMipmap(),i.minFilter=e.LINEAR_MIPMAP_LINEAR,i.magFilter=e.LINEAR;var n=c(e),d=c(e),g=c(e),h=c(e),m=c(e),f=c(e),x=p(e,[{buffer:n,type:e.FLOAT,size:4},{buffer:f,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:g,type:e.FLOAT,size:4},{buffer:h,type:e.FLOAT,size:2},{buffer:m,type:e.FLOAT,size:3},{buffer:d,type:e.FLOAT,size:4}]),b=c(e),_=c(e),v=c(e),w=c(e),k=p(e,[{buffer:b,type:e.FLOAT,size:3},{buffer:w,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:_,type:e.FLOAT,size:4},{buffer:v,type:e.FLOAT,size:2}]),T=c(e),A=c(e),S=c(e),C=c(e),L=c(e),E=p(e,[{buffer:T,type:e.FLOAT,size:3},{buffer:L,type:e.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:A,type:e.FLOAT,size:4},{buffer:S,type:e.FLOAT,size:2},{buffer:C,type:e.FLOAT,size:1}]),z=c(e),I=p(e,[{buffer:z,type:e.FLOAT,size:3}]),D=new a(e,i,o,null,null,r,null,null,n,d,f,g,h,m,x,b,w,_,v,k,T,L,A,S,C,E,z,I);return D.update(t),D}},{"./closest-point":298,"./shaders":299,colormap:114,"gl-buffer":230,"gl-mat4/invert":254,"gl-mat4/multiply":256,"gl-shader":288,"gl-texture2d":305,"gl-vao":310,ndarray:433,normals:436,"simplicial-complex-contour":494,"typedarray-pool":521}],301:[function(e,t){"use strict";var o=e("gl-vec3"),n=e("gl-vec4"),l=function(e,t,l,s){var d=e.points,c=e.velocities,g=e.divergences,h,m,y,f,x,b;b=o.set(o.create(),0,1,0),f=o.create(),x=o.create();for(var _=o.create(),w=[],k=[],T=[],A=[],S=[],C=[],L=0,E=0,z=n.create(),I=n.create(),D=8,P=0;P<d.length;P++){h=d[P],m=c[P],y=g[P],0===t&&(y=.05*l),E=o.length(m)/s,z=n.create(),o.copy(z,m),z[3]=y;for(var O=0;O<D;O++)S[O]=[h[0],h[1],h[2],O];if(0<A.length)for(var O=0,R;O<D;O++)R=(O+1)%D,w.push(A[O],S[O],S[R],S[R],A[R],A[O]),T.push(I,z,z,z,I,I),C.push(L,E,E,E,L,L),k.push([w.length-6,w.length-5,w.length-4],[w.length-3,w.length-2,w.length-1]);var M=A;A=S,S=M,M=I,I=z,z=M,M=L,L=E,E=M}return{positions:w,cells:k,vectors:T,vertexIntensity:C}},s=function(e,t,a,r){for(var n=0,s=0,d;s<e.length;s++){d=e[s].velocities;for(var c=0,p;c<d.length;c++)p=o.length(d[c]),p>n&&(n=p)}for(var u=e.map(function(e){return l(e,a,r,n)}),g=[],h=[],m=[],y=[],s=0;s<u.length;s++){var f=u[s],x=g.length;g=g.concat(f.positions),m=m.concat(f.vectors),y=y.concat(f.vertexIntensity);for(var c=0;c<f.cells.length;c++){var b=f.cells[c],_=[];h.push(_);for(var v=0;v<b.length;v++)_.push(b[v]+x)}}return{positions:g,cells:h,vectors:m,vertexIntensity:y,colormap:t}},d=function(t,a){var r=o.create(),i=1/1e4;o.add(r,t,[i,0,0]);var e=this.getVelocity(r);o.subtract(e,e,a),o.scale(e,e,1/i),o.add(r,t,[0,i,0]);var n=this.getVelocity(r);o.subtract(n,n,a),o.scale(n,n,1/i),o.add(r,t,[0,0,i]);var l=this.getVelocity(r);return o.subtract(l,l,a),o.scale(l,l,1/i),o.add(r,e,n),o.add(r,r,l),r},c=function(e){var t=y(e,this.vectors,this.meshgrid,this.clampBorders);return t},p=function(e,t){for(var a=0,o;a<e.length;a++){if(o=e[a],o===t)return a;if(o>t)return a-1}return a},u=o.create(),g=o.create(),m=function(e,t,a){return e<t?t:e>a?a:e},y=function(e,t,a,r){var i=e[0],n=e[1],l=e[2],s=a[0].length,c=a[1].length,h=a[2].length,d=p(a[0],i),y=p(a[1],n),f=p(a[2],l),x=d+1,b=y+1,_=f+1;if(a[0][d]===i&&(x=d),a[1][y]===n&&(b=y),a[2][f]===l&&(_=f),r&&(d=m(d,0,s-1),x=m(x,0,s-1),y=m(y,0,c-1),b=m(b,0,c-1),f=m(f,0,h-1),_=m(_,0,h-1)),0>d||0>y||0>f||x>=s||b>=c||_>=h)return o.create();var v=(i-a[0][d])/(a[0][x]-a[0][d]),w=(n-a[1][y])/(a[1][b]-a[1][y]),k=(l-a[2][f])/(a[2][_]-a[2][f]);(0>v||1<v||isNaN(v))&&(v=0),(0>w||1<w||isNaN(w))&&(w=0),(0>k||1<k||isNaN(k))&&(k=0);var T=f*s*c,A=_*s*c,S=y*s,C=b*s,L=d,E=x,z=t[S+T+L],I=t[S+T+E],D=t[C+T+L],P=t[C+T+E],O=t[S+A+L],R=t[S+A+E],M=t[C+A+L],j=t[C+A+E],B=o.create();return o.lerp(B,z,I,v),o.lerp(u,D,P,v),o.lerp(B,B,u,w),o.lerp(u,O,R,v),o.lerp(g,M,j,v),o.lerp(u,u,g,w),o.lerp(B,B,u,k),B},f=function(e){var t=1/0;e.sort(function(e,t){return e-t});for(var a=1,o;a<e.length;a++)o=wa(e[a]-e[a-1]),o<t&&(t=o);return t},x=function(e){for(var t=[],a=[],o=[],r={},n={},l={},s=0;s<e.length;s++){var d=e[s],c=d[0],p=d[1],u=d[2];r[c]||(t.push(c),r[c]=!0),n[p]||(a.push(p),n[p]=!0),l[u]||(o.push(u),l[u]=!0)}var g=f(t),h=f(a),m=f(o),y=ie(g,h,m);return isFinite(y)?y:1};t.exports=function(e,t){var a=e.startingPositions,r=e.maxLength||1e3,n=e.tubeSize||1,l=e.absoluteTubeSize;e.getDivergence||(e.getDivergence=d),e.getVelocity||(e.getVelocity=c),void 0===e.clampBorders&&(e.clampBorders=!0);var u=[],g=t[0][0],h=t[0][1],m=t[0][2],f=t[1][0],b=t[1][1],_=t[1][2],w=function(e,t){var a=t[0],o=t[1],r=t[2];return a>=g&&a<=f&&o>=h&&o<=b&&r>=m&&r<=_},k=o.distance(t[0],t[1]),T=10*k/r,A=T*T,S=1,C=0,L=o.create();2<=a.length&&(S=x(a));for(var E=0,y;E<a.length;E++){y=o.create(),o.copy(y,a[E]);var z=[y],I=[],D=e.getVelocity(y),P=y;I.push(D);var O=[],R=e.getDivergence(y,D),M=o.length(R);M>C&&!isNaN(M)&&isFinite(M)&&(C=M),O.push(M),u.push({points:z,velocities:I,divergences:O});for(var B=0;B<100*r&&z.length<r&&w(t,y);){B++;var F=o.clone(D),N=o.squaredLength(F);if(0===N)break;else N>A&&o.scale(F,F,T/re(N));if(o.add(F,F,y),D=e.getVelocity(F),o.squaredDistance(P,F)-A>-1e-4*A){z.push(F),P=F,I.push(D);var R=e.getDivergence(F,D),M=o.length(R);M>C&&!isNaN(M)&&isFinite(M)&&(C=M),O.push(M)}y=F}}for(var E=0,M;E<O.length;E++)M=O[E],(isNaN(M)||!isFinite(M))&&(O[E]=C);var V=s(u,e.colormap,C,S);return l?V.tubeScale=l:(0===C&&(C=1),V.tubeScale=.5*n*S/C),V},t.exports.createTubeMesh=e("./lib/tubemesh")},{"./lib/tubemesh":300,"gl-vec3":329,"gl-vec4":365}],302:[function(e,t,a){var o=e("gl-shader"),r=e("glslify"),i=r(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute vec3 f;\nattribute vec3 normal;\n\nuniform vec3 objectOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 lightPosition, eyePosition;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 localCoordinate = vec3(uv.zw, f.x);\n  worldCoordinate = objectOffset + localCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  gl_Position = clipPosition;\n  kill = f.y;\n  value = f.z;\n  planeCoordinate = uv.xy;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * worldPosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  lightDirection = lightPosition - cameraCoordinate.xyz;\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\n}\n"]),n=r(["precision mediump float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat beckmannSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform float vertexColor;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  if ((kill > 0.0) ||\n      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;\n\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  //decide how to interpolate color \u2014 in vertex or in fragment\n  vec4 surfaceColor =\n    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +\n    step(.5, vertexColor) * vColor;\n\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\n}\n"]),l=r(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute float f;\n\nuniform vec3 objectOffset;\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  worldCoordinate = objectOffset + dataCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z += zOffset;\n\n  gl_Position = clipPosition;\n  value = f + objectOffset.z;\n  kill = -1.0;\n  planeCoordinate = uv.zw;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Don't do lighting for contours\n  surfaceNormal   = vec3(1,0,0);\n  eyeDirection    = vec3(0,1,0);\n  lightDirection  = vec3(0,0,1);\n}\n"]),s=r(["precision mediump float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\n\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\n\nvoid main() {\n  if ((kill > 0.0) ||\n      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;\n\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\n}\n"]);a.createShader=function(e){var t=o(e,i,n,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t.attributes.normal.location=2,t},a.createPickShader=function(e){var t=o(e,i,s,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t.attributes.normal.location=2,t},a.createContourShader=function(e){var t=o(e,l,n,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t},a.createPickContourShader=function(e){var t=o(e,l,s,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return t.attributes.uv.location=0,t.attributes.f.location=1,t}},{"gl-shader":288,glslify:392}],303:[function(e,t){"use strict";function a(e,t,a,o,r){this.position=e,this.index=t,this.uv=a,this.level=o,this.dataCoordinate=r}function o(e){var t=w([_({colormap:e,nshades:256,format:"rgba"}).map(function(e){return[e[0],e[1],e[2],255*e[3]]})]);return v.divseq(t,255),t}function r(e,t,o,r,i,n,l,s,d,c,p,u,g,h,m){this.gl=e,this.shape=t,this.bounds=o,this.objectOffset=m,this.intensityBounds=[],this._shader=r,this._pickShader=i,this._coordinateBuffer=n,this._vao=l,this._colorMap=s,this._contourShader=d,this._contourPickShader=c,this._contourBuffer=p,this._contourVAO=u,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new a([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=g,this._dynamicVAO=h,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[T(b.mallocFloat(1024),[0,0]),T(b.mallocFloat(1024),[0,0]),T(b.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.snapToData=!1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}function n(e,t){var a=t.axes&&t.axes.lastCubeProps.axis||N,o=t.showSurface,r=t.showContour,n,l,s;for(n=0;3>n;++n)for(o=o||t.surfaceProject[n],l=0;3>l;++l)r=r||t.contourProject[n][l];for(n=0;3>n;++n){var d=V.projections[n];for(l=0;16>l;++l)d[l]=0;for(l=0;4>l;++l)d[5*l]=1;d[5*n]=0,d[12+n]=t.axesBounds[+(0<a[n])][n],S(d,e.model,d);var c=V.clipBounds[n];for(s=0;2>s;++s)for(l=0;3>l;++l)c[s][l]=e.clipBounds[s][l];c[0][n]=-1e8,c[1][n]=1e8}return V.showSurface=o,V.showContour=r,V}function l(e,t){e=e||{};var a=this.gl;a.disable(a.CULL_FACE),this._colorMap.bind(0);var o=U;o.model=e.model||R,o.view=e.view||R,o.projection=e.projection||R,o.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],o.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],o.objectOffset=this.objectOffset,o.contourColor=this.contourColor[0],o.inverseModel=C(o.inverseModel,o.model);for(var r=0,l;2>r;++r){l=o.clipBounds[r];for(var d=0;3>d;++d)l[d]=ie(va(this.clipBounds[r][d],-1e8),1e8)}o.kambient=this.ambientLight,o.kdiffuse=this.diffuseLight,o.kspecular=this.specularLight,o.roughness=this.roughness,o.fresnel=this.fresnel,o.opacity=this.opacity,o.height=0,o.permutation=G,o.vertexColor=this.vertexColor;var c=H;for(S(c,o.view,o.model),S(c,o.projection,c),C(c,c),r=0;3>r;++r)o.eyePosition[r]=c[12+r]/c[15];var p=c[15];for(r=0;3>r;++r)p+=this.lightPosition[r]*c[4*r+3];for(r=0;3>r;++r){var u=c[12+r];for(d=0;3>d;++d)u+=c[4*d+r]*this.lightPosition[d];o.lightPosition[r]=u/p}var g=n(o,this);if(g.showSurface&&t===1>this.opacity){for(this._shader.bind(),this._shader.uniforms=o,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(a.TRIANGLES,this._vertexCount),r=0;3>r;++r)this.surfaceProject[r]&&this.vertexCount&&(this._shader.uniforms.model=g.projections[r],this._shader.uniforms.clipBounds=g.clipBounds[r],this._vao.draw(a.TRIANGLES,this._vertexCount));this._vao.unbind()}if(g.showContour&&!t){var h=this._contourShader;o.kambient=1,o.kdiffuse=0,o.kspecular=0,o.opacity=1,h.bind(),h.uniforms=o;var m=this._contourVAO;for(m.bind(),r=0;3>r;++r)for(h.uniforms.permutation=B[r],a.lineWidth(this.contourWidth[r]),d=0;d<this.contourLevels[r].length;++d)(d===this.highlightLevel[r]?(h.uniforms.contourColor=this.highlightColor[r],h.uniforms.contourTint=this.highlightTint[r]):(0===d||d-1===this.highlightLevel[r])&&(h.uniforms.contourColor=this.contourColor[r],h.uniforms.contourTint=this.contourTint[r]),!!this._contourCounts[r][d])&&(h.uniforms.height=this.contourLevels[r][d],m.draw(a.LINES,this._contourCounts[r][d],this._contourOffsets[r][d]));for(r=0;3>r;++r)for(h.uniforms.model=g.projections[r],h.uniforms.clipBounds=g.clipBounds[r],d=0;3>d;++d)if(this.contourProject[r][d]){h.uniforms.permutation=B[d],a.lineWidth(this.contourWidth[d]);for(var y=0;y<this.contourLevels[d].length;++y)y===this.highlightLevel[d]?(h.uniforms.contourColor=this.highlightColor[d],h.uniforms.contourTint=this.highlightTint[d]):(0===y||y-1===this.highlightLevel[d])&&(h.uniforms.contourColor=this.contourColor[d],h.uniforms.contourTint=this.contourTint[d]),h.uniforms.height=this.contourLevels[d][y],m.draw(a.LINES,this._contourCounts[d][y],this._contourOffsets[d][y])}for(m.unbind(),m=this._dynamicVAO,m.bind(),r=0;3>r;++r)if(0!==this._dynamicCounts[r])for(h.uniforms.model=o.model,h.uniforms.clipBounds=o.clipBounds,h.uniforms.permutation=B[r],a.lineWidth(this.dynamicWidth[r]),h.uniforms.contourColor=this.dynamicColor[r],h.uniforms.contourTint=this.dynamicTint[r],h.uniforms.height=this.dynamicLevel[r],m.draw(a.LINES,this._dynamicCounts[r],this._dynamicOffsets[r]),d=0;3>d;++d)this.contourProject[d][r]&&(h.uniforms.model=g.projections[d],h.uniforms.clipBounds=g.clipBounds[d],m.draw(a.LINES,this._dynamicCounts[r],this._dynamicOffsets[r]));m.unbind()}}function d(e,t){return Array.isArray(e)?[t(e[0]),t(e[1]),t(e[2])]:[t(e),t(e),t(e)]}function p(e){return Array.isArray(e)?3===e.length?[e[0],e[1],e[2],1]:[e[0],e[1],e[2],e[3]]:[0,0,0,1]}function u(e){if(Array.isArray(e)){if(Array.isArray(e))return[p(e[0]),p(e[1]),p(e[2])];var t=p(e);return[t.slice(),t.slice(),t.slice()]}}t.exports=function(e){var t=e.gl,a=I(t),o=P(t),i=D(t),n=O(t),l=h(t),s=m(t,[{buffer:l,size:4,stride:40,offset:0},{buffer:l,size:3,stride:40,offset:16},{buffer:l,size:3,stride:40,offset:28}]),d=h(t),c=m(t,[{buffer:d,size:4,stride:20,offset:0},{buffer:d,size:1,stride:20,offset:16}]),p=h(t),u=m(t,[{buffer:p,size:2,type:t.FLOAT}]),g=y(t,1,256,t.RGBA,t.UNSIGNED_BYTE);g.minFilter=t.LINEAR,g.magFilter=t.LINEAR;var f=new r(t,[0,0],[[0,0,0],[0,0,0]],a,o,l,s,g,i,n,d,c,p,u,[0,0,0]),x={levels:[[],[],[]]};for(var b in e)x[b]=e[b];return x.colormap=x.colormap||"jet",f.update(x),f};var g=e("bit-twiddle"),h=e("gl-buffer"),m=e("gl-vao"),y=e("gl-texture2d"),b=e("typedarray-pool"),_=e("colormap"),v=e("ndarray-ops"),w=e("ndarray-pack"),T=e("ndarray"),A=e("surface-nets"),S=e("gl-mat4/multiply"),C=e("gl-mat4/invert"),L=e("binary-search-bounds"),E=e("ndarray-gradient"),z=e("./lib/shaders"),I=z.createShader,D=z.createContourShader,P=z.createPickShader,O=z.createPickContourShader,R=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],M=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],B=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];(function(){for(var e=0;3>e;++e){var t=B[e],a=(e+1)%3,o=(e+2)%3;t[a+0]=1,t[o+3]=1,t[e+6]=1}})();var F=r.prototype;F.isTransparent=function(){return 1>this.opacity},F.isOpaque=function(){if(1<=this.opacity)return!0;for(var e=0;3>e;++e)if(0<this._contourCounts[e].length||0<this._dynamicCounts[e])return!0;return!1},F.pickSlots=1,F.setPickBase=function(e){this.pickId=e};var N=[0,0,0],V={showSurface:!1,showContour:!1,projections:[R.slice(),R.slice(),R.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]},U={model:R,view:R,projection:R,inverseModel:R.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},H=R.slice(),G=[1,0,0,0,1,0,0,0,1];F.draw=function(e){return l.call(this,e,!1)},F.drawTransparent=function(e){return l.call(this,e,!0)};var Y={model:R,view:R,projection:R,inverseModel:R,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};F.drawPick=function(e){e=e||{};var t=this.gl;t.disable(t.CULL_FACE);var a=Y;a.model=e.model||R,a.view=e.view||R,a.projection=e.projection||R,a.shape=this._field[2].shape,a.pickId=this.pickId/255,a.lowerBound=this.bounds[0],a.upperBound=this.bounds[1],a.objectOffset=this.objectOffset,a.permutation=G;for(var o=0,r;2>o;++o){r=a.clipBounds[o];for(var l=0;3>l;++l)r[l]=ie(va(this.clipBounds[o][l],-1e8),1e8)}var s=n(a,this);if(s.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=a,this._vao.bind(),this._vao.draw(t.TRIANGLES,this._vertexCount),o=0;3>o;++o)this.surfaceProject[o]&&(this._pickShader.uniforms.model=s.projections[o],this._pickShader.uniforms.clipBounds=s.clipBounds[o],this._vao.draw(t.TRIANGLES,this._vertexCount));this._vao.unbind()}if(s.showContour){var d=this._contourPickShader;d.bind(),d.uniforms=a;var c=this._contourVAO;for(c.bind(),l=0;3>l;++l)for(t.lineWidth(this.contourWidth[l]),d.uniforms.permutation=B[l],o=0;o<this.contourLevels[l].length;++o)this._contourCounts[l][o]&&(d.uniforms.height=this.contourLevels[l][o],c.draw(t.LINES,this._contourCounts[l][o],this._contourOffsets[l][o]));for(o=0;3>o;++o)for(d.uniforms.model=s.projections[o],d.uniforms.clipBounds=s.clipBounds[o],l=0;3>l;++l)if(this.contourProject[o][l]){d.uniforms.permutation=B[l],t.lineWidth(this.contourWidth[l]);for(var p=0;p<this.contourLevels[l].length;++p)this._contourCounts[l][p]&&(d.uniforms.height=this.contourLevels[l][p],c.draw(t.LINES,this._contourCounts[l][p],this._contourOffsets[l][p]))}c.unbind()}},F.pick=function(e){if(!e)return null;if(e.id!==this.pickId)return null;var o=this._field[2].shape,n=this._pickResult,l=o[0]*(e.value[0]+(e.value[2]>>4)/16)/255,d=ea(l),p=l-d,u=o[1]*(e.value[1]+(15&e.value[2])/16)/255,g=ea(u),h=u-g;d+=1,g+=1;var m=n.position;m[0]=m[1]=m[2]=0;for(var y=0,f;2>y;++y){f=y?p:1-p;for(var x=0;2>x;++x)for(var _=x?h:1-h,t=d+y,r=g+x,c=f*_,v=0;3>v;++v)m[v]+=this._field[v].get(t,r)*c}for(var w=this._pickResult.level,k=0;3>k;++k)if(w[k]=L.le(this.contourLevels[k],m[k]),0>w[k])0<this.contourLevels[k].length&&(w[k]=0);else if(w[k]<this.contourLevels[k].length-1){var T=this.contourLevels[k][w[k]],a=this.contourLevels[k][w[k]+1];wa(T-m[k])>wa(a-m[k])&&(w[k]+=1)}for(n.index[0]=.5>p?d:d+1,n.index[1]=.5>h?g:g+1,n.uv[0]=l/o[0],n.uv[1]=u/o[1],v=0;3>v;++v)n.dataCoordinate[v]=this._field[v].get(n.index[0],n.index[1]);return n},F.padField=function(e,t){var a=t.shape.slice(),o=e.shape.slice();v.assign(e.lo(1,1).hi(a[0],a[1]),t),v.assign(e.lo(1).hi(a[0],1),t.hi(a[0],1)),v.assign(e.lo(1,o[1]-1).hi(a[0],1),t.lo(0,a[1]-1).hi(a[0],1)),v.assign(e.lo(0,1).hi(1,a[1]),t.hi(1)),v.assign(e.lo(o[0]-1,1).hi(1,a[1]),t.lo(a[0]-1)),e.set(0,0,t.get(0,0)),e.set(0,o[1]-1,t.get(0,a[1]-1)),e.set(o[0]-1,0,t.get(a[0]-1,0)),e.set(o[0]-1,o[1]-1,t.get(a[0]-1,a[1]-1))},F.update=function(a){a=a||{},this.objectOffset=a.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in a&&(this.contourWidth=d(a.contourWidth,Number)),"showContour"in a&&(this.showContour=d(a.showContour,Boolean)),"showSurface"in a&&(this.showSurface=!!a.showSurface),"contourTint"in a&&(this.contourTint=d(a.contourTint,Boolean)),"contourColor"in a&&(this.contourColor=u(a.contourColor)),"contourProject"in a&&(this.contourProject=d(a.contourProject,function(e){return d(e,Boolean)})),"surfaceProject"in a&&(this.surfaceProject=a.surfaceProject),"dynamicColor"in a&&(this.dynamicColor=u(a.dynamicColor)),"dynamicTint"in a&&(this.dynamicTint=d(a.dynamicTint,Number)),"dynamicWidth"in a&&(this.dynamicWidth=d(a.dynamicWidth,Number)),"opacity"in a&&(this.opacity=a.opacity),"colorBounds"in a&&(this.colorBounds=a.colorBounds),"vertexColor"in a&&(this.vertexColor=a.vertexColor?1:0);var n=a.field||a.coords&&a.coords[2]||null,h=!1;if(n||(this._field[2].shape[0]||this._field[2].shape[2]?n=this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):n=this._field[2].hi(0,0)),"field"in a||"coords"in a){var m=(n.shape[0]+2)*(n.shape[1]+2);m>this._field[2].data.length&&(b.freeFloat(this._field[2].data),this._field[2].data=b.mallocFloat(g.nextPow2(m))),this._field[2]=T(this._field[2].data,[n.shape[0]+2,n.shape[1]+2]),this.padField(this._field[2],n),this.shape=n.shape.slice();for(var _=this.shape,v=0;2>v;++v)this._field[2].size>this._field[v].data.length&&(b.freeFloat(this._field[v].data),this._field[v].data=b.mallocFloat(this._field[2].size)),this._field[v]=T(this._field[v].data,[_[0]+2,_[1]+2]);if(a.coords){var w=a.coords;if(!Array.isArray(w)||3!==w.length)throw new Error("gl-surface: invalid coordinates for x/y");for(v=0;2>v;++v){var S=w[v];for(D=0;2>D;++D)if(S.shape[D]!==_[D])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[v],S)}}else if(a.ticks){var C=a.ticks;if(!Array.isArray(C)||2!==C.length)throw new Error("gl-surface: invalid ticks");for(v=0;2>v;++v){var L=C[v];if((Array.isArray(L)||L.length)&&(L=T(L)),L.shape[0]!==_[v])throw new Error("gl-surface: invalid tick length");var z=T(L.data,_);z.stride[v]=L.stride[0],z.stride[1^v]=0,this.padField(this._field[v],z)}}else{for(v=0;2>v;++v){var I=[0,0];I[v]=1,this._field[v]=T(this._field[v].data,[_[0]+2,_[1]+2],I,0)}this._field[0].set(0,0,0);for(var D=0;D<_[0];++D)this._field[0].set(D+1,0,D);for(this._field[0].set(_[0]+1,0,_[0]-1),this._field[1].set(0,0,0),D=0;D<_[1];++D)this._field[1].set(0,D+1,D);this._field[1].set(0,_[1]+1,_[1]-1)}var P=this._field,O=T(b.mallocFloat(2*(3*P[2].size)),[3,_[0]+2,_[1]+2,2]);for(v=0;3>v;++v)E(O.pick(v),P[v],"mirror");var R=T(b.mallocFloat(3*P[2].size),[_[0]+2,_[1]+2,3]);for(v=0;v<_[0]+2;++v)for(D=0;D<_[1]+2;++D){var B=O.get(0,v,D,0),F=O.get(0,v,D,1),N=O.get(1,v,D,0),V=O.get(1,v,D,1),U=O.get(2,v,D,0),H=O.get(2,v,D,1),G=N*H-V*U,Y=U*F-H*B,q=B*V-F*N,W=re(G*G+Y*Y+q*q);1e-8>W?(W=va(wa(G),wa(Y),wa(q)),1e-8>W?(q=1,Y=G=0,W=1):W=1/W):W=1/re(W),R.set(v,D,0,G*W),R.set(v,D,1,Y*W),R.set(v,D,2,q*W)}b.free(O.data);var X=[1/0,1/0,1/0],Z=[-Infinity,-Infinity,-Infinity],$=1/0,J=-Infinity,K=6*((_[0]-1)*(_[1]-1)),Q=b.mallocFloat(g.nextPow2(10*K)),ee=0,te=0;for(v=0;v<_[0]-1;++v)j_loop:for(D=0;D<_[1]-1;++D){for(var ae=0;2>ae;++ae)for(var oe=0;2>oe;++oe)for(var ne=0,le;3>ne;++ne)if(le=this._field[ne].get(1+v+ae,1+D+oe),isNaN(le)||!isFinite(le))continue j_loop;for(ne=0;6>ne;++ne){var se=v+M[ne][0],de=D+M[ne][1],ce=this._field[0].get(se+1,de+1),pe=this._field[1].get(se+1,de+1);le=this._field[2].get(se+1,de+1),G=R.get(se+1,de+1,0),Y=R.get(se+1,de+1,1),q=R.get(se+1,de+1,2),a.intensity&&(ue=a.intensity.get(se,de));var ue=a.intensity?a.intensity.get(se,de):le+this.objectOffset[2];Q[ee++]=se,Q[ee++]=de,Q[ee++]=ce,Q[ee++]=pe,Q[ee++]=le,Q[ee++]=0,Q[ee++]=ue,Q[ee++]=G,Q[ee++]=Y,Q[ee++]=q,X[0]=ie(X[0],ce+this.objectOffset[0]),X[1]=ie(X[1],pe+this.objectOffset[1]),X[2]=ie(X[2],le+this.objectOffset[2]),$=ie($,ue),Z[0]=va(Z[0],ce+this.objectOffset[0]),Z[1]=va(Z[1],pe+this.objectOffset[1]),Z[2]=va(Z[2],le+this.objectOffset[2]),J=va(J,ue),te+=1}}for(a.intensityBounds&&($=+a.intensityBounds[0],J=+a.intensityBounds[1]),v=6;v<ee;v+=10)Q[v]=(Q[v]-$)/(J-$);this._vertexCount=te,this._coordinateBuffer.update(Q.subarray(0,ee)),b.freeFloat(Q),b.free(R.data),this.bounds=[X,Z],this.intensity=a.intensity||this._field[2],(this.intensityBounds[0]!==$||this.intensityBounds[1]!==J)&&(h=!0),this.intensityBounds=[$,J]}if("levels"in a){var ge=a.levels;for(ge=Array.isArray(ge[0])?ge.slice():[[],[],ge],v=0;3>v;++v)ge[v]=ge[v].slice(),ge.sort(function(e,t){return e-t});for(v=0;3>v;++v)for(D=0;D<ge[v].length;++D)ge[v][D]-=this.objectOffset[v];change_test:for(v=0;3>v;++v){if(ge[v].length!==this.contourLevels[v].length){h=!0;break}for(D=0;D<ge[v].length;++D)if(ge[v][D]!==this.contourLevels[v][D]){h=!0;break change_test}}this.contourLevels=ge}if(h){P=this._field,_=this.shape;for(var he=[],me=0;3>me;++me){ge=this.contourLevels[me];var ye=[],fe=[],xe=[0,0,0];for(v=0;v<ge.length;++v){var be=A(this._field[me],ge[v]);ye.push(0|he.length/5),te=0;edge_loop:for(D=0;D<be.cells.length;++D){var _e=be.cells[D];for(ne=0;2>ne;++ne){var e=be.positions[_e[ne]],p=e[0],x=0|ea(p),ve=p-x,we=e[1],y=0|ea(we),ke=we-y,Te=!1;axis_loop:for(var Ae=0;3>Ae;++Ae){xe[Ae]=0;var Se=(me+Ae+1)%3;for(ae=0;2>ae;++ae){var Ce=ae?ve:1-ve;for(se=0|ie(va(x+ae,0),_[0]),oe=0;2>oe;++oe){var s=oe?ke:1-ke;if(de=0|ie(va(y+oe,0),_[1]),le=2>Ae?this._field[Se].get(se,de):(this.intensity.get(se,de)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(le)||isNaN(le)){Te=!0;break axis_loop}xe[Ae]+=Ce*s*le}}}if(!Te)he.push(xe[0],xe[1],e[0],e[1],xe[2]),te+=1;else{if(0<ne){for(var t=0;5>t;++t)he.pop();te-=1}continue edge_loop}}}fe.push(te)}this._contourOffsets[me]=ye,this._contourCounts[me]=fe}var Le=b.mallocFloat(he.length);for(v=0;v<he.length;++v)Le[v]=he[v];this._contourBuffer.update(Le),b.freeFloat(Le)}a.colormap&&this._colorMap.setPixels(o(a.colormap))},F.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var e=0;3>e;++e)b.freeFloat(this._field[e].data)},F.highlight=function(t){var a;if(!t)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(a=0;3>a;++a)this.highlightLevel[a]=this.enableHighlight[a]?t.level[a]:-1;var o;for(o=this.snapToData?t.dataCoordinate:t.position,a=0;3>a;++a)o[a]-=this.objectOffset[a];if(this.enableDynamic[0]&&o[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&o[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&o[2]!==this.dynamicLevel[2]){for(var r=0,n=this.shape,l=b.mallocFloat(12*n[0]*n[1]),s=0;3>s;++s){if(!this.enableDynamic[s]){this.dynamicLevel[s]=NaN,this._dynamicCounts[s]=0;continue}this.dynamicLevel[s]=o[s];var c=(s+1)%3,u=(s+2)%3,m=this._field[s],f=this._field[c],g=this._field[u],h=A(m,o[s]),_=h.cells,v=h.positions;for(this._dynamicOffsets[s]=r,a=0;a<_.length;++a)for(var w=_[a],e=0;2>e;++e){var k=v[w[e]],p=+k[0],x=0|p,T=0|ie(x+1,n[0]),S=p-x,C=1-S,L=+k[1],y=0|L,E=0|ie(y+1,n[1]),z=L-y,I=1-z,D=C*I,P=C*z,O=S*I,R=S*z,M=D*f.get(x,y)+P*f.get(x,E)+O*f.get(T,y)+R*f.get(T,E),B=D*g.get(x,y)+P*g.get(x,E)+O*g.get(T,y)+R*g.get(T,E);if(isNaN(M)||isNaN(B)){e&&(r-=1);break}l[2*r+0]=M,l[2*r+1]=B,r+=1}this._dynamicCounts[s]=r-this._dynamicOffsets[s]}this._dynamicBuffer.update(l.subarray(0,2*r)),b.freeFloat(l)}}},{"./lib/shaders":302,"binary-search-bounds":79,"bit-twiddle":80,colormap:114,"gl-buffer":230,"gl-mat4/invert":254,"gl-mat4/multiply":256,"gl-texture2d":305,"gl-vao":310,ndarray:433,"ndarray-gradient":424,"ndarray-ops":427,"ndarray-pack":428,"surface-nets":507,"typedarray-pool":521}],304:[function(e,t){"use strict";function a(e){return"function"==typeof e&&e._gl&&e.prop&&e.texture&&e.buffer}var r=e("css-font"),n=e("pick-by-alias"),l=e("regl"),s=e("gl-util/context"),d=e("es6-weak-map"),c=e("color-normalize"),p=e("font-atlas"),u=e("typedarray-pool"),g=e("parse-rect"),h=e("is-plain-obj"),m=e("parse-unit"),y=e("to-px"),o=e("detect-kerning"),i=e("object-assign"),f=e("font-measure"),x=e("flatten-vertex-data"),b=e("bit-twiddle"),_=b.nextPow2,v=new d,w=!1;if(document.body){var k=document.body.appendChild(document.createElement("div"));k.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(k).fontStretch&&(w=!0),document.body.removeChild(k)}var T=function(e){a(e)?(e={regl:e},this.gl=e.regl._gl):this.gl=s(e),this.shader=v.get(this.gl),this.regl=this.shader?this.shader.regl:e.regl||l({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),v.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(h(e)?e:{})};T.prototype.createShader=function(){var e=this.regl,t=e({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:e.prop("count"),offset:e.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:e.this("sizeBuffer")},width:{offset:0,stride:8,buffer:e.this("sizeBuffer")},char:e.this("charBuffer"),position:e.this("position")},uniforms:{atlasSize:function(e,t){return[t.atlas.width,t.atlas.height]},atlasDim:function(e,t){return[t.atlas.cols,t.atlas.rows]},atlas:function(e,t){return t.atlas.texture},charStep:function(e,t){return t.atlas.step},em:function(e,t){return t.atlas.em},color:e.prop("color"),opacity:e.prop("opacity"),viewport:e.this("viewportArray"),scale:e.this("scale"),align:e.prop("align"),baseline:e.prop("baseline"),translate:e.this("translate"),positionOffset:e.prop("positionOffset")},primitive:"points",viewport:e.this("viewport"),vert:"\n\t\t\tprecision highp float;\n\t\t\tattribute float width, charOffset, char;\n\t\t\tattribute vec2 position;\n\t\t\tuniform float fontSize, charStep, em, align, baseline;\n\t\t\tuniform vec4 viewport;\n\t\t\tuniform vec4 color;\n\t\t\tuniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvoid main () {\n\t\t\t\t"+(T.normalViewport?"":"vec2 positionOffset = vec2(positionOffset.x,- positionOffset.y);")+"\n\n\t\t\t\tvec2 offset = floor(em * (vec2(align + charOffset, baseline)\n\t\t\t\t\t+ positionOffset))\n\t\t\t\t\t/ (viewport.zw * scale.xy);\n\n\t\t\t\tvec2 position = (position + translate) * scale;\n\t\t\t\tposition += offset * scale;\n\n\t\t\t\t"+(T.normalViewport?"position.y = 1. - position.y;":"")+"\n\n\t\t\t\tcharCoord = position * viewport.zw + viewport.xy;\n\n\t\t\t\tgl_Position = vec4(position * 2. - 1., 0, 1);\n\n\t\t\t\tgl_PointSize = charStep;\n\n\t\t\t\tcharId.x = mod(char, atlasDim.x);\n\t\t\t\tcharId.y = floor(char / atlasDim.x);\n\n\t\t\t\tcharWidth = width * em;\n\n\t\t\t\tfontColor = color / 255.;\n\t\t\t}",frag:"\n\t\t\tprecision highp float;\n\t\t\tuniform sampler2D atlas;\n\t\t\tuniform float fontSize, charStep, opacity;\n\t\t\tuniform vec2 atlasSize;\n\t\t\tuniform vec4 viewport;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\n\t\t\tfloat lightness(vec4 color) {\n\t\t\t\treturn color.r * 0.299 + color.g * 0.587 + color.b * 0.114;\n\t\t\t}\n\n\t\t\tvoid main () {\n\t\t\t\tvec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;\n\t\t\t\tfloat halfCharStep = floor(charStep * .5 + .5);\n\n\t\t\t\t// invert y and shift by 1px (FF expecially needs that)\n\t\t\t\tuv.y = charStep - uv.y;\n\n\t\t\t\t// ignore points outside of character bounding box\n\t\t\t\tfloat halfCharWidth = ceil(charWidth * .5);\n\t\t\t\tif (floor(uv.x) > halfCharStep + halfCharWidth ||\n\t\t\t\t\tfloor(uv.x) < halfCharStep - halfCharWidth) return;\n\n\t\t\t\tuv += charId * charStep;\n\t\t\t\tuv = uv / atlasSize;\n\n\t\t\t\tvec4 color = fontColor;\n\t\t\t\tvec4 mask = texture2D(atlas, uv);\n\n\t\t\t\tfloat maskY = lightness(mask);\n\t\t\t\t// float colorY = lightness(color);\n\t\t\t\tcolor.a *= maskY;\n\t\t\t\tcolor.a *= opacity;\n\n\t\t\t\t// color.a += .1;\n\n\t\t\t\t// antialiasing, see yiq color space y-channel formula\n\t\t\t\t// color.rgb += (1. - color.rgb) * (1. - mask.rgb);\n\n\t\t\t\tgl_FragColor = color;\n\t\t\t}"});return{regl:e,draw:t,atlas:{}}},T.prototype.update=function(e){var t=this;if("string"==typeof e)e={text:e};else if(!e)return;e=n(e,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0),null!=e.opacity&&(Array.isArray(e.opacity)?this.opacity=e.opacity.map(function(e){return parseFloat(e)}):this.opacity=parseFloat(e.opacity)),null!=e.viewport&&(this.viewport=g(e.viewport),T.normalViewport&&(this.viewport.y=this.canvas.height-this.viewport.y-this.viewport.height),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null==this.viewport&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null!=e.kerning&&(this.kerning=e.kerning),null!=e.offset&&("number"==typeof e.offset&&(e.offset=[e.offset,0]),this.positionOffset=x(e.offset)),e.direction&&(this.direction=e.direction),e.range&&(this.range=e.range,this.scale=[1/(e.range[2]-e.range[0]),1/(e.range[3]-e.range[1])],this.translate=[-e.range[0],-e.range[1]]),e.scale&&(this.scale=e.scale),e.translate&&(this.translate=e.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||e.font||(e.font=T.baseFontSize+"px sans-serif");var a=!1,s=!1;if(e.font&&(Array.isArray(e.font)?e.font:[e.font]).forEach(function(o,n){if("string"==typeof o)try{o=r.parse(o)}catch(t){o=r.parse(T.baseFontSize+"px "+o)}else o=r.parse(r.stringify(o));var e=r.stringify({size:T.baseFontSize,family:o.family,stretch:w?o.stretch:void 0,variant:o.variant,weight:o.weight,style:o.style}),i=m(o.size),l=R(i[0]*y(i[1]));if(l!==t.fontSize[n]&&(s=!0,t.fontSize[n]=l),(!t.font[n]||e!=t.font[n].baseString)&&(a=!0,t.font[n]=T.fonts[e],!t.font[n])){var d=o.family.join(", "),c=[o.style];o.style!=o.variant&&c.push(o.variant),o.variant!=o.weight&&c.push(o.weight),w&&o.weight!=o.stretch&&c.push(o.stretch),t.font[n]={baseString:e,family:d,weight:o.weight,stretch:o.stretch,style:o.style,variant:o.variant,width:{},kerning:{},metrics:f(d,{origin:"top",fontSize:T.baseFontSize,fontStyle:c.join(" ")})},T.fonts[e]=t.font[n]}}),(a||s)&&this.font.forEach(function(a,o){var i=r.stringify({size:t.fontSize[o],family:a.family,stretch:w?a.stretch:void 0,variant:a.variant,weight:a.weight,style:a.style});if(t.fontAtlas[o]=t.shader.atlas[i],!t.fontAtlas[o]){var n=a.metrics;t.shader.atlas[i]=t.fontAtlas[o]={fontString:i,step:2*ae(.5*(t.fontSize[o]*n.bottom)),em:t.fontSize[o],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:t.regl.texture()}}null==e.text&&(e.text=t.text)}),"string"==typeof e.text&&e.position&&2<e.position.length){for(var d=Array(.5*e.position.length),h=0;h<d.length;h++)d[h]=e.text;e.text=d}var b;if(null!=e.text||a){if(this.textOffsets=[0],Array.isArray(e.text)){this.count=e.text[0].length,this.counts=[this.count];for(var v=1;v<e.text.length;v++)t.textOffsets[v]=t.textOffsets[v-1]+e.text[v-1].length,t.count+=e.text[v].length,t.counts.push(e.text[v].length);this.text=e.text.join("")}else this.text=e.text,this.count=this.text.length,this.counts=[this.count];b=[],this.font.forEach(function(e,a){T.atlasContext.font=e.baseString;for(var r=t.fontAtlas[a],n=0,l;n<t.text.length;n++)if(l=t.text.charAt(n),null==r.ids[l]&&(r.ids[l]=r.chars.length,r.chars.push(l),b.push(l)),null==e.width[l]&&(e.width[l]=T.atlasContext.measureText(l).width/T.baseFontSize,t.kerning)){var s=[];for(var d in e.width)s.push(d+l,l+d);i(e.kerning,o(e.family,{pairs:s}))}})}if(e.position)if(2<e.position.length){for(var k=!e.position[0].length,A=u.mallocFloat(2*this.count),S=0,C=0,L;S<this.counts.length;S++)if(L=t.counts[S],k)for(var E=0;E<L;E++)A[C++]=e.position[2*S],A[C++]=e.position[2*S+1];else for(var z=0;z<L;z++)A[C++]=e.position[S][0],A[C++]=e.position[S][1];this.position.call?this.position({type:"float",data:A}):this.position=this.regl.buffer({type:"float",data:A}),u.freeFloat(A)}else this.position.destroy&&this.position.destroy(),this.position={constant:e.position};if(e.text||a){var I=u.mallocUint8(this.count),D=u.mallocFloat(2*this.count);this.textWidth=[];for(var P=0,O=0;P<this.counts.length;P++){for(var M=t.counts[P],B=t.font[P]||t.font[0],F=t.fontAtlas[P]||t.fontAtlas[0],N=0;N<M;N++){var V=t.text.charAt(O),U=t.text.charAt(O-1);if(I[O]=F.ids[V],D[2*O]=B.width[V],N){var H=D[2*O-2],G=D[2*O],Y=D[2*O-1],q=Y+.5*H+.5*G;if(t.kerning){var W=B.kerning[U+V];W&&(q+=1e-3*W)}D[2*O+1]=q}else D[2*O+1]=.5*D[2*O];O++}t.textWidth.push(D.length?.5*D[2*O-2]+D[2*O-1]:0)}e.align||(e.align=this.align),this.charBuffer({data:I,type:"uint8",usage:"stream"}),this.sizeBuffer({data:D,type:"float",usage:"stream"}),u.freeUint8(I),u.freeFloat(D),b.length&&this.font.forEach(function(e,a){var o=t.fontAtlas[a],r=o.step,i=ea(T.maxAtlasSize/r),n=ie(i,o.chars.length),l=ae(o.chars.length/n),s=_(n*r),d=_(l*r);o.width=s,o.height=d,o.rows=l,o.cols=n,o.em&&o.texture({data:p({canvas:T.atlasCanvas,font:o.fontString,chars:o.chars,shape:[s,d],step:[r,r]})})})}if(e.align&&(this.align=e.align,this.alignOffset=this.textWidth.map(function(e,a){var o=Array.isArray(t.align)?1<t.align.length?t.align[a]:t.align[0]:t.align;return"number"==typeof o?o:"right"===o||"end"===o?-e:"center"===o||"centre"===o||"middle"===o?.5*-e:0})),null==this.baseline&&null==e.baseline&&(e.baseline=0),null!=e.baseline&&(this.baseline=e.baseline,!Array.isArray(this.baseline)&&(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(e,a){var o=(t.font[a]||t.font[0]).metrics,r=0;return r+=.5*o.bottom,r+="number"==typeof e?e-o.baseline:-o[e],T.normalViewport||(r*=-1),r})),null!=e.color)if(e.color||(e.color="transparent"),"string"==typeof e.color||!isNaN(e.color))this.color=c(e.color,"uint8");else{var X;if("number"==typeof e.color[0]&&e.color.length>this.counts.length){var Z=e.color.length;X=u.mallocUint8(Z);for(var l=(e.color.subarray||e.color.slice).bind(e.color),$=0;$<Z;$+=4)X.set(c(l($,$+4),"uint8"),$)}else{var J=e.color.length;X=u.mallocUint8(4*J);for(var K=0;K<J;K++)X.set(c(e.color[K]||0,"uint8"),4*K)}this.color=X}if(e.position||e.text||e.color||e.baseline||e.align||e.font||e.offset||e.opacity){var Q=4<this.color.length||1<this.baselineOffset.length||this.align&&1<this.align.length||1<this.fontAtlas.length||2<this.positionOffset.length;if(Q){var ee=va(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(ee);for(var te=0;te<this.batch.length;te++)t.batch[te]={count:1<t.counts.length?t.counts[te]:t.counts[0],offset:1<t.textOffsets.length?t.textOffsets[te]:t.textOffsets[0],color:t.color?4>=t.color.length?t.color:t.color.subarray(4*te,4*te+4):[0,0,0,255],opacity:Array.isArray(t.opacity)?t.opacity[te]:t.opacity,baseline:null==t.baselineOffset[te]?t.baselineOffset[0]:t.baselineOffset[te],align:t.align?null==t.alignOffset[te]?t.alignOffset[0]:t.alignOffset[te]:0,atlas:t.fontAtlas[te]||t.fontAtlas[0],positionOffset:2<t.positionOffset.length?t.positionOffset.subarray(2*te,2*te+2):t.positionOffset}}else this.batch=this.count?[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:[]}},T.prototype.destroy=function(){},T.prototype.kerning=!0,T.prototype.position={constant:new Float32Array(2)},T.prototype.translate=null,T.prototype.scale=null,T.prototype.font=null,T.prototype.text="",T.prototype.positionOffset=[0,0],T.prototype.opacity=1,T.prototype.color=new Uint8Array([0,0,0,255]),T.prototype.alignOffset=[0,0],T.normalViewport=!1,T.maxAtlasSize=1024,T.atlasCanvas=document.createElement("canvas"),T.atlasContext=T.atlasCanvas.getContext("2d",{alpha:!1}),T.baseFontSize=64,T.fonts={},t.exports=T},{"bit-twiddle":80,"color-normalize":108,"css-font":127,"detect-kerning":151,"es6-weak-map":209,"flatten-vertex-data":216,"font-atlas":217,"font-measure":218,"gl-util/context":306,"is-plain-obj":405,"object-assign":437,"parse-rect":442,"parse-unit":444,"pick-by-alias":448,regl:478,"to-px":515,"typedarray-pool":521}],305:[function(e,t){"use strict";function a(e){y=[e.LINEAR,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_NEAREST],f=[e.NEAREST,e.LINEAR,e.NEAREST_MIPMAP_NEAREST,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_LINEAR],x=[e.REPEAT,e.CLAMP_TO_EDGE,e.MIRRORED_REPEAT]}function o(e){return"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!=typeof ImageData&&e instanceof ImageData}function r(e,t,a){var o=e.gl,r=o.getParameter(o.MAX_TEXTURE_SIZE);if(0>t||t>r||0>a||a>r)throw new Error("gl-texture2d: Invalid texture size");return e._shape=[t,a],e.bind(),o.texImage2D(o.TEXTURE_2D,0,e.format,t,a,0,e.format,e.type,null),e._mipLevels=[0],e}function i(e,t,a,o,r,i){this.gl=e,this.handle=t,this.format=r,this.type=i,this._shape=[a,o],this._mipLevels=[0],this._magFilter=e.NEAREST,this._minFilter=e.NEAREST,this._wrapS=e.CLAMP_TO_EDGE,this._wrapT=e.CLAMP_TO_EDGE,this._anisoSamples=1;var n=this,l=[this._wrapS,this._wrapT];Object.defineProperties(l,[{get:function(){return n._wrapS},set:function(e){return n.wrapS=e}},{get:function(){return n._wrapT},set:function(e){return n.wrapT=e}}]),this._wrapVector=l;var s=[this._shape[0],this._shape[1]];Object.defineProperties(s,[{get:function(){return n._shape[0]},set:function(e){return n.width=e}},{get:function(){return n._shape[1]},set:function(e){return n.height=e}}]),this._shapeVector=s}function n(e,t){return 3===e.length?1===t[2]&&t[1]===e[0]*e[2]&&t[0]===e[2]:1===t[0]&&t[1]===e[0]}function l(e,t,a,o,r,i,l,s){var d=s.dtype,c=s.shape.slice();if(2>c.length||3<c.length)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var p=0,u=0,y=n(c,s.stride.slice());"float32"===d?p=e.FLOAT:"float64"===d?(p=e.FLOAT,y=!1,d="float32"):"uint8"===d?p=e.UNSIGNED_BYTE:(p=e.UNSIGNED_BYTE,y=!1,d="uint8");if(2===c.length)u=e.LUMINANCE,c=[c[0],c[1],1],s=g(s.data,c,[s.stride[0],s.stride[1],1],s.offset);else if(3===c.length){if(1===c[2])u=e.ALPHA;else if(2===c[2])u=e.LUMINANCE_ALPHA;else if(3===c[2])u=e.RGB;else if(4===c[2])u=e.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");c[2]}else throw new Error("gl-texture2d: Invalid shape for texture");if((u===e.LUMINANCE||u===e.ALPHA)&&(r===e.LUMINANCE||r===e.ALPHA)&&(u=r),u!==r)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var f=s.size,x=0>l.indexOf(o);if(x&&l.push(o),p===i&&y)0===s.offset&&s.data.length===f?x?e.texImage2D(e.TEXTURE_2D,o,r,c[0],c[1],0,r,i,s.data):e.texSubImage2D(e.TEXTURE_2D,o,t,a,c[0],c[1],r,i,s.data):x?e.texImage2D(e.TEXTURE_2D,o,r,c[0],c[1],0,r,i,s.data.subarray(s.offset,s.offset+f)):e.texSubImage2D(e.TEXTURE_2D,o,t,a,c[0],c[1],r,i,s.data.subarray(s.offset,s.offset+f));else{var _=i===e.FLOAT?m.mallocFloat32(f):m.mallocUint8(f);var v=g(_,c,[c[2],c[2]*c[0],1]);p===e.FLOAT&&i===e.UNSIGNED_BYTE?b(v,s):h.assign(v,s),x?e.texImage2D(e.TEXTURE_2D,o,r,c[0],c[1],0,r,i,_.subarray(0,f)):e.texSubImage2D(e.TEXTURE_2D,o,t,a,c[0],c[1],r,i,_.subarray(0,f)),i===e.FLOAT?m.freeFloat32(_):m.freeUint8(_)}}function s(e){var t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t}function d(e,t,a,o,r){var n=e.getParameter(e.MAX_TEXTURE_SIZE);if(0>t||t>n||0>a||a>n)throw new Error("gl-texture2d: Invalid texture shape");if(r===e.FLOAT&&!e.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var l=s(e);return e.texImage2D(e.TEXTURE_2D,0,o,t,a,0,o,r,null),new i(e,l,t,a,o,r)}function c(e,t,a,o,r,n){var l=s(e);return e.texImage2D(e.TEXTURE_2D,0,r,r,n,t),new i(e,l,a,o,r,n)}function p(e,t){var a=t.dtype,o=t.shape.slice(),r=e.getParameter(e.MAX_TEXTURE_SIZE);if(0>o[0]||o[0]>r||0>o[1]||o[1]>r)throw new Error("gl-texture2d: Invalid texture size");var l=n(o,t.stride.slice()),d=0;"float32"===a?d=e.FLOAT:"float64"===a?(d=e.FLOAT,l=!1,a="float32"):"uint8"===a?d=e.UNSIGNED_BYTE:(d=e.UNSIGNED_BYTE,l=!1,a="uint8");var c=0;if(2===o.length)c=e.LUMINANCE,o=[o[0],o[1],1],t=g(t.data,o,[t.stride[0],t.stride[1],1],t.offset);else if(3!==o.length)throw new Error("gl-texture2d: Invalid shape for texture");else if(1===o[2])c=e.ALPHA;else if(2===o[2])c=e.LUMINANCE_ALPHA;else if(3===o[2])c=e.RGB;else if(4===o[2])c=e.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");d!==e.FLOAT||e.getExtension("OES_texture_float")||(d=e.UNSIGNED_BYTE,l=!1);var p=t.size,u,y;if(!l){var f=[o[2],o[2]*o[0],1];y=m.malloc(p,a);var x=g(y,o,f,0);("float32"===a||"float64"===a)&&d===e.UNSIGNED_BYTE?b(x,t):h.assign(x,t),u=y.subarray(0,p)}else u=0===t.offset&&t.data.length===p?t.data:t.data.subarray(t.offset,t.offset+p);var _=s(e);return e.texImage2D(e.TEXTURE_2D,0,c,o[0],o[1],0,c,d,u),l||m.free(y),new i(e,_,o[0],o[1],c,d)}function u(e){if(1>=arguments.length)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(y||a(e),"number"==typeof arguments[1])return d(e,arguments[1],arguments[2],arguments[3]||e.RGBA,arguments[4]||e.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return d(e,0|arguments[1][0],0|arguments[1][1],arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var t=arguments[1],r=o(t)?t:t.raw;if(r)return c(e,r,0|t.width,0|t.height,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE);if(t.shape&&t.data&&t.stride)return p(e,t)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}var g=e("ndarray"),h=e("ndarray-ops"),m=e("typedarray-pool");t.exports=u;var y=null,f=null,x=null,b=function(e,t){h.muls(e,t,255)},_=i.prototype;Object.defineProperties(_,{minFilter:{get:function(){return this._minFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&0<=y.indexOf(e)&&!t.getExtension("OES_texture_float_linear")&&(e=t.NEAREST),0>f.indexOf(e))throw new Error("gl-texture2d: Unknown filter mode "+e);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e),this._minFilter=e}},magFilter:{get:function(){return this._magFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&0<=y.indexOf(e)&&!t.getExtension("OES_texture_float_linear")&&(e=t.NEAREST),0>f.indexOf(e))throw new Error("gl-texture2d: Unknown filter mode "+e);return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e),this._magFilter=e}},mipSamples:{get:function(){return this._anisoSamples},set:function(e){var t=this._anisoSamples;if(this._anisoSamples=0|va(e,1),t!==this._anisoSamples){var a=this.gl.getExtension("EXT_texture_filter_anisotropic");a&&this.gl.texParameterf(this.gl.TEXTURE_2D,a.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(e){if(this.bind(),0>x.indexOf(e))throw new Error("gl-texture2d: Unknown wrap mode "+e);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,e),this._wrapS=e}},wrapT:{get:function(){return this._wrapT},set:function(e){if(this.bind(),0>x.indexOf(e))throw new Error("gl-texture2d: Unknown wrap mode "+e);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,e),this._wrapT=e}},wrap:{get:function(){return this._wrapVector},set:function(e){if(Array.isArray(e)||(e=[e,e]),2!==e.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var t=0;2>t;++t)if(0>x.indexOf(e[t]))throw new Error("gl-texture2d: Unknown wrap mode "+e);this._wrapS=e[0],this._wrapT=e[1];var a=this.gl;return this.bind(),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,this._wrapS),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,this._wrapT),e}},shape:{get:function(){return this._shapeVector},set:function(e){if(!Array.isArray(e))e=[0|e,0|e];else if(2!==e.length)throw new Error("gl-texture2d: Invalid texture shape");return r(this,0|e[0],0|e[1]),[0|e[0],0|e[1]]}},width:{get:function(){return this._shape[0]},set:function(e){return e|=0,r(this,e,this._shape[1]),e}},height:{get:function(){return this._shape[1]},set:function(e){return e|=0,r(this,this._shape[0],e),e}}}),_.bind=function(e){var t=this.gl;return void 0!==e&&t.activeTexture(t.TEXTURE0+(0|e)),t.bindTexture(t.TEXTURE_2D,this.handle),void 0===e?t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0:0|e},_.dispose=function(){this.gl.deleteTexture(this.handle)},_.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var e=ie(this._shape[0],this._shape[1]),t=0;0<e;++t,e>>>=1)0>this._mipLevels.indexOf(t)&&this._mipLevels.push(t)},_.setPixels=function(e,t,a,r){var i=this.gl;this.bind(),Array.isArray(t)?(r=a,a=0|t[1],t=0|t[0]):(t=t||0,a=a||0),r=r||0;var n=o(e)?e:e.raw;if(n){var s=0>this._mipLevels.indexOf(r);s?(i.texImage2D(i.TEXTURE_2D,0,this.format,this.format,this.type,n),this._mipLevels.push(r)):i.texSubImage2D(i.TEXTURE_2D,r,t,a,this.format,this.type,n)}else if(e.shape&&e.stride&&e.data){if(2>e.shape.length||t+e.shape[1]>this._shape[1]>>>r||a+e.shape[0]>this._shape[0]>>>r||0>t||0>a)throw new Error("gl-texture2d: Texture dimensions are out of bounds");l(i,t,a,r,this.format,this.type,this._mipLevels,e)}else throw new Error("gl-texture2d: Unsupported data type")}},{ndarray:433,"ndarray-ops":427,"typedarray-pool":521}],306:[function(e,t){"use strict";function a(e){if(e.container)if(e.container==document.body)document.body.style.width||(e.canvas.width=e.width||e.pixelRatio*window.innerWidth),document.body.style.height||(e.canvas.height=e.height||e.pixelRatio*window.innerHeight);else{var t=e.container.getBoundingClientRect();e.canvas.width=e.width||t.right-t.left,e.canvas.height=e.height||t.bottom-t.top}}function r(t){return"function"==typeof t.getContext&&"width"in t&&"height"in t}function i(t){return"string"==typeof t.nodeName&&"function"==typeof t.appendChild&&"function"==typeof t.getBoundingClientRect}function n(t){return"function"==typeof t.drawArrays||"function"==typeof t.drawElements}var l=e("pick-by-alias");t.exports=function(t){if(t?"string"==typeof t&&(t={container:t}):t={},t=r(t)?{container:t}:i(t)?{container:t}:n(t)?{gl:t}:l(t,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio"},!0),t.pixelRatio||(t.pixelRatio=window.pixelRatio||1),t.gl)return t.gl;if(t.canvas&&(t.container=t.canvas.parentNode),t.container){if("string"==typeof t.container){var e=document.querySelector(t.container);if(!e)throw Error("Element "+t.container+" is not found");t.container=e}r(t.container)?(t.canvas=t.container,t.container=t.canvas.parentNode):!t.canvas&&(t.canvas=document.createElement("canvas"),t.container.appendChild(t.canvas),a(t))}else t.canvas||(t.container=document.body||document.documentElement,t.canvas=document.createElement("canvas"),t.canvas.style.position="absolute",t.canvas.style.top=0,t.canvas.style.left=0,t.container.appendChild(t.canvas),a(t));if(!t.gl)try{t.gl=t.canvas.getContext("webgl",t.attrs)}catch(a){try{t.gl=t.canvas.getContext("experimental-webgl",t.attrs)}catch(a){t.gl=t.canvas.getContext("webgl-experimental",t.attrs)}}return t.gl}},{"pick-by-alias":448}],307:[function(e,t){"use strict";t.exports=function(e,t,a){t?t.bind():e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);var o=0|e.getParameter(e.MAX_VERTEX_ATTRIBS);if(a){if(a.length>o)throw new Error("gl-vao: Too many vertex attributes");for(var r=0,n;r<a.length;++r)if(n=a[r],n.buffer){var l=n.buffer,s=n.size||4,d=n.type||e.FLOAT,c=!!n.normalized,p=n.stride||0,u=n.offset||0;l.bind(),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,s,d,c,p,u)}else{if("number"==typeof n)e.vertexAttrib1f(r,n);else if(1===n.length)e.vertexAttrib1f(r,n[0]);else if(2===n.length)e.vertexAttrib2f(r,n[0],n[1]);else if(3===n.length)e.vertexAttrib3f(r,n[0],n[1],n[2]);else if(4===n.length)e.vertexAttrib4f(r,n[0],n[1],n[2],n[3]);else throw new Error("gl-vao: Invalid vertex attribute");e.disableVertexAttribArray(r)}for(;r<o;++r)e.disableVertexAttribArray(r)}else{e.bindBuffer(e.ARRAY_BUFFER,null);for(var r=0;r<o;++r)e.disableVertexAttribArray(r)}}},{}],308:[function(e,t){"use strict";function a(e){this.gl=e,this._elements=null,this._attributes=null,this._elementsType=e.UNSIGNED_SHORT}var o=e("./do-bind.js");a.prototype.bind=function(){o(this.gl,this._elements,this._attributes)},a.prototype.update=function(e,t,a){this._elements=t,this._attributes=e,this._elementsType=a||this.gl.UNSIGNED_SHORT},a.prototype.dispose=function(){},a.prototype.unbind=function(){},a.prototype.draw=function(e,t,a){a=a||0;var o=this.gl;this._elements?o.drawElements(e,t,this._elementsType,a):o.drawArrays(e,a,t)},t.exports=function(e){return new a(e)}},{"./do-bind.js":307}],309:[function(e,t){"use strict";function o(e,t,o,a,r,i){this.location=e,this.dimension=t,this.a=o,this.b=a,this.c=r,this.d=i}function r(e,t,a){this.gl=e,this._ext=t,this.handle=a,this._attribs=[],this._useElements=!1,this._elementsType=e.UNSIGNED_SHORT}var n=e("./do-bind.js");o.prototype.bind=function(e){switch(this.dimension){case 1:e.vertexAttrib1f(this.location,this.a);break;case 2:e.vertexAttrib2f(this.location,this.a,this.b);break;case 3:e.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:e.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);}},r.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var e=0;e<this._attribs.length;++e)this._attribs[e].bind(this.gl)},r.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},r.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},r.prototype.update=function(e,t,r){if(this.bind(),n(this.gl,t,e),this.unbind(),this._attribs.length=0,e)for(var l=0,s;l<e.length;++l)s=e[l],"number"==typeof s?this._attribs.push(new o(l,1,s)):Array.isArray(s)&&this._attribs.push(new o(l,s.length,s[0],s[1],s[2],s[3]));this._useElements=!!t,this._elementsType=r||this.gl.UNSIGNED_SHORT},r.prototype.draw=function(e,t,a){a=a||0;var o=this.gl;this._useElements?o.drawElements(e,t,this._elementsType,a):o.drawArrays(e,a,t)},t.exports=function(e,t){return new r(e,t,t.createVertexArrayOES())}},{"./do-bind.js":307}],310:[function(e,t){"use strict";function a(e){this.bindVertexArrayOES=e.bindVertexArray.bind(e),this.createVertexArrayOES=e.createVertexArray.bind(e),this.deleteVertexArrayOES=e.deleteVertexArray.bind(e)}var o=e("./lib/vao-native.js"),r=e("./lib/vao-emulated.js");t.exports=function(e,t,i,n){var l=e.createVertexArray?new a(e):e.getExtension("OES_vertex_array_object"),s;return s=l?o(e,l):r(e),s.update(t,i,n),s}},{"./lib/vao-emulated.js":308,"./lib/vao-native.js":309}],311:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e}},{}],312:[function(e,t){t.exports=function(e,t){var a=o(e[0],e[1],e[2]),n=o(t[0],t[1],t[2]);r(a,a),r(n,n);var l=i(a,n);return 1<l?0:v(l)};var o=e("./fromValues"),r=e("./normalize"),i=e("./dot")},{"./dot":322,"./fromValues":328,"./normalize":339}],313:[function(e,t){t.exports=function(e,t){return e[0]=ae(t[0]),e[1]=ae(t[1]),e[2]=ae(t[2]),e}},{}],314:[function(e,t){t.exports=function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},{}],315:[function(e,t){t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},{}],316:[function(e,t){t.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},{}],317:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2],n=a[0],l=a[1],s=a[2];return e[0]=r*s-i*l,e[1]=i*n-o*s,e[2]=o*l-r*n,e}},{}],318:[function(e,t){t.exports=e("./distance")},{"./distance":319}],319:[function(e,t){t.exports=function(e,t){var a=t[0]-e[0],o=t[1]-e[1],r=t[2]-e[2];return re(a*a+o*o+r*r)}},{}],320:[function(e,t){t.exports=e("./divide")},{"./divide":321}],321:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]/a[0],e[1]=t[1]/a[1],e[2]=t[2]/a[2],e}},{}],322:[function(e,t){t.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},{}],323:[function(e,t){t.exports=1e-6},{}],324:[function(e,t){t.exports=function(e,t){var a=e[0],r=e[1],i=e[2],n=t[0],l=t[1],s=t[2];return wa(a-n)<=o*va(1,wa(a),wa(n))&&wa(r-l)<=o*va(1,wa(r),wa(l))&&wa(i-s)<=o*va(1,wa(i),wa(s))};var o=e("./epsilon")},{"./epsilon":323}],325:[function(e,t){t.exports=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},{}],326:[function(e,t){t.exports=function(e,t){return e[0]=ea(t[0]),e[1]=ea(t[1]),e[2]=ea(t[2]),e}},{}],327:[function(e,t){t.exports=function(e,t,a,r,n,s){var d,c;for(t||(t=3),a||(a=0),c=r?ie(r*t+a,e.length):e.length,d=a;d<c;d+=t)o[0]=e[d],o[1]=e[d+1],o[2]=e[d+2],n(o,o,s),e[d]=o[0],e[d+1]=o[1],e[d+2]=o[2];return e};var o=e("./create")()},{"./create":316}],328:[function(e,t){t.exports=function(e,t,a){var o=new Float32Array(3);return o[0]=e,o[1]=t,o[2]=a,o}},{}],329:[function(e,t){t.exports={EPSILON:e("./epsilon"),create:e("./create"),clone:e("./clone"),angle:e("./angle"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),equals:e("./equals"),exactEquals:e("./exactEquals"),add:e("./add"),subtract:e("./subtract"),sub:e("./sub"),multiply:e("./multiply"),mul:e("./mul"),divide:e("./divide"),div:e("./div"),min:e("./min"),max:e("./max"),floor:e("./floor"),ceil:e("./ceil"),round:e("./round"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),dist:e("./dist"),squaredDistance:e("./squaredDistance"),sqrDist:e("./sqrDist"),length:e("./length"),len:e("./len"),squaredLength:e("./squaredLength"),sqrLen:e("./sqrLen"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),cross:e("./cross"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformMat3:e("./transformMat3"),transformQuat:e("./transformQuat"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),forEach:e("./forEach")}},{"./add":311,"./angle":312,"./ceil":313,"./clone":314,"./copy":315,"./create":316,"./cross":317,"./dist":318,"./distance":319,"./div":320,"./divide":321,"./dot":322,"./epsilon":323,"./equals":324,"./exactEquals":325,"./floor":326,"./forEach":327,"./fromValues":328,"./inverse":330,"./len":331,"./length":332,"./lerp":333,"./max":334,"./min":335,"./mul":336,"./multiply":337,"./negate":338,"./normalize":339,"./random":340,"./rotateX":341,"./rotateY":342,"./rotateZ":343,"./round":344,"./scale":345,"./scaleAndAdd":346,"./set":347,"./sqrDist":348,"./sqrLen":349,"./squaredDistance":350,"./squaredLength":351,"./sub":352,"./subtract":353,"./transformMat3":354,"./transformMat4":355,"./transformQuat":356}],330:[function(e,t){t.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}},{}],331:[function(e,t){t.exports=e("./length")},{"./length":332}],332:[function(e,t){t.exports=function(e){var t=e[0],a=e[1],o=e[2];return re(t*t+a*a+o*o)}},{}],333:[function(e,t){t.exports=function(e,o,a,r){var t=o[0],i=o[1],n=o[2];return e[0]=t+r*(a[0]-t),e[1]=i+r*(a[1]-i),e[2]=n+r*(a[2]-n),e}},{}],334:[function(e,t){t.exports=function(e,t,a){return e[0]=va(t[0],a[0]),e[1]=va(t[1],a[1]),e[2]=va(t[2],a[2]),e}},{}],335:[function(e,t){t.exports=function(e,t,a){return e[0]=ie(t[0],a[0]),e[1]=ie(t[1],a[1]),e[2]=ie(t[2],a[2]),e}},{}],336:[function(e,t){t.exports=e("./multiply")},{"./multiply":337}],337:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e[2]=t[2]*a[2],e}},{}],338:[function(e,t){t.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}},{}],339:[function(e,t){t.exports=function(e,t){var a=t[0],o=t[1],r=t[2],i=a*a+o*o+r*r;return 0<i&&(i=1/re(i),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i),e}},{}],340:[function(e,t){t.exports=function(e,t){t=t||1;var a=2*Math.random()*Sa,o=2*Math.random()-1,r=re(1-o*o)*t;return e[0]=te(a)*r,e[1]=M(a)*r,e[2]=o*t,e}},{}],341:[function(e,t){t.exports=function(e,t,a,o){var r=a[1],i=a[2],n=t[1]-r,l=t[2]-i,s=M(o),d=te(o);return e[0]=t[0],e[1]=r+n*d-l*s,e[2]=i+n*s+l*d,e}},{}],342:[function(e,t){t.exports=function(e,t,a,o){var r=a[0],i=a[2],n=t[0]-r,l=t[2]-i,s=M(o),d=te(o);return e[0]=r+l*s+n*d,e[1]=t[1],e[2]=i+l*d-n*s,e}},{}],343:[function(e,t){t.exports=function(e,t,a,o){var r=a[0],i=a[1],n=t[0]-r,l=t[1]-i,s=M(o),d=te(o);return e[0]=r+n*d-l*s,e[1]=i+n*s+l*d,e[2]=t[2],e}},{}],344:[function(e,t){t.exports=function(e,t){return e[0]=R(t[0]),e[1]=R(t[1]),e[2]=R(t[2]),e}},{}],345:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}},{}],346:[function(e,t){t.exports=function(e,t,a,o){return e[0]=t[0]+a[0]*o,e[1]=t[1]+a[1]*o,e[2]=t[2]+a[2]*o,e}},{}],347:[function(e,t){t.exports=function(e,t,a,o){return e[0]=t,e[1]=a,e[2]=o,e}},{}],348:[function(e,t){t.exports=e("./squaredDistance")},{"./squaredDistance":350}],349:[function(e,t){t.exports=e("./squaredLength")},{"./squaredLength":351}],350:[function(e,t){t.exports=function(e,t){var a=t[0]-e[0],o=t[1]-e[1],r=t[2]-e[2];return a*a+o*o+r*r}},{}],351:[function(e,t){t.exports=function(e){var t=e[0],a=e[1],o=e[2];return t*t+a*a+o*o}},{}],352:[function(e,t){t.exports=e("./subtract")},{"./subtract":353}],353:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e}},{}],354:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2];return e[0]=o*a[0]+r*a[3]+i*a[6],e[1]=o*a[1]+r*a[4]+i*a[7],e[2]=o*a[2]+r*a[5]+i*a[8],e}},{}],355:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2],n=a[3]*o+a[7]*r+a[11]*i+a[15];return n=n||1,e[0]=(a[0]*o+a[4]*r+a[8]*i+a[12])/n,e[1]=(a[1]*o+a[5]*r+a[9]*i+a[13])/n,e[2]=(a[2]*o+a[6]*r+a[10]*i+a[14])/n,e}},{}],356:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2],n=a[0],l=a[1],s=a[2],d=a[3],c=d*o+l*i-s*r,p=d*r+s*o-n*i,u=d*i+n*r-l*o,g=-n*o-l*r-s*i;return e[0]=c*d+g*-n+p*-s-u*-l,e[1]=p*d+g*-l+u*-n-c*-s,e[2]=u*d+g*-s+c*-l-p*-n,e}},{}],357:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e[3]=t[3]+a[3],e}},{}],358:[function(e,t){t.exports=function(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}},{}],359:[function(e,t){t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}},{}],360:[function(e,t){t.exports=function(){var e=new Float32Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}},{}],361:[function(e,t){t.exports=function(e,t){var a=t[0]-e[0],o=t[1]-e[1],r=t[2]-e[2],i=t[3]-e[3];return re(a*a+o*o+r*r+i*i)}},{}],362:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]/a[0],e[1]=t[1]/a[1],e[2]=t[2]/a[2],e[3]=t[3]/a[3],e}},{}],363:[function(e,t){t.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}},{}],364:[function(e,t){t.exports=function(e,t,a,o){var r=new Float32Array(4);return r[0]=e,r[1]=t,r[2]=a,r[3]=o,r}},{}],365:[function(e,t){t.exports={create:e("./create"),clone:e("./clone"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),add:e("./add"),subtract:e("./subtract"),multiply:e("./multiply"),divide:e("./divide"),min:e("./min"),max:e("./max"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),squaredDistance:e("./squaredDistance"),length:e("./length"),squaredLength:e("./squaredLength"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformQuat:e("./transformQuat")}},{"./add":357,"./clone":358,"./copy":359,"./create":360,"./distance":361,"./divide":362,"./dot":363,"./fromValues":364,"./inverse":366,"./length":367,"./lerp":368,"./max":369,"./min":370,"./multiply":371,"./negate":372,"./normalize":373,"./random":374,"./scale":375,"./scaleAndAdd":376,"./set":377,"./squaredDistance":378,"./squaredLength":379,"./subtract":380,"./transformMat4":381,"./transformQuat":382}],366:[function(e,t){t.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}},{}],367:[function(e,t){t.exports=function(e){var t=e[0],a=e[1],o=e[2],r=e[3];return re(t*t+a*a+o*o+r*r)}},{}],368:[function(e,t){t.exports=function(e,o,a,r){var t=o[0],i=o[1],n=o[2],l=o[3];return e[0]=t+r*(a[0]-t),e[1]=i+r*(a[1]-i),e[2]=n+r*(a[2]-n),e[3]=l+r*(a[3]-l),e}},{}],369:[function(e,t){t.exports=function(e,t,a){return e[0]=va(t[0],a[0]),e[1]=va(t[1],a[1]),e[2]=va(t[2],a[2]),e[3]=va(t[3],a[3]),e}},{}],370:[function(e,t){t.exports=function(e,t,a){return e[0]=ie(t[0],a[0]),e[1]=ie(t[1],a[1]),e[2]=ie(t[2],a[2]),e[3]=ie(t[3],a[3]),e}},{}],371:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e[2]=t[2]*a[2],e[3]=t[3]*a[3],e}},{}],372:[function(e,t){t.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}},{}],373:[function(e,t){t.exports=function(e,t){var a=t[0],o=t[1],r=t[2],i=t[3],n=a*a+o*o+r*r+i*i;return 0<n&&(n=1/re(n),e[0]=a*n,e[1]=o*n,e[2]=r*n,e[3]=i*n),e}},{}],374:[function(e,t){var a=e("./normalize"),o=e("./scale");t.exports=function(e,t){return t=t||1,e[0]=Math.random(),e[1]=Math.random(),e[2]=Math.random(),e[3]=Math.random(),a(e,e),o(e,e,t),e}},{"./normalize":373,"./scale":375}],375:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e}},{}],376:[function(e,t){t.exports=function(e,t,a,o){return e[0]=t[0]+a[0]*o,e[1]=t[1]+a[1]*o,e[2]=t[2]+a[2]*o,e[3]=t[3]+a[3]*o,e}},{}],377:[function(e,t){t.exports=function(e,t,a,o,r){return e[0]=t,e[1]=a,e[2]=o,e[3]=r,e}},{}],378:[function(e,t){t.exports=function(e,t){var a=t[0]-e[0],o=t[1]-e[1],r=t[2]-e[2],i=t[3]-e[3];return a*a+o*o+r*r+i*i}},{}],379:[function(e,t){t.exports=function(e){var t=e[0],a=e[1],o=e[2],r=e[3];return t*t+a*a+o*o+r*r}},{}],380:[function(e,t){t.exports=function(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e[3]=t[3]-a[3],e}},{}],381:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2],n=t[3];return e[0]=a[0]*o+a[4]*r+a[8]*i+a[12]*n,e[1]=a[1]*o+a[5]*r+a[9]*i+a[13]*n,e[2]=a[2]*o+a[6]*r+a[10]*i+a[14]*n,e[3]=a[3]*o+a[7]*r+a[11]*i+a[15]*n,e}},{}],382:[function(e,t){t.exports=function(e,t,a){var o=t[0],r=t[1],i=t[2],n=a[0],l=a[1],s=a[2],d=a[3],c=d*o+l*i-s*r,p=d*r+s*o-n*i,u=d*i+n*r-l*o,g=-n*o-l*r-s*i;return e[0]=c*d+g*-n+p*-s-u*-l,e[1]=p*d+g*-l+u*-n-c*-s,e[2]=u*d+g*-s+c*-l-p*-n,e[3]=t[3],e}},{}],383:[function(e,t){t.exports=function(e,t,r,i){return a[0]=i,a[1]=r,a[2]=t,a[3]=e,o[0]};var a=new Uint8Array(4),o=new Float32Array(a.buffer)},{}],384:[function(e,t){var a=e("glsl-tokenizer"),o=e("atob-lite");t.exports=function(e){for(var t=Array.isArray(e)?e:a(e),r=0,n;r<t.length;r++)if(n=t[r],"preprocessor"===n.type){var l=n.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(l&&l[2]){var s=l[1],d=l[2];return(s?o(d):d).trim()}}}},{"atob-lite":60,"glsl-tokenizer":391}],385:[function(e,t){t.exports=function(e){function t(e){e.length&&C.push({type:s[A],data:e,position:z,line:L,column:E})}function d(e){k=0,P+=e,M=P.length;for(var t;O=P[k],k<M;)if(t=k,0===A?k=y():1===A?k=m():2===A?k=h():3===A?k=f():4===A?k=_():11===A?k=b():5===A?k=v():9999===A?k=w():9===A?k=g():999===A?k=u():void 0,t!==k)switch(P[t]){case"\n":E=0,++L;break;default:++E;}return T+=k,P=P.slice(k),C}function p(){return S.length&&t(S.join("")),A=10,t("(eof)"),C}function u(){return(S=S.length?[]:S,"/"===R&&"*"===O)?(z=T+k-1,A=0,R=O,k+1):"/"===R&&"/"===O?(z=T+k-1,A=1,R=O,k+1):"#"===O?(A=2,z=T+k,k):/\s/.test(O)?(A=9,z=T+k,k):(I=/\d/.test(O),D=/[^\w_]/.test(O),z=T+k,A=I?4:D?3:9999,k)}function g(){return /[^\s]/g.test(O)?(t(S.join("")),A=999,k):(S.push(O),R=O,k+1)}function h(){return("\r"===O||"\n"===O)&&"\\"!==R?(t(S.join("")),A=999,k):(S.push(O),R=O,k+1)}function m(){return h()}function y(){return"/"===O&&"*"===R?(S.push(O),t(S.join("")),A=999,k+1):(S.push(O),R=O,k+1)}function f(){if("."===R&&/\d/.test(O))return A=5,k;if("/"===R&&"*"===O)return A=0,k;if("/"===R&&"/"===O)return A=1,k;if("."===O&&S.length){for(;x(S););return A=5,k}if(";"===O||")"===O||"("===O){if(S.length)for(;x(S););return t(O),A=999,k+1}var e=2===S.length&&"="!==O;if(/[\w_\d\s]/.test(O)||e){for(;x(S););return A=999,k}return S.push(O),R=O,k+1}function x(e){var a=0,r,i;do{if(r=o.indexOf(e.slice(0,e.length+a).join("")),i=o[r],-1===r){if(0<a--+e.length)continue;i=e.slice(0,1).join("")}return t(i),z+=i.length,S=S.slice(i.length),S.length}while(1)}function b(){return /[^a-fA-F0-9]/.test(O)?(t(S.join("")),A=999,k):(S.push(O),R=O,k+1)}function _(){return"."===O?(S.push(O),A=5,R=O,k+1):/[eE]/.test(O)?(S.push(O),A=5,R=O,k+1):"x"===O&&1===S.length&&"0"===S[0]?(A=11,S.push(O),R=O,k+1):/[^\d]/.test(O)?(t(S.join("")),A=999,k):(S.push(O),R=O,k+1)}function v(){return("f"===O&&(S.push(O),R=O,k+=1),/[eE]/.test(O))?(S.push(O),R=O,k+1):"-"===O&&/[eE]/.test(R)?(S.push(O),R=O,k+1):/[^\d]/.test(O)?(t(S.join("")),A=999,k):(S.push(O),R=O,k+1)}function w(){if(/[^\d\w_]/.test(O)){var e=S.join("");return A=-1<B.indexOf(e)?8:-1<j.indexOf(e)?7:6,t(S.join("")),A=999,k}return S.push(O),R=O,k+1}var k=0,T=0,A=999,S=[],C=[],L=1,E=0,z=0,I=!1,D=!1,P="",O,R,M;e=e||{};var j=r,B=a;return"300 es"===e.version&&(j=l,B=n),function(e){return C=[],null===e?p():d(e.replace?e.replace(/\r\n/g,"\n"):e)}};var a=e("./lib/literals"),o=e("./lib/operators"),r=e("./lib/builtins"),n=e("./lib/literals-300es"),l=e("./lib/builtins-300es"),s=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":387,"./lib/builtins-300es":386,"./lib/literals":389,"./lib/literals-300es":388,"./lib/operators":390}],386:[function(e,t){var a=e("./builtins");a=a.slice().filter(function(e){return!/^(gl\_|texture)/.test(e)}),t.exports=a.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":387}],387:[function(e,t){t.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],388:[function(e,t){var a=e("./literals");t.exports=a.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":389}],389:[function(e,t){t.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],390:[function(e,t){t.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],391:[function(e,t){var a=e("./index");t.exports=function(e,t){var o=a(t),r=[];return r=r.concat(o(e)),r=r.concat(o(null)),r}},{"./index":385}],392:[function(e,t){t.exports=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),a=[],o=0;o<e.length-1;o++)a.push(e[o],t[o]||"");return a.push(e[o]),a.join("")}},{}],393:[function(e,t){(function(a){"use strict";var o=e("is-browser"),r;r="function"==typeof a.matchMedia?!a.matchMedia("(hover: none)").matches:o,t.exports=r}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"is-browser":400}],394:[function(e,t){"use strict";var a=e("is-browser");t.exports=a&&function(){var t=!1;try{var a=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,a),window.removeEventListener("test",null,a)}catch(a){t=!1}return t}()},{"is-browser":400}],395:[function(e,t,a){a.read=function(t,a,o,r,n){var l=8*n-r-1,c=(1<<l)-1,p=c>>1,u=-7,g=o?n-1:0,h=o?-1:1,d=t[a+g],y,f;for(g+=h,y=d&(1<<-u)-1,d>>=-u,u+=l;0<u;y=256*y+t[a+g],g+=h,u-=8);for(f=y&(1<<-u)-1,y>>=-u,u+=r;0<u;f=256*f+t[a+g],g+=h,u-=8);if(0===y)y=1-p;else{if(y===c)return f?NaN:(d?-1:1)*(1/0);f+=_a(2,r),y-=p}return(d?-1:1)*f*_a(2,y-r)},a.write=function(t,a,o,r,n,l){var p=8*l-n-1,u=(1<<p)-1,g=u>>1,h=23===n?_a(2,-24)-_a(2,-77):0,y=r?0:l-1,f=r?1:-1,d=0>a||0===a&&0>1/a?1:0,s,x,b;for(a=wa(a),isNaN(a)||a===1/0?(x=isNaN(a)?1:0,s=u):(s=ea(P(a)/E),1>a*(b=_a(2,-s))&&(s--,b*=2),a+=1<=s+g?h/b:h*_a(2,1-g),2<=a*b&&(s++,b/=2),s+g>=u?(x=0,s=u):1<=s+g?(x=(a*b-1)*_a(2,n),s+=g):(x=a*_a(2,g-1)*_a(2,n),s=0));8<=n;t[o+y]=255&x,y+=f,x/=256,n-=8);for(s=s<<n|x,p+=n;0<p;t[o+y]=255&s,y+=f,s/=256,p-=8);t[o+y-f]|=128*d}},{}],396:[function(e,t){"use strict";function a(e,t,a){this.vertices=e,this.adjacent=t,this.boundary=a,this.lastVisited=-1}function o(e,t,a){this.vertices=e,this.cell=t,this.index=a}function r(e,t){return d(e.vertices,t.vertices)}function n(e){for(var t=["function orient(){var tuple=this.tuple;return test("],a=0;a<=e;++a)0<a&&t.push(","),t.push("tuple[",a,"]");t.push(")}return orient");var o=new Function("test",t.join("")),r=s[e+1];return r||(r=s),o(r)}function l(e,t,a){this.dimension=e,this.vertices=t,this.simplices=a,this.interior=a.filter(function(e){return!e.boundary}),this.tuple=Array(e+1);for(var r=0;r<=e;++r)this.tuple[r]=this.vertices[r];var l=c[e];l||(l=c[e]=n(e)),this.orient=l}t.exports=function(e,r){var c=e.length;if(0===c)throw new Error("Must have at least d+1 points");var n=e[0].length;if(c<=n)throw new Error("Must input at least d+1 points");var d=e.slice(0,n+1),p=s.apply(void 0,d);if(0===p)throw new Error("Input not in general position");for(var o=Array(n+1),u=0;u<=n;++u)o[u]=u;0>p&&(o[0]=1,o[1]=0);for(var g=new a(o,Array(n+1),!1),h=g.adjacent,m=Array(n+2),u=0,y;u<=n;++u){y=o.slice();for(var f=0;f<=n;++f)f==u&&(y[f]=-1);var x=y[0];y[0]=y[1],y[1]=x;var t=new a(y,Array(n+1),!0);h[u]=t,m[u]=t}m[n+1]=g;for(var u=0;u<=n;++u)for(var y=h[u].vertices,b=h[u].adjacent,f=0,_;f<=n;++f){if(_=y[f],0>_){b[f]=g;continue}for(var w=0;w<=n;++w)0>h[w].vertices.indexOf(_)&&(b[f]=h[w])}for(var T=new l(n,d,m),u=n+1;u<c;++u)T.insert(e[u],!!r);return T.boundary()};var s=e("robust-orientation"),d=e("simplicial-complex").compareCells;a.prototype.flip=function(){var e=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=e;var t=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=t};var c=[],p=l.prototype;p.handleBoundaryDegeneracy=function(e,t){var a=this.dimension,r=this.vertices.length-1,n=this.tuple,l=this.vertices,s=[e];for(e.lastVisited=-r;0<s.length;){e=s.pop();for(var d=e.vertices,c=e.adjacent,p=0,u;p<=a;++p)if(u=c[p],u.boundary&&!(u.lastVisited<=-r)){for(var g=u.vertices,h=0,m;h<=a;++h)m=g[h],n[h]=0>m?t:l[m];var y=this.orient();if(0<y)return u;u.lastVisited=-r,0===y&&s.push(u)}}return null},p.walk=function(e,t){var a=this.vertices.length-1,r=this.dimension,n=this.vertices,l=this.tuple,s=t?0|this.interior.length*Math.random():this.interior.length-1,d=this.interior[s];outerLoop:for(;!d.boundary;){for(var c=d.vertices,p=d.adjacent,u=0;u<=r;++u)l[u]=n[c[u]];d.lastVisited=a;for(var u=0,g;u<=r;++u)if(g=p[u],!(g.lastVisited>=a)){var h=l[u];l[u]=e;var m=this.orient();if(l[u]=h,0>m){d=g;continue outerLoop}else g.lastVisited=g.boundary?-a:a}return}return d},p.addPeaks=function(e,t){var l=this.vertices.length-1,n=this.dimension,s=this.vertices,d=this.tuple,c=this.interior,p=this.simplices,u=[t];t.lastVisited=l,t.vertices[t.vertices.indexOf(-1)]=l,t.boundary=!1,c.push(t);for(var g=[];0<u.length;){var t=u.pop(),h=t.vertices,m=t.adjacent,y=h.indexOf(l);if(!(0>y))for(var f=0;f<=n;++f)if(f!==y){var x=m[f];if(x.boundary&&!(x.lastVisited>=l)){var _=x.vertices;if(x.lastVisited!==-l){for(var v=0,w=0;w<=n;++w)0>_[w]?(v=w,d[w]=e):d[w]=s[_[w]];var T=this.orient();if(0<T){_[v]=l,x.boundary=!1,c.push(x),u.push(x),x.lastVisited=l;continue}else x.lastVisited=-l}var A=x.adjacent,S=h.slice(),C=m.slice(),L=new a(S,C,!0);p.push(L);var E=A.indexOf(t);if(!(0>E)){A[E]=L,C[y]=x,S[f]=-1,C[f]=t,m[f]=L,L.flip();for(var w=0,z;w<=n;++w)if(z=S[w],!(0>z||z===l)){for(var I=Array(n-1),D=0,P=0,O;P<=n;++P)(O=S[P],!(0>O||P==w))&&(I[D++]=O);g.push(new o(I,L,w))}}}}}g.sort(r);for(var f=0;f+1<g.length;f+=2){var R=g[f],M=g[f+1],b=R.index,B=M.index;0>b||0>B||(R.cell.adjacent[R.index]=M.cell,M.cell.adjacent[M.index]=R.cell)}},p.insert=function(e,t){var a=this.vertices;a.push(e);var r=this.walk(e,t);if(r){for(var n=this.dimension,l=this.tuple,s=0,d;s<=n;++s)d=r.vertices[s],l[s]=0>d?e:a[d];var c=this.orient(l);0>c||0===c&&(r=this.handleBoundaryDegeneracy(r,e),!r)||this.addPeaks(e,r)}},p.boundary=function(){for(var e=this.dimension,a=[],o=this.simplices,r=o.length,n=0,l;n<r;++n)if(l=o[n],l.boundary){for(var s=Array(e),d=l.vertices,p=0,u=0,g=0;g<=e;++g)0<=d[g]?s[p++]=d[g]:u=1&g;if(u===(1&e)){var h=s[0];s[0]=s[1],s[1]=h}a.push(s)}return a}},{"robust-orientation":486,"simplicial-complex":496}],397:[function(e,t){"use strict";function a(e,t,a,o,r){this.mid=e,this.left=t,this.right=a,this.leftPoints=o,this.rightPoints=r,this.count=(t?t.count:0)+(a?a.count:0)+o.length}function o(e,t){e.mid=t.mid,e.left=t.left,e.right=t.right,e.leftPoints=t.leftPoints,e.rightPoints=t.rightPoints,e.count=t.count}function r(e,t){var a=g(t);e.mid=a.mid,e.left=a.left,e.right=a.right,e.leftPoints=a.leftPoints,e.rightPoints=a.rightPoints,e.count=a.count}function i(e,t){var a=e.intervals([]);a.push(t),r(e,a)}function n(e,t){var a=e.intervals([]),o=a.indexOf(t);return 0>o?0:(a.splice(o,1),r(e,a),1)}function l(e,t,a){for(var o=0,n;o<e.length&&e[o][0]<=t;++o)if(n=a(e[o]),n)return n}function s(e,t,a){for(var o=e.length-1,n;0<=o&&e[o][1]>=t;--o)if(n=a(e[o]),n)return n}function d(e,t){for(var a=0,o;a<e.length;++a)if(o=t(e[a]),o)return o}function c(e,t){return e-t}function p(e,t){var a=e[0]-t[0];return a?a:e[1]-t[1]}function u(e,t){var a=e[1]-t[1];return a?a:e[0]-t[0]}function g(e){if(0===e.length)return null;for(var t=[],o=0;o<e.length;++o)t.push(e[o][0],e[o][1]);t.sort(c);for(var r=t[t.length>>1],n=[],l=[],d=[],o=0,h;o<e.length;++o)h=e[o],h[1]<r?n.push(h):r<h[0]?l.push(h):d.push(h);var m=d,y=d.slice();return m.sort(p),y.sort(u),new a(r,g(n),g(l),m,y)}function h(e){this.root=e}var m=e("binary-search-bounds"),y=0,f=1,x=2;t.exports=function(e){return e&&0!==e.length?new h(g(e)):new h(null)};var b=a.prototype;b.intervals=function(e){return e.push.apply(e,this.leftPoints),this.left&&this.left.intervals(e),this.right&&this.right.intervals(e),e},b.insert=function(e){var t=this.count-this.leftPoints.length;if(this.count+=1,e[1]<this.mid)this.left?4*(this.left.count+1)>3*(t+1)?i(this,e):this.left.insert(e):this.left=g([e]);else if(e[0]>this.mid)this.right?4*(this.right.count+1)>3*(t+1)?i(this,e):this.right.insert(e):this.right=g([e]);else{var a=m.ge(this.leftPoints,e,p),o=m.ge(this.rightPoints,e,u);this.leftPoints.splice(a,0,e),this.rightPoints.splice(o,0,e)}},b.remove=function(e){var t=this.count-this.leftPoints;if(e[1]<this.mid){if(!this.left)return y;var a=this.right?this.right.count:0;if(4*a>3*(t-1))return n(this,e);var i=this.left.remove(e);return i===x?(this.left=null,this.count-=1,f):(i===f&&(this.count-=1),i)}if(e[0]>this.mid){if(!this.right)return y;var s=this.left?this.left.count:0;if(4*s>3*(t-1))return n(this,e);var i=this.right.remove(e);return i===x?(this.right=null,this.count-=1,f):(i===f&&(this.count-=1),i)}if(1===this.count)return this.leftPoints[0]===e?x:y;if(1===this.leftPoints.length&&this.leftPoints[0]===e){if(this.left&&this.right){for(var d=this,c=this.left;c.right;)d=c,c=c.right;if(d===this)c.right=this.right;else{var g=this.left,i=this.right;d.count-=c.count,d.right=c.left,c.left=g,c.right=i}o(this,c),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?o(this,this.left):o(this,this.right);return f}for(var g=m.ge(this.leftPoints,e,p);g<this.leftPoints.length&&this.leftPoints[g][0]===e[0];++g)if(this.leftPoints[g]===e){this.count-=1,this.leftPoints.splice(g,1);for(var i=m.ge(this.rightPoints,e,u);i<this.rightPoints.length&&this.rightPoints[i][1]===e[1];++i)if(this.rightPoints[i]===e)return this.rightPoints.splice(i,1),f}return y},b.queryPoint=function(e,t){if(e<this.mid){if(this.left){var a=this.left.queryPoint(e,t);if(a)return a}return l(this.leftPoints,e,t)}if(e>this.mid){if(this.right){var a=this.right.queryPoint(e,t);if(a)return a}return s(this.rightPoints,e,t)}return d(this.leftPoints,t)},b.queryInterval=function(e,t,a){if(e<this.mid&&this.left){var o=this.left.queryInterval(e,t,a);if(o)return o}if(t>this.mid&&this.right){var o=this.right.queryInterval(e,t,a);if(o)return o}return t<this.mid?l(this.leftPoints,t,a):e>this.mid?s(this.rightPoints,e,a):d(this.leftPoints,a)};var _=h.prototype;_.insert=function(e){this.root?this.root.insert(e):this.root=new a(e[0],null,null,[e],[e])},_.remove=function(e){if(this.root){var t=this.root.remove(e);return t===x&&(this.root=null),t!==y}return!1},_.queryPoint=function(e,t){if(this.root)return this.root.queryPoint(e,t)},_.queryInterval=function(e,t,a){if(e<=t&&this.root)return this.root.queryInterval(e,t,a)},Object.defineProperty(_,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(_,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":79}],398:[function(e,t){"use strict";t.exports=function(e,t){t=t||Array(e.length);for(var a=0;a<e.length;++a)t[e[a]]=a;return t}},{}],399:[function(e,t){"use strict";t.exports=function(e){for(var t=Array(e),a=0;a<e;++a)t[a]=a;return t}},{}],400:[function(e,t){t.exports=!0},{}],401:[function(e,t){function a(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function o(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&a(e.slice(0,0))}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */t.exports=function(e){return null!=e&&(a(e)||o(e)||!!e._isBuffer)}},{}],402:[function(e,t){"use strict";t.exports="undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],403:[function(e,t){"use strict";function a(e){e||(e={});var t=e.ua;return t||"undefined"==typeof navigator||(t=navigator.userAgent),t&&t.headers&&"string"==typeof t.headers["user-agent"]&&(t=t.headers["user-agent"]),"string"==typeof t&&(e.tablet?r.test(t):o.test(t))}t.exports=a,t.exports.isMobile=a;var o=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,r=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i},{}],404:[function(e,t){"use strict";t.exports=function(e){var t=typeof e;return null!==e&&("object"==t||"function"==t)}},{}],405:[function(e,t){"use strict";var a=Object.prototype.toString;t.exports=function(e){var t;return"[object Object]"===a.call(e)&&(t=Object.getPrototypeOf(e),null===t||t===Object.getPrototypeOf({}))}},{}],406:[function(e,t){"use strict";t.exports=function(e){for(var t=e.length,o=0,r;o<t;o++)if(r=e.charCodeAt(o),(9>r||13<r)&&32!==r&&133!==r&&160!==r&&5760!==r&&6158!==r&&(8192>r||8205<r)&&8232!==r&&8233!==r&&8239!==r&&8287!==r&&8288!==r&&12288!==r&&65279!==r)return!1;return!0}},{}],407:[function(e,t){"use strict";t.exports=function(e){return!("string"!=typeof e)&&(e=e.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(e)&&/[\dz]$/i.test(e)&&4<e.length))}},{}],408:[function(e,t){t.exports=function(e,a,o){return e*(1-o)+a*o}},{}],409:[function(e,t,o){(function(se){(function(e,a){"object"==typeof o&&"undefined"!=typeof t?t.exports=a():"function"==typeof Ca&&Ca.amd?Ca(a):e.mapboxgl=a()})(this,function(){"use strict";function e(e,a){if(!t)t=a;else if(!o)o=a;else{var i="var sharedChunk = {}; ("+t+")(sharedChunk); ("+o+")(sharedChunk);",n={};t(n),r=a(n),r.workerUrl=window.URL.createObjectURL(new Blob([i],{type:"text/javascript"}))}}var t,o,r;return e(["exports"],function(ue){function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function r(a,t){return a(t={exports:{}},t.exports),t.exports}function n(a,t,e,o){this.cx=3*a,this.bx=3*(e-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(o-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=o,this.p2x=e,this.p2y=o}function o(a,t){this.x=a,this.y=t}function u(a,t,e,r){var i=new al(a,t,e,r);return function(e){return i.solve(e)}}function $t(a,t,e){return ie(e,va(t,a))}function l(l){for(var t=[],e=arguments.length-1;0<e--;)t[e]=arguments[e+1];for(var s=0,d=t,i;s<d.length;s+=1)for(var c in i=d[s],i)l[c]=i[c];return l}function c(a,o){a.forEach(function(e){o[e]&&(o[e]=o[e].bind(o))})}function h(a,t){return-1!==a.indexOf(t,a.length-t.length)}function d(a,t,e){var o={};for(var r in a)o[r]=t.call(e||this,a[r],r,a);return o}function y(a,t,e){var o={};for(var r in a)t.call(e||this,a[r],r,a)&&(o[r]=a[r]);return o}function m(e){return Array.isArray(e)?e.map(m):"object"==typeof e&&e?d(e,m):e}function Qt(e){s[e]||("undefined"!=typeof console&&console.warn(e),s[e]=!0)}function b(a,t,e){return(e.y-a.y)*(t.x-a.x)>(t.y-a.y)*(e.x-a.x)}function w(l){for(var t=0,s=0,d=l.length,n=d-1,c=void 0,p=void 0;s<d;n=s++)c=l[s],t+=((p=l[n]).x-c.x)*(c.y+p.y);return t}function Ga(a){var t=new self.XMLHttpRequest;for(var e in t.open("GET",a.url,!0),a.headers)t.setRequestHeader(e,a.headers[e]);return t.withCredentials="include"===a.credentials,t}function z(a,t,e){e[a]=e[a]||[],e[a].push(t)}function Ya(a,t,e){if(e&&e[a]){var o=e[a].indexOf(t);-1!==o&&e[a].splice(o,1)}}function V(a){var t=a.key,e=a.value;return e?[new il(t,e,"constants have been deprecated as of v8")]:[]}function Wa(l){for(var t=[],e=arguments.length-1;0<e--;)t[e]=arguments[e+1];for(var s=0,d=t,i;s<d.length;s+=1)for(var c in i=d[s],i)l[c]=i[c];return l}function T(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Xa(e){return Array.isArray(e)?e.map(Xa):T(e)}function Qa(a,t){return{kind:"array",itemType:a,N:t}}function H(a){if("array"===a.kind){var t=H(a.itemType);return"number"==typeof a.N?"array<"+t+", "+a.N+">":"value"===a.itemType.kind?"array":"array<"+t+">"}return a.kind}function X(a,t){if("error"===t.kind)return null;if("array"!==a.kind){if(a.kind===t.kind)return null;if("value"===a.kind)for(var e=0,o=$;e<o.length;e+=1)if(!X(o[e],t))return null}else if("array"===t.kind&&!X(a.itemType,t.itemType)&&("number"!=typeof a.N||a.N===t.N))return null;return"Expected "+H(a)+" but found "+H(t)+" instead."}function Y(a,t,e,o){return"number"==typeof a&&0<=a&&255>=a&&"number"==typeof t&&0<=t&&255>=t&&"number"==typeof e&&0<=e&&255>=e?void 0===o||"number"==typeof o&&0<=o&&1>=o?null:"Invalid rgba value ["+[a,t,e,o].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof o?[a,t,e,o]:[a,t,e]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function rt(a){if(null===a)return q;if("string"==typeof a)return U;if("boolean"==typeof a)return D;if("number"==typeof a)return nl;if(a instanceof W)return N;if(a instanceof Q)return J;if(Array.isArray(a)){for(var t=a.length,r=0,l=a,i,s;r<l.length;r+=1){if(s=rt(l[r]),i){if(i===s)continue;i=K;break}i=s}return Qa(i||K,t)}return Z}function nt(a){if(a instanceof ft){if("get"===a.name&&1===a.args.length)return!1;if("has"===a.name&&1===a.args.length)return!1;if("properties"===a.name||"geometry-type"===a.name||"id"===a.name)return!1;if(/^filter-/.test(a.name))return!1}var o=!0;return a.eachChild(function(e){o&&!nt(e)&&(o=!1)}),o}function dt(a,o){if(a instanceof ft&&0<=o.indexOf(a.name))return!1;var e=!0;return a.eachChild(function(a){e&&!dt(a,o)&&(e=!1)}),e}function vt(l,t){for(var e=0,s=l.length-1,d=0,c,p;e<=s;){if(c=l[d=ea((e+s)/2)],p=l[d+1],t===c||t>c&&t<p)return d;if(c<t)e=d+1;else{if(!(c>t))throw new it("Input is not a number.");s=d-1}}return va(d-1,0)}function xt(a,t,e){return a*(1-e)+t*e}function wt(a,t,e,r){var n=r-e,i=a-e;return 0==n?0:1===t?i/n:(_a(t,i)-1)/(_a(t,n)-1)}function kt(e){return"string"===e.kind||"number"===e.kind||"boolean"===e.kind||"null"===e.kind}function Ct(a,o){return function(){function l(a,t,e){this.type=D,this.lhs=a,this.rhs=t,this.collator=e}return l.parse=function(a,t){if(3!==a.length&&4!==a.length)return t.error("Expected two or three arguments.");var e=t.parse(a[1],1,K);if(!e)return null;var r=t.parse(a[2],2,K);if(!r)return null;if(!kt(e.type)&&!kt(r.type))return t.error("Expected at least one argument to be a string, number, boolean, or null, but found ("+H(e.type)+", "+H(r.type)+") instead.");if(e.type.kind!==r.type.kind&&"value"!==e.type.kind&&"value"!==r.type.kind)return t.error("Cannot compare "+H(e.type)+" and "+H(r.type)+".");var i=null;if(4===a.length){if("string"!==e.type.kind&&"string"!==r.type.kind)return t.error("Cannot use collator to compare non-string types.");if(!(i=t.parse(a[3],3,J)))return null}return new l(e,r,i)},l.prototype.evaluate=function(e){var t=this.collator?0===this.collator.evaluate(e).compare(this.lhs.evaluate(e),this.rhs.evaluate(e)):this.lhs.evaluate(e)===this.rhs.evaluate(e);return o?!t:t},l.prototype.eachChild=function(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)},l.prototype.possibleOutputs=function(){return[!0,!1]},l.prototype.serialize=function(){var o=[a];return this.eachChild(function(e){o.push(e.serialize())}),o},l}()}function It(l,t){var e=t[0],d=t[1],c=t[2],p=t[3];e=e.evaluate(l),d=d.evaluate(l),c=c.evaluate(l);var o=p?p.evaluate(l):1,a=Y(e,d,c,o);if(a)throw new it(a);return new W(e/255*o,d/255*o,c/255*o,o)}function Ot(a,t){return a in t}function Lt(a,t){var e=t[a];return void 0===e?null:e}function jt(a,t){var e=t[0],o=t[1];return e.evaluate(a)<o.evaluate(a)}function qt(a,t){var e=t[0],o=t[1];return e.evaluate(a)>o.evaluate(a)}function Rt(a,t){var e=t[0],o=t[1];return e.evaluate(a)<=o.evaluate(a)}function Ut(a,t){var e=t[0],o=t[1];return e.evaluate(a)>=o.evaluate(a)}function Dt(e){return{type:e}}function Nt(e){return{result:"success",value:e}}function Zt(e){return{result:"error",value:e}}function Kt(e){return e>Yt?_a(e,1/3):e/Gt+Ht}function ee(e){return e>Xt?e*e*e:Gt*(e-Ht)}function go(e){return 255*(.0031308>=e?12.92*e:1.055*_a(e,1/2.4)-.055)}function ne(e){return .04045>=(e/=255)?e/12.92:_a((e+.055)/1.055,2.4)}function gi(a){var t=ne(a.r),e=ne(a.g),r=ne(a.b),n=Kt((.4124564*t+.3575761*e+.1804375*r)/Tt),i=Kt((.2126729*t+.7151522*e+.072175*r)/1);return{l:116*i-16,a:500*(n-i),b:200*(i-Kt((.0193339*t+.119192*e+.9503041*r)/Jt)),alpha:a.a}}function oe(a){var t=(a.l+16)/116,o=isNaN(a.a)?t:t+a.a/500,i=isNaN(a.b)?t:t-a.b/200;return t=1*ee(t),o=Tt*ee(o),i=Jt*ee(i),new W(go(3.2404542*o-1.5371385*t-.4985314*i),go(-.969266*o+1.8760108*t+.041556*i),go(.0556434*o-.2040259*t+1.0572252*i),a.alpha)}function Ni(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function pe(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function ce(e){return e}function he(a,t,e){return void 0===a?void 0===t?void 0===e?void 0:e:t:a}function fe(a,t,e,o,r){return he(typeof e===r?o[e]:void 0,a.default,t.default)}function ye(a,t,e){if("number"!==Ni(e))return he(a.default,t.default);var o=a.stops.length;if(1===o)return a.stops[0][1];if(e<=a.stops[0][0])return a.stops[0][1];if(e>=a.stops[o-1][0])return a.stops[o-1][1];var r=me(a.stops,e);return a.stops[r][1]}function de(d,t,e){var r=void 0===d.base?1:d.base;if("number"!==Ni(e))return he(d.default,t.default);var n=d.stops.length;if(1===n)return d.stops[0][1];if(e<=d.stops[0][0])return d.stops[0][1];if(e>=d.stops[n-1][0])return d.stops[n-1][1];var i=me(d.stops,e),o=function(a,t,e,r){var n=r-e,i=a-e;return 0==n?0:1===t?i/n:(_a(t,i)-1)/(_a(t,n)-1)}(e,r,d.stops[i][0],d.stops[i+1][0]),a=d.stops[i][1],s=d.stops[i+1][1],c=bt[t.type]||ce;if(d.colorSpace&&"rgb"!==d.colorSpace){var u=Wt[d.colorSpace];c=function(a,t){return u.reverse(u.interpolate(u.forward(a),u.forward(t),o))}}return"function"==typeof a.evaluate?{evaluate:function(){for(var i=[],t=arguments.length;t--;)i[t]=arguments[t];var l=a.evaluate.apply(void 0,i),r=s.evaluate.apply(void 0,i);if(void 0!==l&&void 0!==r)return c(l,r,o)}}:c(a,s,o)}function ve(a,t,e){return"color"===t.type?e=W.parse(e):Ni(e)===t.type||"enum"===t.type&&t.values[e]||(e=void 0),he(e,a.default,t.default)}function me(l,t){for(var e=0,s=l.length-1,d=0,c,p;e<=s;){if(c=l[d=ea((e+s)/2)][0],p=l[d+1][0],t===c||t>c&&t<p)return d;c<t?e=d+1:c>t&&(s=d-1)}return va(d-1,0)}function ge(e){return Array.isArray(e)&&0<e.length&&"string"==typeof e[0]&&e[0]in Pt}function be(a,t){var e=new mt(Pt,[],function(a){var t={color:N,string:U,number:nl,enum:U,boolean:D};return"array"===a.type?Qa(t[a.value]||K,a.length):t[a.type]||null}(t)),o=e.parse(a);return o?Nt(new le(o,t)):Zt(e.errors)}function we(a,l){if("error"===(a=be(a,l)).result)return a;var e=a.value.expression,r=nt(e);if(!r&&!l["property-function"])return Zt([new F("","property expressions not supported")]);var n=dt(e,["zoom"]);if(!n&&!1===l["zoom-function"])return Zt([new F("","zoom expressions not supported")]);var i=function a(t){var l=null;if(t instanceof zt)l=a(t.result);else if(t instanceof At)for(var e=0,s=t.args,i;e<s.length&&(i=s[e],!(l=a(i)));e+=1);else(t instanceof gt||t instanceof _t)&&t.input instanceof ft&&"zoom"===t.input.name&&(l=t);return l instanceof F?l:(t.eachChild(function(t){var e=a(t);e instanceof F?l=e:!l&&e?l=new F("","\"zoom\" expression may only be used as input to a top-level \"step\" or \"interpolate\" expression."):l&&e&&l!==e&&(l=new F("","Only one zoom-based \"step\" or \"interpolate\" subexpression may be used in an expression."))}),l)}(e);return i||n?i instanceof F?Zt([i]):i instanceof _t&&"piecewise-constant"===l.function?Zt([new F("","\"interpolate\" expressions cannot be used with this property")]):Nt(i?new _e(r?"camera":"composite",a.value,i):new xe(r?"constant":"source",a.value)):Zt([new F("","\"zoom\" expression may only be used as input to a top-level \"step\" or \"interpolate\" expression.")])}function ke(a,t){if(pe(a))return new Ae(a,t);if(ge(a)){var e=we(a,t);if("error"===e.result)throw new Error(e.value.map(function(e){return e.key+": "+e.message}).join(", "));return e.value}var o=a;return"string"==typeof a&&"color"===t.type&&(o=W.parse(a)),{kind:"constant",evaluate:function(){return o}}}function Se(d){var t=d.key,e=d.value,r=d.valueSpec||{},n=d.objectElementValidators||{},i=d.style,o=d.styleSpec,a=[],g=Ni(e);if("object"!==g)return[new il(t,e,"object expected, "+g+" found")];for(var u in e){var l=u.split(".")[0],p=r[l]||r["*"],c=void 0;if(n[l])c=n[l];else if(r[l])c=Xe;else if(n["*"])c=n["*"];else{if(!r["*"]){a.push(new il(t,e[u],"unknown property \""+u+"\""));continue}c=Xe}a=a.concat(c({key:(t?t+".":t)+u,value:e[u],valueSpec:p,style:i,styleSpec:o,object:e,objectKey:u},e))}for(var m in r)n[m]||r[m].required&&void 0===r[m].default&&void 0===e[m]&&a.push(new il(t,e,"missing required property \""+m+"\""));return a}function Me(d){var t=d.value,e=d.valueSpec,r=d.style,n=d.styleSpec,i=d.key,o=d.arrayElementValidator||Xe;if("array"!==Ni(t))return[new il(i,t,"array expected, "+Ni(t)+" found")];if(e.length&&t.length!==e.length)return[new il(i,t,"array length "+e.length+" expected, length "+t.length+" found")];if(e["min-length"]&&t.length<e["min-length"])return[new il(i,t,"array length at least "+e["min-length"]+" expected, length "+t.length+" found")];var a={type:e.value};7>n.$version&&(a.function=e.function),"object"===Ni(e.value)&&(a=e.value);for(var c=[],p=0;p<t.length;p++)c=c.concat(o({array:t,arrayIndex:p,value:t[p],valueSpec:a,style:r,styleSpec:n,key:i+"["+p+"]"}));return c}function Ve(a){var t=a.key,e=a.value,o=a.valueSpec,r=Ni(e);return"number"===r?"minimum"in o&&e<o.minimum?[new il(t,e,e+" is less than the minimum value "+o.minimum)]:"maximum"in o&&e>o.maximum?[new il(t,e,e+" is greater than the maximum value "+o.maximum)]:[]:[new il(t,e,"number expected, "+r+" found")]}function Be(d){function u(a){var t=[],r=a.value,o=a.key;if("array"!==Ni(r))return[new il(o,r,"array expected, "+Ni(r)+" found")];if(2!==r.length)return[new il(o,r,"array length 2 expected, length "+r.length+" found")];if(m){if("object"!==Ni(r[0]))return[new il(o,r,"object expected, "+Ni(r[0])+" found")];if(void 0===r[0].zoom)return[new il(o,r,"object stop key must have zoom")];if(void 0===r[0].value)return[new il(o,r,"object stop key must have value")];if(l&&l>T(r[0].zoom))return[new il(o,r[0].zoom,"stop zoom values must appear in ascending order")];T(r[0].zoom)!==l&&(l=T(r[0].zoom),f=void 0,h={}),t=t.concat(Se({key:o+"[0]",value:r[0],valueSpec:{zoom:{}},style:a.style,styleSpec:a.styleSpec,objectElementValidators:{zoom:Ve,value:c}}))}else t=t.concat(c({key:o+"[0]",value:r[0],valueSpec:{},style:a.style,styleSpec:a.styleSpec},r));return t.concat(Xe({key:o+"[1]",value:r[1],valueSpec:g,style:a.style,styleSpec:a.styleSpec}))}function c(e,t){var a=Ni(e.value),o=T(e.value),r=null===e.value?t:e.value;if(!y)y=a;else if(a!==y)return[new il(e.key,r,a+" stop domain type must match previous stop domain type "+y)];if("number"!==a&&"string"!==a&&"boolean"!==a)return[new il(e.key,r,"stop domain value must be a number, string, or boolean")];if("number"!==a&&"categorical"!==i){var n="number expected, "+a+" found";return g["property-function"]&&void 0===i&&(n+="\nIf you intended to use a categorical function, specify `\"type\": \"categorical\"`."),[new il(e.key,r,n)]}return"categorical"!==i||"number"!==a||isFinite(o)&&ea(o)===o?"categorical"!==i&&"number"===a&&void 0!==f&&o<f?[new il(e.key,r,"stop domain values must appear in ascending order")]:(f=o,"categorical"===i&&o in h?[new il(e.key,r,"stop domain values must be unique")]:(h[o]=!0,[])):[new il(e.key,r,"integer expected, found "+o)]}var g=d.valueSpec,i=T(d.value.type),h={},t="categorical"!==i&&void 0===d.value.property,m="array"===Ni(d.value.stops)&&"array"===Ni(d.value.stops[0])&&"object"===Ni(d.value.stops[0][0]),o=Se({key:d.key,value:d.value,valueSpec:d.styleSpec.function,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:function(a){if("identity"===i)return[new il(a.key,a.value,"identity function may not have a \"stops\" property")];var t=[],o=a.value;return t=t.concat(Me({key:a.key,value:o,valueSpec:a.valueSpec,style:a.style,styleSpec:a.styleSpec,arrayElementValidator:u})),"array"===Ni(o)&&0===o.length&&t.push(new il(a.key,o,"array must have at least one stop")),t},default:function(e){return Xe({key:e.key,value:e.value,valueSpec:g,style:e.style,styleSpec:e.styleSpec})}}}),y,f,l;return"identity"===i&&t&&o.push(new il(d.key,d.value,"missing required property \"property\"")),"identity"===i||d.value.stops||o.push(new il(d.key,d.value,"missing required property \"stops\"")),"exponential"===i&&"piecewise-constant"===d.valueSpec.function&&o.push(new il(d.key,d.value,"exponential functions not supported")),8<=d.styleSpec.$version&&(!t&&!d.valueSpec["property-function"]?o.push(new il(d.key,d.value,"property functions not supported")):t&&!d.valueSpec["zoom-function"]&&"heatmap-color"!==d.objectKey&&"line-gradient"!==d.objectKey&&o.push(new il(d.key,d.value,"zoom functions not supported"))),"categorical"!==i&&!m||void 0!==d.value.property||o.push(new il(d.key,d.value,"\"property\" property is required")),o}function Ce(a){var t=("property"===a.expressionContext?we:be)(Xa(a.value),a.valueSpec);return"error"===t.result?t.value.map(function(t){return new il(""+a.key+t.key,a.value,t.message)}):"property"===a.expressionContext&&"text-font"===a.propertyKey&&-1!==t.value._styleExpression.expression.possibleOutputs().indexOf(void 0)?[new il(a.key,a.value,"Invalid data expression for \"text-font\". Output values must be contained as literals within the expression.")]:[]}function Ie(a){var t=a.key,e=a.value,o=a.valueSpec,r=[];return Array.isArray(o.values)?-1===o.values.indexOf(T(e))&&r.push(new il(t,e,"expected one of ["+o.values.join(", ")+"], "+JSON.stringify(e)+" found")):-1===Object.keys(o.values).indexOf(T(e))&&r.push(new il(t,e,"expected one of ["+Object.keys(o.values).join(", ")+"], "+JSON.stringify(e)+" found")),r}function Ee(a){if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return 2<=a.length&&"$id"!==a[1]&&"$type"!==a[1];case"in":case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3===a.length&&(Array.isArray(a[1])||Array.isArray(a[2]));case"any":case"all":for(var t=0,o=a.slice(1),r;t<o.length;t+=1)if(r=o[t],!Ee(r)&&"boolean"!=typeof r)return!1;return!0;default:return!0;}}function Fe(a){if(!a)return function(){return!0};Ee(a)||(a=Oe(a));var o=be(a,ze);if("error"===o.result)throw new Error(o.value.map(function(e){return e.key+": "+e.message}).join(", "));return function(e,t){return o.value.evaluate(e,t)}}function Te(a,t){return a<t?-1:a>t?1:0}function Oe(a){if(!a)return!0;var t=a[0],o;return 1>=a.length?"any"!==t:"=="===t?Le(a[1],a[2],"=="):"!="===t?Re(Le(a[1],a[2],"==")):"<"===t||">"===t||"<="===t||">="===t?Le(a[1],a[2],t):"any"===t?(o=a.slice(1),["any"].concat(o.map(Oe))):"all"===t?["all"].concat(a.slice(1).map(Oe)):"none"===t?["all"].concat(a.slice(1).map(Oe).map(Re)):"in"===t?je(a[1],a.slice(2)):"!in"===t?Re(je(a[1],a.slice(2))):"has"===t?qe(a[1]):"!has"!==t||Re(qe(a[1]))}function Le(a,t,e){return"$type"===a?["filter-type-"+e,t]:"$id"===a?["filter-id-"+e,t]:["filter-"+e,a,t]}function je(a,o){return 0!==o.length&&("$type"===a?["filter-type-in",["literal",o]]:"$id"===a?["filter-id-in",["literal",o]]:200<o.length&&!o.some(function(e){return typeof e!=typeof o[0]})?["filter-in-large",a,["literal",o.sort(Te)]]:["filter-in-small",a,["literal",o]])}function qe(e){return"$type"===e||("$id"===e?["filter-has-id"]:["filter-has",e])}function Re(e){return["!",e]}function Ue(e){return Ee(Xa(e.value))?Ce(Wa({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function l(t){var e=t.value,r=t.key;if("array"!==Ni(e))return[new il(r,e,"array expected, "+Ni(e)+" found")];var n=t.styleSpec,i=[],d;if(1>e.length)return[new il(r,e,"filter array must have at least 1 element")];switch(i=i.concat(Ie({key:r+"[0]",value:e[0],valueSpec:n.filter_operator,style:t.style,styleSpec:t.styleSpec})),T(e[0])){case"<":case"<=":case">":case">=":2<=e.length&&"$type"===T(e[1])&&i.push(new il(r,e,"\"$type\" cannot be use with operator \""+e[0]+"\""));case"==":case"!=":3!==e.length&&i.push(new il(r,e,"filter array for operator \""+e[0]+"\" must have 3 elements"));case"in":case"!in":2<=e.length&&"string"!==(d=Ni(e[1]))&&i.push(new il(r+"[1]",e[1],"string expected, "+d+" found"));for(var c=2;c<e.length;c++)d=Ni(e[c]),"$type"===T(e[1])?i=i.concat(Ie({key:r+"["+c+"]",value:e[c],valueSpec:n.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==d&&"number"!==d&&"boolean"!==d&&i.push(new il(r+"["+c+"]",e[c],"string, number, or boolean expected, "+d+" found"));break;case"any":case"all":case"none":for(var p=1;p<e.length;p++)i=i.concat(l({key:r+"["+p+"]",value:e[p],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":d=Ni(e[1]),2===e.length?"string"!==d&&i.push(new il(r+"[1]",e[1],"string expected, "+d+" found")):i.push(new il(r,e,"filter array for \""+e[0]+"\" operator must have 2 elements"));}return i}(e)}function De(d,t){var e=d.key,r=d.style,n=d.styleSpec,i=d.value,o=d.objectKey,a=n[t+"_"+d.layerType];if(!a)return[];var s=o.match(/^(.*)-transition$/);if("paint"===t&&s&&a[s[1]]&&a[s[1]].transition)return Xe({key:e,value:i,valueSpec:n.transition,style:r,styleSpec:n});var u=d.valueSpec||a[o],p;if(!u)return[new il(e,i,"unknown property \""+o+"\"")];if("string"===Ni(i)&&u["property-function"]&&!u.tokens&&(p=/^{([^}]+)}$/.exec(i)))return[new il(e,i,"\""+o+"\" does not support interpolation syntax\nUse an identity property function instead: `{ \"type\": \"identity\", \"property\": "+JSON.stringify(p[1])+" }`.")];var g=[];return"symbol"===d.layerType&&("text-field"===o&&r&&!r.glyphs&&g.push(new il(e,i,"use of \"text-field\" requires a style \"glyphs\" property")),"text-font"===o&&pe(Xa(i))&&"identity"===T(i.type)&&g.push(new il(e,i,"\"text-font\" does not support identity functions"))),g.concat(Xe({key:d.key,value:i,valueSpec:u,style:r,styleSpec:n,expressionContext:"property",propertyKey:o}))}function Ne(e){return De(e,"paint")}function Ze(e){return De(e,"layout")}function Ke(d){var g=[],m=d.value,r=d.key,t=d.style,i=d.styleSpec;m.type||m.ref||g.push(new il(r,m,"either \"type\" or \"ref\" is required"));var o=T(m.type),n=T(m.ref),u;if(m.id)for(var y=T(m.id),l=0,x;l<d.arrayIndex;l++)x=t.layers[l],T(x.id)===y&&g.push(new il(r,m.id,"duplicate layer id \""+m.id+"\", previously used at line "+x.id.__line__));if("ref"in m)["type","source","source-layer","filter","layout"].forEach(function(e){e in m&&g.push(new il(r,m[e],"\""+e+"\" is prohibited for ref layers"))}),t.layers.forEach(function(e){T(e.id)===n&&(u=e)}),u?u.ref?g.push(new il(r,m.ref,"ref cannot reference another ref layer")):o=T(u.type):g.push(new il(r,m.ref,"ref layer \""+n+"\" not found"));else if("background"!==o)if(m.source){var b=t.sources&&t.sources[m.source],h=b&&T(b.type);b?"vector"===h&&"raster"===o?g.push(new il(r,m.source,"layer \""+m.id+"\" requires a raster source")):"raster"===h&&"raster"!==o?g.push(new il(r,m.source,"layer \""+m.id+"\" requires a vector source")):"vector"!==h||m["source-layer"]?"raster-dem"===h&&"hillshade"!==o?g.push(new il(r,m.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==o||!m.paint||!m.paint["line-gradient"]||"geojson"===h&&b.lineMetrics||g.push(new il(r,m,"layer \""+m.id+"\" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.")):g.push(new il(r,m,"layer \""+m.id+"\" must specify a \"source-layer\"")):g.push(new il(r,m.source,"source \""+m.source+"\" not found"))}else g.push(new il(r,m,"missing required property \"source\""));return g=g.concat(Se({key:r,value:m,valueSpec:i.layer,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Xe({key:r+".type",value:m.type,valueSpec:i.layer.type,style:d.style,styleSpec:d.styleSpec,object:m,objectKey:"type"})},filter:Ue,layout:function(e){return Se({layer:m,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return Ze(Wa({layerType:o},e))}}})},paint:function(e){return Se({layer:m,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return Ne(Wa({layerType:o},e))}}})}}}))}function Je(l){var t=l.value,e=l.key,r=l.styleSpec,n=l.style;if(!t.type)return[new il(e,t,"\"type\" is required")];var i=T(t.type),o=[];switch(i){case"vector":case"raster":case"raster-dem":if(o=o.concat(Se({key:e,value:t,valueSpec:r["source_"+i.replace("-","_")],style:l.style,styleSpec:r})),"url"in t)for(var d in t)0>["type","url","tileSize"].indexOf(d)&&o.push(new il(e+"."+d,t[d],"a source with a \"url\" property may not include a \""+d+"\" property"));return o;case"geojson":return Se({key:e,value:t,valueSpec:r.source_geojson,style:n,styleSpec:r});case"video":return Se({key:e,value:t,valueSpec:r.source_video,style:n,styleSpec:r});case"image":return Se({key:e,value:t,valueSpec:r.source_image,style:n,styleSpec:r});case"canvas":return o.push(new il(e,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")),o;default:return Ie({key:e+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:n,styleSpec:r});}}function $e(l){var t=l.value,e=l.styleSpec,r=e.light,n=l.style,i=[],d=Ni(t);if(void 0===t)return i;if("object"!==d)return i=i.concat([new il("light",t,"object expected, "+d+" found")]);for(var a in t){var s=a.match(/^(.*)-transition$/);i=s&&r[s[1]]&&r[s[1]].transition?i.concat(Xe({key:a,value:t[a],valueSpec:e.transition,style:n,styleSpec:e})):r[a]?i.concat(Xe({key:a,value:t[a],valueSpec:r[a],style:n,styleSpec:e})):i.concat([new il(a,t[a],"unknown property \""+a+"\"")])}return i}function He(a){var t=a.value,e=a.key,o=Ni(t);return"string"===o?[]:[new il(e,t,"string expected, "+o+" found")]}function Xe(a){var t=a.value,e=a.valueSpec,o=a.styleSpec;return e.function&&pe(T(t))?Be(a):e.function&&ge(Xa(t))?Ce(a):e.type&&Pe[e.type]?Pe[e.type](a):Se(Wa({},a,{valueSpec:e.type?o[e.type]:e}))}function Ye(a){var t=a.value,e=a.key,o=He(a);return o.length?o:(-1===t.indexOf("{fontstack}")&&o.push(new il(e,t,"\"glyphs\" url must include a \"{fontstack}\" token")),-1===t.indexOf("{range}")&&o.push(new il(e,t,"\"glyphs\" url must include a \"{range}\" token")),o)}function We(a,t){t=t||I;var o=[];return o=o.concat(Xe({key:"",value:a,valueSpec:t.$root,styleSpec:t,style:a,objectElementValidators:{glyphs:Ye,"*":function(){return[]}}})),a.constants&&(o=o.concat(V({key:"constants",value:a.constants,style:a,styleSpec:t}))),Qe(o)}function Qe(e){return[].concat(e).sort(function(a,t){return a.line-t.line})}function tr(e){return function(){return Qe(e.apply(this,arguments))}}function er(a,t){var e=!1;if(t&&t.length)for(var l=0,s=t,i;l<s.length;l+=1)i=s[l],a.fire(new B(new Error(i.message))),e=!0;return e}function ar(d,g,h){var m=this.cells=[];if(d instanceof ArrayBuffer){this.arrayBuffer=d;var n=new Int32Array(this.arrayBuffer);d=n[0],g=n[1],h=n[2],this.d=g+2*h;for(var i=0;i<this.d*this.d;i++){var y=n[3+i],a=n[3+i+1];m.push(y===a?null:n.subarray(y,a))}var s=n[3+m.length],u=n[3+m.length+1];this.keys=n.subarray(s,u),this.bboxes=n.subarray(u),this.insert=this._insertReadonly}else{this.d=g+2*h;for(var l=0;l<this.d*this.d;l++)m.push([]);this.keys=[],this.bboxes=[]}this.n=g,this.extent=d,this.padding=h,this.scale=g/d,this.uid=0;var f=h/g*d;this.min=-f,this.max=d+f}function lr(a,t,e){void 0===e&&(e={}),Object.defineProperty(t,"_classRegistryKey",{value:a,writeable:!1}),pr[a]={klass:t,omit:e.omit||[],shallow:e.shallow||[]}}function hr(d,t){if(null==d||"boolean"==typeof d||"number"==typeof d||"string"==typeof d||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp)return d;if(d instanceof ArrayBuffer)return t&&t.push(d),d;if(ArrayBuffer.isView(d)){var e=d;return t&&t.push(e.buffer),e}if(d instanceof ur)return t&&t.push(d.data.buffer),d;if(Array.isArray(d)){for(var r=[],n=0,g=d,o;n<g.length;n+=1)o=g[n],r.push(hr(o,t));return r}if("object"==typeof d){var h=d.constructor,s=h._classRegistryKey;if(!s)throw new Error("can't serialize object of unregistered class");var u={};if(h.serialize)u._serialized=h.serialize(d,t);else{for(var l in d)if(d.hasOwnProperty(l)&&!(0<=pr[s].omit.indexOf(l))){var p=d[l];u[l]=0<=pr[s].shallow.indexOf(l)?p:hr(p,t)}d instanceof Error&&(u.message=d.message)}return{name:s,properties:u}}throw new Error("can't serialize object of type "+typeof d)}function yr(l){if(null==l||"boolean"==typeof l||"number"==typeof l||"string"==typeof l||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||l instanceof ArrayBuffer||ArrayBuffer.isView(l)||l instanceof ur)return l;if(Array.isArray(l))return l.map(function(e){return yr(e)});if("object"==typeof l){var t=l,e=t.name,r=t.properties;if(!e)throw new Error("can't deserialize object of anonymous class");var n=pr[e].klass;if(!n)throw new Error("can't deserialize unregistered class "+e);if(n.deserialize)return n.deserialize(r._serialized);for(var i=Object.create(n.prototype),o=0,d=Object.keys(r),s;o<d.length;o+=1)s=d[o],i[s]=0<=pr[e].shallow.indexOf(s)?r[s]:yr(r[s]);return i}throw new Error("can't deserialize object of type "+typeof l)}function dr(a){for(var t=0,o=a;t<o.length;t+=1)if(xr(o[t].charCodeAt(0)))return!0;return!1}function gr(e){return!vr.Arabic(e)&&!vr["Arabic Supplement"](e)&&!vr["Arabic Extended-A"](e)&&!vr["Arabic Presentation Forms-A"](e)&&!vr["Arabic Presentation Forms-B"](e)}function xr(e){return 746===e||747===e||!(4352>e)&&(!!vr["Bopomofo Extended"](e)||!!vr.Bopomofo(e)||!(!vr["CJK Compatibility Forms"](e)||65097<=e&&65103>=e)||!!vr["CJK Compatibility Ideographs"](e)||!!vr["CJK Compatibility"](e)||!!vr["CJK Radicals Supplement"](e)||!!vr["CJK Strokes"](e)||!(!vr["CJK Symbols and Punctuation"](e)||12296<=e&&12305>=e||12308<=e&&12319>=e||12336===e)||!!vr["CJK Unified Ideographs Extension A"](e)||!!vr["CJK Unified Ideographs"](e)||!!vr["Enclosed CJK Letters and Months"](e)||!!vr["Hangul Compatibility Jamo"](e)||!!vr["Hangul Jamo Extended-A"](e)||!!vr["Hangul Jamo Extended-B"](e)||!!vr["Hangul Jamo"](e)||!!vr["Hangul Syllables"](e)||!!vr.Hiragana(e)||!!vr["Ideographic Description Characters"](e)||!!vr.Kanbun(e)||!!vr["Kangxi Radicals"](e)||!!vr["Katakana Phonetic Extensions"](e)||vr.Katakana(e)&&12540!==e||!(!vr["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||65306<=e&&65310>=e||65339===e||65341===e||65343===e||65371<=e&&65503>=e||65507===e||65512<=e&&65519>=e)||!(!vr["Small Form Variants"](e)||65112<=e&&65118>=e||65123<=e&&65126>=e)||!!vr["Unified Canadian Aboriginal Syllabics"](e)||!!vr["Unified Canadian Aboriginal Syllabics Extended"](e)||!!vr["Vertical Forms"](e)||!!vr["Yijing Hexagram Symbols"](e)||!!vr["Yi Syllables"](e)||!!vr["Yi Radicals"](e))}function br(e){return!(xr(e)||function(e){return!!(vr["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||vr["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||vr["Letterlike Symbols"](e)||vr["Number Forms"](e)||vr["Miscellaneous Technical"](e)&&(8960<=e&&8967>=e||8972<=e&&8991>=e||8996<=e&&9e3>=e||9003===e||9085<=e&&9114>=e||9150<=e&&9165>=e||9167===e||9169<=e&&9179>=e||9186<=e&&9215>=e)||vr["Control Pictures"](e)&&9251!==e||vr["Optical Character Recognition"](e)||vr["Enclosed Alphanumerics"](e)||vr["Geometric Shapes"](e)||vr["Miscellaneous Symbols"](e)&&!(9754<=e&&9759>=e)||vr["Miscellaneous Symbols and Arrows"](e)&&(11026<=e&&11055>=e||11088<=e&&11097>=e||11192<=e&&11243>=e)||vr["CJK Symbols and Punctuation"](e)||vr.Katakana(e)||vr["Private Use Area"](e)||vr["CJK Compatibility Forms"](e)||vr["Small Form Variants"](e)||vr["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||9984<=e&&10087>=e||10102<=e&&10131>=e||65532===e||65533===e)}(e))}function wr(a,t){return!(!t&&(1424<=a&&2303>=a||vr["Arabic Presentation Forms-A"](a)||vr["Arabic Presentation Forms-B"](a)))&&!(2304<=a&&3583>=a||3840<=a&&4255>=a||vr.Khmer(a))}function _r(a,l){void 0===l&&(l=1);var d=0,c=0;return{members:a.map(function(e){var t=(r=e.type,Nr[r].BYTES_PER_ELEMENT),o=d=$r(d,va(l,t)),a=e.components||1,r;return c=va(c,t),d+=t*a,{name:e.name,type:e.type,components:a,offset:o}}),size:$r(d,va(c,l)),alignment:l}}function $r(a,t){return ae(a/t)*t}function Hr(e){return[zn(255*e.r,255*e.g),zn(255*e.b,255*e.a)]}function Pn(a,t){return{"text-opacity":"opacity","icon-opacity":"opacity","text-color":"fill_color","icon-color":"fill_color","text-halo-color":"halo_color","icon-halo-color":"halo_color","text-halo-blur":"halo_blur","icon-halo-blur":"halo_blur","text-halo-width":"halo_width","icon-halo-width":"halo_width","line-gap-width":"gapwidth"}[a]||a.replace(t+"-","").replace(/-/g,"_")}function Mn(l){for(var t=8192/l.extent,e=l.loadGeometry(),r=0;r<e.length;r++)for(var s=e[r],i=0,d;i<s.length;i++)d=s[i],d.x=R(d.x*t),d.y=R(d.y*t),(d.x<En.min||d.x>En.max||d.y<En.min||d.y>En.max)&&Qt("Geometry exceeds allowed extent, reduce your vector tile buffer size");return e}function Ln(a,t,e,o,r){a.emplaceBack(2*t+(o+1)/2,2*e+(r+1)/2)}function jn(a,t,e){for(var o=0,r;o<a.length;o++){if(r=a[o],Hn(r,t))return!0;if(Zn(t,r,e))return!0}return!1}function Rn(l,t){if(1===l.length&&1===l[0].length)return $n(t,l[0][0]);for(var e=0;e<t.length;e++)for(var d=t[e],n=0;n<d.length;n++)if($n(l,d[n]))return!0;for(var c=0;c<l.length;c++){for(var p=l[c],a=0;a<p.length;a++)if($n(t,p[a]))return!0;for(var g=0;g<t.length;g++)if(Nn(p,t[g]))return!0}return!1}function Fn(l,t,e){for(var r=0;r<t.length;r++)for(var d=t[r],i=0,c;i<l.length;i++){if(c=l[i],3<=c.length)for(var p=0;p<d.length;p++)if(Hn(c,d[p]))return!0;if(Dn(c,d,e))return!0}return!1}function Dn(a,t,e){if(1<a.length){if(Nn(a,t))return!0;for(var o=0;o<t.length;o++)if(Zn(t[o],a,e))return!0}for(var r=0;r<a.length;r++)if(Zn(a[r],t,e))return!0;return!1}function Nn(a,t){if(0===a.length||0===t.length)return!1;for(var e=0;e<a.length-1;e++)for(var l=a[e],n=a[e+1],i=0;i<t.length-1;i++)if(Un(l,n,t[i],t[i+1]))return!0;return!1}function Un(a,t,e,o){return b(a,e,o)!==b(t,e,o)&&b(a,t,e)!==b(a,t,o)}function Zn(a,t,e){var o=e*e;if(1===t.length)return a.distSqr(t[0])<o;for(var r=1;r<t.length;r++)if(Jn(a,t[r-1],t[r])<o)return!0;return!1}function Jn(a,t,e){var o=t.distSqr(e);if(0===o)return a.distSqr(t);var r=((a.x-t.x)*(e.x-t.x)+(a.y-t.y)*(e.y-t.y))/o;return 0>r?a.distSqr(t):1<r?a.distSqr(e):a.distSqr(e.sub(t)._mult(r)._add(t))}function $n(l,t){for(var e=!1,d=0,c,p,g;d<l.length;d++)for(var h=0,m=(c=l[d]).length-1;h<c.length;m=h++)p=c[h],g=c[m],p.y>t.y!=g.y>t.y&&t.x<(g.x-p.x)*(t.y-p.y)/(g.y-p.y)+p.x&&(e=!e);return e}function Hn(l,t){for(var e=!1,s=0,d=l.length-1;s<l.length;d=s++){var c=l[s],o=l[d];c.y>t.y!=o.y>t.y&&t.x<(o.x-c.x)*(t.y-c.y)/(o.y-c.y)+c.x&&(e=!e)}return e}function Xn(a,t,e){var o=t.paint.get(a).value;return"constant"===o.kind?o.value:e.programConfigurations.get(t.id).binders[a].statistics.max}function Gn(e){return re(e[0]*e[0]+e[1]*e[1])}function Yn(s,t,e,r,n){if(!t[0]&&!t[1])return s;var i=rl.convert(t);"viewport"===e&&i._rotate(-r);for(var o=[],a=0;a<s.length;a++){for(var d=s[a],l=[],p=0;p<d.length;p++)l.push(d[p].sub(i._mult(n)));o.push(l)}return o}function Wn(a,t,e){var o=ti.transformMat4([],[a.x,a.y,0,1],t);return new rl(.5*((o[0]/o[3]+1)*e.width),.5*((o[1]/o[3]+1)*e.height))}function ii(a,t,e,r){var l=t.width,i=t.height;if(!r)r=new Uint8Array(l*i*e);else if(r.length!==l*i*e)throw new RangeError("mismatched image size");return a.width=l,a.height=i,a.data=r,a}function ai(a,t,e){var r=t.width,n=t.height;if(r!==a.width||n!==a.height){var i=ii({},{width:r,height:n},e);si(a,i,{x:0,y:0},{x:0,y:0},{width:ie(a.width,r),height:ie(a.height,n)},e),a.width=r,a.height=n,a.data=i.data}}function si(d,t,e,r,n,i){if(0===n.width||0===n.height)return t;if(n.width>d.width||n.height>d.height||e.x>d.width-n.width||e.y>d.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>t.width||n.height>t.height||r.x>t.width-n.width||r.y>t.height-n.height)throw new RangeError("out of range destination coordinates for image copy");for(var o=d.data,a=t.data,s=0;s<n.height;s++)for(var g=((e.y+s)*d.width+e.x)*i,l=((r.y+s)*t.width+r.x)*i,p=0;p<n.width*i;p++)a[l+p]=o[g+p];return t}function ui(l,t){for(var e=new Uint8Array(1024),r={},n=0,s=0;256>n;n++,s+=4){r[t]=n/255;var d=l.evaluate(r);e[s+0]=ea(255*d.r/d.a),e[s+1]=ea(255*d.g/d.a),e[s+2]=ea(255*d.b/d.a),e[s+3]=ea(255*d.a)}return new li({width:256,height:1},e)}function hi(d,t,e){e=e||2;var g=t&&t.length,p=g?t[0]*e:d.length,c=xi(d,0,p,e,!0),m=[],f,x,b,_,v,w,k;if(!c)return m;if(g&&(c=function(d,t,e,c){var n=[],l,p,g,h,m;for(l=0,p=t.length;l<p;l++)g=t[l]*c,h=l<p-1?t[l+1]*c:d.length,(m=xi(d,g,h,c,!1))===m.next&&(m.steiner=!0),n.push(Bi(m));for(n.sort(Si),l=0;l<n.length;l++)Mi(n[l],e),e=bi(e,e.next);return e}(d,t,c,e)),d.length>80*e){f=b=d[0],x=_=d[1];for(var T=e;T<p;T+=e)(v=d[T])<f&&(f=v),(w=d[T+1])<x&&(x=w),v>b&&(b=v),w>_&&(_=w);k=0===(k=va(b-f,_-x))?0:1/k}return wi(c,m,e,f,x,k),m}function xi(l,t,e,r,n){var i,s;if(n===0<Ri(l,t,e,r))for(i=t;i<e;i+=r)s=Li(i,l[i],l[i+1],s);else for(i=e-r;i>=t;i-=r)s=Li(i,l[i],l[i+1],s);return s&&Fi(s,s.next)&&(ji(s),s=s.next),s}function bi(a,t){if(!a)return a;t||(t=a);var o=a,i;do if(i=!1,o.steiner||!Fi(o,o.next)&&0!==Ei(o.prev,o,o.next))o=o.next;else{if(ji(o),(o=t=o.prev)===o.next)break;i=!0}while(i||o!==t);return t}function wi(d,c,e,r,n,i,o){if(d){!o&&i&&function(a,t,e,o){var r=a;do null===r.z&&(r.z=Vi(r.x,r.y,t,e,o)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==a);r.prevZ.nextZ=null,r.prevZ=null,function(d){var c=1,p,g,h,m,y,f,x,b;do{for(g=d,d=null,y=null,f=0;g;){for(f++,h=g,x=0,p=0;p<c&&(x++,h=h.nextZ);p++);for(b=c;0<x||0<b&&h;)0!==x&&(0===b||!h||g.z<=h.z)?(m=g,g=g.nextZ,x--):(m=h,h=h.nextZ,b--),y?y.nextZ=m:d=m,m.prevZ=y,y=m;g=h}y.nextZ=null,c*=2}while(1<f)}(r)}(d,r,n,i);for(var a=d,p,g;d.prev!==d.next;)if(p=d.prev,g=d.next,i?Ai(d,r,n,i):_i(d))c.push(p.i/e),c.push(d.i/e),c.push(g.i/e),ji(d),d=g.next,a=g.next;else if((d=g)===a){o?1===o?wi(d=ki(d,c,e),c,e,r,n,i,2):2==o&&zi(d,c,e,r,n,i):wi(bi(d),c,e,r,n,i,1);break}}}function _i(a){var t=a.prev,e=a,o=a.next;if(0<=Ei(t,e,o))return!1;for(var r=a.next.next;r!==a.prev;){if(Ci(t.x,t.y,e.x,e.y,o.x,o.y,r.x,r.y)&&0<=Ei(r.prev,r,r.next))return!1;r=r.next}return!0}function Ai(d,t,e,r){var n=d.prev,i=d,o=d.next;if(0<=Ei(n,i,o))return!1;for(var a=n.x<i.x?n.x<o.x?n.x:o.x:i.x<o.x?i.x:o.x,s=n.y<i.y?n.y<o.y?n.y:o.y:i.y<o.y?i.y:o.y,u=n.x>i.x?n.x>o.x?n.x:o.x:i.x>o.x?i.x:o.x,l=n.y>i.y?n.y>o.y?n.y:o.y:i.y>o.y?i.y:o.y,p=Vi(a,s,t,e,r),c=Vi(u,l,t,e,r),g=d.prevZ,h=d.nextZ;g&&g.z>=p&&h&&h.z<=c;){if(g!==d.prev&&g!==d.next&&Ci(n.x,n.y,i.x,i.y,o.x,o.y,g.x,g.y)&&0<=Ei(g.prev,g,g.next))return!1;if(g=g.prevZ,h!==d.prev&&h!==d.next&&Ci(n.x,n.y,i.x,i.y,o.x,o.y,h.x,h.y)&&0<=Ei(h.prev,h,h.next))return!1;h=h.nextZ}for(;g&&g.z>=p;){if(g!==d.prev&&g!==d.next&&Ci(n.x,n.y,i.x,i.y,o.x,o.y,g.x,g.y)&&0<=Ei(g.prev,g,g.next))return!1;g=g.prevZ}for(;h&&h.z<=c;){if(h!==d.prev&&h!==d.next&&Ci(n.x,n.y,i.x,i.y,o.x,o.y,h.x,h.y)&&0<=Ei(h.prev,h,h.next))return!1;h=h.nextZ}return!0}function ki(a,l,e){var r=a;do{var s=r.prev,i=r.next.next;!Fi(s,i)&&Pi(s,r,r.next,i)&&Ti(s,i)&&Ti(i,s)&&(l.push(s.i/e),l.push(r.i/e),l.push(i.i/e),ji(r),ji(r.next),r=a=i),r=r.next}while(r!==a);return r}function zi(l,t,e,r,n,i){var o=l;do{for(var d=o.next.next;d!==o.prev;){if(o.i!==d.i&&Ii(o,d)){var c=Oi(o,d);return o=bi(o,o.next),c=bi(c,c.next),wi(o,t,e,r,n,i),void wi(c,t,e,r,n,i)}d=d.next}o=o.next}while(o!==l)}function Si(a,t){return a.x-t.x}function Mi(a,t){if(t=function(d,t){var e=t,g=d.x,i=d.y,o=-1/0,m;do{if(i<=e.y&&i>=e.next.y&&e.next.y!==e.y){var y=e.x+(i-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(y<=g&&y>o){if(o=y,y===g){if(i===e.y)return e;if(i===e.next.y)return e.next}m=e.x<e.next.x?e:e.next}}e=e.next}while(e!==t);if(!m)return null;if(g===o)return m.prev;var s=m,l=m.x,p=m.y,c=1/0,f;for(e=m.next;e!==s;)g>=e.x&&e.x>=l&&g!==e.x&&Ci(i<p?g:o,i,l,p,i<p?o:g,i,e.x,e.y)&&((f=wa(i-e.y)/(g-e.x))<c||f===c&&e.x>m.x)&&Ti(e,d)&&(m=e,c=f),e=e.next;return m}(a,t)){var o=Oi(t,a);bi(o,o.next)}}function Vi(a,o,l,r,n){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-l)*n)|a<<8))|a<<4))|a<<2))|a<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=32767*(o-r)*n)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function Bi(a){var t=a,o=a;do t.x<o.x&&(o=t),t=t.next;while(t!==a);return o}function Ci(l,t,e,r,n,i,o,a){return 0<=(n-o)*(t-a)-(l-o)*(i-a)&&0<=(l-o)*(r-a)-(e-o)*(t-a)&&0<=(e-o)*(i-a)-(n-o)*(r-a)}function Ii(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!function(a,t){var e=a;do{if(e.i!==a.i&&e.next.i!==a.i&&e.i!==t.i&&e.next.i!==t.i&&Pi(e,e.next,a,t))return!0;e=e.next}while(e!==a);return!1}(a,t)&&Ti(a,t)&&Ti(t,a)&&function(a,t){var e=a,l=!1,s=(a.x+t.x)/2,i=(a.y+t.y)/2;do e.y>i!=e.next.y>i&&e.next.y!==e.y&&s<(e.next.x-e.x)*(i-e.y)/(e.next.y-e.y)+e.x&&(l=!l),e=e.next;while(e!==a);return l}(a,t)}function Ei(a,t,e){return(t.y-a.y)*(e.x-t.x)-(t.x-a.x)*(e.y-t.y)}function Fi(a,t){return a.x===t.x&&a.y===t.y}function Pi(a,t,e,o){return!!(Fi(a,t)&&Fi(e,o)||Fi(a,o)&&Fi(e,t))||0<Ei(a,t,e)!=0<Ei(a,t,o)&&0<Ei(e,o,a)!=0<Ei(e,o,t)}function Ti(a,t){return 0>Ei(a.prev,a,a.next)?0<=Ei(a,t,a.next)&&0<=Ei(a,a.prev,t):0>Ei(a,t,a.prev)||0>Ei(a,a.next,t)}function Oi(a,t){var e=new qi(a.i,a.x,a.y),r=new qi(t.i,t.x,t.y),n=a.next,i=t.prev;return a.next=t,t.prev=a,e.next=n,n.prev=e,r.next=e,e.prev=r,i.next=r,r.prev=i,r}function Li(a,t,e,o){var r=new qi(a,t,e);return o?(r.next=o.next,r.prev=o,o.next.prev=r,o.next=r):(r.prev=r,r.next=r),r}function ji(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function qi(a,t,e){this.i=a,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ri(l,t,e,r){for(var n=0,s=t,d=e-r;s<e;s+=r)n+=(l[d]-l[s])*(l[s+1]+l[d+1]),d=s;return n}function Ui(a,t,e,o,r){!function g(t,e,r,m,x){for(;m>r;){if(600<m-r){var o=m-r+1,a=e-r+1,s=P(o),u=.5*ka(2*s/3),l=.5*re(s*u*(o-u)/o)*(0>a-o/2?-1:1),p=va(r,ea(e-a*u/o+l)),c=ie(m,ea(e+(o-a)*u/o+l));g(t,e,p,c,x)}var h=t[e],f=r,b=m;for(Zi(t,r,e),0<x(t[m],h)&&Zi(t,r,m);f<b;){for(Zi(t,f,b),f++,b--;0>x(t[f],h);)f++;for(;0<x(t[b],h);)b--}0===x(t[r],h)?Zi(t,r,b):Zi(t,++b,m),b<=e&&(r=b+1),e<=b&&(m=b-1)}}(a,t,e||0,o||a.length-1,r||Ki)}function Zi(a,t,e){var o=a[t];a[t]=a[e],a[e]=o}function Ki(a,t){return a<t?-1:a>t?1:0}function Ji(l,t){var e=l.length;if(1>=e)return[l];for(var r=[],o=0,d,c,p;o<e;o++)p=w(l[o]),0!==p&&(l[o].area=wa(p),null==c&&(c=0>p),c===0>p?(d&&r.push(d),d=[l[o]]):d.push(l[o]));if(d&&r.push(d),1<t)for(var g=0;g<r.length;g++)r[g].length<=t||(mi(r[g],t,1,r[g].length-1,$i),r[g]=r[g].slice(0,t));return r}function $i(a,t){return t.area-a.area}function Hi(l,t,e,r,n,i,o,a){l.emplaceBack(t,e,2*ea(8192*r)+o,2*(8192*n),2*(8192*i),R(a))}function to(a,t){return a.x===t.x&&(0>a.x||8192<a.x)||a.y===t.y&&(0>a.y||8192<a.y)}function ro(e){return e.every(function(e){return 0>e.x})||e.every(function(e){return 8192<e.x})||e.every(function(e){return 0>e.y})||e.every(function(e){return 8192<e.y})}function no(a,t,e,o,r){this.properties={},this.extent=e,this.type=0,this._pbf=a,this._geometry=-1,this._keys=o,this._values=r,a.readFields(uo,this,t)}function uo(a,t,e){1==a?t.id=e.readVarint():2==a?function(a,t){for(var e=a.readVarint()+a.pos;a.pos<e;){var o=t._keys[a.readVarint()],r=t._values[a.readVarint()];t.properties[o]=r}}(e,t):3==a?t.type=e.readVarint():4==a&&(t._geometry=e.pos)}function lo(l){for(var t=0,s=0,d=l.length,o=d-1,c,p;s<d;o=s++)c=l[s],t+=((p=l[o]).x-c.x)*(c.y+p.y);return t}function po(a,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(ho,this,t),this.length=this._features.length}function ho(a,t,e){15===a?t.version=e.readVarint():1===a?t.name=e.readString():5===a?t.extent=e.readVarint():2===a?t._features.push(e.pos):3===a?t._keys.push(e.readString()):4==a&&t._values.push(function(a){for(var t=null,o=a.readVarint()+a.pos,r;a.pos<o;)r=a.readVarint()>>3,t=1==r?a.readString():2==r?a.readFloat():3==r?a.readDouble():4==r?a.readVarint64():5==r?a.readVarint():6==r?a.readSVarint():7==r?a.readBoolean():null;return t}(e))}function fo(a,t,e){if(3===a){var o=new so(e,e.readVarint()+e.pos);o.length&&(t[o.name]=o)}}function yo(l,t,e,r,n,i,o){l.emplaceBack(t.x,t.y,r?1:0,n?1:-1,R(63*e.x)+128,R(63*e.y)+128,1+(0===i?0:0>i?-1:1)|(63&o*xo)<<2,o*xo>>6)}function _o(a,t){return 32767*(a/t.tileTotal*(t.end-t.start)+t.start)}function ko(a,t){return 0<t?t+2*a:a}function Bo(a,o,e){var r=o.layout.get("text-transform").evaluate(e);return"uppercase"===r?a=a.toLocaleUpperCase():"lowercase"===r&&(a=a.toLocaleLowerCase()),Mr.applyArabicShaping&&(a=Mr.applyArabicShaping(a)),a}function To(l,t){var e=t.expression;if("constant"===e.kind)return{functionType:"constant",layoutSize:e.evaluate(new Vr(l+1))};if("source"===e.kind)return{functionType:"source"};for(var r=e.zoomStops,n=0;n<r.length&&r[n]<=l;)n++;for(var s=n=va(0,n-1);s<r.length&&r[s]<l+1;)s++;s=ie(r.length-1,s);var d={min:r[n],max:r[s]};return"composite"===e.kind?{functionType:"composite",zoomRange:d,propertyValue:t.value}:{functionType:"camera",layoutSize:e.evaluate(new Vr(l+1)),zoomRange:d,sizeRange:{min:e.evaluate(new Vr(d.min)),max:e.evaluate(new Vr(d.max))},propertyValue:t.value}}function jo(l,t,e,r,n,i,o,a){l.emplaceBack(t,e,R(32*r),R(32*n),i,o,a?a[0]:0,a?a[1]:0)}function Uo(a,t,e){a.emplaceBack(t.x,t.y,e),a.emplaceBack(t.x,t.y,e),a.emplaceBack(t.x,t.y,e),a.emplaceBack(t.x,t.y,e)}function Do(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}function aa(e){return e.type===Do.Bytes?e.readVarint()+e.pos:e.pos+1}function sa(a,t,e){return e?4294967296*t+(a>>>0):4294967296*(t>>>0)+(a>>>0)}function ua(a,t,e){var o=16383>=t?1:2097151>=t?2:268435455>=t?3:ae(P(t)/(7*E));e.realloc(o);for(var r=e.pos-1;r>=a;r--)e.buf[r+o]=e.buf[r]}function la(a,t){for(var e=0;e<a.length;e++)t.writeVarint(a[e])}function pa(a,t){for(var e=0;e<a.length;e++)t.writeSVarint(a[e])}function ca(a,t){for(var e=0;e<a.length;e++)t.writeFloat(a[e])}function ha(a,t){for(var e=0;e<a.length;e++)t.writeDouble(a[e])}function fa(a,t){for(var e=0;e<a.length;e++)t.writeBoolean(a[e])}function ya(a,t){for(var e=0;e<a.length;e++)t.writeFixed32(a[e])}function da(a,t){for(var e=0;e<a.length;e++)t.writeSFixed32(a[e])}function Kn(a,t){for(var e=0;e<a.length;e++)t.writeFixed64(a[e])}function ma(a,t){for(var e=0;e<a.length;e++)t.writeSFixed64(a[e])}function ga(a,t){return(a[t]|a[t+1]<<8|a[t+2]<<16)+16777216*a[t+3]}function xa(a,t,e){a[e]=t,a[e+1]=t>>>8,a[e+2]=t>>>16,a[e+3]=t>>>24}function ba(a,t){return(a[t]|a[t+1]<<8|a[t+2]<<16)+(a[t+3]<<24)}function el(a,t,e){1===a&&e.readMessage(Aa,t)}function Aa(d,t,e){if(3===d){var r=e.readMessage(tl,{}),n=r.id,i=r.bitmap,o=r.width,a=r.height,s=r.left,c=r.top,l=r.advance;t.push({id:n,bitmap:new oi({width:o+6,height:a+6},i),metrics:{width:o,height:a,left:s,top:c,advance:l}})}}function tl(a,t,e){1===a?t.id=e.readVarint():2===a?t.bitmap=e.readBytes():3===a?t.width=e.readVarint():4===a?t.height=e.readVarint():5===a?t.left=e.readSVarint():6===a?t.top=e.readSVarint():7==a&&(t.advance=e.readVarint())}function za(a,o,e,r){0>(a*=2)&&(a=-1*a-1);var n=1<<o;return 32*(n*n*a+n*r+e)+o}function Ea(a,t){return t-a}function qa(a,t,e,o){var r=_a(a-t,2);return o?a<t?r/2:2*r:r+wa(e)*e}function Na(a,t){var e=0;return 10===a&&(e-=1e4),40!==a&&65288!==a||(e+=50),41!==t&&65289!==t||(e+=50),e}function Za(d,t,e,r,n,i){for(var o=null,g=qa(t,e,n,i),h=0,m=r;h<m.length;h+=1){var l=m[h],p=qa(t-l.x,e,n,i)+l.badness;p<=g&&(o=l,g=p)}return{index:d,x:t,priorBreak:o,badness:g}}function Ka(d,t,e,r){if(!e)return[];if(!d)return[];for(var n=[],o=function(l,t,e,r){for(var n=0,s=0,d;s<l.length;s++)d=r[l.charCodeAt(s)],d&&(n+=d.metrics.advance+t);return n/va(1,ae(n/e))}(d,t,e,r),a=0,c=0,g;c<d.length;c++){var h=d.charCodeAt(c),l=r[h];l&&!Ra[h]&&(a+=l.metrics.advance+t),c<d.length-1&&(Ua[h]||!(11904>(g=h))&&(vr["Bopomofo Extended"](g)||vr.Bopomofo(g)||vr["CJK Compatibility Forms"](g)||vr["CJK Compatibility Ideographs"](g)||vr["CJK Compatibility"](g)||vr["CJK Radicals Supplement"](g)||vr["CJK Strokes"](g)||vr["CJK Symbols and Punctuation"](g)||vr["CJK Unified Ideographs Extension A"](g)||vr["CJK Unified Ideographs"](g)||vr["Enclosed CJK Letters and Months"](g)||vr["Halfwidth and Fullwidth Forms"](g)||vr.Hiragana(g)||vr["Ideographic Description Characters"](g)||vr["Kangxi Radicals"](g)||vr["Katakana Phonetic Extensions"](g)||vr.Katakana(g)||vr["Vertical Forms"](g)||vr["Yi Radicals"](g)||vr["Yi Syllables"](g)))&&n.push(Za(c+1,a,o,n,Na(h,d.charCodeAt(c+1)),!1))}return function a(t){return t?a(t.priorBreak).concat(t.index):[]}(Za(d.length,a,o,n,0,!0))}function Ja(a){var t=.5,o=.5;return"right"===a||"top-right"===a||"bottom-right"===a?t=1:"left"===a||"top-left"===a||"bottom-left"===a?t=0:void 0,"bottom"===a||"bottom-right"===a||"bottom-left"===a?o=1:"top"===a||"top-right"===a||"top-left"===a?o=0:void 0,{horizontalAlign:t,verticalAlign:o}}function $a(l,t,e,r,n){if(n){var i=t[l[r].glyph];if(i)for(var o=i.metrics.advance,a=(l[r].x+o)*n,s=e;s<=r;s++)l[s].x-=a}}var Ha="undefined"==typeof window?"undefined"==typeof se?"undefined"==typeof self?{}:self:se:window,al=n;n.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},n.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},n.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},n.prototype.solveCurveX=function(l,t){var d,c,p,u,g;for(void 0===t&&(t=1e-6),p=l,g=0;8>g;g++){if(u=this.sampleCurveX(p)-l,wa(u)<t)return p;var h=this.sampleCurveDerivativeX(p);if(1e-6>wa(h))break;p-=u/h}if((p=l)<(d=0))return d;if(p>(c=1))return c;for(;d<c;){if(u=this.sampleCurveX(p),wa(u-l)<t)return p;l>u?d=p:c=p,p=.5*(c-d)+d}return p},n.prototype.solve=function(a,t){return this.sampleCurveY(this.solveCurveX(a,t))};var ol=function(a,t,e){this.column=a,this.row=t,this.zoom=e};ol.prototype.clone=function(){return new ol(this.column,this.row,this.zoom)},ol.prototype.zoomTo=function(e){return this.clone()._zoomTo(e)},ol.prototype.sub=function(e){return this.clone()._sub(e)},ol.prototype._zoomTo=function(a){var t=_a(2,a-this.zoom);return this.column*=t,this.row*=t,this.zoom=a,this},ol.prototype._sub=function(e){return e=e.zoomTo(this.zoom),this.column-=e.column,this.row-=e.row,this};var rl=o;o.prototype={clone:function(){return new o(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(a,t){return this.clone()._rotateAround(a,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return re(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return re(this.distSqr(e))},distSqr:function(a){var t=a.x-this.x,e=a.y-this.y;return t*t+e*e},angle:function(){return L(this.y,this.x)},angleTo:function(e){return L(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(a,t){return L(this.x*t-this.y*a,this.x*a+this.y*t)},_matMult:function(a){var t=a[0]*this.x+a[1]*this.y,e=a[2]*this.x+a[3]*this.y;return this.x=t,this.y=e,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(a){var t=te(a),e=M(a),o=t*this.x-e*this.y,r=e*this.x+t*this.y;return this.x=o,this.y=r,this},_rotateAround:function(a,t){var e=te(a),r=M(a),n=t.x+e*(this.x-t.x)-r*(this.y-t.y),i=t.y+r*(this.x-t.x)+e*(this.y-t.y);return this.x=n,this.y=i,this},_round:function(){return this.x=R(this.x),this.y=R(this.y),this}},o.convert=function(e){return e instanceof o?e:Array.isArray(e)?new o(e[0],e[1]):e};var e=u(.25,.1,.25,1),i=1,s={},p={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(p);var x=function(a){function t(t,e,o){a.call(this,t),this.status=e,this.url=o,this.name=this.constructor.name,this.message=t}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),A=function(a,t){var e=Ga(a);return e.responseType="arraybuffer",e.onerror=function(){t(new Error(e.statusText))},e.onload=function(){var o=e.response;return 0===o.byteLength&&200===e.status?t(new Error("http status 200 returned without content.")):void(200<=e.status&&300>e.status&&e.response?t(null,{data:o,cacheControl:e.getResponseHeader("Cache-Control"),expires:e.getResponseHeader("Expires")}):t(new x(e.statusText,e.status,a.url)))},e.send(),e},S=function(a,t){void 0===t&&(t={}),l(this,t),this.type=a},B=function(a){function t(t,e){void 0===e&&(e={}),a.call(this,"error",l({error:t},e))}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t}(S),C=function(){};C.prototype.on=function(a,t){return this._listeners=this._listeners||{},z(a,t,this._listeners),this},C.prototype.off=function(a,t){return Ya(a,t,this._listeners),Ya(a,t,this._oneTimeListeners),this},C.prototype.once=function(a,t){return this._oneTimeListeners=this._oneTimeListeners||{},z(a,t,this._oneTimeListeners),this},C.prototype.fire=function(d){"string"==typeof d&&(d=new S(d,arguments[1]||{}));var c=d.type;if(this.listens(c)){d.target=this;for(var e=0,p=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];e<p.length;e+=1)p[e].call(this,d);for(var n=0,u=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[],o;n<u.length;n+=1)o=u[n],Ya(c,o,this._oneTimeListeners),o.call(this,d);var g=this._eventedParent;g&&(l(d,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),g.fire(d))}else h(c,"error")?console.error(d&&d.error||d||"Empty error event"):h(c,"warning")&&console.warn(d&&d.warning||d||"Empty warning event");return this},C.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&0<this._listeners[e].length||this._oneTimeListeners&&this._oneTimeListeners[e]&&0<this._oneTimeListeners[e].length||this._eventedParent&&this._eventedParent.listens(e)},C.prototype.setEventedParent=function(a,t){return this._eventedParent=a,this._eventedParentData=t,this};var I={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},lineMetrics:{type:"boolean",default:!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_line:{"line-cap":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{butt:{},round:{},square:{}},default:"butt"},"line-join":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{bevel:{},round:{},miter:{}},default:"miter"},"line-miter-limit":{type:"number",default:2,function:"interpolated","zoom-function":!0,requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number",default:1.05,function:"interpolated","zoom-function":!0,requires:[{"line-join":"round"}]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_symbol:{"symbol-placement":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{point:{},line:{}},default:"point"},"symbol-spacing":{type:"number",default:250,minimum:1,function:"interpolated","zoom-function":!0,units:"pixels",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1},"icon-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"icon-size":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,units:"factor of the original icon size",requires:["icon-image"]},"icon-text-fit":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"]},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",function:"interpolated","zoom-function":!0,requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}]},"icon-image":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,tokens:!0},"icon-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,"property-function":!0,units:"degrees",requires:["icon-image"]},"icon-padding":{type:"number",default:2,minimum:0,function:"interpolated","zoom-function":!0,units:"pixels",requires:["icon-image"]},"icon-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,"property-function":!0,requires:["icon-image"]},"icon-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"]},"icon-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"text-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-field":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,default:"",tokens:!0},"text-font":{type:"array",value:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"]},"text-size":{type:"number",default:16,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-line-height":{type:"number",default:1.2,units:"ems",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-letter-spacing":{type:"number",default:0,units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-justify":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{left:{},center:{},right:{}},default:"center",requires:["text-field"]},"text-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field"]},"text-max-angle":{type:"number",default:45,units:"degrees",function:"interpolated","zoom-function":!0,requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number",default:0,period:360,units:"degrees",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"]},"text-offset":{type:"array",value:"number",units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,length:2,default:[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field","icon-image"]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Heatmap"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},transition:!1,"zoom-function":!0,"property-function":!1,function:"piecewise-constant"},position:{type:"array",default:[1.15,210,30],length:3,value:"number",transition:!0,function:"interpolated","zoom-function":!0,"property-function":!1},color:{type:"color",default:"#ffffff",function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0},intensity:{type:"number",default:.5,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0},"fill-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"fill-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-translate"]},"fill-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0}},paint_line:{"line-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"line-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["line-translate"]},"line-width":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-gap-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-offset":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-dasharray":{type:"array",value:"number",function:"piecewise-constant","zoom-function":!0,minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"line-gradient":{type:"color",function:"interpolated","zoom-function":!1,"property-function":!1,transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}]}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-blur":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"circle-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["circle-translate"]},"circle-pitch-scale":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map"},"circle-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"viewport"},"circle-stroke-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-stroke-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"heatmap-weight":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!1},"heatmap-intensity":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],function:"interpolated","zoom-function":!1,"property-function":!1,transition:!1},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-hue-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,transition:!0,units:"degrees"},"raster-brightness-min":{type:"number",function:"interpolated","zoom-function":!0,default:0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number",function:"interpolated","zoom-function":!0,default:1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-fade-duration":{type:"number",default:300,minimum:0,function:"interpolated","zoom-function":!0,transition:!1,units:"milliseconds"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,function:"interpolated","zoom-function":!0,transition:!1},"hillshade-illumination-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"viewport"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"hillshade-shadow-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",function:"interpolated","zoom-function":!0,transition:!0},"hillshade-accent-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0}},paint_background:{"background-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!1,default:1,minimum:0,maximum:1,transition:!0},"fill-extrusion-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-extrusion-pattern"}]},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-extrusion-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"]},"fill-extrusion-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"fill-extrusion-height":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,units:"meters",transition:!0},"fill-extrusion-base":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"]}}},il=function(a,t,e,o){this.message=(a?a+": ":"")+e,o&&(this.identifier=o),null!=t&&t.__line__&&(this.line=t.__line__)},F=function(a){function t(t,e){a.call(this,e),this.message=e,this.key=t}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t}(Error),j=function(l,t){void 0===t&&(t=[]),this.parent=l,this.bindings={};for(var s=0,d=t;s<d.length;s+=1){var n=d[s],i=n[0],o=n[1];this.bindings[i]=o}};j.prototype.concat=function(e){return new j(this,e)},j.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},j.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var q={kind:"null"},nl={kind:"number"},U={kind:"string"},D={kind:"boolean"},N={kind:"color"},Z={kind:"object"},K={kind:"value"},J={kind:"collator"},$=[q,nl,U,D,N,Z,Qa(K)],G=r(function(l,t){function e(e){return 0>(e=R(e))?0:255<e?255:e}function n(e){return 0>e?0:1<e?1:e}function i(a){return"%"===a[a.length-1]?e(255*(parseFloat(a)/100)):e(parseInt(a))}function o(e){return"%"===e[e.length-1]?n(parseFloat(e)/100):n(parseFloat(e))}function a(a,t,e){return 0>e?e+=1:1<e&&(e-=1),1>6*e?a+6*((t-a)*e):1>2*e?t:2>3*e?a+6*((t-a)*(2/3-e)):a}var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{t.parseCSSColor=function(r){var t=r.replace(/ /g,"").toLowerCase(),n;if(t in s)return s[t].slice();if("#"===t[0])return 4===t.length?0<=(n=parseInt(t.substr(1),16))&&4095>=n?[(3840&n)>>4|(3840&n)>>8,240&n|(240&n)>>4,15&n|(15&n)<<4,1]:null:7===t.length&&0<=(n=parseInt(t.substr(1),16))&&16777215>=n?[(16711680&n)>>16,(65280&n)>>8,255&n,1]:null;var g=t.indexOf("("),u=t.indexOf(")");if(-1!==g&&u+1===t.length){var l=t.substr(0,g),p=t.substr(g+1,u-(g+1)).split(","),c=1;switch(l){case"rgba":if(4!==p.length)return null;c=o(p.pop());case"rgb":return 3===p.length?[i(p[0]),i(p[1]),i(p[2]),c]:null;case"hsla":if(4!==p.length)return null;c=o(p.pop());case"hsl":if(3!==p.length)return null;var x=(parseFloat(p[0])%360+360)%360/360,f=o(p[1]),y=o(p[2]),d=.5>=y?y*(f+1):y+f-y*f,b=2*y-d;return[e(255*a(b,d,x+1/3)),e(255*a(b,d,x)),e(255*a(b,d,x-1/3)),c];default:return null;}}return null}}catch(e){}}).parseCSSColor,W=function(a,t,e,o){void 0===o&&(o=1),this.r=a,this.g=t,this.b=e,this.a=o};W.parse=function(a){if(a){if(a instanceof W)return a;if("string"==typeof a){var t=G(a);if(t)return new W(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},W.prototype.toString=function(){var a=this.toArray(),t=a[0],e=a[1],o=a[2],r=a[3];return"rgba("+R(t)+","+R(e)+","+R(o)+","+r+")"},W.prototype.toArray=function(){var a=this.r,t=this.g,e=this.b,o=this.a;return 0===o?[0,0,0,0]:[255*a/o,255*t/o,255*e/o,o]},W.black=new W(0,0,0,1),W.white=new W(1,1,1,1),W.transparent=new W(0,0,0,0);var Q=function(a,t,e){this.sensitivity=a?t?"variant":"case":t?"accent":"base",this.locale=e,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Q.prototype.compare=function(a,t){return this.collator.compare(a,t)},Q.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var tt=function(a,t,e){this.type=J,this.locale=e,this.caseSensitive=a,this.diacriticSensitive=t};tt.parse=function(a,t){if(2!==a.length)return t.error("Expected one argument.");var e=a[1];if("object"!=typeof e||Array.isArray(e))return t.error("Collator options argument must be an object.");var r=t.parse(void 0!==e["case-sensitive"]&&e["case-sensitive"],1,D);if(!r)return null;var n=t.parse(void 0!==e["diacritic-sensitive"]&&e["diacritic-sensitive"],1,D);if(!n)return null;var i=null;return e.locale&&!(i=t.parse(e.locale,1,U))?null:new tt(r,n,i)},tt.prototype.evaluate=function(e){return new Q(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},tt.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},tt.prototype.possibleOutputs=function(){return[void 0]},tt.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var et=function(a,t){this.type=a,this.value=t};et.parse=function(a,t){if(2!==a.length)return t.error("'literal' expression requires exactly one argument, but found "+(a.length-1)+" instead.");if(!function a(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof W)return!0;if(t instanceof Q)return!0;if(Array.isArray(t)){for(var e=0,o=t;e<o.length;e+=1)if(!a(o[e]))return!1;return!0}if("object"==typeof t){for(var n in t)if(!a(t[n]))return!1;return!0}return!1}(a[1]))return t.error("invalid value");var e=a[1],o=rt(e),r=t.expectedType;return"array"!==o.kind||0!==o.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(o=r),new et(o,e)},et.prototype.evaluate=function(){return this.value},et.prototype.eachChild=function(){},et.prototype.possibleOutputs=function(){return[this.value]},et.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof W?["rgba"].concat(this.value.toArray()):this.value};var it=function(e){this.name="ExpressionEvaluationError",this.message=e};it.prototype.toJSON=function(){return this.message};var ot={string:U,number:nl,boolean:D,object:Z},at=function(a,t){this.type=a,this.args=t};at.parse=function(l,t){if(2>l.length)return t.error("Expected at least one argument.");for(var e=l[0],r=ot[e],n=[],i=1,s;i<l.length;i++){if(s=t.parse(l[i],i,K),!s)return null;n.push(s)}return new at(r,n)},at.prototype.evaluate=function(a){for(var t=0,o;t<this.args.length;t++){if(o=this.args[t].evaluate(a),!X(this.type,rt(o)))return o;if(t==this.args.length-1)throw new it("Expected value to be of type "+H(this.type)+", but found "+H(rt(o))+" instead.")}return null},at.prototype.eachChild=function(e){this.args.forEach(e)},at.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.args.map(function(e){return e.possibleOutputs()}));var e},at.prototype.serialize=function(){return[this.type.kind].concat(this.args.map(function(e){return e.serialize()}))};var st={string:U,number:nl,boolean:D},ut=function(a,t){this.type=a,this.input=t};ut.parse=function(l,t){if(2>l.length||4<l.length)return t.error("Expected 1, 2, or 3 arguments, but found "+(l.length-1)+" instead.");var e,s;if(2<l.length){var d=l[1];if("string"!=typeof d||!(d in st))return t.error("The item type argument of \"array\" must be one of string, number, boolean",1);e=st[d]}else e=K;if(3<l.length){if("number"!=typeof l[2]||0>l[2]||l[2]!==ea(l[2]))return t.error("The length argument to \"array\" must be a positive integer literal",2);s=l[2]}var i=Qa(e,s),o=t.parse(l[l.length-1],l.length-1,K);return o?new ut(i,o):null},ut.prototype.evaluate=function(a){var t=this.input.evaluate(a);if(X(this.type,rt(t)))throw new it("Expected value to be of type "+H(this.type)+", but found "+H(rt(t))+" instead.");return t},ut.prototype.eachChild=function(e){e(this.input)},ut.prototype.possibleOutputs=function(){return this.input.possibleOutputs()},ut.prototype.serialize=function(){var a=["array"],t=this.type.itemType;if("string"===t.kind||"number"===t.kind||"boolean"===t.kind){a.push(t.kind);var e=this.type.N;"number"==typeof e&&a.push(e)}return a.push(this.input.serialize()),a};var lt={"to-number":nl,"to-color":N},pt=function(a,t){this.type=a,this.args=t};pt.parse=function(l,t){if(2>l.length)return t.error("Expected at least one argument.");for(var e=l[0],r=lt[e],n=[],i=1,s;i<l.length;i++){if(s=t.parse(l[i],i,K),!s)return null;n.push(s)}return new pt(r,n)},pt.prototype.evaluate=function(d){if("color"===this.type.kind){for(var t=0,c=this.args,i,p;t<c.length;t+=1)if(p=null,"string"==typeof(i=c[t].evaluate(d))){var g=d.parseColor(i);if(g)return g}else if(Array.isArray(i)&&!(p=3>i.length||4<i.length?"Invalid rbga value "+JSON.stringify(i)+": expected an array containing either three or four numeric values.":Y(i[0],i[1],i[2],i[3])))return new W(i[0]/255,i[1]/255,i[2]/255,i[3]);throw new it(p||"Could not parse color from value '"+("string"==typeof i?i:JSON.stringify(i))+"'")}for(var o=null,h=0,m=this.args;h<m.length;h+=1)if(null!==(o=m[h].evaluate(d))){var u=+o;if(!isNaN(u))return u}throw new it("Could not convert "+JSON.stringify(o)+" to number.")},pt.prototype.eachChild=function(e){this.args.forEach(e)},pt.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.args.map(function(e){return e.possibleOutputs()}));var e},pt.prototype.serialize=function(){var a=["to-"+this.type.kind];return this.eachChild(function(t){a.push(t.serialize())}),a};var ct=["Unknown","Point","LineString","Polygon"],ht=function(){this._parseColorCache={}};ht.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ht.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?ct[this.feature.type]:this.feature.type:null},ht.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ht.prototype.parseColor=function(a){var t=this._parseColorCache[a];return t||(t=this._parseColorCache[a]=W.parse(a)),t};var ft=function(a,t,e,o){this.name=a,this.type=t,this._evaluate=e,this.args=o};ft.prototype.evaluate=function(e){return this._evaluate(e,this.args)},ft.prototype.eachChild=function(e){this.args.forEach(e)},ft.prototype.possibleOutputs=function(){return[void 0]},ft.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},ft.parse=function(k,t){var e=k[0],r=ft.definitions[e];if(!r)return t.error("Unknown expression \""+e+"\". If you wanted a literal array, use [\"literal\", [...]].",0);for(var n=Array.isArray(r)?r[0]:r.type,i=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,o=i.filter(function(t){var e=t[0];return!Array.isArray(e)||e.length===k.length-1}),a=[],s=1;s<k.length;s++){var T=k[s],l=void 0;if(1===o.length){var S=o[0][0];l=Array.isArray(S)?S[s-1]:S.type}var c=t.parse(T,1+a.length,l);if(!c)return null;a.push(c)}for(var h=null,C=0,L=o;C<L.length;C+=1){var d=L[C],v=d[0],m=d[1];if(h=new mt(t.registry,t.path,null,t.scope),Array.isArray(v)&&v.length!==a.length)h.error("Expected "+v.length+" arguments, but found "+a.length+" instead.");else{for(var g=0;g<a.length;g++){var E=Array.isArray(v)?v[g]:v.type,b=a[g];h.concat(g+1).checkSubtype(E,b.type)}if(0===h.errors.length)return new ft(e,n,m,a)}}if(1===o.length)t.errors.push.apply(t.errors,h.errors);else{var w=(o.length?o:i).map(function(a){var t=a[0],o;return o=t,Array.isArray(o)?"("+o.map(H).join(", ")+")":"("+H(o.type)+"...)"}).join(" | "),_=a.map(function(e){return H(e.type)}).join(", ");t.error("Expected arguments of type "+w+", but found ("+_+") instead.")}return null},ft.register=function(a,t){for(var e in ft.definitions=t,t)a[e]=ft};var yt=function(a,t){this.type=t.type,this.name=a,this.boundExpression=t};yt.parse=function(a,t){if(2!==a.length||"string"!=typeof a[1])return t.error("'var' expression requires exactly one string literal argument.");var e=a[1];return t.scope.has(e)?new yt(e,t.scope.get(e)):t.error("Unknown variable \""+e+"\". Make sure \""+e+"\" has been bound in an enclosing \"let\" expression before using it.",1)},yt.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},yt.prototype.eachChild=function(){},yt.prototype.possibleOutputs=function(){return[void 0]},yt.prototype.serialize=function(){return["var",this.name]};var mt=function(a,t,o,r,l){void 0===t&&(t=[]),void 0===r&&(r=new j),void 0===l&&(l=[]),this.registry=a,this.path=t,this.key=t.map(function(e){return"["+e+"]"}).join(""),this.scope=r,this.errors=l,this.expectedType=o};mt.prototype.parse=function(a,t,e,o,r){return void 0===r&&(r={}),t?this.concat(t,e,o)._parse(a,r):this._parse(a,r)},mt.prototype._parse=function(l,d){if(null!==l&&"string"!=typeof l&&"boolean"!=typeof l&&"number"!=typeof l||(l=["literal",l]),Array.isArray(l)){if(0===l.length)return this.error("Expected an array with at least one element. If you wanted a literal array, use [\"literal\", []].");var e=l[0];if("string"!=typeof e)return this.error("Expression name must be a string, but found "+typeof e+" instead. If you wanted a literal array, use [\"literal\", [...]].",0),null;var r=this.registry[e];if(r){var n=r.parse(l,this);if(!n)return null;if(this.expectedType){var c=this.expectedType,o=n.type;if(("string"===c.kind||"number"===c.kind||"boolean"===c.kind||"object"===c.kind)&&"value"===o.kind)d.omitTypeAnnotations||(n=new at(c,[n]));else if("array"===c.kind&&"value"===o.kind)d.omitTypeAnnotations||(n=new ut(c,n));else if("color"===c.kind&&("value"===o.kind||"string"===o.kind))d.omitTypeAnnotations||(n=new pt(c,[n]));else if(this.checkSubtype(this.expectedType,n.type))return null}if(!(n instanceof et)&&function a(t){if(t instanceof yt)return a(t.boundExpression);if(t instanceof ft&&"error"===t.name)return!1;if(t instanceof tt)return!1;var o=!0;return t.eachChild(function(t){o=t instanceof pt||t instanceof at||t instanceof ut?o&&a(t):o&&t instanceof et}),!!o&&nt(t)&&dt(t,["zoom","heatmap-density","line-progress","is-supported-script"])}(n)){var a=new ht;try{n=new et(n.type,n.evaluate(a))}catch(e){return this.error(e.message),null}}return n}return this.error("Unknown expression \""+e+"\". If you wanted a literal array, use [\"literal\", [...]].",0)}return void 0===l?this.error("'undefined' value invalid. Use null instead."):"object"==typeof l?this.error("Bare objects invalid. Use [\"literal\", {...}] instead."):this.error("Expected an array, but found "+typeof l+" instead.")},mt.prototype.concat=function(a,t,e){var o="number"==typeof a?this.path.concat(a):this.path,r=e?this.scope.concat(e):this.scope;return new mt(this.registry,o,t||null,r,this.errors)},mt.prototype.error=function(a){for(var t=[],e=arguments.length-1;0<e--;)t[e]=arguments[e+1];var o=""+this.key+t.map(function(e){return"["+e+"]"}).join("");this.errors.push(new F(o,a))},mt.prototype.checkSubtype=function(a,t){var e=X(a,t);return e&&this.error(e),e};var gt=function(l,t,e){this.type=l,this.input=t,this.labels=[],this.outputs=[];for(var r=0,d=e;r<d.length;r+=1){var i=d[r],o=i[0],a=i[1];this.labels.push(o),this.outputs.push(a)}};gt.parse=function(d,t){var e=d[1],g=d.slice(2);if(4>d.length-1)return t.error("Expected at least 4 arguments, but found only "+(d.length-1)+".");if(0!=(d.length-1)%2)return t.error("Expected an even number of arguments.");if(!(e=t.parse(e,1,nl)))return null;var n=[],i=null;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType),g.unshift(-1/0);for(var h=0;h<g.length;h+=2){var m=g[h],s=g[h+1],u=h+1,l=h+2;if("number"!=typeof m)return t.error("Input/output pairs for \"step\" expressions must be defined using literal numeric values (not computed expressions) for the input values.",u);if(n.length&&n[n.length-1][0]>=m)return t.error("Input/output pairs for \"step\" expressions must be arranged with input values in strictly ascending order.",u);var p=t.parse(s,l,i);if(!p)return null;i=i||p.type,n.push([m,p])}return new gt(i,e,n)},gt.prototype.evaluate=function(a){var t=this.labels,e=this.outputs;if(1===t.length)return e[0].evaluate(a);var o=this.input.evaluate(a);if(o<=t[0])return e[0].evaluate(a);var r=t.length;return o>=t[r-1]?e[r-1].evaluate(a):e[vt(t,o)].evaluate(a)},gt.prototype.eachChild=function(a){a(this.input);for(var t=0,o=this.outputs;t<o.length;t+=1)a(o[t])},gt.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.outputs.map(function(e){return e.possibleOutputs()}));var e},gt.prototype.serialize=function(){for(var a=["step",this.input.serialize()],t=0;t<this.labels.length;t++)0<t&&a.push(this.labels[t]),a.push(this.outputs[t].serialize());return a};var bt=Object.freeze({number:xt,color:function(a,t,e){return new W(xt(a.r,t.r,e),xt(a.g,t.g,e),xt(a.b,t.b,e),xt(a.a,t.a,e))},array:function(a,o,e){return a.map(function(a,t){return xt(a,o[t],e)})}}),_t=function(l,t,e,r){this.type=l,this.interpolation=t,this.input=e,this.labels=[],this.outputs=[];for(var n=0,d=r;n<d.length;n+=1){var o=d[n],a=o[0],s=o[1];this.labels.push(a),this.outputs.push(s)}};_t.interpolationFactor=function(i,t,e,r){var n=0;if("exponential"===i.name)n=wt(t,i.base,e,r);else if("linear"===i.name)n=wt(t,1,e,r);else if("cubic-bezier"===i.name){var l=i.controlPoints;n=new al(l[0],l[1],l[2],l[3]).solve(wt(t,1,e,r))}return n},_t.parse=function(d,t){var e=d[1],g=d[2],m=d.slice(3);if(!Array.isArray(e)||0===e.length)return t.error("Expected an interpolation type expression.",1);if("linear"===e[0])e={name:"linear"};else if("exponential"===e[0]){var i=e[1];if("number"!=typeof i)return t.error("Exponential interpolation requires a numeric base.",1,1);e={name:"exponential",base:i}}else{if("cubic-bezier"!==e[0])return t.error("Unknown interpolation type "+(e[0]+""),1,0);var o=e.slice(1);if(4!==o.length||o.some(function(e){return"number"!=typeof e||0>e||1<e}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);e={name:"cubic-bezier",controlPoints:o}}if(4>d.length-1)return t.error("Expected at least 4 arguments, but found only "+(d.length-1)+".");if(0!=(d.length-1)%2)return t.error("Expected an even number of arguments.");if(!(g=t.parse(g,2,nl)))return null;var a=[],s=null;t.expectedType&&"value"!==t.expectedType.kind&&(s=t.expectedType);for(var x=0;x<m.length;x+=2){var b=m[x],p=m[x+1],c=x+3,h=x+4;if("number"!=typeof b)return t.error("Input/output pairs for \"interpolate\" expressions must be defined using literal numeric values (not computed expressions) for the input values.",c);if(a.length&&a[a.length-1][0]>=b)return t.error("Input/output pairs for \"interpolate\" expressions must be arranged with input values in strictly ascending order.",c);var f=t.parse(p,h,s);if(!f)return null;s=s||f.type,a.push([b,f])}return"number"===s.kind||"color"===s.kind||"array"===s.kind&&"number"===s.itemType.kind&&"number"==typeof s.N?new _t(s,e,g,a):t.error("Type "+H(s)+" is not interpolatable.")},_t.prototype.evaluate=function(d){var t=this.labels,e=this.outputs;if(1===t.length)return e[0].evaluate(d);var r=this.input.evaluate(d);if(r<=t[0])return e[0].evaluate(d);var n=t.length;if(r>=t[n-1])return e[n-1].evaluate(d);var i=vt(t,r),o=t[i],a=t[i+1],s=_t.interpolationFactor(this.interpolation,r,o,a),c=e[i].evaluate(d),l=e[i+1].evaluate(d);return bt[this.type.kind.toLowerCase()](c,l,s)},_t.prototype.eachChild=function(a){a(this.input);for(var t=0,o=this.outputs;t<o.length;t+=1)a(o[t])},_t.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.outputs.map(function(e){return e.possibleOutputs()}));var e},_t.prototype.serialize=function(){for(var a=["interpolate","linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints),this.input.serialize()],t=0;t<this.labels.length;t++)a.push(this.labels[t],this.outputs[t].serialize());return a};var At=function(a,t){this.type=a,this.args=t};At.parse=function(d,t){if(2>d.length)return t.error("Expectected at least one argument.");var e=null,c=t.expectedType;c&&"value"!==c.kind&&(e=c);for(var n=[],i=0,p=d.slice(1);i<p.length;i+=1){var a=p[i],s=t.parse(a,1+n.length,e,void 0,{omitTypeAnnotations:!0});if(!s)return null;e=e||s.type,n.push(s)}var u=c&&n.some(function(e){return X(c,e.type)});return new At(u?K:e,n)},At.prototype.evaluate=function(a){for(var t=null,o=0,i=this.args;o<i.length&&null===(t=i[o].evaluate(a));o+=1);return t},At.prototype.eachChild=function(e){this.args.forEach(e)},At.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.args.map(function(e){return e.possibleOutputs()}));var e},At.prototype.serialize=function(){var a=["coalesce"];return this.eachChild(function(t){a.push(t.serialize())}),a};var zt=function(a,t){this.type=t.type,this.bindings=[].concat(a),this.result=t};zt.prototype.evaluate=function(e){return this.result.evaluate(e)},zt.prototype.eachChild=function(a){for(var t=0,o=this.bindings;t<o.length;t+=1)a(o[t][1]);a(this.result)},zt.parse=function(l,t){if(4>l.length)return t.error("Expected at least 3 arguments, but found "+(l.length-1)+" instead.");for(var e=[],r=1,s;r<l.length-1;r+=2){if(s=l[r],"string"!=typeof s)return t.error("Expected string, but found "+typeof s+" instead.",r);if(/[^a-zA-Z0-9_]/.test(s))return t.error("Variable names must contain only alphanumeric characters or '_'.",r);var d=t.parse(l[r+1],r+1);if(!d)return null;e.push([s,d])}var o=t.parse(l[l.length-1],l.length-1,void 0,e);return o?new zt(e,o):null},zt.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},zt.prototype.serialize=function(){for(var a=["let"],t=0,l=this.bindings;t<l.length;t+=1){var r=l[t],n=r[0],i=r[1];a.push(n,i.serialize())}return a.push(this.result.serialize()),a};var St=function(a,t,e){this.type=a,this.index=t,this.input=e};St.parse=function(a,t){if(3!==a.length)return t.error("Expected 2 arguments, but found "+(a.length-1)+" instead.");var e=t.parse(a[1],1,nl),o=t.parse(a[2],2,Qa(t.expectedType||K));if(!e||!o)return null;var r=o.type;return new St(r.itemType,e,o)},St.prototype.evaluate=function(a){var t=this.index.evaluate(a),e=this.input.evaluate(a);if(0>t)throw new it("Array index out of bounds: "+t+" < 0.");if(t>=e.length)throw new it("Array index out of bounds: "+t+" > "+(e.length-1)+".");if(t!==ea(t))throw new it("Array index must be an integer, but found "+t+" instead.");return e[t]},St.prototype.eachChild=function(e){e(this.index),e(this.input)},St.prototype.possibleOutputs=function(){return[void 0]},St.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Mt=function(a,t,e,r,n,i){this.inputType=a,this.type=t,this.input=e,this.cases=r,this.outputs=n,this.otherwise=i};Mt.parse=function(g,t){var e=Number.MAX_SAFE_INTEGER;if(5>g.length)return t.error("Expected at least 4 arguments, but found only "+(g.length-1)+".");if(1!=g.length%2)return t.error("Expected an even number of arguments.");var m,x;t.expectedType&&"value"!==t.expectedType.kind&&(x=t.expectedType);for(var b={},i=[],o=2;o<g.length-1;o+=2){var _=g[o],v=g[o+1];Array.isArray(_)||(_=[_]);var u=t.concat(o);if(0===_.length)return u.error("Expected at least one branch label.");for(var l=0,w=_,c;l<w.length;l+=1){if(c=w[l],"number"!=typeof c&&"string"!=typeof c)return u.error("Branch labels must be numbers or strings.");if("number"==typeof c&&wa(c)>e)return u.error("Branch labels must be integers no larger than "+e+".");if("number"==typeof c&&ea(c)!==c)return u.error("Numeric branch labels must be integer values.");if(!m)m=rt(c);else if(u.checkSubtype(m,rt(c)))return null;if(void 0!==b[c+""])return u.error("Branch labels must be unique.");b[c+""]=i.length}var k=t.parse(v,o,x);if(!k)return null;x=x||k.type,i.push(k)}var f=t.parse(g[1],1,m);if(!f)return null;var y=t.parse(g[g.length-1],g.length-1,x);return y?new Mt(m,x,f,b,i,y):null},Mt.prototype.evaluate=function(a){var t=this.input.evaluate(a);return(this.outputs[this.cases[t]]||this.otherwise).evaluate(a)},Mt.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},Mt.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.outputs.map(function(e){return e.possibleOutputs()})).concat(this.otherwise.possibleOutputs());var e},Mt.prototype.serialize=function(){for(var d=this,t=["match",this.input.serialize()],e=[],r={},n=0,g=Object.keys(this.cases).sort();n<g.length;n+=1){var o=g[n],a=r[d.cases[o]];void 0===a?(r[d.cases[o]]=e.length,e.push([d.cases[o],[o]])):e[a][1].push(o)}for(var s=function(t){return"number"===d.input.type.kind?+t:t},u=0,m=e;u<m.length;u+=1){var p=m[u],c=p[0],h=p[1];1===h.length?t.push(s(h[0])):t.push(h.map(s)),t.push(d.outputs[c].serialize())}return t.push(this.otherwise.serialize()),t};var Vt=function(a,t,e){this.type=a,this.branches=t,this.otherwise=e};Vt.parse=function(l,t){if(4>l.length)return t.error("Expected at least 3 arguments, but found only "+(l.length-1)+".");if(0!=l.length%2)return t.error("Expected an odd number of arguments.");var e;t.expectedType&&"value"!==t.expectedType.kind&&(e=t.expectedType);for(var d=[],n=1,c;n<l.length-1;n+=2){if(c=t.parse(l[n],n,D),!c)return null;var p=t.parse(l[n+1],n+1,e);if(!p)return null;d.push([c,p]),e=e||p.type}var a=t.parse(l[l.length-1],l.length-1,e);return a?new Vt(e,d,a):null},Vt.prototype.evaluate=function(a){for(var t=0,l=this.branches;t<l.length;t+=1){var r=l[t],n=r[0],i=r[1];if(n.evaluate(a))return i.evaluate(a)}return this.otherwise.evaluate(a)},Vt.prototype.eachChild=function(a){for(var t=0,l=this.branches;t<l.length;t+=1){var r=l[t],n=r[0],i=r[1];a(n),a(i)}a(this.otherwise)},Vt.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.branches.map(function(e){return e[0],e[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs());var e},Vt.prototype.serialize=function(){var a=["case"];return this.eachChild(function(t){a.push(t.serialize())}),a};var Bt=Ct("==",!1),Et=Ct("!=",!0),Ft=function(e){this.type=nl,this.input=e};Ft.parse=function(a,t){if(2!==a.length)return t.error("Expected 1 argument, but found "+(a.length-1)+" instead.");var e=t.parse(a[1],1);return e?"array"!==e.type.kind&&"string"!==e.type.kind&&"value"!==e.type.kind?t.error("Expected argument of type string or array, but found "+H(e.type)+" instead."):new Ft(e):null},Ft.prototype.evaluate=function(a){var t=this.input.evaluate(a);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new it("Expected value to be of type string or array, but found "+H(rt(t))+" instead.")},Ft.prototype.eachChild=function(e){e(this.input)},Ft.prototype.possibleOutputs=function(){return[void 0]},Ft.prototype.serialize=function(){var a=["length"];return this.eachChild(function(t){a.push(t.serialize())}),a};var Pt={"==":Bt,"!=":Et,array:ut,at:St,boolean:at,case:Vt,coalesce:At,collator:tt,interpolate:_t,length:Ft,let:zt,literal:et,match:Mt,number:at,object:at,step:gt,string:at,"to-color":pt,"to-number":pt,var:yt};ft.register(Pt,{error:[{kind:"error"},[U],function(a,t){var e=t[0];throw new it(e.evaluate(a))}],typeof:[U,[K],function(a,t){return H(rt(t[0].evaluate(a)))}],"to-string":[U,[K],function(a,t){var e=t[0],o=typeof(e=e.evaluate(a));return null===e?"":"string"==o||"number"==o||"boolean"==o?e+"":e instanceof W?e.toString():JSON.stringify(e)}],"to-boolean":[D,[K],function(a,t){var e=t[0];return!!e.evaluate(a)}],"to-rgba":[Qa(nl,4),[N],function(a,t){return t[0].evaluate(a).toArray()}],rgb:[N,[nl,nl,nl],It],rgba:[N,[nl,nl,nl,nl],It],has:{type:D,overloads:[[[U],function(a,t){return Ot(t[0].evaluate(a),a.properties())}],[[U,Z],function(a,t){var e=t[0],o=t[1];return Ot(e.evaluate(a),o.evaluate(a))}]]},get:{type:K,overloads:[[[U],function(a,t){return Lt(t[0].evaluate(a),a.properties())}],[[U,Z],function(a,t){var e=t[0],o=t[1];return Lt(e.evaluate(a),o.evaluate(a))}]]},properties:[Z,[],function(e){return e.properties()}],"geometry-type":[U,[],function(e){return e.geometryType()}],id:[K,[],function(e){return e.id()}],zoom:[nl,[],function(e){return e.globals.zoom}],"heatmap-density":[nl,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[nl,[],function(e){return e.globals.lineProgress||0}],"+":[nl,Dt(nl),function(a,t){for(var e=0,o=0,l=t;o<l.length;o+=1)e+=l[o].evaluate(a);return e}],"*":[nl,Dt(nl),function(a,t){for(var e=1,o=0,l=t;o<l.length;o+=1)e*=l[o].evaluate(a);return e}],"-":{type:nl,overloads:[[[nl,nl],function(a,t){var e=t[0],o=t[1];return e.evaluate(a)-o.evaluate(a)}],[[nl],function(a,t){return-t[0].evaluate(a)}]]},"/":[nl,[nl,nl],function(a,t){var e=t[0],o=t[1];return e.evaluate(a)/o.evaluate(a)}],"%":[nl,[nl,nl],function(a,t){var e=t[0],o=t[1];return e.evaluate(a)%o.evaluate(a)}],ln2:[nl,[],function(){return E}],pi:[nl,[],function(){return Sa}],e:[nl,[],function(){var e=Math.E;return e}],"^":[nl,[nl,nl],function(a,t){var e=t[0],o=t[1];return _a(e.evaluate(a),o.evaluate(a))}],sqrt:[nl,[nl],function(a,t){var e=t[0];return re(e.evaluate(a))}],log10:[nl,[nl],function(a,t){var e=Math.log10,o=t[0];return e(o.evaluate(a))}],ln:[nl,[nl],function(a,t){var e=t[0];return P(e.evaluate(a))}],log2:[nl,[nl],function(o,t){var e=t[0];return a(e.evaluate(o))}],sin:[nl,[nl],function(a,t){var e=t[0];return M(e.evaluate(a))}],cos:[nl,[nl],function(a,t){var e=t[0];return te(e.evaluate(a))}],tan:[nl,[nl],function(a,t){var e=t[0];return g(e.evaluate(a))}],asin:[nl,[nl],function(a,t){var e=t[0];return _(e.evaluate(a))}],acos:[nl,[nl],function(a,t){var e=t[0];return v(e.evaluate(a))}],atan:[nl,[nl],function(a,t){var e=t[0];return k(e.evaluate(a))}],min:[nl,Dt(nl),function(a,t){return ie.apply(Math,t.map(function(t){return t.evaluate(a)}))}],max:[nl,Dt(nl),function(a,t){return va.apply(Math,t.map(function(t){return t.evaluate(a)}))}],abs:[nl,[nl],function(a,t){var e=t[0];return wa(e.evaluate(a))}],round:[nl,[nl],function(a,t){var e=t[0].evaluate(a);return 0>e?-R(-e):R(e)}],floor:[nl,[nl],function(a,t){var e=t[0];return ea(e.evaluate(a))}],ceil:[nl,[nl],function(a,t){var e=t[0];return ae(e.evaluate(a))}],"filter-==":[D,[U,K],function(a,t){var e=t[0],o=t[1];return a.properties()[e.value]===o.value}],"filter-id-==":[D,[K],function(a,t){var e=t[0];return a.id()===e.value}],"filter-type-==":[D,[U],function(a,t){var e=t[0];return a.geometryType()===e.value}],"filter-<":[D,[U,K],function(a,t){var e=t[0],r=t[1],n=a.properties()[e.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[D,[K],function(a,t){var e=t[0],o=a.id(),r=e.value;return typeof o==typeof r&&o<r}],"filter->":[D,[U,K],function(a,t){var e=t[0],r=t[1],n=a.properties()[e.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[D,[K],function(a,t){var e=t[0],o=a.id(),r=e.value;return typeof o==typeof r&&o>r}],"filter-<=":[D,[U,K],function(a,t){var e=t[0],r=t[1],n=a.properties()[e.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[D,[K],function(a,t){var e=t[0],o=a.id(),r=e.value;return typeof o==typeof r&&o<=r}],"filter->=":[D,[U,K],function(a,t){var e=t[0],r=t[1],n=a.properties()[e.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[D,[K],function(a,t){var e=t[0],o=a.id(),r=e.value;return typeof o==typeof r&&o>=r}],"filter-has":[D,[K],function(a,t){return t[0].value in a.properties()}],"filter-has-id":[D,[],function(e){return null!==e.id()}],"filter-type-in":[D,[Qa(U)],function(a,t){return 0<=t[0].value.indexOf(a.geometryType())}],"filter-id-in":[D,[Qa(K)],function(a,t){return 0<=t[0].value.indexOf(a.id())}],"filter-in-small":[D,[U,Qa(K)],function(a,t){var e=t[0];return 0<=t[1].value.indexOf(a.properties()[e.value])}],"filter-in-large":[D,[U,Qa(K)],function(a,t){var e=t[0],o=t[1];return function(a,t,e,o){for(;e<=o;){var l=e+o>>1;if(t[l]===a)return!0;t[l]>a?o=l-1:e=l+1}return!1}(a.properties()[e.value],o.value,0,o.value.length-1)}],">":{type:D,overloads:[[[nl,nl],qt],[[U,U],qt],[[U,U,J],function(a,t){var e=t[0],o=t[1];return 0<t[2].evaluate(a).compare(e.evaluate(a),o.evaluate(a))}]]},"<":{type:D,overloads:[[[nl,nl],jt],[[U,U],jt],[[U,U,J],function(a,t){var e=t[0],o=t[1];return 0>t[2].evaluate(a).compare(e.evaluate(a),o.evaluate(a))}]]},">=":{type:D,overloads:[[[nl,nl],Ut],[[U,U],Ut],[[U,U,J],function(a,t){var e=t[0],o=t[1];return 0<=t[2].evaluate(a).compare(e.evaluate(a),o.evaluate(a))}]]},"<=":{type:D,overloads:[[[nl,nl],Rt],[[U,U],Rt],[[U,U,J],function(a,t){var e=t[0],o=t[1];return 0>=t[2].evaluate(a).compare(e.evaluate(a),o.evaluate(a))}]]},all:{type:D,overloads:[[[D,D],function(a,t){var e=t[0],o=t[1];return e.evaluate(a)&&o.evaluate(a)}],[Dt(D),function(a,t){for(var e=0,o=t;e<o.length;e+=1)if(!o[e].evaluate(a))return!1;return!0}]]},any:{type:D,overloads:[[[D,D],function(a,t){var e=t[0],o=t[1];return e.evaluate(a)||o.evaluate(a)}],[Dt(D),function(a,t){for(var e=0,o=t;e<o.length;e+=1)if(o[e].evaluate(a))return!0;return!1}]]},"!":[D,[D],function(a,t){return!t[0].evaluate(a)}],"is-supported-script":[D,[U],function(a,t){var e=t[0],o=a.globals&&a.globals.isSupportedScript;return!o||o(e.evaluate(a))}],upcase:[U,[U],function(a,t){return t[0].evaluate(a).toUpperCase()}],downcase:[U,[U],function(a,t){return t[0].evaluate(a).toLowerCase()}],concat:[U,Dt(U),function(a,t){return t.map(function(t){return t.evaluate(a)}).join("")}],"resolved-locale":[U,[J],function(a,t){return t[0].evaluate(a).resolvedLocale()}]});var Tt=.95047,Jt=1.08883,Ht=4/29,Xt=6/29,Gt=3*Xt*Xt,Yt=Xt*Xt*Xt,Wt=Object.freeze({lab:{forward:gi,reverse:oe,interpolate:function(a,t,e){return{l:xt(a.l,t.l,e),a:xt(a.a,t.a,e),b:xt(a.b,t.b,e),alpha:xt(a.alpha,t.alpha,e)}}},hcl:{forward:function(a){var t=gi(a),e=t.l,r=t.a,n=t.b,i=L(n,r)*(180/Sa);return{h:0>i?i+360:i,c:re(r*r+n*n),l:e,alpha:a.a}},reverse:function(a){var t=a.h*(Sa/180),e=a.c;return oe({l:a.l,a:te(t)*e,b:M(t)*e,alpha:a.alpha})},interpolate:function(a,t,e){return{h:function(a,t,e){var o=t-a;return a+e*(180<o||-180>o?o-360*R(o/360):o)}(a.h,t.h,e),c:xt(a.c,t.c,e),l:xt(a.l,t.l,e),alpha:xt(a.alpha,t.alpha,e)}}}}),le=function(a,t){var e;this.expression=a,this._warningHistory={},this._defaultValue="color"===(e=t).type&&pe(e.default)?new W(0,0,0,0):"color"===e.type?W.parse(e.default)||null:void 0===e.default?null:e.default,"enum"===t.type&&(this._enumValues=t.values)};le.prototype.evaluateWithoutErrorHandling=function(a,t){return this._evaluator||(this._evaluator=new ht),this._evaluator.globals=a,this._evaluator.feature=t,this.expression.evaluate(this._evaluator)},le.prototype.evaluate=function(a,t){this._evaluator||(this._evaluator=new ht),this._evaluator.globals=a,this._evaluator.feature=t;try{var e=this.expression.evaluate(this._evaluator);if(null==e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new it("Expected value to be one of "+Object.keys(this._enumValues).map(function(e){return JSON.stringify(e)}).join(", ")+", but found "+JSON.stringify(e)+" instead.");return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}};var xe=function(a,t){this.kind=a,this._styleExpression=t};xe.prototype.evaluateWithoutErrorHandling=function(a,t){return this._styleExpression.evaluateWithoutErrorHandling(a,t)},xe.prototype.evaluate=function(a,t){return this._styleExpression.evaluate(a,t)};var _e=function(a,t,e){this.kind=a,this.zoomStops=e.labels,this._styleExpression=t,e instanceof _t&&(this._interpolationType=e.interpolation)};_e.prototype.evaluateWithoutErrorHandling=function(a,t){return this._styleExpression.evaluateWithoutErrorHandling(a,t)},_e.prototype.evaluate=function(a,t){return this._styleExpression.evaluate(a,t)},_e.prototype.interpolationFactor=function(a,t,e){return this._interpolationType?_t.interpolationFactor(this._interpolationType,a,t,e):0};var Ae=function(a,t){this._parameters=a,this._specification=t,Wa(this,function l(k,T){var t="color"===T.type,a=k.stops&&"object"==typeof k.stops[0][0],r=a||void 0!==k.property,s=k.type||("interpolated"===T.function?"exponential":"interval"),p,u,A;if(t&&((k=Wa({},k)).stops&&(k.stops=k.stops.map(function(e){return[e[0],W.parse(e[1])]})),k.default=k.default?W.parse(k.default):W.parse(T.default)),k.colorSpace&&"rgb"!==k.colorSpace&&!Wt[k.colorSpace])throw new Error("Unknown color space: "+k.colorSpace);if("exponential"===s)p=de;else if("interval"===s)p=ye;else if("categorical"===s){p=fe,u=Object.create(null);for(var S=0,C=k.stops,h;S<C.length;S+=1)h=C[S],u[h[0]]=h[1];A=typeof k.stops[0][0]}else{if("identity"!==s)throw new Error("Unknown function type \""+s+"\"");p=ve}if(a){for(var L={},y=[],d=0;d<k.stops.length;d++){var E=k.stops[d],m=E[0].zoom;void 0===L[m]&&(L[m]={zoom:m,type:k.type,property:k.property,default:k.default,stops:[]},y.push(m)),L[m].stops.push([E[0].value,E[1]])}for(var g=[],x=0,z=y,w;x<z.length;x+=1)w=z[x],g.push([L[w].zoom,l(L[w],T)]);return{kind:"composite",interpolationFactor:_t.interpolationFactor.bind(void 0,{name:"linear"}),zoomStops:g.map(function(e){return e[0]}),evaluate:function(e,t){var a=e.zoom;return de({stops:g,base:k.base},T,a).evaluate(a,t)}}}return a||!r?{kind:"camera",interpolationFactor:"exponential"===s?_t.interpolationFactor.bind(void 0,{name:"exponential",base:void 0===k.base?1:k.base}):function(){return 0},zoomStops:k.stops.map(function(e){return e[0]}),evaluate:function(e){var t=e.zoom;return p(k,T,t,u,A)}}:{kind:"source",evaluate:function(e,t){var a=t&&t.properties?t.properties[k.property]:void 0;return void 0===a?he(k.default,T.default):p(k,T,a,u,A)}}}(this._parameters,this._specification))};Ae.deserialize=function(e){return new Ae(e._parameters,e._specification)},Ae.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var ze={type:"boolean",default:!1,function:!0,"property-function":!0,"zoom-function":!0},Pe={"*":function(){return[]},array:Me,boolean:function(a){var t=a.value,e=a.key,o=Ni(t);return"boolean"===o?[]:[new il(e,t,"boolean expected, "+o+" found")]},number:Ve,color:function(a){var t=a.key,e=a.value,o=Ni(e);return"string"===o?null===G(e)?[new il(t,e,"color expected, \""+e+"\" found")]:[]:[new il(t,e,"color expected, "+o+" found")]},constants:V,enum:Ie,filter:Ue,function:Be,layer:Ke,object:Se,source:Je,light:$e,string:He};We.source=tr(Je),We.light=tr($e),We.layer=tr(Ke),We.filter=tr(Ue),We.paintProperty=tr(Ne),We.layoutProperty=tr(Ze);var Ge=We,rr=We.light,nr=We.paintProperty,ir=We.layoutProperty,or=ar,sr=3;ar.prototype.insert=function(a,t,e,o,r){this._forEachCell(t,e,o,r,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(t),this.bboxes.push(e),this.bboxes.push(o),this.bboxes.push(r)},ar.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ar.prototype._insertCell=function(a,t,e,r,n,i){this.cells[n].push(i)},ar.prototype.query=function(l,t,e,r){var n=this.min,i=this.max;if(l<=n&&t<=n&&i<=e&&i<=r)return Array.prototype.slice.call(this.keys);var o=[];return this._forEachCell(l,t,e,r,this._queryCell,o,{}),o},ar.prototype._queryCell=function(d,t,e,r,n,i,o){var a=this.cells[n];if(null!==a)for(var s=this.keys,u=this.bboxes,l=0,g;l<a.length;l++)if(g=a[l],void 0===o[g]){var m=4*g;d<=u[m+2]&&t<=u[m+3]&&e>=u[m+0]&&r>=u[m+1]?(o[g]=!0,i.push(s[g])):o[g]=!1}},ar.prototype._forEachCell=function(d,t,e,r,n,i,o){for(var a=this._convertToCellCoord(d),s=this._convertToCellCoord(t),u=this._convertToCellCoord(e),l=this._convertToCellCoord(r),p=a;p<=u;p++)for(var g=s,m;g<=l;g++)if(m=this.d*g+p,n.call(this,d,t,e,r,m,i,o))return},ar.prototype._convertToCellCoord=function(e){return va(0,ie(this.d-1,ea(e*this.scale)+this.padding))},ar.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,t=sr+this.cells.length+1+1,e=0,d=0;d<this.cells.length;d++)e+=this.cells[d].length;var c=new Int32Array(t+e+this.keys.length+this.bboxes.length);c[0]=this.extent,c[1]=this.n,c[2]=this.padding;for(var i=t,p=0,u;p<l.length;p++)u=l[p],c[sr+p]=i,c.set(u,i),i+=u.length;return c[sr+l.length]=i,c.set(this.keys,i),i+=this.keys.length,c[sr+l.length+1]=i,c.set(this.bboxes,i),i+=this.bboxes.length,c.buffer};var ur=self.ImageData,pr={};for(var cr in lr("Object",Object),or.serialize=function(a,t){var e=a.toArrayBuffer();return t&&t.push(e),e},or.deserialize=function(e){return new or(e)},lr("Grid",or),lr("Color",W),lr("Error",Error),lr("StylePropertyFunction",Ae),lr("StyleExpression",le,{omit:["_evaluator"]}),lr("ZoomDependentExpression",_e),lr("ZoomConstantExpression",xe),lr("CompoundExpression",ft,{omit:["_evaluate"]}),Pt)Pt[cr]._classRegistryKey||lr("Expression_"+cr,Pt[cr]);var fr=function(){this.first=!0};fr.prototype.update=function(a,t){var e=ea(a);return this.first?(this.first=!1,this.lastIntegerZoom=e,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=e,!0):(this.lastFloorZoom>e?(this.lastIntegerZoom=e+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<e&&(this.lastIntegerZoom=e,this.lastIntegerZoomTime=t),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=e,!0))};var vr={"Latin-1 Supplement":function(e){return 128<=e&&255>=e},Arabic:function(e){return 1536<=e&&1791>=e},"Arabic Supplement":function(e){return 1872<=e&&1919>=e},"Arabic Extended-A":function(e){return 2208<=e&&2303>=e},"Hangul Jamo":function(e){return 4352<=e&&4607>=e},"Unified Canadian Aboriginal Syllabics":function(e){return 5120<=e&&5759>=e},Khmer:function(e){return 6016<=e&&6143>=e},"Unified Canadian Aboriginal Syllabics Extended":function(e){return 6320<=e&&6399>=e},"General Punctuation":function(e){return 8192<=e&&8303>=e},"Letterlike Symbols":function(e){return 8448<=e&&8527>=e},"Number Forms":function(e){return 8528<=e&&8591>=e},"Miscellaneous Technical":function(e){return 8960<=e&&9215>=e},"Control Pictures":function(e){return 9216<=e&&9279>=e},"Optical Character Recognition":function(e){return 9280<=e&&9311>=e},"Enclosed Alphanumerics":function(e){return 9312<=e&&9471>=e},"Geometric Shapes":function(e){return 9632<=e&&9727>=e},"Miscellaneous Symbols":function(e){return 9728<=e&&9983>=e},"Miscellaneous Symbols and Arrows":function(e){return 11008<=e&&11263>=e},"CJK Radicals Supplement":function(e){return 11904<=e&&12031>=e},"Kangxi Radicals":function(e){return 12032<=e&&12255>=e},"Ideographic Description Characters":function(e){return 12272<=e&&12287>=e},"CJK Symbols and Punctuation":function(e){return 12288<=e&&12351>=e},Hiragana:function(e){return 12352<=e&&12447>=e},Katakana:function(e){return 12448<=e&&12543>=e},Bopomofo:function(e){return 12544<=e&&12591>=e},"Hangul Compatibility Jamo":function(e){return 12592<=e&&12687>=e},Kanbun:function(e){return 12688<=e&&12703>=e},"Bopomofo Extended":function(e){return 12704<=e&&12735>=e},"CJK Strokes":function(e){return 12736<=e&&12783>=e},"Katakana Phonetic Extensions":function(e){return 12784<=e&&12799>=e},"Enclosed CJK Letters and Months":function(e){return 12800<=e&&13055>=e},"CJK Compatibility":function(e){return 13056<=e&&13311>=e},"CJK Unified Ideographs Extension A":function(e){return 13312<=e&&19903>=e},"Yijing Hexagram Symbols":function(e){return 19904<=e&&19967>=e},"CJK Unified Ideographs":function(e){return 19968<=e&&40959>=e},"Yi Syllables":function(e){return 40960<=e&&42127>=e},"Yi Radicals":function(e){return 42128<=e&&42191>=e},"Hangul Jamo Extended-A":function(e){return 43360<=e&&43391>=e},"Hangul Syllables":function(e){return 44032<=e&&55215>=e},"Hangul Jamo Extended-B":function(e){return 55216<=e&&55295>=e},"Private Use Area":function(e){return 57344<=e&&63743>=e},"CJK Compatibility Ideographs":function(e){return 63744<=e&&64255>=e},"Arabic Presentation Forms-A":function(e){return 64336<=e&&65023>=e},"Vertical Forms":function(e){return 65040<=e&&65055>=e},"CJK Compatibility Forms":function(e){return 65072<=e&&65103>=e},"Small Form Variants":function(e){return 65104<=e&&65135>=e},"Arabic Presentation Forms-B":function(e){return 65136<=e&&65279>=e},"Halfwidth and Fullwidth Forms":function(e){return 65280<=e&&65519>=e}},mr=!1,ll=null,sl=!1,dl=new C,Mr={applyArabicShaping:null,processBidirectionalText:null,isLoaded:function(){return sl||null!=Mr.applyArabicShaping}},Vr=function(a,t){this.zoom=a,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new fr,this.transition={})},Br;Vr.prototype.isSupportedScript=function(e){return function(a,t){for(var e=0,o=a;e<o.length;e+=1)if(!wr(o[e].charCodeAt(0),t))return!1;return!0}(e,Mr.isLoaded())},Vr.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:ie((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)};var cl=function(a,t){this.property=a,this.value=t,this.expression=ke(void 0===t?a.specification.default:t,a.specification)};cl.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},cl.prototype.possiblyEvaluate=function(e){return this.property.possiblyEvaluate(this,e)};var Cr=function(e){this.property=e,this.value=new cl(e,void 0)};Cr.prototype.transitioned=function(a,t){return new Er(this.property,this.value,t,l({},a.transition,this.transition),a.now)},Cr.prototype.untransitioned=function(){return new Er(this.property,this.value,null,{},0)};var Ir=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};Ir.prototype.getValue=function(e){return m(this._values[e].value.value)},Ir.prototype.setValue=function(a,t){this._values.hasOwnProperty(a)||(this._values[a]=new Cr(this._values[a].property)),this._values[a].value=new cl(this._values[a].property,null===t?void 0:m(t))},Ir.prototype.getTransition=function(e){return m(this._values[e].transition)},Ir.prototype.setTransition=function(a,t){this._values.hasOwnProperty(a)||(this._values[a]=new Cr(this._values[a].property)),this._values[a].transition=m(t)||void 0},Ir.prototype.serialize=function(){for(var a={},t=0,l=Object.keys(this._values);t<l.length;t+=1){var r=l[t],n=this.getValue(r);void 0!==n&&(a[r]=n);var i=this.getTransition(r);void 0!==i&&(a[r+"-transition"]=i)}return a},Ir.prototype.transitioned=function(a,t){for(var e=new Fr(this._properties),r=0,l=Object.keys(this._values),i;r<l.length;r+=1)i=l[r],e._values[i]=this._values[i].transitioned(a,t._values[i]);return e},Ir.prototype.untransitioned=function(){for(var a=new Fr(this._properties),t=0,o=Object.keys(this._values),r;t<o.length;t+=1)r=o[t],a._values[r]=this._values[r].untransitioned();return a};var Er=function(a,t,e,o,r){this.property=a,this.value=t,this.begin=r+o.delay||0,this.end=this.begin+o.duration||0,a.specification.transition&&(o.delay||o.duration)&&(this.prior=e)};Er.prototype.possiblyEvaluate=function(a){var t=a.now||0,e=this.value.possiblyEvaluate(a),o=this.prior;if(o){if(t>this.end)return this.prior=null,e;if(this.value.isDataDriven())return this.prior=null,e;if(t<this.begin)return o.possiblyEvaluate(a);var r=(t-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(a),e,function(a){if(0>=a)return 0;if(1<=a)return 1;var t=a*a,e=t*a;return 4*(.5>a?e:3*(a-t)+e-.75)}(r))}return e};var Fr=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Fr.prototype.possiblyEvaluate=function(a){for(var t=new Or(this._properties),e=0,o=Object.keys(this._values),n;e<o.length;e+=1)n=o[e],t._values[n]=this._values[n].possiblyEvaluate(a);return t},Fr.prototype.hasTransition=function(){for(var a=0,o=Object.keys(this._values),e;a<o.length;a+=1)if(e=o[a],this._values[e].prior)return!0;return!1};var Pr=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};Pr.prototype.getValue=function(e){return m(this._values[e].value)},Pr.prototype.setValue=function(a,t){this._values[a]=new cl(this._values[a].property,null===t?void 0:m(t))},Pr.prototype.serialize=function(){for(var a={},t=0,o=Object.keys(this._values);t<o.length;t+=1){var r=o[t],n=this.getValue(r);void 0!==n&&(a[r]=n)}return a},Pr.prototype.possiblyEvaluate=function(a){for(var t=new Or(this._properties),e=0,o=Object.keys(this._values),n;e<o.length;e+=1)n=o[e],t._values[n]=this._values[n].possiblyEvaluate(a);return t};var Tr=function(a,t,e){this.property=a,this.value=t,this.globals=e};Tr.prototype.isConstant=function(){return"constant"===this.value.kind},Tr.prototype.constantOr=function(e){return"constant"===this.value.kind?this.value.value:e},Tr.prototype.evaluate=function(e){return this.property.evaluate(this.value,this.globals,e)};var Or=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};Or.prototype.get=function(e){return this._values[e]};var Lr=function(e){this.specification=e};Lr.prototype.possiblyEvaluate=function(a,t){return a.expression.evaluate(t)},Lr.prototype.interpolate=function(a,t,e){var o=bt[this.specification.type];return o?o(a,t,e):a};var jr=function(e){this.specification=e};jr.prototype.possiblyEvaluate=function(a,t){return"constant"===a.expression.kind||"camera"===a.expression.kind?new Tr(this,{kind:"constant",value:a.expression.evaluate(t)},t):new Tr(this,a.expression,t)},jr.prototype.interpolate=function(a,t,e){if("constant"!==a.value.kind||"constant"!==t.value.kind)return a;if(void 0===a.value.value||void 0===t.value.value)return new Tr(this,{kind:"constant",value:void 0},a.globals);var o=bt[this.specification.type];return o?new Tr(this,{kind:"constant",value:o(a.value.value,t.value.value,e)},a.globals):a},jr.prototype.evaluate=function(a,t,e){return"constant"===a.kind?a.value:a.evaluate(t,e)};var qr=function(e){this.specification=e};qr.prototype.possiblyEvaluate=function(a,t){if(void 0!==a.value){if("constant"===a.expression.kind){var e=a.expression.evaluate(t);return this._calculate(e,e,e,t)}return this._calculate(a.expression.evaluate(new Vr(ea(t.zoom-1),t)),a.expression.evaluate(new Vr(ea(t.zoom),t)),a.expression.evaluate(new Vr(ea(t.zoom+1),t)),t)}},qr.prototype._calculate=function(l,t,e,r){var n=r.zoom,i=n-ea(n),o=r.crossFadingFactor();return n>r.zoomHistory.lastIntegerZoom?{from:l,to:t,fromScale:2,toScale:1,t:i+(1-i)*o}:{from:e,to:t,fromScale:.5,toScale:1,t:1-(1-o)*i}},qr.prototype.interpolate=function(e){return e};var Rr=function(e){this.specification=e};Rr.prototype.possiblyEvaluate=function(a,t){return!!a.expression.evaluate(t)},Rr.prototype.interpolate=function(){return!1};var Ur=function(a){for(var t in this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},a){var e=a[t],o=this.defaultPropertyValues[t]=new cl(e,void 0),r=this.defaultTransitionablePropertyValues[t]=new Cr(e);this.defaultTransitioningPropertyValues[t]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=o.possiblyEvaluate({})}};lr("DataDrivenProperty",jr),lr("DataConstantProperty",Lr),lr("CrossFadedProperty",qr),lr("ColorRampProperty",Rr);var Dr=function(a){function t(t,e){for(var o in a.call(this),this.id=t.id,this.metadata=t.metadata,this.type=t.type,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,this.visibility="visible","background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),this._featureFilter=function(){return!0},e.layout&&(this._unevaluatedLayout=new Pr(e.layout)),this._transitionablePaint=new Ir(e.paint),t.paint)this.setPaintProperty(o,t.paint[o],{validate:!1});for(var r in t.layout)this.setLayoutProperty(r,t.layout[r],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getLayoutProperty=function(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)},t.prototype.setLayoutProperty=function(a,t,e){if(null!=t){var o="layers."+this.id+".layout."+a;if(this._validate(ir,o,a,t,e))return}"visibility"===a?this.visibility="none"===t?t:"visible":this._unevaluatedLayout.setValue(a,t)},t.prototype.getPaintProperty=function(e){return h(e,"-transition")?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)},t.prototype.setPaintProperty=function(a,t,e){if(null!=t){var o="layers."+this.id+".paint."+a;if(this._validate(nr,o,a,t,e))return}h(a,"-transition")?this._transitionablePaint.setTransition(a.slice(0,-11),t||void 0):this._transitionablePaint.setValue(a,t)},t.prototype.isHidden=function(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility},t.prototype.updateTransitions=function(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(e){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e)),this.paint=this._transitioningPaint.possiblyEvaluate(e)},t.prototype.serialize=function(){var e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return"none"===this.visibility&&(e.layout=e.layout||{},e.layout.visibility="none"),y(e,function(a,t){return void 0!==a&&("layout"!==t||Object.keys(a).length)&&("paint"!==t||Object.keys(a).length)})},t.prototype._validate=function(a,t,e,o,r){return(!r||!1!==r.validate)&&er(this,a.call(Ge,{key:t,layerType:this.type,objectKey:e,value:o,styleSpec:I,style:{glyphs:!0,sprite:!0}}))},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t}(C),Nr={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Zr=function(a,t){this._structArray=a,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Kr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};Kr.serialize=function(a,t){return a._trim(),t&&(a.isTransferred=!0,t.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}},Kr.deserialize=function(a){var t=Object.create(this.prototype);return t.arrayBuffer=a.arrayBuffer,t.length=a.length,t.capacity=a.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Kr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Kr.prototype.clear=function(){this.length=0},Kr.prototype.resize=function(e){this.reserve(e),this.length=e},Kr.prototype.reserve=function(a){if(a>this.capacity){this.capacity=va(a,ea(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Kr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Jr=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t){var e=this.length;this.resize(e+1);var o=2*e;return this.int16[o+0]=a,this.int16[o+1]=t,e},t}(Kr);Jr.prototype.bytesPerElement=4,lr("StructArrayLayout2i4",Jr);var Xr=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e,r){var n=this.length;this.resize(n+1);var i=4*n;return this.int16[i+0]=a,this.int16[i+1]=t,this.int16[i+2]=e,this.int16[i+3]=r,n},t}(Kr);Xr.prototype.bytesPerElement=8,lr("StructArrayLayout4i8",Xr);var Gr=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(l,t,e,r,n,i){var o=this.length;this.resize(o+1);var a=6*o;return this.int16[a+0]=l,this.int16[a+1]=t,this.int16[a+2]=e,this.int16[a+3]=r,this.int16[a+4]=n,this.int16[a+5]=i,o},t}(Kr);Gr.prototype.bytesPerElement=12,lr("StructArrayLayout2i4i12",Gr);var Yr=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(d,t,e,r,n,i,o,a){var s=this.length;this.resize(s+1);var c=6*s,l=12*s;return this.int16[c+0]=d,this.int16[c+1]=t,this.int16[c+2]=e,this.int16[c+3]=r,this.uint8[l+8]=n,this.uint8[l+9]=i,this.uint8[l+10]=o,this.uint8[l+11]=a,s},t}(Kr);Yr.prototype.bytesPerElement=12,lr("StructArrayLayout4i4ub12",Yr);var Wr=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(d,t,e,r,n,i,o,a){var s=this.length;this.resize(s+1);var c=8*s;return this.int16[c+0]=d,this.int16[c+1]=t,this.int16[c+2]=e,this.int16[c+3]=r,this.uint16[c+4]=n,this.uint16[c+5]=i,this.uint16[c+6]=o,this.uint16[c+7]=a,s},t}(Kr);Wr.prototype.bytesPerElement=16,lr("StructArrayLayout4i4ui16",Wr);var Qr=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e){var o=this.length;this.resize(o+1);var r=3*o;return this.float32[r+0]=a,this.float32[r+1]=t,this.float32[r+2]=e,o},t}(Kr);Qr.prototype.bytesPerElement=12,lr("StructArrayLayout3f12",Qr);var tn=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a){var t=this.length;this.resize(t+1);return this.uint32[1*t+0]=a,t},t}(Kr);tn.prototype.bytesPerElement=4,lr("StructArrayLayout1ul4",tn);var en=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(d,t,e,r,n,i,o,a,s,u,l){var p=this.length;this.resize(p+1);var c=12*p;return this.int16[c+0]=d,this.int16[c+1]=t,this.int16[c+2]=e,this.int16[c+3]=r,this.int16[c+4]=n,this.int16[c+5]=i,this.uint32[6*p+3]=o,this.uint16[c+8]=a,this.uint16[c+9]=s,this.int16[c+10]=u,this.int16[c+11]=l,p},t}(Kr);en.prototype.bytesPerElement=24,lr("StructArrayLayout6i1ul2ui2i24",en);var rn=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(l,t,e,r,n,i){var o=this.length;this.resize(o+1);var a=6*o;return this.int16[a+0]=l,this.int16[a+1]=t,this.int16[a+2]=e,this.int16[a+3]=r,this.int16[a+4]=n,this.int16[a+5]=i,o},t}(Kr);rn.prototype.bytesPerElement=12,lr("StructArrayLayout2i2i2i12",rn);var nn=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t){var e=this.length;this.resize(e+1);var o=4*e;return this.uint8[o+0]=a,this.uint8[o+1]=t,e},t}(Kr);nn.prototype.bytesPerElement=4,lr("StructArrayLayout2ub4",nn);var on=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(g,t,e,r,n,i,o,a,s,u,l,p,c,h){var f=this.length;this.resize(f+1);var y=20*f,d=10*f,x=40*f;return this.int16[y+0]=g,this.int16[y+1]=t,this.uint16[y+2]=e,this.uint16[y+3]=r,this.uint32[d+2]=n,this.uint32[d+3]=i,this.uint32[d+4]=o,this.uint16[y+10]=a,this.uint16[y+11]=s,this.uint16[y+12]=u,this.float32[d+7]=l,this.float32[d+8]=p,this.uint8[x+36]=c,this.uint8[x+37]=h,f},t}(Kr);on.prototype.bytesPerElement=40,lr("StructArrayLayout2i2ui3ul3ui2f2ub40",on);var an=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a){var t=this.length;this.resize(t+1);return this.float32[1*t+0]=a,t},t}(Kr);an.prototype.bytesPerElement=4,lr("StructArrayLayout1f4",an);var sn=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e){var o=this.length;this.resize(o+1);var r=3*o;return this.int16[r+0]=a,this.int16[r+1]=t,this.int16[r+2]=e,o},t}(Kr);sn.prototype.bytesPerElement=6,lr("StructArrayLayout3i6",sn);var un=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e){var r=this.length;this.resize(r+1);var i=4*r;return this.uint32[2*r+0]=a,this.uint16[i+2]=t,this.uint16[i+3]=e,r},t}(Kr);un.prototype.bytesPerElement=8,lr("StructArrayLayout1ul2ui8",un);var ln=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e){var o=this.length;this.resize(o+1);var r=3*o;return this.uint16[r+0]=a,this.uint16[r+1]=t,this.uint16[r+2]=e,o},t}(Kr);ln.prototype.bytesPerElement=6,lr("StructArrayLayout3ui6",ln);var pn=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t){var e=this.length;this.resize(e+1);var o=2*e;return this.uint16[o+0]=a,this.uint16[o+1]=t,e},t}(Kr);pn.prototype.bytesPerElement=4,lr("StructArrayLayout2ui4",pn);var cn=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t){var e=this.length;this.resize(e+1);var o=2*e;return this.float32[o+0]=a,this.float32[o+1]=t,e},t}(Kr);cn.prototype.bytesPerElement=8,lr("StructArrayLayout2f8",cn);var hn=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(a,t,e,r){var n=this.length;this.resize(n+1);var i=4*n;return this.float32[i+0]=a,this.float32[i+1]=t,this.float32[i+2]=e,this.float32[i+3]=r,n},t}(Kr);hn.prototype.bytesPerElement=16,lr("StructArrayLayout4f16",hn);var fn=function(a){function t(){a.apply(this,arguments)}a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t;var e={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return e.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},e.anchorPointX.set=function(e){this._structArray.int16[this._pos2+0]=e},e.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},e.anchorPointY.set=function(e){this._structArray.int16[this._pos2+1]=e},e.x1.get=function(){return this._structArray.int16[this._pos2+2]},e.x1.set=function(e){this._structArray.int16[this._pos2+2]=e},e.y1.get=function(){return this._structArray.int16[this._pos2+3]},e.y1.set=function(e){this._structArray.int16[this._pos2+3]=e},e.x2.get=function(){return this._structArray.int16[this._pos2+4]},e.x2.set=function(e){this._structArray.int16[this._pos2+4]=e},e.y2.get=function(){return this._structArray.int16[this._pos2+5]},e.y2.set=function(e){this._structArray.int16[this._pos2+5]=e},e.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},e.featureIndex.set=function(e){this._structArray.uint32[this._pos4+3]=e},e.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},e.sourceLayerIndex.set=function(e){this._structArray.uint16[this._pos2+8]=e},e.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},e.bucketIndex.set=function(e){this._structArray.uint16[this._pos2+9]=e},e.radius.get=function(){return this._structArray.int16[this._pos2+10]},e.radius.set=function(e){this._structArray.int16[this._pos2+10]=e},e.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},e.signedDistanceFromAnchor.set=function(e){this._structArray.int16[this._pos2+11]=e},e.anchorPoint.get=function(){return new rl(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,e),t}(Zr);fn.prototype.size=24;var yn=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.get=function(e){return new fn(this,e)},t}(en);lr("CollisionBoxArray",yn);var dn=function(a){function t(){a.apply(this,arguments)}a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t;var e={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},hidden:{configurable:!0}};return e.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},e.anchorX.set=function(e){this._structArray.int16[this._pos2+0]=e},e.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},e.anchorY.set=function(e){this._structArray.int16[this._pos2+1]=e},e.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},e.glyphStartIndex.set=function(e){this._structArray.uint16[this._pos2+2]=e},e.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},e.numGlyphs.set=function(e){this._structArray.uint16[this._pos2+3]=e},e.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},e.vertexStartIndex.set=function(e){this._structArray.uint32[this._pos4+2]=e},e.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},e.lineStartIndex.set=function(e){this._structArray.uint32[this._pos4+3]=e},e.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},e.lineLength.set=function(e){this._structArray.uint32[this._pos4+4]=e},e.segment.get=function(){return this._structArray.uint16[this._pos2+10]},e.segment.set=function(e){this._structArray.uint16[this._pos2+10]=e},e.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},e.lowerSize.set=function(e){this._structArray.uint16[this._pos2+11]=e},e.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},e.upperSize.set=function(e){this._structArray.uint16[this._pos2+12]=e},e.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},e.lineOffsetX.set=function(e){this._structArray.float32[this._pos4+7]=e},e.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},e.lineOffsetY.set=function(e){this._structArray.float32[this._pos4+8]=e},e.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},e.writingMode.set=function(e){this._structArray.uint8[this._pos1+36]=e},e.hidden.get=function(){return this._structArray.uint8[this._pos1+37]},e.hidden.set=function(e){this._structArray.uint8[this._pos1+37]=e},Object.defineProperties(t.prototype,e),t}(Zr);dn.prototype.size=40;var vn=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.get=function(e){return new dn(this,e)},t}(on);lr("PlacedSymbolArray",vn);var mn=function(a){function t(){a.apply(this,arguments)}a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t;var e={offsetX:{configurable:!0}};return e.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},e.offsetX.set=function(e){this._structArray.float32[this._pos4+0]=e},Object.defineProperties(t.prototype,e),t}(Zr);mn.prototype.size=4;var gn=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getoffsetX=function(e){return this.float32[1*e+0]},t.prototype.get=function(e){return new mn(this,e)},t}(an);lr("GlyphOffsetArray",gn);var xn=function(a){function t(){a.apply(this,arguments)}a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t;var e={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return e.x.get=function(){return this._structArray.int16[this._pos2+0]},e.x.set=function(e){this._structArray.int16[this._pos2+0]=e},e.y.get=function(){return this._structArray.int16[this._pos2+1]},e.y.set=function(e){this._structArray.int16[this._pos2+1]=e},e.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},e.tileUnitDistanceFromAnchor.set=function(e){this._structArray.int16[this._pos2+2]=e},Object.defineProperties(t.prototype,e),t}(Zr);xn.prototype.size=6;var bn=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.getx=function(e){return this.int16[3*e+0]},t.prototype.gety=function(e){return this.int16[3*e+1]},t.prototype.gettileUnitDistanceFromAnchor=function(e){return this.int16[3*e+2]},t.prototype.get=function(e){return new xn(this,e)},t}(sn);lr("SymbolLineVertexArray",bn);var wn=function(a){function t(){a.apply(this,arguments)}a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t;var e={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return e.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},e.featureIndex.set=function(e){this._structArray.uint32[this._pos4+0]=e},e.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},e.sourceLayerIndex.set=function(e){this._structArray.uint16[this._pos2+2]=e},e.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},e.bucketIndex.set=function(e){this._structArray.uint16[this._pos2+3]=e},Object.defineProperties(t.prototype,e),t}(Zr);wn.prototype.size=8;var _n=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.get=function(e){return new wn(this,e)},t}(un);lr("FeatureIndexArray",_n);var An=_r([{name:"a_pos",components:2,type:"Int16"}],4).members,kn=function(e){void 0===e&&(e=[]),this.segments=e};kn.prototype.prepareSegment=function(a,t,e){var o=this.segments[this.segments.length-1];return a>kn.MAX_VERTEX_ARRAY_LENGTH&&Qt("Max vertices per segment is "+kn.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+a),(!o||o.vertexLength+a>kn.MAX_VERTEX_ARRAY_LENGTH)&&(o={vertexOffset:t.length,primitiveOffset:e.length,vertexLength:0,primitiveLength:0},this.segments.push(o)),o},kn.prototype.get=function(){return this.segments},kn.prototype.destroy=function(){for(var a=0,o=this.segments,e;a<o.length;a+=1)for(var i in e=o[a],e.vaos)e.vaos[i].destroy()},kn.MAX_VERTEX_ARRAY_LENGTH=_a(2,16)-1,lr("SegmentVector",kn);var zn=function(a,o){return 256*(a=$t(ea(a),0,255))+(o=$t(ea(o),0,255))},Sn=function(a,t,e){this.value=a,this.name=t,this.type=e,this.statistics={max:-1/0}};Sn.prototype.defines=function(){return["#define HAS_UNIFORM_u_"+this.name]},Sn.prototype.populatePaintArray=function(){},Sn.prototype.upload=function(){},Sn.prototype.destroy=function(){},Sn.prototype.setUniforms=function(a,t,e,r){var n=r.constantOr(this.value),i=a.gl;"color"===this.type?i.uniform4f(t.uniforms["u_"+this.name],n.r,n.g,n.b,n.a):i.uniform1f(t.uniforms["u_"+this.name],n)};var Vn=function(a,t,e){this.expression=a,this.name=t,this.type=e,this.statistics={max:-1/0};var o="color"===e?cn:an;this.paintVertexAttributes=[{name:"a_"+t,type:"Float32",components:"color"===e?2:1,offset:0}],this.paintVertexArray=new o};Vn.prototype.defines=function(){return[]},Vn.prototype.populatePaintArray=function(l,t){var e=this.paintVertexArray,r=e.length;e.reserve(l);var n=this.expression.evaluate(new Vr(0),t);if("color"===this.type)for(var i=Hr(n),o=r;o<l;o++)e.emplaceBack(i[0],i[1]);else{for(var d=r;d<l;d++)e.emplaceBack(n);this.statistics.max=va(this.statistics.max,n)}},Vn.prototype.upload=function(e){this.paintVertexArray&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes))},Vn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Vn.prototype.setUniforms=function(a,t){a.gl.uniform1f(t.uniforms["a_"+this.name+"_t"],0)};var Bn=function(a,t,e,r,n){this.expression=a,this.name=t,this.type=e,this.useIntegerZoom=r,this.zoom=n,this.statistics={max:-1/0};var i="color"===e?hn:cn;this.paintVertexAttributes=[{name:"a_"+t,type:"Float32",components:"color"===e?4:2,offset:0}],this.paintVertexArray=new i};Bn.prototype.defines=function(){return[]},Bn.prototype.populatePaintArray=function(d,t){var e=this.paintVertexArray,r=e.length;e.reserve(d);var n=this.expression.evaluate(new Vr(this.zoom),t),i=this.expression.evaluate(new Vr(this.zoom+1),t);if("color"===this.type)for(var o=Hr(n),a=Hr(i),s=r;s<d;s++)e.emplaceBack(o[0],o[1],a[0],a[1]);else{for(var c=r;c<d;c++)e.emplaceBack(n,i);this.statistics.max=va(this.statistics.max,n,i)}},Bn.prototype.upload=function(e){this.paintVertexArray&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes))},Bn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Bn.prototype.interpolationFactor=function(e){return this.useIntegerZoom?this.expression.interpolationFactor(ea(e),this.zoom,this.zoom+1):this.expression.interpolationFactor(e,this.zoom,this.zoom+1)},Bn.prototype.setUniforms=function(a,t,e){a.gl.uniform1f(t.uniforms["a_"+this.name+"_t"],this.interpolationFactor(e.zoom))};var Cn=function(){this.binders={},this.cacheKey="",this._buffers=[]};Cn.createDynamic=function(d,t,e){var r=new Cn,n=[];for(var i in d.paint._values)if(e(i)){var o=d.paint.get(i);if(o instanceof Tr&&o.property.specification["property-function"]){var a=Pn(i,d.type),s=o.property.specification.type,c=o.property.useIntegerZoom;"constant"===o.value.kind?(r.binders[i]=new Sn(o.value,a,s),n.push("/u_"+a)):"source"===o.value.kind?(r.binders[i]=new Vn(o.value,a,s),n.push("/a_"+a)):(r.binders[i]=new Bn(o.value,a,s,c,t),n.push("/z_"+a))}}return r.cacheKey=n.sort().join(""),r},Cn.prototype.populatePaintArrays=function(a,t){for(var e in this.binders)this.binders[e].populatePaintArray(a,t)},Cn.prototype.defines=function(){var a=[];for(var t in this.binders)a.push.apply(a,this.binders[t].defines());return a},Cn.prototype.setUniforms=function(a,t,e,o){for(var r in this.binders)this.binders[r].setUniforms(a,t,o,e.get(r))},Cn.prototype.getPaintVertexBuffers=function(){return this._buffers},Cn.prototype.upload=function(a){for(var t in this.binders)this.binders[t].upload(a);var e=[];for(var o in this.binders){var r=this.binders[o];(r instanceof Vn||r instanceof Bn)&&r.paintVertexBuffer&&e.push(r.paintVertexBuffer)}this._buffers=e},Cn.prototype.destroy=function(){for(var e in this.binders)this.binders[e].destroy()};var In=function(l,t,e,r){void 0===r&&(r=function(){return!0}),this.programConfigurations={};for(var s=0,d=t,o;s<d.length;s+=1)o=d[s],this.programConfigurations[o.id]=Cn.createDynamic(o,e,r),this.programConfigurations[o.id].layoutAttributes=l};In.prototype.populatePaintArrays=function(a,t){for(var e in this.programConfigurations)this.programConfigurations[e].populatePaintArrays(a,t)},In.prototype.get=function(e){return this.programConfigurations[e]},In.prototype.upload=function(a){for(var t in this.programConfigurations)this.programConfigurations[t].upload(a)},In.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},lr("ConstantBinder",Sn),lr("SourceExpressionBinder",Vn),lr("CompositeExpressionBinder",Bn),lr("ProgramConfiguration",Cn,{omit:["_buffers"]}),lr("ProgramConfigurationSet",In);var En=(qn=16,{min:-1*_a(2,qn-1),max:_a(2,qn-1)-1}),On=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.layoutVertexArray=new Jr,this.indexArray=new ln,this.segments=new kn,this.programConfigurations=new In(An,e.layers,e.zoom)},qn;On.prototype.populate=function(l,t){for(var e=0,d=l;e<d.length;e+=1){var n=d[e],i=n.feature,o=n.index,a=n.sourceLayerIndex;if(this.layers[0]._featureFilter(new Vr(this.zoom),i)){var s=Mn(i);this.addFeature(i,s),t.featureIndex.insert(i,s,o,a,this.index)}}},On.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},On.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,An),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.programConfigurations.upload(e)},On.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},On.prototype.addFeature=function(d,t){for(var e=0,c=t;e<c.length;e+=1)for(var n=0,g=c[e];n<g.length;n+=1){var o=g[n],a=o.x,s=o.y;if(!(0>a||8192<=a||0>s||8192<=s)){var u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),l=u.vertexLength;Ln(this.layoutVertexArray,a,s,-1,-1),Ln(this.layoutVertexArray,a,s,1,-1),Ln(this.layoutVertexArray,a,s,1,1),Ln(this.layoutVertexArray,a,s,-1,1),this.indexArray.emplaceBack(l,l+1,l+2),this.indexArray.emplaceBack(l,l+3,l+2),u.vertexLength+=4,u.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,d)},lr("CircleBucket",On,{omit:["layers"]});var pl={paint:new Ur({"circle-radius":new jr(I.paint_circle["circle-radius"]),"circle-color":new jr(I.paint_circle["circle-color"]),"circle-blur":new jr(I.paint_circle["circle-blur"]),"circle-opacity":new jr(I.paint_circle["circle-opacity"]),"circle-translate":new Lr(I.paint_circle["circle-translate"]),"circle-translate-anchor":new Lr(I.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Lr(I.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Lr(I.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jr(I.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jr(I.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jr(I.paint_circle["circle-stroke-opacity"])})},Qn=r(function(e){var t;e.exports=((t=new Float32Array(3))[0]=0,t[1]=0,t[2]=0,function(){var e=new Float32Array(4);e[0]=0,e[1]=0,e[2]=0,e[3]=0}(),{vec3:{transformMat3:function(a,t,e){var r=t[0],n=t[1],i=t[2];return a[0]=r*e[0]+n*e[3]+i*e[6],a[1]=r*e[1]+n*e[4]+i*e[7],a[2]=r*e[2]+n*e[5]+i*e[8],a}},vec4:{transformMat4:function(l,t,e){var r=t[0],n=t[1],i=t[2],o=t[3];return l[0]=e[0]*r+e[4]*n+e[8]*i+e[12]*o,l[1]=e[1]*r+e[5]*n+e[9]*i+e[13]*o,l[2]=e[2]*r+e[6]*n+e[10]*i+e[14]*o,l[3]=e[3]*r+e[7]*n+e[11]*i+e[15]*o,l}},mat2:{create:function(){var e=new Float32Array(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},rotate:function(l,t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=M(e),s=te(e);return l[0]=r*s+i*a,l[1]=n*s+o*a,l[2]=r*-a+i*s,l[3]=n*-a+o*s,l},scale:function(l,t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=e[0],s=e[1];return l[0]=r*a,l[1]=n*a,l[2]=i*s,l[3]=o*s,l}},mat3:{create:function(){var e=new Float32Array(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromRotation:function(a,t){var e=M(t),o=te(t);return a[0]=o,a[1]=e,a[2]=0,a[3]=-e,a[4]=o,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a}},mat4:{create:function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},translate:function(g,t,e){var r=e[0],d=e[1],x=e[2],m,b,_,v,w,k,T,A,S,C,L,E;return t===g?(g[12]=t[0]*r+t[4]*d+t[8]*x+t[12],g[13]=t[1]*r+t[5]*d+t[9]*x+t[13],g[14]=t[2]*r+t[6]*d+t[10]*x+t[14],g[15]=t[3]*r+t[7]*d+t[11]*x+t[15]):(m=t[0],b=t[1],_=t[2],v=t[3],w=t[4],k=t[5],T=t[6],A=t[7],S=t[8],C=t[9],L=t[10],E=t[11],g[0]=m,g[1]=b,g[2]=_,g[3]=v,g[4]=w,g[5]=k,g[6]=T,g[7]=A,g[8]=S,g[9]=C,g[10]=L,g[11]=E,g[12]=m*r+w*d+S*x+t[12],g[13]=b*r+k*d+C*x+t[13],g[14]=_*r+T*d+L*x+t[14],g[15]=v*r+A*d+E*x+t[15]),g},scale:function(a,t,e){var r=e[0],n=e[1],i=e[2];return a[0]=t[0]*r,a[1]=t[1]*r,a[2]=t[2]*r,a[3]=t[3]*r,a[4]=t[4]*n,a[5]=t[5]*n,a[6]=t[6]*n,a[7]=t[7]*n,a[8]=t[8]*i,a[9]=t[9]*i,a[10]=t[10]*i,a[11]=t[11]*i,a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},multiply:function(k,t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],p=t[8],c=t[9],h=t[10],f=t[11],y=t[12],d=t[13],v=t[14],m=t[15],g=e[0],T=e[1],A=e[2],S=e[3];return k[0]=g*r+T*a+A*p+S*y,k[1]=g*n+T*s+A*c+S*d,k[2]=g*i+T*u+A*h+S*v,k[3]=g*o+T*l+A*f+S*m,g=e[4],T=e[5],A=e[6],S=e[7],k[4]=g*r+T*a+A*p+S*y,k[5]=g*n+T*s+A*c+S*d,k[6]=g*i+T*u+A*h+S*v,k[7]=g*o+T*l+A*f+S*m,g=e[8],T=e[9],A=e[10],S=e[11],k[8]=g*r+T*a+A*p+S*y,k[9]=g*n+T*s+A*c+S*d,k[10]=g*i+T*u+A*h+S*v,k[11]=g*o+T*l+A*f+S*m,g=e[12],T=e[13],A=e[14],S=e[15],k[12]=g*r+T*a+A*p+S*y,k[13]=g*n+T*s+A*c+S*d,k[14]=g*i+T*u+A*h+S*v,k[15]=g*o+T*l+A*f+S*m,k},perspective:function(l,t,e,r,n){var i=1/g(t/2),o=1/(r-n);return l[0]=i/e,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=i,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=(n+r)*o,l[11]=-1,l[12]=0,l[13]=0,l[14]=2*n*r*o,l[15]=0,l},rotateX:function(d,t,e){var r=M(e),n=te(e),i=t[4],o=t[5],a=t[6],s=t[7],u=t[8],l=t[9],p=t[10],c=t[11];return t!==d&&(d[0]=t[0],d[1]=t[1],d[2]=t[2],d[3]=t[3],d[12]=t[12],d[13]=t[13],d[14]=t[14],d[15]=t[15]),d[4]=i*n+u*r,d[5]=o*n+l*r,d[6]=a*n+p*r,d[7]=s*n+c*r,d[8]=u*n-i*r,d[9]=l*n-o*r,d[10]=p*n-a*r,d[11]=c*n-s*r,d},rotateZ:function(d,t,e){var r=M(e),n=te(e),i=t[0],o=t[1],a=t[2],s=t[3],u=t[4],l=t[5],p=t[6],c=t[7];return t!==d&&(d[8]=t[8],d[9]=t[9],d[10]=t[10],d[11]=t[11],d[12]=t[12],d[13]=t[13],d[14]=t[14],d[15]=t[15]),d[0]=i*n+u*r,d[1]=o*n+l*r,d[2]=a*n+p*r,d[3]=s*n+c*r,d[4]=u*n-i*r,d[5]=l*n-o*r,d[6]=p*n-a*r,d[7]=c*n-s*r,d},invert:function(T,t){var e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],p=t[9],c=t[10],h=t[11],f=t[12],y=t[13],d=t[14],v=t[15],m=e*a-r*o,g=e*s-n*o,x=e*u-i*o,b=r*s-n*a,w=r*u-i*a,_=n*u-i*s,A=l*y-p*f,k=l*d-c*f,L=l*v-h*f,S=p*d-c*y,E=p*v-h*y,z=c*v-h*d,I=m*z-g*E+x*S+b*L-w*k+_*A;return I?(I=1/I,T[0]=(a*z-s*E+u*S)*I,T[1]=(n*E-r*z-i*S)*I,T[2]=(y*_-d*w+v*b)*I,T[3]=(c*w-p*_-h*b)*I,T[4]=(s*L-o*z-u*k)*I,T[5]=(e*z-n*L+i*k)*I,T[6]=(d*x-f*_-v*g)*I,T[7]=(l*_-c*x+h*g)*I,T[8]=(o*E-a*L+u*A)*I,T[9]=(r*L-e*E-i*A)*I,T[10]=(f*w-y*x+v*m)*I,T[11]=(p*x-l*w-h*m)*I,T[12]=(a*k-o*S-s*A)*I,T[13]=(e*S-r*k+n*A)*I,T[14]=(y*g-f*b-d*m)*I,T[15]=(l*b-p*g+c*m)*I,T):null},ortho:function(d,t,e,r,n,i,o){var a=1/(t-e),s=1/(r-n),c=1/(i-o);return d[0]=-2*a,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=-2*s,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=2*c,d[11]=0,d[12]=(t+e)*a,d[13]=(n+r)*s,d[14]=(o+i)*c,d[15]=1,d}}})}),ti=(Qn.vec3,Qn.vec4),ei=(Qn.mat2,Qn.mat3,Qn.mat4),ri=function(a){function t(t){a.call(this,t,pl)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.createBucket=function(e){return new On(e)},t.prototype.queryRadius=function(a){var t=a;return Xn("circle-radius",this,t)+Xn("circle-stroke-width",this,t)+Gn(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(b,t,e,r,n,i,o){for(var a=Yn(b,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),n.angle,i),s=this.paint.get("circle-radius").evaluate(t)+this.paint.get("circle-stroke-width").evaluate(t),u="map"===this.paint.get("circle-pitch-alignment"),l=u?a:function(a,o,e){return a.map(function(a){return a.map(function(a){return Wn(a,o,e)})})}(a,o,n),p=u?s*i:s,c=0,_=e;c<_.length;c+=1)for(var f=0,w=_[c];f<w.length;f+=1){var d=w[f],v=u?d:Wn(d,o,n),m=p,k=ti.transformMat4([],[d.x,d.y,0,1],o);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?m*=k[3]/n.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(m*=n.cameraToCenterDistance/k[3]),jn(l,v,m))return!0}return!1},t}(Dr),ni=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t}(On);lr("HeatmapBucket",ni,{omit:["layers"]});var oi=function(a,t){ii(this,a,1,t)};oi.prototype.resize=function(e){ai(this,e,1)},oi.prototype.clone=function(){return new oi({width:this.width,height:this.height},new Uint8Array(this.data))},oi.copy=function(a,t,e,o,r){si(a,t,e,o,r,1)};var li=function(a,t){ii(this,a,4,t)};li.prototype.resize=function(e){ai(this,e,4)},li.prototype.clone=function(){return new li({width:this.width,height:this.height},new Uint8Array(this.data))},li.copy=function(a,t,e,o,r){si(a,t,e,o,r,4)},lr("AlphaImage",oi),lr("RGBAImage",li);var pi={paint:new Ur({"heatmap-radius":new jr(I.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jr(I.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Lr(I.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Rr(I.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Lr(I.paint_heatmap["heatmap-opacity"])})},ci=function(a){function t(t){a.call(this,t,pi),this._updateColorRamp()}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.createBucket=function(e){return new ni(e)},t.prototype.setPaintProperty=function(t,e,o){a.prototype.setPaintProperty.call(this,t,e,o),"heatmap-color"===t&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){var e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=ui(e,"heatmapDensity"),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},t}(Dr),fi={paint:new Ur({"hillshade-illumination-direction":new Lr(I.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Lr(I.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Lr(I.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Lr(I.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Lr(I.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Lr(I.paint_hillshade["hillshade-accent-color"])})},yi=function(a){function t(t){a.call(this,t,fi)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},t}(Dr),di=_r([{name:"a_pos",components:2,type:"Int16"}],4).members,vi=hi;hi.deviation=function(d,t,e,r){var n=t&&t.length,i=n?t[0]*e:d.length,o=wa(Ri(d,0,i,e));if(n)for(var g=0,m=t.length;g<m;g++){var u=t[g]*e,l=g<m-1?t[g+1]*e:d.length;o-=wa(Ri(d,u,l,e))}var p=0;for(g=0;g<r.length;g+=3){var x=r[g]*e,h=r[g+1]*e,f=r[g+2]*e;p+=wa((d[x]-d[f])*(d[h+1]-d[x+1])-(d[x]-d[h])*(d[f+1]-d[x+1]))}return 0===o&&0===p?0:wa((p-o)/o)},hi.flatten=function(l){for(var t=l[0][0].length,e={vertices:[],holes:[],dimensions:t},r=0,s=0;s<l.length;s++){for(var d=0;d<l[s].length;d++)for(var c=0;c<t;c++)e.vertices.push(l[s][d][c]);0<s&&(r+=l[s-1].length,e.holes.push(r))}return e},vi.default=hi;var mi=Ui;mi.default=Ui;var Di=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.layoutVertexArray=new Jr,this.indexArray=new ln,this.indexArray2=new pn,this.programConfigurations=new In(di,e.layers,e.zoom),this.segments=new kn,this.segments2=new kn};Di.prototype.populate=function(l,t){for(var e=0,d=l;e<d.length;e+=1){var n=d[e],i=n.feature,o=n.index,a=n.sourceLayerIndex;if(this.layers[0]._featureFilter(new Vr(this.zoom),i)){var s=Mn(i);this.addFeature(i,s),t.featureIndex.insert(i,s,o,a,this.index)}}},Di.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Di.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,di),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2),this.programConfigurations.upload(e)},Di.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Di.prototype.addFeature=function(b,t){for(var e=0,_=Ji(t,500);e<_.length;e+=1){for(var n=_[e],i=0,w=0,k=n;w<k.length;w+=1)i+=k[w].length;for(var s=this.segments.prepareSegment(i,this.layoutVertexArray,this.indexArray),u=s.vertexLength,l=[],p=[],c=0,T=n,f;c<T.length;c+=1)if(f=T[c],0!==f.length){f!==n[0]&&p.push(l.length/2);var A=this.segments2.prepareSegment(f.length,this.layoutVertexArray,this.indexArray2),d=A.vertexLength;this.layoutVertexArray.emplaceBack(f[0].x,f[0].y),this.indexArray2.emplaceBack(d+f.length-1,d),l.push(f[0].x),l.push(f[0].y);for(var v=1;v<f.length;v++)this.layoutVertexArray.emplaceBack(f[v].x,f[v].y),this.indexArray2.emplaceBack(d+v-1,d+v),l.push(f[v].x),l.push(f[v].y);A.vertexLength+=f.length,A.primitiveLength+=f.length}for(var S=vi(l,p),g=0;g<S.length;g+=3)this.indexArray.emplaceBack(u+S[g],u+S[g+1],u+S[g+2]);s.vertexLength+=i,s.primitiveLength+=S.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,b)},lr("FillBucket",Di,{omit:["layers"]});var Xi={paint:new Ur({"fill-antialias":new Lr(I.paint_fill["fill-antialias"]),"fill-opacity":new jr(I.paint_fill["fill-opacity"]),"fill-color":new jr(I.paint_fill["fill-color"]),"fill-outline-color":new jr(I.paint_fill["fill-outline-color"]),"fill-translate":new Lr(I.paint_fill["fill-translate"]),"fill-translate-anchor":new Lr(I.paint_fill["fill-translate-anchor"]),"fill-pattern":new qr(I.paint_fill["fill-pattern"])})},Gi=function(a){function t(t){a.call(this,t,Xi)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.recalculate=function(a){this.paint=this._transitioningPaint.possiblyEvaluate(a);var t=this.paint._values["fill-outline-color"];"constant"===t.value.kind&&void 0===t.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(e){return new Di(e)},t.prototype.queryRadius=function(){return Gn(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(a,t,e,r,n,i){return Rn(Yn(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),n.angle,i),e)},t}(Dr),Yi=_r([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Wi=_a(2,13),Qi=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.layoutVertexArray=new Gr,this.indexArray=new ln,this.programConfigurations=new In(Yi,e.layers,e.zoom),this.segments=new kn};Qi.prototype.populate=function(l,t){for(var e=0,d=l;e<d.length;e+=1){var n=d[e],i=n.feature,o=n.index,a=n.sourceLayerIndex;if(this.layers[0]._featureFilter(new Vr(this.zoom),i)){var s=Mn(i);this.addFeature(i,s),t.featureIndex.insert(i,s,o,a,this.index)}}},Qi.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Qi.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Yi),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.programConfigurations.upload(e)},Qi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Qi.prototype.addFeature=function(T,t){for(var e=0,C=Ji(t,500);e<C.length;e+=1){for(var n=C[e],i=0,L=0,E=n;L<E.length;L+=1)i+=E[L].length;for(var s=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),I=0,D=n,p;I<D.length;I+=1)if(p=D[I],0!==p.length&&!ro(p))for(var P=0,O=0,R;O<p.length;O++)if(R=p[O],1<=O){var j=p[O-1];if(!to(R,j)){s.vertexLength+4>kn.MAX_VERTEX_ARRAY_LENGTH&&(s=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var d=R.sub(j)._perp()._unit(),v=j.dist(R);32768<P+v&&(P=0),Hi(this.layoutVertexArray,R.x,R.y,d.x,d.y,0,0,P),Hi(this.layoutVertexArray,R.x,R.y,d.x,d.y,0,1,P),P+=v,Hi(this.layoutVertexArray,j.x,j.y,d.x,d.y,0,0,P),Hi(this.layoutVertexArray,j.x,j.y,d.x,d.y,0,1,P);var m=s.vertexLength;this.indexArray.emplaceBack(m,m+1,m+2),this.indexArray.emplaceBack(m+1,m+2,m+3),s.vertexLength+=4,s.primitiveLength+=2}}s.vertexLength+i>kn.MAX_VERTEX_ARRAY_LENGTH&&(s=this.segments.prepareSegment(i,this.layoutVertexArray,this.indexArray));for(var g=[],x=[],b=s.vertexLength,w=0,B=n,A;w<B.length;w+=1)if(A=B[w],0!==A.length){A!==n[0]&&x.push(g.length/2);for(var F=0,N;F<A.length;F++)N=A[F],Hi(this.layoutVertexArray,N.x,N.y,0,0,1,1,0),g.push(N.x),g.push(N.y)}for(var U=vi(g,x),M=0;M<U.length;M+=3)this.indexArray.emplaceBack(b+U[M],b+U[M+1],b+U[M+2]);s.primitiveLength+=U.length/3,s.vertexLength+=i}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,T)},lr("FillExtrusionBucket",Qi,{omit:["layers"]});var eo={paint:new Ur({"fill-extrusion-opacity":new Lr(I["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jr(I["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Lr(I["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Lr(I["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new qr(I["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jr(I["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jr(I["paint_fill-extrusion"]["fill-extrusion-base"])})},io=function(a){function t(t){a.call(this,t,eo)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.createBucket=function(e){return new Qi(e)},t.prototype.queryRadius=function(){return Gn(this.paint.get("fill-extrusion-translate"))},t.prototype.queryIntersectsFeature=function(a,t,e,r,n,i){return Rn(Yn(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),n.angle,i),e)},t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("fill-extrusion-opacity")&&"none"!==this.visibility},t.prototype.resize=function(){this.viewportFrame&&(this.viewportFrame.destroy(),this.viewportFrame=null)},t}(Dr),oo=_r([{name:"a_pos_normal",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,ao=no;no.types=["Unknown","Point","LineString","Polygon"],no.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var t=s.readVarint()+s.pos,r=1,d=0,c=0,p=0,g=[],u;s.pos<t;){if(0>=d){var h=s.readVarint();r=7&h,d=h>>3}if(d--,1==r||2==r)c+=s.readSVarint(),p+=s.readSVarint(),1==r&&(u&&g.push(u),u=[]),u.push(new rl(c,p));else{if(7!=r)throw new Error("unknown command "+r);u&&u.push(u[0].clone())}}return u&&g.push(u),g},no.prototype.bbox=function(){var d=this._pbf;d.pos=this._geometry;for(var t=d.readVarint()+d.pos,e=1,c=0,g=0,h=0,m=1/0,y=-1/0,f=1/0,x=-1/0;d.pos<t;){if(0>=c){var b=d.readVarint();e=7&b,c=b>>3}if(c--,1==e||2==e)(g+=d.readSVarint())<m&&(m=g),g>y&&(y=g),(h+=d.readSVarint())<f&&(f=h),h>x&&(x=h);else if(7!=e)throw new Error("unknown command "+e)}return[m,f,y,x]},no.prototype.toGeoJSON=function(d,t,e){function r(i){for(var t=0;t<i.length;t++){var l=i[t],r=180-360*(l.y+a)/p;i[t]=[360*(l.x+o)/p-180,360/Sa*k(ka(r*Sa/180))-90]}}var p=this.extent*_a(2,e),o=this.extent*d,a=this.extent*t,s=this.loadGeometry(),g=no.types[this.type],m,y;switch(this.type){case 1:var f=[];for(m=0;m<s.length;m++)f[m]=s[m][0];r(s=f);break;case 2:for(m=0;m<s.length;m++)r(s[m]);break;case 3:for(s=function(l){var t=l.length;if(1>=t)return[l];for(var e=[],i=0,s,d,c;i<t;i++)c=lo(l[i]),0!==c&&(null==d&&(d=0>c),d===0>c?(s&&e.push(s),s=[l[i]]):s.push(l[i]));return s&&e.push(s),e}(s),m=0;m<s.length;m++)for(y=0;y<s[m].length;y++)r(s[m][y]);}1===s.length?s=s[0]:g="Multi"+g;var c={type:"Feature",geometry:{type:g,coordinates:s},properties:this.properties};return"id"in this&&(c.id=this.id),c};var so=po;po.prototype.feature=function(a){if(0>a||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var t=this._pbf.readVarint()+this._pbf.pos;return new ao(this._pbf,t,this.extent,this._keys,this._values)};var co={VectorTile:function(a,t){this.layers=a.readFields(fo,{},t)},VectorTileFeature:ao,VectorTileLayer:so},vo=co.VectorTileFeature.types,mo=te(37.5*(Sa/180)),xo=.5,bo=_a(2,14)/xo,wo=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.layoutVertexArray=new Yr,this.indexArray=new ln,this.programConfigurations=new In(oo,e.layers,e.zoom),this.segments=new kn};wo.prototype.populate=function(l,t){for(var e=0,d=l;e<d.length;e+=1){var n=d[e],i=n.feature,o=n.index,a=n.sourceLayerIndex;if(this.layers[0]._featureFilter(new Vr(this.zoom),i)){var s=Mn(i);this.addFeature(i,s),t.featureIndex.insert(i,s,o,a,this.index)}}},wo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},wo.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,oo),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.programConfigurations.upload(e)},wo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},wo.prototype.addFeature=function(d,t){for(var e=this.layers[0].layout,r=e.get("line-join").evaluate(d),n=e.get("line-cap"),i=e.get("line-miter-limit"),o=e.get("line-round-limit"),a=0,c=t,p;a<c.length;a+=1)p=c[a],this.addLine(p,d,r,n,i,o)},wo.prototype.addLine=function(v,t,e,r,n,D){var o=null;t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end")&&(o={start:t.properties.mapbox_clip_start,end:t.properties.mapbox_clip_end,tileTotal:void 0});for(var N="Polygon"===vo[t.type],s=v.length;2<=s&&v[s-1].equals(v[s-2]);)s--;for(var H=0;H<s-1&&v[H].equals(v[H+1]);)H++;if(!(s<(N?3:2))){o&&(o.tileTotal=function(l,t,e){for(var r=0,s=t,d,c;s<e-1;s++)d=l[s],c=l[s+1],r+=d.dist(c);return r}(v,H,s)),"bevel"===e&&(n=1.05);var G=15*(8192/(512*this.overscaling)),p=v[H],c=this.segments.prepareSegment(10*s,this.layoutVertexArray,this.indexArray);this.distance=0;var h=N?"butt":r,m=!0,Y,W,X,Z,$,J,K;this.e1=this.e2=this.e3=-1,N&&(Y=v[s-2],K=p.sub(Y)._unit()._perp());for(var Q=H;Q<s;Q++)if(!($=N&&Q==s-1?v[H+1]:v[Q+1])||!v[Q].equals($)){K&&(J=K),Y&&(Z=Y),Y=v[Q],K=$?$.sub(Y)._unit()._perp():J;var ee=(J=J||K).add(K);0===ee.x&&0===ee.y||ee._unit();var te=ee.x*K.x+ee.y*K.y,z=0==te?1/0:1/te,S=te<mo&&Z&&$;if(S&&Q>H){var M=Y.dist(Z);if(M>2*G){var V=Y.sub(Y.sub(Z)._mult(G/M)._round());this.distance+=V.dist(Z),this.addCurrentVertex(V,this.distance,J.mult(1),0,0,!1,c,o),Z=V}}var B=Z&&$,C=B?e:$?r:h;if(B&&"round"===C&&(z<D?C="miter":2>=z&&(C="fakeround")),"miter"===C&&z>n&&(C="bevel"),"bevel"===C&&(2<z&&(C="flipbevel"),z<n&&(C="miter")),Z&&(this.distance+=Y.dist(Z)),"miter"===C)ee._mult(z),this.addCurrentVertex(Y,this.distance,ee,0,0,!1,c,o);else if("flipbevel"===C){if(100<z)ee=K.clone().mult(-1);else{var ae=0<J.x*K.y-J.y*K.x?-1:1,E=z*J.add(K).mag()/J.sub(K).mag();ee._perp()._mult(E*ae)}this.addCurrentVertex(Y,this.distance,ee,0,0,!1,c,o),this.addCurrentVertex(Y,this.distance,ee.mult(-1),0,0,!1,c,o)}else if("bevel"===C||"fakeround"===C){var F=0<J.x*K.y-J.y*K.x,P=-re(z*z-1);if(F?(X=0,W=P):(W=0,X=P),m||this.addCurrentVertex(Y,this.distance,J,W,X,!1,c,o),"fakeround"===C){for(var T=ea(8*(.5-(te-.5))),O=void 0,oe=0;oe<T;oe++)O=K.mult((oe+1)/(T+1))._add(J)._unit(),this.addPieSliceVertex(Y,this.distance,O,F,c,o);this.addPieSliceVertex(Y,this.distance,ee,F,c,o);for(var ie=T-1;0<=ie;ie--)O=J.mult((ie+1)/(T+1))._add(K)._unit(),this.addPieSliceVertex(Y,this.distance,O,F,c,o)}$&&this.addCurrentVertex(Y,this.distance,K,-W,-X,!1,c,o)}else"butt"===C?(m||this.addCurrentVertex(Y,this.distance,J,0,0,!1,c,o),$&&this.addCurrentVertex(Y,this.distance,K,0,0,!1,c,o)):"square"===C?(m||(this.addCurrentVertex(Y,this.distance,J,1,1,!1,c,o),this.e1=this.e2=-1),$&&this.addCurrentVertex(Y,this.distance,K,-1,-1,!1,c,o)):"round"==C&&(m||(this.addCurrentVertex(Y,this.distance,J,0,0,!1,c,o),this.addCurrentVertex(Y,this.distance,J,1,1,!0,c,o),this.e1=this.e2=-1),$&&(this.addCurrentVertex(Y,this.distance,K,-1,-1,!0,c,o),this.addCurrentVertex(Y,this.distance,K,0,0,!1,c,o)));if(S&&Q<s-1){var ne=Y.dist($);if(ne>2*G){var R=Y.add($.sub(Y)._mult(G/ne)._round());this.distance+=R.dist(Y),this.addCurrentVertex(R,this.distance,K.mult(1),0,0,!1,c,o),Y=R}}m=!1}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t)}},wo.prototype.addCurrentVertex=function(d,t,c,r,n,i,o,a){var s=this.layoutVertexArray,l=this.indexArray,p;a&&(t=_o(t,a)),p=c.clone(),r&&p._sub(c.perp()._mult(r)),yo(s,d,p,i,!1,r,t),this.e3=o.vertexLength++,0<=this.e1&&0<=this.e2&&(l.emplaceBack(this.e1,this.e2,this.e3),o.primitiveLength++),this.e1=this.e2,this.e2=this.e3,p=c.mult(-1),n&&p._sub(c.perp()._mult(n)),yo(s,d,p,i,!0,-n,t),this.e3=o.vertexLength++,0<=this.e1&&0<=this.e2&&(l.emplaceBack(this.e1,this.e2,this.e3),o.primitiveLength++),this.e1=this.e2,this.e2=this.e3,16384<t&&!a&&(this.distance=0,this.addCurrentVertex(d,this.distance,c,r,n,i,o))},wo.prototype.addPieSliceVertex=function(l,t,d,c,n,i){d=d.mult(c?-1:1);var o=this.layoutVertexArray,a=this.indexArray;i&&(t=_o(t,i)),yo(o,l,d,!1,c,0,t),this.e3=n.vertexLength++,0<=this.e1&&0<=this.e2&&(a.emplaceBack(this.e1,this.e2,this.e3),n.primitiveLength++),c?this.e2=this.e3:this.e1=this.e3},lr("LineBucket",wo,{omit:["layers"]});var Ao=new Ur({"line-cap":new Lr(I.layout_line["line-cap"]),"line-join":new jr(I.layout_line["line-join"]),"line-miter-limit":new Lr(I.layout_line["line-miter-limit"]),"line-round-limit":new Lr(I.layout_line["line-round-limit"])}),zo={paint:new Ur({"line-opacity":new jr(I.paint_line["line-opacity"]),"line-color":new jr(I.paint_line["line-color"]),"line-translate":new Lr(I.paint_line["line-translate"]),"line-translate-anchor":new Lr(I.paint_line["line-translate-anchor"]),"line-width":new jr(I.paint_line["line-width"]),"line-gap-width":new jr(I.paint_line["line-gap-width"]),"line-offset":new jr(I.paint_line["line-offset"]),"line-blur":new jr(I.paint_line["line-blur"]),"line-dasharray":new qr(I.paint_line["line-dasharray"]),"line-pattern":new qr(I.paint_line["line-pattern"]),"line-gradient":new Rr(I.paint_line["line-gradient"])}),layout:Ao},So=new(function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.possiblyEvaluate=function(t,e){return e=new Vr(ea(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),a.prototype.possiblyEvaluate.call(this,t,e)},t.prototype.evaluate=function(t,e,o){return e=l({},e,{zoom:ea(e.zoom)}),a.prototype.evaluate.call(this,t,e,o)},t}(jr))(zo.paint.properties["line-width"].specification);So.useIntegerZoom=!0;var Mo=function(a){function t(t){a.call(this,t,zo)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.setPaintProperty=function(t,e,o){a.prototype.setPaintProperty.call(this,t,e,o),"line-gradient"===t&&this._updateGradient()},t.prototype._updateGradient=function(){var e=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=ui(e,"lineProgress"),this.gradientTexture=null},t.prototype.recalculate=function(t){a.prototype.recalculate.call(this,t),this.paint._values["line-floorwidth"]=So.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)},t.prototype.createBucket=function(e){return new wo(e)},t.prototype.queryRadius=function(a){var t=a,e=ko(Xn("line-width",this,t),Xn("line-gap-width",this,t)),o=Xn("line-offset",this,t);return e/2+wa(o)+Gn(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(s,t,e,d,n,i){var o=Yn(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),n.angle,i),a=i/2*ko(this.paint.get("line-width").evaluate(t),this.paint.get("line-gap-width").evaluate(t)),c=this.paint.get("line-offset").evaluate(t);return c&&(e=function(s,t){for(var e=[],r=new rl(0,0),n=0;n<s.length;n++){for(var g=s[n],o=[],a=0;a<g.length;a++){var m=g[a-1],l=g[a],p=g[a+1],c=0==a?r:l.sub(m)._unit()._perp(),h=a==g.length-1?r:p.sub(l)._unit()._perp(),f=c._add(h)._unit(),y=f.x*h.x+f.y*h.y;f._mult(1/y),o.push(f._mult(t)._add(l))}e.push(o)}return e}(e,c*i)),Fn(o,e,a)},t}(Dr),Vo=_r([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]),Co=_r([{name:"a_projected_pos",components:3,type:"Float32"}],4),Io=(_r([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),_r([{name:"a_placed",components:2,type:"Uint8"}],4)),Eo=(_r([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),_r([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Fo=_r([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);_r([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"hidden"}]),_r([{type:"Float32",name:"offsetX"}]),_r([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Po={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","":"\uFFE0","":"\uFFE1","":"\uFFE5","":"\uFFE4","":"\uFFE2","":"\uFFE3","":"\uFE32","":"\uFE31","":"\uFE43","":"\uFE44","":"\uFE41","":"\uFE42","":"\uFE19","":"\u30FB","":"\uFFE6","":"\uFE11","":"\uFE12","":"\uFE3F","":"\uFE40","":"\uFE3D","":"\uFE3E","":"\uFE41","":"\uFE42","":"\uFE43","":"\uFE44","":"\uFE3B","":"\uFE3C","":"\uFE39","":"\uFE3A","":"\uFE17","":"\uFE18","":"\uFE15","":"\uFE35","":"\uFE36","":"\uFE10","":"\uFE32","":"\u30FB","":"\uFE13","":"\uFE14","":"\uFE3F","":"\uFE40","":"\uFE16","":"\uFE47","":"\uFE48","":"\uFE33","":"\uFE37","":"\u2015","":"\uFE38","":"\uFE35","":"\uFE36","":"\uFE12","":"\uFE41","":"\uFE42"},Oo=function(a){function t(t,e,o,r){a.call(this,t,e),this.angle=o,void 0!==r&&(this.segment=r)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(rl);lr("Anchor",Oo);var Lo=co.VectorTileFeature.types,qo=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}],Ro=function(e){this.layoutVertexArray=new Wr,this.indexArray=new ln,this.programConfigurations=e,this.segments=new kn,this.dynamicLayoutVertexArray=new Qr,this.opacityVertexArray=new tn,this.placedSymbolArray=new vn};Ro.prototype.upload=function(a,t){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Vo.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,t),this.programConfigurations.upload(a),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,Co.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,qo,!0),this.opacityVertexBuffer.itemSize=1},Ro.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},lr("SymbolBuffers",Ro);var No=function(a,t,e){this.layoutVertexArray=new a,this.layoutAttributes=t,this.indexArray=new e,this.segments=new kn,this.collisionVertexArray=new nn};No.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Io.members,!0)},No.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},lr("CollisionBuffers",No);var Zo=function(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex;var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=To(this.zoom,t["text-size"]),this.iconSizeData=To(this.zoom,t["icon-size"]);var e=this.layers[0].layout;this.sortFeaturesByY=e.get("text-allow-overlap")||e.get("icon-allow-overlap")||e.get("text-ignore-placement")||e.get("icon-ignore-placement")};Zo.prototype.createArrays=function(){this.text=new Ro(new In(Vo.members,this.layers,this.zoom,function(e){return /^text/.test(e)})),this.icon=new Ro(new In(Vo.members,this.layers,this.zoom,function(e){return /^icon/.test(e)})),this.collisionBox=new No(rn,Eo.members,pn),this.collisionCircle=new No(rn,Fo.members,ln),this.glyphOffsetArray=new gn,this.lineVertexArray=new bn},Zo.prototype.populate=function(T,t){var e=this.layers[0],r=e.layout,n=r.get("text-font"),i=r.get("text-field"),o=r.get("icon-image"),a=("constant"!==i.value.kind||0<i.value.value.length)&&("constant"!==n.value.kind||0<n.value.value.length),s="constant"!==o.value.kind||o.value.value&&0<o.value.value.length;if(this.features=[],a||s){for(var u=t.iconDependencies,l=t.glyphDependencies,p=new Vr(this.zoom),c=0,C=T;c<C.length;c+=1){var f=C[c],y=f.feature,d=f.index,v=f.sourceLayerIndex;if(e._featureFilter(p,y)){var m=void 0;a&&(m=Bo(m=e.getValueAndResolveTokens("text-field",y),e,y));var L=void 0;if(s&&(L=e.getValueAndResolveTokens("icon-image",y)),m||L){var E={text:m,icon:L,index:d,sourceLayerIndex:v,geometry:Mn(y),properties:y.properties,type:Lo[y.type]};if(void 0!==y.id&&(E.id=y.id),this.features.push(E),L&&(u[L]=!0),m)for(var b=n.evaluate(y).join(","),w=l[b]=l[b]||{},_="map"===r.get("text-rotation-alignment")&&"line"===r.get("symbol-placement"),A=dr(m),k=0;k<m.length;k++)if(w[m.charCodeAt(k)]=!0,_&&A){var I=Po[m.charAt(k)];I&&(w[I.charCodeAt(0)]=!0)}}}}"line"===r.get("symbol-placement")&&(this.features=function(g){function t(t){x.push(g[t]),r++}function o(a,t,e){var r=m[a];return delete m[a],m[t]=r,x[r].geometry[0].pop(),x[r].geometry[0]=x[r].geometry[0].concat(e[0]),r}function a(e,t,a){var r=u[t];return delete u[t],u[e]=r,x[r].geometry[0].shift(),x[r].geometry[0]=a[0].concat(x[r].geometry[0]),r}function s(a,t,e){var o=e?t[0][t[0].length-1]:t[0][0];return a+":"+o.x+":"+o.y}for(var u={},m={},x=[],r=0,e=0;e<g.length;e++){var n=g[e],p=n.geometry,c=n.text;if(c){var h=s(c,p),f=s(c,p,!0);if(h in m&&f in u&&m[h]!==u[f]){var y=a(h,f,p),d=o(h,f,x[y].geometry);delete u[h],delete m[f],m[s(c,x[d].geometry,!0)]=d,x[y].geometry=null}else h in m?o(h,f,p):f in u?a(h,f,p):(t(e),u[h]=r-1,m[f]=r-1)}else t(e)}return x.filter(function(e){return e.geometry})}(this.features))}},Zo.prototype.isEmpty=function(){return 0===this.symbolInstances.length},Zo.prototype.upload=function(e){this.text.upload(e,this.sortFeaturesByY),this.icon.upload(e,this.sortFeaturesByY),this.collisionBox.upload(e),this.collisionCircle.upload(e)},Zo.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.collisionBox.destroy(),this.collisionCircle.destroy()},Zo.prototype.addToLineVertexArray=function(d,t){var e=this.lineVertexArray.length;if(void 0!==d.segment){for(var r=d.dist(t[d.segment+1]),c=d.dist(t[d.segment]),p={},o=d.segment+1;o<t.length;o++)p[o]={x:t[o].x,y:t[o].y,tileUnitDistanceFromAnchor:r},o<t.length-1&&(r+=t[o+1].dist(t[o]));for(var g=d.segment||0;0<=g;g--)p[g]={x:t[g].x,y:t[g].y,tileUnitDistanceFromAnchor:c},0<g&&(c+=t[g-1].dist(t[g]));for(var h=0,m;h<t.length;h++)m=p[h],this.lineVertexArray.emplaceBack(m.x,m.y,m.tileUnitDistanceFromAnchor)}return{lineStartIndex:e,lineLength:this.lineVertexArray.length-e}},Zo.prototype.addSymbols=function(T,t,e,r,n,i,o,a,s,u){for(var l=T.indexArray,p=T.layoutVertexArray,c=T.dynamicLayoutVertexArray,h=T.segments.prepareSegment(4*t.length,T.layoutVertexArray,T.indexArray),f=this.glyphOffsetArray.length,y=h.vertexLength,d=0,S=t;d<S.length;d+=1){var m=S[d],g=m.tl,x=m.tr,b=m.bl,w=m.br,_=m.tex,A=h.vertexLength,k=m.glyphOffset[1];jo(p,a.x,a.y,g.x,k+g.y,_.x,_.y,e),jo(p,a.x,a.y,x.x,k+x.y,_.x+_.w,_.y,e),jo(p,a.x,a.y,b.x,k+b.y,_.x,_.y+_.h,e),jo(p,a.x,a.y,w.x,k+w.y,_.x+_.w,_.y+_.h,e),Uo(c,a,0),l.emplaceBack(A,A+1,A+2),l.emplaceBack(A+1,A+2,A+3),h.vertexLength+=4,h.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(m.glyphOffset[0])}T.placedSymbolArray.emplaceBack(a.x,a.y,f,this.glyphOffsetArray.length-f,y,s,u,a.segment,e?e[0]:0,e?e[1]:0,r[0],r[1],o,!1),T.programConfigurations.populatePaintArrays(T.layoutVertexArray.length,i)},Zo.prototype._addCollisionDebugVertex=function(a,t,e,o,r){return t.emplaceBack(0,0),a.emplaceBack(e.x,e.y,o.x,o.y,R(r.x),R(r.y))},Zo.prototype.addCollisionDebugVertices=function(s,t,e,r,n,i,o,a){var d=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),l=d.vertexLength,p=n.layoutVertexArray,c=n.collisionVertexArray;if(this._addCollisionDebugVertex(p,c,i,o.anchor,new rl(s,t)),this._addCollisionDebugVertex(p,c,i,o.anchor,new rl(e,t)),this._addCollisionDebugVertex(p,c,i,o.anchor,new rl(e,r)),this._addCollisionDebugVertex(p,c,i,o.anchor,new rl(s,r)),d.vertexLength+=4,a){var u=n.indexArray;u.emplaceBack(l,l+1,l+2),u.emplaceBack(l,l+2,l+3),d.primitiveLength+=2}else{var g=n.indexArray;g.emplaceBack(l,l+1),g.emplaceBack(l+1,l+2),g.emplaceBack(l+2,l+3),g.emplaceBack(l+3,l),d.primitiveLength+=4}},Zo.prototype.generateCollisionDebugBuffers=function(){for(var d=0,g=this.symbolInstances,e;d<g.length;d+=1){e=g[d],e.textCollisionFeature={boxStartIndex:e.textBoxStartIndex,boxEndIndex:e.textBoxEndIndex},e.iconCollisionFeature={boxStartIndex:e.iconBoxStartIndex,boxEndIndex:e.iconBoxEndIndex};for(var h=0,m;2>h;h++)if(m=e[0==h?"textCollisionFeature":"iconCollisionFeature"],m)for(var y=m.boxStartIndex;y<m.boxEndIndex;y++){var f=this.collisionBoxArray.get(y),a=f.x1,s=f.y1,u=f.x2,l=f.y2,p=0<f.radius;this.addCollisionDebugVertices(a,s,u,l,p?this.collisionCircle:this.collisionBox,f.anchorPoint,e,p)}}},Zo.prototype.deserializeCollisionBoxes=function(d,t,e,r,n){for(var i={},o=t,c;o<e;o++){if(c=d.get(o),0===c.radius){i.textBox={x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2,anchorPointX:c.anchorPointX,anchorPointY:c.anchorPointY},i.textFeatureIndex=c.featureIndex;break}i.textCircles||(i.textCircles=[],i.textFeatureIndex=c.featureIndex),i.textCircles.push(c.anchorPointX,c.anchorPointY,c.radius,c.signedDistanceFromAnchor,1)}for(var p=r,g;p<n;p++)if(g=d.get(p),0===g.radius){i.iconBox={x1:g.x1,y1:g.y1,x2:g.x2,y2:g.y2,anchorPointX:g.anchorPointX,anchorPointY:g.anchorPointY},i.iconFeatureIndex=g.featureIndex;break}return i},Zo.prototype.hasTextData=function(){return 0<this.text.segments.get().length},Zo.prototype.hasIconData=function(){return 0<this.icon.segments.get().length},Zo.prototype.hasCollisionBoxData=function(){return 0<this.collisionBox.segments.get().length},Zo.prototype.hasCollisionCircleData=function(){return 0<this.collisionCircle.segments.get().length},Zo.prototype.sortFeatures=function(g){var x=this;if(this.sortFeaturesByY&&this.sortedAngle!==g&&(this.sortedAngle=g,!(1<this.text.segments.get().length||1<this.icon.segments.get().length))){for(var e=[],t=0;t<this.symbolInstances.length;t++)e.push(t);var b=M(g),i=te(g);e.sort(function(e,t){var o=x.symbolInstances[e],r=x.symbolInstances[t];return(0|b*o.anchor.x+i*o.anchor.y)-(0|b*r.anchor.x+i*r.anchor.y)||r.featureIndex-o.featureIndex}),this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var o=0,r=e;o<r.length;o+=1){var s=r[o],u=x.symbolInstances[s];x.featureSortOrder.push(u.featureIndex);for(var l=0,_=u.placedTextSymbolIndices;l<_.length;l+=1)for(var c=_[l],h=x.text.placedSymbolArray.get(c),f=h.vertexStartIndex+4*h.numGlyphs,y=h.vertexStartIndex;y<f;y+=4)x.text.indexArray.emplaceBack(y,y+1,y+2),x.text.indexArray.emplaceBack(y+1,y+2,y+3);var w=x.icon.placedSymbolArray.get(s);if(w.numGlyphs){var v=w.vertexStartIndex;x.icon.indexArray.emplaceBack(v,v+1,v+2),x.icon.indexArray.emplaceBack(v+1,v+2,v+3)}}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},lr("SymbolBucket",Zo,{omit:["layers","collisionBoxArray","features","compareText"],shallow:["symbolInstances"]}),Zo.MAX_GLYPHS=65535,Zo.addDynamicAttributes=Uo;var Ko=new Ur({"symbol-placement":new Lr(I.layout_symbol["symbol-placement"]),"symbol-spacing":new Lr(I.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Lr(I.layout_symbol["symbol-avoid-edges"]),"icon-allow-overlap":new Lr(I.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Lr(I.layout_symbol["icon-ignore-placement"]),"icon-optional":new Lr(I.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Lr(I.layout_symbol["icon-rotation-alignment"]),"icon-size":new jr(I.layout_symbol["icon-size"]),"icon-text-fit":new Lr(I.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Lr(I.layout_symbol["icon-text-fit-padding"]),"icon-image":new jr(I.layout_symbol["icon-image"]),"icon-rotate":new jr(I.layout_symbol["icon-rotate"]),"icon-padding":new Lr(I.layout_symbol["icon-padding"]),"icon-keep-upright":new Lr(I.layout_symbol["icon-keep-upright"]),"icon-offset":new jr(I.layout_symbol["icon-offset"]),"icon-anchor":new jr(I.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Lr(I.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Lr(I.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Lr(I.layout_symbol["text-rotation-alignment"]),"text-field":new jr(I.layout_symbol["text-field"]),"text-font":new jr(I.layout_symbol["text-font"]),"text-size":new jr(I.layout_symbol["text-size"]),"text-max-width":new jr(I.layout_symbol["text-max-width"]),"text-line-height":new Lr(I.layout_symbol["text-line-height"]),"text-letter-spacing":new jr(I.layout_symbol["text-letter-spacing"]),"text-justify":new jr(I.layout_symbol["text-justify"]),"text-anchor":new jr(I.layout_symbol["text-anchor"]),"text-max-angle":new Lr(I.layout_symbol["text-max-angle"]),"text-rotate":new jr(I.layout_symbol["text-rotate"]),"text-padding":new Lr(I.layout_symbol["text-padding"]),"text-keep-upright":new Lr(I.layout_symbol["text-keep-upright"]),"text-transform":new jr(I.layout_symbol["text-transform"]),"text-offset":new jr(I.layout_symbol["text-offset"]),"text-allow-overlap":new Lr(I.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Lr(I.layout_symbol["text-ignore-placement"]),"text-optional":new Lr(I.layout_symbol["text-optional"])}),Jo={paint:new Ur({"icon-opacity":new jr(I.paint_symbol["icon-opacity"]),"icon-color":new jr(I.paint_symbol["icon-color"]),"icon-halo-color":new jr(I.paint_symbol["icon-halo-color"]),"icon-halo-width":new jr(I.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jr(I.paint_symbol["icon-halo-blur"]),"icon-translate":new Lr(I.paint_symbol["icon-translate"]),"icon-translate-anchor":new Lr(I.paint_symbol["icon-translate-anchor"]),"text-opacity":new jr(I.paint_symbol["text-opacity"]),"text-color":new jr(I.paint_symbol["text-color"]),"text-halo-color":new jr(I.paint_symbol["text-halo-color"]),"text-halo-width":new jr(I.paint_symbol["text-halo-width"]),"text-halo-blur":new jr(I.paint_symbol["text-halo-blur"]),"text-translate":new Lr(I.paint_symbol["text-translate"]),"text-translate-anchor":new Lr(I.paint_symbol["text-translate-anchor"])}),layout:Ko},$o=function(a){function t(t){a.call(this,t,Jo)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.recalculate=function(t){a.prototype.recalculate.call(this,t),"auto"===this.layout.get("icon-rotation-alignment")&&("line"===this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("line"===this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"))},t.prototype.getValueAndResolveTokens=function(a,t){var e=this.layout.get(a).evaluate(t),o=this._unevaluatedLayout._values[a],i;return o.isDataDriven()||ge(o.value)?e:(i=t.properties,e.replace(/{([^{}]+)}/g,function(a,t){return t in i?i[t]+"":""}))},t.prototype.createBucket=function(e){return new Zo(e)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t}(Dr),Ho={paint:new Ur({"background-color":new Lr(I.paint_background["background-color"]),"background-pattern":new qr(I.paint_background["background-pattern"]),"background-opacity":new Lr(I.paint_background["background-opacity"])})},Xo=function(a){function t(t){a.call(this,t,Ho)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t}(Dr),Go={paint:new Ur({"raster-opacity":new Lr(I.paint_raster["raster-opacity"]),"raster-hue-rotate":new Lr(I.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Lr(I.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Lr(I.paint_raster["raster-brightness-max"]),"raster-saturation":new Lr(I.paint_raster["raster-saturation"]),"raster-contrast":new Lr(I.paint_raster["raster-contrast"]),"raster-fade-duration":new Lr(I.paint_raster["raster-fade-duration"])})},Yo={circle:ri,heatmap:ci,hillshade:yi,fill:Gi,"fill-extrusion":io,line:Mo,symbol:$o,background:Xo,raster:function(a){function t(t){a.call(this,t,Go)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t}(Dr)},Wo=r(function(e){e.exports=function(){function a(a,t,e){e=e||{},this.w=a||64,this.h=t||64,this.autoResize=!!e.autoResize,this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0}function d(a,t,e){this.x=0,this.y=a,this.w=this.free=t,this.h=e}return a.prototype.pack=function(l,d){l=[].concat(l),d=d||{};for(var c=[],a=0,p,u,g,h;a<l.length;a++)if(p=l[a].w||l[a].width,u=l[a].h||l[a].height,g=l[a].id,p&&u){if(!(h=this.packOne(p,u,g)))continue;d.inPlace&&(l[a].x=h.x,l[a].y=h.y,l[a].id=h.id),c.push(h)}return this.shrink(),c},a.prototype.packOne=function(e,t,r){var g={freebin:-1,shelf:-1,waste:1/0},h=0,m,y,x,b,_,v,w,k;if("string"==typeof r||"number"==typeof r){if(m=this.getBin(r))return this.ref(m),m;"number"==typeof r&&(this.maxId=va(r,this.maxId))}else r=++this.maxId;for(b=0;b<this.freebins.length;b++){if(t===(m=this.freebins[b]).maxh&&e===m.maxw)return this.allocFreebin(b,e,t,r);t>m.maxh||e>m.maxw||t<=m.maxh&&e<=m.maxw&&(x=m.maxw*m.maxh-e*t)<g.waste&&(g.waste=x,g.freebin=b)}for(b=0;b<this.shelves.length;b++)if(h+=(y=this.shelves[b]).h,!(e>y.free)){if(t===y.h)return this.allocShelf(b,e,t,r);t>y.h||t<y.h&&(x=(y.h-t)*e)<g.waste&&(g.freebin=-1,g.waste=x,g.shelf=b)}return-1===g.freebin?-1===g.shelf?t<=this.h-h&&e<=this.w?(y=new d(h,this.w,t),this.allocShelf(this.shelves.push(y)-1,e,t,r)):this.autoResize?(_=v=this.h,((w=k=this.w)<=_||e>w)&&(k=2*va(e,w)),(_<w||t>_)&&(v=2*va(t,_)),this.resize(k,v),this.packOne(e,t,r)):null:this.allocShelf(g.shelf,e,t,r):this.allocFreebin(g.freebin,e,t,r)},a.prototype.allocFreebin=function(a,t,e,o){var r=this.freebins.splice(a,1)[0];return r.id=o,r.w=t,r.h=e,r.refcount=0,this.bins[o]=r,this.ref(r),r},a.prototype.allocShelf=function(a,t,e,o){var r=this.shelves[a].alloc(t,e,o);return this.bins[o]=r,this.ref(r),r},a.prototype.shrink=function(){if(0<this.shelves.length){for(var a=0,o=0,i=0,l;i<this.shelves.length;i++)l=this.shelves[i],o+=l.h,a=va(l.w-l.free,a);this.resize(a,o)}},a.prototype.getBin=function(e){return this.bins[e]},a.prototype.ref=function(a){if(1==++a.refcount){var t=a.h;this.stats[t]=1+(0|this.stats[t])}return a.refcount},a.prototype.unref=function(e){return 0===e.refcount?0:(0==--e.refcount&&(this.stats[e.h]--,delete this.bins[e.id],this.freebins.push(e)),e.refcount)},a.prototype.clear=function(){this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0},a.prototype.resize=function(a,t){this.w=a,this.h=t;for(var e=0;e<this.shelves.length;e++)this.shelves[e].resize(a);return!0},d.prototype.alloc=function(a,t,e){if(a>this.free||t>this.h)return null;var o=this.x;return this.x+=a,this.free-=a,new function(l,t,e,r,n,i,o){this.id=l,this.x=t,this.y=e,this.w=r,this.h=n,this.maxw=i||r,this.maxh=o||n,this.refcount=0}(e,o,this.y,a,t,a,this.h)},d.prototype.resize=function(e){return this.free+=e-this.w,this.w=e,!0},a}()}),Qo=function(a,t){var e=t.pixelRatio;this.paddedRect=a,this.pixelRatio=e},ta={tl:{configurable:!0},br:{configurable:!0},displaySize:{configurable:!0}};ta.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},ta.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},ta.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Qo.prototype,ta);var ul=function(l){var t=new li({width:0,height:0}),e={},r=new Wo(0,0,{autoResize:!0});for(var n in l){var i=l[n],o=r.packOne(i.data.width+2,i.data.height+2);t.resize({width:r.w,height:r.h}),li.copy(i.data,t,{x:0,y:0},{x:o.x+1,y:o.y+1},i.data),e[n]=new Qo(o,i)}r.shrink(),t.resize({width:r.w,height:r.h}),this.image=t,this.positions=e};lr("ImagePosition",Qo),lr("ImageAtlas",ul);var ra=function(d,t,e,r,n){var i=8*n-r-1,s=(1<<i)-1,u=s>>1,l=-7,g=e?n-1:0,m=e?-1:1,h=d[t+g],y,x;for(g+=m,y=h&(1<<-l)-1,h>>=-l,l+=i;0<l;y=256*y+d[t+g],g+=m,l-=8);for(x=y&(1<<-l)-1,y>>=-l,l+=r;0<l;x=256*x+d[t+g],g+=m,l-=8);if(0===y)y=1-u;else{if(y===s)return x?NaN:1/0*(h?-1:1);x+=_a(2,r),y-=u}return(h?-1:1)*x*_a(2,y-r)},na=function(g,t,m,r,n,x){var o=8*x-n-1,b=(1<<o)-1,p=b>>1,c=23===n?_a(2,-24)-_a(2,-77):0,h=r?0:x-1,_=r?1:-1,y=0>t||0===t&&0>1/t?1:0,d,v,w;for(t=wa(t),isNaN(t)||t===1/0?(v=isNaN(t)?1:0,d=b):(d=ea(P(t)/E),1>t*(w=_a(2,-d))&&(d--,w*=2),2<=(t+=1<=d+p?c/w:c*_a(2,1-p))*w&&(d++,w/=2),d+p>=b?(v=0,d=b):1<=d+p?(v=(t*w-1)*_a(2,n),d+=p):(v=t*_a(2,p-1)*_a(2,n),d=0));8<=n;g[m+h]=255&v,h+=_,v/=256,n-=8);for(d=d<<n|v,o+=n;0<o;g[m+h]=255&d,h+=_,d/=256,o-=8);g[m+h-_]|=128*y},ia=Do;Do.Varint=0,Do.Fixed64=1,Do.Bytes=2,Do.Fixed32=5,Do.prototype={destroy:function(){this.buf=null},readFields:function(a,t,e){for(e=e||this.length;this.pos<e;){var i=this.readVarint(),n=this.pos;this.type=7&i,a(i>>3,t,this),this.pos===n&&this.skip(i)}return t},readMessage:function(a,t){return this.readFields(a,t,this.readVarint()+this.pos)},readFixed32:function(){var e=ga(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=ba(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=ga(this.buf,this.pos)+4294967296*ga(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=ga(this.buf,this.pos)+4294967296*ba(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=ra(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=ra(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(a){var t=this.buf,o,i;return o=127&(i=t[this.pos++]),128>i?o:(o|=(127&(i=t[this.pos++]))<<7,128>i?o:(o|=(127&(i=t[this.pos++]))<<14,128>i?o:(o|=(127&(i=t[this.pos++]))<<21,128>i?o:function(a,t,e){var r=e.buf,o,l;if(l=r[e.pos++],o=(112&l)>>4,128>l)return sa(a,o,t);if(l=r[e.pos++],o|=(127&l)<<3,128>l)return sa(a,o,t);if(l=r[e.pos++],o|=(127&l)<<10,128>l)return sa(a,o,t);if(l=r[e.pos++],o|=(127&l)<<17,128>l)return sa(a,o,t);if(l=r[e.pos++],o|=(127&l)<<24,128>l)return sa(a,o,t);if(l=r[e.pos++],o|=(1&l)<<31,128>l)return sa(a,o,t);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(i=t[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return 1==e%2?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,t=function(d,t,e){for(var r="",c=t;c<e;){var g=d[c],u=null,h=239<g?4:223<g?3:191<g?2:1,m,y,f;if(c+h>e)break;1==h?128>g&&(u=g):2==h?128==(192&(m=d[c+1]))&&127>=(u=(31&g)<<6|63&m)&&(u=null):3==h?(m=d[c+1],y=d[c+2],128==(192&m)&&128==(192&y)&&(2047>=(u=(15&g)<<12|(63&m)<<6|63&y)||55296<=u&&57343>=u)&&(u=null)):4==h&&(m=d[c+1],y=d[c+2],f=d[c+3],128==(192&m)&&128==(192&y)&&128==(192&f)&&(65535>=(u=(15&g)<<18|(63&m)<<12|(63&y)<<6|63&f)||1114112<=u)&&(u=null)),null===u?(u=65533,h=1):65535<u&&(u-=65536,r+=O(55296|1023&u>>>10),u=56320|1023&u),r+=O(u),c+=h}return r}(this.buf,this.pos,a);return this.pos=a,t},readBytes:function(){var a=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,a);return this.pos=a,t},readPackedVarint:function(a,o){var e=aa(this);for(a=a||[];this.pos<e;)a.push(this.readVarint(o));return a},readPackedSVarint:function(a){var o=aa(this);for(a=a||[];this.pos<o;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){var o=aa(this);for(a=a||[];this.pos<o;)a.push(this.readBoolean());return a},readPackedFloat:function(a){var o=aa(this);for(a=a||[];this.pos<o;)a.push(this.readFloat());return a},readPackedDouble:function(a){var o=aa(this);for(a=a||[];this.pos<o;)a.push(this.readDouble());return a},readPackedFixed32:function(a){var o=aa(this);for(a=a||[];this.pos<o;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){var o=aa(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){var o=aa(this);for(a=a||[];this.pos<o;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){var o=aa(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed64());return a},skip:function(a){var t=7&a;if(t===Do.Varint)for(;127<this.buf[this.pos++];);else if(t===Do.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Do.Fixed32)this.pos+=4;else{if(t!==Do.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(a,t){this.writeVarint(a<<3|t)},realloc:function(a){for(var t=this.length||16;t<this.pos+a;)t*=2;if(t!==this.length){var o=new Uint8Array(t);o.set(this.buf),this.buf=o,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),xa(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),xa(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),xa(this.buf,-1&e,this.pos),xa(this.buf,ea(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),xa(this.buf,-1&e,this.pos),xa(this.buf,ea(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){268435455<(e=+e||0)||0>e?function(a,t){var e,o;if(0<=a?(e=0|a%4294967296,o=0|a/4294967296):(o=~(-a/4294967296),4294967295^(e=~(-a%4294967296))?e=0|e+1:(e=0,o=0|o+1)),0x10000000000000000<=a||-0x10000000000000000>a)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(a,o,e){e.buf[e.pos++]=128|127&a,a>>>=7,e.buf[e.pos++]=128|127&a,a>>>=7,e.buf[e.pos++]=128|127&a,a>>>=7,e.buf[e.pos++]=128|127&a,a>>>=7,e.buf[e.pos]=127&a}(e,0,t),function(a,o){var e=(7&a)<<4;(o.buf[o.pos++]|=e|((a>>>=3)?128:0),!a)||(o.buf[o.pos++]=127&a|((a>>>=7)?128:0),!a)||(o.buf[o.pos++]=127&a|((a>>>=7)?128:0),!a)||(o.buf[o.pos++]=127&a|((a>>>=7)?128:0),!a)||(o.buf[o.pos++]=127&a|((a>>>=7)?128:0),!a)||(o.buf[o.pos++]=127&a)}(o,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(127<e?128:0),127>=e||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),127>=e||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),127>=e||(this.buf[this.pos++]=127&e>>>7))))},writeSVarint:function(e){this.writeVarint(0>e?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(a){a+="",this.realloc(4*a.length),this.pos++;var o=this.pos;this.pos=function(a,t,e){for(var l=0,s,d;l<t.length;l++){if(55295<(s=t.charCodeAt(l))&&57344>s){if(!d){56319<s||l+1===t.length?(a[e++]=239,a[e++]=191,a[e++]=189):d=s;continue}if(56320>s){a[e++]=239,a[e++]=191,a[e++]=189,d=s;continue}s=65536|(d-55296<<10|s-56320),d=null}else d&&(a[e++]=239,a[e++]=191,a[e++]=189,d=null);128>s?a[e++]=s:(2048>s?a[e++]=192|s>>6:(65536>s?a[e++]=224|s>>12:(a[e++]=240|s>>18,a[e++]=128|63&s>>12),a[e++]=128|63&s>>6),a[e++]=128|63&s)}return e}(this.buf,a,this.pos);var e=this.pos-o;128<=e&&ua(o,e,this),this.pos=o-1,this.writeVarint(e),this.pos+=e},writeFloat:function(e){this.realloc(4),na(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),na(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var t=a.length;this.writeVarint(t),this.realloc(t);for(var e=0;e<t;e++)this.buf[this.pos++]=a[e]},writeRawMessage:function(a,t){this.pos++;var e=this.pos;a(t,this);var o=this.pos-e;128<=o&&ua(e,o,this),this.pos=e-1,this.writeVarint(o),this.pos+=o},writeMessage:function(a,t,e){this.writeTag(a,Do.Bytes),this.writeRawMessage(t,e)},writePackedVarint:function(a,t){this.writeMessage(a,la,t)},writePackedSVarint:function(a,t){this.writeMessage(a,pa,t)},writePackedBoolean:function(a,t){this.writeMessage(a,fa,t)},writePackedFloat:function(a,t){this.writeMessage(a,ca,t)},writePackedDouble:function(a,t){this.writeMessage(a,ha,t)},writePackedFixed32:function(a,t){this.writeMessage(a,ya,t)},writePackedSFixed32:function(a,t){this.writeMessage(a,da,t)},writePackedFixed64:function(a,t){this.writeMessage(a,Kn,t)},writePackedSFixed64:function(a,t){this.writeMessage(a,ma,t)},writeBytesField:function(a,t){this.writeTag(a,Do.Bytes),this.writeBytes(t)},writeFixed32Field:function(a,t){this.writeTag(a,Do.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(a,t){this.writeTag(a,Do.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(a,t){this.writeTag(a,Do.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(a,t){this.writeTag(a,Do.Fixed64),this.writeSFixed64(t)},writeVarintField:function(a,t){this.writeTag(a,Do.Varint),this.writeVarint(t)},writeSVarintField:function(a,t){this.writeTag(a,Do.Varint),this.writeSVarint(t)},writeStringField:function(a,t){this.writeTag(a,Do.Bytes),this.writeString(t)},writeFloatField:function(a,t){this.writeTag(a,Do.Fixed32),this.writeFloat(t)},writeDoubleField:function(a,t){this.writeTag(a,Do.Fixed64),this.writeDouble(t)},writeBooleanField:function(a,t){this.writeVarintField(a,!!t)}};var oa=function(a,t,e){this.target=a,this.parent=t,this.mapId=e,this.callbacks={},this.callbackID=0,c(["receive"],this),this.target.addEventListener("message",this.receive,!1)};oa.prototype.send=function(a,t,e,r){var n=e?this.mapId+":"+this.callbackID++:null;e&&(this.callbacks[n]=e);var i=[];this.target.postMessage({targetMapId:r,sourceMapId:this.mapId,type:a,id:n+"",data:hr(t,i)},i)},oa.prototype.receive=function(l){var s=this,t=l.data,r=t.id,i;if(!t.targetMapId||this.mapId===t.targetMapId){var n=function(a,t){var e=[];s.target.postMessage({sourceMapId:s.mapId,type:"<response>",id:r+"",error:a?hr(a):null,data:hr(t,e)},e)};if("<response>"===t.type)i=this.callbacks[t.id],delete this.callbacks[t.id],i&&t.error?i(yr(t.error)):i&&i(null,yr(t.data));else if(void 0!==t.id&&this.parent[t.type])this.parent[t.type](t.sourceMapId,yr(t.data),n);else if(void 0!==t.id&&this.parent.getWorkerSource){var o=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,o[0],o[1])[o[2]](yr(t.data),n)}else this.parent[t.type](yr(t.data))}},oa.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)};var Ma=t(r(function(a,t){!function(a){function l(a,t,r){t=_a(2,r)-t-1;var n=s(256*a,256*t,r),i=s(256*(a+1),256*(t+1),r);return n[0]+","+n[1]+","+i[0]+","+i[1]}function s(a,t,e){var o=6378137*(2*Sa)/256/_a(2,e);return[a*o-6378137*(2*Sa)/2,t*o-6378137*(2*Sa)/2]}a.getURL=function(e,t,r,n,i,o){return o=o||{},e+"?"+["bbox="+l(r,n,i),"format="+(o.format||"image/png"),"service="+(o.service||"WMS"),"version="+(o.version||"1.1.1"),"request="+(o.request||"GetMap"),"srs="+(o.srs||"EPSG:3857"),"width="+(o.width||256),"height="+(o.height||256),"layers="+t].join("&")},a.getTileBBox=l,a.getMercCoords=s,Object.defineProperty(a,"__esModule",{value:!0})}(t)})),Va=function(a,t,e){this.z=a,this.x=t,this.y=e,this.key=za(0,a,t,e)};Va.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Va.prototype.url=function(a,t){var e=Ma.getTileBBox(this.x,this.y,this.z),o=function(a,t,e){for(var r="",l=a,s;0<l;l--)r+=(t&(s=1<<l-1)?1:0)+(e&s?2:0);return r}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",this.z+"").replace("{x}",this.x+"").replace("{y}",("tms"===t?_a(2,this.z)-this.y-1:this.y)+"").replace("{quadkey}",o).replace("{bbox-epsg-3857}",e)};var Ba=function(a,t){this.wrap=a,this.canonical=t,this.key=za(a,t.z,t.x,t.y)},Ca=function(a,t,e,o,r){this.overscaledZ=a,this.wrap=t,this.canonical=new Va(e,+o,+r),this.key=za(t,a,o,r)};Ca.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Ca.prototype.scaledTo=function(a){var t=this.canonical.z-a;return a>this.canonical.z?new Ca(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ca(a,this.wrap,a,this.canonical.x>>t,this.canonical.y>>t)},Ca.prototype.isChildOf=function(a){var t=this.canonical.z-a.canonical.z;return 0===a.overscaledZ||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>t&&a.canonical.y===this.canonical.y>>t},Ca.prototype.children=function(a){if(this.overscaledZ>=a)return[new Ca(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,e=2*this.canonical.x,o=2*this.canonical.y;return[new Ca(t,this.wrap,t,e,o),new Ca(t,this.wrap,t,e+1,o),new Ca(t,this.wrap,t,e,o+1),new Ca(t,this.wrap,t,e+1,o+1)]},Ca.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Ca.prototype.wrapped=function(){return new Ca(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Ca.prototype.unwrapTo=function(e){return new Ca(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Ca.prototype.overscaleFactor=function(){return _a(2,this.overscaledZ-this.canonical.z)},Ca.prototype.toUnwrapped=function(){return new Ba(this.wrap,this.canonical)},Ca.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Ca.prototype.toCoordinate=function(){return new ol(this.canonical.x+_a(2,this.wrap),this.canonical.y,this.canonical.z)},lr("CanonicalTileID",Va),lr("OverscaledTileID",Ca,{omit:["posMatrix"]});var Ia=function(a,t,e){if(0>=a)throw new RangeError("Level must have positive dimension");this.dim=a,this.border=t,this.stride=this.dim+2*this.border,this.data=e||new Int32Array((this.dim+2*this.border)*(this.dim+2*this.border))};Ia.prototype.set=function(a,t,e){this.data[this._idx(a,t)]=e+65536},Ia.prototype.get=function(a,t){return this.data[this._idx(a,t)]-65536},Ia.prototype._idx=function(a,t){if(a<-this.border||a>=this.dim+this.border||t<-this.border||t>=this.dim+this.border)throw new RangeError("out of range source coordinates for DEM data");return(t+this.border)*this.stride+(a+this.border)},lr("Level",Ia);var Fa=function(a,t,e){this.uid=a,this.scale=t||1,this.level=e||new Ia(256,512),this.loaded=!!e};Fa.prototype.loadFromImage=function(a,t){if(a.height!==a.width)throw new RangeError("DEM tiles must be square");if(t&&"mapbox"!==t&&"terrarium"!==t)return Qt("\""+t+"\" is not a valid encoding type. Valid types include \"mapbox\" and \"terrarium\".");var e=this.level=new Ia(a.width,a.width/2),o=a.data;this._unpackData(e,o,t||"mapbox");for(var r=0;r<e.dim;r++)e.set(-1,r,e.get(0,r)),e.set(e.dim,r,e.get(e.dim-1,r)),e.set(r,-1,e.get(r,0)),e.set(r,e.dim,e.get(r,e.dim-1));e.set(-1,-1,e.get(0,0)),e.set(e.dim,-1,e.get(e.dim-1,0)),e.set(-1,e.dim,e.get(0,e.dim-1)),e.set(e.dim,e.dim,e.get(e.dim-1,e.dim-1)),this.loaded=!0},Fa.prototype._unpackMapbox=function(a,t,e){return(256*(256*a)+256*t+e)/10-1e4},Fa.prototype._unpackTerrarium=function(a,t,e){return 256*a+t+e/256-32768},Fa.prototype._unpackData=function(l,t,e){for(var r={mapbox:this._unpackMapbox,terrarium:this._unpackTerrarium}[e],n=0;n<l.dim;n++)for(var s=0,d;s<l.dim;s++)d=4*(n*l.dim+s),l.set(s,n,this.scale*r(t[d],t[d+1],t[d+2]))},Fa.prototype.getPixels=function(){return new li({width:this.level.dim+2*this.level.border,height:this.level.dim+2*this.level.border},new Uint8Array(this.level.data.buffer))},Fa.prototype.backfillBorder=function(c,t,e){var r=this.level,n=c.level;if(r.dim!==n.dim)throw new Error("level mismatch (dem dimension)");var i=t*r.dim,g=t*r.dim+r.dim,x=e*r.dim,b=e*r.dim+r.dim;-1===t?i=g-1:1===t?g=i+1:void 0,-1===e?x=b-1:1===e?b=x+1:void 0;for(var _=$t(i,-r.border,r.dim+r.border),l=$t(g,-r.border,r.dim+r.border),p=$t(x,-r.border,r.dim+r.border),h=$t(b,-r.border,r.dim+r.border),f=-t*r.dim,y=-e*r.dim,d=p;d<h;d++)for(var w=_;w<l;w++)r.set(w,d,n.get(w+f,d+y))},lr("DEMData",Fa);var Pa=function(a){this._stringToNumber={},this._numberToString=[];for(var t=0,o;t<a.length;t++)o=a[t],this._stringToNumber[o]=t,this._numberToString[t]=o};Pa.prototype.encode=function(e){return this._stringToNumber[e]},Pa.prototype.decode=function(e){return this._numberToString[e]};var Ta=function(a,t,e,o){this.type="Feature",this._vectorTileFeature=a,a._z=t,a._x=e,a._y=o,this.properties=a.properties,null!=a.id&&(this.id=a.id)},Oa={geometry:{configurable:!0}};Oa.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Oa.geometry.set=function(e){this._geometry=e},Ta.prototype.toJSON=function(){var a={geometry:this.geometry};for(var t in this)"_geometry"!=t&&"_vectorTileFeature"!=t&&(a[t]=this[t]);return a},Object.defineProperties(Ta.prototype,Oa);var La=function(a,t,e){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=t||new or(8192,16,0),this.featureIndexArray=e||new _n};La.prototype.insert=function(d,t,e,r,n){var i=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(e,r,n);for(var o=0;o<t.length;o++){for(var c=t[o],s=[1/0,1/0,-1/0,-1/0],u=0,g;u<c.length;u++)g=c[u],s[0]=ie(s[0],g.x),s[1]=ie(s[1],g.y),s[2]=va(s[2],g.x),s[3]=va(s[3],g.y);8192>s[0]&&8192>s[1]&&0<=s[2]&&0<=s[3]&&this.grid.insert(i,s[0],s[1],s[2],s[3])}},La.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new co.VectorTile(new ia(this.rawTileData)).layers,this.sourceLayerCoder=new Pa(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},La.prototype.query=function(_,t){var w=this;this.loadVTLayers();for(var e=_.params||{},r=8192/_.tileSize/_.scale,i=Fe(e.filter),o=_.queryGeometry,a=_.queryPadding*r,n=1/0,s=1/0,k=-1/0,T=-1/0,A=0;A<o.length;A++)for(var S=o[A],f=0,C;f<S.length;f++)C=S[f],n=ie(n,C.x),s=ie(s,C.y),k=va(k,C.x),T=va(T,C.y);var L=this.grid.query(n-a,s-a,k+a,T+a);L.sort(Ea);for(var v={},g=function(a){var n=L[a];if(n!==E){E=n;var s=w.featureIndexArray.get(n),l=null;w.loadMatchingFeature(v,s.bucketIndex,s.sourceLayerIndex,s.featureIndex,i,e.layers,t,function(t,e){return l||(l=Mn(t)),e.queryIntersectsFeature(o,t,l,w.z,_.transform,r,_.posMatrix)})}},x=0,E;x<L.length;x++)g(x);return v},La.prototype.loadMatchingFeature=function(g,t,e,r,n,i,o,a){var s=this.bucketLayerIDs[t];if(!i||function(a,t){for(var e=0;e<a.length;e++)if(0<=t.indexOf(a[e]))return!0;return!1}(i,s)){var u=this.sourceLayerCoder.decode(e),l=this.vtLayers[u].feature(r);if(n(new Vr(this.tileID.overscaledZ),l))for(var p=0,m;p<s.length;p++)if(m=s[p],!(i&&0>i.indexOf(m))){var x=o[m];if(x&&(!a||a(l,x))){var f=new Ta(l,this.z,this.x,this.y);f.layer=x.serialize();var y=g[m];void 0===y&&(y=g[m]=[]),y.push({featureIndex:r,feature:f})}}}},La.prototype.lookupSymbolFeatures=function(d,t,e,r,n,i){var o={};this.loadVTLayers();for(var a=Fe(r),s=0,c=d,l;s<c.length;s+=1)l=c[s],this.loadMatchingFeature(o,t,e,l,a,n,i);return o},La.prototype.hasLayer=function(a){for(var t=0,o=this.bucketLayerIDs;t<o.length;t+=1)for(var r=0,l=o[t];r<l.length;r+=1)if(a===l[r])return!0;return!1},lr("FeatureIndex",La,{omit:["rawTileData","sourceLayerCoder"]});var ja={horizontal:1,vertical:2,horizontalOnly:3},Ra={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ua={};Ua[10]=!0,Ua[32]=!0,Ua[38]=!0,Ua[40]=!0,Ua[41]=!0,Ua[43]=!0,Ua[45]=!0,Ua[47]=!0,Ua[173]=!0,Ua[183]=!0,Ua[8203]=!0,Ua[8208]=!0,Ua[8211]=!0,Ua[8231]=!0,ue.commonjsGlobal=Ha,ue.unwrapExports=t,ue.createCommonjsModule=r,ue.default=self,ue.default$1=rl,ue.getJSON=function(a,o){var e=Ga(a);return e.setRequestHeader("Accept","application/json"),e.onerror=function(){o(new Error(e.statusText))},e.onload=function(){if(200<=e.status&&300>e.status&&e.response){var t;try{t=JSON.parse(e.response)}catch(e){return o(e)}o(null,t)}else 401===e.status&&a.url.match(/mapbox.com/)?o(new x(e.statusText+": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens",e.status,a.url)):o(new x(e.statusText,e.status,a.url))},e.send(),e},ue.getImage=function(a,l){return A(a,function(e,t){if(e)l(e);else if(t){var a=new self.Image,r=self.URL||self.webkitURL;a.onload=function(){l(null,a),r.revokeObjectURL(a.src)};var i=new self.Blob([new Uint8Array(t.data)],{type:"image/png"});a.cacheControl=t.cacheControl,a.expires=t.expires,a.src=t.data.byteLength?r.createObjectURL(i):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})},ue.ResourceType=p,ue.RGBAImage=li,ue.default$2=Wo,ue.ImagePosition=Qo,ue.getArrayBuffer=A,ue.default$3=function(e){return new ia(e).readFields(el,[])},ue.default$4=vr,ue.asyncAll=function(a,l,s){if(!a.length)return s(null,[]);var r=a.length,d=Array(a.length),i=null;a.forEach(function(e,o){l(e,function(a,t){a&&(i=a),d[o]=t,0==--r&&s(i,d)})})},ue.AlphaImage=oi,ue.default$5=I,ue.endsWith=h,ue.extend=l,ue.sphericalToCartesian=function(a){var t=a[0],e=a[1],o=a[2];return e+=90,e*=Sa/180,o*=Sa/180,{x:t*te(e)*M(o),y:t*M(e)*M(o),z:t*te(o)}},ue.Evented=C,ue.validateStyle=Ge,ue.validateLight=rr,ue.emitValidationErrors=er,ue.default$6=W,ue.number=xt,ue.Properties=Ur,ue.Transitionable=Ir,ue.Transitioning=Fr,ue.PossiblyEvaluated=Or,ue.DataConstantProperty=Lr,ue.warnOnce=Qt,ue.uniqueId=function(){return i++},ue.default$7=oa,ue.pick=function(a,t){for(var e={},o=0,r;o<t.length;o++)r=t[o],r in a&&(e[r]=a[r]);return e},ue.wrap=function(a,t,e){var o=e-t,r=((a-t)%o+o)%o+t;return r===t?e:r},ue.clamp=$t,ue.Event=S,ue.ErrorEvent=B,ue.OverscaledTileID=Ca,ue.default$8=8192,ue.createLayout=_r,ue.getCoordinatesCenter=function(a){for(var t=1/0,d=1/0,c=-1/0,g=-1/0,h=0;h<a.length;h++)t=ie(t,a[h].column),d=ie(d,a[h].row),c=va(c,a[h].column),g=va(g,a[h].row);var m=c-t,s=g-d,u=va(m,s),l=va(0,ea(-P(u)/E));return new ol((t+c)/2,(d+g)/2,0).zoomTo(l)},ue.CanonicalTileID=Va,ue.RasterBoundsArray=Xr,ue.getVideo=function(l,t){var e=self.document.createElement("video"),i,s;e.onloadstart=function(){t(null,e)};for(var d=0,c;d<l.length;d++)c=self.document.createElement("source"),i=l[d],s=void 0,(s=self.document.createElement("a")).href=i,(s.protocol!==self.document.location.protocol||s.host!==self.document.location.host)&&(e.crossOrigin="Anonymous"),c.src=l[d],e.appendChild(c);return e},ue.default$9=il,ue.bindAll=c,ue.default$10=function a(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var o=0;o<t.length;o++)if(!a(t[o],e[o]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var r in t)if(!a(t[r],e[r]))return!1;return!0}return t===e},ue.parseCacheControl=function(a){var l={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(e,t,a,r){var i=a||r;return l[t]=!i||i.toLowerCase(),""}),l["max-age"]){var e=parseInt(l["max-age"],10);isNaN(e)?delete l["max-age"]:l["max-age"]=e}return l},ue.default$11=La,ue.default$12=Ta,ue.default$13=Fe,ue.default$14=Zo,ue.CollisionBoxArray=yn,ue.default$15=kn,ue.TriangleIndexArray=ln,ue.default$16=Vr,ue.default$17=ol,ue.keysDifference=function(a,t){var e=[];for(var o in a)o in t||e.push(o);return e},ue.default$18=["type","source","source-layer","minzoom","maxzoom","filter","layout"],ue.mat4=ei,ue.vec4=ti,ue.getSizeData=To,ue.evaluateSizeForFeature=function(a,t,e){var o=t;return"source"===a.functionType?e.lowerSize/10:"composite"===a.functionType?xt(e.lowerSize/10,e.upperSize/10,o.uSizeT):o.uSize},ue.evaluateSizeForZoom=function(l,t,e){if("constant"===l.functionType)return{uSizeT:0,uSize:l.layoutSize};if("source"===l.functionType)return{uSizeT:0,uSize:0};if("camera"===l.functionType){var r=l.propertyValue,n=l.zoomRange,i=l.sizeRange,o=$t(ke(r,e.specification).interpolationFactor(t,n.min,n.max),0,1);return{uSizeT:0,uSize:i.min+o*(i.max-i.min)}}var a=l.propertyValue,s=l.zoomRange;return{uSizeT:$t(ke(a,e.specification).interpolationFactor(t,s.min,s.max),0,1),uSize:0}},ue.addDynamicAttributes=Uo,ue.default$19=Jo,ue.WritingMode=ja,ue.multiPolygonIntersectsBufferedPoint=jn,ue.multiPolygonIntersectsMultiPolygon=Rn,ue.multiPolygonIntersectsBufferedMultiLine=Fn,ue.polygonIntersectsPolygon=function(a,t){for(var e=0;e<a.length;e++)if(Hn(t,a[e]))return!0;for(var o=0;o<t.length;o++)if(Hn(a,t[o]))return!0;return!!Nn(a,t)},ue.distToSegmentSquared=Jn,ue.default$20=Qn,ue.default$21=Dr,ue.default$22=function(e){return new Yo[e.type](e)},ue.clone=m,ue.filterObject=y,ue.mapObject=d,ue.registerForPluginAvailability=function(e){return ll?e({pluginURL:ll,completionCallback:Br}):dl.once("pluginAvailable",e),e},ue.evented=dl,ue.default$23=fr,ue.default$24=Cn,ue.PosArray=Jr,ue.UnwrappedTileID=Ba,ue.ease=e,ue.bezier=u,ue.setRTLTextPlugin=function(a,o){if(mr)throw new Error("setRTLTextPlugin cannot be called multiple times.");mr=!0,ll=a,Br=function(e){e?(mr=!1,ll=null,o&&o(e)):sl=!0},dl.fire(new S("pluginAvailable",{pluginURL:ll,completionCallback:Br}))},ue.values=function(a){var t=[];for(var e in a)t.push(a[e]);return t},ue.default$25=Oo,ue.register=lr,ue.GLYPH_PBF_BORDER=3,ue.shapeText=function(d,t,e,r,n,i,o,a,s,u){var l=d.trim();u===ja.vertical&&(l=function(a){for(var t="",o=0;o<a.length;o++){var l=a.charCodeAt(o+1)||null,n=a.charCodeAt(o-1)||null;t+=l&&br(l)&&!Po[a[o+1]]||n&&br(n)&&!Po[a[o-1]]||!Po[a[o]]?a[o]:Po[a[o]]}return t}(l));var g=[],c={positionedGlyphs:g,text:l,top:a[1],bottom:a[1],left:a[0],right:a[0],writingMode:u},h=Mr.processBidirectionalText;return function(T,t,e,r,n,i,o,a,s){for(var u=0,S=-17,C=0,L=T.positionedGlyphs,h="right"===i?1:"left"===i?0:.5,f=0,E=e,d;f<E.length;f+=1)if(d=E[f],(d=d.trim()).length){for(var I=L.length,m=0;m<d.length;m++){var D=d.charCodeAt(m),x=t[D];x&&(xr(D)&&o!==ja.horizontal?(L.push({glyph:D,x:u,y:0,vertical:!0}),u+=s+a):(L.push({glyph:D,x:u,y:S,vertical:!1}),u+=x.metrics.advance+a))}if(L.length!==I){var b=u-a;C=va(b,C),$a(L,t,I,L.length-1,h)}u=0,S+=r}else S+=r;var w=Ja(n),_=w.horizontalAlign,A=w.verticalAlign;!function(s,t,e,r,n,i,o){for(var a=0;a<s.length;a++)s[a].x+=(t-e)*n,s[a].y+=(-r*o+.5)*i}(L,h,_,A,C,r,e.length);var k=e.length*r;T.top+=-A*k,T.bottom=T.top+k,T.left+=-_*C,T.right=T.left+C}(c,t,h?h(l,Ka(l,o,e,t)):function(l,t){for(var e=[],r=0,s=0,d=t,o;s<d.length;s+=1)o=d[s],e.push(l.substring(r,o)),r=o;return r<l.length&&e.push(l.substring(r,l.length)),e}(l,Ka(l,o,e,t)),r,n,i,u,o,s),!!g.length&&c},ue.shapeIcon=function(d,t,e){var r=Ja(e),n=r.horizontalAlign,i=r.verticalAlign,o=t[0],a=t[1],s=o-d.displaySize[0]*n,c=s+d.displaySize[0],l=a-d.displaySize[1]*i;return{image:d,top:l,bottom:l+d.displaySize[1],left:s,right:c}},ue.allowsVerticalWritingMode=dr,ue.allowsLetterSpacing=function(a){for(var t=0,o=a;t<o.length;t+=1)if(!gr(o[t].charCodeAt(0)))return!1;return!0},ue.default$26=Ji,ue.default$27=Pa,ue.default$28=ul,ue.default$29=co,ue.default$30=ia,ue.default$31=Fa,ue.__moduleExports=co,ue.default$32=rl,ue.__moduleExports$1=ia,ue.plugin=Mr}),e(["./chunk1.js"],function(Ue){function u(t){var e=typeof t;if("number"==e||"boolean"==e||"string"==e||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var i="[",d=0,c=t;d<c.length;d+=1)i+=u(c[d])+",";return i+"]"}for(var o=Object.keys(t).sort(),a="{",p=0;p<o.length;p++)a+=JSON.stringify(o[p])+":"+u(t[o[p]])+",";return a+"}"}function Y(e){for(var t="",a=0,i=Ue.default$18;a<i.length;a+=1)t+="/"+u(e[i[a]]);return t}function e(d,e,t,i,r){if(void 0===e.segment)return!0;for(var n=e,g=e.segment+1,m=0;m>-t/2;){if(0>--g)return!1;m-=d[g].dist(n),n=d[g]}m+=d[g].dist(d[g+1]),g++;for(var y=[],l=0;m<t/2;){var x=d[g-1],h=d[g],c=d[g+1];if(!c)return!1;var f=x.angleTo(h)-h.angleTo(c);for(f=wa((f+3*Sa)%(2*Sa)-Sa),y.push({distance:m,angleDelta:f}),l+=f;m-y[0].distance>i;)l-=y.shift().angleDelta;if(l>r)return!1;g++,m+=h.dist(c)}return!0}function i(n,t,d,r,o,a,s,l,u){var g=r?.6*a*s:0,c=va(r?r.right-r.left:0,o?o.right-o.left:0),h=0===n[0].x||n[0].x===u||0===n[0].y||n[0].y===u;return t-c*s<t/4&&(t=c*s+t/4),function n(t,i,r,o,a,s,l,u,h){for(var c=s/2,f=0,k=0;k<t.length-1;k++)f+=t[k].dist(t[k+1]);for(var T=0,A=i-r,C=[],L=0;L<t.length-1;L++){for(var E=t[L],x=t[L+1],w=E.dist(x),S=x.angleTo(E);A+r<T+w;){var D=((A+=r)-T)/w,b=Ue.number(E.x,x.x,D),_=Ue.number(E.y,x.y,D);if(0<=b&&b<h&&0<=_&&_<h&&0<=A-c&&A+c<=f){var I=new Ue.default$25(b,_,S,L);I._round(),o&&!e(t,I,s,o,a)||C.push(I)}}T+=w}return u||C.length||l||(C=n(t,T/2,r,o,a,s,l,!0,h)),C}(n,h?t/2*l%t:(c/2+2*a)*s*l%t,t,g,d,c*s,h,!1,u)}function o(a,e){if(!(this instanceof o))return new o(a,e);if(this.data=a||[],this.length=this.data.length,this.compare=e||n,0<this.length)for(var t=(this.length>>1)-1;0<=t;t--)this._down(t)}function n(a,e){return a<e?-1:a>e?1:0}function t(e,t,l){void 0===t&&(t=1),void 0===l&&(l=!1);for(var d=1/0,p=1/0,_=-1/0,k=-1/0,T=e[0],u=0,A;u<T.length;u++)A=T[u],(!u||A.x<d)&&(d=A.x),(!u||A.y<p)&&(p=A.y),(!u||A.x>_)&&(_=A.x),(!u||A.y>k)&&(k=A.y);var C=_-d,f=k-p,g=ie(C,f),v=g/2,L=new Ke(null,W);if(0===g)return new Ue.default$1(d,p);for(var m=d;m<_;m+=g)for(var E=p;E<k;E+=g)L.push(new c(m+v,E+v,v,e));for(var z=function(d){for(var e=0,p=0,g=0,m=d[0],n=0,y=m.length,a=y-1;n<y;a=n++){var f=m[n],l=m[a],u=f.x*l.y-l.x*f.y;p+=(f.x+l.x)*u,g+=(f.y+l.y)*u,e+=3*u}return new c(p/e,g/e,0,d)}(e),I=L.length,D;L.length;)D=L.pop(),(D.d>z.d||!z.d)&&(z=D,l&&console.log("found best %d after %d probes",R(1e4*D.d)/1e4,I)),D.max-z.d<=t||(v=D.h/2,L.push(new c(D.p.x-v,D.p.y-v,v,e)),L.push(new c(D.p.x+v,D.p.y-v,v,e)),L.push(new c(D.p.x-v,D.p.y+v,v,e)),L.push(new c(D.p.x+v,D.p.y+v,v,e)),I+=4);return l&&(console.log("num probes: "+I),console.log("best distance: "+z.d)),z.p}function W(a,e){return e.max-a.max}function c(e,t,a,o){this.p=new Ue.default$1(e,t),this.h=a,this.d=function(e,t){for(var i=!1,d=1/0,p=0;p<t.length;p++)for(var g=t[p],a=0,m=g.length,l=m-1;a<m;l=a++){var y=g[a],h=g[l];y.y>e.y!=h.y>e.y&&e.x<(h.x-y.x)*(e.y-y.y)/(h.y-y.y)+y.x&&(i=!i),d=ie(d,Ue.distToSegmentSquared(e,y,h))}return(i?1:-1)*re(d)}(this.p,o),this.max=this.d+this.h*w}function d(e,t,i,r,n,o){e.createArrays(),e.symbolInstances=[];var a=512*e.overscaling;e.tilePixelRatio=Ue.default$8/a,e.compareText={},e.iconsNeedLinear=!1;var s=e.layers[0].layout,l=e.layers[0]._unevaluatedLayout._values,u={};if("composite"===e.textSizeData.functionType){var h=e.textSizeData.zoomRange,c=h.min,f=h.max;u.compositeTextSizes=[l["text-size"].possiblyEvaluate(new Ue.default$16(c)),l["text-size"].possiblyEvaluate(new Ue.default$16(f))]}if("composite"===e.iconSizeData.functionType){var v=e.iconSizeData.zoomRange,d=v.min,g=v.max;u.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new Ue.default$16(d)),l["icon-size"].possiblyEvaluate(new Ue.default$16(g))]}u.layoutTextSize=l["text-size"].possiblyEvaluate(new Ue.default$16(e.zoom+1)),u.layoutIconSize=l["icon-size"].possiblyEvaluate(new Ue.default$16(e.zoom+1)),u.textMaxSize=l["text-size"].possiblyEvaluate(new Ue.default$16(18));for(var y=24*s.get("text-line-height"),m="map"===s.get("text-rotation-alignment")&&"line"===s.get("symbol-placement"),x=s.get("text-keep-upright"),w=0,R=e.features;w<R.length;w+=1){var M=R[w],b=s.get("text-font").evaluate(M).join(","),_=t[b]||{},I=i[b]||{},z={},T=M.text;if(T){var P=s.get("text-offset").evaluate(M).map(function(t){return 24*t}),k=24*s.get("text-letter-spacing").evaluate(M),L=Ue.allowsLetterSpacing(T)?k:0,j=s.get("text-anchor").evaluate(M),D=s.get("text-justify").evaluate(M),O="line"===s.get("symbol-placement")?0:24*s.get("text-max-width").evaluate(M);z.horizontal=Ue.shapeText(T,_,O,y,j,D,L,P,24,Ue.WritingMode.horizontal),Ue.allowsVerticalWritingMode(T)&&m&&x&&(z.vertical=Ue.shapeText(T,_,O,y,j,D,L,P,24,Ue.WritingMode.vertical))}var C=void 0;if(M.icon){var B=r[M.icon];B&&(C=Ue.shapeIcon(n[M.icon],s.get("icon-offset").evaluate(M),s.get("icon-anchor").evaluate(M)),void 0===e.sdfIcons?e.sdfIcons=B.sdf:e.sdfIcons!==B.sdf&&Ue.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),B.pixelRatio===e.pixelRatio?0!==s.get("icon-rotate").constantOr(1)&&(e.iconsNeedLinear=!0):e.iconsNeedLinear=!0)}(z.horizontal||C)&&p(e,M,z,C,I,u)}o&&e.generateCollisionDebugBuffers()}function p(e,s,m,r,n,l){var o=l.layoutTextSize.evaluate(s),u=l.layoutIconSize.evaluate(s),c=l.textMaxSize.evaluate(s);void 0===c&&(c=o);var h=e.layers[0].layout,d=h.get("text-offset").evaluate(s),y=h.get("icon-offset").evaluate(s),f=e.tilePixelRatio*(o/24),x=e.tilePixelRatio*c/24,v=e.tilePixelRatio*u,w=e.tilePixelRatio*h.get("symbol-spacing"),b=h.get("text-padding")*e.tilePixelRatio,_=h.get("icon-padding")*e.tilePixelRatio,k=h.get("text-max-angle")/180*Sa,S="map"===h.get("text-rotation-alignment")&&"line"===h.get("symbol-placement"),T="map"===h.get("icon-rotation-alignment")&&"line"===h.get("symbol-placement"),z=function(t,o){0>o.x||o.x>=Ue.default$8||0>o.y||o.y>=Ue.default$8||e.symbolInstances.push(function(e,t,i,r,n,o,l,s,u,c,h,p,d,g,y,m,f,x,v,w,b){var _=e.addToLineVertexArray(t,i),T=0,S=0,j=0,V=r.horizontal?r.horizontal.text:"",U=[],D,H;r.horizontal&&(D=new a(l,i,t,s,u,c,r.horizontal,h,p,d,e.overscaling),S+=J(e,t,r.horizontal,o,d,v,g,_,r.vertical?Ue.WritingMode.horizontal:Ue.WritingMode.horizontalOnly,U,w,b),r.vertical&&(j+=J(e,t,r.vertical,o,d,v,g,_,Ue.WritingMode.vertical,U,w,b)));var Y=D?D.boxStartIndex:e.collisionBoxArray.length,O=D?D.boxEndIndex:e.collisionBoxArray.length;if(n){var C=function(e,t,i,r,n,o){var a=t.image,c=i.layout,f=t.top-1/a.pixelRatio,p=t.left-1/a.pixelRatio,d=t.bottom+1/a.pixelRatio,g=t.right+1/a.pixelRatio,v,R,j,B;if("none"!==c.get("icon-text-fit")&&n){var F=g-p,y=d-f,m=c.get("text-size").evaluate(o)/24,x=n.left*m,w=n.right*m,S=n.top*m,N=w-x,b=n.bottom*m-S,_=c.get("icon-text-fit-padding")[0],I=c.get("icon-text-fit-padding")[1],z=c.get("icon-text-fit-padding")[2],T=c.get("icon-text-fit-padding")[3],P="width"===c.get("icon-text-fit")?.5*(b-y):0,k="height"===c.get("icon-text-fit")?.5*(N-F):0,L="width"===c.get("icon-text-fit")||"both"===c.get("icon-text-fit")?N:F,V="height"===c.get("icon-text-fit")||"both"===c.get("icon-text-fit")?b:y;v=new Ue.default$1(x+k-T,S+P-_),R=new Ue.default$1(x+k+I+L,S+P-_),j=new Ue.default$1(x+k+I+L,S+P+z+V),B=new Ue.default$1(x+k-T,S+P+z+V)}else v=new Ue.default$1(p,f),R=new Ue.default$1(g,f),j=new Ue.default$1(g,d),B=new Ue.default$1(p,d);var D=i.layout.get("icon-rotate").evaluate(o)*Sa/180;if(D){var O=M(D),C=te(D),A=[C,-O,O,C];v._matMult(A),R._matMult(A),B._matMult(A),j._matMult(A)}return[{tl:v,tr:R,bl:B,br:j,tex:a.paddedRect,writingMode:void 0,glyphOffset:[0,0]}]}(0,n,o,0,r.horizontal,v);H=new a(l,i,t,s,u,c,n,y,m,!1,e.overscaling),T=4*C.length;var A=e.iconSizeData,E=null;"source"===A.functionType?E=[10*o.layout.get("icon-size").evaluate(v)]:"composite"===A.functionType&&(E=[10*b.compositeIconSizes[0].evaluate(v),10*b.compositeIconSizes[1].evaluate(v)]),e.addSymbols(e.icon,C,E,x,f,v,!1,t,_.lineStartIndex,_.lineLength)}var q=H?H.boxStartIndex:e.collisionBoxArray.length,R=H?H.boxEndIndex:e.collisionBoxArray.length;e.glyphOffsetArray.length>=Ue.default$14.MAX_GLYPHS&&Ue.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907");var B=new Je,F=new Je;return{key:V,textBoxStartIndex:Y,textBoxEndIndex:O,iconBoxStartIndex:q,iconBoxEndIndex:R,textOffset:g,iconOffset:x,anchor:t,line:i,featureIndex:s,feature:v,numGlyphVertices:S,numVerticalGlyphVertices:j,numIconVertices:T,textOpacityState:B,iconOpacityState:F,isDuplicate:!1,placedTextSymbolIndices:U,crossTileID:0}}(e,o,t,m,r,e.layers[0],e.collisionBoxArray,s.index,s.sourceLayerIndex,e.index,f,b,S,d,v,_,T,y,s,n,l))};if("line"===h.get("symbol-placement"))for(var L=0,I=function(e,t,i,r,n){for(var o=[],a=0;a<e.length;a++)for(var d=e[a],l=void 0,p=0;p<d.length-1;p++){var g=d[p],m=d[p+1];g.x<t&&m.x<t||(g.x<t?g=new Ue.default$1(t,g.y+(m.y-g.y)*((t-g.x)/(m.x-g.x)))._round():m.x<t&&(m=new Ue.default$1(t,g.y+(m.y-g.y)*((t-g.x)/(m.x-g.x)))._round()),g.y<i&&m.y<i||(g.y<i?g=new Ue.default$1(g.x+(m.x-g.x)*((i-g.y)/(m.y-g.y)),i)._round():m.y<i&&(m=new Ue.default$1(g.x+(m.x-g.x)*((i-g.y)/(m.y-g.y)),i)._round()),g.x>=r&&m.x>=r||(g.x>=r?g=new Ue.default$1(r,g.y+(m.y-g.y)*((r-g.x)/(m.x-g.x)))._round():m.x>=r&&(m=new Ue.default$1(r,g.y+(m.y-g.y)*((r-g.x)/(m.x-g.x)))._round()),g.y>=n&&m.y>=n||(g.y>=n?g=new Ue.default$1(g.x+(m.x-g.x)*((n-g.y)/(m.y-g.y)),n)._round():m.y>=n&&(m=new Ue.default$1(g.x+(m.x-g.x)*((n-g.y)/(m.y-g.y)),n)._round()),l&&g.equals(l[l.length-1])||(l=[g],o.push(l)),l.push(m)))))}return o}(s.geometry,0,0,Ue.default$8,Ue.default$8);L<I.length;L+=1)for(var D=I[L],P=0,O=i(D,w,k,m.vertical||m.horizontal,r,24,x,e.overscaling,Ue.default$8);P<O.length;P+=1){var A=O[P],E=m.horizontal;E&&g(e,E.text,w/2,A)||z(D,A)}else if("Polygon"===s.type)for(var N=0,U=Ue.default$26(s.geometry,0);N<U.length;N+=1){var B=U[N],F=t(B,16);z(B[0],new Ue.default$25(F.x,F.y,0))}else if("LineString"===s.type)for(var H=0,G=s.geometry,K;H<G.length;H+=1)K=G[H],z(K,new Ue.default$25(K[0].x,K[0].y,0));else if("Point"===s.type)for(var Q=0,ee=s.geometry;Q<ee.length;Q+=1)for(var Z=0,ae=ee[Q],X;Z<ae.length;Z+=1)X=ae[Z],z([X],new Ue.default$25(X.x,X.y,0))}function J(e,t,i,r,n,o,a,s,l,u,h,c){var m=function(e,t,i,r,n,o){for(var a=i.layout.get("text-rotate").evaluate(n)*Sa/180,s=i.layout.get("text-offset").evaluate(n).map(function(t){return 24*t}),l=t.positionedGlyphs,u=[],h=0;h<l.length;h++){var A=l[h],f=o[A.glyph];if(f){var p=f.rect;if(p){var d=Ue.GLYPH_PBF_BORDER+1,g=f.metrics.advance/2,v=r?[A.x+g,A.y]:[0,0],y=r?[0,0]:[A.x+g+s[0],A.y+s[1]],m=f.metrics.left-d-g+y[0],x=-f.metrics.top-d+y[1],w=m+p.w,S=x+p.h,C=new Ue.default$1(m,x),b=new Ue.default$1(w,x),_=new Ue.default$1(m,S),E=new Ue.default$1(w,S);if(r&&A.vertical){var z=new Ue.default$1(-g,g),T=-Sa/2,I=new Ue.default$1(5,0);C._rotateAround(T,z)._add(I),b._rotateAround(T,z)._add(I),_._rotateAround(T,z)._add(I),E._rotateAround(T,z)._add(I)}if(a){var k=M(a),L=te(a),P=[L,-k,k,L];C._matMult(P),b._matMult(P),_._matMult(P),E._matMult(P)}u.push({tl:C,tr:b,bl:_,br:E,tex:p,writingMode:t.writingMode,glyphOffset:v})}}}return u}(0,i,r,n,o,h),p=e.textSizeData,d=null;return"source"===p.functionType?d=[10*r.layout.get("text-size").evaluate(o)]:"composite"===p.functionType&&(d=[10*c.compositeTextSizes[0].evaluate(o),10*c.compositeTextSizes[1].evaluate(o)]),e.addSymbols(e.text,m,d,a,n,o,l,t,s.lineStartIndex,s.lineLength),u.push(e.text.placedSymbolArray.length-1),4*m.length}function g(l,e,t,i){var r=l.compareText;if(e in r){for(var n=r[e],o=n.length-1;0<=o;o--)if(i.dist(n[o])<t)return!0;}else r[e]=[];return r[e].push(i),!1}function v(e,t){for(var a=new Ue.default$16(t),r=0,i=e;r<i.length;r+=1)i[r].recalculate(a)}function h(e,a){var t=Ue.getArrayBuffer(e.request,function(e,t){e?a(e):t&&a(null,{vectorTile:new Ue.default$29.VectorTile(new Ue.default$30(t.data)),rawData:t.data,cacheControl:t.cacheControl,expires:t.expires})});return function(){t.abort(),a()}}function m(a){var e=0;if(a&&0<a.length){e+=wa(y(a[0]));for(var o=1;o<a.length;o++)e-=wa(y(a[o]))}return e}function y(d){var e=0,c=d.length,l,p,u,g,h,m;if(2<c){for(m=0;m<c;m++)m===c-2?(u=c-2,g=c-1,h=0):m===c-1?(u=c-1,g=0,h=1):(u=m,g=m+1,h=m+2),l=d[u],p=d[g],e+=(f(d[h][0])-f(l[0]))*M(f(p[1]));e=e*I.RADIUS*I.RADIUS/2}return e}function f(t){return t*Sa/180}function b(a,e){return function(t){return a(t,e)}}function T(a,e){e=!!e,a[0]=S(a[0],e);for(var o=1;o<a.length;o++)a[o]=S(a[o],!e);return a}function S(a,e){return function(t){return 0<=z.ring(t)}(a)===e?a:a.reverse()}function C(a,e){this.options=e||{},this.features=a,this.length=a.length}function D(a,e){this.id="number"==typeof a.id?a.id:void 0,this.type=a.type,this.rawGeometry=1===a.type?[a.geometry]:a.geometry,this.properties=a.tags,this.extent=e||4096}function O(e){var t=new Ue.__moduleExports$1;return function(a,e){for(var t in a.layers)e.writeMessage(3,F,a.layers[t])}(e,t),t.finish()}function F(a,e){var t;e.writeVarintField(15,a.version||1),e.writeStringField(1,a.name||""),e.writeVarintField(5,a.extent||4096);var l={keys:[],values:[],keycache:{},valuecache:{}};for(t=0;t<a.length;t++)l.feature=a.feature(t),e.writeMessage(2,j,l);var r=l.keys;for(t=0;t<r.length;t++)e.writeStringField(3,r[t]);var n=l.values;for(t=0;t<n.length;t++)e.writeMessage(4,X,n[t])}function j(a,e){var t=a.feature;void 0!==t.id&&e.writeVarintField(1,t.id),e.writeMessage(2,G,a),e.writeVarintField(3,t.type),e.writeMessage(4,H,t)}function G(d,e){var t=d.feature,i=d.keys,r=d.values,n=d.keycache,o=d.valuecache;for(var a in t.properties){var s=n[a];void 0===s&&(i.push(a),s=i.length-1,n[a]=s),e.writeVarint(s);var p=t.properties[a],g=typeof p;"string"!=g&&"boolean"!=g&&"number"!=g&&(p=JSON.stringify(p));var h=g+":"+p,c=o[h];void 0===c&&(r.push(p),c=r.length-1,o[h]=c),e.writeVarint(c)}}function q(a,e){return(e<<3)+(7&a)}function U(t){return t<<1^t>>31}function H(d,e){for(var t=d.loadGeometry(),i=d.type,r=0,g=0,m=t.length,a=0;a<m;a++){var y=t[a],l=1;1===i&&(l=y.length),e.writeVarint(q(1,l));for(var x=3===i?y.length-1:y.length,h=0;h<x;h++){1==h&&1!==i&&e.writeVarint(q(2,x-1));var b=y[h].x-r,f=y[h].y-g;e.writeVarint(U(b)),e.writeVarint(U(f)),r+=b,g+=f}3===i&&e.writeVarint(q(7,0))}}function X(a,e){var t=typeof a;"string"==t?e.writeStringField(1,a):"boolean"==t?e.writeBooleanField(7,a):"number"==t&&(0==a%1?0>a?e.writeSVarintField(6,a):e.writeVarintField(5,a):e.writeDoubleField(3,a))}function Z(a,e,t,o){K(a,t,o),K(e,2*t,2*o),K(e,2*t+1,2*o+1)}function K(a,e,t){var o=a[e];a[e]=a[t],a[t]=o}function Q(a,e,t,i){var r=a-t,n=e-i;return r*r+n*n}function oe(a,e,l,s,r){e=e||se,l=l||le,r=r||Array,this.nodeSize=s||64,this.points=a,this.ids=new r(a.length),this.coords=new r(2*a.length);for(var d=0;d<a.length;d++)this.ids[d]=d,this.coords[2*d]=e(a[d]),this.coords[2*d+1]=l(a[d]);V(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function se(t){return t[0]}function le(t){return t[1]}function ue(t){this.options=ye(Object.create(this.options),t),this.trees=Array(this.options.maxZoom+1)}function ce(a,e,t,o,r){return{x:a,y:e,zoom:1/0,id:o,properties:r,parentId:-1,numPoints:t}}function fe(a,e){var t=a.geometry.coordinates;return{x:ge(t[0]),y:ve(t[1]),zoom:1/0,id:e,parentId:-1}}function pe(a){return{type:"Feature",properties:de(a),geometry:{type:"Point",coordinates:[(n=a.x,360*(n-.5)),(e=a.y,o=(180-360*e)*Sa/180,360*k(ka(o))/Sa-90)]}};var e,o,n}function de(a){var e=a.numPoints,t=1e4<=e?R(e/1e3)+"k":1e3<=e?R(e/100)/10+"k":e;return ye(ye({},a.properties),{cluster:!0,cluster_id:a.id,point_count:e,point_count_abbreviated:t})}function ge(t){return t/360+.5}function ve(a){var e=M(a*Sa/180),t=.5-.25*P((1+e)/(1-e))/Sa;return 0>t?0:1<t?1:t}function ye(a,e){for(var t in e)a[t]=e[t];return a}function me(t){return t.x}function xe(t){return t.y}function we(d,e,t,c,p,n){var o=p-t,u=n-c;if(0!=o||0!=u){var g=((d-t)*o+(e-c)*u)/(o*o+u*u);1<g?(t=p,c=n):0<g&&(t+=o*g,c+=u*g)}return(o=d-t)*o+(u=e-c)*u}function Se(a,e,t,o){var r={id:a||null,type:e,geometry:t,tags:o,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(a){var e=a.geometry,t=a.type;if("Point"===t||"MultiPoint"===t||"LineString"===t)Me(a,e);else if("Polygon"===t||"MultiLineString"===t)for(var o=0;o<e.length;o++)Me(a,e[o]);else if("MultiPolygon"===t)for(o=0;o<e.length;o++)for(var i=0;i<e[o].length;i++)Me(a,e[o][i])}(r),r}function Me(a,e){for(var t=0;t<e.length;t+=3)a.minX=ie(a.minX,e[t]),a.minY=ie(a.minY,e[t+1]),a.maxX=va(a.maxX,e[t]),a.maxY=va(a.maxY,e[t+1])}function be(d,e,t){if(e.geometry){var i=e.geometry.coordinates,r=e.geometry.type,n=_a(t.tolerance/((1<<t.maxZoom)*t.extent),2),o=[];if("Point"===r)_e(i,o);else if("MultiPoint"===r)for(var c=0;c<i.length;c++)_e(i[c],o);else if("LineString"===r)Ie(i,o,n,!1);else if("MultiLineString"===r){if(t.lineMetrics)for(c=0;c<i.length;c++)return o=[],Ie(i[c],o,n,!1),void d.push(Se(e.id,"LineString",o,e.properties));else ze(i,o,n,!1);}else if("Polygon"===r)ze(i,o,n,!0);else{if("MultiPolygon"!==r){if("GeometryCollection"===r){for(c=0;c<e.geometry.geometries.length;c++)be(d,{id:e.id,geometry:e.geometry.geometries[c],properties:e.properties},t);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<i.length;c++){var p=[];ze(i[c],p,n,!0),o.push(p)}}d.push(Se(e.id,r,o,e.properties))}}function _e(a,e){e.push(Te(a[0])),e.push(Pe(a[1])),e.push(0)}function Ie(d,e,t,i){for(var r=0,c=0,p,g;c<d.length;c++){var m=Te(d[c][0]),l=Pe(d[c][1]);e.push(m),e.push(l),e.push(0),0<c&&(r+=i?(p*l-m*g)/2:re(_a(m-p,2)+_a(l-g,2))),p=m,g=l}var u=e.length-3;e[2]=1,function d(e,t,i,r){for(var n=r,p=e[t],s=e[t+1],l=e[i],u=e[i+1],g=t+3,h,m;g<i;g+=3)m=we(e[g],e[g+1],p,s,l,u),m>n&&(h=g,n=m);n>r&&(3<h-t&&d(e,t,h,r),e[h+2]=n,3<i-h&&d(e,h,i,r))}(e,0,u,t),e[u+2]=1,e.size=wa(r),e.start=0,e.end=e.size}function ze(a,e,t,i){for(var r=0,l;r<a.length;r++)l=[],Ie(a[r],l,t,i),e.push(l)}function Te(t){return t/360+.5}function Pe(a){var e=M(a*Sa/180),t=.5-.25*P((1+e)/(1-e))/Sa;return 0>t?0:1<t?1:t}function ke(m,e,t,x,b,n,o,a){if(x/=e,n>=(t/=e)&&o<=x)return m;if(n>x||o<t)return null;for(var s=[],l=0;l<m.length;l++){var _=m[l],h=_.geometry,c=_.type,w=0===b?_.minX:_.minY,p=0===b?_.maxX:_.maxY;if(w>=t&&p<=x)s.push(_);else if(!(w>x||p<t)){var d=[];if("Point"===c||"MultiPoint"===c)Le(h,d,t,x,b);else if("LineString"===c)He(h,d,t,x,b,!1,a.lineMetrics);else if("MultiLineString"===c)Oe(h,d,t,x,b,!1);else if("Polygon"===c)Oe(h,d,t,x,b,!0);else if("MultiPolygon"===c)for(var k=0,T;k<h.length;k++)T=[],Oe(h[k],T,t,x,b,!0),T.length&&d.push(T);if(d.length){if(a.lineMetrics&&"LineString"===c){for(k=0;k<d.length;k++)s.push(Se(_.id,c,d[k],_.tags));continue}"LineString"!==c&&"MultiLineString"!==c||(1===d.length?(c="LineString",d=d[0]):c="MultiLineString"),"Point"!==c&&"MultiPoint"!==c||(c=3===d.length?"Point":"MultiPoint"),s.push(Se(_.id,c,d,_.tags))}}}return s.length?s:null}function Le(l,e,t,i,r){for(var n=0,s;n<l.length;n+=3)s=l[n+r],s>=t&&s<=i&&(e.push(l[n]),e.push(l[n+1]),e.push(l[n+2]))}function He(b,e,t,i,r,n,o){for(var a=De(b),_=0===r?Ae:Ee,h=b.start,k=0,T,A;k<b.length-3;k+=3){var C=b[k],L=b[k+1],E=b[k+2],z=b[k+3],v=b[k+4],y=0===r?C:L,I=0===r?z:v,x=!1;o&&(T=re(_a(C-z,2)+_a(L-v,2))),y<t?I>=t&&(A=_(a,C,L,z,v,t),o&&(a.start=h+T*A)):y>i?I<=i&&(A=_(a,C,L,z,v,i),o&&(a.start=h+T*A)):Ce(a,C,L,E),I<t&&y>=t&&(A=_(a,C,L,z,v,t),x=!0),I>i&&y<=i&&(A=_(a,C,L,z,v,i),x=!0),!n&&x&&(o&&(a.end=h+T*A),e.push(a),a=De(b)),o&&(h+=T)}var D=b.length-3;C=b[D],L=b[D+1],E=b[D+2],(y=0===r?C:L)>=t&&y<=i&&Ce(a,C,L,E),D=a.length-3,n&&3<=D&&(a[D]!==a[0]||a[D+1]!==a[1])&&Ce(a,a[0],a[1],a[2]),a.length&&e.push(a)}function De(a){var e=[];return e.size=a.size,e.start=a.start,e.end=a.end,e}function Oe(l,e,t,i,r,n){for(var o=0;o<l.length;o++)He(l[o],e,t,i,r,n,!1)}function Ce(a,e,t,o){a.push(e),a.push(t),a.push(o)}function Ae(l,e,t,i,r,n){var o=(n-e)/(i-e);return l.push(n),l.push(t+(r-t)*o),l.push(1),o}function Ee(l,e,t,i,r,n){var o=(n-t)/(r-t);return l.push(e+(i-e)*o),l.push(n),l.push(1),o}function Ne(d,e){for(var t=[],i=0;i<d.length;i++){var c=d[i],o=c.type,a;if("Point"===o||"MultiPoint"===o||"LineString"===o)a=Re(c.geometry,e);else if("MultiLineString"===o||"Polygon"===o){a=[];for(var p=0;p<c.geometry.length;p++)a.push(Re(c.geometry[p],e))}else if("MultiPolygon"===o)for(a=[],p=0;p<c.geometry.length;p++){for(var g=[],l=0;l<c.geometry[p].length;l++)g.push(Re(c.geometry[p][l],e));a.push(g)}t.push(Se(c.id,o,a,c.tags))}return t}function Re(a,e){var t=[];t.size=a.size,void 0!==a.start&&(t.start=a.start,t.end=a.end);for(var o=0;o<a.length;o+=3)t.push(a[o]+e,a[o+1],a[o+2]);return t}function Be(d,e){if(d.transformed)return d;var t=1<<d.z,o=d.x,a=d.y,s,p,g;for(s=0;s<d.features.length;s++){var m=d.features[s],l=m.geometry,u=m.type;if(m.geometry=[],1===u)for(p=0;p<l.length;p+=2)m.geometry.push(Fe(l[p],l[p+1],e,t,o,a));else for(p=0;p<l.length;p++){var h=[];for(g=0;g<l[p].length;g+=2)h.push(Fe(l[p][g],l[p][g+1],e,t,o,a));m.geometry.push(h)}}return d.transformed=!0,d}function Fe(a,e,t,i,r,n){return[R(t*(a*i-r)),R(t*(e*i-n))]}function Ge(d,e,t,i,r){for(var n=e===r.maxZoom?0:r.tolerance/((1<<e)*r.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:t,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},a=0;a<d.length;a++){o.numFeatures++,Ve(o,d[a],n,r);var p=d[a].minX,l=d[a].minY,u=d[a].maxX,g=d[a].maxY;p<o.minX&&(o.minX=p),l<o.minY&&(o.minY=l),u>o.maxX&&(o.maxX=u),g>o.maxY&&(o.maxY=g)}return o}function Ve(d,e,t,i){var r=e.geometry,n=e.type,o=[];if("Point"===n||"MultiPoint"===n)for(var a=0;a<r.length;a+=3)o.push(r[a]),o.push(r[a+1]),d.numPoints++,d.numSimplified++;else if("LineString"===n)$e(o,r,d,t,!1,!1);else if("MultiLineString"===n||"Polygon"===n)for(a=0;a<r.length;a++)$e(o,r[a],d,t,"Polygon"===n,0==a);else if("MultiPolygon"===n)for(var p=0,g;p<r.length;p++)for(g=r[p],a=0;a<g.length;a++)$e(o,g[a],d,t,!0,0==a);if(o.length){var m=e.tags||null;if("LineString"===n&&i.lineMetrics){for(var y in m={},e.tags)m[y]=e.tags[y];m.mapbox_clip_start=r.start/r.size,m.mapbox_clip_end=r.end/r.size}var c={geometry:o,type:"Polygon"===n||"MultiPolygon"===n?3:"LineString"===n||"MultiLineString"===n?2:1,tags:m};null!==e.id&&(c.id=e.id),d.features.push(c)}}function $e(d,e,t,i,r,n){var o=i*i;if(0<i&&e.size<(r?o:i))t.numPoints+=e.length/3;else{for(var a=[],s=0;s<e.length;s+=3)(0==i||e[s+2]>o)&&(t.numSimplified++,a.push(e[s]),a.push(e[s+1])),t.numPoints++;r&&function(l,e){for(var t=0,d=0,c=l.length,p=c-2;d<c;p=d,d+=2)t+=(l[d]-l[p])*(l[d+1]+l[p+1]);if(0<t===e)for(d=0,c=l.length;d<c/2;d+=2){var u=l[d],a=l[d+1];l[d]=l[c-2-d],l[d+1]=l[c-1-d],l[c-2-d]=u,l[c-1-d]=a}}(a,n),d.push(a)}}function We(a,e){var o=(e=this.options=function(a,e){for(var t in e)a[t]=e[t];return a}(Object.create(this.options),e)).debug;if(o&&console.time("preprocess data"),0>e.maxZoom||24<e.maxZoom)throw new Error("maxZoom should be in the 0-24 range");var i=function(a,e){var t=[];if("FeatureCollection"===a.type)for(var o=0;o<a.features.length;o++)be(t,a.features[o],e);else"Feature"===a.type?be(t,a,e):be(t,{geometry:a},e);return t}(a,e);this.tiles={},this.tileCoords=[],o&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=function(a,e){var t=e.buffer/e.extent,i=a,l=ke(a,1,-1-t,t,0,-1,2,e),n=ke(a,1,1-t,2+t,0,-1,2,e);return(l||n)&&(i=ke(a,1,-t,1+t,0,-1,2,e)||[],l&&(i=Ne(l,1).concat(i)),n&&(i=i.concat(Ne(n,-1)))),i}(i,e)).length&&this.splitTile(i,0,0,0),o&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ye(a,e,t){return 32*((1<<a)*t+e)+a}function Ze(a,e){var t=a.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var i=this._geoJSONIndex.getTile(t.z,t.x,t.y);if(!i)return e(null,null);var r=new Qe(i.features),n=B(r);0===n.byteOffset&&n.byteLength===n.buffer.byteLength||(n=new Uint8Array(n)),e(null,{vectorTile:r,rawData:n.buffer})}var je=function(t){t&&this.replace(t)};je.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},je.prototype.update=function(e,t){for(var r=this,i=0,n=e,a;i<n.length;i+=1){a=n[i],r._layerConfigs[a.id]=a;var b=r._layers[a.id]=Ue.default$22(a);b._featureFilter=Ue.default$13(b.filter)}for(var l=0,_=t,h;l<_.length;l+=1)h=_[l],delete r._layerConfigs[h],delete r._layers[h];this.familiesBySource={};for(var w=0,k=function(i){for(var e={},t=0;t<i.length;t++){var l=Y(i[t]),n=e[l];n||(n=e[l]=[]),n.push(i[t])}var d=[];for(var a in e)d.push(e[a]);return d}(Ue.values(this._layerConfigs));w<k.length;w+=1){var p=k[w].map(function(t){return r._layers[t.id]}),d=p[0];if("none"!==d.visibility){var g=d.source||"",v=r.familiesBySource[g];v||(v=r.familiesBySource[g]={});var T=d.sourceLayer||"_geojsonTileLayer",m=v[T];m||(m=v[T]=[]),m.push(p)}}};var Je=function(){this.opacity=0,this.targetOpacity=0,this.time=0};Je.prototype.clone=function(){var t=new Je;return t.opacity=this.opacity,t.targetOpacity=this.targetOpacity,t.time=this.time,t},Ue.register("OpacityState",Je);var a=function(m,e,t,i,r,n,o,a,s,l,u){var h=o.top*a-s,c=o.bottom*a+s,y=o.left*a-s,p=o.right*a+s;if(this.boxStartIndex=m.length,l){var d=c-h;0<d&&(d=va(10*a,d),this._addLineCollisionCircles(m,e,t,t.segment,p-y,d,i,r,n,u))}else m.emplaceBack(t.x,t.y,y,h,p,c,i,r,n,0,0);this.boxEndIndex=m.length};a.prototype._addLineCollisionCircles=function(x,e,t,i,r,n,o,a,s,l){var u=n/2,h=ea(r/u),c=1+.4*P(l)/E,f=ea(h*c/2),p=-n/2,d=t,k=i+1,A=p,C=-r/2;do{if(0>--k){if(A>C)return;k=0;break}A-=e[k].dist(d),d=e[k]}while(A>C-r/4);for(var m=e[k].dist(e[k+1]),L=-f;L<h+f;L++){var D=L*u,O=C+D;if(0>D&&(O+=D),D>r&&(O+=D-r),!(O<A)){for(;A+m<O;){if(A+=m,++k+1>=e.length)return;m=e[k].dist(e[k+1])}var R=O-A,_=e[k],I=e[k+1].sub(_)._unit()._mult(R)._add(_)._round(),z=wa(O-p)<u?0:.8*(O-p);x.emplaceBack(I.x,I.y,-n/2,-n/2,n/2,n/2,o,a,s,n/2,z)}}};var Ke=o;o.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,0<this.length&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(a){for(var l=this.data,t=this.compare,i=l[a];0<a;){var r=a-1>>1,n=l[r];if(0<=t(i,n))break;l[a]=n,a=r}l[a]=i},_down:function(l){for(var d=this.data,t=this.compare,i=this.length>>1,r=d[l];l<i;){var n=1+(l<<1),c=n+1,a=d[n];if(c<this.length&&0>t(d[c],a)&&(n=c,a=d[c]),0<=t(a,r))break;d[l]=a,l=n}d[l]=r}},Ke.default=o;var l=function(e){var t=new Ue.AlphaImage({width:0,height:0}),i={},r=new Ue.default$2(0,0,{autoResize:!0});for(var n in e){var o=e[n],a=i[n]={};for(var s in o){var l=o[+s];if(l&&0!==l.bitmap.width&&0!==l.bitmap.height){var d=r.packOne(l.bitmap.width+2,l.bitmap.height+2);t.resize({width:r.w,height:r.h}),Ue.AlphaImage.copy(l.bitmap,t,{x:0,y:0},{x:d.x+1,y:d.y+1},l.bitmap),a[s]={rect:d,metrics:l.metrics}}}}r.shrink(),t.resize({width:r.w,height:r.h}),this.image=t,this.positions=i};Ue.register("GlyphAtlas",l);var s=function(e){this.tileID=new Ue.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming};s.prototype.parse=function(e,t,i,g){function r(){if(p)return g(p);if(x&&k){var e=new l(x),t=new Ue.default$28(k);for(var i in s){var r=s[i];r instanceof Ue.default$14&&(v(r.layers,this.zoom),d(r,x,e.positions,k,t.positions,this.showCollisionBoxes))}this.status="done",g(null,{buckets:Ue.values(s).filter(function(t){return!t.isEmpty()}),featureIndex:a,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,iconAtlasImage:t.image})}}var n=this;this.status="parsing",this.data=e,this.collisionBoxArray=new Ue.CollisionBoxArray;var o=new Ue.default$27(Object.keys(e.layers).sort()),a=new Ue.default$11(this.tileID);a.bucketLayerIDs=[];var s={},c={featureIndex:a,iconDependencies:{},glyphDependencies:{}},f=t.familiesBySource[this.source],p,x,k;for(var A in f){var S=e.layers[A];if(S){1===S.version&&Ue.warnOnce("Vector tile source \""+n.source+"\" layer \""+A+"\" does not use vector tile spec v2 and therefore may have some rendering errors.");for(var C=o.encode(A),y=[],m=0,L;m<S.length;m++)L=S.feature(m),y.push({feature:L,index:m,sourceLayerIndex:C});for(var E=0,D=f[A];E<D.length;E+=1){var _=D[E],I=_[0];I.minzoom&&n.zoom<ea(I.minzoom)||I.maxzoom&&n.zoom>=I.maxzoom||"none"===I.visibility||(v(_,n.zoom),(s[I.id]=I.createBucket({index:a.bucketLayerIDs.length,layers:_,zoom:n.zoom,pixelRatio:n.pixelRatio,overscaling:n.overscaling,collisionBoxArray:n.collisionBoxArray,sourceLayerIndex:C})).populate(y,c),a.bucketLayerIDs.push(_.map(function(t){return t.id})))}}}var z=Ue.mapObject(c.glyphDependencies,function(t){return Object.keys(t).map(Number)});Object.keys(z).length?i.send("getGlyphs",{uid:this.uid,stacks:z},function(a,e){p||(p=a,x=e,r.call(n))}):x={};var T=Object.keys(c.iconDependencies);T.length?i.send("getImages",{icons:T},function(a,e){p||(p=a,k=e,r.call(n))}):k={},r.call(this)};var r=function(t){return performance&&performance.getEntriesByName&&performance.getEntriesByName(t)},x=function(a,e,t){this.actor=a,this.layerIndex=e,this.loadVectorData=t||h,this.loading={},this.loaded={}};x.prototype.loadTile=function(e,d){var t=this,i=e.uid;this.loading||(this.loading={});var n=this.loading[i]=new s(e);n.abort=this.loadVectorData(e,function(o,a){if(delete t.loading[i],o||!a)return d(o);var s=a.rawData,l={};a.expires&&(l.expires=a.expires),a.cacheControl&&(l.cacheControl=a.cacheControl);var p={};if(e.request&&e.request.collectResourceTiming){var u=r(e.request.url);u&&(p.resourceTiming=JSON.parse(JSON.stringify(u)))}n.vectorTile=a.vectorTile,n.parse(a.vectorTile,t.layerIndex,t.actor,function(e,t){return e||!t?d(e):void d(null,Ue.extend({rawTileData:s.slice(0)},t,l,p))}),t.loaded=t.loaded||{},t.loaded[i]=n})},x.prototype.reloadTile=function(l,s){var e=this.loaded,t=l.uid,d=this;if(e&&e[t]){var n=e[t];n.showCollisionBoxes=l.showCollisionBoxes;var o=function(t,e){var a=n.reloadCallback;a&&(delete n.reloadCallback,n.parse(n.vectorTile,d.layerIndex,d.actor,a)),s(t,e)};"parsing"===n.status?n.reloadCallback=o:"done"===n.status&&n.parse(n.vectorTile,this.layerIndex,this.actor,o)}},x.prototype.abortTile=function(a,e){var t=this.loading,o=a.uid;t&&t[o]&&t[o].abort&&(t[o].abort(),delete t[o]),e()},x.prototype.removeTile=function(a,e){var t=this.loaded,o=a.uid;t&&t[o]&&delete t[o],e()};var _=function(){this.loading={},this.loaded={}};_.prototype.loadTile=function(e,t){var a=e.uid,r=e.encoding,i=new Ue.default$31(a);this.loading[a]=i,i.loadFromImage(e.rawImageData,r),delete this.loading[a],this.loaded=this.loaded||{},this.loaded[a]=i,t(null,i)},_.prototype.removeTile=function(a){var e=this.loaded,t=a.uid;e&&e[t]&&delete e[t]};var I={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142},z={geometry:function a(e){var t=0,o;switch(e.type){case"Polygon":return m(e.coordinates);case"MultiPolygon":for(o=0;o<e.coordinates.length;o++)t+=m(e.coordinates[o]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(o=0;o<e.geometries.length;o++)t+=a(e.geometries[o]);return t;}},ring:y},L=function a(e,t){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.map(b(a,t)),e;case"Feature":return e.geometry=a(e.geometry,t),e;case"Polygon":case"MultiPolygon":return function(a,e){return"Polygon"===a.type?a.coordinates=T(a.coordinates,e):"MultiPolygon"===a.type&&(a.coordinates=a.coordinates.map(b(T,e))),a}(e,t);default:return e;}},$=Ue.default$29.VectorTileFeature.prototype.toGeoJSON,A=function(e){this._feature=e,this.extent=Ue.default$8,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};A.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],t=0,d=this._feature.geometry,r;t<d.length;t+=1)r=d[t],e.push([new Ue.default$1(r[0],r[1])]);return e}for(var p=[],o=0,g=this._feature.geometry;o<g.length;o+=1){for(var s=[],l=0,m=g[o],h;l<m.length;l+=1)h=m[l],s.push(new Ue.default$1(h[0],h[1]));p.push(s)}return p},A.prototype.toGeoJSON=function(a,e,t){return $.call(this,a,e,t)};var Qe=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=Ue.default$8,this.length=e.length,this._features=e};Qe.prototype.feature=function(t){return new A(this._features[t])};var N=Ue.__moduleExports.VectorTileFeature,et=C;C.prototype.feature=function(t){return new D(this.features[t],this.options.extent)},D.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var a=e[t],r=[],n=0;n<a.length;n++)r.push(new Ue.default$32(a[n][0],a[n][1]));this.geometry.push(r)}return this.geometry},D.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var d=this.geometry,e=1/0,c=-1/0,p=1/0,u=-1/0,g=0;g<d.length;g++)for(var h=d[g],a=0,m;a<h.length;a++)m=h[a],e=ie(e,m.x),c=va(c,m.x),p=ie(p,m.y),u=va(u,m.y);return[e,p,c,u]},D.prototype.toGeoJSON=N.prototype.toGeoJSON;var B=O;B.fromVectorTileJs=O,B.fromGeojsonVt=function(a,e){e=e||{};var o={};for(var i in a)o[i]=new et(a[i].features,e),o[i].name=i,o[i].version=e.version,o[i].extent=e.extent;return O({layers:o})},B.GeoJSONWrapper=et;var V=function l(e,t,i,r,n,o){if(!(n-r<=i)){var a=ea((r+n)/2);!function m(e,t,i,r,y,x){for(;y>r;){if(600<y-r){var a=y-r+1,s=i-r+1,l=P(a),u=.5*ka(2*l/3),h=.5*re(l*u*(a-u)/a)*(0>s-a/2?-1:1),c=va(r,ea(i-s*u/a+h)),f=ie(y,ea(i+(a-s)*u/a+h));m(e,t,i,c,f,x)}var p=t[2*i+x],d=r,b=y;for(Z(e,t,r,i),t[2*y+x]>p&&Z(e,t,r,y);d<b;){for(Z(e,t,d,b),d++,b--;t[2*d+x]<p;)d++;for(;t[2*b+x]>p;)b--}t[2*r+x]===p?Z(e,t,r,b):Z(e,t,++b,y),b<=i&&(r=b+1),i<=b&&(y=b-1)}}(e,t,a,r,n,o%2),l(e,t,i,r,a-1,o+1),l(e,t,i,a+1,n,o+1)}},ee=function(m,e,t,i,r,n,o){for(var a=[0,m.length-1,0],u=[],h,y;a.length;){var x=a.pop(),c=a.pop(),f=a.pop();if(c-f<=o)for(var p=f;p<=c;p++)h=e[2*p],y=e[2*p+1],h>=t&&h<=r&&y>=i&&y<=n&&u.push(m[p]);else{var b=ea((f+c)/2);h=e[2*b],y=e[2*b+1],h>=t&&h<=r&&y>=i&&y<=n&&u.push(m[b]);var g=(x+1)%2;(0===x?t<=h:i<=y)&&(a.push(f),a.push(b-1),a.push(g)),(0===x?r>=h:n>=y)&&(a.push(b+1),a.push(c),a.push(g))}}return u},tt=function(m,e,t,i,r,n){for(var o=[0,m.length-1,0],a=[],s=r*r;o.length;){var l=o.pop(),u=o.pop(),h=o.pop();if(u-h<=n)for(var c=h;c<=u;c++)Q(e[2*c],e[2*c+1],t,i)<=s&&a.push(m[c]);else{var y=ea((h+u)/2),p=e[2*y],d=e[2*y+1];Q(p,d,t,i)<=s&&a.push(m[y]);var g=(l+1)%2;(0===l?t-r<=p:i-r<=d)&&(o.push(h),o.push(y-1),o.push(g)),(0===l?t+r>=p:i+r>=d)&&(o.push(y+1),o.push(u),o.push(g))}}return a},ne=function(a,e,t,o,r){return new oe(a,e,t,o,r)};oe.prototype={range:function(a,e,t,o){return ee(this.ids,this.coords,a,e,t,o,this.nodeSize)},within:function(a,e,t){return tt(this.ids,this.coords,a,e,t,this.nodeSize)}};var ae=function(t){return new ue(t)};ue.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(a){var e=this.options.log;e&&console.time("total time");var t="prepare "+a.length+" points";e&&console.time(t),this.points=a;var i=a.map(fe);e&&console.timeEnd(t);for(var l=this.options.maxZoom,s;l>=this.options.minZoom;l--)s=+Date.now(),this.trees[l+1]=ne(i,me,xe,this.options.nodeSize,Float32Array),i=this._cluster(i,l),e&&console.log("z%d: %d clusters in %dms",l,i.length,+Date.now()-s);return this.trees[this.options.minZoom]=ne(i,me,xe,this.options.nodeSize,Float32Array),e&&console.timeEnd("total time"),this},getClusters:function(l,e){for(var t=this.trees[this._limitZoom(e)],i=t.range(ge(l[0]),ve(l[3]),ge(l[2]),ve(l[1])),r=[],n=0,s;n<i.length;n++)s=t.points[i[n]],r.push(s.numPoints?pe(s):this.points[s.id]);return r},getChildren:function(l,e){for(var t=this.trees[e+1].points[l],i=this.options.radius/(this.options.extent*_a(2,e)),r=this.trees[e+1].within(t.x,t.y,i),n=[],o=0,d;o<r.length;o++)d=this.trees[e+1].points[r[o]],d.parentId===l&&n.push(d.numPoints?pe(d):this.points[d.id]);return n},getLeaves:function(a,e,t,o){t=t||10,o=o||0;var l=[];return this._appendLeaves(l,a,e,t,o,0),l},getTile:function(d,e,t){var i=this.trees[this._limitZoom(d)],r=_a(2,d),n=this.options.extent,o=this.options.radius/n,a=(t-o)/r,s=(t+1+o)/r,l={features:[]};return this._addTileFeatures(i.range((e-o)/r,a,(e+1+o)/r,s),i.points,e,t,r,l),0===e&&this._addTileFeatures(i.range(1-o/r,a,1,s),i.points,r,t,r,l),e===r-1&&this._addTileFeatures(i.range(0,a,o/r,s),i.points,-1,t,r,l),l.features.length?l:null},getClusterExpansionZoom:function(a,o){for(;o<this.options.maxZoom;){var r=this.getChildren(a,o);if(o++,1!==r.length)break;a=r[0].properties.cluster_id}return o},_appendLeaves:function(d,e,t,i,r,n){for(var c=this.getChildren(e,t),a=0,p;a<c.length&&(p=c[a].properties,p.cluster?n+p.point_count<=r?n+=p.point_count:n=this._appendLeaves(d,p.cluster_id,t+1,i,r,n):n<r?n++:d.push(c[a]),d.length!==i);a++);return n},_addTileFeatures:function(l,e,t,i,r,n){for(var o=0,d;o<l.length;o++)d=e[l[o]],n.features.push({type:1,geometry:[[R(this.options.extent*(d.x*r-t)),R(this.options.extent*(d.y*r-i))]],tags:d.numPoints?de(d):this.points[d.id].properties})},_limitZoom:function(t){return va(this.options.minZoom,ie(t,this.options.maxZoom+1))},_cluster:function(g,e){for(var t=[],i=this.options.radius/(this.options.extent*_a(2,e)),r=0,m;r<g.length;r++)if(m=g[r],!(m.zoom<=e)){m.zoom=e;var y=this.trees[e+1],a=y.within(m.x,m.y,i),s=m.numPoints||1,x=m.x*s,b=m.y*s,_=null;this.options.reduce&&(_=this.options.initial(),this._accumulate(_,m));for(var v=0,w;v<a.length;v++)if(w=y.points[a[v]],e<w.zoom){var k=w.numPoints||1;w.zoom=e,x+=w.x*k,b+=w.y*k,s+=k,w.parentId=r,this.options.reduce&&this._accumulate(_,w)}1===s?t.push(m):(m.parentId=r,t.push(ce(x/s,b/s,s,r,_)))}return t},_accumulate:function(a,e){var t=e.numPoints?e.properties:this.options.map(this.points[e.id].properties);this.options.reduce(a,t)}},We.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,debug:0},We.prototype.splitTile=function(k,T,A,C,L,n,o){for(var a=[k,T,A,C],s=this.options,l=s.debug;a.length;){C=a.pop(),A=a.pop(),T=a.pop(),k=a.pop();var u=1<<T,h=Ye(T,A,C),c=this.tiles[h];if(!c&&(1<l&&console.time("creation"),c=this.tiles[h]=Ge(k,T,A,C,s),this.tileCoords.push({z:T,x:A,y:C}),l)){1<l&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",T,A,C,c.numFeatures,c.numPoints,c.numSimplified),console.timeEnd("creation"));var E="z"+T;this.stats[E]=(this.stats[E]||0)+1,this.total++}if(c.source=k,L){if(T===s.maxZoom||T===L)continue;var p=1<<L-T;if(A!==ea(n/p)||C!==ea(o/p))continue}else if(T===s.indexMaxZoom||c.numPoints<=s.indexMaxPoints)continue;if(c.source=null,0!==k.length){1<l&&console.time("clipping");var d=.5*s.buffer/s.extent,S=.5-d,z=.5+d,b=1+d,_,I,D,P,O,R;_=I=D=P=null,O=ke(k,u,A-d,A+z,0,c.minX,c.maxX,s),R=ke(k,u,A+S,A+b,0,c.minX,c.maxX,s),k=null,O&&(_=ke(O,u,C-d,C+z,1,c.minY,c.maxY,s),I=ke(O,u,C+S,C+b,1,c.minY,c.maxY,s),O=null),R&&(D=ke(R,u,C-d,C+z,1,c.minY,c.maxY,s),P=ke(R,u,C+S,C+b,1,c.minY,c.maxY,s),R=null),1<l&&console.timeEnd("clipping"),a.push(_||[],T+1,2*A,2*C),a.push(I||[],T+1,2*A,2*C+1),a.push(D||[],T+1,2*A+1,2*C),a.push(P||[],T+1,2*A+1,2*C+1)}}},We.prototype.getTile=function(d,e,p){var i=this.options,r=i.extent,n=i.debug;if(0>d||24<d)return null;var o=1<<d,a=Ye(d,e=(e%o+o)%o,p);if(this.tiles[a])return Be(this.tiles[a],r);1<n&&console.log("drilling down to z%d-%d-%d",d,e,p);for(var s=d,g=e,m=p,y;!y&&0<s;)s--,g=ea(g/2),m=ea(m/2),y=this.tiles[Ye(s,g,m)];return y&&y.source?(1<n&&console.log("found parent tile z%d-%d-%d",s,g,m),1<n&&console.time("drilling down"),this.splitTile(y.source,s,g,m,d,e,p),1<n&&console.timeEnd("drilling down"),this.tiles[a]?Be(this.tiles[a],r):null):null};var he=function(a){function e(t,e,o){a.call(this,t,e,Ze),o&&(this.loadGeoJSON=o)}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.loadData=function(a,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=a,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},e.prototype._loadData=function(){var l=this;if(this._pendingCallback&&this._pendingLoadDataParams){var e=this._pendingCallback,t=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams,this.loadGeoJSON(t,function(i,s){if(i||!s)return e(i);if("object"!=typeof s)return e(new Error("Input data is not a valid GeoJSON object."));L(s,!0);try{l._geoJSONIndex=t.cluster?ae(t.superclusterOptions).load(s.features):function(a,e){return new We(a,e)}(s,t.geojsonVtOptions)}catch(t){return e(t)}l.loaded={};var n={};if(t.request&&t.request.collectResourceTiming){var o=r(t.request.url);o&&(n.resourceTiming={},n.resourceTiming[t.source]=JSON.parse(JSON.stringify(o)))}e(null,n)})}},e.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},e.prototype.reloadTile=function(t,e){var o=this.loaded,r=t.uid;return o&&o[r]?a.prototype.reloadTile.call(this,t,e):this.loadTile(t,e)},e.prototype.loadGeoJSON=function(e,t){if(e.request)Ue.getJSON(e.request,t);else{if("string"!=typeof e.data)return t(new Error("Input data is not a valid GeoJSON object."));try{return t(null,JSON.parse(e.data))}catch(a){return t(new Error("Input data is not a valid GeoJSON object."))}}},e.prototype.removeSource=function(a,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},e}(x),Xe=function(e){var a=this;this.self=e,this.actor=new Ue.default$7(e,this),this.layerIndexes={},this.workerSourceTypes={vector:x,geojson:he},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(o,e){if(a.workerSourceTypes[o])throw new Error("Worker source with name \""+o+"\" already registered.");a.workerSourceTypes[o]=e},this.self.registerRTLTextPlugin=function(e){if(Ue.plugin.isLoaded())throw new Error("RTL text plugin already registered.");Ue.plugin.applyArabicShaping=e.applyArabicShaping,Ue.plugin.processBidirectionalText=e.processBidirectionalText}};return Xe.prototype.setLayers=function(a,e,t){this.getLayerIndex(a).replace(e),t()},Xe.prototype.updateLayers=function(a,e,t){this.getLayerIndex(a).update(e.layers,e.removedIds),t()},Xe.prototype.loadTile=function(a,e,t){this.getWorkerSource(a,e.type,e.source).loadTile(e,t)},Xe.prototype.loadDEMTile=function(a,e,t){this.getDEMWorkerSource(a,e.source).loadTile(e,t)},Xe.prototype.reloadTile=function(a,e,t){this.getWorkerSource(a,e.type,e.source).reloadTile(e,t)},Xe.prototype.abortTile=function(a,e,t){this.getWorkerSource(a,e.type,e.source).abortTile(e,t)},Xe.prototype.removeTile=function(a,e,t){this.getWorkerSource(a,e.type,e.source).removeTile(e,t)},Xe.prototype.removeDEMTile=function(a,e){this.getDEMWorkerSource(a,e.source).removeTile(e)},Xe.prototype.removeSource=function(a,e,t){if(this.workerSources[a]&&this.workerSources[a][e.type]&&this.workerSources[a][e.type][e.source]){var o=this.workerSources[a][e.type][e.source];delete this.workerSources[a][e.type][e.source],void 0===o.removeSource?t():o.removeSource(e,t)}},Xe.prototype.loadWorkerSource=function(a,e,t){try{this.self.importScripts(e.url),t()}catch(a){t(a.toString())}},Xe.prototype.loadRTLTextPlugin=function(e,t,a){try{Ue.plugin.isLoaded()||(this.self.importScripts(t),a(Ue.plugin.isLoaded()?null:new Error("RTL Text Plugin failed to import scripts from "+t)))}catch(t){a(t.toString())}},Xe.prototype.getLayerIndex=function(a){var e=this.layerIndexes[a];return e||(e=this.layerIndexes[a]=new je),e},Xe.prototype.getWorkerSource=function(a,e,t){var o=this;if(this.workerSources[a]||(this.workerSources[a]={}),this.workerSources[a][e]||(this.workerSources[a][e]={}),!this.workerSources[a][e][t]){var r={send:function(e,t,r){o.actor.send(e,t,r,a)}};this.workerSources[a][e][t]=new this.workerSourceTypes[e](r,this.getLayerIndex(a))}return this.workerSources[a][e][t]},Xe.prototype.getDEMWorkerSource=function(a,e){return this.demWorkerSources[a]||(this.demWorkerSources[a]={}),this.demWorkerSources[a][e]||(this.demWorkerSources[a][e]=new _),this.demWorkerSources[a][e]},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&new Xe(self),Xe}),e(["./chunk1.js"],function(ta){function t(o){if(!a)return null;for(var t=0;t<o.length;t++)if(o[t]in a)return o[t];return o[0]}function c(a,t){var o=y(m.API_URL);if(a.protocol=o.protocol,a.authority=o.authority,"/"!==o.path&&(a.path=""+o.path+a.path),!m.REQUIRE_ACCESS_TOKEN)return C(a);if(!(t=t||m.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. See https://www.mapbox.com/api-documentation/#access-tokens");if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). See https://www.mapbox.com/api-documentation/#access-tokens");return a.params.push("access_token="+t),C(a)}function aa(e){return 0===e.indexOf("mapbox:")}function y(a){var t=a.match(T);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function C(a){var t=a.params.length?"?"+a.params.join("&"):"";return a.protocol+"://"+a.authority+a.path+t}function S(l,t,e,i,n,o){this.fontSize=l||24,this.buffer=void 0===t?3:t,this.cutoff=i||.25,this.fontFamily=n||"sans-serif",this.fontWeight=o||"normal",this.radius=e||8;var r=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=r,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(r*r),this.gridInner=new Float64Array(r*r),this.f=new Float64Array(r),this.d=new Float64Array(r),this.z=new Float64Array(r+1),this.v=new Int16Array(r),this.middle=R(r/2*(0<=navigator.userAgent.indexOf("Gecko/")?1.2:1))}function B(d,t,e,i,n,o,r){for(var a=0;a<t;a++){for(var c=0;c<e;c++)i[c]=d[c*t+a];for(oa(i,n,o,r,e),c=0;c<e;c++)d[c*t+a]=n[c]}for(c=0;c<e;c++){for(a=0;a<t;a++)i[a]=d[c*t+a];for(oa(i,n,o,r,t),a=0;a<t;a++)d[c*t+a]=re(n[a])}}function oa(l,t,e,i,n){e[0]=0,i[0]=-100000000000000000000,i[1]=100000000000000000000;for(var o=1,d=0;o<n;o++){for(var c=(l[o]+o*o-(l[e[d]]+e[d]*e[d]))/(2*o-2*e[d]);c<=i[d];)d--,c=(l[o]+o*o-(l[e[d]]+e[d]*e[d]))/(2*o-2*e[d]);e[++d]=o,i[d]=c,i[d+1]=100000000000000000000}for(o=0,d=0;o<n;o++){for(;i[d+1]<o;)d++;t[o]=(o-e[d])*(o-e[d])+l[e[d]]}}function F(t,e,a){var r=function(t,e){if(t)return a(t);if(e){var r=ta.pick(e,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);e.vector_layers&&(r.vectorLayers=e.vector_layers,r.vectorLayerIds=r.vectorLayers.map(function(e){return e.id})),a(null,r)}};t.url?ta.getJSON(e(x(t.url),ta.ResourceType.Source),r):ja.frame(function(){return r(null,t)})}function G(d,t,e,i,n){var o=n.maxPitchScaleFactor(),r=d.tilesIn(e,o);r.sort(at);for(var a=[],s=0,p=r,c;s<p.length;s+=1)c=p[s],a.push({wrappedTileID:c.tileID.wrapped().key,queryResults:c.tile.queryRenderedFeatures(t,c.queryGeometry,c.scale,i,n,o,d.transform.calculatePosMatrix(c.tileID.toUnwrapped()))});return function(g){for(var t={},e={},i=0,y=g;i<y.length;i+=1){var o=y[i],r=o.queryResults,a=o.wrappedTileID,s=e[a]=e[a]||{};for(var l in r)for(var c=r[l],u=s[l]=s[l]||{},h=t[l]=t[l]||[],p=0,x=c,f;p<x.length;p+=1)f=x[p],u[f.featureIndex]||(u[f.featureIndex]=!0,h.push(f.feature))}return t}(a)}function at(a,t){var e=a.tileID,o=t.tileID;return e.overscaledZ-o.overscaledZ||e.canonical.y-o.canonical.y||e.wrap-o.wrap||e.canonical.x-o.canonical.x}function st(t,e){var a=e.zoomTo(t.canonical.z);return new ta.default$1((a.column-(t.canonical.x+t.wrap*_a(2,t.canonical.z)))*ta.default$8,(a.row-t.canonical.y)*ta.default$8)}function Ht(e){return"raster"===e||"image"===e||"video"===e}function Kt(){return new ta.default.Worker($o.workerUrl)}function Yt(t,e){var a={};for(var r in t)"ref"!=r&&(a[r]=t[r]);return ta.default$18.forEach(function(o){o in e&&(a[o]=e[o])}),a}function ra(a){a=a.slice();for(var o=Object.create(null),e=0;e<a.length;e++)o[a[e].id]=a[e];for(var r=0;r<a.length;r++)"ref"in a[r]&&(a[r]=Yt(a[r],o[a[r].ref]));return a}function ee(a,t,e){e.push({command:Ga.addSource,args:[a,t[a]]})}function ne(a,t,e){t.push({command:Ga.removeSource,args:[a]}),e[a]=!0}function oe(a,t,e,o){ne(a,e,o),ee(a,t,e)}function ia(t,e,a){for(var r in t[a])if(t[a].hasOwnProperty(r)&&"data"!==r&&!ta.default$10(t[a][r],e[a][r]))return!1;for(r in e[a])if(e[a].hasOwnProperty(r)&&"data"!==r&&!ta.default$10(t[a][r],e[a][r]))return!1;return!0}function na(t,l,d,n,o,r){for(var a in l=l||{},t=t||{})t.hasOwnProperty(a)&&(ta.default$10(t[a],l[a])||d.push({command:r,args:[n,a,l[a],o]}));for(a in l)l.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(ta.default$10(t[a],l[a])||d.push({command:r,args:[n,a,l[a],o]}))}function se(e){return e.id}function le(a,t){return a[t.id]=t,a}function ce(t,e){if(!t)return[{command:Ga.setStyle,args:[e]}];var i=[];try{if(!ta.default$10(t.version,e.version))return[{command:Ga.setStyle,args:[e]}];ta.default$10(t.center,e.center)||i.push({command:Ga.setCenter,args:[e.center]}),ta.default$10(t.zoom,e.zoom)||i.push({command:Ga.setZoom,args:[e.zoom]}),ta.default$10(t.bearing,e.bearing)||i.push({command:Ga.setBearing,args:[e.bearing]}),ta.default$10(t.pitch,e.pitch)||i.push({command:Ga.setPitch,args:[e.pitch]}),ta.default$10(t.sprite,e.sprite)||i.push({command:Ga.setSprite,args:[e.sprite]}),ta.default$10(t.glyphs,e.glyphs)||i.push({command:Ga.setGlyphs,args:[e.glyphs]}),ta.default$10(t.transition,e.transition)||i.push({command:Ga.setTransition,args:[e.transition]}),ta.default$10(t.light,e.light)||i.push({command:Ga.setLight,args:[e.light]});var l={},o=[];!function(t,a,l,n){for(var o in a=a||{},t=t||{})t.hasOwnProperty(o)&&(a.hasOwnProperty(o)||ne(o,l,n));for(o in a)a.hasOwnProperty(o)&&(t.hasOwnProperty(o)?ta.default$10(t[o],a[o])||("geojson"===t[o].type&&"geojson"===a[o].type&&ia(t,a,o)?l.push({command:Ga.setGeoJSONSourceData,args:[o,a[o].data]}):oe(o,a,l,n)):ee(o,a,l))}(t.sources,e.sources,o,l);var r=[];t.layers&&t.layers.forEach(function(e){l[e.source]?i.push({command:Ga.removeLayer,args:[e.id]}):r.push(e)}),i=i.concat(o),function(t,g,y){g=g||[];var n=(t=t||[]).map(se),h=g.map(se),p=t.reduce(le,{}),d=g.reduce(le,{}),f=n.slice(),m=Object.create(null),x,b,_,v,w,k,T;for(x=0,b=0;x<n.length;x++)_=n[x],d.hasOwnProperty(_)?b++:(y.push({command:Ga.removeLayer,args:[_]}),f.splice(f.indexOf(_,b),1));for(x=0,b=0;x<h.length;x++)_=h[h.length-1-x],f[f.length-1-x]!==_&&(p.hasOwnProperty(_)?(y.push({command:Ga.removeLayer,args:[_]}),f.splice(f.lastIndexOf(_,f.length-b),1)):b++,k=f[f.length-x],y.push({command:Ga.addLayer,args:[d[_],k]}),f.splice(f.length-x,0,_),m[_]=!0);for(x=0;x<h.length;x++)if(v=p[_=h[x]],w=d[_],!m[_]&&!ta.default$10(v,w))if(ta.default$10(v.source,w.source)&&ta.default$10(v["source-layer"],w["source-layer"])&&ta.default$10(v.type,w.type)){for(T in na(v.layout,w.layout,y,_,null,Ga.setLayoutProperty),na(v.paint,w.paint,y,_,null,Ga.setPaintProperty),ta.default$10(v.filter,w.filter)||y.push({command:Ga.setFilter,args:[_,w.filter]}),ta.default$10(v.minzoom,w.minzoom)&&ta.default$10(v.maxzoom,w.maxzoom)||y.push({command:Ga.setLayerZoomRange,args:[_,w.minzoom,w.maxzoom]}),v)v.hasOwnProperty(T)&&"layout"!==T&&"paint"!==T&&"filter"!==T&&"metadata"!==T&&"minzoom"!==T&&"maxzoom"!==T&&(0===T.indexOf("paint.")?na(v[T],w[T],y,_,T.slice(6),Ga.setPaintProperty):ta.default$10(v[T],w[T])||y.push({command:Ga.setLayerProperty,args:[_,T,w[T]]}));for(T in w)w.hasOwnProperty(T)&&!v.hasOwnProperty(T)&&"layout"!==T&&"paint"!==T&&"filter"!==T&&"metadata"!==T&&"minzoom"!==T&&"maxzoom"!==T&&(0===T.indexOf("paint.")?na(v[T],w[T],y,_,T.slice(6),Ga.setPaintProperty):ta.default$10(v[T],w[T])||y.push({command:Ga.setLayerProperty,args:[_,T,w[T]]}))}else y.push({command:Ga.removeLayer,args:[_]}),k=f[f.lastIndexOf(_)+1],y.push({command:Ga.addLayer,args:[w,k]})}(r,e.layers,i)}catch(a){console.warn("Unable to compute style diff:",a),i=[{command:Ga.setStyle,args:[e]}]}return i}function ue(t,e,i,n,o){var r=ta.mat4.identity(new Float32Array(16));return e?(ta.mat4.identity(r),ta.mat4.scale(r,r,[1/o,1/o,1]),i||ta.mat4.rotateZ(r,r,n.angle)):(ta.mat4.scale(r,r,[n.width/2,-n.height/2,1]),ta.mat4.translate(r,r,[1,-1,0]),ta.mat4.multiply(r,r,t)),r}function de(t,e,i,n,o){var r=ta.mat4.identity(new Float32Array(16));return e?(ta.mat4.multiply(r,r,t),ta.mat4.scale(r,r,[o,o,1]),i||ta.mat4.rotateZ(r,r,-n.angle)):(ta.mat4.scale(r,r,[1,-1,1]),ta.mat4.translate(r,r,[-1,-1,0]),ta.mat4.scale(r,r,[2/n.width,2/n.height,1])),r}function fe(t,e){var a=[t.x,t.y,0,1];Te(a,a,e);var r=a[3];return{point:new ta.default$1(a[0]/r,a[1]/r),signedDistanceFromCamera:r}}function me(a,t){var e=a[0]/a[3],o=a[1]/a[3];return e>=-t[0]&&e<=t[0]&&o>=-t[1]&&o<=t[1]}function _e(t,e,i,n,o,r,a,s){var l=n?t.textSizeData:t.iconSizeData,c=ta.evaluateSizeForZoom(l,i.transform.zoom,he.properties[n?"text-size":"icon-size"]),u=[2*(256/i.width)+1,2*(256/i.height)+1],h=n?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;h.clear();for(var p=t.lineVertexArray,d=n?t.text.placedSymbolArray:t.icon.placedSymbolArray,f=i.transform.width/i.transform.height,m=!1,k=0,A;k<d.length;k++)if(A=d.get(k),A.hidden||A.writingMode===ta.WritingMode.vertical&&!m)we(A.numGlyphs,h);else{m=!1;var S=[A.anchorX,A.anchorY,0,1];if(ta.vec4.transformMat4(S,S,e),me(S,u)){var y=.5+.5*(S[3]/i.transform.cameraToCenterDistance),x=ta.evaluateSizeForFeature(l,c,A),b=a?x*y:x/y,w=new ta.default$1(A.anchorX,A.anchorY),L=fe(w,o).point,T={},E=ye(A,b,!1,s,e,o,r,t.glyphOffsetArray,p,h,L,w,T,f);m=E.useVertical,(E.notEnoughRoom||m||E.needsFlipping&&ye(A,b,!0,s,e,o,r,t.glyphOffsetArray,p,h,L,w,T,f).notEnoughRoom)&&we(A.numGlyphs,h)}else we(A.numGlyphs,h)}n?t.text.dynamicLayoutVertexBuffer.updateData(h):t.icon.dynamicLayoutVertexBuffer.updateData(h)}function ge(y,t,e,i,n,o,r,a,s,l,c,u){var h=a.glyphStartIndex+a.numGlyphs,p=a.lineStartIndex,d=a.lineStartIndex+a.lineLength,f=t.getoffsetX(a.glyphStartIndex),m=t.getoffsetX(h-1),x=be(y*f,e,i,n,o,r,a.segment,p,d,s,l,c,u);if(!x)return null;var g=be(y*m,e,i,n,o,r,a.segment,p,d,s,l,c,u);return g?{first:x,last:g}:null}function ve(t,e,a,r){return t===ta.WritingMode.horizontal&&wa(a.y-e.y)>wa(a.x-e.x)*r?{useVertical:!0}:(t===ta.WritingMode.vertical?e.y<a.y:e.x>a.x)?{needsFlipping:!0}:null}function ye(t,e,i,n,o,r,a,s,l,c,u,h,p,d){var f=e/24,_=t.lineOffsetX*e,g=t.lineOffsetY*e,v;if(1<t.numGlyphs){var O=t.glyphStartIndex+t.numGlyphs,y=t.lineStartIndex,x=t.lineStartIndex+t.lineLength,b=ge(f,s,_,g,i,u,h,t,l,r,p,!1);if(!b)return{notEnoughRoom:!0};var w=fe(b.first.point,a).point,E=fe(b.last.point,a).point;if(n&&!i){var T=ve(t.writingMode,w,E,d);if(T)return T}v=[b.first];for(var I=t.glyphStartIndex+1;I<O-1;I++)v.push(be(f*s.getoffsetX(I),_,g,i,u,h,t.segment,y,x,l,r,p,!1));v.push(b.last)}else{if(n&&!i){var j=fe(h,o).point,S=t.lineStartIndex+t.segment+1,z=new ta.default$1(l.getx(S),l.gety(S)),A=fe(z,o),R=0<A.signedDistanceFromCamera?A.point:xe(h,z,j,1,o),D=ve(t.writingMode,j,R,d);if(D)return D}var M=be(f*s.getoffsetX(t.glyphStartIndex),_,g,i,u,h,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,l,r,p,!1);if(!M)return{notEnoughRoom:!0};v=[M]}for(var L=0,F=v,k;L<F.length;L+=1)k=F[L],ta.addDynamicAttributes(c,k.point,k.angle);return{}}function xe(l,t,e,i,n){var o=fe(l.add(l.sub(t)._unit()),n).point,r=e.sub(o);return e.add(r._mult(i/r.mag()))}function be(t,e,i,n,o,r,a,s,l,c,u,h,p){var d=n?t-e:t+e,f=0<d?1:-1,k=0;n&&(f*=-1,k=Sa),0>f&&(k+=Sa);for(var D=0<f?s+a:s+a+1,P=D,v=o,O=o,R=0,M=0,j=wa(d);R+M<=j;){if((D+=f)<s||D>=l)return null;if(O=v,void 0===(v=h[D])){var E=new ta.default$1(c.getx(D),c.gety(D)),T=fe(E,u);if(0<T.signedDistanceFromCamera)v=h[D]=T.point;else{var I=D-f;v=xe(0==R?r:new ta.default$1(c.getx(I),c.gety(I)),E,O,j-R+1,u)}}R+=M,M=O.dist(v)}var C=(j-R)/M,S=v.sub(O),z=S.mult(C)._add(O);return z._add(S._unit()._perp()._mult(i*f)),{point:z,angle:k+L(v.y-O.y,v.x-O.x),tileDistance:p?{prevTileDistance:D-f===P?0:c.gettileUnitDistanceFromAnchor(D-f),lastSegmentViewportDistance:j-R}:null}}function we(a,t){for(var e=0,o;e<a;e++)o=t.length,t.resize(o+4),t.float32.set(pe,3*o)}function Te(a,t,e){var r=t[0],i=t[1];return a[0]=e[0]*r+e[4]*i+e[12],a[1]=e[1]*r+e[5]*i+e[13],a[3]=e[3]*r+e[7]*i+e[15],a}function Ie(a,t,e){a[t+4]=e?1:0}function Se(t,e,a){return e*(ta.default$8/(t.tileSize*_a(2,a-t.tileID.overscaledZ)))}function ze(a,t,e){a.emplaceBack(t?1:0,e?1:0),a.emplaceBack(t?1:0,e?1:0),a.emplaceBack(t?1:0,e?1:0),a.emplaceBack(t?1:0,e?1:0)}function Pe(a){if(0===a.opacity&&!a.placed)return 0;if(1===a.opacity&&a.placed)return 4294967295;var t=a.placed?1:0,e=ea(127*a.opacity);return 33554432*e+16777216*t+131072*e+65536*t+512*e+256*t+2*e+t}function Ve(t,e,i,n,o){for(var r=0,d;r<i.length&&(d=i[r],!n.isLessThan(d.tileID));r++){if(e.key===d.tileID.key)return;if(d.tileID.isChildOf(e)){for(var p=e.children(1/0),l=0;l<p.length;l++)Ve(t,p[l],i.slice(r),n,o);return}}var g=e.overscaledZ-t.overscaledZ,u=new ta.CanonicalTileID(g,e.canonical.x-(t.canonical.x<<g),e.canonical.y-(t.canonical.y<<g));o[u.key]=o[u.key]||u}function la(g,t,e,i,n){var o=g.context,r=o.gl,a=n?g.useProgram("collisionCircle"):g.useProgram("collisionBox");o.setDepthMode(jt.disabled),o.setStencilMode($t.disabled),o.setColorMode(g.colorModeForRenderPass());for(var s=0;s<i.length;s++){var m=i[s],c=t.getTile(m),u=c.getBucket(e);if(u){var h=n?u.collisionCircle:u.collisionBox;if(h){r.uniformMatrix4fv(a.uniforms.u_matrix,!1,m.posMatrix),n||o.lineWidth.set(1),r.uniform1f(a.uniforms.u_camera_to_center_distance,g.transform.cameraToCenterDistance);var p=Se(c,1,g.transform.zoom),d=_a(2,g.transform.zoom-c.tileID.overscaledZ);r.uniform1f(a.uniforms.u_pixels_to_tile_units,p),r.uniform2f(a.uniforms.u_extrude_scale,g.transform.pixelsToGLUnits[0]/(p*d),g.transform.pixelsToGLUnits[1]/(p*d)),r.uniform1f(a.uniforms.u_overscale_factor,c.tileID.overscaleFactor()),a.draw(o,n?r.TRIANGLES:r.LINES,e.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,null,h.collisionVertexBuffer,null)}}}}function sa(g,t,e,i,n,o,r,a,s,l){var c=g.context,h=c.gl,p=g.transform,d="map"===a,f="map"===s,m=d&&"line"===e.layout.get("symbol-placement"),_;c.setDepthMode(f?g.depthModeForSublayer(0,jt.ReadOnly):jt.disabled);for(var v=0,k=i;v<k.length;v+=1){var x=k[v],b=t.getTile(x),w=b.getBucket(e);if(w){var L=n?w.text:w.icon;if(L&&L.segments.get().length){var T=L.programConfigurations.get(e.id),E=n||w.sdfIcons,C=n?w.textSizeData:w.iconSizeData;if(_||(_=g.useProgram(E?"symbolSDF":"symbolIcon",T),T.setUniforms(g.context,_,e.paint,{zoom:g.transform.zoom}),da(_,g,e,n,d&&!f&&!m,f,C)),c.activeTexture.set(h.TEXTURE0),h.uniform1i(_.uniforms.u_texture,0),n)b.glyphAtlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.uniform2fv(_.uniforms.u_texsize,b.glyphAtlasTexture.size);else{var S=1!==e.layout.get("icon-size").constantOr(0)||w.iconsNeedLinear,z=f||0!==p.pitch;b.iconAtlasTexture.bind(E||g.options.rotating||g.options.zooming||S||z?h.LINEAR:h.NEAREST,h.CLAMP_TO_EDGE),h.uniform2fv(_.uniforms.u_texsize,b.iconAtlasTexture.size)}h.uniformMatrix4fv(_.uniforms.u_matrix,!1,g.translatePosMatrix(x.posMatrix,b,o,r));var A=Se(b,1,g.transform.zoom),I=ue(x.posMatrix,f,d,g.transform,A),D=de(x.posMatrix,f,d,g.transform,A);h.uniformMatrix4fv(_.uniforms.u_gl_coord_matrix,!1,g.translatePosMatrix(D,b,o,r,!0)),m?(h.uniformMatrix4fv(_.uniforms.u_label_plane_matrix,!1,Ka),_e(w,x.posMatrix,g,n,I,D,f,l)):h.uniformMatrix4fv(_.uniforms.u_label_plane_matrix,!1,I),h.uniform1f(_.uniforms.u_fade_change,g.options.fadeDuration?g.symbolFadeChange:1),ca(_,T,g,e,b,L,n,E,f)}}}}function da(t,e,i,n,o,r,a){var s=e.context.gl,l=e.transform;s.uniform1i(t.uniforms.u_pitch_with_map,r?1:0),s.uniform1f(t.uniforms.u_is_text,n?1:0),s.uniform1f(t.uniforms.u_pitch,2*(l.pitch/360)*Sa);var d="constant"===a.functionType||"source"===a.functionType,c="constant"===a.functionType||"camera"===a.functionType;s.uniform1i(t.uniforms.u_is_size_zoom_constant,d?1:0),s.uniform1i(t.uniforms.u_is_size_feature_constant,c?1:0),s.uniform1f(t.uniforms.u_camera_to_center_distance,l.cameraToCenterDistance);var u=ta.evaluateSizeForZoom(a,l.zoom,Qa.properties[n?"text-size":"icon-size"]);void 0!==u.uSizeT&&s.uniform1f(t.uniforms.u_size_t,u.uSizeT),void 0!==u.uSize&&s.uniform1f(t.uniforms.u_size,u.uSize),s.uniform1f(t.uniforms.u_aspect_ratio,l.width/l.height),s.uniform1i(t.uniforms.u_rotate_symbol,o?1:0)}function ca(g,t,e,i,n,o,r,a,s){var l=e.context,c=l.gl,u=e.transform;if(a){var h=0!==i.paint.get(r?"text-halo-width":"icon-halo-width").constantOr(1),p=s?te(u._pitch)*u.cameraToCenterDistance:1;c.uniform1f(g.uniforms.u_gamma_scale,p),h&&(c.uniform1f(g.uniforms.u_is_halo,1),pa(o,i,l,g)),c.uniform1f(g.uniforms.u_is_halo,0)}pa(o,i,l,g)}function pa(a,t,e,o){o.draw(e,e.gl.TRIANGLES,t.id,a.layoutVertexBuffer,a.indexBuffer,a.segments,a.programConfigurations.get(t.id),a.dynamicLayoutVertexBuffer,a.opacityVertexBuffer)}function ua(r,t,e,i,n,o,a,s,l){var c=t.context,f=c.gl,m=n.paint.get("line-dasharray"),_=n.paint.get("line-pattern"),g,k,A,S;if(s||l){var C=1/Se(e,1,t.transform.tileZoom);if(m){g=t.lineAtlas.getDash(m.from,"round"===n.layout.get("line-cap")),k=t.lineAtlas.getDash(m.to,"round"===n.layout.get("line-cap"));var v=g.width*m.fromScale,y=k.width*m.toScale;f.uniform2f(r.uniforms.u_patternscale_a,C/v,-g.height/2),f.uniform2f(r.uniforms.u_patternscale_b,C/y,-k.height/2),f.uniform1f(r.uniforms.u_sdfgamma,t.lineAtlas.width/(256*ie(v,y)*ja.devicePixelRatio)/2)}else if(_){if(A=t.imageManager.getPattern(_.from),S=t.imageManager.getPattern(_.to),!A||!S)return;f.uniform2f(r.uniforms.u_pattern_size_a,A.displaySize[0]*_.fromScale/C,A.displaySize[1]),f.uniform2f(r.uniforms.u_pattern_size_b,S.displaySize[0]*_.toScale/C,S.displaySize[1]);var x=t.imageManager.getPixelSize(),b=x.width,w=x.height;f.uniform2fv(r.uniforms.u_texsize,[b,w])}f.uniform2f(r.uniforms.u_gl_units_to_pixels,1/t.transform.pixelsToGLUnits[0],1/t.transform.pixelsToGLUnits[1])}s&&(m?(f.uniform1i(r.uniforms.u_image,0),c.activeTexture.set(f.TEXTURE0),t.lineAtlas.bind(c),f.uniform1f(r.uniforms.u_tex_y_a,g.y),f.uniform1f(r.uniforms.u_tex_y_b,k.y),f.uniform1f(r.uniforms.u_mix,m.t)):_&&(f.uniform1i(r.uniforms.u_image,0),c.activeTexture.set(f.TEXTURE0),t.imageManager.bind(c),f.uniform2fv(r.uniforms.u_pattern_tl_a,A.tl),f.uniform2fv(r.uniforms.u_pattern_br_a,A.br),f.uniform2fv(r.uniforms.u_pattern_tl_b,S.tl),f.uniform2fv(r.uniforms.u_pattern_br_b,S.br),f.uniform1f(r.uniforms.u_fade,_.t))),c.setStencilMode(t.stencilModeForClipping(o));var L=t.translatePosMatrix(o.posMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"));if(f.uniformMatrix4fv(r.uniforms.u_matrix,!1,L),f.uniform1f(r.uniforms.u_ratio,1/Se(e,1,t.transform.zoom)),n.paint.get("line-gradient")){c.activeTexture.set(f.TEXTURE0);var T=n.gradientTexture;if(!n.gradient)return;T||(T=n.gradientTexture=new D(c,n.gradient,f.RGBA)),T.bind(f.LINEAR,f.CLAMP_TO_EDGE),f.uniform1i(r.uniforms.u_image,0)}r.draw(c,f.TRIANGLES,n.id,i.layoutVertexBuffer,i.indexBuffer,i.segments,a)}function ga(d,t,e,i,n){if(!eo(e.paint.get("fill-pattern"),d))for(var o=!0,p=0,g=i;p<g.length;p+=1){var s=g[p],l=t.getTile(s),c=l.getBucket(e);c&&(d.context.setStencilMode(d.stencilModeForClipping(s)),n(d,t,e,l,s,c,o),o=!1)}}function ha(d,t,e,i,n,o,r){var a=d.context.gl,s=o.programConfigurations.get(e.id);ya("fill",e.paint.get("fill-pattern"),d,s,e,i,n,r).draw(d.context,a.TRIANGLES,e.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,s)}function ma(d,t,e,i,n,o,r){var a=d.context.gl,s=o.programConfigurations.get(e.id),l=ya("fillOutline",e.getPaintProperty("fill-outline-color")?null:e.paint.get("fill-pattern"),d,s,e,i,n,r);a.uniform2f(l.uniforms.u_world,a.drawingBufferWidth,a.drawingBufferHeight),l.draw(d.context,a.LINES,e.id,o.layoutVertexBuffer,o.indexBuffer2,o.segments2,s)}function ya(d,t,e,i,n,o,r,a){var s=e.context.program.get(),c;return t?(c=e.useProgram(d+"Pattern",i),(a||c.program!==s)&&(i.setUniforms(e.context,c,n.paint,{zoom:e.transform.zoom}),to(t,e,c)),ao(o,e,c)):(c=e.useProgram(d,i),(a||c.program!==s)&&i.setUniforms(e.context,c,n.paint,{zoom:e.transform.zoom})),e.context.gl.uniformMatrix4fv(c.uniforms.u_matrix,!1,e.translatePosMatrix(r.posMatrix,o,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"))),c}function fa(d,t,e,i,n,o,r){var a=d.context,s=a.gl,l=e.paint.get("fill-extrusion-pattern"),c=d.context.program.get(),u=o.programConfigurations.get(e.id),g=d.useProgram(l?"fillExtrusionPattern":"fillExtrusion",u);if((r||g.program!==c)&&u.setUniforms(a,g,e.paint,{zoom:d.transform.zoom}),l){if(eo(l,d))return;to(l,d,g),ao(i,d,g),s.uniform1f(g.uniforms.u_height_factor,-_a(2,n.overscaledZ)/i.tileSize/8)}d.context.gl.uniformMatrix4fv(g.uniforms.u_matrix,!1,d.translatePosMatrix(n.posMatrix,i,e.paint.get("fill-extrusion-translate"),e.paint.get("fill-extrusion-translate-anchor"))),function(l,t){var e=t.context.gl,i=t.style.light,n=i.properties.get("position"),o=[n.x,n.y,n.z],r=oo.create();"viewport"===i.properties.get("anchor")&&oo.fromRotation(r,-t.transform.angle),io.transformMat3(o,o,r);var a=i.properties.get("color");e.uniform3fv(l.uniforms.u_lightpos,o),e.uniform1f(l.uniforms.u_lightintensity,i.properties.get("intensity")),e.uniform3f(l.uniforms.u_lightcolor,a.r,a.g,a.b)}(g,d),g.draw(a,s.TRIANGLES,e.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,u)}function xa(t,e,i){var n=t.context,o=n.gl,r=e.fbo;if(r){var a=t.useProgram("hillshade"),s=t.transform.calculatePosMatrix(e.tileID.toUnwrapped(),!0);!function(a,t,e){var o=e.paint.get("hillshade-illumination-direction")*(Sa/180);"viewport"===e.paint.get("hillshade-illumination-anchor")&&(o-=t.transform.angle),t.context.gl.uniform2f(a.uniforms.u_light,e.paint.get("hillshade-exaggeration"),o)}(a,t,i);var l=function(t,e){var a=e.toCoordinate(),r=new ta.default$17(a.column,a.row+1,a.zoom);return[t.transform.coordinateLocation(a).lat,t.transform.coordinateLocation(r).lat]}(t,e.tileID);n.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,r.colorAttachment.get()),o.uniformMatrix4fv(a.uniforms.u_matrix,!1,s),o.uniform2fv(a.uniforms.u_latrange,l),o.uniform1i(a.uniforms.u_image,0);var c=i.paint.get("hillshade-shadow-color");o.uniform4f(a.uniforms.u_shadow,c.r,c.g,c.b,c.a);var u=i.paint.get("hillshade-highlight-color");o.uniform4f(a.uniforms.u_highlight,u.r,u.g,u.b,u.a);var g=i.paint.get("hillshade-accent-color");if(o.uniform4f(a.uniforms.u_accent,g.r,g.g,g.b,g.a),e.maskedBoundsBuffer&&e.maskedIndexBuffer&&e.segments)a.draw(n,o.TRIANGLES,i.id,e.maskedBoundsBuffer,e.maskedIndexBuffer,e.segments);else{var p=t.rasterBoundsBuffer;t.rasterBoundsVAO.bind(n,a,p,[]),o.drawArrays(o.TRIANGLE_STRIP,0,p.length)}}}function ba(t,e,i){var n=t.context,o=n.gl;if(e.dem&&e.dem.level){var r=e.dem.level.dim,a=e.dem.getPixels();if(n.activeTexture.set(o.TEXTURE1),n.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||t.getTileTexture(e.tileSize),e.demTexture){var s=e.demTexture;s.update(a,{premultiply:!1}),s.bind(o.NEAREST,o.CLAMP_TO_EDGE)}else e.demTexture=new D(n,a,o.RGBA,{premultiply:!1}),e.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE);n.activeTexture.set(o.TEXTURE0);var l=e.fbo;if(!l){var g=new D(n,{width:r,height:r,data:null},o.RGBA);g.bind(o.LINEAR,o.CLAMP_TO_EDGE),(l=e.fbo=n.createFramebuffer(r,r)).colorAttachment.set(g.texture)}n.bindFramebuffer.set(l.framebuffer),n.viewport.set([0,0,r,r]);var u=ta.mat4.create();ta.mat4.ortho(u,0,ta.default$8,-ta.default$8,0,0,1),ta.mat4.translate(u,u,[0,-ta.default$8,0]);var h=t.useProgram("hillshadePrepare");o.uniformMatrix4fv(h.uniforms.u_matrix,!1,u),o.uniform1f(h.uniforms.u_zoom,e.tileID.overscaledZ),o.uniform2fv(h.uniforms.u_dimension,[2*r,2*r]),o.uniform1i(h.uniforms.u_image,1),o.uniform1f(h.uniforms.u_maxzoom,i);var p=t.rasterBoundsBuffer;t.rasterBoundsVAO.bind(n,h,p,[]),o.drawArrays(o.TRIANGLE_STRIP,0,p.length),e.needsHillshadePrepare=!1}}function Ta(t,e,r,i,o){var a=i.paint.get("raster-fade-duration");if(0<a){var n=ja.now(),l=(n-t.timeAdded)/a,s=e?(n-e.timeAdded)/a:-1,c=r.getSource(),u=o.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),p=!e||wa(e.tileID.overscaledZ-u)>wa(t.tileID.overscaledZ-u),d=p&&t.refreshedUponExpiration?1:ta.clamp(p?l:1-s,0,1);return t.refreshedUponExpiration&&1<=l&&(t.refreshedUponExpiration=!1),e?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}function Aa(t,e,r){var i=t.context,o=i.gl;i.lineWidth.set(1*ja.devicePixelRatio);var a=r.posMatrix,n=t.useProgram("debug");i.setDepthMode(jt.disabled),i.setStencilMode($t.disabled),i.setColorMode(t.colorModeForRenderPass()),o.uniformMatrix4fv(n.uniforms.u_matrix,!1,a),o.uniform4f(n.uniforms.u_color,1,0,0,1),t.debugVAO.bind(i,n,t.debugBuffer,[]),o.drawArrays(o.LINE_STRIP,0,t.debugBuffer.length);for(var l=function(d,t,g,i){i=i||1;var m=[],p,y,f,x,b,_,v,w;for(p=0,y=d.length;p<y;p++)if(b=no[d[p]]){for(w=null,f=0,x=b[1].length;f<x;f+=2)-1===b[1][f]&&-1===b[1][f+1]?w=null:(_=t+b[1][f]*i,v=g-b[1][f+1]*i,w&&m.push(w.x,w.y,_,v),w={x:_,y:v});t+=b[0]*i}return m}(r.toString(),50,200,5),s=new ta.PosArray,c=0;c<l.length;c+=2)s.emplaceBack(l[c],l[c+1]);var u=i.createVertexBuffer(s,Qe.members);new Q().bind(i,n,u,[]),o.uniform4f(n.uniforms.u_color,1,1,1,1);for(var p=e.getTile(r).tileSize,d=ta.default$8/(_a(2,t.transform.zoom-r.overscaledZ)*p),y=[[-1,-1],[-1,1],[1,-1],[1,1]],m=0,f;m<y.length;m++)f=y[m],o.uniformMatrix4fv(n.uniforms.u_matrix,!1,ta.mat4.translate([],a,[d*f[0],d*f[1],0])),o.drawArrays(o.LINES,0,u.length);o.uniform4f(n.uniforms.u_color,0,0,0,1),o.uniformMatrix4fv(n.uniforms.u_matrix,!1,a),o.drawArrays(o.LINES,0,u.length)}function Ca(a,o){if(a.row>o.row){var r=a;a=o,o=r}return{x0:a.column,y0:a.row,x1:o.column,y1:o.row,dx:o.column-a.column,dy:o.row-a.row}}function La(g,m,y,i,n){var o=va(y,ea(m.y0)),r=ie(i,ae(m.y1));if(g.x0===m.x0&&g.y0===m.y0?g.x0+m.dy/g.dy*g.dx<m.x1:g.x1-m.dy/g.dy*g.dx<m.x0){var a=g;g=m,m=a}for(var s=g.dx/g.dy,l=m.dx/m.dy,c=0<g.dx,u=0>m.dx,h=o;h<r;h++){var x=s*va(0,ie(g.dy,h+c-g.y0))+g.x0,d=l*va(0,ie(m.dy,h+u-m.y0))+m.x0;n(ea(d),ae(x),h)}}function Ea(d,t,e,i,n,o){var r=Ca(d,t),p=Ca(t,e),u=Ca(e,d),g;r.dy>p.dy&&(g=r,r=p,p=g),r.dy>u.dy&&(g=r,r=u,u=g),p.dy>u.dy&&(g=p,p=u,u=g),r.dy&&La(u,r,i,n,o),p.dy&&La(u,p,i,n,o)}function za(e){return e*(2-e)}function Ia(e){e.parentNode&&e.parentNode.removeChild(e)}function Da(l,s,e){if(l=new $(l.lng,l.lat),s){var i=new $(l.lng-360,l.lat),n=new $(l.lng+360,l.lat),o=e.locationPoint(l).distSqr(s);e.locationPoint(i).distSqr(s)<o?l=i:e.locationPoint(n).distSqr(s)<o&&(l=n)}for(;180<wa(l.lng-e.center.lng);){var r=e.locationPoint(l);if(0<=r.x&&0<=r.y&&r.x<=e.width&&r.y<=e.height)break;l.lng>e.center.lng?l.lng-=360:l.lng+=360}return l}function Pa(a,t,e){var r=a.classList;for(var i in No)r.remove("mapboxgl-"+e+"-anchor-"+i);r.add("mapboxgl-"+e+"-anchor-"+t)}function Oa(d,t,e){var i=e&&e.maxWidth||100,c=d._container.clientHeight/2,u=(g=d.unproject([0,c]),h=d.unproject([i,c]),m=Sa/180,y=g.lat*m,f=h.lat*m,x=M(y)*M(f)+te(y)*te(f)*te((h.lng-g.lng)*m),6371e3*v(ie(x,1))),g,h,m,y,f,x;if(e&&"imperial"===e.unit){var b=3.2808*u;5280<b?Ra(t,i,b/5280,"mi"):Ra(t,i,b,"ft")}else e&&"nautical"===e.unit?Ra(t,i,u/1852,"nm"):Ra(t,i,u,"m")}function Ra(d,t,e,i){var c=(l=e,(u=_a(10,(""+ea(l)).length-1))*(g=10<=(g=l/u)?10:5<=g?5:3<=g?3:2<=g?2:1)),p=c/e,l,u,g;"m"===i&&1e3<=c&&(c/=1e3,i="km"),d.style.width=t*p+"px",d.innerHTML=c+i}var Ma=ta.createCommonjsModule(function(a){function o(a){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var a=new Blob([""],{type:"text/javascript"}),o=URL.createObjectURL(a),r,i;try{i=new Worker(o),r=!0}catch(t){r=!1}return i&&i.terminate(),URL.revokeObjectURL(o),r}()&&"Uint8ClampedArray"in window&&function(a){return void 0===e[a]&&(e[a]=function(e){var t=document.createElement("canvas"),a=Object.create(o.webGLContextAttributes);return a.failIfMajorPerformanceCaveat=e,t.probablySupportsContext?t.probablySupportsContext("webgl",a)||t.probablySupportsContext("experimental-webgl",a):t.supportsContext?t.supportsContext("webgl",a)||t.supportsContext("experimental-webgl",a):t.getContext("webgl",a)||t.getContext("experimental-webgl",a)}(a)),e[a]}(a&&a.failIfMajorPerformanceCaveat))}a.exports?a.exports=o:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=o);var e={};o.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),e=ta.default.performance&&ta.default.performance.now?ta.default.performance.now.bind(ta.default.performance):Date.now.bind(Date),i=ta.default.requestAnimationFrame||ta.default.mozRequestAnimationFrame||ta.default.webkitRequestAnimationFrame||ta.default.msRequestAnimationFrame,n=ta.default.cancelAnimationFrame||ta.default.mozCancelAnimationFrame||ta.default.webkitCancelAnimationFrame||ta.default.msCancelAnimationFrame,ja={now:e,frame:function(e){return i(e)},cancelFrame:function(e){return n(e)},getImageData:function(t){var e=ta.default.document.createElement("canvas"),a=e.getContext("2d");if(!a)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,a.drawImage(t,0,0,t.width,t.height),a.getImageData(0,0,t.width,t.height)},hardwareConcurrency:ta.default.navigator.hardwareConcurrency||4,get devicePixelRatio(){return ta.default.devicePixelRatio},supportsWebp:!1};if(ta.default.document){var o=ta.default.document.createElement("img");o.onload=function(){ja.supportsWebp=!0},o.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="}var Ba={create:function(t,e,a){var r=ta.default.document.createElement(t);return e&&(r.className=e),a&&a.appendChild(r),r},createNS:function(t,e){return ta.default.document.createElementNS(t,e)}},a=ta.default.document?ta.default.document.documentElement.style:null,r=t(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),l;Ba.disableDrag=function(){a&&r&&(l=a[r],a[r]="none")},Ba.enableDrag=function(){a&&r&&(a[r]=l)};var s=t(["transform","WebkitTransform"]);Ba.setTransform=function(a,t){a.style[s]=t};var p=!1;try{var h=Object.defineProperty({},"passive",{get:function(){p=!0}});ta.default.addEventListener("test",h,h),ta.default.removeEventListener("test",h,h)}catch(e){p=!1}Ba.addEventListener=function(a,t,e,o){void 0===o&&(o={}),"passive"in o&&p?a.addEventListener(t,e,o):a.addEventListener(t,e,o.capture)},Ba.removeEventListener=function(a,t,e,o){void 0===o&&(o={}),"passive"in o&&p?a.removeEventListener(t,e,o):a.removeEventListener(t,e,o.capture)};var f=function(t){t.preventDefault(),t.stopPropagation(),ta.default.removeEventListener("click",f,!0)};Ba.suppressClick=function(){ta.default.addEventListener("click",f,!0),ta.default.setTimeout(function(){ta.default.removeEventListener("click",f,!0)},0)},Ba.mousePos=function(t,e){var a=t.getBoundingClientRect();return e=e.touches?e.touches[0]:e,new ta.default$1(e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop)},Ba.touchPos=function(t,e){for(var i=t.getBoundingClientRect(),n=[],o="touchend"===e.type?e.changedTouches:e.touches,r=0;r<o.length;r++)n.push(new ta.default$1(o[r].clientX-i.left-t.clientLeft,o[r].clientY-i.top-t.clientTop));return n},Ba.mouseButton=function(t){return void 0!==ta.default.InstallTrigger&&2===t.button&&t.ctrlKey&&0<=ta.default.navigator.platform.toUpperCase().indexOf("MAC")?0:t.button},Ba.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};var m={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null},_=function(a,t){if(!aa(a))return a;var e=y(a);return e.path="/fonts/v1"+e.path,c(e,t)},x=function(a,t){if(!aa(a))return a;var e=y(a);return e.path="/v4/"+e.authority+".json",e.params.push("secure"),c(e,t)},b=function(a,t,e,r){var i=y(a);return aa(a)?(i.path="/styles/v1"+i.path+"/sprite"+t+e,c(i,r)):(i.path+=""+t+e,C(i))},w=/(\.(png|jpg)\d*)(?=$)/,Fa=function(r,t,e){if(!t||!aa(t))return r;var i=y(r),n=2<=ja.devicePixelRatio||512===e?"@2x":"",o=ja.supportsWebp?".webp":"$1";return i.path=i.path.replace(w,""+n+o),function(a){for(var t=0;t<a.length;t++)0===a[t].indexOf("access_token=tk.")&&(a[t]="access_token="+(m.ACCESS_TOKEN||""))}(i.params),C(i)},T=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/,I=ta.default.HTMLImageElement,Na=ta.default.HTMLCanvasElement,A=ta.default.HTMLVideoElement,Va=ta.default.ImageData,D=function(a,t,e,o){this.context=a,this.format=e,this.texture=a.gl.createTexture(),this.update(t,o)};D.prototype.update=function(l,t){var e=l.width,i=l.height,n=!this.size||this.size[0]!==e||this.size[1]!==i,o=this.context,r=o.gl;this.useMipmap=!!(t&&t.useMipmap),r.bindTexture(r.TEXTURE_2D,this.texture),n?(this.size=[e,i],o.pixelStoreUnpack.set(1),this.format!==r.RGBA||t&&!1===t.premultiply||o.pixelStoreUnpackPremultiplyAlpha.set(!0),l instanceof I||l instanceof Na||l instanceof A||l instanceof Va?r.texImage2D(r.TEXTURE_2D,0,this.format,this.format,r.UNSIGNED_BYTE,l):r.texImage2D(r.TEXTURE_2D,0,this.format,e,i,0,this.format,r.UNSIGNED_BYTE,l.data)):l instanceof I||l instanceof Na||l instanceof A||l instanceof Va?r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,l):r.texSubImage2D(r.TEXTURE_2D,0,0,0,e,i,r.RGBA,r.UNSIGNED_BYTE,l.data),this.useMipmap&&this.isSizePowerOfTwo()&&r.generateMipmap(r.TEXTURE_2D)},D.prototype.bind=function(a,t,e){var o=this.context.gl;o.bindTexture(o.TEXTURE_2D,this.texture),e!==o.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(e=o.LINEAR),a!==this.filter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,a),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,e||a),this.filter=a),t!==this.wrap&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,t),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,t),this.wrap=t)},D.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&0==P(this.size[0])/E%1},D.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Ua=function(){this.images={},this.loaded=!1,this.requestors=[],this.shelfPack=new ta.default$2(64,64,{autoResize:!0}),this.patterns={},this.atlasImage=new ta.RGBAImage({width:64,height:64}),this.dirty=!0};Ua.prototype.isLoaded=function(){return this.loaded},Ua.prototype.setLoaded=function(a){if(this.loaded!==a&&(this.loaded=a,a)){for(var t=0,l=this.requestors;t<l.length;t+=1){var i=l[t],n=i.ids,o=i.callback;this._notify(n,o)}this.requestors=[]}},Ua.prototype.getImage=function(e){return this.images[e]},Ua.prototype.addImage=function(a,t){this.images[a]=t},Ua.prototype.removeImage=function(a){delete this.images[a];var t=this.patterns[a];t&&(this.shelfPack.unref(t.bin),delete this.patterns[a])},Ua.prototype.getImages=function(a,t){var e=!0;if(!this.isLoaded())for(var l=0,s=a,o;l<s.length;l+=1)o=s[l],this.images[o]||(e=!1);this.isLoaded()||e?this._notify(a,t):this.requestors.push({ids:a,callback:t})},Ua.prototype._notify=function(l,t){for(var e={},i=0,s=l;i<s.length;i+=1){var o=s[i],r=this.images[o];r&&(e[o]={data:r.data.clone(),pixelRatio:r.pixelRatio,sdf:r.sdf})}t(null,e)},Ua.prototype.getPixelSize=function(){return{width:this.shelfPack.w,height:this.shelfPack.h}},Ua.prototype.getPattern=function(t){var e=this.patterns[t];if(e)return e.position;var i=this.getImage(t);if(!i)return null;var n=i.data.width+2,o=i.data.height+2,r=this.shelfPack.packOne(n,o);if(!r)return null;this.atlasImage.resize(this.getPixelSize());var a=i.data,s=this.atlasImage,l=r.x+1,c=r.y+1,u=a.width,g=a.height;ta.RGBAImage.copy(a,s,{x:0,y:0},{x:l,y:c},{width:u,height:g}),ta.RGBAImage.copy(a,s,{x:0,y:g-1},{x:l,y:c-1},{width:u,height:1}),ta.RGBAImage.copy(a,s,{x:0,y:0},{x:l,y:c+g},{width:u,height:1}),ta.RGBAImage.copy(a,s,{x:u-1,y:0},{x:l-1,y:c},{width:1,height:g}),ta.RGBAImage.copy(a,s,{x:0,y:0},{x:l+u,y:c},{width:1,height:g}),this.dirty=!0;var p=new ta.ImagePosition(r,i);return this.patterns[t]={bin:r,position:p},p},Ua.prototype.bind=function(a){var t=a.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new D(a,this.atlasImage,t.RGBA),this.atlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE)};S.prototype.draw=function(a){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(a,this.buffer,this.middle);for(var t=this.ctx.getImageData(0,0,this.size,this.size),e=new Uint8ClampedArray(this.size*this.size),i=0,l;i<this.size*this.size;i++)l=t.data[4*i+3]/255,this.gridOuter[i]=1===l?0:0===l?100000000000000000000:_a(va(0,.5-l),2),this.gridInner[i]=1===l?100000000000000000000:0===l?0:_a(va(0,l-.5),2);for(B(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),B(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++){var s=this.gridOuter[i]-this.gridInner[i];e[i]=va(0,ie(255,R(255-255*(s/this.radius+this.cutoff))))}return e};var Ha=function(a,t){this.requestTransform=a,this.localIdeographFontFamily=t,this.entries={}};Ha.prototype.setURL=function(e){this.url=e},Ha.prototype.getGlyphs=function(t,d){var c=this,e=[];for(var o in t)for(var r=0,i=t[o],n;r<i.length;r+=1)n=i[r],e.push({stack:o,id:n});ta.asyncAll(e,function(n,d){var e=n.stack,i=n.id,p=c.entries[e];p||(p=c.entries[e]={glyphs:{},requests:{}});var t=p.glyphs[i];if(void 0!==t)d(null,{stack:e,id:i,glyph:t});else if(t=c._tinySDF(p,e,i))d(null,{stack:e,id:i,glyph:t});else{var u=ea(i/256);if(65535<256*u)d(new Error("glyphs > 65535 not supported"));else{var s=p.requests[u];s||(s=p.requests[u]=[],Ha.loadGlyphRange(e,u,c.url,c.requestTransform,function(a,t){if(t)for(var e in t)p.glyphs[+e]=t[+e];for(var r=0,i=s;r<i.length;r+=1)(0,i[r])(a,t);delete p.requests[u]})),s.push(function(a,t){a?d(a):t&&d(null,{stack:e,id:i,glyph:t[i]||null})})}}},function(i,t){if(i)d(i);else if(t){for(var e={},n=0,p=t;n<p.length;n+=1){var r=p[n],a=r.stack,s=r.id,l=r.glyph;(e[a]||(e[a]={}))[s]=l&&{id:l.id,bitmap:l.bitmap.clone(),metrics:l.metrics}}d(null,e)}})},Ha.prototype._tinySDF=function(t,e,i){var n=this.localIdeographFontFamily;if(n&&(ta.default$4["CJK Unified Ideographs"](i)||ta.default$4["Hangul Syllables"](i))){var o=t.tinySDF;if(!o){var l="400";/bold/i.test(e)?l="900":/medium/i.test(e)?l="500":/light/i.test(e)&&(l="200"),o=t.tinySDF=new Ha.TinySDF(24,3,8,.25,n,l)}return{id:i,bitmap:new ta.AlphaImage({width:30,height:30},o.draw(O(i))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ha.loadGlyphRange=function(t,e,i,n,d){var o=256*e,a=n(_(i).replace("{fontstack}",t).replace("{range}",o+"-"+(o+255)),ta.ResourceType.Glyphs);ta.getArrayBuffer(a,function(t,e){if(t)d(t);else if(e){for(var r={},i=0,n=ta.default$3(e.data),a;i<n.length;i+=1)a=n[i],r[a.id]=a;d(null,r)}})},Ha.TinySDF=S;var N=function(){this.specification=ta.default$5.light.position};N.prototype.possiblyEvaluate=function(t,e){return ta.sphericalToCartesian(t.expression.evaluate(e))},N.prototype.interpolate=function(t,e,a){return{x:ta.number(t.x,e.x,a),y:ta.number(t.y,e.y,a),z:ta.number(t.z,e.z,a)}};var U=new ta.Properties({anchor:new ta.DataConstantProperty(ta.default$5.light.anchor),position:new N,color:new ta.DataConstantProperty(ta.default$5.light.color),intensity:new ta.DataConstantProperty(ta.default$5.light.intensity)}),Z=function(t){function e(e){t.call(this),this._transitionable=new ta.Transitionable(U),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLight=function(){return this._transitionable.serialize()},e.prototype.setLight=function(t){if(!this._validate(ta.validateLight,t))for(var e in t){var a=t[e];ta.endsWith(e,"-transition")?this._transitionable.setTransition(e.slice(0,-11),a):this._transitionable.setValue(e,a)}},e.prototype.updateTransitions=function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)},e.prototype.hasTransition=function(){return this._transitioning.hasTransition()},e.prototype.recalculate=function(e){this.properties=this._transitioning.possiblyEvaluate(e)},e.prototype._validate=function(t,e){return ta.emitValidationErrors(this,t.call(ta.validateStyle,ta.extend({value:e,style:{glyphs:!0,sprite:!0},styleSpec:ta.default$5})))},e}(ta.Evented),V=function(a,t){this.width=a,this.height=t,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};V.prototype.getDash=function(a,t){var e=a.join(",")+(t+"");return this.positions[e]||(this.positions[e]=this.addDash(a,t)),this.positions[e]},V.prototype.addDash=function(t,e){var i=e?7:0,n=2*i+1;if(this.nextRow+n>this.height)return ta.warnOnce("LineAtlas out of space"),null;for(var o=0,k=0;k<t.length;k++)o+=t[k];for(var A=this.width/o,s=A/2,l=1==t.length%2,c=-i;c<=i;c++)for(var S=this.nextRow+i+c,h=this.width*S,p=l?-t[t.length-1]:0,C=t[0],L=1,z=0;z<this.width;z++){for(;C<z/A;)p=C,C+=t[L],l&&L==t.length-1&&(C+=t[0]),L++;var I=wa(z-p*A),g=wa(z-C*A),v=ie(I,g),y=1==L%2,x=void 0;if(e){var D=i?c/i*(s+1):0;if(y){var w=s-wa(D);x=re(v*v+w*w)}else x=s-re(v*v+D*D)}else x=(y?1:-1)*v;this.data[3+4*(h+z)]=va(0,ie(255,x+128))}var E={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:o};return this.nextRow+=n,this.dirty=!0,E},V.prototype.bind=function(a){var t=a.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.RGBA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,this.data))};var j=function t(e,i){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=ta.uniqueId();for(var n=this.workerPool.acquire(this.id),o=0;o<n.length;o++){var l=n[o],a=new t.Actor(l,i,this.id);a.name="Worker "+o,this.actors.push(a)}};j.prototype.broadcast=function(a,e,t){t=t||function(){},ta.asyncAll(this.actors,function(o,t){o.send(a,e,t)},t)},j.prototype.send=function(a,t,e,o){return("number"!=typeof o||isNaN(o))&&(o=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[o].send(a,t,e),o},j.prototype.remove=function(){this.actors.forEach(function(e){e.remove()}),this.actors=[],this.workerPool.release(this.id)},j.Actor=ta.default$7;var $=function(a,t){if(isNaN(a)||isNaN(t))throw new Error("Invalid LngLat object: ("+a+", "+t+")");if(this.lng=+a,this.lat=+t,90<this.lat||-90>this.lat)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};$.prototype.wrap=function(){return new $(ta.wrap(this.lng,-180,180),this.lat)},$.prototype.toArray=function(){return[this.lng,this.lat]},$.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},$.prototype.toBounds=function(a){var t=360*a/40075017,e=t/te(Sa/180*this.lat);return new W(new $(this.lng-e,this.lat-t),new $(this.lng+e,this.lat+t))},$.convert=function(e){if(e instanceof $)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new $(+e[0],+e[1]);if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new $(+e.lng,+e.lat);throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var W=function(a,t){a&&(t?this.setSouthWest(a).setNorthEast(t):4===a.length?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))};W.prototype.setNorthEast=function(e){return this._ne=e instanceof $?new $(e.lng,e.lat):$.convert(e),this},W.prototype.setSouthWest=function(e){return this._sw=e instanceof $?new $(e.lng,e.lat):$.convert(e),this},W.prototype.extend=function(a){var t=this._sw,r=this._ne,o,n;if(a instanceof $)o=a,n=a;else{if(!(a instanceof W))return Array.isArray(a)?a.every(Array.isArray)?this.extend(W.convert(a)):this.extend($.convert(a)):this;if(o=a._sw,n=a._ne,!o||!n)return this}return t||r?(t.lng=ie(o.lng,t.lng),t.lat=ie(o.lat,t.lat),r.lng=va(n.lng,r.lng),r.lat=va(n.lat,r.lat)):(this._sw=new $(o.lng,o.lat),this._ne=new $(n.lng,n.lat)),this},W.prototype.getCenter=function(){return new $((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},W.prototype.getSouthWest=function(){return this._sw},W.prototype.getNorthEast=function(){return this._ne},W.prototype.getNorthWest=function(){return new $(this.getWest(),this.getNorth())},W.prototype.getSouthEast=function(){return new $(this.getEast(),this.getSouth())},W.prototype.getWest=function(){return this._sw.lng},W.prototype.getSouth=function(){return this._sw.lat},W.prototype.getEast=function(){return this._ne.lng},W.prototype.getNorth=function(){return this._ne.lat},W.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},W.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},W.prototype.isEmpty=function(){return!(this._sw&&this._ne)},W.convert=function(e){return!e||e instanceof W?e:new W(e)};var q=function(a,t,e){this.bounds=W.convert(this.validateBounds(a)),this.minzoom=t||0,this.maxzoom=e||24};q.prototype.validateBounds=function(e){return Array.isArray(e)&&4===e.length?[va(-180,e[0]),va(-90,e[1]),ie(180,e[2]),ie(90,e[3])]:[-180,-90,180,90]},q.prototype.contains=function(a){var t=ea(this.lngX(this.bounds.getWest(),a.z)),e=ea(this.latY(this.bounds.getNorth(),a.z)),r=ae(this.lngX(this.bounds.getEast(),a.z)),i=ae(this.latY(this.bounds.getSouth(),a.z));return a.x>=t&&a.x<r&&a.y>=e&&a.y<i},q.prototype.lngX=function(a,t){return(a+180)*(_a(2,t)/360)},q.prototype.latY=function(t,e){var a=ta.clamp(M(Sa/180*t),-.9999,.9999),r=_a(2,e)/(2*Sa);return _a(2,e-1)+.5*P((1+a)/(1-a))*-r};var X=function(t){function e(e,a,i,o){if(t.call(this),this.id=e,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,ta.extend(this,ta.pick(a,["url","scheme","tileSize"])),this._options=ta.extend({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(o)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire(new ta.Event("dataloading",{dataType:"source"})),F(this._options,this.map._transformRequest,function(e,a){e?t.fire(new ta.ErrorEvent(e)):a&&(ta.extend(t,a),a.bounds&&(t.tileBounds=new q(a.bounds,t.minzoom,t.maxzoom)),t.fire(new ta.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new ta.Event("data",{dataType:"source",sourceDataType:"content"})))})},e.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},e.prototype.onAdd=function(e){this.map=e,this.load()},e.prototype.serialize=function(){return ta.extend({},this._options)},e.prototype.loadTile=function(r,e){function t(a,t){return r.aborted?e(null):a?e(a):(t&&t.resourceTiming&&(r.resourceTiming=t.resourceTiming),this.map._refreshExpiredTiles&&r.setExpiryData(t),r.loadVectorData(t,this.map.painter),e(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}var a=Fa(r.tileID.canonical.url(this.tiles,this.scheme),this.url),i={request:this.map._transformRequest(a,ta.ResourceType.Tile),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:ja.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};i.request.collectResourceTiming=this._collectResourceTiming,void 0===r.workerID||"expired"===r.state?r.workerID=this.dispatcher.send("loadTile",i,t.bind(this)):"loading"===r.state?r.reloadCallback=e:this.dispatcher.send("reloadTile",i,t.bind(this),r.workerID)},e.prototype.abortTile=function(e){this.dispatcher.send("abortTile",{uid:e.uid,type:this.type,source:this.id},void 0,e.workerID)},e.prototype.unloadTile=function(e){e.unloadVectorData(),this.dispatcher.send("removeTile",{uid:e.uid,type:this.type,source:this.id},void 0,e.workerID)},e.prototype.hasTransition=function(){return!1},e}(ta.Evented),H=function(t){function e(e,a,i,o){t.call(this),this.id=e,this.dispatcher=i,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=ta.extend({},a),ta.extend(this,ta.pick(a,["url","scheme","tileSize"]))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire(new ta.Event("dataloading",{dataType:"source"})),F(this._options,this.map._transformRequest,function(e,a){e?t.fire(new ta.ErrorEvent(e)):a&&(ta.extend(t,a),a.bounds&&(t.tileBounds=new q(a.bounds,t.minzoom,t.maxzoom)),t.fire(new ta.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new ta.Event("data",{dataType:"source",sourceDataType:"content"})))})},e.prototype.onAdd=function(e){this.map=e,this.load()},e.prototype.serialize=function(){return ta.extend({},this._options)},e.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},e.prototype.loadTile=function(l,e){var t=this,a=Fa(l.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);l.request=ta.getImage(this.map._transformRequest(a,ta.ResourceType.Tile),function(i,n){if(delete l.request,l.aborted)l.state="unloaded",e(null);else if(i)l.state="errored",e(i);else if(n){t.map._refreshExpiredTiles&&l.setExpiryData(n),delete n.cacheControl,delete n.expires;var o=t.map.painter.context,r=o.gl;l.texture=t.map.painter.getTileTexture(n.width),l.texture?l.texture.update(n,{useMipmap:!0}):(l.texture=new D(o,n,r.RGBA,{useMipmap:!0}),l.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST),o.extTextureFilterAnisotropic&&r.texParameterf(r.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax)),l.state="loaded",e(null)}})},e.prototype.abortTile=function(a,t){a.request&&(a.request.abort(),delete a.request),t()},e.prototype.unloadTile=function(a,t){a.texture&&this.map.painter.saveTileTexture(a.texture),t()},e.prototype.hasTransition=function(){return!1},e}(ta.Evented),K=function(t){function e(e,a,i,o){t.call(this,e,a,i,o),this.type="raster-dem",this.maxzoom=22,this._options=ta.extend({},a),this.encoding=a.encoding||"mapbox"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},e.prototype.loadTile=function(r,e){var t=Fa(r.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);r.request=ta.getImage(this.map._transformRequest(t,ta.ResourceType.Tile),function(i,t){if(delete r.request,r.aborted)r.state="unloaded",e(null);else if(i)r.state="errored",e(i);else if(t){this.map._refreshExpiredTiles&&r.setExpiryData(t),delete t.cacheControl,delete t.expires;var n=ja.getImageData(t),o={uid:r.uid,coord:r.tileID,source:this.id,rawImageData:n,encoding:this.encoding};r.workerID&&"expired"!==r.state||(r.workerID=this.dispatcher.send("loadDEMTile",o,function(a,t){a&&(r.state="errored",e(a)),t&&(r.dem=t,r.needsHillshadePrepare=!0,r.state="loaded",e(null))}.bind(this)))}}.bind(this)),r.neighboringTiles=this._getNeighboringTiles(r.tileID)},e.prototype._getNeighboringTiles=function(t){var e=t.canonical,i=_a(2,e.z),n=(e.x-1+i)%i,o=0===e.x?t.wrap-1:t.wrap,r=(e.x+1+i)%i,a=e.x+1===i?t.wrap+1:t.wrap,s={};return s[new ta.OverscaledTileID(t.overscaledZ,o,e.z,n,e.y).key]={backfilled:!1},s[new ta.OverscaledTileID(t.overscaledZ,a,e.z,r,e.y).key]={backfilled:!1},0<e.y&&(s[new ta.OverscaledTileID(t.overscaledZ,o,e.z,n,e.y-1).key]={backfilled:!1},s[new ta.OverscaledTileID(t.overscaledZ,t.wrap,e.z,e.x,e.y-1).key]={backfilled:!1},s[new ta.OverscaledTileID(t.overscaledZ,a,e.z,r,e.y-1).key]={backfilled:!1}),e.y+1<i&&(s[new ta.OverscaledTileID(t.overscaledZ,o,e.z,n,e.y+1).key]={backfilled:!1},s[new ta.OverscaledTileID(t.overscaledZ,t.wrap,e.z,e.x,e.y+1).key]={backfilled:!1},s[new ta.OverscaledTileID(t.overscaledZ,a,e.z,r,e.y+1).key]={backfilled:!1}),s},e.prototype.unloadTile=function(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",this.dispatcher.send("removeDEMTile",{uid:e.uid,source:this.id},void 0,e.workerID)},e}(H),Y=function(t){function e(e,i,n,o){t.call(this),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this.dispatcher=n,this.setEventedParent(o),this._data=i.data,this._options=ta.extend({},i),this._collectResourceTiming=i.collectResourceTiming,this._resourceTiming=[],void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type);var r=ta.default$8/this.tileSize;this.workerOptions=ta.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0===i.buffer?128:i.buffer)*r,tolerance:(void 0===i.tolerance?.375:i.tolerance)*r,extent:ta.default$8,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1},superclusterOptions:{maxZoom:void 0===i.clusterMaxZoom?this.maxzoom-1:ie(i.clusterMaxZoom,this.maxzoom-1),extent:ta.default$8,radius:(i.clusterRadius||50)*r,log:!1}},i.workerOptions)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire(new ta.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(e){if(e)t.fire(new ta.ErrorEvent(e));else{var a={dataType:"source",sourceDataType:"metadata"};t._collectResourceTiming&&t._resourceTiming&&0<t._resourceTiming.length&&(a.resourceTiming=t._resourceTiming,t._resourceTiming=[]),t.fire(new ta.Event("data",a))}})},e.prototype.onAdd=function(e){this.map=e,this.load()},e.prototype.setData=function(t){var a=this;return this._data=t,this.fire(new ta.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(t){if(t)return a.fire(new ta.ErrorEvent(t));var e={dataType:"source",sourceDataType:"content"};a._collectResourceTiming&&a._resourceTiming&&0<a._resourceTiming.length&&(e.resourceTiming=a._resourceTiming,a._resourceTiming=[]),a.fire(new ta.Event("data",e))}),this},e.prototype._updateWorkerData=function(l){var e=this,o=ta.extend({},this.workerOptions),t=this._data,a,r;"string"==typeof t?(o.request=this.map._transformRequest((a=t,(r=ta.default.document.createElement("a")).href=a,r.href),ta.ResourceType.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(t),this.workerID=this.dispatcher.send(this.type+"."+o.source+".loadData",o,function(a,t){e._removed||t&&t.abandoned||(e._loaded=!0,t&&t.resourceTiming&&t.resourceTiming[e.id]&&(e._resourceTiming=t.resourceTiming[e.id].slice(0)),e.dispatcher.send(e.type+"."+o.source+".coalesce",null,null,e.workerID),l(a))},this.workerID)},e.prototype.loadTile=function(a,t){var e=this,i=void 0===a.workerID?"loadTile":"reloadTile",r={type:this.type,uid:a.uid,tileID:a.tileID,zoom:a.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:ja.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};a.workerID=this.dispatcher.send(i,r,function(n,o){return a.unloadVectorData(),a.aborted?t(null):n?t(n):(a.loadVectorData(o,e.map.painter,"reloadTile"==i),t(null))},this.workerID)},e.prototype.abortTile=function(e){e.aborted=!0},e.prototype.unloadTile=function(e){e.unloadVectorData(),this.dispatcher.send("removeTile",{uid:e.uid,type:this.type,source:this.id},null,e.workerID)},e.prototype.onRemove=function(){this._removed=!0,this.dispatcher.send("removeSource",{type:this.type,source:this.id},null,this.workerID)},e.prototype.serialize=function(){return ta.extend({},this._options,{type:this.type,data:this._data})},e.prototype.hasTransition=function(){return!1},e}(ta.Evented),J=ta.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Q=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};Q.prototype.bind=function(d,t,e,i,n,o,r,a){this.context=d;for(var s=this.boundPaintVertexBuffers.length!==i.length,p=0;!s&&p<i.length;p++)this.boundPaintVertexBuffers[p]!==i[p]&&(s=!0);var g=!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==e||s||this.boundIndexBuffer!==n||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==r||this.boundDynamicVertexBuffer2!==a;!d.extVertexArrayObject||g?this.freshBind(t,e,i,n,o,r,a):(d.bindVertexArrayOES.set(this.vao),r&&r.bind(),n&&n.dynamicDraw&&n.bind(),a&&a.bind())},Q.prototype.freshBind=function(g,t,e,i,n,o,r){var a=g.numAttributes,l=this.context,c=l.gl,u;if(l.extVertexArrayObject)this.vao&&this.destroy(),this.vao=l.extVertexArrayObject.createVertexArrayOES(),l.bindVertexArrayOES.set(this.vao),u=0,this.boundProgram=g,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=e,this.boundIndexBuffer=i,this.boundVertexOffset=n,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=r;else{u=l.currentNumAttributes||0;for(var y=a;y<u;y++)c.disableVertexAttribArray(y)}t.enableAttributes(c,g);for(var x=0,b=e;x<b.length;x+=1)b[x].enableAttributes(c,g);o&&o.enableAttributes(c,g),r&&r.enableAttributes(c,g),t.bind(),t.setVertexAttribPointers(c,g,n);for(var d=0,v=e,m;d<v.length;d+=1)m=v[d],m.bind(),m.setVertexAttribPointers(c,g,n);o&&(o.bind(),o.setVertexAttribPointers(c,g,n)),i&&i.bind(),r&&(r.bind(),r.setVertexAttribPointers(c,g,n)),l.currentNumAttributes=a},Q.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var tt=function(a){function e(e,t,r,i){a.call(this),this.id=e,this.dispatcher=r,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(i),this.options=t}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;this.fire(new ta.Event("dataloading",{dataType:"source"})),this.url=this.options.url,ta.getImage(this.map._transformRequest(this.url,ta.ResourceType.Image),function(e,a){e?t.fire(new ta.ErrorEvent(e)):a&&(t.image=ja.getImageData(a),t._finishLoading())})},e.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new ta.Event("data",{dataType:"source",sourceDataType:"metadata"})))},e.prototype.onAdd=function(e){this.map=e,this.load()},e.prototype.setCoordinates=function(t){this.coordinates=t;var e=this.map,a=t.map(function(a){return e.transform.locationCoordinate($.convert(a)).zoomTo(0)}),n=this.centerCoord=ta.getCoordinatesCenter(a);n.column=ea(n.column),n.row=ea(n.row),this.tileID=new ta.CanonicalTileID(n.zoom,n.column,n.row),this.minzoom=this.maxzoom=n.zoom;var o=a.map(function(t){var e=t.zoomTo(n.zoom);return new ta.default$1(R((e.column-n.column)*ta.default$8),R((e.row-n.row)*ta.default$8))});return this._boundsArray=new ta.RasterBoundsArray,this._boundsArray.emplaceBack(o[0].x,o[0].y,0,0),this._boundsArray.emplaceBack(o[1].x,o[1].y,ta.default$8,0),this._boundsArray.emplaceBack(o[3].x,o[3].y,0,ta.default$8),this._boundsArray.emplaceBack(o[2].x,o[2].y,ta.default$8,ta.default$8),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new ta.Event("data",{dataType:"source",sourceDataType:"content"})),this},e.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var a=this.map.painter.context,t=a.gl;for(var e in this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,J.members)),this.boundsVAO||(this.boundsVAO=new Q),this.texture||(this.texture=new D(a,this.image,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE)),this.tiles){var o=this.tiles[e];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},e.prototype.loadTile=function(a,t){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[a.tileID.wrap+""]=a,a.buckets={},t(null)):(a.state="errored",t(null))},e.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},e.prototype.hasTransition=function(){return!1},e}(ta.Evented),et=function(a){function e(e,t,r,i){a.call(this,e,t,r,i),this.roundZoom=!0,this.type="video",this.options=t}return a&&(e.__proto__=a),e.prototype=Object.create(a&&a.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this,e=this.options;this.urls=[];for(var a=0,i=e.urls,o;a<i.length;a+=1)o=i[a],t.urls.push(t.map._transformRequest(o,ta.ResourceType.Source).url);ta.getVideo(this.urls,function(e,a){e?t.fire(new ta.ErrorEvent(e)):a&&(t.video=a,t.video.loop=!0,t.video.addEventListener("playing",function(){t.map._rerender()}),t.map&&t.video.play(),t._finishLoading())})},e.prototype.getVideo=function(){return this.video},e.prototype.onAdd=function(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},e.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||2>this.video.readyState)){var a=this.map.painter.context,t=a.gl;for(var e in this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,J.members)),this.boundsVAO||(this.boundsVAO=new Q),this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new D(a,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE)),this.tiles){var o=this.tiles[e];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},e.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},e.prototype.hasTransition=function(){return this.video&&!this.video.paused},e}(tt),it=function(t){function e(e,a,i,o){t.call(this,e,a,i,o),a.coordinates?Array.isArray(a.coordinates)&&4===a.coordinates.length&&!a.coordinates.some(function(e){return!Array.isArray(e)||2!==e.length||e.some(function(e){return"number"!=typeof e})})||this.fire(new ta.ErrorEvent(new ta.default$9("sources."+e,null,"\"coordinates\" property must be an array of 4 longitude/latitude array pairs"))):this.fire(new ta.ErrorEvent(new ta.default$9("sources."+e,null,"missing required property \"coordinates\""))),a.animate&&"boolean"!=typeof a.animate&&this.fire(new ta.ErrorEvent(new ta.default$9("sources."+e,null,"optional \"animate\" property must be a boolean value"))),a.canvas?"string"==typeof a.canvas||a.canvas instanceof ta.default.HTMLCanvasElement||this.fire(new ta.ErrorEvent(new ta.default$9("sources."+e,null,"\"canvas\" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance"))):this.fire(new ta.ErrorEvent(new ta.default$9("sources."+e,null,"missing required property \"canvas\""))),this.options=a,this.animate=void 0===a.animate||a.animate}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){this.canvas||(this.canvas=this.options.canvas instanceof ta.default.HTMLCanvasElement?this.options.canvas:ta.default.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new ta.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map._rerender()},this.pause=function(){this._playing=!1},this._finishLoading())},e.prototype.getCanvas=function(){return this.canvas},e.prototype.onAdd=function(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()},e.prototype.onRemove=function(){this.pause()},e.prototype.prepare=function(){var a=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,a=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,a=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var r=this.map.painter.context,e=r.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,J.members)),this.boundsVAO||(this.boundsVAO=new Q),this.texture?a?this.texture.update(this.canvas):this._playing&&(this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE),e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,this.canvas)):(this.texture=new D(r,this.canvas,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE)),this.tiles){var n=this.tiles[i];"loaded"!==n.state&&(n.state="loaded",n.texture=this.texture)}}},e.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},e.prototype.hasTransition=function(){return this._playing},e.prototype._hasInvalidDimensions=function(){for(var a=0,o=[this.canvas.width,this.canvas.height],e;a<o.length;a+=1)if(e=o[a],isNaN(e)||0>=e)return!0;return!1},e}(tt),nt={vector:X,raster:H,"raster-dem":K,geojson:Y,video:et,image:tt,canvas:it},ot=function(t,e,a,i){var o=new nt[e.type](t,e,a,i);if(o.id!==t)throw new Error("Expected Source id to be "+t+" instead of "+o.id);return ta.bindAll(["load","abort","unload","serialize","prepare"],o),o},rt=function(t,e){this.tileID=t,this.uid=ta.uniqueId(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.expiredRequestCount=0,this.state="loading"};rt.prototype.registerFadeDuration=function(a){var t=a+this.timeAdded;t<ja.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},rt.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},rt.prototype.loadVectorData=function(t,e,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){if(t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(d,c){var e={};if(!c)return e;for(var t=0,i=d;t<i.length;t+=1){var o=i[t],r=o.layerIds.map(function(e){return c.getLayer(e)}).filter(Boolean);if(0!==r.length){o.layers=r;for(var a=0,p=r;a<p.length;a+=1)e[p[a].id]=o}}return e}(t.buckets,e.style),i)for(var n in this.buckets){var o=this.buckets[n];o instanceof ta.default$14&&(o.justReloaded=!0)}for(var r in this.queryPadding=0,this.buckets){var a=this.buckets[r];this.queryPadding=va(this.queryPadding,e.style.getLayer(a.layerIds[0]).queryRadius(a))}t.iconAtlasImage&&(this.iconAtlasImage=t.iconAtlasImage),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new ta.CollisionBoxArray},rt.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.iconAtlasTexture&&this.iconAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},rt.prototype.unloadDEMData=function(){this.dem=null,this.neighboringTiles=null,this.state="unloaded"},rt.prototype.getBucket=function(e){return this.buckets[e.id]},rt.prototype.upload=function(a){for(var t in this.buckets){var e=this.buckets[t];e.uploaded||(e.upload(a),e.uploaded=!0)}var o=a.gl;this.iconAtlasImage&&(this.iconAtlasTexture=new D(a,this.iconAtlasImage,o.RGBA),this.iconAtlasImage=null),this.glyphAtlasImage&&(this.glyphAtlasTexture=new D(a,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)},rt.prototype.queryRenderedFeatures=function(l,t,e,i,n,o,r){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:t,scale:e,tileSize:this.tileSize,posMatrix:r,transform:n,params:i,queryPadding:this.queryPadding*o},l):{}},rt.prototype.querySourceFeatures=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var i=this.latestFeatureIndex.loadVTLayers(),n=e?e.sourceLayer:"",o=i._geojsonTileLayer||i[n];if(o)for(var r=ta.default$13(e&&e.filter),a={z:this.tileID.overscaledZ,x:this.tileID.canonical.x,y:this.tileID.canonical.y},s=0,d;s<o.length;s++)if(d=o.feature(s),r(new ta.default$16(this.tileID.overscaledZ),d)){var p=new ta.default$12(d,a.z,a.x,a.y);p.tile=a,t.push(p)}}},rt.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)},rt.prototype.setMask=function(t,e){if(!ta.default$10(this.mask,t)&&(this.mask=t,this.clearMask(),!ta.default$10(t,{0:!0}))){var i=new ta.RasterBoundsArray,n=new ta.TriangleIndexArray;this.segments=new ta.default$15,this.segments.prepareSegment(0,i,n);for(var o=Object.keys(t),r=0;r<o.length;r++){var d=t[o[r]],s=ta.default$8>>d.z,l=new ta.default$1(d.x*s,d.y*s),c=new ta.default$1(l.x+s,l.y+s),u=this.segments.prepareSegment(4,i,n);i.emplaceBack(l.x,l.y,l.x,l.y),i.emplaceBack(c.x,l.y,c.x,l.y),i.emplaceBack(l.x,c.y,l.x,c.y),i.emplaceBack(c.x,c.y,c.x,c.y);var g=u.vertexLength;n.emplaceBack(g,g+1,g+2),n.emplaceBack(g+1,g+2,g+3),u.vertexLength+=4,u.primitiveLength+=2}this.maskedBoundsBuffer=e.createVertexBuffer(i,J.members),this.maskedIndexBuffer=e.createIndexBuffer(n)}},rt.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},rt.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var i=ta.parseCacheControl(t.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var n=Date.now(),o=!1;if(this.expirationTime>n)o=!1;else if(!e)o=!0;else if(this.expirationTime<e)o=!0;else{var l=this.expirationTime-e;l?this.expirationTime=n+va(l,3e4):o=!0}o?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},rt.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<ie(this.expiredRequestCount-1,31)):ie(this.expirationTime-new Date().getTime(),_a(2,31)-1)};var lt=function(a,t){this.max=a,this.onRemove=t,this.reset()};lt.prototype.reset=function(){for(var a in this.data)for(var t=0,o=this.data[a],r;t<o.length;t+=1)r=o[t],r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this},lt.prototype.add=function(l,t,e){var i=this,n=l.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);var o={value:t,timeout:void 0};if(void 0!==e&&(o.timeout=setTimeout(function(){i.remove(l,o)},e)),this.data[n].push(o),this.order.push(n),this.order.length>this.max){var r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this},lt.prototype.has=function(e){return e.wrapped().key in this.data},lt.prototype.getAndRemove=function(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null},lt.prototype._getAndRemoveByKey=function(a){var t=this.data[a].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[a].length&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),t.value},lt.prototype.get=function(e){return this.has(e)?this.data[e.wrapped().key][0].value:null},lt.prototype.remove=function(a,t){if(!this.has(a))return this;var e=a.wrapped().key,r=void 0===t?0:this.data[e].indexOf(t),i=this.data[e][r];return this.data[e].splice(r,1),i.timeout&&clearTimeout(i.timeout),0===this.data[e].length&&delete this.data[e],this.onRemove(i.value),this.order.splice(this.order.indexOf(e),1),this},lt.prototype.setMaxSize=function(a){for(this.max=a;this.order.length>this.max;){var t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this};var ct=function(a,t,e){this.context=a;var o=a.gl;this.buffer=o.createBuffer(),this.dynamicDraw=!!e,this.unbindVAO(),a.bindElementBuffer.set(this.buffer),o.bufferData(o.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?o.DYNAMIC_DRAW:o.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer};ct.prototype.unbindVAO=function(){this.context.extVertexArrayObject&&this.context.bindVertexArrayOES.set(null)},ct.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},ct.prototype.updateData=function(a){var t=this.context.gl;this.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)},ct.prototype.destroy=function(){var e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)};var ut={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ht=function(a,t,e,r){this.length=t.length,this.attributes=e,this.itemSize=t.bytesPerElement,this.dynamicDraw=r,this.context=a;var i=a.gl;this.buffer=i.createBuffer(),a.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer};ht.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ht.prototype.updateData=function(a){var t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,a.arrayBuffer)},ht.prototype.enableAttributes=function(a,t){for(var e=0;e<this.attributes.length;e++){var r=this.attributes[e],n=t.attributes[r.name];void 0!==n&&a.enableVertexAttribArray(n)}},ht.prototype.setVertexAttribPointers=function(a,t,e){for(var i=0;i<this.attributes.length;i++){var l=this.attributes[i],o=t.attributes[l.name];void 0!==o&&a.vertexAttribPointer(o,l.components,a[ut[l.type]],!1,this.itemSize,l.offset+this.itemSize*(e||0))}},ht.prototype.destroy=function(){var e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)};var pt=function(t){this.context=t,this.current=ta.default$6.transparent};pt.prototype.get=function(){return this.current},pt.prototype.set=function(a){var t=this.current;a.r===t.r&&a.g===t.g&&a.b===t.b&&a.a===t.a||(this.context.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a)};var dt=function(e){this.context=e,this.current=1};dt.prototype.get=function(){return this.current},dt.prototype.set=function(e){this.current!==e&&(this.context.gl.clearDepth(e),this.current=e)};var ft=function(e){this.context=e,this.current=0};ft.prototype.get=function(){return this.current},ft.prototype.set=function(e){this.current!==e&&(this.context.gl.clearStencil(e),this.current=e)};var mt=function(e){this.context=e,this.current=[!0,!0,!0,!0]};mt.prototype.get=function(){return this.current},mt.prototype.set=function(a){var t=this.current;a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]||(this.context.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a)};var _t=function(e){this.context=e,this.current=!0};_t.prototype.get=function(){return this.current},_t.prototype.set=function(e){this.current!==e&&(this.context.gl.depthMask(e),this.current=e)};var gt=function(e){this.context=e,this.current=255};gt.prototype.get=function(){return this.current},gt.prototype.set=function(e){this.current!==e&&(this.context.gl.stencilMask(e),this.current=e)};var vt=function(e){this.context=e,this.current={func:e.gl.ALWAYS,ref:0,mask:255}};vt.prototype.get=function(){return this.current},vt.prototype.set=function(a){var t=this.current;a.func===t.func&&a.ref===t.ref&&a.mask===t.mask||(this.context.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a)};var yt=function(a){this.context=a;var t=this.context.gl;this.current=[t.KEEP,t.KEEP,t.KEEP]};yt.prototype.get=function(){return this.current},yt.prototype.set=function(a){var t=this.current;a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]||(this.context.gl.stencilOp(a[0],a[1],a[2]),this.current=a)};var xt=function(e){this.context=e,this.current=!1};xt.prototype.get=function(){return this.current},xt.prototype.set=function(a){if(this.current!==a){var t=this.context.gl;a?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=a}};var bt=function(e){this.context=e,this.current=[0,1]};bt.prototype.get=function(){return this.current},bt.prototype.set=function(a){var t=this.current;a[0]===t[0]&&a[1]===t[1]||(this.context.gl.depthRange(a[0],a[1]),this.current=a)};var wt=function(e){this.context=e,this.current=!1};wt.prototype.get=function(){return this.current},wt.prototype.set=function(a){if(this.current!==a){var t=this.context.gl;a?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=a}};var Et=function(e){this.context=e,this.current=e.gl.LESS};Et.prototype.get=function(){return this.current},Et.prototype.set=function(e){this.current!==e&&(this.context.gl.depthFunc(e),this.current=e)};var Tt=function(e){this.context=e,this.current=!1};Tt.prototype.get=function(){return this.current},Tt.prototype.set=function(a){if(this.current!==a){var t=this.context.gl;a?t.enable(t.BLEND):t.disable(t.BLEND),this.current=a}};var It=function(a){this.context=a;var t=this.context.gl;this.current=[t.ONE,t.ZERO]};It.prototype.get=function(){return this.current},It.prototype.set=function(a){var t=this.current;a[0]===t[0]&&a[1]===t[1]||(this.context.gl.blendFunc(a[0],a[1]),this.current=a)};var Ct=function(t){this.context=t,this.current=ta.default$6.transparent};Ct.prototype.get=function(){return this.current},Ct.prototype.set=function(a){var t=this.current;a.r===t.r&&a.g===t.g&&a.b===t.b&&a.a===t.a||(this.context.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a)};var St=function(e){this.context=e,this.current=null};St.prototype.get=function(){return this.current},St.prototype.set=function(e){this.current!==e&&(this.context.gl.useProgram(e),this.current=e)};var zt=function(e){this.context=e,this.current=1};zt.prototype.get=function(){return this.current},zt.prototype.set=function(t){var e=this.context.lineWidthRange,a=ta.clamp(t,e[0],e[1]);this.current!==a&&(this.context.gl.lineWidth(a),this.current=t)};var At=function(e){this.context=e,this.current=e.gl.TEXTURE0};At.prototype.get=function(){return this.current},At.prototype.set=function(e){this.current!==e&&(this.context.gl.activeTexture(e),this.current=e)};var Rt=function(a){this.context=a;var t=this.context.gl;this.current=[0,0,t.drawingBufferWidth,t.drawingBufferHeight]};Rt.prototype.get=function(){return this.current},Rt.prototype.set=function(a){var t=this.current;a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]||(this.context.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a)};var Dt=function(e){this.context=e,this.current=null};Dt.prototype.get=function(){return this.current},Dt.prototype.set=function(a){if(this.current!==a){var t=this.context.gl;t.bindFramebuffer(t.FRAMEBUFFER,a),this.current=a}};var Mt=function(e){this.context=e,this.current=null};Mt.prototype.get=function(){return this.current},Mt.prototype.set=function(a){if(this.current!==a){var t=this.context.gl;t.bindRenderbuffer(t.RENDERBUFFER,a),this.current=a}};var Lt=function(e){this.context=e,this.current=null};Lt.prototype.get=function(){return this.current},Lt.prototype.set=function(a){if(this.current!==a){var t=this.context.gl;t.bindTexture(t.TEXTURE_2D,a),this.current=a}};var Pt=function(e){this.context=e,this.current=null};Pt.prototype.get=function(){return this.current},Pt.prototype.set=function(a){if(this.current!==a){var t=this.context.gl;t.bindBuffer(t.ARRAY_BUFFER,a),this.current=a}};var kt=function(e){this.context=e,this.current=null};kt.prototype.get=function(){return this.current},kt.prototype.set=function(a){var t=this.context.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a),this.current=a};var Bt=function(e){this.context=e,this.current=null};Bt.prototype.get=function(){return this.current},Bt.prototype.set=function(e){this.current!==e&&this.context.extVertexArrayObject&&(this.context.extVertexArrayObject.bindVertexArrayOES(e),this.current=e)};var Ot=function(e){this.context=e,this.current=4};Ot.prototype.get=function(){return this.current},Ot.prototype.set=function(a){if(this.current!==a){var t=this.context.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,a),this.current=a}};var Ft=function(e){this.context=e,this.current=!1};Ft.prototype.get=function(){return this.current},Ft.prototype.set=function(a){if(this.current!==a){var t=this.context.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a}};var Nt=function(a,t){this.context=a,this.current=null,this.parent=t};Nt.prototype.get=function(){return this.current};var Ut=function(a){function t(t,e){a.call(this,t,e),this.dirty=!1}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.set=function(a){if(this.dirty||this.current!==a){var t=this.context.gl;this.context.bindFramebuffer.set(this.parent),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}},t.prototype.setDirty=function(){this.dirty=!0},t}(Nt),Zt=function(a){function t(){a.apply(this,arguments)}return a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t,t.prototype.set=function(a){if(this.current!==a){var t=this.context.gl;this.context.bindFramebuffer.set(this.parent),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,a),this.current=a}},t}(Nt),Vt=function(a,t,e){this.context=a,this.width=t,this.height=e;var r=a.gl,i=this.framebuffer=r.createFramebuffer();this.colorAttachment=new Ut(a,i),this.depthAttachment=new Zt(a,i)};Vt.prototype.destroy=function(){var a=this.context.gl,t=this.colorAttachment.get();t&&a.deleteTexture(t);var e=this.depthAttachment.get();e&&a.deleteRenderbuffer(e),a.deleteFramebuffer(this.framebuffer)};var jt=function(a,t,e){this.func=a,this.mask=t,this.range=e};jt.ReadOnly=!1,jt.ReadWrite=!0,jt.disabled=new jt(519,jt.ReadOnly,[0,1]);var $t=function(a,t,e,i,n,o){this.test=a,this.ref=t,this.mask=e,this.fail=i,this.depthFail=n,this.pass=o};$t.disabled=new $t({func:519,mask:0},0,0,7680,7680,7680);var Gt=function(a,t,e){this.blendFunction=a,this.blendColor=t,this.mask=e};Gt.Replace=[1,0],Gt.disabled=new Gt(Gt.Replace,ta.default$6.transparent,[!1,!1,!1,!1]),Gt.unblended=new Gt(Gt.Replace,ta.default$6.transparent,[!0,!0,!0,!0]),Gt.alphaBlended=new Gt([1,771],ta.default$6.transparent,[!0,!0,!0,!0]);var Wt=function(e){this.gl=e,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.lineWidthRange=e.getParameter(e.ALIASED_LINE_WIDTH_RANGE),this.clearColor=new pt(this),this.clearDepth=new dt(this),this.clearStencil=new ft(this),this.colorMask=new mt(this),this.depthMask=new _t(this),this.stencilMask=new gt(this),this.stencilFunc=new vt(this),this.stencilOp=new yt(this),this.stencilTest=new xt(this),this.depthRange=new bt(this),this.depthTest=new wt(this),this.depthFunc=new Et(this),this.blend=new Tt(this),this.blendFunc=new It(this),this.blendColor=new Ct(this),this.program=new St(this),this.lineWidth=new zt(this),this.activeTexture=new At(this),this.viewport=new Rt(this),this.bindFramebuffer=new Dt(this),this.bindRenderbuffer=new Mt(this),this.bindTexture=new Lt(this),this.bindVertexBuffer=new Pt(this),this.bindElementBuffer=new kt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Bt(this),this.pixelStoreUnpack=new Ot(this),this.pixelStoreUnpackPremultiplyAlpha=new Ft(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=e.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&e.getExtension("OES_texture_half_float_linear")};Wt.prototype.createIndexBuffer=function(a,t){return new ct(this,a,t)},Wt.prototype.createVertexBuffer=function(a,t,e){return new ht(this,a,t,e)},Wt.prototype.createRenderbuffer=function(a,t,e){var r=this.gl,i=r.createRenderbuffer();return this.bindRenderbuffer.set(i),r.renderbufferStorage(r.RENDERBUFFER,a,t,e),this.bindRenderbuffer.set(null),i},Wt.prototype.createFramebuffer=function(a,t){return new Vt(this,a,t)},Wt.prototype.clear=function(a){var t=a.color,e=a.depth,r=this.gl,i=0;t&&(i|=r.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==e&&(i|=r.DEPTH_BUFFER_BIT,this.clearDepth.set(e),this.depthMask.set(!0)),r.clear(i)},Wt.prototype.setDepthMode=function(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)},Wt.prototype.setStencilMode=function(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)},Wt.prototype.setColorMode=function(t){ta.default$10(t.blendFunction,Gt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)};var qt=function(a){function x(e,t,r){var i=this;a.call(this),this.id=e,this.dispatcher=r,this.on("data",function(e){"source"===e.dataType&&"metadata"===e.sourceDataType&&(i._sourceLoaded=!0),i._sourceLoaded&&!i._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(i.reload(),i.transform&&i.update(i.transform))}),this.on("error",function(){i._sourceErrored=!0}),this._source=ot(e,t,r,this),this._tiles={},this._cache=new lt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._isIdRenderable=this._isIdRenderable.bind(this),this._coveredTiles={}}return a&&(x.__proto__=a),x.prototype=Object.create(a&&a.prototype),x.prototype.constructor=x,x.prototype.onAdd=function(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(e)},x.prototype.onRemove=function(e){this._source&&this._source.onRemove&&this._source.onRemove(e)},x.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var a in this._tiles){var t=this._tiles[a];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0},x.prototype.getSource=function(){return this._source},x.prototype.pause=function(){this._paused=!0},x.prototype.resume=function(){if(this._paused){var e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}},x.prototype._loadTile=function(a,t){return this._source.loadTile(a,t)},x.prototype._unloadTile=function(e){if(this._source.unloadTile)return this._source.unloadTile(e,function(){})},x.prototype._abortTile=function(e){if(this._source.abortTile)return this._source.abortTile(e,function(){})},x.prototype.serialize=function(){return this._source.serialize()},x.prototype.prepare=function(a){for(var t in this._source.prepare&&this._source.prepare(),this._tiles)this._tiles[t].upload(a)},x.prototype.getIds=function(){var t=this;return Object.keys(this._tiles).map(Number).sort(function(e,i){var n=t._tiles[e].tileID,o=t._tiles[i].tileID,r=new ta.default$1(n.canonical.x,n.canonical.y).rotate(t.transform.angle),a=new ta.default$1(o.canonical.x,o.canonical.y).rotate(t.transform.angle);return n.overscaledZ-o.overscaledZ||a.y-r.y||a.x-r.x})},x.prototype.getRenderableIds=function(){return this.getIds().filter(this._isIdRenderable)},x.prototype.hasRenderableParent=function(a){var t=this.findLoadedParent(a,0,{});return!!t&&this._isIdRenderable(t.tileID.key)},x.prototype._isIdRenderable=function(e){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]},x.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var e in this._cache.reset(),this._tiles)this._reloadTile(e,"reloading")},x.prototype._reloadTile=function(a,t){var e=this._tiles[a];e&&("loading"!==e.state&&(e.state=t),this._loadTile(e,this._tileLoaded.bind(this,e,a,t)))},x.prototype._tileLoaded=function(t,e,a,r){return r?(t.state="errored",void(404===r.status?this.update(this.transform):this._source.fire(new ta.ErrorEvent(r,{tile:t})))):void(t.timeAdded=ja.now(),"expired"===a&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._source.fire(new ta.Event("data",{dataType:"source",tile:t,coord:t.tileID})),this.map&&(this.map.painter.tileExtentVAO.vao=null))},x.prototype._backfillDEM=function(a){function t(a,t){a.needsHillshadePrepare=!0;var e=t.tileID.canonical.x-a.tileID.canonical.x,l=t.tileID.canonical.y-a.tileID.canonical.y,n=_a(2,a.tileID.canonical.z),o=t.tileID.key;0===e&&0==l||1<wa(l)||(1<wa(e)&&(1===wa(e+n)?e+=n:1===wa(e-n)&&(e-=n)),t.dem&&a.dem&&(a.dem.backfillBorder(t.dem,e,l),a.neighboringTiles&&a.neighboringTiles[o]&&(a.neighboringTiles[o].backfilled=!0)))}for(var r=this.getRenderableIds(),e=0,l;e<r.length;e++)if(l=r[e],a.neighboringTiles&&a.neighboringTiles[l]){var s=this.getTileByID(l);t(a,s),t(s,a)}},x.prototype.getTile=function(e){return this.getTileByID(e.key)},x.prototype.getTileByID=function(e){return this._tiles[e]},x.prototype.getZoom=function(e){return e.zoom+e.scaleZoom(e.tileSize/this._source.tileSize)},x.prototype._findLoadedChildren=function(l,t,e){var i=!1;for(var d in this._tiles){var o=this._tiles[d];if(!(e[d]||!o.hasData()||o.tileID.overscaledZ<=l.overscaledZ||o.tileID.overscaledZ>t)){var c=_a(2,o.tileID.canonical.z-l.canonical.z);if(ea(o.tileID.canonical.x/c)===l.canonical.x&&ea(o.tileID.canonical.y/c)===l.canonical.y)for(e[d]=o.tileID,i=!0;o&&o.tileID.overscaledZ-1>l.overscaledZ;){var a=o.tileID.scaledTo(o.tileID.overscaledZ-1);if(!a)break;(o=this._tiles[a.key])&&o.hasData()&&(delete e[d],e[a.key]=a)}}}return i},x.prototype.findLoadedParent=function(l,t,e){for(var i=l.overscaledZ-1,s;i>=t;i--){if(s=l.scaledTo(i),!s)return;var d=s.key+"",r=this._tiles[d];if(r&&r.hasData())return e[d]=s,r;if(this._cache.has(s))return e[d]=s,this._cache.get(s)}},x.prototype.updateCacheSize=function(a){var t=(ae(a.width/this._source.tileSize)+1)*(ae(a.height/this._source.tileSize)+1),e=ea(5*t),o="number"==typeof this._maxTileCacheSize?ie(this._maxTileCacheSize,e):e;this._cache.setMaxSize(o)},x.prototype.handleWrapJump=function(d){var t=(d-(void 0===this._prevLng?d:this._prevLng))/360,e=R(t);if(this._prevLng=d,e){var i={};for(var n in this._tiles){var o=this._tiles[n];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+e),i[o.tileID.key]=o}for(var r in this._tiles=i,this._timers)clearTimeout(this._timers[r]),delete this._timers[r];for(var a in this._tiles){var s=this._tiles[a];this._setTileReloadTimer(a,s)}}},x.prototype.update=function(t){var e=this;if(this.transform=t,this._sourceLoaded&&!this._paused){var r;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?r=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(t){return new ta.OverscaledTileID(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)}):(r=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(r=r.filter(function(a){return e._source.hasTile(a)}))):r=[];var i=(this._source.roundZoom?R:ea)(this.getZoom(t)),n=va(i-x.maxOverzooming,this._source.minzoom),l=va(i+x.maxUnderzooming,this._source.minzoom),s=this._updateRetainedTiles(r,i),c={},u;if(Ht(this._source.type))for(var h=Object.keys(s),p=0;p<h.length;p++){var b=h[p],f=s[b],m=e._tiles[b];if(m&&(void 0===m.fadeEndTime||m.fadeEndTime>=ja.now())){e._findLoadedChildren(f,l,s)&&(s[b]=f);var _=e.findLoadedParent(f,n,c);_&&e._addTile(_.tileID)}}for(u in c)s[u]||(e._coveredTiles[u]=!0);for(u in c)s[u]=c[u];for(var g=ta.keysDifference(this._tiles,s),v=0;v<g.length;v++)e._removeTile(g[v])}},x.prototype._updateRetainedTiles=function(i,t){for(var e={},n={},o=va(t-x.maxOverzooming,this._source.minzoom),r=va(t+x.maxUnderzooming,this._source.minzoom),a=0;a<i.length;a++){var y=i[a],l=this._addTile(y),b=!1;if(l.hasData())e[y.key]=y;else{b=l.wasRequested(),e[y.key]=y;var v=!0;if(t+1>this._source.maxzoom){var w=y.children(this._source.maxzoom)[0],p=this.getTile(w);p&&p.hasData()?e[w.key]=w:v=!1}else{this._findLoadedChildren(y,r,e);for(var d=y.children(this._source.maxzoom),f=0;f<d.length;f++)if(!e[d[f].key]){v=!1;break}}if(!v)for(var k=y.overscaledZ-1,T;k>=o&&(T=y.scaledTo(k),!n[T.key])&&(n[T.key]=!0,!(l=this.getTile(T))&&b&&(l=this._addTile(T)),!(l&&(e[T.key]=T,b=l.wasRequested(),l.hasData())));--k);}}return e},x.prototype._addTile=function(t){var e=this._tiles[t.key];if(e)return e;(e=this._cache.getAndRemove(t))&&(this._setTileReloadTimer(t.key,e),e.tileID=t);var a=!!e;return a||(e=new rt(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state))),e?(e.uses++,this._tiles[t.key]=e,a||this._source.fire(new ta.Event("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e):null},x.prototype._setTileReloadTimer=function(a,t){var e=this;a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);var o=t.getExpiryTimeout();o&&(this._timers[a]=setTimeout(function(){e._reloadTile(a,"expired"),delete e._timers[a]},o))},x.prototype._removeTile=function(a){var t=this._tiles[a];t&&(t.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),0<t.uses||(t.hasData()?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))},x.prototype.clearTiles=function(){for(var e in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(e);this._cache.reset()},x.prototype.tilesIn=function(t,e){for(var i=[],n=this.getIds(),o=1/0,x=1/0,b=-1/0,w=-1/0,k=t[0].zoom,c=0,T;c<t.length;c++)T=t[c],o=ie(o,T.column),x=ie(x,T.row),b=va(b,T.column),w=va(w,T.row);for(var A=0;A<n.length;A++){var S=this._tiles[n[A]],d=S.tileID,f=_a(2,this.transform.zoom-S.tileID.overscaledZ),m=e*S.queryPadding*ta.default$8/S.tileSize/f,_=[st(d,new ta.default$17(o,x,k)),st(d,new ta.default$17(b,w,k))];if(_[0].x-m<ta.default$8&&_[0].y-m<ta.default$8&&0<=_[1].x+m&&0<=_[1].y+m){for(var g=[],v=0;v<t.length;v++)g.push(st(d,t[v]));i.push({tile:S,tileID:d,queryGeometry:[g],scale:f})}}return i},x.prototype.getVisibleCoordinates=function(){for(var a=this,t=this.getRenderableIds().map(function(t){return a._tiles[t].tileID}),e=0,r=t,n;e<r.length;e+=1)n=r[e],n.posMatrix=a.transform.calculatePosMatrix(n.toUnwrapped());return t},x.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ht(this._source.type))for(var a in this._tiles){var t=this._tiles[a];if(void 0!==t.fadeEndTime&&t.fadeEndTime>=ja.now())return!0}return!1},x}(ta.Evented);qt.maxOverzooming=10,qt.maxUnderzooming=3;var Xt=function(){this.active={}},Qt;Xt.prototype.acquire=function(a){if(!this.workers){var t=$o.workerCount;for(this.workers=[];this.workers.length<t;)this.workers.push(new Kt)}return this.active[a]=!0,this.workers.slice()},Xt.prototype.release=function(e){delete this.active[e],0===Object.keys(this.active).length&&(this.workers.forEach(function(e){e.terminate()}),this.workers=null)};var Ga={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"},Ya=function(a,t,e){var i=this.boxCells=[],n=this.circleCells=[];this.xCellCount=ae(a/e),this.yCellCount=ae(t/e);for(var o=0;o<this.xCellCount*this.yCellCount;o++)i.push([]),n.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=t,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0};Ya.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Ya.prototype.insert=function(a,t,e,r,i){this._forEachCell(t,e,r,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(i)},Ya.prototype.insertCircle=function(a,t,e,o){this._forEachCell(t-o,e-o,t+o,e+o,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(t),this.circles.push(e),this.circles.push(o)},Ya.prototype._insertBoxCell=function(a,t,e,i,n,o){this.boxCells[n].push(o)},Ya.prototype._insertCircleCell=function(a,t,e,i,n,o){this.circleCells[n].push(o)},Ya.prototype._query=function(d,t,e,i,n){if(0>e||d>this.width||0>i||t>this.height)return!n&&[];var o=[];if(0>=d&&0>=t&&this.width<=e&&this.height<=i){if(n)return!0;for(var r=0;r<this.boxKeys.length;r++)o.push({key:this.boxKeys[r],x1:this.bboxes[4*r],y1:this.bboxes[4*r+1],x2:this.bboxes[4*r+2],y2:this.bboxes[4*r+3]});for(var p=0;p<this.circleKeys.length;p++){var g=this.circles[3*p],l=this.circles[3*p+1],c=this.circles[3*p+2];o.push({key:this.circleKeys[p],x1:g-c,y1:l-c,x2:g+c,y2:l+c})}}else{this._forEachCell(d,t,e,i,this._queryCell,o,{hitTest:n,seenUids:{box:{},circle:{}}})}return n?0<o.length:o},Ya.prototype._queryCircle=function(d,t,e,i){var n=d-e,o=d+e,r=t-e,a=t+e;if(0>o||n>this.width||0>a||r>this.height)return!i&&[];var s=[];return this._forEachCell(n,r,o,a,this._queryCellCircle,s,{hitTest:i,circle:{x:d,y:t,radius:e},seenUids:{box:{},circle:{}}}),i?0<s.length:s},Ya.prototype.query=function(a,t,e,o){return this._query(a,t,e,o,!1)},Ya.prototype.hitTest=function(a,t,e,o){return this._query(a,t,e,o,!0)},Ya.prototype.hitTestCircle=function(a,t,e){return this._queryCircle(a,t,e,!0)},Ya.prototype._queryCell=function(k,t,e,i,n,o,r){var a=r.seenUids,s=this.boxCells[n];if(null!==s)for(var l=this.bboxes,c=0,T=s,h;c<T.length;c+=1)if(h=T[c],!a.box[h]){a.box[h]=!0;var A=4*h;if(k<=l[A+2]&&t<=l[A+3]&&e>=l[A+0]&&i>=l[A+1]){if(r.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[h],x1:l[A],y1:l[A+1],x2:l[A+2],y2:l[A+3]})}}var d=this.circleCells[n];if(null!==d)for(var f=this.circles,m=0,S=d,g;m<S.length;m+=1)if(g=S[m],!a.circle[g]){a.circle[g]=!0;var C=3*g;if(this._circleAndRectCollide(f[C],f[C+1],f[C+2],k,t,e,i)){if(r.hitTest)return o.push(!0),!0;var y=f[C],x=f[C+1],b=f[C+2];o.push({key:this.circleKeys[g],x1:y-b,y1:x-b,x2:y+b,y2:x+b})}}},Ya.prototype._queryCellCircle=function(b,t,e,i,n,o,r){var a=r.circle,s=r.seenUids,l=this.boxCells[n];if(null!==l)for(var c=this.bboxes,u=0,w=l,p;u<w.length;u+=1)if(p=w[u],!s.box[p]){s.box[p]=!0;var k=4*p;if(this._circleAndRectCollide(a.x,a.y,a.radius,c[k+0],c[k+1],c[k+2],c[k+3]))return o.push(!0),!0}var f=this.circleCells[n];if(null!==f)for(var m=this.circles,_=0,T=f,v;_<T.length;_+=1)if(v=T[_],!s.circle[v]){s.circle[v]=!0;var A=3*v;if(this._circlesCollide(m[A],m[A+1],m[A+2],a.x,a.y,a.radius))return o.push(!0),!0}},Ya.prototype._forEachCell=function(g,t,e,i,n,o,r){for(var a=this._convertToXCellCoord(g),s=this._convertToYCellCoord(t),l=this._convertToXCellCoord(e),c=this._convertToYCellCoord(i),u=a;u<=l;u++)for(var m=s,y;m<=c;m++)if(y=this.xCellCount*m+u,n.call(this,g,t,e,i,y,o,r))return},Ya.prototype._convertToXCellCoord=function(e){return va(0,ie(this.xCellCount-1,ea(e*this.xScale)))},Ya.prototype._convertToYCellCoord=function(e){return va(0,ie(this.yCellCount-1,ea(e*this.yScale)))},Ya.prototype._circlesCollide=function(d,t,e,i,n,o){var r=i-d,a=n-t,s=e+o;return s*s>r*r+a*a},Ya.prototype._circleAndRectCollide=function(d,t,e,i,n,o,r){var a=(o-i)/2,s=wa(d-(i+a));if(s>a+e)return!1;var l=(r-n)/2,c=wa(t-(n+l));if(c>l+e)return!1;if(s<=a||c<=l)return!0;var u=s-a,g=c-l;return u*u+g*g<=e*e};var he=ta.default$19.layout,pe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);ta.default$20.mat4;var Ee=function(a,t,o){void 0===t&&(t=new Ya(a.width+200,a.height+200,25)),void 0===o&&(o=new Ya(a.width+200,a.height+200,25)),this.transform=a,this.grid=t,this.ignoredGrid=o,this.pitchfactor=te(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100};Ee.prototype.placeCollisionBox=function(d,t,e,i){var n=this.projectAndGetPerspectiveRatio(i,d.anchorPointX,d.anchorPointY),o=e*n.perspectiveRatio,r=d.x1*o+n.point.x,a=d.y1*o+n.point.y,s=d.x2*o+n.point.x,l=d.y2*o+n.point.y;return!t&&this.grid.hitTest(r,a,s,l)?{box:[],offscreen:!1}:{box:[r,a,s,l],offscreen:this.isOffscreen(r,a,s,l)}},Ee.prototype.approximateTileDistance=function(l,t,e,i,n){var o=n?1:i/this.pitchfactor,r=l.lastSegmentViewportDistance*e;return l.prevTileDistance+r+(o-1)*r*wa(M(t))},Ee.prototype.placeCollisionCircles=function(t,e,i,n,o,r,a,s,l,c,u,h,p){var d=[],f=this.projectAnchor(c,r.anchorX,r.anchorY),m=r.lineOffsetX*l,g=r.lineOffsetY*l,_=new ta.default$1(r.anchorX,r.anchorY),y=ge(l/24,s,m,g,!1,fe(_,u).point,_,r,a,u,{},!0),x=!1,v=!0,j=f.perspectiveRatio*n,E=1/(n*i),T=0,F=0;y&&(T=this.approximateTileDistance(y.first.tileDistance,y.first.angle,E,f.cameraDistance,p),F=this.approximateTileDistance(y.last.tileDistance,y.last.angle,E,f.cameraDistance,p));for(var N=0;N<t.length;N+=5){var V=t[N],z=t[N+1],A=t[N+2],R=t[N+3];if(!y||R<-T||R>F)Ie(t,N,!1);else{var D=this.projectPoint(c,V,z),M=A*j;if(0<d.length){var L=D.x-d[d.length-4],P=D.y-d[d.length-3];if(2*(M*M)>L*L+P*P&&N+8<t.length){var k=t[N+8];if(k>-T&&k<F){Ie(t,N,!1);continue}}}var B=N/5;if(d.push(D.x,D.y,M,B),Ie(t,N,!0),v=v&&this.isOffscreen(D.x-M,D.y-M,D.x+M,D.y+M),!e&&this.grid.hitTestCircle(D.x,D.y,M)){if(!h)return{circles:[],offscreen:!1};x=!0}}}return{circles:x?[]:d,offscreen:v}},Ee.prototype.queryRenderedSymbols=function(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var e=[],i=1/0,y=1/0,x=-1/0,b=-1/0,v=0,w=t;v<w.length;v+=1){var l=w[v],c=new ta.default$1(l.x+100,l.y+100);i=ie(i,c.x),y=ie(y,c.y),x=va(x,c.x),b=va(b,c.y),e.push(c)}for(var u={},h={},p=0,k=this.grid.query(i,y,x,b).concat(this.ignoredGrid.query(i,y,x,b));p<k.length;p+=1){var f=k[p],m=f.key;if(void 0===u[m.bucketInstanceId]&&(u[m.bucketInstanceId]={}),!u[m.bucketInstanceId][m.featureIndex]){var _=[new ta.default$1(f.x1,f.y1),new ta.default$1(f.x2,f.y1),new ta.default$1(f.x2,f.y2),new ta.default$1(f.x1,f.y2)];ta.polygonIntersectsPolygon(e,_)&&(u[m.bucketInstanceId][m.featureIndex]=!0,void 0===h[m.bucketInstanceId]&&(h[m.bucketInstanceId]=[]),h[m.bucketInstanceId].push(m.featureIndex))}}return h},Ee.prototype.insertCollisionBox=function(a,t,e,o){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:e,featureIndex:o},a[0],a[1],a[2],a[3])},Ee.prototype.insertCollisionCircles=function(l,t,e,i){for(var n=t?this.ignoredGrid:this.grid,o={bucketInstanceId:e,featureIndex:i},r=0;r<l.length;r+=4)n.insertCircle(o,l[r],l[r+1],l[r+2])},Ee.prototype.projectAnchor=function(a,t,e){var o=[t,e,0,1];return Te(o,o,a),{perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/o[3]),cameraDistance:o[3]}},Ee.prototype.projectPoint=function(t,e,a){var r=[e,a,0,1];return Te(r,r,t),new ta.default$1((r[0]/r[3]+1)/2*this.transform.width+100,(-r[1]/r[3]+1)/2*this.transform.height+100)},Ee.prototype.projectAndGetPerspectiveRatio=function(t,e,a){var r=[e,a,0,1];return Te(r,r,t),{point:new ta.default$1((r[0]/r[3]+1)/2*this.transform.width+100,(-r[1]/r[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/r[3])}},Ee.prototype.isOffscreen=function(a,t,e,o){return 100>e||a>=this.screenRightBoundary||100>o||t>this.screenBottomBoundary};var Ce=ta.default$19.layout,Ae=function(a,t,e,o){this.opacity=a?va(0,ie(1,a.opacity+(a.placed?t:-t))):o&&e?1:0,this.placed=e};Ae.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var Re=function(a,t,e,r,i){this.text=new Ae(a?a.text:null,t,e,i),this.icon=new Ae(a?a.icon:null,t,r,i)};Re.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var De=function(a,t,e){this.text=a,this.icon=t,this.skipFade=e},Me=function(a,t){this.transform=a.clone(),this.collisionIndex=new Ee(this.transform),this.placements={},this.opacities={},this.stale=!1,this.fadeDuration=t,this.retainedQueryData={}};Me.prototype.placeLayerTile=function(t,e,i,n){var o=e.getBucket(t),r=e.latestFeatureIndex;if(o&&r&&t.id===o.layerIds[0]){var a=e.collisionBoxArray,s=o.layers[0].layout,l=_a(2,this.transform.zoom-e.tileID.overscaledZ),c=e.tileSize/ta.default$8,u=this.transform.calculatePosMatrix(e.tileID.toUnwrapped()),g=ue(u,"map"===s.get("text-pitch-alignment"),"map"===s.get("text-rotation-alignment"),this.transform,Se(e,1,this.transform.zoom)),p=ue(u,"map"===s.get("icon-pitch-alignment"),"map"===s.get("icon-rotation-alignment"),this.transform,Se(e,1,this.transform.zoom));this.retainedQueryData[o.bucketInstanceId]=new function(a,t,e,r,i){this.bucketInstanceId=a,this.featureIndex=t,this.sourceLayerIndex=e,this.bucketIndex=r,this.tileID=i}(o.bucketInstanceId,r,o.sourceLayerIndex,o.index,e.tileID),this.placeLayerBucket(o,u,g,p,l,c,i,n,a)}},Me.prototype.placeLayerBucket=function(t,e,i,n,o,r,a,s,l){for(var c=t.layers[0].layout,u=ta.evaluateSizeForZoom(t.textSizeData,this.transform.zoom,Ce.properties["text-size"]),h=!t.hasTextData()||c.get("text-optional"),p=!t.hasIconData()||c.get("icon-optional"),d=0,k=t.symbolInstances,m;d<k.length;d+=1)if(m=k[d],!s[m.crossTileID]){var A=void 0!==m.feature.text,L=void 0!==m.feature.icon,z=!0,D=null,P=null,O=null,R=0,M=0;m.collisionArrays||(m.collisionArrays=t.deserializeCollisionBoxes(l,m.textBoxStartIndex,m.textBoxEndIndex,m.iconBoxStartIndex,m.iconBoxEndIndex)),m.collisionArrays.textFeatureIndex&&(R=m.collisionArrays.textFeatureIndex),m.collisionArrays.textBox&&(A=0<(D=this.collisionIndex.placeCollisionBox(m.collisionArrays.textBox,c.get("text-allow-overlap"),r,e)).box.length,z=z&&D.offscreen);var j=m.collisionArrays.textCircles;if(j){var I=t.text.placedSymbolArray.get(m.placedTextSymbolIndices[0]),C=ta.evaluateSizeForFeature(t.textSizeData,u,I);P=this.collisionIndex.placeCollisionCircles(j,c.get("text-allow-overlap"),o,r,m.key,I,t.lineVertexArray,t.glyphOffsetArray,C,e,i,a,"map"===c.get("text-pitch-alignment")),A=c.get("text-allow-overlap")||0<P.circles.length,z=z&&P.offscreen}m.collisionArrays.iconFeatureIndex&&(M=m.collisionArrays.iconFeatureIndex),m.collisionArrays.iconBox&&(L=0<(O=this.collisionIndex.placeCollisionBox(m.collisionArrays.iconBox,c.get("icon-allow-overlap"),r,e)).box.length,z=z&&O.offscreen),h||p?p?h||(L=L&&A):A=L&&A:L=A=L&&A,A&&D&&this.collisionIndex.insertCollisionBox(D.box,c.get("text-ignore-placement"),t.bucketInstanceId,R),L&&O&&this.collisionIndex.insertCollisionBox(O.box,c.get("icon-ignore-placement"),t.bucketInstanceId,M),A&&P&&this.collisionIndex.insertCollisionCircles(P.circles,c.get("text-ignore-placement"),t.bucketInstanceId,R),this.placements[m.crossTileID]=new De(A,L,z||t.justReloaded),s[m.crossTileID]=!0}t.justReloaded=!1},Me.prototype.commit=function(d,t){this.commitTime=t;var e=!1,p=d&&0!==this.fadeDuration?(this.commitTime-d.commitTime)/this.fadeDuration:1,n=d?d.opacities:{};for(var o in this.placements){var r=this.placements[o],a=n[o];a?(this.opacities[o]=new Re(a,p,r.text,r.icon),e=e||r.text!==a.text.placed||r.icon!==a.icon.placed):(this.opacities[o]=new Re(null,p,r.text,r.icon,r.skipFade),e=e||r.text||r.icon)}for(var s in n){var l=n[s];if(!this.opacities[s]){var c=new Re(l,p,!1,!1);c.isHidden()||(this.opacities[s]=c,e=e||l.text.placed||l.icon.placed)}}e?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:t)},Me.prototype.updateLayerOpacities=function(l,t){for(var e={},i=0,s=t;i<s.length;i+=1){var o=s[i],r=o.getBucket(l);r&&o.latestFeatureIndex&&l.id===r.layerIds[0]&&this.updateBucketOpacities(r,e,o.collisionBoxArray)}},Me.prototype.updateBucketOpacities=function(k,t,e){k.hasTextData()&&k.text.opacityVertexArray.clear(),k.hasIconData()&&k.icon.opacityVertexArray.clear(),k.hasCollisionBoxData()&&k.collisionBox.collisionVertexArray.clear(),k.hasCollisionCircleData()&&k.collisionCircle.collisionVertexArray.clear();for(var i=k.layers[0].layout,n=new Re(null,0,!1,!1,!0),o=new Re(null,0,i.get("text-allow-overlap"),i.get("icon-allow-overlap"),!0),r=0;r<k.symbolInstances.length;r++){var T=k.symbolInstances[r],s=t[T.crossTileID],l=this.opacities[T.crossTileID];s?l=n:l||(l=o,this.opacities[T.crossTileID]=l),t[T.crossTileID]=!0;var A=0<T.numGlyphVertices||0<T.numVerticalGlyphVertices,u=0<T.numIconVertices;if(A){for(var h=Pe(l.text),p=(T.numGlyphVertices+T.numVerticalGlyphVertices)/4,d=0;d<p;d++)k.text.opacityVertexArray.emplaceBack(h);for(var S=0,C=T.placedTextSymbolIndices,_;S<C.length;S+=1)_=C[S],k.text.placedSymbolArray.get(_).hidden=l.text.isHidden()}if(u){for(var L=Pe(l.icon),v=0;v<T.numIconVertices/4;v++)k.icon.opacityVertexArray.emplaceBack(L);k.icon.placedSymbolArray.get(r).hidden=l.icon.isHidden()}T.collisionArrays||(T.collisionArrays=k.deserializeCollisionBoxes(e,T.textBoxStartIndex,T.textBoxEndIndex,T.iconBoxStartIndex,T.iconBoxEndIndex));var z=T.collisionArrays;if(z){z.textBox&&k.hasCollisionBoxData()&&ze(k.collisionBox.collisionVertexArray,l.text.placed,!1),z.iconBox&&k.hasCollisionBoxData()&&ze(k.collisionBox.collisionVertexArray,l.icon.placed,!1);var x=z.textCircles;if(x&&k.hasCollisionCircleData())for(var b=0,I;b<x.length;b+=5)I=s||0===x[b+4],ze(k.collisionCircle.collisionVertexArray,l.text.placed,I)}}k.sortFeatures(this.transform.angle),this.retainedQueryData[k.bucketInstanceId]&&(this.retainedQueryData[k.bucketInstanceId].featureSortOrder=k.featureSortOrder),k.hasTextData()&&k.text.opacityVertexBuffer&&k.text.opacityVertexBuffer.updateData(k.text.opacityVertexArray),k.hasIconData()&&k.icon.opacityVertexBuffer&&k.icon.opacityVertexBuffer.updateData(k.icon.opacityVertexArray),k.hasCollisionBoxData()&&k.collisionBox.collisionVertexBuffer&&k.collisionBox.collisionVertexBuffer.updateData(k.collisionBox.collisionVertexArray),k.hasCollisionCircleData()&&k.collisionCircle.collisionVertexBuffer&&k.collisionCircle.collisionVertexBuffer.updateData(k.collisionCircle.collisionVertexArray)},Me.prototype.symbolFadeChange=function(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration},Me.prototype.hasTransitions=function(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration},Me.prototype.stillRecent=function(e){return"undefined"!==this.commitTime&&this.commitTime+this.fadeDuration>e},Me.prototype.setStale=function(){this.stale=!0};var Le=_a(2,25),ke=_a(2,24),Be=_a(2,17),Oe=_a(2,16),Fe=_a(2,9),Ne=_a(2,8),Ue=_a(2,1),Ze=function(){this._currentTileIndex=0,this._seenCrossTileIDs={}};Ze.prototype.continuePlacement=function(a,t,e,i,n){for(;this._currentTileIndex<a.length;){var o=a[this._currentTileIndex];if(t.placeLayerTile(i,o,e,this._seenCrossTileIDs),this._currentTileIndex++,n())return!0}};var je=function(a,t,e,r,i){this.placement=new Me(a,i),this._currentPlacementIndex=t.length-1,this._forceFullPlacement=e,this._showCollisionBoxes=r,this._done=!1};je.prototype.isDone=function(){return this._done},je.prototype.continuePlacement=function(r,t,e){for(var i=this,n=ja.now(),o=function(){var e=ja.now()-n;return!i._forceFullPlacement&&2<e};0<=this._currentPlacementIndex;){var a=t[r[i._currentPlacementIndex]],s=i.placement.collisionIndex.transform.zoom;if("symbol"===a.type&&(!a.minzoom||a.minzoom<=s)&&(!a.maxzoom||a.maxzoom>s)){if(i._inProgressLayer||(i._inProgressLayer=new Ze),i._inProgressLayer.continuePlacement(e[a.source],i.placement,i._showCollisionBoxes,a,o))return;delete i._inProgressLayer}i._currentPlacementIndex--}this._done=!0},je.prototype.commit=function(a,t){return this.placement.commit(a,t),this.placement};var $e=512/ta.default$8/2,Ge=function(l,t,e){this.tileID=l,this.indexedSymbolInstances={},this.bucketInstanceId=e;for(var i=0,s=t;i<s.length;i+=1){var o=s[i],r=o.key;this.indexedSymbolInstances[r]||(this.indexedSymbolInstances[r]=[]),this.indexedSymbolInstances[r].push({crossTileID:o.crossTileID,coord:this.getScaledCoordinates(o,l)})}};Ge.prototype.getScaledCoordinates=function(t,e){var a=e.canonical.z-this.tileID.canonical.z,i=$e/_a(2,a),o=t.anchor;return{x:ea((e.canonical.x*ta.default$8+o.x)*i),y:ea((e.canonical.y*ta.default$8+o.y)*i)}},Ge.prototype.findMatches=function(d,t,e){for(var i=this.tileID.canonical.z<t.canonical.z?1:_a(2,this.tileID.canonical.z-t.canonical.z),n=0,p=d,r;n<p.length;n+=1)if(r=p[n],!r.crossTileID){var g=this.indexedSymbolInstances[r.key];if(g)for(var s=this.getScaledCoordinates(r,t),l=0,m=g,u;l<m.length;l+=1)if(u=m[l],wa(u.coord.x-s.x)<=i&&wa(u.coord.y-s.y)<=i&&!e[u.crossTileID]){e[u.crossTileID]=!0,r.crossTileID=u.crossTileID;break}}};var We=function(){this.maxCrossTileID=0};We.prototype.generate=function(){return++this.maxCrossTileID};var qe=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};qe.prototype.handleWrapJump=function(l){var t=R((l-this.lng)/360);if(0!==t)for(var e in this.indexes){var i=this.indexes[e],n={};for(var o in i){var r=i[o];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+t),n[r.tileID.key]=r}this.indexes[e]=n}this.lng=l},qe.prototype.addBucket=function(g,t,e){if(this.indexes[g.overscaledZ]&&this.indexes[g.overscaledZ][g.key]){if(this.indexes[g.overscaledZ][g.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(g.overscaledZ,this.indexes[g.overscaledZ][g.key])}for(var i=0,m=t.symbolInstances;i<m.length;i+=1)m[i].crossTileID=0;this.usedCrossTileIDs[g.overscaledZ]||(this.usedCrossTileIDs[g.overscaledZ]={});var o=this.usedCrossTileIDs[g.overscaledZ];for(var r in this.indexes){var a=this.indexes[r];if(+r>g.overscaledZ)for(var s in a){var l=a[s];l.tileID.isChildOf(g)&&l.findMatches(t.symbolInstances,g,o)}else{var c=a[g.scaledTo(+r).key];c&&c.findMatches(t.symbolInstances,g,o)}}for(var u=0,y=t.symbolInstances,p;u<y.length;u+=1)p=y[u],p.crossTileID||(p.crossTileID=e.generate(),o[p.crossTileID]=!0);return void 0===this.indexes[g.overscaledZ]&&(this.indexes[g.overscaledZ]={}),this.indexes[g.overscaledZ][g.key]=new Ge(g,t.symbolInstances,t.bucketInstanceId),!0},qe.prototype.removeBucketCrossTileIDs=function(a,t){for(var e in t.indexedSymbolInstances)for(var i=0,l=t.indexedSymbolInstances[e],o;i<l.length;i+=1)o=l[i],delete this.usedCrossTileIDs[a][o.crossTileID]},qe.prototype.removeStaleBuckets=function(a){var t=!1;for(var r in this.indexes){var i=this.indexes[r];for(var n in i)a[i[n].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,i[n]),delete i[n],t=!0)}return t};var Xe=function(){this.layerIndexes={},this.crossTileIDs=new We,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Xe.prototype.addLayer=function(d,t,e){var i=this.layerIndexes[d.id];void 0===i&&(i=this.layerIndexes[d.id]=new qe);var p=!1,u={};i.handleWrapJump(e);for(var r=0,g=t;r<g.length;r+=1){var s=g[r],l=s.getBucket(d);l&&d.id===l.layerIds[0]&&(l.bucketInstanceId||(l.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(s.tileID,l,this.crossTileIDs)&&(p=!0),u[l.bucketInstanceId]=!0)}return i.removeStaleBuckets(u)&&(p=!0),p},Xe.prototype.pruneUnusedLayers=function(a){var o={};for(var e in a.forEach(function(e){o[e]=!0}),this.layerIndexes)o[e]||delete this.layerIndexes[e]};var He=function(t,e){return ta.emitValidationErrors(t,e&&e.filter(function(e){return"source.canvas"!==e.identifier}))},Ke=ta.pick(Ga,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ye=ta.pick(Ga,["setCenter","setZoom","setBearing","setPitch"]),Je=function(t){function l(e,i){var s=this;void 0===i&&(i={}),t.call(this),this.map=e,this.dispatcher=new j((Qt||(Qt=new Xt),Qt),this),this.imageManager=new Ua,this.glyphManager=new Ha(e._transformRequest,i.localIdeographFontFamily),this.lineAtlas=new V(256,512),this.crossTileSymbolIndex=new Xe,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new ta.default$23,this._loaded=!1,this._resetUpdates();var r=this;this._rtlTextPluginCallback=l.registerForPluginAvailability(function(a){for(var t in r.dispatcher.broadcast("loadRTLTextPlugin",a.pluginURL,a.completionCallback),r.sourceCaches)r.sourceCaches[t].reload()}),this.on("data",function(a){if("source"===a.dataType&&"metadata"===a.sourceDataType){var t=s.sourceCaches[a.sourceId];if(t){var e=t.getSource();if(e&&e.vectorLayerIds)for(var r in s._layers){var i=s._layers[r];i.source===e.id&&s._validateLayer(i)}}}})}return t&&(l.__proto__=t),l.prototype=Object.create(t&&t.prototype),l.prototype.constructor=l,l.prototype.loadURL=function(t,a){var l=this;void 0===a&&(a={}),this.fire(new ta.Event("dataloading",{dataType:"style"}));var n="boolean"==typeof a.validate?a.validate:!aa(t);t=function(a,t){if(!aa(a))return a;var e=y(a);return e.path="/styles/v1"+e.path,c(e,t)}(t,a.accessToken);var o=this.map._transformRequest(t,ta.ResourceType.Style);ta.getJSON(o,function(t,e){t?l.fire(new ta.ErrorEvent(t)):e&&l._load(e,n)})},l.prototype.loadJSON=function(t,e){var a=this;void 0===e&&(e={}),this.fire(new ta.Event("dataloading",{dataType:"style"})),ja.frame(function(){a._load(t,!1!==e.validate)})},l.prototype._load=function(t,e){var r=this;if(!e||!He(this,ta.validateStyle(t))){for(var i in this._loaded=!0,this.stylesheet=t,t.sources)r.addSource(i,t.sources[i],{validate:!1});t.sprite?function(t,e,r){function i(){if(x)r(x);else if(g&&y){var t=ja.getImageData(y),e={};for(var a in g){var o=g[a],i=o.width,n=o.height,l=o.x,s=o.y,d=o.sdf,c=o.pixelRatio,p=new ta.RGBAImage({width:i,height:n});ta.RGBAImage.copy(t,p,{x:l,y:s},{x:0,y:0},{width:i,height:n}),e[a]={data:p,pixelRatio:c,sdf:d}}r(null,e)}}var n=1<ja.devicePixelRatio?"@2x":"",g,y,x;ta.getJSON(e(b(t,n,".json"),ta.ResourceType.SpriteJSON),function(a,t){x||(x=a,g=t,i())}),ta.getImage(e(b(t,n,".png"),ta.ResourceType.SpriteImage),function(a,t){x||(x=a,y=t,i())})}(t.sprite,this.map._transformRequest,function(t,e){if(t)r.fire(new ta.ErrorEvent(t));else if(e)for(var a in e)r.imageManager.addImage(a,e[a]);r.imageManager.setLoaded(!0),r.fire(new ta.Event("data",{dataType:"style"}))}):this.imageManager.setLoaded(!0),this.glyphManager.setURL(t.glyphs);var o=ra(this.stylesheet.layers);this._order=o.map(function(e){return e.id}),this._layers={};for(var a=0,n=o,l;a<n.length;a+=1)l=n[a],(l=ta.default$22(l)).setEventedParent(r,{layer:{id:l.id}}),r._layers[l.id]=l;this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Z(this.stylesheet.light),this.fire(new ta.Event("data",{dataType:"style"})),this.fire(new ta.Event("style.load"))}},l.prototype._validateLayer=function(t){var e=this.sourceCaches[t.source];if(e){var a=t.sourceLayer;if(a){var r=e.getSource();("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(a))&&this.fire(new ta.ErrorEvent(new Error("Source layer \""+a+"\" does not exist on source \""+r.id+"\" as specified by style layer \""+t.id+"\"")))}}},l.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()},l.prototype._serializeLayers=function(a){var o=this;return a.map(function(e){return o._layers[e].serialize()})},l.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var a in this.sourceCaches)if(this.sourceCaches[a].hasTransition())return!0;for(var t in this._layers)if(this._layers[t].hasTransition())return!0;return!1},l.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},l.prototype.update=function(t){if(this._loaded){if(this._changed){var e=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);for(var n in(e.length||i.length)&&this._updateWorkerLayers(e,i),this._updatedSources){var o=this._updatedSources[n];"reload"===o?this._reloadSource(n):"clear"===o&&this._clearSource(n)}for(var r in this._updatedPaintProps)this._layers[r].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates(),this.fire(new ta.Event("data",{dataType:"style"}))}for(var a in this.sourceCaches)this.sourceCaches[a].used=!1;for(var s=0,d=this._order;s<d.length;s+=1){var c=d[s],p=this._layers[c];p.recalculate(t),!p.isHidden(t.zoom)&&p.source&&(this.sourceCaches[p.source].used=!0)}this.light.recalculate(t),this.z=t.zoom}},l.prototype._updateWorkerLayers=function(a,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:t})},l.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={}},l.prototype.setState=function(t){var a=this;if(this._checkLoaded(),He(this,ta.validateStyle(t)))return!1;(t=ta.clone(t)).layers=ra(t.layers);var r=ce(this.serialize(),t).filter(function(e){return!(e.command in Ye)});if(0===r.length)return!1;var i=r.filter(function(e){return!(e.command in Ke)});if(0<i.length)throw new Error("Unimplemented: "+i.map(function(e){return e.command}).join(", ")+".");return r.forEach(function(e){"setTransition"!==e.command&&a[e.command].apply(a,e.args)}),this.stylesheet=t,!0},l.prototype.addImage=function(t,e){return this.getImage(t)?this.fire(new ta.ErrorEvent(new Error("An image with this name already exists."))):void(this.imageManager.addImage(t,e),this.fire(new ta.Event("data",{dataType:"style"})))},l.prototype.getImage=function(e){return this.imageManager.getImage(e)},l.prototype.removeImage=function(t){return this.getImage(t)?void(this.imageManager.removeImage(t),this.fire(new ta.Event("data",{dataType:"style"}))):this.fire(new ta.ErrorEvent(new Error("No image with this name exists.")))},l.prototype.addSource=function(t,e,a){var i=this;if(this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error("There is already a source with this ID");if(!e.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(e).join(", ")+".");if(!(0<=["vector","raster","geojson","video","image"].indexOf(e.type))||!this._validate(ta.validateStyle.source,"sources."+t,e,null,a)){this.map&&this.map._collectResourceTiming&&(e.collectResourceTiming=!0);var o=this.sourceCaches[t]=new qt(t,e,this.dispatcher);o.style=this,o.setEventedParent(this,function(){return{isSourceLoaded:i.loaded(),source:o.serialize(),sourceId:t}}),o.onAdd(this.map),this._changed=!0}},l.prototype.removeSource=function(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(var e in this._layers)if(this._layers[e].source===t)return this.fire(new ta.ErrorEvent(new Error("Source \""+t+"\" cannot be removed while layer \""+e+"\" is using it.")));var a=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],a.fire(new ta.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),a.setEventedParent(null),a.clearTiles(),a.onRemove&&a.onRemove(this.map),this._changed=!0},l.prototype.setGeoJSONSourceData=function(a,t){this._checkLoaded(),this.sourceCaches[a].getSource().setData(t),this._changed=!0},l.prototype.getSource=function(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()},l.prototype.addLayer=function(t,l,i){this._checkLoaded();var n=t.id;if(this.getLayer(n))this.fire(new ta.ErrorEvent(new Error("Layer with id \""+n+"\" already exists on this map")));else if("object"==typeof t.source&&(this.addSource(n,t.source),t=ta.clone(t),t=ta.extend(t,{source:n})),!this._validate(ta.validateStyle.layer,"layers."+n,t,{arrayIndex:-1},i)){var o=ta.default$22(t);this._validateLayer(o),o.setEventedParent(this,{layer:{id:n}});var r=l?this._order.indexOf(l):this._order.length;if(l&&-1===r)this.fire(new ta.ErrorEvent(new Error("Layer with id \""+l+"\" does not exist on this map.")));else{if(this._order.splice(r,0,n),this._layerOrderChanged=!0,this._layers[n]=o,this._removedLayers[n]&&o.source){var a=this._removedLayers[n];delete this._removedLayers[n],a.type===o.type?(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()):this._updatedSources[o.source]="clear"}this._updateLayer(o)}}},l.prototype.moveLayer=function(t,e){if(this._checkLoaded(),this._changed=!0,!this._layers[t])this.fire(new ta.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be moved.")));else if(t!==e){var a=this._order.indexOf(t);this._order.splice(a,1);var r=e?this._order.indexOf(e):this._order.length;e&&-1===r?this.fire(new ta.ErrorEvent(new Error("Layer with id \""+e+"\" does not exist on this map."))):(this._order.splice(r,0,t),this._layerOrderChanged=!0)}},l.prototype.removeLayer=function(t){this._checkLoaded();var e=this._layers[t];if(e){e.setEventedParent(null);var a=this._order.indexOf(t);this._order.splice(a,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=e,delete this._layers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t]}else this.fire(new ta.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be removed.")))},l.prototype.getLayer=function(e){return this._layers[e]},l.prototype.setLayerZoomRange=function(t,e,a){this._checkLoaded();var r=this.getLayer(t);r?r.minzoom===e&&r.maxzoom===a||(null!=e&&(r.minzoom=e),null!=a&&(r.maxzoom=a),this._updateLayer(r)):this.fire(new ta.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot have zoom extent.")))},l.prototype.setFilter=function(t,e){this._checkLoaded();var a=this.getLayer(t);if(!a)this.fire(new ta.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be filtered.")));else if(!ta.default$10(a.filter,e))return null==e?(a.filter=void 0,void this._updateLayer(a)):void(this._validate(ta.validateStyle.filter,"layers."+a.id+".filter",e)||(a.filter=ta.clone(e),this._updateLayer(a)))},l.prototype.getFilter=function(t){return ta.clone(this.getLayer(t).filter)},l.prototype.setLayoutProperty=function(t,e,a){this._checkLoaded();var r=this.getLayer(t);r?ta.default$10(r.getLayoutProperty(e),a)||(r.setLayoutProperty(e,a),this._updateLayer(r)):this.fire(new ta.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},l.prototype.getLayoutProperty=function(a,t){return this.getLayer(a).getLayoutProperty(t)},l.prototype.setPaintProperty=function(t,e,a){this._checkLoaded();var i=this.getLayer(t);if(!i)this.fire(new ta.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")));else if(!ta.default$10(i.getPaintProperty(e),a)){var o=i._transitionablePaint._values[e].value.isDataDriven();i.setPaintProperty(e,a),(i._transitionablePaint._values[e].value.isDataDriven()||o)&&this._updateLayer(i),this._changed=!0,this._updatedPaintProps[t]=!0}},l.prototype.getPaintProperty=function(a,t){return this.getLayer(a).getPaintProperty(t)},l.prototype.getTransition=function(){return ta.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},l.prototype.serialize=function(){var a=this;return ta.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:ta.mapObject(this.sourceCaches,function(e){return e.serialize()}),layers:this._order.map(function(e){return a._layers[e].serialize()})},function(e){return void 0!==e})},l.prototype._updateLayer=function(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._changed=!0},l.prototype._flattenRenderedFeatures=function(d){for(var t=[],e=this._order.length-1;0<=e;e--)for(var p=this._order[e],n=0,u=d,r;n<u.length;n+=1)if(r=u[n][p],r)for(var g=0,h=r,l;g<h.length;g+=1)l=h[g],t.push(l);return t},l.prototype.queryRenderedFeatures=function(t,e,i){e&&e.filter&&this._validate(ta.validateStyle.filter,"queryRenderedFeatures.filter",e.filter);var n={};if(e&&e.layers){if(!Array.isArray(e.layers))return this.fire(new ta.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var o=0,d=e.layers;o<d.length;o+=1){var a=d[o],s=this._layers[a];if(!s)return this.fire(new ta.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style and cannot be queried for features."))),[];n[s.source]=!0}}var l=[];for(var c in this.sourceCaches)e.layers&&!n[c]||l.push(G(this.sourceCaches[c],this._layers,t.worldCoordinate,e,i));return this.placement&&l.push(function(g,t,m,e,i){for(var y={},r=e.queryRenderedSymbols(t),a=[],o=0,n=Object.keys(r).map(Number),s;o<n.length;o+=1)s=n[o],a.push(i[s]);a.sort(at);for(var c=function(){var a=x[f],e=a.featureIndex.lookupSymbolFeatures(r[a.bucketInstanceId],a.bucketIndex,a.sourceLayerIndex,m.filter,m.layers,g);for(var t in e){var o=y[t]=y[t]||[],i=e[t];i.sort(function(e,t){var r=a.featureSortOrder;if(r){var i=r.indexOf(e.featureIndex);return r.indexOf(t.featureIndex)-i}return t.featureIndex-e.featureIndex});for(var n=0,l=i,s;n<l.length;n+=1)s=l[n],o.push(s.feature)}},f=0,x=a;f<x.length;f+=1)c();return y}(this._layers,t.viewport,e,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenRenderedFeatures(l)},l.prototype.querySourceFeatures=function(t,e){e&&e.filter&&this._validate(ta.validateStyle.filter,"querySourceFeatures.filter",e.filter);var a=this.sourceCaches[t];return a?function(l,t){for(var e=l.getRenderableIds().map(function(t){return l.getTileByID(t)}),i=[],n={},o=0;o<e.length;o++){var d=e[o],a=d.tileID.canonical.key;n[a]||(n[a]=!0,d.querySourceFeatures(i,t))}return i}(a,e):[]},l.prototype.addSourceType=function(a,t,e){return l.getSourceType(a)?e(new Error("A source type called \""+a+"\" already exists.")):(l.setSourceType(a,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:t.workerSourceURL},e):e(null,null))},l.prototype.getLight=function(){return this.light.getLight()},l.prototype.setLight=function(t){this._checkLoaded();var e=this.light.getLight(),r=!1;for(var i in t)if(!ta.default$10(t[i],e[i])){r=!0;break}if(r){var o={now:ja.now(),transition:ta.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t),this.light.updateTransitions(o)}},l.prototype._validate=function(t,e,a,i,o){return(!o||!1!==o.validate)&&He(this,t.call(ta.validateStyle,ta.extend({key:e,style:this.serialize(),value:a,styleSpec:ta.default$5},i)))},l.prototype._remove=function(){for(var t in ta.evented.off("pluginAvailable",this._rtlTextPluginCallback),this.sourceCaches)this.sourceCaches[t].clearTiles();this.dispatcher.remove()},l.prototype._clearSource=function(e){this.sourceCaches[e].clearTiles()},l.prototype._reloadSource=function(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()},l.prototype._updateSources=function(a){for(var t in this.sourceCaches)this.sourceCaches[t].update(a)},l.prototype._generateCollisionBoxes=function(){for(var e in this.sourceCaches)this._reloadSource(e)},l.prototype._updatePlacement=function(r,t,e){for(var i=!1,y=!1,x={},a=0,b=this._order;a<b.length;a+=1){var l=b[a],c=this._layers[l];if("symbol"===c.type){if(!x[c.source]){var u=this.sourceCaches[c.source];x[c.source]=u.getRenderableIds().map(function(e){return u.getTileByID(e)}).sort(function(a,t){return t.tileID.overscaledZ-a.tileID.overscaledZ||(a.tileID.isLessThan(t.tileID)?-1:1)})}var h=this.crossTileSymbolIndex.addLayer(c,x[c.source],r.center.lng);i=i||h}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var p=this._layerOrderChanged;if((p||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ja.now()))&&(this.pauseablePlacement=new je(r,this._order,p,t,e),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,x),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(this.placement,ja.now()),y=!0),i&&this.pauseablePlacement.placement.setStale()),y||i)for(var d=0,v=this._order;d<v.length;d+=1){var m=v[d],_=this._layers[m];"symbol"===_.type&&this.placement.updateLayerOpacities(_,x[_.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ja.now())},l.prototype.getImages=function(a,t,e){this.imageManager.getImages(t.icons,e)},l.prototype.getGlyphs=function(a,t,e){this.glyphManager.getGlyphs(t.stacks,e)},l}(ta.Evented);Je.getSourceType=function(e){return nt[e]},Je.setSourceType=function(a,t){nt[a]=t},Je.registerForPluginAvailability=ta.registerForPluginAvailability;var Qe=ta.createLayout([{name:"a_pos",type:"Int16",components:2}]),qa={prelude:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\n// Unpack a pair of values that have been packed into a single float.\n// The packed values are assumed to be 8-bit unsigned integers, and are\n// packed like so:\n// packedValue = floor(input[0]) * 256 + input[1],\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue = int(packedValue);\n    int v0 = packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec2 unpack_opacity(const float packedOpacity) {\n    int intOpacity = int(packedOpacity) / 2;\n    return vec2(float(intOpacity) / 127.0, mod(packedOpacity, 2.0));\n}\n\n// To minimize the number of attributes needed, we encode a 4-component\n// color into a pair of floats (i.e. a vec2) as follows:\n// [ floor(color.r * 255) * 256 + color.g * 255,\n//   floor(color.b * 255) * 256 + color.g * 255 ]\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\n// Unpack a pair of paint values and interpolate between them.\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\n// Unpack a pair of paint values and interpolate between them.\nvec4 unpack_mix_vec4(const vec4 packedColors, const float t) {\n    vec4 minColor = decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor = decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\n// The offset depends on how many pixels are between the world origin and the edge of the tile:\n// vec2 offset = mod(pixel_coord, size)\n//\n// At high zoom levels there are a ton of pixels between the world origin and the edge of the tile.\n// The glsl spec only guarantees 16 bits of precision for highp floats. We need more than that.\n//\n// The pixel_coord is passed in as two 16 bit values:\n// pixel_coord_upper = floor(pixel_coord / 2^16)\n// pixel_coord_lower = mod(pixel_coord, 2^16)\n//\n// The offset is calculated in a series of steps that should preserve this precision:\nvec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\n    const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\n\n    vec2 offset = mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\n}\n"},background:{fragmentSource:"uniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main() {\n    gl_FragColor = u_color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},backgroundPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\nuniform float u_opacity;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},circle:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    vec2 extrude = v_data.xy;\n    float extrude_length = length(extrude);\n\n    lowp float antialiasblur = v_data.z;\n    float antialiased_blur = -max(blur, antialiasblur);\n\n    float opacity_t = smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t = stroke_width < 0.01 ? 0.0 : smoothstep(\n        antialiased_blur,\n        0.0,\n        extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor = opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform bool u_scale_with_map;\nuniform bool u_pitch_with_map;\nuniform vec2 u_extrude_scale;\nuniform highp float u_camera_to_center_distance;\n\nattribute vec2 a_pos;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main(void) {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec2 circle_center = floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n        vec2 corner_position = circle_center;\n        if (u_scale_with_map) {\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale;\n        } else {\n            // Pitching the circle with the map effectively scales it with the map\n            // To counteract the effect for pitch-scale: viewport, we rescale the\n            // whole circle based on the pitch scaling effect at its central point\n            vec4 projected_center = u_matrix * vec4(circle_center, 0, 1);\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n        }\n\n        gl_Position = u_matrix * vec4(corner_position, 0, 1);\n    } else {\n        gl_Position = u_matrix * vec4(circle_center, 0, 1);\n\n        if (u_scale_with_map) {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n        } else {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n        }\n    }\n\n    // This is a minimum blur distance that serves as a faux-antialiasing for\n    // the circle. since blur is a ratio of the circle's size and the intent is\n    // to keep the blur at roughly 1px, the two are inversely related.\n    lowp float antialiasblur = 1.0 / DEVICE_PIXEL_RATIO / (radius + stroke_width);\n\n    v_data = vec3(extrude.x, extrude.y, antialiasblur);\n}\n"},clippingMask:{fragmentSource:"void main() {\n    gl_FragColor = vec4(1.0);\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},heatmap:{fragmentSource:"#pragma mapbox: define highp float weight\n\nuniform highp float u_intensity;\nvarying vec2 v_extrude;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main() {\n    #pragma mapbox: initialize highp float weight\n\n    // Kernel density estimation with a Gaussian kernel of size 5x5\n    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);\n    float val = weight * u_intensity * GAUSS_COEF * exp(d);\n\n    gl_FragColor = vec4(val, 1.0, 1.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\n\nuniform mat4 u_matrix;\nuniform float u_extrude_scale;\nuniform float u_opacity;\nuniform float u_intensity;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_extrude;\n\n// Effective \"0\" in the kernel density texture to adjust the kernel size to;\n// this empirically chosen number minimizes artifacts on overlapping kernels\n// for typical heatmap cases (assuming clustered source)\nconst highp float ZERO = 1.0 / 255.0 / 16.0;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main(void) {\n    #pragma mapbox: initialize highp float weight\n    #pragma mapbox: initialize mediump float radius\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 unscaled_extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // This 'extrude' comes in ranging from [-1, -1], to [1, 1].  We'll use\n    // it to produce the vertices of a square mesh framing the point feature\n    // we're adding to the kernel density texture.  We'll also pass it as\n    // a varying, so that the fragment shader can determine the distance of\n    // each fragment from the point feature.\n    // Before we do so, we need to scale it up sufficiently so that the\n    // kernel falls effectively to zero at the edge of the mesh.\n    // That is, we want to know S such that\n    // weight * u_intensity * GAUSS_COEF * exp(-0.5 * 3.0^2 * S^2) == ZERO\n    // Which solves to:\n    // S = sqrt(-2.0 * log(ZERO / (weight * u_intensity * GAUSS_COEF))) / 3.0\n    float S = sqrt(-2.0 * log(ZERO / weight / u_intensity / GAUSS_COEF)) / 3.0;\n\n    // Pass the varying in units of radius\n    v_extrude = S * unscaled_extrude;\n\n    // Scale by radius and the zoom-based scale factor to produce actual\n    // mesh position\n    vec2 extrude = v_extrude * radius * u_extrude_scale;\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec4 pos = vec4(floor(a_pos * 0.5) + extrude, 0, 1);\n\n    gl_Position = u_matrix * pos;\n}\n"},heatmapTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform sampler2D u_color_ramp;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    float t = texture2D(u_image, v_pos).r;\n    vec4 color = texture2D(u_color_ramp, vec2(t, 0.5));\n    gl_FragColor = color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},collisionBox:{fragmentSource:"\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        gl_FragColor *= .1;\n    }\n}",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field boxes in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    gl_Position.xy += a_extrude * u_extrude_scale * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n}\n"},collisionCircle:{fragmentSource:"uniform float u_overscale_factor;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    vec4 color = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        color = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        color *= .2;\n    }\n\n    float extrude_scale_length = length(v_extrude_scale);\n    float extrude_length = length(v_extrude) * extrude_scale_length;\n    float stroke_width = 15.0 * extrude_scale_length / u_overscale_factor;\n    float radius = v_radius * extrude_scale_length;\n\n    float distance_to_edge = abs(extrude_length - radius);\n    float opacity_t = smoothstep(-stroke_width, 0.0, -distance_to_edge);\n\n    gl_FragColor = opacity_t * color;\n}\n",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\n\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field circles in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n\n    highp float padding_factor = 1.2; // Pad the vertices slightly to make room for anti-alias blur\n    gl_Position.xy += a_extrude * u_extrude_scale * padding_factor * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n    v_radius = abs(a_extrude.y); // We don't pitch the circles, so both units of the extrusion vector are equal in magnitude to the radius\n\n    v_extrude = a_extrude * padding_factor;\n    v_extrude_scale = u_extrude_scale * u_camera_to_center_distance * collision_perspective_ratio;\n}\n"},debug:{fragmentSource:"uniform highp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fill:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_FragColor = color * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fillOutline:{fragmentSource:"#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_pos;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n    gl_FragColor = outline_color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos;\n\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillOutlinePattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    // find distance to outline for alpha interpolation\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n\n\n    gl_FragColor = mix(color1, color2, u_mix) * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},fillExtrusion:{fragmentSource:"varying vec4 v_color;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    gl_FragColor = v_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec4 v_color;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    vec3 normal = a_normal_ed.xyz;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n\n    gl_Position = u_matrix * vec4(a_pos, t > 0.0 ? height : base, 1);\n\n    // Relative luminance (how dark/bright is the surface color?)\n    float colorvalue = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\n\n    v_color = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // Add slight ambient lighting so no extrusions are totally black\n    vec4 ambientlight = vec4(0.03, 0.03, 0.03, 1.0);\n    color += ambientlight;\n\n    // Calculate cos(theta), where theta is the angle between surface normal and diffuse light ray\n    float directional = clamp(dot(normal / 16384.0, u_lightpos), 0.0, 1.0);\n\n    // Adjust directional so that\n    // the range of values for highlight/shading is narrower\n    // with lower light intensity\n    // and with lighter/brighter surface colors\n    directional = mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\n\n    // Add gradient along z axis of side surfaces\n    if (normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    // Assign final color based on surface + ambient light color, diffuse light directional, and light color\n    // with lower bounds adjusted to hue of light\n    // so that shading is tinted with the complementary (opposite) color to the light color\n    v_color.r += clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\n    v_color.g += clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\n    v_color.b += clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\n}\n"},fillExtrusionPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    vec4 mixedColor = mix(color1, color2, u_mix);\n\n    gl_FragColor = mixedColor * v_lighting;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\nuniform float u_height_factor;\n\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\nvarying float v_directional;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec3 normal = a_normal_ed.xyz;\n    float edgedistance = a_normal_ed.w;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n    float z = t > 0.0 ? height : base;\n\n    gl_Position = u_matrix * vec4(a_pos, z, 1);\n\n    vec2 pos = normal.x == 1.0 && normal.y == 0.0 && normal.z == 16384.0\n        ? a_pos // extrusion top\n        : vec2(edgedistance, z * u_height_factor); // extrusion side\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, pos);\n\n    v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\n    float directional = clamp(dot(normal / 16383.0, u_lightpos), 0.0, 1.0);\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\n\n    if (normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\n}\n"},extrusionTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_FragColor = texture2D(u_image, v_pos) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},hillshadePrepare:{fragmentSource:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D u_image;\nvarying vec2 v_pos;\nuniform vec2 u_dimension;\nuniform float u_zoom;\nuniform float u_maxzoom;\n\nfloat getElevation(vec2 coord, float bias) {\n    // Convert encoded elevation value to meters\n    vec4 data = texture2D(u_image, coord) * 255.0;\n    return (data.r + data.g * 256.0 + data.b * 256.0 * 256.0) / 4.0;\n}\n\nvoid main() {\n    vec2 epsilon = 1.0 / u_dimension;\n\n    // queried pixels:\n    // +-----------+\n    // |   |   |   |\n    // | a | b | c |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | d | e | f |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | g | h | i |\n    // |   |   |   |\n    // +-----------+\n\n    float a = getElevation(v_pos + vec2(-epsilon.x, -epsilon.y), 0.0);\n    float b = getElevation(v_pos + vec2(0, -epsilon.y), 0.0);\n    float c = getElevation(v_pos + vec2(epsilon.x, -epsilon.y), 0.0);\n    float d = getElevation(v_pos + vec2(-epsilon.x, 0), 0.0);\n    float e = getElevation(v_pos, 0.0);\n    float f = getElevation(v_pos + vec2(epsilon.x, 0), 0.0);\n    float g = getElevation(v_pos + vec2(-epsilon.x, epsilon.y), 0.0);\n    float h = getElevation(v_pos + vec2(0, epsilon.y), 0.0);\n    float i = getElevation(v_pos + vec2(epsilon.x, epsilon.y), 0.0);\n\n    // here we divide the x and y slopes by 8 * pixel size\n    // where pixel size (aka meters/pixel) is:\n    // circumference of the world / (pixels per tile * number of tiles)\n    // which is equivalent to: 8 * 40075016.6855785 / (512 * pow(2, u_zoom))\n    // which can be reduced to: pow(2, 19.25619978527 - u_zoom)\n    // we want to vertically exaggerate the hillshading though, because otherwise\n    // it is barely noticeable at low zooms. to do this, we multiply this by some\n    // scale factor pow(2, (u_zoom - u_maxzoom) * a) where a is an arbitrary value\n    // Here we use a=0.3 which works out to the expression below. see \n    // nickidlugash's awesome breakdown for more info\n    // https://github.com/mapbox/mapbox-gl-js/pull/5286#discussion_r148419556\n    float exaggeration = u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;\n\n    vec2 deriv = vec2(\n        (c + f + f + i) - (a + d + d + g),\n        (g + h + h + i) - (a + b + b + c)\n    ) /  pow(2.0, (u_zoom - u_maxzoom) * exaggeration + 19.2562 - u_zoom);\n\n    gl_FragColor = clamp(vec4(\n        deriv.x / 2.0 + 0.5,\n        deriv.y / 2.0 + 0.5,\n        1.0,\n        1.0), 0.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (a_texture_pos / 8192.0) / 2.0 + 0.25;\n}\n"},hillshade:{fragmentSource:"uniform sampler2D u_image;\nvarying vec2 v_pos;\n\nuniform vec2 u_latrange;\nuniform vec2 u_light;\nuniform vec4 u_shadow;\nuniform vec4 u_highlight;\nuniform vec4 u_accent;\n\n#define PI 3.141592653589793\n\nvoid main() {\n    vec4 pixel = texture2D(u_image, v_pos);\n\n    vec2 deriv = ((pixel.rg * 2.0) - 1.0);\n\n    // We divide the slope by a scale factor based on the cosin of the pixel's approximate latitude\n    // to account for mercator projection distortion. see #4807 for details\n    float scaleFactor = cos(radians((u_latrange[0] - u_latrange[1]) * (1.0 - v_pos.y) + u_latrange[1]));\n    // We also multiply the slope by an arbitrary z-factor of 1.25\n    float slope = atan(1.25 * length(deriv) / scaleFactor);\n    float aspect = deriv.x != 0.0 ? atan(deriv.y, -deriv.x) : PI / 2.0 * (deriv.y > 0.0 ? 1.0 : -1.0);\n\n    float intensity = u_light.x;\n    // We add PI to make this property match the global light object, which adds PI/2 to the light's azimuthal\n    // position property to account for 0deg corresponding to north/the top of the viewport in the style spec\n    // and the original shader was written to accept (-illuminationDirection - 90) as the azimuthal.\n    float azimuth = u_light.y + PI;\n\n    // We scale the slope exponentially based on intensity, using a calculation similar to\n    // the exponential interpolation function in the style spec:\n    // https://github.com/mapbox/mapbox-gl-js/blob/master/src/style-spec/expression/definitions/interpolate.js#L217-L228\n    // so that higher intensity values create more opaque hillshading.\n    float base = 1.875 - intensity * 1.75;\n    float maxValue = 0.5 * PI;\n    float scaledSlope = intensity != 0.5 ? ((pow(base, slope) - 1.0) / (pow(base, maxValue) - 1.0)) * maxValue : slope;\n\n    // The accent color is calculated with the cosine of the slope while the shade color is calculated with the sine\n    // so that the accent color's rate of change eases in while the shade color's eases out.\n    float accent = cos(scaledSlope);\n    // We multiply both the accent and shade color by a clamped intensity value\n    // so that intensities >= 0.5 do not additionally affect the color values\n    // while intensity values < 0.5 make the overall color more transparent.\n    vec4 accent_color = (1.0 - accent) * u_accent * clamp(intensity * 2.0, 0.0, 1.0);\n    float shade = abs(mod((aspect + azimuth) / PI + 0.5, 2.0) - 1.0);\n    vec4 shade_color = mix(u_shadow, u_highlight, shade) * sin(scaledSlope) * clamp(intensity * 2.0, 0.0, 1.0);\n    gl_FragColor = accent_color * (1.0 - shade_color.a) + shade_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = a_texture_pos / 8192.0;\n}\n"},line:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_linesofar;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},lineGradient:{fragmentSource:"\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nuniform sampler2D u_image;\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    // For gradient lines, v_lineprogress is the ratio along the entire line,\n    // scaled to [0, 2^15), and the gradient ramp is stored in a texture.\n    vec4 color = texture2D(u_image, vec2(v_lineprogress, 0.5));\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n// the attribute conveying progress along a line is scaled to [0, 2^15)\n#define MAX_LINE_DISTANCE 32767.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_lineprogress = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0 / MAX_LINE_DISTANCE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},linePattern:{fragmentSource:"uniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float x_a = mod(v_linesofar / u_pattern_size_a.x, 1.0);\n    float x_b = mod(v_linesofar / u_pattern_size_b.x, 1.0);\n\n    // v_normal.y is 0 at the midpoint of the line, -1 at the lower edge, 1 at the upper edge\n    // we clamp the line width outset to be between 0 and half the pattern height plus padding (2.0)\n    // to ensure we don't sample outside the designated symbol on the sprite sheet.\n    // 0.5 is added to shift the component to be bounded between 0 and 1 for interpolation of\n    // the texture coordinate\n    float y_a = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (u_pattern_size_a.y + 2.0) / 2.0) / u_pattern_size_a.y);\n    float y_b = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (u_pattern_size_b.y + 2.0) / 2.0) / u_pattern_size_b.y);\n    vec2 pos_a = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, vec2(x_a, y_a));\n    vec2 pos_b = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, vec2(x_b, y_b));\n\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\n\n    gl_FragColor = color * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_linesofar = a_linesofar;\n    v_width2 = vec2(outset, inset);\n}\n"},lineSDF:{fragmentSource:"\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *= smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist =outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    v_width2 = vec2(outset, inset);\n}\n"},raster:{fragmentSource:"uniform float u_fade_t;\nuniform float u_opacity;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n\n    // read and cross-fade colors from the main and parent tiles\n    vec4 color0 = texture2D(u_image0, v_pos0);\n    vec4 color1 = texture2D(u_image1, v_pos1);\n    if (color0.a > 0.0) {\n        color0.rgb = color0.rgb / color0.a;\n    }\n    if (color1.a > 0.0) {\n        color1.rgb = color1.rgb / color1.a;\n    }\n    vec4 color = mix(color0, color1, u_fade_t);\n    color.a *= u_opacity;\n    vec3 rgb = color.rgb;\n\n    // spin\n    rgb = vec3(\n        dot(rgb, u_spin_weights.xyz),\n        dot(rgb, u_spin_weights.zxy),\n        dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average = (color.r + color.g + color.b) / 3.0;\n    rgb += (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    // We are using Int16 for texture position coordinates to give us enough precision for\n    // fractional coordinates. We use 8192 to scale the texture coordinates in the buffer\n    // as an arbitrarily high number to preserve adequate precision when rendering.\n    // This is also the same value as the EXTENT we are using for our tile buffer pos coordinates,\n    // so math for modifying either is consistent.\n    v_pos0 = (((a_texture_pos / 8192.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\n}\n"},symbolIcon:{fragmentSource:"uniform sampler2D u_texture;\n\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    lowp float alpha = opacity * v_fade_opacity;\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform float u_fade_change;\n\n#pragma mapbox: define lowp float opacity\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n\n    float size;\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // See comments in symbol_sdf.vertex\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n            0.5 + 0.5 * distance_ratio,\n            0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n            4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // See comments in symbol_sdf.vertex\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n\n    v_tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    v_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n}\n"},symbolSDF:{fragmentSource:"#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\n\nuniform bool u_is_halo;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform sampler2D u_texture;\nuniform highp float u_gamma_scale;\nuniform bool u_is_text;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 tex = v_data0.xy;\n    float gamma_scale = v_data1.x;\n    float size = v_data1.y;\n    float fade_opacity = v_data1[2];\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    lowp vec4 color = fill_color;\n    highp float gamma = EDGE_GAMMA / (fontScale * u_gamma_scale);\n    lowp float buff = (256.0 - 64.0) / 256.0;\n    if (u_is_halo) {\n        color = halo_color;\n        gamma = (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n        buff = (6.0 - halo_width / fontScale) / SDF_PX;\n    }\n\n    lowp float dist = texture2D(u_texture, tex).a;\n    highp float gamma_scaled = gamma * gamma_scale;\n    highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n    gl_FragColor = color * (alpha * opacity * fade_opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\n// contents of a_size vary based on the type of property value\n// used for {text,icon}-size.\n// For constants, a_size is disabled.\n// For source functions, we bind only one value per vertex: the value of {text,icon}-size evaluated for the current feature.\n// For composite functions:\n// [ text-size(lowerZoomStop, feature),\n//   text-size(upperZoomStop, feature) ]\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\n\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_camera_to_center_distance;\nuniform float u_fade_change;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n    float size;\n\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // If the label is pitched with the map, layout is done in pitched space,\n    // which makes labels in the distance smaller relative to viewport space.\n    // We counteract part of that effect by multiplying by the perspective ratio.\n    // If the label isn't pitched with the map, we do layout in viewport space,\n    // which makes labels in the distance larger relative to the features around\n    // them. We counteract part of that effect by dividing by the perspective ratio.\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n        0.5 + 0.5 * distance_ratio,\n        0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n        4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // Point labels with 'rotation-alignment: map' are horizontal with respect to tile units\n        // To figure out that angle in projected space, we draw a short horizontal line in tile\n        // space, project it, and measure its angle in projected space.\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n    float gamma_scale = gl_Position.w;\n\n    vec2 tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    float interpolated_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n\n    v_data0 = vec2(tex.x, tex.y);\n    v_data1 = vec3(gamma_scale, size, interpolated_fade_opacity);\n}\n"}},Wa=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,Xa=function(a){var t=qa[a],l={};t.fragmentSource=t.fragmentSource.replace(Wa,function(a,t,e,i,o){return l[o]=!0,"define"===t?"\n#ifndef HAS_UNIFORM_u_"+o+"\nvarying "+e+" "+i+" "+o+";\n#else\nuniform "+e+" "+i+" u_"+o+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+o+"\n    "+e+" "+i+" "+o+" = u_"+o+";\n#endif\n"}),t.vertexSource=t.vertexSource.replace(Wa,function(i,t,e,n,o){var r="float"===n?"vec2":"vec4";return l[o]?"define"===t?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+e+" "+r+" a_"+o+";\nvarying "+e+" "+n+" "+o+";\n#else\nuniform "+e+" "+n+" u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = unpack_mix_"+r+"(a_"+o+", a_"+o+"_t);\n#else\n    "+e+" "+n+" "+o+" = u_"+o+";\n#endif\n":"define"===t?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float a_"+o+"_t;\nattribute "+e+" "+r+" a_"+o+";\n#else\nuniform "+e+" "+n+" u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+e+" "+n+" "+o+" = unpack_mix_"+r+"(a_"+o+", a_"+o+"_t);\n#else\n    "+e+" "+n+" "+o+" = u_"+o+";\n#endif\n"})};for(var Za in qa)Xa(Za);var $a=qa,Ja=function(r,t,e,i){var n=r.gl;this.program=n.createProgram();var o=e.defines().concat("#define DEVICE_PIXEL_RATIO "+ja.devicePixelRatio.toFixed(1));i&&o.push("#define OVERDRAW_INSPECTOR;");var a=o.concat($a.prelude.fragmentSource,t.fragmentSource).join("\n"),s=o.concat($a.prelude.vertexSource,t.vertexSource).join("\n"),l=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(l,a),n.compileShader(l),n.attachShader(this.program,l);var c=n.createShader(n.VERTEX_SHADER);n.shaderSource(c,s),n.compileShader(c),n.attachShader(this.program,c);for(var u=e.layoutAttributes||[],h=0;h<u.length;h++)n.bindAttribLocation(this.program,h,u[h].name);n.linkProgram(this.program),this.numAttributes=n.getProgramParameter(this.program,n.ACTIVE_ATTRIBUTES),this.attributes={},this.uniforms={};for(var y=0,x;y<this.numAttributes;y++)x=n.getActiveAttrib(this.program,y),x&&(this.attributes[x.name]=n.getAttribLocation(this.program,x.name));for(var b=n.getProgramParameter(this.program,n.ACTIVE_UNIFORMS),m=0,v;m<b;m++)v=n.getActiveUniform(this.program,m),v&&(this.uniforms[v.name]=n.getUniformLocation(this.program,v.name))};Ja.prototype.draw=function(g,t,e,i,n,o,r,a,s){for(var l=g.gl,u=(d={},d[l.LINES]=2,d[l.TRIANGLES]=3,d)[t],h=0,y=o.get(),d;h<y.length;h+=1){var x=y[h],f=x.vaos||(x.vaos={});(f[e]||(f[e]=new Q)).bind(g,this,i,r?r.getPaintVertexBuffers():[],n,x.vertexOffset,a,s),l.drawElements(t,x.primitiveLength*u,l.UNSIGNED_SHORT,2*(x.primitiveOffset*u))}};var Ka=ta.mat4.identity(new Float32Array(16)),Qa=ta.default$19.layout,eo=function(a,t){if(!a)return!1;var e=t.imageManager.getPattern(a.from),o=t.imageManager.getPattern(a.to);return!e||!o},to=function(d,t,e){var i=t.context,n=i.gl,o=t.imageManager.getPattern(d.from),r=t.imageManager.getPattern(d.to);n.uniform1i(e.uniforms.u_image,0),n.uniform2fv(e.uniforms.u_pattern_tl_a,o.tl),n.uniform2fv(e.uniforms.u_pattern_br_a,o.br),n.uniform2fv(e.uniforms.u_pattern_tl_b,r.tl),n.uniform2fv(e.uniforms.u_pattern_br_b,r.br);var a=t.imageManager.getPixelSize(),s=a.width,l=a.height;n.uniform2fv(e.uniforms.u_texsize,[s,l]),n.uniform1f(e.uniforms.u_mix,d.t),n.uniform2fv(e.uniforms.u_pattern_size_a,o.displaySize),n.uniform2fv(e.uniforms.u_pattern_size_b,r.displaySize),n.uniform1f(e.uniforms.u_scale_a,d.fromScale),n.uniform1f(e.uniforms.u_scale_b,d.toScale),i.activeTexture.set(n.TEXTURE0),t.imageManager.bind(t.context)},ao=function(l,t,e){var i=t.context.gl;i.uniform1f(e.uniforms.u_tile_units_to_pixels,1/Se(l,1,t.transform.tileZoom));var n=_a(2,l.tileID.overscaledZ),o=l.tileSize*_a(2,t.transform.tileZoom)/n,r=o*(l.tileID.canonical.x+l.tileID.wrap*n),a=o*l.tileID.canonical.y;i.uniform2f(e.uniforms.u_pixel_coord_upper,r>>16,a>>16),i.uniform2f(e.uniforms.u_pixel_coord_lower,65535&r,65535&a)},oo=ta.default$20.mat3,ro=ta.default$20.mat4,io=ta.default$20.vec3,no={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]},lo={symbol:function(a,t,e,r){if("translucent"===a.renderPass){var i=a.context;i.setStencilMode($t.disabled),i.setColorMode(a.colorModeForRenderPass()),0!==e.paint.get("icon-opacity").constantOr(1)&&sa(a,t,e,r,!1,e.paint.get("icon-translate"),e.paint.get("icon-translate-anchor"),e.layout.get("icon-rotation-alignment"),e.layout.get("icon-pitch-alignment"),e.layout.get("icon-keep-upright")),0!==e.paint.get("text-opacity").constantOr(1)&&sa(a,t,e,r,!0,e.paint.get("text-translate"),e.paint.get("text-translate-anchor"),e.layout.get("text-rotation-alignment"),e.layout.get("text-pitch-alignment"),e.layout.get("text-keep-upright")),t.map.showCollisionBoxes&&function(a,t,e,o){la(a,t,e,o,!1),la(a,t,e,o,!0)}(a,t,e,r)}},circle:function(y,t,e,i){if("translucent"===y.renderPass){var n=e.paint.get("circle-opacity"),o=e.paint.get("circle-stroke-width"),r=e.paint.get("circle-stroke-opacity");if(0!==n.constantOr(1)||0!==o.constantOr(1)&&0!==r.constantOr(1)){var a=y.context,s=a.gl;a.setDepthMode(y.depthModeForSublayer(0,jt.ReadOnly)),a.setStencilMode($t.disabled),a.setColorMode(y.colorModeForRenderPass());for(var l=!0,x=0;x<i.length;x++){var b=i[x],h=t.getTile(b),p=h.getBucket(e);if(p){var d=y.context.program.get(),f=p.programConfigurations.get(e.id),m=y.useProgram("circle",f);if((l||m.program!==d)&&(f.setUniforms(a,m,e.paint,{zoom:y.transform.zoom}),l=!1),s.uniform1f(m.uniforms.u_camera_to_center_distance,y.transform.cameraToCenterDistance),s.uniform1i(m.uniforms.u_scale_with_map,"map"===e.paint.get("circle-pitch-scale")?1:0),"map"===e.paint.get("circle-pitch-alignment")){s.uniform1i(m.uniforms.u_pitch_with_map,1);var _=Se(h,1,y.transform.zoom);s.uniform2f(m.uniforms.u_extrude_scale,_,_)}else s.uniform1i(m.uniforms.u_pitch_with_map,0),s.uniform2fv(m.uniforms.u_extrude_scale,y.transform.pixelsToGLUnits);s.uniformMatrix4fv(m.uniforms.u_matrix,!1,y.translatePosMatrix(b.posMatrix,h,e.paint.get("circle-translate"),e.paint.get("circle-translate-anchor"))),m.draw(a,s.TRIANGLES,e.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,f)}}}}},heatmap:function(t,e,i,n){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){var o=t.context,r=o.gl;o.setDepthMode(t.depthModeForSublayer(0,jt.ReadOnly)),o.setStencilMode($t.disabled),function(a,t,e){var i=a.gl;a.activeTexture.set(i.TEXTURE1),a.viewport.set([0,0,t.width/4,t.height/4]);var n=e.heatmapFbo;if(n)i.bindTexture(i.TEXTURE_2D,n.colorAttachment.get()),a.bindFramebuffer.set(n.framebuffer);else{var l=i.createTexture();i.bindTexture(i.TEXTURE_2D,l),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),n=e.heatmapFbo=a.createFramebuffer(t.width/4,t.height/4),function a(t,e,i,n){var o=t.gl;o.texImage2D(o.TEXTURE_2D,0,o.RGBA,e.width/4,e.height/4,0,o.RGBA,t.extTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),n.colorAttachment.set(i),t.extTextureHalfFloat&&o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE&&(t.extTextureHalfFloat=null,n.colorAttachment.setDirty(),a(t,e,i,n))}(a,t,l,n)}}(o,t,i),o.clear({color:ta.default$6.transparent}),o.setColorMode(new Gt([r.ONE,r.ONE],ta.default$6.transparent,[!0,!0,!0,!0]));for(var a=!0,g=0,y;g<n.length;g++)if(y=n[g],!e.hasRenderableParent(y)){var x=e.getTile(y),u=x.getBucket(i);if(u){var h=t.context.program.get(),p=u.programConfigurations.get(i.id),d=t.useProgram("heatmap",p),f=t.transform.zoom;(a||d.program!==h)&&(p.setUniforms(t.context,d,i.paint,{zoom:f}),a=!1),r.uniform1f(d.uniforms.u_extrude_scale,Se(x,1,f)),r.uniform1f(d.uniforms.u_intensity,i.paint.get("heatmap-intensity")),r.uniformMatrix4fv(d.uniforms.u_matrix,!1,y.posMatrix),d.draw(o,r.TRIANGLES,i.id,u.layoutVertexBuffer,u.indexBuffer,u.segments,p)}}o.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,e){var i=t.context,n=i.gl,o=e.heatmapFbo;if(o){i.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,o.colorAttachment.get()),i.activeTexture.set(n.TEXTURE1);var r=e.colorRampTexture;r||(r=e.colorRampTexture=new D(i,e.colorRamp,n.RGBA)),r.bind(n.LINEAR,n.CLAMP_TO_EDGE),i.setDepthMode(jt.disabled);var d=t.useProgram("heatmapTexture"),s=e.paint.get("heatmap-opacity");n.uniform1f(d.uniforms.u_opacity,s),n.uniform1i(d.uniforms.u_image,0),n.uniform1i(d.uniforms.u_color_ramp,1);var l=ta.mat4.create();ta.mat4.ortho(l,0,t.width,t.height,0,0,1),n.uniformMatrix4fv(d.uniforms.u_matrix,!1,l),n.uniform2f(d.uniforms.u_world,n.drawingBufferWidth,n.drawingBufferHeight),t.viewportVAO.bind(t.context,d,t.viewportBuffer,[]),n.drawArrays(n.TRIANGLE_STRIP,0,4)}}(t,i))},line:function(y,t,e,i){if("translucent"===y.renderPass&&0!==e.paint.get("line-opacity").constantOr(1)){var n=y.context;n.setDepthMode(y.depthModeForSublayer(0,jt.ReadOnly)),n.setColorMode(y.colorModeForRenderPass());for(var o=e.paint.get("line-dasharray")?"lineSDF":e.paint.get("line-pattern")?"linePattern":e.paint.get("line-gradient")?"lineGradient":"line",a=!0,x=0,b=i,c;x<b.length;x+=1){var v=b[x],u=t.getTile(v),h=u.getBucket(e);if(h){var p=h.programConfigurations.get(e.id),d=y.context.program.get(),f=y.useProgram(o,p),m=a||f.program!==d,_=c!==u.tileID.overscaledZ;m&&p.setUniforms(y.context,f,e.paint,{zoom:y.transform.zoom}),ua(f,y,u,h,e,v,p,m,_),c=u.tileID.overscaledZ,a=!1}}}},fill:function(t,e,i,n){var o=i.paint.get("fill-color"),r=i.paint.get("fill-opacity");if(0!==r.constantOr(1)){var a=t.context;a.setColorMode(t.colorModeForRenderPass());var s=i.paint.get("fill-pattern")||1!==o.constantOr(ta.default$6.transparent).a||1!==r.constantOr(0)?"translucent":"opaque";t.renderPass===s&&(a.setDepthMode(t.depthModeForSublayer(1,"opaque"===t.renderPass?jt.ReadWrite:jt.ReadOnly)),ga(t,e,i,n,ha)),"translucent"===t.renderPass&&i.paint.get("fill-antialias")&&(a.lineWidth.set(2),a.setDepthMode(t.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,jt.ReadOnly)),ga(t,e,i,n,ma))}},"fill-extrusion":function(t,e,i,n){if(0!==i.paint.get("fill-extrusion-opacity"))if("offscreen"===t.renderPass){!function(t,e){var i=t.context,n=i.gl,o=e.viewportFrame;if(t.depthRboNeedsClear&&t.setupOffscreenDepthRenderbuffer(),!o){var l=new D(i,{width:t.width,height:t.height,data:null},n.RGBA);l.bind(n.LINEAR,n.CLAMP_TO_EDGE),(o=e.viewportFrame=i.createFramebuffer(t.width,t.height)).colorAttachment.set(l.texture)}i.bindFramebuffer.set(o.framebuffer),o.depthAttachment.set(t.depthRbo),t.depthRboNeedsClear&&(i.clear({depth:1}),t.depthRboNeedsClear=!1),i.clear({color:ta.default$6.transparent}),i.setStencilMode($t.disabled),i.setDepthMode(new jt(n.LEQUAL,jt.ReadWrite,[0,1])),i.setColorMode(t.colorModeForRenderPass())}(t,i);for(var o=!0,d=0,p=n;d<p.length;d+=1){var s=p[d],l=e.getTile(s),c=l.getBucket(i);c&&(fa(t,0,i,l,s,c,o),o=!1)}}else"translucent"===t.renderPass&&function(l,t){var e=t.viewportFrame;if(e){var i=l.context,n=i.gl,o=l.useProgram("extrusionTexture");i.setStencilMode($t.disabled),i.setDepthMode(jt.disabled),i.setColorMode(l.colorModeForRenderPass()),i.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,e.colorAttachment.get()),n.uniform1f(o.uniforms.u_opacity,t.paint.get("fill-extrusion-opacity")),n.uniform1i(o.uniforms.u_image,0);var r=ro.create();ro.ortho(r,0,l.width,l.height,0,0,1),n.uniformMatrix4fv(o.uniforms.u_matrix,!1,r),n.uniform2f(o.uniforms.u_world,n.drawingBufferWidth,n.drawingBufferHeight),l.viewportVAO.bind(i,o,l.viewportBuffer,[]),n.drawArrays(n.TRIANGLE_STRIP,0,4)}}(t,i)},hillshade:function(d,t,e,i){if("offscreen"===d.renderPass||"translucent"===d.renderPass){var n=d.context,o=t.getSource().maxzoom;n.setDepthMode(d.depthModeForSublayer(0,jt.ReadOnly)),n.setStencilMode($t.disabled),n.setColorMode(d.colorModeForRenderPass());for(var r=0,p=i;r<p.length;r+=1){var s=p[r],l=t.getTile(s);l.needsHillshadePrepare&&"offscreen"===d.renderPass?ba(d,l,o):"translucent"===d.renderPass&&xa(d,l,e)}n.viewport.set([0,0,d.width,d.height])}},raster:function(w,t,e,i){if("translucent"===w.renderPass&&0!==e.paint.get("raster-opacity")){var n=w.context,a=n.gl,s=t.getSource(),l=w.useProgram("raster"),c,k;n.setStencilMode($t.disabled),n.setColorMode(w.colorModeForRenderPass()),a.uniform1f(l.uniforms.u_brightness_low,e.paint.get("raster-brightness-min")),a.uniform1f(l.uniforms.u_brightness_high,e.paint.get("raster-brightness-max")),a.uniform1f(l.uniforms.u_saturation_factor,0<(c=e.paint.get("raster-saturation"))?1-1/(1.001-c):-c),a.uniform1f(l.uniforms.u_contrast_factor,0<(k=e.paint.get("raster-contrast"))?1/(1-k):1+k),a.uniform3fv(l.uniforms.u_spin_weights,function(a){a*=Sa/180;var o=M(a),e=te(a);return[(2*e+1)/3,(-re(3)*o-e+1)/3,(re(3)*o-e+1)/3]}(e.paint.get("raster-hue-rotate"))),a.uniform1f(l.uniforms.u_buffer_scale,1),a.uniform1i(l.uniforms.u_image0,0),a.uniform1i(l.uniforms.u_image1,1);for(var T=i.length&&i[0].overscaledZ,u=0,A=i,p;u<A.length;u+=1){p=A[u],n.setDepthMode(w.depthModeForSublayer(p.overscaledZ-T,1===e.paint.get("raster-opacity")?jt.ReadWrite:jt.ReadOnly,a.LESS));var S=t.getTile(p),f=w.transform.calculatePosMatrix(p.toUnwrapped(),!0);S.registerFadeDuration(e.paint.get("raster-fade-duration")),a.uniformMatrix4fv(l.uniforms.u_matrix,!1,f);var m=t.findLoadedParent(p,0,{}),_=Ta(S,m,t,e,w.transform),g=void 0,C=void 0;if(n.activeTexture.set(a.TEXTURE0),S.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),n.activeTexture.set(a.TEXTURE1),m?(m.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),g=_a(2,m.tileID.overscaledZ-S.tileID.overscaledZ),C=[S.tileID.canonical.x*g%1,S.tileID.canonical.y*g%1]):S.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),a.uniform2fv(l.uniforms.u_tl_parent,C||[0,0]),a.uniform1f(l.uniforms.u_scale_parent,g||1),a.uniform1f(l.uniforms.u_fade_t,_.mix),a.uniform1f(l.uniforms.u_opacity,_.opacity*e.paint.get("raster-opacity")),s instanceof tt){var L=s.boundsBuffer;s.boundsVAO.bind(n,l,L,[]),a.drawArrays(a.TRIANGLE_STRIP,0,L.length)}else if(S.maskedBoundsBuffer&&S.maskedIndexBuffer&&S.segments)l.draw(n,a.TRIANGLES,e.id,S.maskedBoundsBuffer,S.maskedIndexBuffer,S.segments);else{var x=w.rasterBoundsBuffer;w.rasterBoundsVAO.bind(n,l,x,[]),a.drawArrays(a.TRIANGLE_STRIP,0,x.length)}}}},background:function(g,t,e){var i=e.paint.get("background-color"),n=e.paint.get("background-opacity");if(0!==n){var o=g.context,r=o.gl,a=g.transform,s=a.tileSize,l=e.paint.get("background-pattern"),c=l||1!==i.a||1!==n?"translucent":"opaque";if(g.renderPass===c){var u;if(o.setStencilMode($t.disabled),o.setDepthMode(g.depthModeForSublayer(0,"opaque"==c?jt.ReadWrite:jt.ReadOnly)),o.setColorMode(g.colorModeForRenderPass()),l){if(eo(l,g))return;u=g.useProgram("backgroundPattern"),to(l,g,u),g.tileExtentPatternVAO.bind(o,u,g.tileExtentBuffer,[])}else u=g.useProgram("background"),r.uniform4fv(u.uniforms.u_color,[i.r,i.g,i.b,i.a]),g.tileExtentVAO.bind(o,u,g.tileExtentBuffer,[]);r.uniform1f(u.uniforms.u_opacity,n);for(var m=0,y=a.coveringTiles({tileSize:s}),d;m<y.length;m+=1)d=y[m],l&&ao({tileID:d,tileSize:s},g,u),r.uniformMatrix4fv(u.uniforms.u_matrix,!1,g.transform.calculatePosMatrix(d.toUnwrapped())),r.drawArrays(r.TRIANGLE_STRIP,0,g.tileExtentBuffer.length)}}},debug:function(a,t,e){for(var o=0;o<e.length;o++)Aa(a,t,e[o])}},so=function(t,e){this.context=new Wt(t),this.transform=e,this._tileTextures={},this.setup(),this.numSublayers=qt.maxUnderzooming+qt.maxOverzooming+1,this.depthEpsilon=1/_a(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new ta.default$24,this.crossTileSymbolIndex=new Xe};so.prototype.resize=function(r,t){var e=this.context.gl;if(this.width=r*ja.devicePixelRatio,this.height=t*ja.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var i=0,l=this.style._order,o;i<l.length;i+=1)o=l[i],this.style._layers[o].resize();this.depthRbo&&(e.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},so.prototype.setup=function(){var t=this.context,e=new ta.PosArray;e.emplaceBack(0,0),e.emplaceBack(ta.default$8,0),e.emplaceBack(0,ta.default$8),e.emplaceBack(ta.default$8,ta.default$8),this.tileExtentBuffer=t.createVertexBuffer(e,Qe.members),this.tileExtentVAO=new Q,this.tileExtentPatternVAO=new Q;var a=new ta.PosArray;a.emplaceBack(0,0),a.emplaceBack(ta.default$8,0),a.emplaceBack(ta.default$8,ta.default$8),a.emplaceBack(0,ta.default$8),a.emplaceBack(0,0),this.debugBuffer=t.createVertexBuffer(a,Qe.members),this.debugVAO=new Q;var i=new ta.RasterBoundsArray;i.emplaceBack(0,0,0,0),i.emplaceBack(ta.default$8,0,ta.default$8,0),i.emplaceBack(0,ta.default$8,0,ta.default$8),i.emplaceBack(ta.default$8,ta.default$8,ta.default$8,ta.default$8),this.rasterBoundsBuffer=t.createVertexBuffer(i,J.members),this.rasterBoundsVAO=new Q;var o=new ta.PosArray;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(o,Qe.members),this.viewportVAO=new Q},so.prototype.clearStencil=function(){var t=this.context,e=t.gl;t.setColorMode(Gt.disabled),t.setDepthMode(jt.disabled),t.setStencilMode(new $t({func:e.ALWAYS,mask:0},0,255,e.ZERO,e.ZERO,e.ZERO));var a=ta.mat4.create();ta.mat4.ortho(a,0,this.width,this.height,0,0,1),ta.mat4.scale(a,a,[e.drawingBufferWidth,e.drawingBufferHeight,0]);var r=this.useProgram("clippingMask");e.uniformMatrix4fv(r.uniforms.u_matrix,!1,a),this.viewportVAO.bind(t,r,this.viewportBuffer,[]),e.drawArrays(e.TRIANGLE_STRIP,0,4)},so.prototype._renderTileClippingMasks=function(d){var t=this.context,e=t.gl;t.setColorMode(Gt.disabled),t.setDepthMode(jt.disabled);var i=1;this._tileClippingMaskIDs={};for(var c=0,p=d;c<p.length;c+=1){var r=p[c],a=this._tileClippingMaskIDs[r.key]=i++;t.setStencilMode(new $t({func:e.ALWAYS,mask:0},a,255,e.KEEP,e.KEEP,e.REPLACE));var s=this.useProgram("clippingMask");e.uniformMatrix4fv(s.uniforms.u_matrix,!1,r.posMatrix),this.tileExtentVAO.bind(this.context,s,this.tileExtentBuffer,[]),e.drawArrays(e.TRIANGLE_STRIP,0,this.tileExtentBuffer.length)}},so.prototype.stencilModeForClipping=function(a){var t=this.context.gl;return new $t({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,t.KEEP,t.KEEP,t.REPLACE)},so.prototype.colorModeForRenderPass=function(){var t=this.context.gl;return this._showOverdrawInspector?new Gt([t.CONSTANT_COLOR,t.ONE],new ta.default$6(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Gt.unblended:Gt.alphaBlended},so.prototype.depthModeForSublayer=function(a,t,e){var r=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon,i=r-1+this.depthRange;return new jt(e||this.context.gl.LEQUAL,t,[i,r])},so.prototype.render=function(t,e){var r=this;for(var i in this.style=t,this.options=e,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(ja.now()),t.sourceCaches){var o=r.style.sourceCaches[i];o.used&&o.prepare(r.context)}var a=this.style._order,n=ta.filterObject(this.style.sourceCaches,function(e){return"raster"===e.getSource().type||"raster-dem"===e.getSource().type}),l=function(t){var e=n[t];!function(t,e){for(var i=t.sort(function(a,t){return a.tileID.isLessThan(t.tileID)?-1:t.tileID.isLessThan(a.tileID)?1:0}),n=0;n<i.length;n++){var l={},r=i[n],a=i.slice(n+1);Ve(r.tileID.wrapped(),r.tileID,a,new ta.OverscaledTileID(0,r.tileID.wrap+1,0,0,0),l),r.setMask(l,e)}}(e.getVisibleCoordinates().map(function(a){return e.getTile(a)}),r.context)};for(var s in n)l(s);this.renderPass="offscreen";var c=[],u;this.depthRboNeedsClear=!0;for(var w=0,k;w<a.length;w++)k=r.style._layers[a[w]],k.hasOffscreenPass()&&!k.isHidden(r.transform.zoom)&&(k.source!==(u&&u.id)&&(c=[],(u=r.style.sourceCaches[k.source])&&(c=u.getVisibleCoordinates()).reverse()),c.length&&r.renderLayer(r,u,k,c));this.context.bindFramebuffer.set(null),this.context.clear({color:e.showOverdrawInspector?ta.default$6.black:ta.default$6.transparent,depth:1}),this._showOverdrawInspector=e.showOverdrawInspector,this.depthRange=(t._order.length+2)*this.numSublayers*this.depthEpsilon,this.renderPass="opaque";var T=[],A;for(this.currentLayer=a.length-1,this.currentLayer;0<=this.currentLayer;this.currentLayer--){var S=r.style._layers[a[r.currentLayer]];S.source!==(A&&A.id)&&(T=[],(A=r.style.sourceCaches[S.source])&&(r.clearStencil(),T=A.getVisibleCoordinates(),A.getSource().isTileClipped&&r._renderTileClippingMasks(T))),r.renderLayer(r,A,S,T)}this.renderPass="translucent";var g=[],C;for(this.currentLayer=0,this.currentLayer;this.currentLayer<a.length;this.currentLayer++){var L=r.style._layers[a[r.currentLayer]];L.source!==(C&&C.id)&&(g=[],(C=r.style.sourceCaches[L.source])&&(r.clearStencil(),g=C.getVisibleCoordinates(),C.getSource().isTileClipped&&r._renderTileClippingMasks(g)),g.reverse()),r.renderLayer(r,C,L,g)}if(this.options.showTileBoundaries){var x=this.style.sourceCaches[Object.keys(this.style.sourceCaches)[0]];x&&lo.debug(this,x,x.getVisibleCoordinates())}},so.prototype.setupOffscreenDepthRenderbuffer=function(){var e=this.context;this.depthRbo||(this.depthRbo=e.createRenderbuffer(e.gl.DEPTH_COMPONENT16,this.width,this.height))},so.prototype.renderLayer=function(a,t,e,o){e.isHidden(this.transform.zoom)||("background"===e.type||o.length)&&(this.id=e.id,lo[e.type](a,t,e,o))},so.prototype.translatePosMatrix=function(t,e,i,d,o){if(!i[0]&&!i[1])return t;var r=o?"map"===d?this.transform.angle:0:"viewport"===d?-this.transform.angle:0;if(r){var a=M(r),s=te(r);i=[i[0]*s-i[1]*a,i[0]*a+i[1]*s]}var l=[o?i[0]:Se(e,i[0],this.transform.zoom),o?i[1]:Se(e,i[1],this.transform.zoom),0],c=new Float32Array(16);return ta.mat4.translate(c,t,l),c},so.prototype.saveTileTexture=function(a){var t=this._tileTextures[a.size[0]];t?t.push(a):this._tileTextures[a.size[0]]=[a]},so.prototype.getTileTexture=function(a){var t=this._tileTextures[a];return t&&0<t.length?t.pop():null},so.prototype._createProgramCached=function(a,t){this.cache=this.cache||{};var e=""+a+(t.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[e]||(this.cache[e]=new Ja(this.context,$a[a],t,this._showOverdrawInspector)),this.cache[e]},so.prototype.useProgram=function(a,t){var e=this._createProgramCached(a,t||this.emptyProgramConfiguration);return this.context.program.set(e.program),e};var co=ta.default$20.vec4,po=ta.default$20.mat4,uo=ta.default$20.mat2,go=function(a,t,e){this.tileSize=512,this._renderWorldCopies=void 0===e||e,this._minZoom=a||0,this._maxZoom=t||22,this.latRange=[-85.05113,85.05113],this.width=0,this.height=0,this._center=new $(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}},ho={minZoom:{configurable:!0},maxZoom:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},x:{configurable:!0},y:{configurable:!0},point:{configurable:!0}};go.prototype.clone=function(){var e=new go(this._minZoom,this._maxZoom,this._renderWorldCopies);return e.tileSize=this.tileSize,e.latRange=this.latRange,e.width=this.width,e.height=this.height,e._center=this._center,e.zoom=this.zoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._unmodified=this._unmodified,e._calcMatrices(),e},ho.minZoom.get=function(){return this._minZoom},ho.minZoom.set=function(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=va(this.zoom,e))},ho.maxZoom.get=function(){return this._maxZoom},ho.maxZoom.set=function(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=ie(this.zoom,e))},ho.renderWorldCopies.get=function(){return this._renderWorldCopies},ho.renderWorldCopies.set=function(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e},ho.worldSize.get=function(){return this.tileSize*this.scale},ho.centerPoint.get=function(){return this.size._div(2)},ho.size.get=function(){return new ta.default$1(this.width,this.height)},ho.bearing.get=function(){return 180*(-this.angle/Sa)},ho.bearing.set=function(t){var e=-ta.wrap(t,-180,180)*Sa/180;this.angle!==e&&(this._unmodified=!1,this.angle=e,this._calcMatrices(),this.rotationMatrix=uo.create(),uo.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},ho.pitch.get=function(){return 180*(this._pitch/Sa)},ho.pitch.set=function(t){var e=ta.clamp(t,0,60)/180*Sa;this._pitch!==e&&(this._unmodified=!1,this._pitch=e,this._calcMatrices())},ho.fov.get=function(){return 180*(this._fov/Sa)},ho.fov.set=function(e){e=va(.01,ie(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Sa,this._calcMatrices())},ho.zoom.get=function(){return this._zoom},ho.zoom.set=function(a){var t=ie(va(a,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=ea(t),this.zoomFraction=t-this.tileZoom,this._constrain(),this._calcMatrices())},ho.center.get=function(){return this._center},ho.center.set=function(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())},go.prototype.coveringZoomLevel=function(e){return(e.roundZoom?R:ea)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize))},go.prototype.getVisibleUnwrappedCoordinates=function(t){var e=this.pointCoordinate(new ta.default$1(0,0),0),i=this.pointCoordinate(new ta.default$1(this.width,0),0),n=ea(e.column),o=ea(i.column),r=[new ta.UnwrappedTileID(0,t)];if(this._renderWorldCopies)for(var a=n;a<=o;a++)0!==a&&r.push(new ta.UnwrappedTileID(a,t));return r},go.prototype.coveringTiles=function(t){var e=this.coveringZoomLevel(t),a=e;if(void 0!==t.minzoom&&e<t.minzoom)return[];void 0!==t.maxzoom&&e>t.maxzoom&&(e=t.maxzoom);var n=this.pointCoordinate(this.centerPoint,e),o=new ta.default$1(n.column-.5,n.row-.5);return function(t,e,d,n){function i(e,a,o){var i,l,s,m;if(0<=o&&o<=g)for(i=e;i<a;i++)l=ea(i/g),s=(i%g+g)%g,0!==l&&!0!==n||(m=new ta.OverscaledTileID(d,l,t,s,o),r[m.key]=m)}void 0===n&&(n=!0);var g=1<<t,r={};return Ea(e[0],e[1],e[2],0,g,i),Ea(e[2],e[3],e[0],0,g,i),Object.keys(r).map(function(e){return r[e]})}(e,[this.pointCoordinate(new ta.default$1(0,0),e),this.pointCoordinate(new ta.default$1(this.width,0),e),this.pointCoordinate(new ta.default$1(this.width,this.height),e),this.pointCoordinate(new ta.default$1(0,this.height),e)],t.reparseOverscaled?a:e,this._renderWorldCopies).sort(function(a,t){return o.dist(a.canonical)-o.dist(t.canonical)})},go.prototype.resize=function(a,t){this.width=a,this.height=t,this.pixelsToGLUnits=[2/a,-2/t],this._constrain(),this._calcMatrices()},ho.unmodified.get=function(){return this._unmodified},go.prototype.zoomScale=function(e){return _a(2,e)},go.prototype.scaleZoom=function(e){return P(e)/E},go.prototype.project=function(t){return new ta.default$1(this.lngX(t.lng),this.latY(t.lat))},go.prototype.unproject=function(e){return new $(this.xLng(e.x),this.yLat(e.y))},ho.x.get=function(){return this.lngX(this.center.lng)},ho.y.get=function(){return this.latY(this.center.lat)},ho.point.get=function(){return new ta.default$1(this.x,this.y)},go.prototype.lngX=function(e){return(180+e)*this.worldSize/360},go.prototype.latY=function(e){return(180-180/Sa*P(g(Sa/4+e*Sa/360)))*this.worldSize/360},go.prototype.xLng=function(e){return 360*e/this.worldSize-180},go.prototype.yLat=function(a){var t=180-360*a/this.worldSize;return 360/Sa*k(ka(t*Sa/180))-90},go.prototype.setLocationAtPoint=function(a,t){var e=this.pointCoordinate(t)._sub(this.pointCoordinate(this.centerPoint));this.center=this.coordinateLocation(this.locationCoordinate(a)._sub(e)),this._renderWorldCopies&&(this.center=this.center.wrap())},go.prototype.locationPoint=function(e){return this.coordinatePoint(this.locationCoordinate(e))},go.prototype.pointLocation=function(e){return this.coordinateLocation(this.pointCoordinate(e))},go.prototype.locationCoordinate=function(t){return new ta.default$17(this.lngX(t.lng)/this.tileSize,this.latY(t.lat)/this.tileSize,this.zoom).zoomTo(this.tileZoom)},go.prototype.coordinateLocation=function(a){var t=a.zoomTo(this.zoom);return new $(this.xLng(t.column*this.tileSize),this.yLat(t.row*this.tileSize))},go.prototype.pointCoordinate=function(t,e){void 0===e&&(e=this.tileZoom);var g=[t.x,t.y,0,1],n=[t.x,t.y,1,1];co.transformMat4(g,g,this.pixelMatrixInverse),co.transformMat4(n,n,this.pixelMatrixInverse);var o=g[3],r=n[3],a=g[0]/o,s=n[0]/r,l=g[1]/o,c=n[1]/r,u=g[2]/o,h=n[2]/r,p=u==h?0:(0-u)/(h-u);return new ta.default$17(ta.number(a,s,p)/this.tileSize,ta.number(l,c,p)/this.tileSize,this.zoom)._zoomTo(e)},go.prototype.coordinatePoint=function(t){var e=t.zoomTo(this.zoom),a=[e.column*this.tileSize,e.row*this.tileSize,0,1];return co.transformMat4(a,a,this.pixelMatrix),new ta.default$1(a[0]/a[3],a[1]/a[3])},go.prototype.calculatePosMatrix=function(t,e){void 0===e&&(e=!1);var d=t.key,n=e?this._alignedPosMatrixCache:this._posMatrixCache;if(n[d])return n[d];var o=t.canonical,r=this.worldSize/this.zoomScale(o.z),a=o.x+_a(2,o.z)*t.wrap,s=po.identity(new Float64Array(16));return po.translate(s,s,[a*r,o.y*r,0]),po.scale(s,s,[r/ta.default$8,r/ta.default$8,1]),po.multiply(s,e?this.alignedProjMatrix:this.projMatrix,s),n[d]=new Float32Array(s),n[d]},go.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t=-90,y=90,x=-180,b=180,v=this.size,c=this._unmodified,u,w,k,T;if(this.latRange){var A=this.latRange;t=this.latY(A[1]),u=(y=this.latY(A[0]))-t<v.y?v.y/(y-t):0}if(this.lngRange){var h=this.lngRange;x=this.lngX(h[0]),w=(b=this.lngX(h[1]))-x<v.x?v.x/(b-x):0}var p=va(w||0,u||0);if(p)return this.center=this.unproject(new ta.default$1(w?(b+x)/2:this.x,u?(y+t)/2:this.y)),this.zoom+=this.scaleZoom(p),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var d=this.y,f=v.y/2;d-f<t&&(T=t+f),d+f>y&&(T=y-f)}if(this.lngRange){var m=this.x,_=v.x/2;m-_<x&&(k=x+_),m+_>b&&(k=b-_)}void 0===k&&void 0===T||(this.center=this.unproject(new ta.default$1(void 0===k?this.x:k,void 0===T?this.y:T))),this._unmodified=c,this._constraining=!1}},go.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/g(this._fov/2)*this.height;var m=this._fov/2,t=Sa/2+this._pitch,e=M(m)*this.cameraToCenterDistance/M(Sa-t-m),i=this.x,n=this.y,o=1.01*(te(Sa/2-this._pitch)*e+this.cameraToCenterDistance),r=new Float64Array(16);po.perspective(r,this._fov,this.width/this.height,1,o),po.scale(r,r,[1,-1,1]),po.translate(r,r,[0,0,-this.cameraToCenterDistance]),po.rotateX(r,r,this._pitch),po.rotateZ(r,r,this.angle),po.translate(r,r,[-i,-n,0]);var y=this.worldSize/(6378137*(2*Sa)*wa(te(this.center.lat*(Sa/180))));po.scale(r,r,[1,1,y,1]),this.projMatrix=r;var s=this.width%2/2,l=this.height%2/2,c=te(this.angle),u=M(this.angle),h=i-R(i)+c*s+u*l,p=n-R(n)+c*l+u*s,d=new Float64Array(r);if(po.translate(d,d,[.5<h?h-1:h,.5<p?p-1:p,0]),this.alignedProjMatrix=d,r=po.create(),po.scale(r,r,[this.width/2,-this.height/2,1]),po.translate(r,r,[1,-1,0]),this.pixelMatrix=po.multiply(new Float64Array(16),r,this.projMatrix),!(r=po.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=r,this._posMatrixCache={},this._alignedPosMatrixCache={}}},go.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var t=this.pointCoordinate(new ta.default$1(0,0)).zoomTo(this.zoom),e=[t.column*this.tileSize,t.row*this.tileSize,0,1];return co.transformMat4(e,e,this.pixelMatrix)[3]/this.cameraToCenterDistance},Object.defineProperties(go.prototype,ho);var mo=function(){var t,a,l,s,d;ta.bindAll(["_onHashChange","_updateHash"],this),this._updateHash=(t=this._updateHashUnthrottled.bind(this),a=300,l=!1,s=0,d=function(){s=0,l&&(t(),s=setTimeout(d,a),l=!1)},function(){return l=!0,s||d(),s})};mo.prototype.addTo=function(t){return this._map=t,ta.default.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},mo.prototype.remove=function(){return ta.default.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},mo.prototype.getHashString=function(d){var t=this._map.getCenter(),e=R(100*this._map.getZoom())/100,i=ae((e*E+P(512/360/.5))/z),n=_a(10,i),o=R(t.lng*n)/n,r=R(t.lat*n)/n,a=this._map.getBearing(),s=this._map.getPitch(),l="";return l+=d?"#/"+o+"/"+r+"/"+e:"#"+e+"/"+r+"/"+o,(a||s)&&(l+="/"+R(10*a)/10),s&&(l+="/"+R(s)),l},mo.prototype._onHashChange=function(){var t=ta.default.location.hash.replace("#","").split("/");return 3<=t.length&&(this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:+(t[3]||0),pitch:+(t[4]||0)}),!0)},mo.prototype._updateHashUnthrottled=function(){var t=this.getHashString();ta.default.history.replaceState(ta.default.history.state,"",t)};var yo=function(t){function e(e,i,n,o){void 0===o&&(o={});var s=Ba.mousePos(i.getCanvasContainer(),n),a=i.unproject(s);t.call(this,e,ta.extend({point:s,lngLat:a,originalEvent:n},o)),this._defaultPrevented=!1,this.target=i}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var a={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,a),e}(ta.Event),fo=function(t){function e(e,i,n){var o=Ba.touchPos(i.getCanvasContainer(),n),r=o.map(function(e){return i.unproject(e)}),a=o.reduce(function(a,t,e,o){return a.add(t.div(o.length))},new ta.default$1(0,0)),l=i.unproject(a);t.call(this,e,{points:o,point:a,lngLats:r,lngLat:l,originalEvent:n}),this._defaultPrevented=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var a={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,a),e}(ta.Event),xo=function(a){function t(t,e,o){a.call(this,t,{originalEvent:o}),this._defaultPrevented=!1}a&&(t.__proto__=a),t.prototype=Object.create(a&&a.prototype),t.prototype.constructor=t;var e={defaultPrevented:{configurable:!0}};return t.prototype.preventDefault=function(){this._defaultPrevented=!0},e.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(t.prototype,e),t}(ta.Event),bo=function(t){this._map=t,this._el=t.getCanvasContainer(),this._delta=0,ta.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};bo.prototype.isEnabled=function(){return!!this._enabled},bo.prototype.isActive=function(){return!!this._active},bo.prototype.enable=function(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=e&&"center"===e.around)},bo.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},bo.prototype.onWheel=function(t){if(this.isEnabled()){var e=t.deltaMode===ta.default.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY,a=ja.now(),r=a-(this._lastWheelEventTime||0);this._lastWheelEventTime=a,0!==e&&0==e%4.000244140625?this._type="wheel":0!==e&&4>wa(e)?this._type="trackpad":400<r?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=200>wa(r*e)?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&(this._lastWheelEvent=t,this._delta-=e,this.isActive()||this._start(t)),t.preventDefault()}},bo.prototype._onTimeout=function(e){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(e)},bo.prototype._start=function(t){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this._map.fire(new ta.Event("movestart",{originalEvent:t})),this._map.fire(new ta.Event("zoomstart",{originalEvent:t})),this._finishTimeout&&clearTimeout(this._finishTimeout);var e=Ba.mousePos(this._el,t);this._around=$.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(e)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},bo.prototype._onScrollFrame=function(){var t=this;if(this._frameId=null,this.isActive()){var e=this._map.transform;if(0!==this._delta){var r="wheel"===this._type&&4.000244140625<wa(this._delta)?1/450:.01,i=2/(1+ka(-wa(this._delta*r)));0>this._delta&&0!=i&&(i=1/i);var n="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=ie(e.maxZoom,va(e.minZoom,e.scaleZoom(n*i))),"wheel"===this._type&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a=!1;if("wheel"===this._type){var d=ie((ja.now()-this._lastWheelEventTime)/200,1),l=this._easing(d);e.zoom=ta.number(this._startZoom,this._targetZoom,l),1>d?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):a=!0}else e.zoom=this._targetZoom,a=!0;e.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new ta.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new ta.Event("zoom",{originalEvent:this._lastWheelEvent})),a&&(this._active=!1,this._finishTimeout=setTimeout(function(){t._map.fire(new ta.Event("zoomend",{originalEvent:t._lastWheelEvent})),t._map.fire(new ta.Event("moveend",{originalEvent:t._lastWheelEvent})),delete t._targetZoom},200))}},bo.prototype._smoothOutEasing=function(t){var e=ta.ease;if(this._prevEase){var r=this._prevEase,n=(ja.now()-r.start)/r.duration,o=r.easing(n+.01)-r.easing(n),a=.01*(.27/re(o*o+1e-4)),s=re(.0729-a*a);e=ta.bezier(a,s,.25,1)}return this._prevEase={start:ja.now(),duration:t,easing:e},e};var _o=function(t){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),ta.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};_o.prototype.isEnabled=function(){return!!this._enabled},_o.prototype.isActive=function(){return!!this._active},_o.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},_o.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},_o.prototype.onMouseDown=function(t){this.isEnabled()&&t.shiftKey&&0===t.button&&(ta.default.document.addEventListener("mousemove",this._onMouseMove,!1),ta.default.document.addEventListener("keydown",this._onKeyDown,!1),ta.default.document.addEventListener("mouseup",this._onMouseUp,!1),Ba.disableDrag(),this._startPos=Ba.mousePos(this._el,t),this._active=!0)},_o.prototype._onMouseMove=function(l){var t=this._startPos,e=Ba.mousePos(this._el,l);this._box||(this._box=Ba.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));var i=ie(t.x,e.x),n=va(t.x,e.x),o=ie(t.y,e.y),r=va(t.y,e.y);Ba.setTransform(this._box,"translate("+i+"px,"+o+"px)"),this._box.style.width=n-i+"px",this._box.style.height=r-o+"px"},_o.prototype._onMouseUp=function(t){if(0===t.button){var e=this._startPos,a=Ba.mousePos(this._el,t),r=new W().extend(this._map.unproject(e)).extend(this._map.unproject(a));this._finish(),Ba.suppressClick(),e.x===a.x&&e.y===a.y?this._fireEvent("boxzoomcancel",t):this._map.fitBounds(r,{linear:!0}).fire(new ta.Event("boxzoomend",{originalEvent:t,boxZoomBounds:r}))}},_o.prototype._onKeyDown=function(e){27===e.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",e))},_o.prototype._finish=function(){this._active=!1,ta.default.document.removeEventListener("mousemove",this._onMouseMove,!1),ta.default.document.removeEventListener("keydown",this._onKeyDown,!1),ta.default.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(Ba.remove(this._box),this._box=null),Ba.enableDrag()},_o.prototype._fireEvent=function(t,e){return this._map.fire(new ta.Event(t,{originalEvent:e}))};var vo=ta.bezier(0,0,.25,1),wo=function(t,e){this._map=t,this._el=e.element||t.getCanvasContainer(),this._state="disabled",this._button=e.button||"right",this._bearingSnap=e.bearingSnap||0,this._pitchWithRotate=!1!==e.pitchWithRotate,ta.bindAll(["_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};wo.prototype.isEnabled=function(){return"disabled"!==this._state},wo.prototype.isActive=function(){return"active"===this._state},wo.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},wo.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled";}},wo.prototype.onMouseDown=function(t){if("enabled"===this._state){if("right"!==this._button){if(t.ctrlKey||0!==Ba.mouseButton(t))return;this._eventButton=0}else if(this._eventButton=Ba.mouseButton(t),this._eventButton!==(t.ctrlKey?0:2))return;Ba.disableDrag(),ta.default.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),ta.default.document.addEventListener("mouseup",this._onMouseUp),ta.default.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[ja.now(),this._map.getBearing()]],this._previousPos=Ba.mousePos(this._el,t),this._center=this._map.transform.centerPoint,t.preventDefault()}},wo.prototype._onMouseMove=function(e){this._lastMoveEvent=e,this._pos=Ba.mousePos(this._el,e),"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",e),this._fireEvent("movestart",e),this._pitchWithRotate&&this._fireEvent("pitchstart",e)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame))},wo.prototype._onDragFrame=function(){this._frameId=null;var r=this._lastMoveEvent;if(r){var t=this._map.transform,e=this._previousPos,i=this._pos,n=.8*(e.x-i.x),o=-.5*(e.y-i.y),a=t.bearing-n,s=t.pitch-o,l=this._inertia,d=l[l.length-1];this._drainInertiaBuffer(),l.push([ja.now(),this._map._normalizeBearing(a,d[1])]),t.bearing=a,this._pitchWithRotate&&(this._fireEvent("pitch",r),t.pitch=s),this._fireEvent("rotate",r),this._fireEvent("move",r),delete this._lastMoveEvent,this._previousPos=this._pos}},wo.prototype._onMouseUp=function(e){if(Ba.mouseButton(e)===this._eventButton)switch(this._state){case"active":this._state="enabled",Ba.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(e);break;case"pending":this._state="enabled",this._unbind();}},wo.prototype._onBlur=function(e){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",e),this._pitchWithRotate&&this._fireEvent("pitchend",e),this._fireEvent("moveend",e);break;case"pending":this._state="enabled",this._unbind();}},wo.prototype._unbind=function(){ta.default.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),ta.default.document.removeEventListener("mouseup",this._onMouseUp),ta.default.removeEventListener("blur",this._onBlur),Ba.enableDrag()},wo.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._previousPos},wo.prototype._inertialRotate=function(g){var t=this;this._fireEvent("rotateend",g),this._drainInertiaBuffer();var e=this._map,i=e.getBearing(),n=this._inertia,o=function(){wa(i)<t._bearingSnap?e.resetNorth({noMoveStart:!0},{originalEvent:g}):t._fireEvent("moveend",g),t._pitchWithRotate&&t._fireEvent("pitchend",g)};if(2>n.length)o();else{var r=n[0],a=n[n.length-1],s=n[n.length-2],l=e._normalizeBearing(i,s[1]),m=a[1]-r[1],u=0>m?-1:1,h=(a[0]-r[0])/1e3;if(0!=m&&0!=h){var p=wa(m*(.25/h));180<p&&(p=180);var y=p/180;l+=u*p*(y/2),wa(e._normalizeBearing(l,0))<this._bearingSnap&&(l=e._normalizeBearing(0,l)),e.rotateTo(l,{duration:1e3*y,easing:vo,noMoveStart:!0},{originalEvent:g})}else o()}},wo.prototype._fireEvent=function(t,e){return this._map.fire(new ta.Event(t,e?{originalEvent:e}:{}))},wo.prototype._drainInertiaBuffer=function(){for(var a=this._inertia,t=ja.now();0<a.length&&160<t-a[0][0];)a.shift()};var ko=ta.bezier(0,0,.3,1),To=function(t){this._map=t,this._el=t.getCanvasContainer(),this._state="disabled",ta.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};To.prototype.isEnabled=function(){return"disabled"!==this._state},To.prototype.isActive=function(){return"active"===this._state},To.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled")},To.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled";}},To.prototype.onMouseDown=function(t){"enabled"===this._state&&(t.ctrlKey||0!==Ba.mouseButton(t)||(Ba.addEventListener(ta.default.document,"mousemove",this._onMove,{capture:!0}),Ba.addEventListener(ta.default.document,"mouseup",this._onMouseUp),this._start(t)))},To.prototype.onTouchStart=function(t){"enabled"===this._state&&(1<t.touches.length||(Ba.addEventListener(ta.default.document,"touchmove",this._onMove,{capture:!0,passive:!1}),Ba.addEventListener(ta.default.document,"touchend",this._onTouchEnd),this._start(t)))},To.prototype._start=function(t){ta.default.addEventListener("blur",this._onBlur),this._state="pending",this._previousPos=Ba.mousePos(this._el,t),this._inertia=[[ja.now(),this._previousPos]]},To.prototype._onMove=function(e){this._lastMoveEvent=e,e.preventDefault(),this._pos=Ba.mousePos(this._el,e),this._drainInertiaBuffer(),this._inertia.push([ja.now(),this._pos]),"pending"===this._state&&(this._state="active",this._fireEvent("dragstart",e),this._fireEvent("movestart",e)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame))},To.prototype._onDragFrame=function(){this._frameId=null;var a=this._lastMoveEvent;if(a){var t=this._map.transform;t.setLocationAtPoint(t.pointLocation(this._previousPos),this._pos),this._fireEvent("drag",a),this._fireEvent("move",a),this._previousPos=this._pos,delete this._lastMoveEvent}},To.prototype._onMouseUp=function(e){if(0===Ba.mouseButton(e))switch(this._state){case"active":this._state="enabled",Ba.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(e);break;case"pending":this._state="enabled",this._unbind();}},To.prototype._onTouchEnd=function(e){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(e);break;case"pending":this._state="enabled",this._unbind();}},To.prototype._onBlur=function(e){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("dragend",e),this._fireEvent("moveend",e);break;case"pending":this._state="enabled",this._unbind();}},To.prototype._unbind=function(){Ba.removeEventListener(ta.default.document,"touchmove",this._onMove,{capture:!0,passive:!1}),Ba.removeEventListener(ta.default.document,"touchend",this._onTouchEnd),Ba.removeEventListener(ta.default.document,"mousemove",this._onMove,{capture:!0}),Ba.removeEventListener(ta.default.document,"mouseup",this._onMouseUp),Ba.removeEventListener(ta.default,"blur",this._onBlur)},To.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._previousPos,delete this._pos},To.prototype._inertialPan=function(d){this._fireEvent("dragend",d),this._drainInertiaBuffer();var t=this._inertia;if(2>t.length)this._fireEvent("moveend",d);else{var e=t[t.length-1],i=t[0],n=e[1].sub(i[1]),o=(e[0]-i[0])/1e3;if(0==o||e[1].equals(i[1]))this._fireEvent("moveend",d);else{var r=n.mult(.3/o),a=r.mag();1400<a&&(a=1400,r._unit()._mult(a));var p=a/750,l=r.mult(-p/2);this._map.panBy(l,{duration:1e3*p,easing:ko,noMoveStart:!0},{originalEvent:d})}}},To.prototype._fireEvent=function(t,e){return this._map.fire(new ta.Event(t,e?{originalEvent:e}:{}))},To.prototype._drainInertiaBuffer=function(){for(var a=this._inertia,t=ja.now();0<a.length&&160<t-a[0][0];)a.shift()};var Ao=function(t){this._map=t,this._el=t.getCanvasContainer(),ta.bindAll(["_onKeyDown"],this)};Ao.prototype.isEnabled=function(){return!!this._enabled},Ao.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},Ao.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},Ao.prototype._onKeyDown=function(d){if(!(d.altKey||d.ctrlKey||d.metaKey)){var t=0,c=0,p=0,u=0,g=0;switch(d.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:d.shiftKey?c=-1:(d.preventDefault(),u=-1);break;case 39:d.shiftKey?c=1:(d.preventDefault(),u=1);break;case 38:d.shiftKey?p=1:(d.preventDefault(),g=-1);break;case 40:d.shiftKey?p=-1:(g=1,d.preventDefault());break;default:return;}var h=this._map,a=h.getZoom(),s={duration:300,delayEndEvents:500,easing:za,zoom:t?R(a)+t*(d.shiftKey?2:1):a,bearing:h.getBearing()+15*c,pitch:h.getPitch()+10*p,offset:[100*-u,100*-g],center:h.getCenter()};h.easeTo(s,{originalEvent:d})}};var So=function(t){this._map=t,ta.bindAll(["_onDblClick","_onZoomEnd"],this)};So.prototype.isEnabled=function(){return!!this._enabled},So.prototype.isActive=function(){return!!this._active},So.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},So.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},So.prototype.onTouchStart=function(a){var t=this;this.isEnabled()&&(1<a.points.length||(this._tapped?(clearTimeout(this._tapped),this._tapped=null,this._zoom(a)):this._tapped=setTimeout(function(){t._tapped=null},300)))},So.prototype.onDblClick=function(e){this.isEnabled()&&(e.originalEvent.preventDefault(),this._zoom(e))},So.prototype._zoom=function(e){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(e.originalEvent.shiftKey?-1:1),{around:e.lngLat},e)},So.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var Co=ta.bezier(0,0,.15,1),Lo=function(t){this._map=t,this._el=t.getCanvasContainer(),ta.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};Lo.prototype.isEnabled=function(){return!!this._enabled},Lo.prototype.enable=function(e){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around)},Lo.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},Lo.prototype.disableRotation=function(){this._rotationDisabled=!0},Lo.prototype.enableRotation=function(){this._rotationDisabled=!1},Lo.prototype.onStart=function(t){if(this.isEnabled()&&2===t.touches.length){var e=Ba.mousePos(this._el,t.touches[0]),a=Ba.mousePos(this._el,t.touches[1]);this._startVec=e.sub(a),this._gestureIntent=void 0,this._inertia=[],Ba.addEventListener(ta.default.document,"touchmove",this._onMove,{passive:!1}),Ba.addEventListener(ta.default.document,"touchend",this._onEnd)}},Lo.prototype._getTouchEventData=function(a){var t=Ba.mousePos(this._el,a.touches[0]),e=Ba.mousePos(this._el,a.touches[1]),o=t.sub(e);return{vec:o,center:t.add(e).div(2),scale:o.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*o.angleWith(this._startVec)/Sa}},Lo.prototype._onMove=function(t){if(2===t.touches.length){var e=this._getTouchEventData(t),i=e.vec,n=e.scale,o=e.bearing;if(!this._gestureIntent){var r=.15<wa(1-n);10<wa(o)?this._gestureIntent="rotate":r&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new ta.Event(this._gestureIntent+"start",{originalEvent:t})),this._map.fire(new ta.Event("movestart",{originalEvent:t})),this._startVec=i)}this._lastTouchEvent=t,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),t.preventDefault()}},Lo.prototype._onTouchFrame=function(){this._frameId=null;var t=this._gestureIntent;if(t){var e=this._map.transform;this._startScale||(this._startScale=e.scale,this._startBearing=e.bearing);var r=this._getTouchEventData(this._lastTouchEvent),i=r.center,o=r.bearing,a=r.scale,n=e.pointLocation(i),l=e.locationPoint(n);"rotate"===t&&(e.bearing=this._startBearing+o),e.zoom=e.scaleZoom(this._startScale*a),e.setLocationAtPoint(n,l),this._map.fire(new ta.Event(t,{originalEvent:this._lastTouchEvent})),this._map.fire(new ta.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([ja.now(),a,i])}},Lo.prototype._onEnd=function(t){Ba.removeEventListener(ta.default.document,"touchmove",this._onMove,{passive:!1}),Ba.removeEventListener(ta.default.document,"touchend",this._onEnd);var e=this._gestureIntent,i=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,e){this._map.fire(new ta.Event(e+"end",{originalEvent:t})),this._drainInertiaBuffer();var n=this._inertia,o=this._map;if(2>n.length)o.snapToNorth({},{originalEvent:t});else{var r=n[n.length-1],a=n[0],l=o.transform.scaleZoom(i*r[1]),s=o.transform.scaleZoom(i*a[1]),c=(r[0]-a[0])/1e3,p=r[2];if(0!=c&&l!==s){var d=.15*(l-s)/c;2.5<wa(d)&&(d=0<d?2.5:-2.5);var u=1e3*wa(d/(.15*12)),g=l+d*u/2e3;0>g&&(g=0),o.easeTo({zoom:g,duration:u,easing:Co,around:this._aroundCenter?o.getCenter():o.unproject(p),noMoveStart:!0},{originalEvent:t})}else o.snapToNorth({},{originalEvent:t})}}},Lo.prototype._drainInertiaBuffer=function(){for(var a=this._inertia,t=ja.now();2<a.length&&160<t-a[0][0];)a.shift()};var Eo={scrollZoom:bo,boxZoom:_o,dragRotate:wo,dragPan:To,keyboard:Ao,doubleClickZoom:So,touchZoomRotate:Lo},zo=function(t){function e(e,a){t.call(this),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=a.bearingSnap,ta.bindAll(["_renderFrameCallback"],this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCenter=function(){return this.transform.center},e.prototype.setCenter=function(a,t){return this.jumpTo({center:a},t)},e.prototype.panBy=function(t,a,o){return t=ta.default$1.convert(t).mult(-1),this.panTo(this.transform.center,ta.extend({offset:t},a),o)},e.prototype.panTo=function(t,e,a){return this.easeTo(ta.extend({center:t},e),a)},e.prototype.getZoom=function(){return this.transform.zoom},e.prototype.setZoom=function(a,t){return this.jumpTo({zoom:a},t),this},e.prototype.zoomTo=function(t,e,a){return this.easeTo(ta.extend({zoom:t},e),a)},e.prototype.zoomIn=function(a,t){return this.zoomTo(this.getZoom()+1,a,t),this},e.prototype.zoomOut=function(a,t){return this.zoomTo(this.getZoom()-1,a,t),this},e.prototype.getBearing=function(){return this.transform.bearing},e.prototype.setBearing=function(a,t){return this.jumpTo({bearing:a},t),this},e.prototype.rotateTo=function(t,e,a){return this.easeTo(ta.extend({bearing:t},e),a)},e.prototype.resetNorth=function(t,e){return this.rotateTo(0,ta.extend({duration:1e3},t),e),this},e.prototype.snapToNorth=function(a,t){return wa(this.getBearing())<this._bearingSnap?this.resetNorth(a,t):this},e.prototype.getPitch=function(){return this.transform.pitch},e.prototype.setPitch=function(a,t){return this.jumpTo({pitch:a},t),this},e.prototype.fitBounds=function(t,g,m){if("number"==typeof(g=ta.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},g)).padding){var n=g.padding;g.padding={top:n,bottom:n,right:n,left:n}}if(!ta.default$10(Object.keys(g.padding).sort(function(a,t){return a<t?-1:a>t?1:0}),["bottom","left","right","top"]))return ta.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'"),this;t=W.convert(t);var o=[(g.padding.left-g.padding.right)/2,(g.padding.top-g.padding.bottom)/2],r=ie(g.padding.right,g.padding.left),a=ie(g.padding.top,g.padding.bottom);g.offset=[g.offset[0]+o[0],g.offset[1]+o[1]];var s=ta.default$1.convert(g.offset),l=this.transform,c=l.project(t.getNorthWest()),u=l.project(t.getSouthEast()),h=u.sub(c),p=(l.width-2*r-2*wa(s.x))/h.x,d=(l.height-2*a-2*wa(s.y))/h.y;return 0>d||0>p?(ta.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset."),this):(g.center=l.unproject(c.add(u).div(2)),g.zoom=ie(l.scaleZoom(l.scale*ie(p,d)),g.maxZoom),g.bearing=0,g.linear?this.easeTo(g,m):this.flyTo(g,m))},e.prototype.jumpTo=function(t,e){this.stop();var i=this.transform,n=!1,l=!1,s=!1;return"zoom"in t&&i.zoom!==+t.zoom&&(n=!0,i.zoom=+t.zoom),void 0!==t.center&&(i.center=$.convert(t.center)),"bearing"in t&&i.bearing!==+t.bearing&&(l=!0,i.bearing=+t.bearing),"pitch"in t&&i.pitch!==+t.pitch&&(s=!0,i.pitch=+t.pitch),this.fire(new ta.Event("movestart",e)).fire(new ta.Event("move",e)),n&&this.fire(new ta.Event("zoomstart",e)).fire(new ta.Event("zoom",e)).fire(new ta.Event("zoomend",e)),l&&this.fire(new ta.Event("rotatestart",e)).fire(new ta.Event("rotate",e)).fire(new ta.Event("rotateend",e)),s&&this.fire(new ta.Event("pitchstart",e)).fire(new ta.Event("pitch",e)).fire(new ta.Event("pitchend",e)),this.fire(new ta.Event("moveend",e))},e.prototype.easeTo=function(t,b){var i=this;this.stop(),!1===(t=ta.extend({offset:[0,0],duration:500,easing:ta.ease},t)).animate&&(t.duration=0);var n=this.transform,o=this.getZoom(),r=this.getBearing(),a=this.getPitch(),s="zoom"in t?+t.zoom:o,l="bearing"in t?this._normalizeBearing(t.bearing,r):r,c="pitch"in t?+t.pitch:a,u=n.centerPoint.add(ta.default$1.convert(t.offset)),h=n.pointLocation(u),p=$.convert(t.center||h);this._normalizeCenter(p);var w=n.project(h),_=n.project(p).sub(w),g=n.zoomScale(s-o),v,k;return t.around&&(v=$.convert(t.around),k=n.locationPoint(v)),this._zooming=s!==o,this._rotating=r!==l,this._pitching=c!==a,this._prepareEase(b,t.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease(function(t){if(i._zooming&&(n.zoom=ta.number(o,s,t)),i._rotating&&(n.bearing=ta.number(r,l,t)),i._pitching&&(n.pitch=ta.number(a,c,t)),v)n.setLocationAtPoint(v,k);else{var e=n.zoomScale(n.zoom-o),p=s>o?ie(2,g):va(.5,g),d=_a(p,1-t),h=n.unproject(w.add(_.mult(t*d)).mult(e));n.setLocationAtPoint(n.renderWorldCopies?h.wrap():h,u)}i._fireMoveEvents(b)},function(){t.delayEndEvents?i._easeEndTimeoutID=setTimeout(function(){return i._afterEase(b)},t.delayEndEvents):i._afterEase(b)},t),this},e.prototype._prepareEase=function(t,e){this._moving=!0,e||this.fire(new ta.Event("movestart",t)),this._zooming&&this.fire(new ta.Event("zoomstart",t)),this._rotating&&this.fire(new ta.Event("rotatestart",t)),this._pitching&&this.fire(new ta.Event("pitchstart",t))},e.prototype._fireMoveEvents=function(t){this.fire(new ta.Event("move",t)),this._zooming&&this.fire(new ta.Event("zoom",t)),this._rotating&&this.fire(new ta.Event("rotate",t)),this._pitching&&this.fire(new ta.Event("pitch",t))},e.prototype._afterEase=function(t){var e=this._zooming,a=this._rotating,r=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,e&&this.fire(new ta.Event("zoomend",t)),a&&this.fire(new ta.Event("rotateend",t)),r&&this.fire(new ta.Event("pitchend",t)),this.fire(new ta.Event("moveend",t))},e.prototype.flyTo=function(t,k){function i(a){var t=(v*v-_*_+(a?-1:1)*w*w*y*y)/(2*(a?v:_)*w*y);return P(re(t*t+1)-t)}function T(e){return(ka(e)-ka(-e))/2}function L(e){return(ka(e)+ka(-e))/2}var C=this;this.stop(),t=ta.extend({offset:[0,0],speed:1.2,curve:1.42,easing:ta.ease},t);var n=this.transform,o=this.getZoom(),r=this.getBearing(),a=this.getPitch(),s="zoom"in t?ta.clamp(+t.zoom,n.minZoom,n.maxZoom):o,I="bearing"in t?this._normalizeBearing(t.bearing,r):r,c="pitch"in t?+t.pitch:a,l=n.zoomScale(s-o),u=n.centerPoint.add(ta.default$1.convert(t.offset)),p=n.pointLocation(u),d=$.convert(t.center||p);this._normalizeCenter(d);var f=n.project(p),m=n.project(d).sub(f),h=t.curve,_=va(n.width,n.height),v=_/l,y=m.mag();if("minZoom"in t){var x=ta.clamp(ie(t.minZoom,o,s),n.minZoom,n.maxZoom),b=_/n.zoomScale(x-o);h=re(2*(b/y))}var w=h*h,E=i(0),S=function(e){return L(E)/L(E+h*e)},O=function(a){return _*((L(E)*(T(t=E+h*a)/L(t))-T(E))/w)/y;var t},j=(i(1)-E)/h;if(1e-6>wa(y)||!isFinite(j)){if(1e-6>wa(_-v))return this.easeTo(t,k);var B=v<_?-1:1;j=wa(P(v/_))/h,O=function(){return 0},S=function(e){return ka(B*h*e)}}if("duration"in t)t.duration=+t.duration;else{var D="screenSpeed"in t?+t.screenSpeed/h:+t.speed;t.duration=1e3*j/D}return t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=r!==I,this._pitching=c!==a,this._prepareEase(k,!1),this._ease(function(t){var e=t*j,i=1/S(e);n.zoom=o+n.scaleZoom(i),C._rotating&&(n.bearing=ta.number(r,I,t)),C._pitching&&(n.pitch=ta.number(a,c,t));var l=n.unproject(f.add(m.mult(O(e))).mult(i));n.setLocationAtPoint(n.renderWorldCopies?l.wrap():l,u),C._fireMoveEvents(k)},function(){return C._afterEase(k)},t),this},e.prototype.isEasing=function(){return!!this._easeFrameId},e.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var e=this._onEaseEnd;delete this._onEaseEnd,e.call(this)}return this},e.prototype._ease=function(a,t,e){!1===e.animate||0===e.duration?(a(1),t()):(this._easeStart=ja.now(),this._easeOptions=e,this._onEaseFrame=a,this._onEaseEnd=t,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},e.prototype._renderFrameCallback=function(){var e=ie((ja.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),1>e?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},e.prototype._normalizeBearing=function(t,a){t=ta.wrap(t,-180,180);var o=wa(t-a);return wa(t-360-a)<o&&(t-=360),wa(t+360-a)<o&&(t+=360),t},e.prototype._normalizeCenter=function(a){var t=this.transform;if(t.renderWorldCopies&&!t.lngRange){var e=a.lng-t.center.lng;a.lng+=180<e?-360:-180>e?360:0}},e}(ta.Evented),Io=function(t){void 0===t&&(t={}),this.options=t,ta.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Io.prototype.getDefaultPosition=function(){return"bottom-right"},Io.prototype.onAdd=function(a){var t=this.options&&this.options.compact;return this._map=a,this._container=Ba.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Io.prototype.onRemove=function(){Ba.remove(this._container),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},Io.prototype._updateEditLink=function(){var a=this._editLink;a||(a=this._editLink=this._container.querySelector(".mapbox-improve-map"));var o=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:m.ACCESS_TOKEN}];if(a){var e=o.reduce(function(e,a,r){return a.value&&(e+=a.key+"="+a.value+(r<o.length-1?"&":"")),e},"?");a.href="https://www.mapbox.com/feedback/"+e+(this._map._hash?this._map._hash.getHashString(!0):"")}},Io.prototype._updateData=function(e){e&&"metadata"===e.sourceDataType&&(this._updateAttributions(),this._updateEditLink())},Io.prototype._updateAttributions=function(){if(this._map.style){var a=[];if(this._map.style.stylesheet){var r=this._map.style.stylesheet;this.styleOwner=r.owner,this.styleId=r.id}var e=this._map.style.sourceCaches;for(var i in e){var n=e[i].getSource();n.attribution&&0>a.indexOf(n.attribution)&&a.push(n.attribution)}a.sort(function(a,t){return a.length-t.length}),(a=a.filter(function(t,e){for(var o=e+1;o<a.length;o++)if(0<=a[o].indexOf(t))return!1;return!0})).length?(this._container.innerHTML=a.join(" | "),this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null}},Io.prototype._updateCompact=function(){640>=this._map.getCanvasContainer().offsetWidth?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Do=function(){ta.bindAll(["_updateLogo"],this)};Do.prototype.onAdd=function(a){this._map=a,this._container=Ba.create("div","mapboxgl-ctrl");var t=Ba.create("a","mapboxgl-ctrl-logo");return t.target="_blank",t.href="https://www.mapbox.com/",t.setAttribute("aria-label","Mapbox logo"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._container},Do.prototype.onRemove=function(){Ba.remove(this._container),this._map.off("sourcedata",this._updateLogo)},Do.prototype.getDefaultPosition=function(){return"bottom-left"},Do.prototype._updateLogo=function(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Do.prototype._logoRequired=function(){if(this._map.style){var a=this._map.style.sourceCaches;for(var t in a)if(a[t].getSource().mapbox_logo)return!0;return!1}};var Po=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Po.prototype.add=function(a){var t=++this._id;return this._queue.push({callback:a,id:t,cancelled:!1}),t},Po.prototype.remove=function(a){for(var t=this._currentlyRunning,e=0,r=t?this._queue.concat(t):this._queue,n;e<r.length;e+=1)if(n=r[e],n.id===a)return void(n.cancelled=!0)},Po.prototype.run=function(){var a=this._currentlyRunning=this._queue;this._queue=[];for(var t=0,o=a,r;t<o.length&&(r=o[t],r.cancelled||(r.callback(),!this._cleared));t+=1);this._cleared=!1,this._currentlyRunning=!1},Po.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Oo=ta.default.HTMLImageElement,Ro=ta.default.HTMLElement,Mo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,transformRequest:null,fadeDuration:300},jo=function(l){function e(t){if(null!=(t=ta.extend({},Mo,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than minZoom");var a=new go(t.minZoom,t.maxZoom,t.renderWorldCopies);l.call(this,a,t),this._interactive=t.interactive,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._crossFadingFactor=1,this._collectResourceTiming=t.collectResourceTiming,this._renderTaskQueue=new Po;var i=t.transformRequest;if(this._transformRequest=i?function(a,t){return i(a,t)||{url:a}}:function(e){return{url:e}},"string"==typeof t.container){var o=ta.default.document.getElementById(t.container);if(!o)throw new Error("Container '"+t.container+"' not found.");this._container=o}else{if(!(t.container instanceof Ro))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}t.maxBounds&&this.setMaxBounds(t.maxBounds),ta.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored","_update","_render","_onData","_onDataLoading"],this),this._setupContainer(),this._setupPainter(),this.on("move",this._update.bind(this,!1)),this.on("zoom",this._update.bind(this,!0)),void 0!==ta.default&&(ta.default.addEventListener("online",this._onWindowOnline,!1),ta.default.addEventListener("resize",this._onWindowResize,!1)),function(a,t){var l=a.getCanvasContainer(),s=null,d=!1;for(var e in Eo)a[e]=new Eo[e](a,t),t.interactive&&t[e]&&a[e].enable(t[e]);Ba.addEventListener(l,"mouseout",function(t){a.fire(new yo("mouseout",a,t))}),Ba.addEventListener(l,"mousedown",function(e){d=!0;var o=new yo("mousedown",a,e);a.fire(o),o.defaultPrevented||(t.interactive&&!a.doubleClickZoom.isActive()&&a.stop(),a.boxZoom.onMouseDown(e),a.boxZoom.isActive()||a.dragPan.isActive()||a.dragRotate.onMouseDown(e),a.boxZoom.isActive()||a.dragRotate.isActive()||a.dragPan.onMouseDown(e))}),Ba.addEventListener(l,"mouseup",function(t){var e=a.dragRotate.isActive();s&&!e&&a.fire(new yo("contextmenu",a,s)),s=null,d=!1,a.fire(new yo("mouseup",a,t))}),Ba.addEventListener(l,"mousemove",function(t){if(!a.dragPan.isActive()&&!a.dragRotate.isActive()){for(var e=t.toElement||t.target;e&&e!==l;)e=e.parentNode;e===l&&a.fire(new yo("mousemove",a,t))}}),Ba.addEventListener(l,"mouseover",function(t){for(var e=t.toElement||t.target;e&&e!==l;)e=e.parentNode;e===l&&a.fire(new yo("mouseover",a,t))}),Ba.addEventListener(l,"touchstart",function(e){var o=new fo("touchstart",a,e);a.fire(o),o.defaultPrevented||(t.interactive&&a.stop(),a.boxZoom.isActive()||a.dragRotate.isActive()||a.dragPan.onTouchStart(e),a.touchZoomRotate.onStart(e),a.doubleClickZoom.onTouchStart(o))},{passive:!1}),Ba.addEventListener(l,"touchmove",function(t){a.fire(new fo("touchmove",a,t))},{passive:!1}),Ba.addEventListener(l,"touchend",function(t){a.fire(new fo("touchend",a,t))}),Ba.addEventListener(l,"touchcancel",function(t){a.fire(new fo("touchcancel",a,t))}),Ba.addEventListener(l,"click",function(t){a.fire(new yo("click",a,t))}),Ba.addEventListener(l,"dblclick",function(t){var e=new yo("dblclick",a,t);a.fire(e),e.defaultPrevented||a.doubleClickZoom.onDblClick(e)}),Ba.addEventListener(l,"contextmenu",function(t){var e=a.dragRotate.isActive();d||e?d&&(s=t):a.fire(new yo("contextmenu",a,t)),t.preventDefault()}),Ba.addEventListener(l,"wheel",function(t){var e=new xo("wheel",a,t);a.fire(e),e.defaultPrevented||a.scrollZoom.onWheel(t)},{passive:!1})}(this,t),this._hash=t.hash&&new mo().addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),this.resize(),t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new Io),this.addControl(new Do,t.logoPosition),this.on("style.load",function(){this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",this._onData),this.on("dataloading",this._onDataLoading)}l&&(e.__proto__=l),e.prototype=Object.create(l&&l.prototype),e.prototype.constructor=e;var t={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0}};return e.prototype.addControl=function(a,t){void 0===t&&a.getDefaultPosition&&(t=a.getDefaultPosition()),void 0===t&&(t="top-right");var o=a.onAdd(this),r=this._controlPositions[t];return-1===t.indexOf("bottom")?r.appendChild(o):r.insertBefore(o,r.firstChild),this},e.prototype.removeControl=function(e){return e.onRemove(this),this},e.prototype.resize=function(t){var e=this._containerDimensions(),a=e[0],r=e[1];return this._resizeCanvas(a,r),this.transform.resize(a,r),this.painter.resize(a,r),this.fire(new ta.Event("movestart",t)).fire(new ta.Event("move",t)).fire(new ta.Event("resize",t)).fire(new ta.Event("moveend",t))},e.prototype.getBounds=function(){var t=new W(this.transform.pointLocation(new ta.default$1(0,this.transform.height)),this.transform.pointLocation(new ta.default$1(this.transform.width,0)));return(this.transform.angle||this.transform.pitch)&&(t.extend(this.transform.pointLocation(new ta.default$1(this.transform.size.x,0))),t.extend(this.transform.pointLocation(new ta.default$1(0,this.transform.size.y)))),t},e.prototype.getMaxBounds=function(){return this.transform.latRange&&2===this.transform.latRange.length&&this.transform.lngRange&&2===this.transform.lngRange.length?new W([this.transform.lngRange[0],this.transform.latRange[0]],[this.transform.lngRange[1],this.transform.latRange[1]]):null},e.prototype.setMaxBounds=function(a){if(a){var t=W.convert(a);this.transform.lngRange=[t.getWest(),t.getEast()],this.transform.latRange=[t.getSouth(),t.getNorth()],this.transform._constrain(),this._update()}else null==a&&(this.transform.lngRange=null,this.transform.latRange=null,this._update());return this},e.prototype.setMinZoom=function(e){if(0<=(e=null==e?0:e)&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},e.prototype.getMinZoom=function(){return this.transform.minZoom},e.prototype.setMaxZoom=function(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")},e.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},e.prototype.setRenderWorldCopies=function(e){return this.transform.renderWorldCopies=e,this._update(),this},e.prototype.getMaxZoom=function(){return this.transform.maxZoom},e.prototype.project=function(e){return this.transform.locationPoint($.convert(e))},e.prototype.unproject=function(t){return this.transform.pointLocation(ta.default$1.convert(t))},e.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},e.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isActive()},e.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},e.prototype.on=function(d,c,p){var n=this,e;if(void 0===p)return l.prototype.on.call(this,d,c);var t=function(){if("mouseenter"===d||"mouseover"===d){var t=!1;return{layer:c,listener:p,delegates:{mousemove:function(e){var o=n.getLayer(c)?n.queryRenderedFeatures(e.point,{layers:[c]}):[];o.length?t||(t=!0,p.call(n,new yo(d,n,e.originalEvent,{features:o}))):t=!1},mouseout:function(){t=!1}}}}if("mouseleave"===d||"mouseout"===d){var o=!1;return{layer:c,listener:p,delegates:{mousemove:function(e){(n.getLayer(c)?n.queryRenderedFeatures(e.point,{layers:[c]}):[]).length?o=!0:o&&(o=!1,p.call(n,new yo(d,n,e.originalEvent)))},mouseout:function(t){o&&(o=!1,p.call(n,new yo(d,n,t.originalEvent)))}}}}return{layer:c,listener:p,delegates:(e={},e[d]=function(e){var t=n.getLayer(c)?n.queryRenderedFeatures(e.point,{layers:[c]}):[];t.length&&(e.features=t,p.call(n,e),delete e.features)},e)}}();for(var a in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(t),t.delegates)n.on(a,t.delegates[a]);return this},e.prototype.off=function(i,t,e){if(void 0===e)return l.prototype.off.call(this,i,t);if(this._delegatedListeners&&this._delegatedListeners[i])for(var n=this._delegatedListeners[i],o=0,d;o<n.length;o++)if(d=n[o],d.layer===t&&d.listener===e){for(var c in d.delegates)this.off(c,d.delegates[c]);return n.splice(o,1),this}return this},e.prototype.queryRenderedFeatures=function(t,a){var o;return 2===arguments.length?(t=arguments[0],a=arguments[1]):1===arguments.length&&((o=arguments[0])instanceof ta.default$1||Array.isArray(o))?(t=arguments[0],a={}):1===arguments.length?(t=void 0,a=arguments[0]):(t=void 0,a={}),this.style?this.style.queryRenderedFeatures(this._makeQueryGeometry(t),a,this.transform):[]},e.prototype._makeQueryGeometry=function(t){var a=this,r;if(void 0===t&&(t=[ta.default$1.convert([0,0]),ta.default$1.convert([this.transform.width,this.transform.height])]),t instanceof ta.default$1||"number"==typeof t[0])r=[ta.default$1.convert(t)];else{var n=[ta.default$1.convert(t[0]),ta.default$1.convert(t[1])];r=[n[0],new ta.default$1(n[1].x,n[0].y),n[1],new ta.default$1(n[0].x,n[1].y),n[0]]}return{viewport:r,worldCoordinate:r.map(function(e){return a.transform.pointCoordinate(e)})}},e.prototype.querySourceFeatures=function(a,t){return this.style.querySourceFeatures(a,t)},e.prototype.setStyle=function(t,e){if((!e||!1!==e.diff&&!e.localIdeographFontFamily)&&this.style&&t&&"object"==typeof t)try{return this.style.setState(t)&&this._update(!0),this}catch(t){ta.warnOnce("Unable to perform style diff: "+(t.message||t.error||t)+".  Rebuilding the style from scratch.")}return this.style&&(this.style.setEventedParent(null),this.style._remove()),t?(this.style=new Je(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t),this):(delete this.style,this)},e.prototype.getStyle=function(){if(this.style)return this.style.serialize()},e.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():ta.warnOnce("There is no style added to the map.")},e.prototype.addSource=function(a,t){return this.style.addSource(a,t),this._update(!0),this},e.prototype.isSourceLoaded=function(t){var e=this.style&&this.style.sourceCaches[t];return void 0===e?void this.fire(new ta.ErrorEvent(new Error("There is no source with ID '"+t+"'"))):e.loaded()},e.prototype.areTilesLoaded=function(){var a=this.style&&this.style.sourceCaches;for(var t in a){var e=a[t]._tiles;for(var r in e){var i=e[r];if("loaded"!==i.state&&"errored"!==i.state)return!1}}return!0},e.prototype.addSourceType=function(a,t,e){return this.style.addSourceType(a,t,e)},e.prototype.removeSource=function(e){return this.style.removeSource(e),this._update(!0),this},e.prototype.getSource=function(e){return this.style.getSource(e)},e.prototype.addImage=function(t,e,r){void 0===r&&(r={});var i=r.pixelRatio;void 0===i&&(i=1);var g=r.sdf;if(void 0===g&&(g=!1),e instanceof Oo){var m=ja.getImageData(e),s=m.width,l=m.height,c=m.data;this.style.addImage(t,{data:new ta.RGBAImage({width:s,height:l},c),pixelRatio:i,sdf:g})}else{if(void 0===e.width||void 0===e.height)return this.fire(new ta.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var u=e.width,h=e.height,p=e.data;this.style.addImage(t,{data:new ta.RGBAImage({width:u,height:h},p.slice(0)),pixelRatio:i,sdf:g})}},e.prototype.hasImage=function(t){return t?!!this.style.getImage(t):(this.fire(new ta.ErrorEvent(new Error("Missing required image id"))),!1)},e.prototype.removeImage=function(e){this.style.removeImage(e)},e.prototype.loadImage=function(t,e){ta.getImage(this._transformRequest(t,ta.ResourceType.Image),e)},e.prototype.addLayer=function(a,t){return this.style.addLayer(a,t),this._update(!0),this},e.prototype.moveLayer=function(a,t){return this.style.moveLayer(a,t),this._update(!0),this},e.prototype.removeLayer=function(e){return this.style.removeLayer(e),this._update(!0),this},e.prototype.getLayer=function(e){return this.style.getLayer(e)},e.prototype.setFilter=function(a,t){return this.style.setFilter(a,t),this._update(!0),this},e.prototype.setLayerZoomRange=function(a,t,e){return this.style.setLayerZoomRange(a,t,e),this._update(!0),this},e.prototype.getFilter=function(e){return this.style.getFilter(e)},e.prototype.setPaintProperty=function(a,t,e){return this.style.setPaintProperty(a,t,e),this._update(!0),this},e.prototype.getPaintProperty=function(a,t){return this.style.getPaintProperty(a,t)},e.prototype.setLayoutProperty=function(a,t,e){return this.style.setLayoutProperty(a,t,e),this._update(!0),this},e.prototype.getLayoutProperty=function(a,t){return this.style.getLayoutProperty(a,t)},e.prototype.setLight=function(e){return this.style.setLight(e),this._update(!0),this},e.prototype.getLight=function(){return this.style.getLight()},e.prototype.getContainer=function(){return this._container},e.prototype.getCanvasContainer=function(){return this._canvasContainer},e.prototype.getCanvas=function(){return this._canvas},e.prototype._containerDimensions=function(){var a=0,o=0;return this._container&&(a=this._container.offsetWidth||400,o=this._container.offsetHeight||300),[a,o]},e.prototype._setupContainer=function(){var a=this._container;a.classList.add("mapboxgl-map"),(this._missingCSSContainer=Ba.create("div","mapboxgl-missing-css",a)).innerHTML="Missing Mapbox GL JS CSS";var t=this._canvasContainer=Ba.create("div","mapboxgl-canvas-container",a);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=Ba.create("canvas","mapboxgl-canvas",t),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var e=this._containerDimensions();this._resizeCanvas(e[0],e[1]);var r=this._controlContainer=Ba.create("div","mapboxgl-control-container",a),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(e){i[e]=Ba.create("div","mapboxgl-ctrl-"+e,r)})},e.prototype._resizeCanvas=function(t,e){var a=ta.default.devicePixelRatio||1;this._canvas.width=a*t,this._canvas.height=a*e,this._canvas.style.width=t+"px",this._canvas.style.height=e+"px"},e.prototype._setupPainter=function(){var e=ta.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},Ma.webGLContextAttributes),t=this._canvas.getContext("webgl",e)||this._canvas.getContext("experimental-webgl",e);t?this.painter=new so(t,this.transform):this.fire(new ta.ErrorEvent(new Error("Failed to initialize WebGL")))},e.prototype._contextLost=function(t){t.preventDefault(),this._frameId&&(ja.cancelFrame(this._frameId),this._frameId=null),this.fire(new ta.Event("webglcontextlost",{originalEvent:t}))},e.prototype._contextRestored=function(t){this._setupPainter(),this.resize(),this._update(),this.fire(new ta.Event("webglcontextrestored",{originalEvent:t}))},e.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&this.style&&this.style.loaded()},e.prototype._update=function(e){this.style&&(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this._rerender())},e.prototype._requestRenderFrame=function(e){return this._update(),this._renderTaskQueue.add(e)},e.prototype._cancelRenderFrame=function(e){this._renderTaskQueue.remove(e)},e.prototype._render=function(){this._renderTaskQueue.run();var t=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var r=this.transform.zoom,i=ja.now();this.style.zoomHistory.update(r,i);var n=new ta.default$16(r,{now:i,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),o=n.crossFadingFactor();1===o&&o===this._crossFadingFactor||(t=!0,this._crossFadingFactor=o),this.style.update(n)}return this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),fadeDuration:this._fadeDuration}),this.fire(new ta.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new ta.Event("load"))),this.style&&(this.style.hasTransitions()||t)&&(this._styleDirty=!0),(this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty)&&this._rerender(),this},e.prototype.remove=function(){this._hash&&this._hash.remove(),ja.cancelFrame(this._frameId),this._renderTaskQueue.clear(),this._frameId=null,this.setStyle(null),void 0!==ta.default&&(ta.default.removeEventListener("resize",this._onWindowResize,!1),ta.default.removeEventListener("online",this._onWindowOnline,!1));var t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),Ia(this._canvasContainer),Ia(this._controlContainer),Ia(this._missingCSSContainer),this._container.classList.remove("mapboxgl-map"),this.fire(new ta.Event("remove"))},e.prototype._rerender=function(){var e=this;this.style&&!this._frameId&&(this._frameId=ja.frame(function(){e._frameId=null,e._render()}))},e.prototype._onWindowOnline=function(){this._update()},e.prototype._onWindowResize=function(){this._trackResize&&this.stop().resize()._update()},t.showTileBoundaries.get=function(){return!!this._showTileBoundaries},t.showTileBoundaries.set=function(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())},t.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},t.showCollisionBoxes.set=function(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())},t.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},t.showOverdrawInspector.set=function(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())},t.repaint.get=function(){return!!this._repaint},t.repaint.set=function(e){this._repaint=e,this._update()},t.vertices.get=function(){return!!this._vertices},t.vertices.set=function(e){this._vertices=e,this._update()},e.prototype._onData=function(t){this._update("style"===t.dataType),this.fire(new ta.Event(t.dataType+"data",t))},e.prototype._onDataLoading=function(t){this.fire(new ta.Event(t.dataType+"dataloading",t))},Object.defineProperties(e.prototype,t),e}(zo),Bo={showCompass:!0,showZoom:!0},Fo=function(t){var e=this;this.options=ta.extend({},Bo,t),this._container=Ba.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(e){return e.preventDefault()}),this.options.showZoom&&(this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom In",function(){return e._map.zoomIn()}),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom Out",function(){return e._map.zoomOut()})),this.options.showCompass&&(ta.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset North",function(){return e._map.resetNorth()}),this._compassArrow=Ba.create("span","mapboxgl-ctrl-compass-arrow",this._compass))};Fo.prototype._rotateCompassArrow=function(){var e="rotate("+this._map.transform.angle*(180/Sa)+"deg)";this._compassArrow.style.transform=e},Fo.prototype.onAdd=function(e){return this._map=e,this.options.showCompass&&(this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new wo(e,{button:"left",element:this._compass}),this._handler.enable()),this._container},Fo.prototype.onRemove=function(){Ba.remove(this._container),this.options.showCompass&&(this._map.off("rotate",this._rotateCompassArrow),this._handler.disable(),delete this._handler),delete this._map},Fo.prototype._createButton=function(a,t,e){var o=Ba.create("button",a,this._container);return o.type="button",o.setAttribute("aria-label",t),o.addEventListener("click",e),o};var No={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Vo=function(t){if((arguments[0]instanceof ta.default.HTMLElement||2===arguments.length)&&(t=ta.extend({element:t},arguments[1])),ta.bindAll(["_update","_onMapClick"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",t&&t.element)this._element=t.element,this._offset=ta.default$1.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=Ba.create("div");var s=Ba.createNS("http://www.w3.org/2000/svg","svg");s.setAttributeNS(null,"height","41px"),s.setAttributeNS(null,"width","27px"),s.setAttributeNS(null,"viewBox","0 0 27 41");var i=Ba.createNS("http://www.w3.org/2000/svg","g");i.setAttributeNS(null,"stroke","none"),i.setAttributeNS(null,"stroke-width","1"),i.setAttributeNS(null,"fill","none"),i.setAttributeNS(null,"fill-rule","evenodd");var n=Ba.createNS("http://www.w3.org/2000/svg","g");n.setAttributeNS(null,"fill-rule","nonzero");var o=Ba.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"transform","translate(3.0, 29.0)"),o.setAttributeNS(null,"fill","#000000");for(var r=0,y=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];r<y.length;r+=1){var l=y[r],c=Ba.createNS("http://www.w3.org/2000/svg","ellipse");c.setAttributeNS(null,"opacity","0.04"),c.setAttributeNS(null,"cx","10.5"),c.setAttributeNS(null,"cy","5.80029008"),c.setAttributeNS(null,"rx",l.rx),c.setAttributeNS(null,"ry",l.ry),o.appendChild(c)}var u=Ba.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill",this._color);var h=Ba.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),u.appendChild(h);var p=Ba.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"opacity","0.25"),p.setAttributeNS(null,"fill","#000000");var d=Ba.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),p.appendChild(d);var f=Ba.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(6.0, 7.0)"),f.setAttributeNS(null,"fill","#FFFFFF");var m=Ba.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");var x=Ba.createNS("http://www.w3.org/2000/svg","circle");x.setAttributeNS(null,"fill","#000000"),x.setAttributeNS(null,"opacity","0.25"),x.setAttributeNS(null,"cx","5.5"),x.setAttributeNS(null,"cy","5.5"),x.setAttributeNS(null,"r","5.4999962");var g=Ba.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#FFFFFF"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962"),m.appendChild(x),m.appendChild(g),n.appendChild(o),n.appendChild(u),n.appendChild(p),n.appendChild(f),n.appendChild(m),s.appendChild(n),this._element.appendChild(s),this._offset=ta.default$1.convert(t&&t.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._popup=null};Vo.prototype.addTo=function(e){return this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),this._update(),this._map.on("click",this._onMapClick),this},Vo.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),delete this._map),Ba.remove(this._element),this._popup&&this._popup.remove(),this},Vo.prototype.getLngLat=function(){return this._lngLat},Vo.prototype.setLngLat=function(e){return this._lngLat=$.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},Vo.prototype.getElement=function(){return this._element},Vo.prototype.setPopup=function(a){if(this._popup&&(this._popup.remove(),this._popup=null),a){if(!("offset"in a.options)){var t=re(_a(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[t,-1*(24.6+t)],"bottom-right":[-t,-1*(24.6+t)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=a,this._lngLat&&this._popup.setLngLat(this._lngLat)}return this},Vo.prototype._onMapClick=function(a){var t=a.originalEvent.target,e=this._element;this._popup&&(t===e||e.contains(t))&&this.togglePopup()},Vo.prototype.getPopup=function(){return this._popup},Vo.prototype.togglePopup=function(){var e=this._popup;return e?(e.isOpen()?e.remove():e.addTo(this._map),this):this},Vo.prototype._update=function(e){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=Da(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),e&&"moveend"!==e.type||(this._pos=this._pos.round()),Ba.setTransform(this._element,No[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px)"),Pa(this._element,this._anchor,"marker"))},Vo.prototype.getOffset=function(){return this._offset},Vo.prototype.setOffset=function(t){return this._offset=ta.default$1.convert(t),this._update(),this};var Uo={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},Ho=function(t){function e(e){t.call(this),this.options=ta.extend({},Uo,e),ta.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.onAdd=function(t){var e;return this._map=t,this._container=Ba.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),e=this._setupUI,void 0===qo?void 0===ta.default.navigator.permissions?(qo=!!ta.default.navigator.geolocation,e(qo)):ta.default.navigator.permissions.query({name:"geolocation"}).then(function(a){qo="denied"!==a.state,e(qo)}):e(qo),this._container},e.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(ta.default.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker.remove(),Ba.remove(this._container),this._map=void 0},e.prototype._onSuccess=function(t){if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new ta.Event("geolocate",t)),this._finish()},e.prototype._updateCamera=function(a){var t=new $(a.coords.longitude,a.coords.latitude),e=a.coords.accuracy;this._map.fitBounds(t.toBounds(e),this.options.fitBoundsOptions,{geolocateSource:!0})},e.prototype._updateMarker=function(e){e?this._userLocationDotMarker.setLngLat([e.coords.longitude,e.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},e.prototype._onError=function(t){if(this.options.trackUserLocation)if(1===t.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new ta.Event("error",t)),this._finish()},e.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},e.prototype._setupUI=function(t){var a=this;!1!==t&&(this._container.addEventListener("contextmenu",function(e){return e.preventDefault()}),this._geolocateButton=Ba.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Ba.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Vo(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(t){t.geolocateSource||"ACTIVE_LOCK"!==a._watchState||(a._watchState="BACKGROUND",a._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),a._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),a.fire(new ta.Event("trackuserlocationend")))}))},e.prototype.trigger=function(){if(!this._setup)return ta.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new ta.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new ta.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new ta.Event("trackuserlocationstart"));}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=ta.default.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else ta.default.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},e.prototype._clearWatch=function(){ta.default.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},e}(ta.Evented),Go={maxWidth:100,unit:"metric"},Yo=function(t){this.options=ta.extend({},Go,t),ta.bindAll(["_onMove","setUnit"],this)},qo;Yo.prototype.getDefaultPosition=function(){return"bottom-left"},Yo.prototype._onMove=function(){Oa(this._map,this._container,this.options)},Yo.prototype.onAdd=function(e){return this._map=e,this._container=Ba.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Yo.prototype.onRemove=function(){Ba.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Yo.prototype.setUnit=function(e){this.options.unit=e,Oa(this._map,this._container,this.options)};var Wo=function(){this._fullscreen=!1,ta.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in ta.default.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in ta.default.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in ta.default.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in ta.default.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};Wo.prototype.onAdd=function(t){return this._map=t,this._mapContainer=this._map.getContainer(),this._container=Ba.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._container.style.display="none",ta.warnOnce("This device does not support fullscreen mode.")),this._container},Wo.prototype.onRemove=function(){Ba.remove(this._container),this._map=null,ta.default.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Wo.prototype._checkFullscreenSupport=function(){return!!(ta.default.document.fullscreenEnabled||ta.default.document.mozFullScreenEnabled||ta.default.document.msFullscreenEnabled||ta.default.document.webkitFullscreenEnabled)},Wo.prototype._setupUI=function(){var t=this._fullscreenButton=Ba.create("button",this._className+"-icon "+this._className+"-fullscreen",this._container);t.setAttribute("aria-label","Toggle fullscreen"),t.type="button",this._fullscreenButton.addEventListener("click",this._onClickFullscreen),ta.default.document.addEventListener(this._fullscreenchange,this._changeIcon)},Wo.prototype._isFullscreen=function(){return this._fullscreen},Wo.prototype._changeIcon=function(){(ta.default.document.fullscreenElement||ta.default.document.mozFullScreenElement||ta.default.document.webkitFullscreenElement||ta.default.document.msFullscreenElement)===this._mapContainer!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"))},Wo.prototype._onClickFullscreen=function(){this._isFullscreen()?ta.default.document.exitFullscreen?ta.default.document.exitFullscreen():ta.default.document.mozCancelFullScreen?ta.default.document.mozCancelFullScreen():ta.default.document.msExitFullscreen?ta.default.document.msExitFullscreen():ta.default.document.webkitCancelFullScreen&&ta.default.document.webkitCancelFullScreen():this._mapContainer.requestFullscreen?this._mapContainer.requestFullscreen():this._mapContainer.mozRequestFullScreen?this._mapContainer.mozRequestFullScreen():this._mapContainer.msRequestFullscreen?this._mapContainer.msRequestFullscreen():this._mapContainer.webkitRequestFullscreen&&this._mapContainer.webkitRequestFullscreen()};var Xo={closeButton:!0,closeOnClick:!0},Zo=function(t){function e(e){t.call(this),this.options=ta.extend(Object.create(Xo),e),ta.bindAll(["_update","_onClickClose"],this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addTo=function(t){return this._map=t,this._map.on("move",this._update),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this.fire(new ta.Event("open")),this},e.prototype.isOpen=function(){return!!this._map},e.prototype.remove=function(){return this._content&&Ba.remove(this._content),this._container&&(Ba.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map),this.fire(new ta.Event("close")),this},e.prototype.getLngLat=function(){return this._lngLat},e.prototype.setLngLat=function(e){return this._lngLat=$.convert(e),this._pos=null,this._update(),this},e.prototype.setText=function(t){return this.setDOMContent(ta.default.document.createTextNode(t))},e.prototype.setHTML=function(t){var e=ta.default.document.createDocumentFragment(),a=ta.default.document.createElement("body"),o;for(a.innerHTML=t;o=a.firstChild;)e.appendChild(o);return this.setDOMContent(e)},e.prototype.setDOMContent=function(e){return this._createContent(),this._content.appendChild(e),this._update(),this},e.prototype._createContent=function(){this._content&&Ba.remove(this._content),this._content=Ba.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=Ba.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},e.prototype._update=function(){if(this._map&&this._lngLat&&this._content){this._container||(this._container=Ba.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=Ba.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this._map.transform.renderWorldCopies&&(this._lngLat=Da(this._lngLat,this._pos,this._map.transform));var t=this._pos=this._map.project(this._lngLat),e=this.options.anchor,s=function t(e){if(e){if("number"==typeof e){var a=R(re(.5*_a(e,2)));return{center:new ta.default$1(0,0),top:new ta.default$1(0,e),"top-left":new ta.default$1(a,a),"top-right":new ta.default$1(-a,a),bottom:new ta.default$1(0,-e),"bottom-left":new ta.default$1(a,-a),"bottom-right":new ta.default$1(-a,-a),left:new ta.default$1(e,0),right:new ta.default$1(-e,0)}}if(e instanceof ta.default$1||Array.isArray(e)){var r=ta.default$1.convert(e);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:ta.default$1.convert(e.center||[0,0]),top:ta.default$1.convert(e.top||[0,0]),"top-left":ta.default$1.convert(e["top-left"]||[0,0]),"top-right":ta.default$1.convert(e["top-right"]||[0,0]),bottom:ta.default$1.convert(e.bottom||[0,0]),"bottom-left":ta.default$1.convert(e["bottom-left"]||[0,0]),"bottom-right":ta.default$1.convert(e["bottom-right"]||[0,0]),left:ta.default$1.convert(e.left||[0,0]),right:ta.default$1.convert(e.right||[0,0])}}return t(new ta.default$1(0,0))}(this.options.offset);if(!e){var n=this._container.offsetWidth,r=this._container.offsetHeight,a;a=t.y+s.bottom.y<r?["top"]:t.y>this._map.transform.height-r?["bottom"]:[],t.x<n/2?a.push("left"):t.x>this._map.transform.width-n/2&&a.push("right"),e=0===a.length?"bottom":a.join("-")}var d=t.add(s[e]).round();Ba.setTransform(this._container,No[e]+" translate("+d.x+"px,"+d.y+"px)"),Pa(this._container,e,"popup")}},e.prototype._onClickClose=function(){this.remove()},e}(ta.Evented),$o={version:"0.45.0",supported:Ma,workerCount:va(ea(ja.hardwareConcurrency/2),1),setRTLTextPlugin:ta.setRTLTextPlugin,Map:jo,NavigationControl:Fo,GeolocateControl:Ho,AttributionControl:Io,ScaleControl:Yo,FullscreenControl:Wo,Popup:Zo,Marker:Vo,Style:Je,LngLat:$,LngLatBounds:W,Point:ta.default$1,Evented:ta.Evented,config:m,get accessToken(){return m.ACCESS_TOKEN},set accessToken(e){m.ACCESS_TOKEN=e},workerUrl:""};return $o}),r})}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],410:[function(e,t){"use strict";function a(e,t,a){for(var o=Array(e),r=0;r<e;++r)o[r]=0,r===t&&(o[r]+=.5),r===a&&(o[r]+=.5);return o}function o(e,t){if(0===t||t===(1<<e+1)-1)return[];for(var o=[],n=[],l=0;l<=e;++l)if(t&1<<l){o.push(a(e,l-1,l-1)),n.push(null);for(var s=0;s<=e;++s)~t&1<<s&&(o.push(a(e,l-1,s-1)),n.push([l,s]))}var d=r(o),c=[];i_loop:for(var l=0;l<d.length;++l){for(var p=d[l],u=[],s=0;s<p.length;++s){if(!n[p[s]])continue i_loop;u.push(n[p[s]].slice())}c.push(u)}return c}t.exports=function(e){for(var t=1<<e+1,a=Array(t),r=0;r<t;++r)a[r]=o(e,r);return a};var r=e("convex-hull")},{"convex-hull":118}],411:[function(e,t){function a(e,t,a){var o=t[0],r=t[1],i=t[2],n=t[3];return e[0]=a[0]*o+a[4]*r+a[8]*i+a[12]*n,e[1]=a[1]*o+a[5]*r+a[9]*i+a[13]*n,e[2]=a[2]*o+a[6]*r+a[10]*i+a[14]*n,e[3]=a[3]*o+a[7]*r+a[11]*i+a[15]*n,e}function o(e,t){e[0][0]=t[0],e[0][1]=t[1],e[0][2]=t[2],e[1][0]=t[4],e[1][1]=t[5],e[1][2]=t[6],e[2][0]=t[8],e[2][1]=t[9],e[2][2]=t[10]}function r(e,t,a,o,r){e[0]=t[0]*o+a[0]*r,e[1]=t[1]*o+a[1]*r,e[2]=t[2]*o+a[2]*r}var n=e("./normalize"),l=e("gl-mat4/create"),s=e("gl-mat4/clone"),d=e("gl-mat4/determinant"),c=e("gl-mat4/invert"),p=e("gl-mat4/transpose"),u={length:e("gl-vec3/length"),normalize:e("gl-vec3/normalize"),dot:e("gl-vec3/dot"),cross:e("gl-vec3/cross")},g=l(),h=l(),m=[0,0,0,0],y=[[0,0,0],[0,0,0],[0,0,0]],f=[0,0,0];t.exports=function(e,t,l,x,b,_){if(t||(t=[0,0,0]),l||(l=[0,0,0]),x||(x=[0,0,0]),b||(b=[0,0,0,1]),_||(_=[0,0,0,1]),!n(g,e))return!1;if(s(h,g),h[3]=0,h[7]=0,h[11]=0,h[15]=1,wa(1e-8>d(h)))return!1;var v=g[3],w=g[7],k=g[11],T=g[12],A=g[13],S=g[14],C=g[15];if(0!==v||0!==w||0!==k){m[0]=v,m[1]=w,m[2]=k,m[3]=C;var L=c(h,h);if(!L)return!1;p(h,h),a(b,m,h)}else b[0]=b[1]=b[2]=0,b[3]=1;if(t[0]=T,t[1]=A,t[2]=S,o(y,g),l[0]=u.length(y[0]),u.normalize(y[0],y[0]),x[0]=u.dot(y[0],y[1]),r(y[1],y[1],y[0],1,-x[0]),l[1]=u.length(y[1]),u.normalize(y[1],y[1]),x[0]/=l[1],x[1]=u.dot(y[0],y[2]),r(y[2],y[2],y[0],1,-x[1]),x[2]=u.dot(y[1],y[2]),r(y[2],y[2],y[1],1,-x[2]),l[2]=u.length(y[2]),u.normalize(y[2],y[2]),x[1]/=l[2],x[2]/=l[2],u.cross(f,y[1],y[2]),0>u.dot(y[0],f))for(var E=0;3>E;E++)l[E]*=-1,y[E][0]*=-1,y[E][1]*=-1,y[E][2]*=-1;return _[0]=.5*re(va(1+y[0][0]-y[1][1]-y[2][2],0)),_[1]=.5*re(va(1-y[0][0]+y[1][1]-y[2][2],0)),_[2]=.5*re(va(1-y[0][0]-y[1][1]+y[2][2],0)),_[3]=.5*re(va(1+y[0][0]+y[1][1]+y[2][2],0)),y[2][1]>y[1][2]&&(_[0]=-_[0]),y[0][2]>y[2][0]&&(_[1]=-_[1]),y[1][0]>y[0][1]&&(_[2]=-_[2]),!0}},{"./normalize":412,"gl-mat4/clone":248,"gl-mat4/create":249,"gl-mat4/determinant":250,"gl-mat4/invert":254,"gl-mat4/transpose":264,"gl-vec3/cross":317,"gl-vec3/dot":322,"gl-vec3/length":332,"gl-vec3/normalize":339}],412:[function(e,t){t.exports=function(e,t){var a=t[15];if(0===a)return!1;for(var o=0;16>o;o++)e[o]=t[o]*(1/a);return!0}},{}],413:[function(e,t){function a(){return{translate:o(),scale:o(1),skew:o(),perspective:r(),quaternion:r()}}function o(e){return[e||0,e||0,e||0]}function r(){return[0,0,0,1]}var i=e("gl-vec3/lerp"),n=e("mat4-recompose"),l=e("mat4-decompose"),s=e("gl-mat4/determinant"),d=e("quat-slerp"),c=a(),p=a(),u=a();t.exports=function(e,t,a,o){if(0===s(t)||0===s(a))return!1;var r=l(t,c.translate,c.scale,c.skew,c.perspective,c.quaternion),g=l(a,p.translate,p.scale,p.skew,p.perspective,p.quaternion);return!!(r&&g)&&(i(u.translate,c.translate,p.translate,o),i(u.skew,c.skew,p.skew,o),i(u.scale,c.scale,p.scale,o),i(u.perspective,c.perspective,p.perspective,o),d(u.quaternion,c.quaternion,p.quaternion,o),n(e,u.translate,u.scale,u.skew,u.perspective,u.quaternion),!0)}},{"gl-mat4/determinant":250,"gl-vec3/lerp":333,"mat4-decompose":411,"mat4-recompose":414,"quat-slerp":466}],414:[function(e,t){var a={identity:e("gl-mat4/identity"),translate:e("gl-mat4/translate"),multiply:e("gl-mat4/multiply"),create:e("gl-mat4/create"),scale:e("gl-mat4/scale"),fromRotationTranslation:e("gl-mat4/fromRotationTranslation")},o=a.create(),r=a.create();t.exports=function(e,t,o,i,n,l){return a.identity(e),a.fromRotationTranslation(e,l,t),e[3]=n[0],e[7]=n[1],e[11]=n[2],e[15]=n[3],a.identity(r),0!==i[2]&&(r[9]=i[2],a.multiply(e,e,r)),0!==i[1]&&(r[9]=0,r[8]=i[1],a.multiply(e,e,r)),0!==i[0]&&(r[8]=0,r[4]=i[0],a.multiply(e,e,r)),a.scale(e,e,o),e}},{"gl-mat4/create":249,"gl-mat4/fromRotationTranslation":252,"gl-mat4/identity":253,"gl-mat4/multiply":256,"gl-mat4/scale":262,"gl-mat4/translate":263}],415:[function(e,t){"use strict";t.exports=a||function(e){return P(e)*Math.LOG2E}},{}],416:[function(e,t){"use strict";function a(e){this._components=e.slice(),this._time=[0],this.prevMatrix=e.slice(),this.nextMatrix=e.slice(),this.computedMatrix=e.slice(),this.computedInverse=e.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-Infinity,1/0]}var o=e("binary-search-bounds"),r=e("mat4-interpolate"),n=e("gl-mat4/invert"),l=e("gl-mat4/rotateX"),s=e("gl-mat4/rotateY"),d=e("gl-mat4/rotateZ"),c=e("gl-mat4/lookAt"),p=e("gl-mat4/translate"),u=e("gl-mat4/scale"),g=e("gl-vec3/normalize"),h=[0,0,0];t.exports=function(e){e=e||{};var t=e.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new a(t)};var m=a.prototype;m.recalcMatrix=function(e){var t=this._time,a=o.le(t,e),l=this.computedMatrix;if(!(0>a)){var s=this._components;if(a===t.length-1)for(var d=16*a,c=0;16>c;++c)l[c]=s[d++];else{for(var p=t[a+1]-t[a],d=16*a,u=this.prevMatrix,h=!0,c=0;16>c;++c)u[c]=s[d++];for(var m=this.nextMatrix,c=0;16>c;++c)m[c]=s[d++],h=h&&u[c]===m[c];if(1e-6>p||h)for(var c=0;16>c;++c)l[c]=u[c];else r(l,u,m,(e-t[a])/p)}var y=this.computedUp;y[0]=l[1],y[1]=l[5],y[2]=l[9],g(y,y);var f=this.computedInverse;n(f,l);var x=this.computedEye,b=f[15];x[0]=f[12]/b,x[1]=f[13]/b,x[2]=f[14]/b;for(var _=this.computedCenter,v=ka(this.computedRadius[0]),c=0;3>c;++c)_[c]=x[c]-l[2+4*c]*v}},m.idle=function(e){if(!(e<this.lastT())){for(var t=this._components,a=t.length-16,o=0;16>o;++o)t.push(t[a++]);this._time.push(e)}},m.flush=function(e){var t=o.gt(this._time,e)-2;0>t||(this._time.splice(0,t),this._components.splice(0,16*t))},m.lastT=function(){return this._time[this._time.length-1]},m.lookAt=function(e,t,a,o){this.recalcMatrix(e),t=t||this.computedEye,a=a||h,o=o||this.computedUp,this.setMatrix(e,c(this.computedMatrix,t,a,o));for(var r=0,n=0;3>n;++n)r+=_a(a[n]-t[n],2);r=P(re(r)),this.computedRadius[0]=r},m.rotate=function(e,t,a,o){this.recalcMatrix(e);var r=this.computedInverse;t&&s(r,r,t),a&&l(r,r,a),o&&d(r,r,o),this.setMatrix(e,n(this.computedMatrix,r))};var y=[0,0,0];m.pan=function(e,t,a,o){y[0]=-(t||0),y[1]=-(a||0),y[2]=-(o||0),this.recalcMatrix(e);var r=this.computedInverse;p(r,r,y),this.setMatrix(e,n(r,r))},m.translate=function(e,t,a,o){y[0]=t||0,y[1]=a||0,y[2]=o||0,this.recalcMatrix(e);var r=this.computedMatrix;p(r,r,y),this.setMatrix(e,r)},m.setMatrix=function(e,t){if(!(e<this.lastT())){this._time.push(e);for(var a=0;16>a;++a)this._components.push(t[a])}},m.setDistance=function(e,t){this.computedRadius[0]=t},m.setDistanceLimits=function(e,t){var a=this._limits;a[0]=e,a[1]=t},m.getDistanceLimits=function(e){var t=this._limits;return e?(e[0]=t[0],e[1]=t[1],e):t}},{"binary-search-bounds":79,"gl-mat4/invert":254,"gl-mat4/lookAt":255,"gl-mat4/rotateX":259,"gl-mat4/rotateY":260,"gl-mat4/rotateZ":261,"gl-mat4/scale":262,"gl-mat4/translate":263,"gl-vec3/normalize":339,"mat4-interpolate":413}],417:[function(e,t){"use strict";t.exports=function(e){var t=e.length;if(3>t){for(var o=Array(t),r=0;r<t;++r)o[r]=r;return 2===t&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]?[0]:o}for(var n=Array(t),r=0;r<t;++r)n[r]=r;n.sort(function(t,a){var o=e[t][0]-e[a][0];return o?o:e[t][1]-e[a][1]});for(var l=[n[0],n[1]],s=[n[0],n[1]],r=2;r<t;++r){for(var d=n[r],c=e[d],p=l.length;1<p&&0>=a(e[l[p-2]],e[l[p-1]],c);)p-=1,l.pop();for(l.push(d),p=s.length;1<p&&0<=a(e[s[p-2]],e[s[p-1]],c);)p-=1,s.pop();s.push(d)}for(var o=Array(s.length+l.length-2),u=0,r=0,g=l.length;r<g;++r)o[u++]=l[r];for(var h=s.length-2;0<h;--h)o[u++]=s[h];return o};var a=e("robust-orientation")[3]},{"robust-orientation":486}],418:[function(e,t){"use strict";t.exports=function(e,t){function o(e){var t=!1;return"altKey"in e&&(t=t||e.altKey!==f.alt,f.alt=!!e.altKey),"shiftKey"in e&&(t=t||e.shiftKey!==f.shift,f.shift=!!e.shiftKey),"ctrlKey"in e&&(t=t||e.ctrlKey!==f.control,f.control=!!e.ctrlKey),"metaKey"in e&&(t=t||e.metaKey!==f.meta,f.meta=!!e.metaKey),t}function r(e,r){var i=a.x(r),n=a.y(r);"buttons"in r&&(e=0|r.buttons),(e!==g||i!==h||n!==m||o(r))&&(g=0|e,h=i||0,m=n||0,t&&t(g,h,m,f))}function i(e){r(0,e)}function n(){(g||h||m||f.shift||f.alt||f.meta||f.control)&&(h=m=0,g=0,f.shift=f.alt=f.control=f.meta=!1,t&&t(0,0,0,f))}function l(e){o(e)&&t&&t(g,h,m,f)}function s(e){0===a.buttons(e)?r(0,e):r(g,e)}function d(e){r(g|a.buttons(e),e)}function c(e){r(g&~a.buttons(e),e)}function p(){b||(b=!0,e.addEventListener("mousemove",s),e.addEventListener("mousedown",d),e.addEventListener("mouseup",c),e.addEventListener("mouseleave",i),e.addEventListener("mouseenter",i),e.addEventListener("mouseout",i),e.addEventListener("mouseover",i),e.addEventListener("blur",n),e.addEventListener("keyup",l),e.addEventListener("keydown",l),e.addEventListener("keypress",l),e!==window&&(window.addEventListener("blur",n),window.addEventListener("keyup",l),window.addEventListener("keydown",l),window.addEventListener("keypress",l)))}function u(){b&&(b=!1,e.removeEventListener("mousemove",s),e.removeEventListener("mousedown",d),e.removeEventListener("mouseup",c),e.removeEventListener("mouseleave",i),e.removeEventListener("mouseenter",i),e.removeEventListener("mouseout",i),e.removeEventListener("mouseover",i),e.removeEventListener("blur",n),e.removeEventListener("keyup",l),e.removeEventListener("keydown",l),e.removeEventListener("keypress",l),e!==window&&(window.removeEventListener("blur",n),window.removeEventListener("keyup",l),window.removeEventListener("keydown",l),window.removeEventListener("keypress",l)))}t||(t=e,e=window);var g=0,h=0,m=0,f={shift:!1,alt:!1,control:!1,meta:!1},b=!1;p();var _={element:e};return Object.defineProperties(_,{enabled:{get:function(){return b},set:function(e){e?p():u()},enumerable:!0},buttons:{get:function(){return g},enumerable:!0},x:{get:function(){return h},enumerable:!0},y:{get:function(){return m},enumerable:!0},mods:{get:function(){return f},enumerable:!0}}),_};var a=e("mouse-event")},{"mouse-event":420}],419:[function(e,t){function a(e){return e===window||e===document||e===document.body?o:e.getBoundingClientRect()}var o={left:0,top:0};t.exports=function(e,t,o){t=t||e.currentTarget||e.srcElement,Array.isArray(o)||(o=[0,0]);var r=e.clientX||0,i=e.clientY||0,n=a(t);return o[0]=r-n.left,o[1]=i-n.top,o}},{}],420:[function(e,t,a){"use strict";function o(e){if("object"==typeof e){if("buttons"in e)return e.buttons;if("which"in e){var t=e.which;if(2===t)return 4;if(3===t)return 2;if(0<t)return 1<<t-1}else if("button"in e){var t=e.button;if(1===t)return 4;if(2===t)return 2;if(0<=t)return 1<<t}}return 0}function r(e){return e.target||e.srcElement||window}function i(e){if("object"==typeof e){if("offsetX"in e)return e.offsetX;var t=r(e),a=t.getBoundingClientRect();return e.clientX-a.left}return 0}function n(e){if("object"==typeof e){if("offsetY"in e)return e.offsetY;var t=r(e),a=t.getBoundingClientRect();return e.clientY-a.top}return 0}a.buttons=o,a.element=r,a.x=i,a.y=n},{}],421:[function(e,t){"use strict";var a=e("to-px");t.exports=function(e,t,o){"function"==typeof e&&(o=!!t,t=e,e=window);var r=a("ex",e),i=function(e){o&&e.preventDefault();var a=e.deltaX||0,i=e.deltaY||0,n=e.deltaZ||0,l=e.deltaMode,s=1;if(1===l?s=r:2===l?s=window.innerHeight:void 0,a*=s,i*=s,n*=s,a||i||n)return t(a,i,n,e)};return e.addEventListener("wheel",i),i}},{"to-px":515}],422:[function(e,t){"use strict";function a(e){return"a"+e}function o(e){return"d"+e}function r(e,t){return"c"+e+"_"+t}function n(e){return"s"+e}function l(e,t){return"t"+e+"_"+t}function s(e){return"o"+e}function d(e){return"x"+e}function c(e){return"p"+e}function p(e,t){return"d"+e+"_"+t}function u(e){return"i"+e}function g(e,t){return"u"+e+"_"+t}function h(e){return"b"+e}function m(e){return"y"+e}function y(e){return"e"+e}function f(e){return"v"+e}function x(e,t,a){for(var o=0,n=0;n<e;++n)t&1<<n&&(o|=1<<a[n]);return o}function b(e,t,b,v,w,T){function A(e,t){O.push("for(",u(w[e]),"=",t,";",u(w[e]),"<",n(w[e]),";","++",u(w[e]),"){")}function S(e){for(var t=0;t<I;++t)O.push(c(t),"+=",g(t,w[e]),";");O.push("}")}function C(e){for(var t=e-1;0<=t;--t)A(t,0);for(var a=[],t=0;t<I;++t)T[t]?a.push(o(t)+".get("+c(t)+")"):a.push(o(t)+"["+c(t)+"]");for(var t=0;t<v;++t)a.push(d(t));O.push("P","[","X","++]=phase(",a.join(),");");for(var t=0;t<e;++t)S(t);for(var r=0;r<I;++r)O.push(c(r),"+=",g(r,w[e]),";")}function L(e){for(var t=0;t<I;++t)T[t]?O.push(r(t,0),"=",o(t),".get(",c(t),");"):O.push(r(t,0),"=",o(t),"[",c(t),"];");for(var a=[],t=0;t<I;++t)a.push(r(t,0));for(var t=0;t<v;++t)a.push(d(t));O.push(h(0),"=","P","[","X","]=phase(",a.join(),");");for(var n=1;n<1<<D;++n)O.push(h(n),"=","P","[","X","+",y(n),"];");for(var l=[],n=1;n<1<<D;++n)l.push("("+h(0)+"!=="+h(n)+")");O.push("if(",l.join("||"),"){");for(var s=[],t=0;t<D;++t)s.push(u(t));for(var t=0;t<I;++t){s.push(r(t,0));for(var n=1;n<1<<D;++n)T[t]?O.push(r(t,n),"=",o(t),".get(",c(t),"+",p(t,n),");"):O.push(r(t,n),"=",o(t),"[",c(t),"+",p(t,n),"];"),s.push(r(t,n))}for(var t=0;t<1<<D;++t)s.push(h(t));for(var t=0;t<v;++t)s.push(d(t));O.push("vertex(",s.join(),");",f(0),"=","V","[","X","]=","N","++;");for(var g=(1<<D)-1,m=h(g),n=0;n<D;++n)if(0==(e&~(1<<n))){for(var x=g^1<<n,b=h(x),_=[],w=x;0<w;w=w-1&x)_.push("V[X+"+y(w)+"]");_.push(f(0));for(var w=0;w<I;++w)1&n?_.push(r(w,g),r(w,x)):_.push(r(w,x),r(w,g));1&n?_.push(m,b):_.push(b,m);for(var w=0;w<v;++w)_.push(d(w));O.push("if(",m,"!==",b,"){","face(",_.join(),")}")}O.push("}","X","+=1;")}function E(){for(var e=1;e<1<<D;++e)O.push("T","=",y(e),";",y(e),"=",m(e),";",m(e),"=","T",";")}function z(e,t){if(0>e)return void L(t);C(e),O.push("if(",n(w[e]),">0){",u(w[e]),"=1;"),z(e-1,t|1<<w[e]);for(var a=0;a<I;++a)O.push(c(a),"+=",g(a,w[e]),";");e===D-1&&(O.push("X","=0;"),E()),A(e,2),z(e-1,t),e===D-1&&(O.push("if(",u(w[D-1]),"&1){","X","=0;}"),E()),S(e),O.push("}")}var I=T.length,D=w.length;if(2>D)throw new Error("ndarray-extract-contour: Dimension must be at least 2");for(var P="extractContour"+w.join("_"),O=[],R=[],M=[],B=0;B<I;++B)M.push(a(B));for(var B=0;B<v;++B)M.push(d(B));for(var B=0;B<D;++B)R.push(n(B)+"="+a(0)+".shape["+B+"]|0");for(var B=0;B<I;++B){R.push(o(B)+"="+a(B)+".data",s(B)+"="+a(B)+".offset|0");for(var F=0;F<D;++F)R.push(l(B,F)+"="+a(B)+".stride["+F+"]|0")}for(var B=0;B<I;++B){R.push(c(B)+"="+s(B)),R.push(r(B,0));for(var F=1,N;F<1<<D;++F){N=[];for(var V=0;V<D;++V)F&1<<V&&N.push("-"+l(B,V));R.push(p(B,F)+"=("+N.join("")+")|0"),R.push(r(B,F)+"=0")}}for(var B=0;B<I;++B)for(var F=0,U;F<D;++F)U=[l(B,w[F])],0<F&&U.push(l(B,w[F-1])+"*"+n(w[F-1])),R.push(g(B,w[F])+"=("+U.join("-")+")|0");for(var B=0;B<D;++B)R.push(u(B)+"=0");R.push("N=0");for(var H=["2"],B=D-2;0<=B;--B)H.push(n(w[B]));R.push("Q=("+H.join("*")+")|0","P=mallocUint32(Q)","V=mallocUint32(Q)","X=0"),R.push(h(0)+"=0");for(var F=1;F<1<<D;++F){for(var G=[],Y=[],V=0;V<D;++V)F&1<<V&&(0===Y.length?G.push("1"):G.unshift(Y.join("*"))),Y.push(n(w[V]));var q="";0>G[0].indexOf(n(w[D-2]))&&(q="-");var W=x(D,F,w);R.push(y(W)+"=(-"+G.join("-")+")|0",m(W)+"=("+q+G.join("-")+")|0",h(W)+"=0")}R.push(f(0)+"=0","T=0"),z(D-1,0),O.push("freeUint32(","V",");freeUint32(","P",");");var X=["'use strict';","function ",P,"(",M.join(),"){","var ",R.join(),";",O.join(""),"}","return ",P].join(""),Z=new Function("vertex","face","phase","mallocUint32","freeUint32",X);return Z(e,t,b,_.mallocUint32,_.freeUint32)}var _=e("typedarray-pool");t.exports=function(e){function t(e){throw new Error("ndarray-extract-contour: "+e)}"object"!=typeof e&&t("Must specify arguments");var a=e.order;Array.isArray(a)||t("Must specify order");var o=e.arrayArguments||1;1>o&&t("Must have at least one array argument");var r=e.scalarArguments||0;0>r&&t("Scalar arg count must be > 0"),"function"!=typeof e.vertex&&t("Must specify vertex creation function"),"function"!=typeof e.cell&&t("Must specify cell creation function"),"function"!=typeof e.phase&&t("Must specify phase function");for(var n=e.getters||[],l=Array(o),s=0;s<o;++s)l[s]=!!(0<=n.indexOf(s));return b(e.vertex,e.cell,e.phase,r,a,l)}},{"typedarray-pool":521}],423:[function(e,t){"use strict";var a=e("cwise/lib/wrapper")({args:["index","array","scalar"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{_inline_1_arg1_=_inline_1_arg2_.apply(void 0,_inline_1_arg0_)}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"cwise",blockSize:64});t.exports=function(e,t){return a(e,t),e}},{"cwise/lib/wrapper":137}],424:[function(e,t){"use strict";function a(e){if(e in l)return l[e];for(var t=[],a=0;a<e;++a)t.push("out",a,"s=0.5*(inp",a,"l-inp",a,"r);");for(var s=["array"],d=["junk"],a=0;a<e;++a){s.push("array"),d.push("out"+a+"s");var p=r(e);p[a]=-1,s.push({array:0,offset:p.slice()}),p[a]=1,s.push({array:0,offset:p.slice()}),d.push("inp"+a+"l","inp"+a+"r")}return l[e]=n({args:s,pre:c,post:c,body:{body:t.join(""),args:d.map(function(e){return{name:e,lvalue:0===e.indexOf("out"),rvalue:0===e.indexOf("inp"),count:0|"junk"!==e}}),thisVars:[],localVars:[]},funcName:"fdTemplate"+e})}function o(e){function t(t){for(var a=n-t.length,o=[],r=[],l=[],s=0;s<n;++s)0<=t.indexOf(s+1)?l.push("0"):0<=t.indexOf(-(s+1))?l.push("s["+s+"]-1"):(l.push("-1"),o.push("1"),r.push("s["+s+"]-2"));var c=".lo("+o.join()+").hi("+r.join()+")";if(0===o.length&&(c=""),0<a){d.push("if(1");for(var s=0;s<n;++s)0<=t.indexOf(s+1)||0<=t.indexOf(-(s+1))||d.push("&&s[",s,"]>2");d.push("){grad",a,"(src.pick(",l.join(),")",c);for(var s=0;s<n;++s)0<=t.indexOf(s+1)||0<=t.indexOf(-(s+1))||d.push(",dst.pick(",l.join(),",",s,")",c);d.push(");")}for(var s=0;s<t.length;++s){var p=wa(t[s])-1,u="dst.pick("+l.join()+","+p+")"+c;switch(e[p]){case"clamp":var g=l.slice(),h=l.slice();0>t[s]?g[p]="s["+p+"]-2":h[p]="1",0===a?d.push("if(s[",p,"]>1){dst.set(",l.join(),",",p,",0.5*(src.get(",g.join(),")-src.get(",h.join(),")))}else{dst.set(",l.join(),",",p,",0)};"):d.push("if(s[",p,"]>1){diff(",u,",src.pick(",g.join(),")",c,",src.pick(",h.join(),")",c,");}else{zero(",u,");};");break;case"mirror":0===a?d.push("dst.set(",l.join(),",",p,",0);"):d.push("zero(",u,");");break;case"wrap":var m=l.slice(),y=l.slice();0>t[s]?(m[p]="s["+p+"]-2",y[p]="0"):(m[p]="s["+p+"]-1",y[p]="1"),0===a?d.push("if(s[",p,"]>2){dst.set(",l.join(),",",p,",0.5*(src.get(",m.join(),")-src.get(",y.join(),")))}else{dst.set(",l.join(),",",p,",0)};"):d.push("if(s[",p,"]>2){diff(",u,",src.pick(",m.join(),")",c,",src.pick(",y.join(),")",c,");}else{zero(",u,");};");break;default:throw new Error("ndarray-gradient: Invalid boundary condition");}}0<a&&d.push("};")}var o=e.join(),r=s[o];if(r)return r;for(var n=e.length,d=["function gradient(dst,src){var s=src.shape.slice();"],c=0,g;c<1<<n;++c){g=[];for(var h=0;h<n;++h)c&1<<h&&g.push(h+1);for(var m=0,y;m<1<<g.length;++m){y=g.slice();for(var h=0;h<g.length;++h)m&1<<h&&(y[h]=-y[h]);t(y)}}d.push("return dst;};return gradient");for(var f=["diff","zero"],x=[p,u],c=1;c<=n;++c)f.push("grad"+c),x.push(a(c));f.push(d.join(""));var b=Function.apply(void 0,f),r=b.apply(void 0,x);return l[o]=r,r}t.exports=function(e,t,a){if(!Array.isArray(a))a="string"==typeof a?r(t.dimension,a):r(t.dimension,"clamp");else if(a.length!==t.dimension)throw new Error("ndarray-gradient: invalid boundary conditions");if(e.dimension!==t.dimension+1)throw new Error("ndarray-gradient: output dimension must be +1 input dimension");if(e.shape[t.dimension]!==t.dimension)throw new Error("ndarray-gradient: output shape must match input shape");for(var n=0;n<t.dimension;++n)if(e.shape[n]!==t.shape[n])throw new Error("ndarray-gradient: shape mismatch");if(0===t.size)return e;if(0>=t.dimension)return e.set(0),e;var l=o(a);return l(e,t)};var r=e("dup"),n=e("cwise-compiler"),l={},s={},c={body:"",args:[],thisVars:[],localVars:[]},p=n({args:["array","array","array"],pre:c,post:c,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1},{name:"left",lvalue:!1,rvalue:!0,count:1},{name:"right",lvalue:!1,rvalue:!0,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"}),u=n({args:["array"],pre:c,post:c,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"})},{"cwise-compiler":134,dup:155}],425:[function(e,t){"use strict";var a=e("ndarray-warp"),o=e("gl-matrix-invert");t.exports=function(e,t,r){var l=t.dimension,n=o([],r);return a(e,t,function(e,t){for(var a=0;a<l;++a){e[a]=n[(l+1)*l+a];for(var o=0;o<l;++o)e[a]+=n[(l+1)*o+a]*t[o]}for(var r=n[(l+1)*(l+1)-1],o=0;o<l;++o)r+=n[(l+1)*o+l]*t[o];for(var s=1/r,a=0;a<l;++a)e[a]*=s;return e}),e}},{"gl-matrix-invert":265,"ndarray-warp":432}],426:[function(e,t){"use strict";function a(e,t){var a=ea(t),o=t-a,r=0<=a&&a<e.shape[0],i=0<=a+1&&a+1<e.shape[0],n=r?+e.get(a):0,l=i?+e.get(a+1):0;return(1-o)*n+o*l}function o(e,t,a){var o=ea(t),r=t-o,i=0<=o&&o<e.shape[0],n=0<=o+1&&o+1<e.shape[0],l=ea(a),s=a-l,d=0<=l&&l<e.shape[1],c=0<=l+1&&l+1<e.shape[1],p=i&&d?e.get(o,l):0,u=i&&c?e.get(o,l+1):0,g=n&&d?e.get(o+1,l):0,h=n&&c?e.get(o+1,l+1):0;return(1-s)*((1-r)*p+r*g)+s*((1-r)*u+r*h)}function r(e,t,a,o){var r=ea(t),i=t-r,n=0<=r&&r<e.shape[0],l=0<=r+1&&r+1<e.shape[0],s=ea(a),d=a-s,c=0<=s&&s<e.shape[1],p=0<=s+1&&s+1<e.shape[1],u=ea(o),g=o-u,h=0<=u&&u<e.shape[2],m=0<=u+1&&u+1<e.shape[2],y=n&&c&&h?e.get(r,s,u):0,f=n&&p&&h?e.get(r,s+1,u):0,x=l&&c&&h?e.get(r+1,s,u):0,b=l&&p&&h?e.get(r+1,s+1,u):0,_=n&&c&&m?e.get(r,s,u+1):0,v=n&&p&&m?e.get(r,s+1,u+1):0,w=l&&c&&m?e.get(r+1,s,u+1):0,k=l&&p&&m?e.get(r+1,s+1,u+1):0;return(1-g)*((1-d)*((1-i)*y+i*x)+d*((1-i)*f+i*b))+g*((1-d)*((1-i)*_+i*w)+d*((1-i)*v+i*k))}function i(e){var a=0|e.shape.length,o=Array(a),n=Array(a),l=Array(a),s=Array(a),d,c;for(d=0;d<a;++d)c=+arguments[d+1],o[d]=ea(c),n[d]=c-o[d],l[d]=0<=o[d]&&o[d]<e.shape[d],s[d]=0<=o[d]+1&&o[d]+1<e.shape[d];var p=0,u,g,h;i_loop:for(d=0;d<1<<a;++d){for(g=1,h=e.offset,u=0;u<a;++u)if(d&1<<u){if(!s[u])continue i_loop;g*=n[u],h+=e.stride[u]*(o[u]+1)}else{if(!l[u])continue i_loop;g*=1-n[u],h+=e.stride[u]*o[u]}p+=g*e.data[h]}return p}t.exports=function(e,t,n,l){switch(e.shape.length){case 0:return 0;case 1:return a(e,t);case 2:return o(e,t,n);case 3:return r(e,t,n,l);default:return i.apply(void 0,arguments);}},t.exports.d1=a,t.exports.d2=o,t.exports.d3=r},{}],427:[function(e,t,a){"use strict";function o(e){if(!e)return s;for(var t=0,o;t<e.args.length;++t)o=e.args[t],e.args[t]=0==t?{name:o,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:{name:o,lvalue:!1,rvalue:!0,count:1};return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function r(e){return l({args:e.args,pre:o(e.pre),body:o(e.body),post:o(e.proc),funcName:e.funcName})}function n(e){for(var t=[],a=0;a<e.args.length;++a)t.push("a"+a);var o=new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""));return o(r(e))}var l=e("cwise-compiler"),s={body:"",args:[],thisVars:[],localVars:[]},d={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var e in d){var t=d[e];a[e]=n({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),a[e+"eq"]=n({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:!0,funcName:e+"eq"}),a[e+"s"]=n({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),a[e+"seq"]=n({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:!0,funcName:e+"seq"})}})();var c={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var e in c){var t=c[e];a[e]=n({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:e}),a[e+"eq"]=n({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:!0,count:2,funcName:e+"eq"})}})();var p={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var e in p){var t=p[e];a[e]=n({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),a[e+"s"]=n({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),a[e+"eq"]=n({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:!0,count:2,funcName:e+"eq"}),a[e+"seq"]=n({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:!0,count:2,funcName:e+"seq"})}})();var u=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var e=0,t;e<u.length;++e)t=u[e],a[t]=n({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:t}),a[t+"eq"]=n({args:["array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"})})();var g=["max","min","atan2","pow"];(function(){for(var e=0,t;e<g.length;++e)t=g[e],a[t]=n({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t}),a[t+"s"]=n({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t+"s"}),a[t+"eq"]=n({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"}),a[t+"seq"]=n({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"seq"})})();var h=["atan2","pow"];(function(){for(var e=0,t;e<h.length;++e)t=h[e],a[t+"op"]=n({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"op"}),a[t+"ops"]=n({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"ops"}),a[t+"opeq"]=n({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opeq"}),a[t+"opseq"]=n({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opseq"})})(),a.any=l({args:["array"],pre:s,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),a.all=l({args:["array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),a.sum=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),a.prod=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),a.norm2squared=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),a.norm2=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),a.norminf=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),a.norm1=l({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),a.sup=l({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),a.inf=l({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),a.argmin=l({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),a.argmax=l({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),a.random=n({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),a.assign=n({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),a.assigns=n({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),a.equals=l({args:["array","array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":134}],428:[function(e,t){"use strict";var a=e("ndarray"),o=e("./doConvert.js");t.exports=function(e,t){for(var r=[],i=e,n=1;Array.isArray(i);)r.push(i.length),n*=i.length,i=i[0];return 0===r.length?a():(t||(t=a(new Float64Array(n),r)),o(t,e),t)}},{"./doConvert.js":429,ndarray:433}],429:[function(e,t){t.exports=e("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":134}],430:[function(e,t){"use strict";function a(e){return"uint8"===e?[l.mallocUint8,l.freeUint8]:"uint16"===e?[l.mallocUint16,l.freeUint16]:"uint32"===e?[l.mallocUint32,l.freeUint32]:"int8"===e?[l.mallocInt8,l.freeInt8]:"int16"===e?[l.mallocInt16,l.freeInt16]:"int32"===e?[l.mallocInt32,l.freeInt32]:"float32"===e?[l.mallocFloat,l.freeFloat]:"float64"===e?[l.mallocDouble,l.freeDouble]:null}function o(e){for(var t=[],a=0;a<e;++a)t.push("s"+a);for(var a=0;a<e;++a)t.push("n"+a);for(var a=1;a<e;++a)t.push("d"+a);for(var a=1;a<e;++a)t.push("e"+a);for(var a=1;a<e;++a)t.push("f"+a);return t}function r(e,t){function r(e){return"generic"===t?["data.get(",e,")"].join(""):["data[",e,"]"].join("")}function n(e,a){return"generic"===t?["data.set(",e,",",a,")"].join(""):["data[",e,"]=",a].join("")}var l=["'use strict'"],s=["ndarrayInsertionSort",e.join("d"),t].join(""),d=["left","right","data","offset"].concat(o(e.length)),c=a(t),p=["i,j,cptr,ptr=left*s0+offset"];if(1<e.length){for(var u=[],g=1;g<e.length;++g)p.push("i"+g),u.push("n"+g);c?p.push("scratch=malloc("+u.join("*")+")"):p.push("scratch=new Array("+u.join("*")+")"),p.push("dptr","sptr","a","b")}else p.push("scratch");if(l.push(["function ",s,"(",d.join(","),"){var ",p.join(",")].join(""),"for(i=left+1;i<=right;++i){","j=i;ptr+=s0","cptr=ptr"),1<e.length){l.push("dptr=0;sptr=ptr");for(var g=e.length-1,h;0<=g;--g)(h=e[g],0!==h)&&l.push(["for(i",h,"=0;i",h,"<n",h,";++i",h,"){"].join(""));l.push("scratch[dptr++]=",r("sptr"));for(var g=0,h;g<e.length;++g)(h=e[g],0!==h)&&l.push("sptr+=d"+h,"}");l.push("__g:while(j-->left){","dptr=0","sptr=cptr-s0");for(var g=1;g<e.length;++g)1==g&&l.push("__l:"),l.push(["for(i",g,"=0;i",g,"<n",g,";++i",g,"){"].join(""));l.push(["a=",r("sptr"),"\nb=scratch[dptr]\nif(a<b){break __g}\nif(a>b){break __l}"].join(""));for(var g=e.length-1;1<=g;--g)l.push("sptr+=e"+g,"dptr+=f"+g,"}");l.push("dptr=cptr;sptr=cptr-s0");for(var g=e.length-1,h;0<=g;--g)(h=e[g],0!==h)&&l.push(["for(i",h,"=0;i",h,"<n",h,";++i",h,"){"].join(""));l.push(n("dptr",r("sptr")));for(var g=0,h;g<e.length;++g)(h=e[g],0!==h)&&l.push(["dptr+=d",h,";sptr+=d",h].join(""),"}");l.push("cptr-=s0\n}"),l.push("dptr=cptr;sptr=0");for(var g=e.length-1,h;0<=g;--g)(h=e[g],0!==h)&&l.push(["for(i",h,"=0;i",h,"<n",h,";++i",h,"){"].join(""));l.push(n("dptr","scratch[sptr++]"));for(var g=0,h;g<e.length;++g)(h=e[g],0!==h)&&l.push("dptr+=d"+h,"}")}else l.push("scratch="+r("ptr"),"while((j-->left)&&("+r("cptr-s0")+">scratch)){",n("cptr",r("cptr-s0")),"cptr-=s0","}",n("cptr","scratch"));if(l.push("}"),1<e.length&&c&&l.push("free(scratch)"),l.push("} return "+s),c){var m=new Function("malloc","free",l.join("\n"));return m(c[0],c[1])}var m=new Function(l.join("\n"));return m()}function n(e,t,r){function l(e){return["(offset+",e,"*s0)"].join("")}function s(e){return"generic"===t?["data.get(",e,")"].join(""):["data[",e,"]"].join("")}function d(e,a){return"generic"===t?["data.set(",e,",",a,")"].join(""):["data[",e,"]=",a].join("")}function c(t,a,o){if(1===t.length)w.push("ptr0="+l(t[0]));else for(var r=0;r<t.length;++r)w.push(["b_ptr",r,"=s0*",t[r]].join(""));a&&w.push("pivot_ptr=0"),w.push("ptr_shift=offset");for(var r=e.length-1,n;0<=r;--r)(n=e[r],0!==n)&&w.push(["for(i",n,"=0;i",n,"<n",n,";++i",n,"){"].join(""));if(1<t.length)for(var r=0;r<t.length;++r)w.push(["ptr",r,"=b_ptr",r,"+ptr_shift"].join(""));w.push(o),a&&w.push("++pivot_ptr");for(var r=0,n;r<e.length;++r)(n=e[r],0!==n)&&(1<t.length?w.push("ptr_shift+=d"+n):w.push("ptr0+=d"+n),w.push("}"))}function p(t,a,o,r){if(1===a.length)w.push("ptr0="+l(a[0]));else{for(var n=0;n<a.length;++n)w.push(["b_ptr",n,"=s0*",a[n]].join(""));w.push("ptr_shift=offset")}o&&w.push("pivot_ptr=0"),t&&w.push(t+":");for(var n=1;n<e.length;++n)w.push(["for(i",n,"=0;i",n,"<n",n,";++i",n,"){"].join(""));if(1<a.length)for(var n=0;n<a.length;++n)w.push(["ptr",n,"=b_ptr",n,"+ptr_shift"].join(""));w.push(r);for(var n=e.length-1;1<=n;--n)o&&w.push("pivot_ptr+=f"+n),1<a.length?w.push("ptr_shift+=e"+n):w.push("ptr0+=e"+n),w.push("}")}function u(){1<e.length&&A&&w.push("free(pivot1)","free(pivot2)")}function g(t,o){var r="el"+t,a="el"+o;if(1<e.length){var i="__l"+ ++S;p(i,[r,a],!1,["comp=",s("ptr0"),"-",s("ptr1"),"\n","if(comp>0){tmp0=",r,";",r,"=",a,";",a,"=tmp0;break ",i,"}\n","if(comp<0){break ",i,"}"].join(""))}else w.push(["if(",s(l(r)),">",s(l(a)),"){tmp0=",r,";",r,"=",a,";",a,"=tmp0}"].join(""))}function h(t,a){1<e.length?c([t,a],!1,d("ptr0",s("ptr1"))):w.push(d(l(t),s(l(a))))}function m(t,a,o){if(1<e.length){var r="__l"+ ++S;p(r,[a],!0,[t,"=",s("ptr0"),"-pivot",o,"[pivot_ptr]\n","if(",t,"!==0){break ",r,"}"].join(""))}else w.push([t,"=",s(l(a)),"-pivot",o].join(""))}function y(t,a){1<e.length?c([t,a],!1,["tmp=",s("ptr0"),"\n",d("ptr0",s("ptr1")),"\n",d("ptr1","tmp")].join("")):w.push(["ptr0=",l(t),"\n","ptr1=",l(a),"\n","tmp=",s("ptr0"),"\n",d("ptr0",s("ptr1")),"\n",d("ptr1","tmp")].join(""))}function f(t,a,o){1<e.length?(c([t,a,o],!1,["tmp=",s("ptr0"),"\n",d("ptr0",s("ptr1")),"\n",d("ptr1",s("ptr2")),"\n",d("ptr2","tmp")].join("")),w.push("++"+a,"--"+o)):w.push(["ptr0=",l(t),"\n","ptr1=",l(a),"\n","ptr2=",l(o),"\n","++",a,"\n","--",o,"\n","tmp=",s("ptr0"),"\n",d("ptr0",s("ptr1")),"\n",d("ptr1",s("ptr2")),"\n",d("ptr2","tmp")].join(""))}function x(e,t){y(e,t),w.push("--"+t)}function b(t,a,o){1<e.length?c([t,a],!0,[d("ptr0",s("ptr1")),"\n",d("ptr1",["pivot",o,"[pivot_ptr]"].join(""))].join("")):w.push(d(l(t),s(l(a))),d(l(a),"pivot"+o))}function _(t,a){w.push(["if((",a,"-",t,")<=",32,"){\n","insertionSort(",t,",",a,",data,offset,",o(e.length).join(","),")\n","}else{\n",k,"(",t,",",a,",data,offset,",o(e.length).join(","),")\n","}"].join(""))}function v(t,a,o){1<e.length?(w.push(["__l",++S,":while(true){"].join("")),c([t],!0,["if(",s("ptr0"),"!==pivot",a,"[pivot_ptr]){break __l",S,"}"].join("")),w.push(o,"}")):w.push(["while(",s(l(t)),"===pivot",a,"){",o,"}"].join(""))}var w=["'use strict'"],k=["ndarrayQuickSort",e.join("d"),t].join(""),T=["left","right","data","offset"].concat(o(e.length)),A=a(t),S=0;w.push(["function ",k,"(",T.join(","),"){"].join(""));var C=["sixth=((right-left+1)/6)|0","index1=left+sixth","index5=right-sixth","index3=(left+right)>>1","index2=index3-sixth","index4=index3+sixth","el1=index1","el2=index2","el3=index3","el4=index4","el5=index5","less=left+1","great=right-1","pivots_are_equal=true","tmp","tmp0","x","y","z","k","ptr0","ptr1","ptr2","comp_pivot1=0","comp_pivot2=0","comp=0"];if(1<e.length){for(var L=[],E=1;E<e.length;++E)L.push("n"+E),C.push("i"+E);for(var E=0;8>E;++E)C.push("b_ptr"+E);C.push("ptr3","ptr4","ptr5","ptr6","ptr7","pivot_ptr","ptr_shift","elementSize="+L.join("*")),A?C.push("pivot1=malloc(elementSize)","pivot2=malloc(elementSize)"):C.push("pivot1=new Array(elementSize),pivot2=new Array(elementSize)")}else C.push("pivot1","pivot2");if(w.push("var "+C.join(",")),g(1,2),g(4,5),g(1,3),g(2,3),g(1,4),g(3,4),g(2,5),g(2,3),g(4,5),1<e.length?c(["el1","el2","el3","el4","el5","index1","index3","index5"],!0,["pivot1[pivot_ptr]=",s("ptr1"),"\n","pivot2[pivot_ptr]=",s("ptr3"),"\n","pivots_are_equal=pivots_are_equal&&(pivot1[pivot_ptr]===pivot2[pivot_ptr])\n","x=",s("ptr0"),"\n","y=",s("ptr2"),"\n","z=",s("ptr4"),"\n",d("ptr5","x"),"\n",d("ptr6","y"),"\n",d("ptr7","z")].join("")):w.push(["pivot1=",s(l("el2")),"\n","pivot2=",s(l("el4")),"\n","pivots_are_equal=pivot1===pivot2\n","x=",s(l("el1")),"\n","y=",s(l("el3")),"\n","z=",s(l("el5")),"\n",d(l("index1"),"x"),"\n",d(l("index3"),"y"),"\n",d(l("index5"),"z")].join("")),h("index2","left"),h("index4","right"),w.push("if(pivots_are_equal){"),w.push("for(k=less;k<=great;++k){"),m("comp","k",1),w.push("if(comp===0){continue}"),w.push("if(comp<0){"),w.push("if(k!==less){"),y("k","less"),w.push("}"),w.push("++less"),w.push("}else{"),w.push("while(true){"),m("comp","great",1),w.push("if(comp>0){"),w.push("great--"),w.push("}else if(comp<0){"),f("k","less","great"),w.push("break"),w.push("}else{"),x("k","great"),w.push("break"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),w.push("}else{"),w.push("for(k=less;k<=great;++k){"),m("comp_pivot1","k",1),w.push("if(comp_pivot1<0){"),w.push("if(k!==less){"),y("k","less"),w.push("}"),w.push("++less"),w.push("}else{"),m("comp_pivot2","k",2),w.push("if(comp_pivot2>0){"),w.push("while(true){"),m("comp","great",2),w.push("if(comp>0){"),w.push("if(--great<k){break}"),w.push("continue"),w.push("}else{"),m("comp","great",1),w.push("if(comp<0){"),f("k","less","great"),w.push("}else{"),x("k","great"),w.push("}"),w.push("break"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),b("left","(less-1)",1),b("right","(great+1)",2),_("left","(less-2)"),_("(great+2)","right"),w.push("if(pivots_are_equal){"),u(),w.push("return"),w.push("}"),w.push("if(less<index1&&great>index5){"),v("less",1,"++less"),v("great",2,"--great"),w.push("for(k=less;k<=great;++k){"),m("comp_pivot1","k",1),w.push("if(comp_pivot1===0){"),w.push("if(k!==less){"),y("k","less"),w.push("}"),w.push("++less"),w.push("}else{"),m("comp_pivot2","k",2),w.push("if(comp_pivot2===0){"),w.push("while(true){"),m("comp","great",2),w.push("if(comp===0){"),w.push("if(--great<k){break}"),w.push("continue"),w.push("}else{"),m("comp","great",1),w.push("if(comp<0){"),f("k","less","great"),w.push("}else{"),x("k","great"),w.push("}"),w.push("break"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),w.push("}"),u(),_("less","great"),w.push("}return "+k),1<e.length&&A){var n=new Function("insertionSort","malloc","free",w.join("\n"));return n(r,A[0],A[1])}var n=new Function("insertionSort",w.join("\n"));return n(r)}var l=e("typedarray-pool");t.exports=function(e,t){var a=["'use strict'"],l=["ndarraySortWrapper",e.join("d"),t].join("");a.push(["function ",l,"(",["array"].join(","),"){"].join(""));for(var s=["data=array.data,offset=array.offset|0,shape=array.shape,stride=array.stride"],d=0;d<e.length;++d)s.push(["s",d,"=stride[",d,"]|0,n",d,"=shape[",d,"]|0"].join(""));for(var c=Array(e.length),u=[],d=0,g;d<e.length;++d)(g=e[d],0!==g)&&(c[g]=0===u.length?"1":u.join("*"),u.push("n"+g));for(var h=-1,m=-1,d=0,y;d<e.length;++d){y=e[d],0!==y&&(0<h?s.push(["d",y,"=s",y,"-d",h,"*n",h].join("")):s.push(["d",y,"=s",y].join("")),h=y);var g=e.length-1-d;0!==g&&(0<m?s.push(["e",g,"=s",g,"-e",m,"*n",m,",f",g,"=",c[g],"-f",m,"*n",m].join("")):s.push(["e",g,"=s",g,",f",g,"=",c[g]].join("")),m=g)}a.push("var "+s.join(","));var f=["0","n0-1","data","offset"].concat(o(e.length));a.push(["if(n0<=",32,"){","insertionSort(",f.join(","),")}else{","quickSort(",f.join(","),")}"].join("")),a.push("}return "+l);var x=new Function("insertionSort","quickSort",a.join("\n")),b=r(e,t),_=n(e,t,b);return x(b,_)}},{"typedarray-pool":521}],431:[function(e,t){"use strict";var a=e("./lib/compile_sort.js"),o={};t.exports=function(e){var t=e.order,r=e.dtype,i=[t,r].join(":"),n=o[i];return n||(o[i]=n=a(t,r)),n(e),e}},{"./lib/compile_sort.js":430}],432:[function(e,t){"use strict";var a=e("ndarray-linear-interpolate"),o=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=new Array(_inline_3_arg4_)}",args:[{name:"_inline_3_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg2_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg3_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_3_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_4_arg2_(this_warped,_inline_4_arg0_),_inline_4_arg1_=_inline_4_arg3_.apply(void 0,this_warped)}",args:[{name:"_inline_4_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_4_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_4_arg4_",lvalue:!1,rvalue:!1,count:0}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warpND",blockSize:64}),r=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_7_arg2_(this_warped,_inline_7_arg0_),_inline_7_arg1_=_inline_7_arg3_(_inline_7_arg4_,this_warped[0])}",args:[{name:"_inline_7_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_7_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_7_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_7_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_7_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp1D",blockSize:64}),i=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_10_arg2_(this_warped,_inline_10_arg0_),_inline_10_arg1_=_inline_10_arg3_(_inline_10_arg4_,this_warped[0],this_warped[1])}",args:[{name:"_inline_10_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_10_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_10_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp2D",blockSize:64}),n=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_13_arg2_(this_warped,_inline_13_arg0_),_inline_13_arg1_=_inline_13_arg3_(_inline_13_arg4_,this_warped[0],this_warped[1],this_warped[2])}",args:[{name:"_inline_13_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg1_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_13_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg3_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_13_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"warp3D",blockSize:64});t.exports=function(e,t,l){switch(t.shape.length){case 1:r(e,l,a.d1,t);break;case 2:i(e,l,a.d2,t);break;case 3:n(e,l,a.d3,t);break;default:o(e,l,a.bind(void 0,t),t.shape.length);}return e}},{"cwise/lib/wrapper":137,"ndarray-linear-interpolate":426}],433:[function(e,t){function a(e,t){return e[0]-t[0]}function o(){var e=this.stride,t=Array(e.length),o;for(o=0;o<t.length;++o)t[o]=[wa(e[o]),o];t.sort(a);var r=Array(t.length);for(o=0;o<r.length;++o)r[o]=t[o][1];return r}function r(e,t){var a=["View",t,"d",e].join("");0>t&&(a="View_Nil"+e);var r="generic"===e;if(-1===t){var l="function "+a+"(a){this.data=a;};var proto="+a+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+a+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+a+"(a){return new "+a+"(a);}",s=new Function(l);return s()}if(0===t){var l="function "+a+"(a,d) {this.data = a;this.offset = d};var proto="+a+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+a+"_copy() {return new "+a+"(this.data,this.offset)};proto.pick=function "+a+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+a+"_get(){return "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+a+"_set(v){return "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+a+"(a,b,c,d){return new "+a+"(a,d)}",s=new Function("TrivialArray",l);return s(c[e][0])}var l=["'use strict'"],d=n(t),p=d.map(function(e){return"i"+e}),u="this.offset+"+d.map(function(e){return"this.stride["+e+"]*i"+e}).join("+"),g=d.map(function(e){return"b"+e}).join(","),h=d.map(function(e){return"c"+e}).join(",");l.push("function "+a+"(a,"+g+","+h+",d){this.data=a","this.shape=["+g+"]","this.stride=["+h+"]","this.offset=d|0}","var proto="+a+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),l.push("Object.defineProperty(proto,'size',{get:function "+a+"_size(){return "+d.map(function(e){return"this.shape["+e+"]"}).join("*"),"}})"),1===t?l.push("proto.order=[0]"):(l.push("Object.defineProperty(proto,'order',{get:"),4>t?(l.push("function "+a+"_order(){"),2===t?l.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3==t&&l.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):l.push("ORDER})")),l.push("proto.set=function "+a+"_set("+p.join(",")+",v){"),r?l.push("return this.data.set("+u+",v)}"):l.push("return this.data["+u+"]=v}"),l.push("proto.get=function "+a+"_get("+p.join(",")+"){"),r?l.push("return this.data.get("+u+")}"):l.push("return this.data["+u+"]}"),l.push("proto.index=function "+a+"_index(",p.join(),"){return "+u+"}"),l.push("proto.hi=function "+a+"_hi("+p.join(",")+"){return new "+a+"(this.data,"+d.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")}).join(",")+","+d.map(function(e){return"this.stride["+e+"]"}).join(",")+",this.offset)}");var m=d.map(function(e){return"a"+e+"=this.shape["+e+"]"}),y=d.map(function(e){return"c"+e+"=this.stride["+e+"]"});l.push("proto.lo=function "+a+"_lo("+p.join(",")+"){var b=this.offset,d=0,"+m.join(",")+","+y.join(","));for(var f=0;f<t;++f)l.push("if(typeof i"+f+"==='number'&&i"+f+">=0){d=i"+f+"|0;b+=c"+f+"*d;a"+f+"-=d}");l.push("return new "+a+"(this.data,"+d.map(function(e){return"a"+e}).join(",")+","+d.map(function(e){return"c"+e}).join(",")+",b)}"),l.push("proto.step=function "+a+"_step("+p.join(",")+"){var "+d.map(function(e){return"a"+e+"=this.shape["+e+"]"}).join(",")+","+d.map(function(e){return"b"+e+"=this.stride["+e+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var f=0;f<t;++f)l.push("if(typeof i"+f+"==='number'){d=i"+f+"|0;if(d<0){c+=b"+f+"*(a"+f+"-1);a"+f+"=ceil(-a"+f+"/d)}else{a"+f+"=ceil(a"+f+"/d)}b"+f+"*=d}");l.push("return new "+a+"(this.data,"+d.map(function(e){return"a"+e}).join(",")+","+d.map(function(e){return"b"+e}).join(",")+",c)}");for(var x=Array(t),b=Array(t),f=0;f<t;++f)x[f]="a[i"+f+"]",b[f]="b[i"+f+"]";l.push("proto.transpose=function "+a+"_transpose("+p+"){"+p.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+a+"(this.data,"+x.join(",")+","+b.join(",")+",this.offset)}"),l.push("proto.pick=function "+a+"_pick("+p+"){var a=[],b=[],c=this.offset");for(var f=0;f<t;++f)l.push("if(typeof i"+f+"==='number'&&i"+f+">=0){c=(c+this.stride["+f+"]*i"+f+")|0}else{a.push(this.shape["+f+"]);b.push(this.stride["+f+"])}");l.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),l.push("return function construct_"+a+"(data,shape,stride,offset){return new "+a+"(data,"+d.map(function(e){return"shape["+e+"]"}).join(",")+","+d.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}");var s=new Function("CTOR_LIST","ORDER",l.join("\n"));return s(c[e],o)}function i(e){if(l(e))return"buffer";if(s)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";}return Array.isArray(e)?"array":"generic"}var n=e("iota-array"),l=e("is-buffer"),s="undefined"!=typeof Float64Array,c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};(function(){for(var e in c)c[e].push(r(e,-1))}),t.exports=function(e,t,a,o){if(e===void 0){var n=c.array[0];return n([])}"number"==typeof e&&(e=[e]);t===void 0&&(t=[e.length]);var l=t.length;if(a===void 0){a=Array(l);for(var s=l-1,d=1;0<=s;--s)a[s]=d,d*=t[s]}if(void 0===o){o=0;for(var s=0;s<l;++s)0>a[s]&&(o-=(t[s]-1)*a[s])}for(var p=i(e),u=c[p];u.length<=l+1;)u.push(r(p,u.length-1));var n=u[l+1];return n(e,t,a,o)}},{"iota-array":399,"is-buffer":401}],434:[function(e,t){"use strict";var a=e("double-bits"),o=_a(2,-1074);t.exports=function(e,t){if(isNaN(e)||isNaN(t))return NaN;if(e===t)return e;if(0===e)return 0>t?-o:o;var r=a.hi(e),i=a.lo(e);return t>e==0<e?4294967295===i?(r+=1,i=0):i+=1:0===i?(i=4294967295,r-=1):i-=1,a.pack(i,r)}},{"double-bits":152}],435:[function(e,t){function a(e,t,a,o){return["C",e,t,a,o,a,o]}function o(e,t,a,o,r,i){return["C",e/3+2/3*a,t/3+2/3*o,r/3+2/3*a,i/3+2/3*o,r,i]}function r(e,a,o,l,c,p,u,m,f,b){if(!b){var v=n(e,a,-c);e=v.x,a=v.y,v=n(m,f,-c),m=v.x,f=v.y;var w=(e-m)/2,x=(a-f)/2,y=w*w/(o*o)+x*x/(l*l);1<y&&(y=re(y),o=y*o,l=y*l);var T=o*o,A=l*l,S=(p==u?-1:1)*re(wa((T*A-T*x*x-A*w*w)/(T*x*x+A*w*w)));S==1/0&&(S=1);var C=S*o*x/l+(e+m)/2,L=S*-l*w/o+(a+f)/2,E=_(((a-L)/l).toFixed(9)),z=_(((f-L)/l).toFixed(9));E=e<C?s-E:E,z=m<C?s-z:z,0>E&&(E=2*s+E),0>z&&(z=2*s+z),u&&E>z&&(E-=2*s),!u&&z>E&&(z-=2*s)}else E=b[0],z=b[1],C=b[2],L=b[3];if(wa(z-E)>d){var I=z,D=m,P=f;z=E+d*(u&&z>E?1:-1),m=C+o*te(z),f=L+l*M(z);var O=r(m,f,o,l,c,0,u,D,P,[z,I,C,L])}var R=g((z-E)/4),t=4/3*o*R,j=4/3*l*R,B=[2*e-(e+t*M(E)),2*a-(a-j*te(E)),m+t*M(z),f-j*te(z),m,f];if(b)return B;O&&(B=B.concat(O));for(var F=0,N;F<B.length;)N=n(B[F],B[F+1],c),B[F++]=N.x,B[F++]=N.y;return B}function n(e,t,a){return{x:e*te(a)-t*M(a),y:e*M(a)+t*te(a)}}function l(e){return e*(s/180)}var s=Sa,d=l(120);t.exports=function(e){for(var t=[],n=0,s=0,d=0,c=0,p=null,u=null,g=0,h=0,m=0,f=e.length,b;m<f;m++){var _=e[m],v=_[0];switch(v){case"M":d=_[1],c=_[2];break;case"A":_=r(g,h,_[1],_[2],l(_[3]),_[4],_[5],_[6],_[7]),_.unshift("C"),7<_.length&&(t.push(_.splice(0,7)),_.unshift("C"));break;case"S":var w=g,k=h;("C"==b||"S"==b)&&(w+=w-n,k+=k-s),_=["C",w,k,_[1],_[2],_[3],_[4]];break;case"T":"Q"==b||"T"==b?(p=2*g-p,u=2*h-u):(p=g,u=h),_=o(g,h,p,u,_[1],_[2]);break;case"Q":p=_[1],u=_[2],_=o(g,h,_[1],_[2],_[3],_[4]);break;case"L":_=a(g,h,_[1],_[2]);break;case"H":_=a(g,h,_[1],h);break;case"V":_=a(g,h,g,_[1]);break;case"Z":_=a(g,h,d,c);}b=v,g=_[_.length-2],h=_[_.length-1],4<_.length?(n=_[_.length-4],s=_[_.length-3]):(n=g,s=h),t.push(_)}return t}},{}],436:[function(e,t,a){a.vertexNormals=function(e,t,a){for(var o=t.length,r=Array(o),l=void 0===a?1e-6:a,s=0;s<o;++s)r[s]=[0,0,0];for(var s=0;s<e.length;++s)for(var d=e[s],g=0,h=d[d.length-1],y=d[0],f=0;f<d.length;++f){g=h,h=y,y=d[(f+1)%d.length];for(var x=t[g],b=t[h],_=t[y],T=[,,,],A=0,S=[,,,],C=0,L=0;3>L;++L)T[L]=x[L]-b[L],A+=T[L]*T[L],S[L]=_[L]-b[L],C+=S[L]*S[L];if(A*C>l)for(var E=r[h],z=1/re(A*C),L=0;3>L;++L){var I=(L+1)%3,u=(L+2)%3;E[L]+=z*(S[I]*T[u]-S[u]*T[I])}}for(var s=0;s<o;++s){for(var E=r[s],v=0,L=0;3>L;++L)v+=E[L]*E[L];if(v>l)for(var z=1/re(v),L=0;3>L;++L)E[L]*=z;else for(var L=0;3>L;++L)E[L]=0}return r},a.faceNormals=function(e,t,a){for(var o=e.length,r=Array(o),s=void 0===a?1e-6:a,d=0;d<o;++d){for(var c=e[d],p=[,,,],g=0;3>g;++g)p[g]=t[c[g]];for(var h=[,,,],m=[,,,],g=0;3>g;++g)h[g]=p[1][g]-p[0][g],m[g]=p[2][g]-p[0][g];for(var y=[,,,],n=0,g=0;3>g;++g){var f=(g+1)%3,u=(g+2)%3;y[g]=h[f]*m[u]-h[u]*m[f],n+=y[g]*y[g]}n=n>s?1/re(n):0;for(var g=0;3>g;++g)y[g]*=n;r[d]=y}return r}},{}],437:[function(e,t){/*
object-assign
(c) Sindre Sorhus
@license MIT
*/"use strict";function a(e){if(null===e||e===void 0)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},a=0;10>a;a++)t["_"+O(a)]=a;var o=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==o.join(""))return!1;var r={};return["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t"].forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e){for(var t=a(e),l=1,d,c;l<arguments.length;l++){for(var p in d=Object(arguments[l]),d)r.call(d,p)&&(t[p]=d[p]);if(o){c=o(d);for(var u=0;u<c.length;u++)n.call(d,c[u])&&(t[c[u]]=d[c[u]])}}return t}},{}],438:[function(e,t){"use strict";t.exports=function(e,t,a,o,r,i,n,s,d,c){var p=t+i+c;if(0<u){var u=re(p+1);e[0]=.5*(n-d)/u,e[1]=.5*(s-o)/u,e[2]=.5*(a-i)/u,e[3]=.5*u}else{var g=va(t,i,c),u=re(2*g-p+1);t>=g?(e[0]=.5*u,e[1]=.5*(r+a)/u,e[2]=.5*(s+o)/u,e[3]=.5*(n-d)/u):i>=g?(e[0]=.5*(a+r)/u,e[1]=.5*u,e[2]=.5*(d+n)/u,e[3]=.5*(s-o)/u):(e[0]=.5*(o+s)/u,e[1]=.5*(n+d)/u,e[2]=.5*u,e[3]=.5*(a-r)/u)}return e}},{}],439:[function(e,t){"use strict";function a(e,t,a){return re(_a(e,2)+_a(t,2)+_a(a,2))}function o(e,t,a,o){return re(_a(e,2)+_a(t,2)+_a(a,2)+_a(o,2))}function n(e,t){var a=t[0],r=t[1],i=t[2],n=t[3],l=o(a,r,i,n);1e-6<l?(e[0]=a/l,e[1]=r/l,e[2]=i/l,e[3]=n/l):(e[0]=e[1]=e[2]=0,e[3]=1)}function l(e,t,a){this.radius=d([a]),this.center=d(t),this.rotation=d(e),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}function s(e){e=e||{};var t=e.center||[0,0,0],a=e.rotation||[0,0,0,1],o=e.radius||1;t=[].slice.call(t,0,3),a=[].slice.call(a,0,4),n(a,a);var r=new l(a,t,P(o));return r.setDistanceLimits(e.zoomMin,e.zoomMax),("eye"in e||"up"in e)&&r.lookAt(0,e.eye,e.center,e.up),r}t.exports=s;var d=e("filtered-vector"),c=e("gl-mat4/lookAt"),p=e("gl-mat4/fromQuat"),u=e("gl-mat4/invert"),g=e("./lib/quatFromFrame"),h=l.prototype;h.lastT=function(){return va(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},h.recalcMatrix=function(e){this.radius.curve(e),this.center.curve(e),this.rotation.curve(e);var t=this.computedRotation;n(t,t);var a=this.computedMatrix;p(a,t);var o=this.computedCenter,r=this.computedEye,l=this.computedUp,s=ka(this.computedRadius[0]);r[0]=o[0]+s*a[2],r[1]=o[1]+s*a[6],r[2]=o[2]+s*a[10],l[0]=a[1],l[1]=a[5],l[2]=a[9];for(var d=0,c;3>d;++d){c=0;for(var u=0;3>u;++u)c+=a[d+4*u]*r[u];a[12+d]=-c}},h.getMatrix=function(e,t){this.recalcMatrix(e);var a=this.computedMatrix;if(t){for(var o=0;16>o;++o)t[o]=a[o];return t}return a},h.idle=function(e){this.center.idle(e),this.radius.idle(e),this.rotation.idle(e)},h.flush=function(e){this.center.flush(e),this.radius.flush(e),this.rotation.flush(e)},h.pan=function(e,t,o,r){t=t||0,o=o||0,r=r||0,this.recalcMatrix(e);var i=this.computedMatrix,n=i[1],l=i[5],s=i[9],d=a(n,l,s);n/=d,l/=d,s/=d;var c=i[0],p=i[4],u=i[8],g=c*n+p*l+u*s;c-=n*g,p-=l*g,u-=s*g;var h=a(c,p,u);c/=h,p/=h,u/=h;var m=i[2],y=i[6],f=i[10],x=m*n+y*l+f*s,b=m*c+y*p+f*u;m-=x*n+b*c,y-=x*l+b*p,f-=x*s+b*u;var _=a(m,y,f);m/=_,y/=_,f/=_;var v=c*t+n*o,w=p*t+l*o,k=u*t+s*o;this.center.move(e,v,w,k);var T=ka(this.computedRadius[0]);T=va(1e-4,T+r),this.radius.set(e,P(T))},h.rotate=function(e,t,r,i){this.recalcMatrix(e),t=t||0,r=r||0;var n=this.computedMatrix,l=n[0],d=n[4],c=n[8],p=n[1],u=n[5],g=n[9],h=n[2],m=n[6],y=n[10],f=t*l+r*p,x=t*d+r*u,b=t*c+r*g,_=-(m*b-y*x),v=-(y*f-h*b),w=-(h*x-m*f),k=re(va(0,1-_a(_,2)-_a(v,2)-_a(w,2))),T=o(_,v,w,k);1e-6<T?(_/=T,v/=T,w/=T,k/=T):(_=v=w=0,k=1);var A=this.computedRotation,S=A[0],C=A[1],L=A[2],E=A[3],z=S*k+E*_+C*w-L*v,I=C*k+E*v+L*_-S*w,D=L*k+E*w+S*v-C*_,P=E*k-S*_-C*v-L*w;if(i){_=h,v=m,w=y;var O=M(i)/a(_,v,w);_*=O,v*=O,w*=O,k=te(t),z=z*k+P*_+I*w-D*v,I=I*k+P*v+D*_-z*w,D=D*k+P*w+z*v-I*_,P=P*k-z*_-I*v-D*w}var s=o(z,I,D,P);1e-6<s?(z/=s,I/=s,D/=s,P/=s):(z=I=D=0,P=1),this.rotation.set(e,z,I,D,P)},h.lookAt=function(e,t,a,o){this.recalcMatrix(e),a=a||this.computedCenter,t=t||this.computedEye,o=o||this.computedUp;var r=this.computedMatrix;c(r,t,a,o);var l=this.computedRotation;g(l,r[0],r[1],r[2],r[4],r[5],r[6],r[8],r[9],r[10]),n(l,l),this.rotation.set(e,l[0],l[1],l[2],l[3]);for(var s=0,d=0;3>d;++d)s+=_a(a[d]-t[d],2);this.radius.set(e,.5*P(va(s,1e-6))),this.center.set(e,a[0],a[1],a[2])},h.translate=function(e,t,a,o){this.center.move(e,t||0,a||0,o||0)},h.setMatrix=function(e,t){var a=this.computedRotation;g(a,t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]),n(a,a),this.rotation.set(e,a[0],a[1],a[2],a[3]);var o=this.computedMatrix;u(o,t);var i=o[15];if(1e-6<wa(i)){var l=o[12]/i,s=o[13]/i,d=o[14]/i;this.recalcMatrix(e);var c=ka(this.computedRadius[0]);this.center.set(e,l-o[2]*c,s-o[6]*c,d-o[10]*c),this.radius.idle(e)}else this.center.idle(e),this.radius.idle(e)},h.setDistance=function(e,t){0<t&&this.radius.set(e,P(t))},h.setDistanceLimits=function(e,t){e=0<e?P(e):-Infinity,t=0<t?P(t):1/0,t=va(t,e),this.radius.bounds[0][0]=e,this.radius.bounds[1][0]=t},h.getDistanceLimits=function(e){var t=this.radius.bounds;return e?(e[0]=ka(t[0][0]),e[1]=ka(t[1][0]),e):[ka(t[0][0]),ka(t[1][0])]},h.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:P(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},h.fromJSON=function(e){var a=this.lastT(),t=e.center;t&&this.center.set(a,t[0],t[1],t[2]);var o=e.rotation;o&&this.rotation.set(a,o[0],o[1],o[2],o[3]);var r=e.distance;r&&0<r&&this.radius.set(a,P(r)),this.setDistanceLimits(e.zoomMin,e.zoomMax)}},{"./lib/quatFromFrame":438,"filtered-vector":215,"gl-mat4/fromQuat":251,"gl-mat4/invert":254,"gl-mat4/lookAt":255}],440:[function(e,t){/*!
 * pad-left <https://github.com/jonschlinkert/pad-left>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT license.
 */"use strict";var a=e("repeat-string");t.exports=function(e,t,o){return o="undefined"==typeof o?" ":o+"",a(o,t)+e}},{"repeat-string":479}],441:[function(e,t){"use strict";function a(e,t){function o(e,t){for(var r=[],i=0,n;n=s.exec(e);){if(1e4<i++)throw Error("Circular references in parenthesis");r.push(e.slice(0,n.index)),r.push(o(t[n[1]],t)),e=e.slice(n.index+n[0].length)}return r.push(e),r}if("string"!=typeof e)return[e];var r=[e];"string"==typeof t||Array.isArray(t)?t={brackets:t}:!t&&(t={});var i=t.brackets?Array.isArray(t.brackets)?t.brackets:[t.brackets]:["{}","[]","()"],n=t.escape||"___",l=!!t.flat;i.forEach(function(e){function t(t){var a=r.push(t.slice(e[0].length,-e[1].length))-1;return i.push(a),n+a}var o=new RegExp(["\\",e[0],"[^\\",e[0],"\\",e[1],"]*\\",e[1]].join("")),i=[];r.forEach(function(e,n){for(var i=0,l;e!=l;)if(l=e,e=e.replace(o,t),1e4<i++)throw Error("References have circular dependency. Please, check them.");r[n]=e}),i=i.reverse(),r=r.map(function(t){return i.forEach(function(a){t=t.replace(new RegExp("(\\"+n+a+"(?![0-9]))","g"),e[0]+"$1"+e[1])}),t})});var s=new RegExp("\\"+n+"([0-9]+)");return l?r:o(r[0],r)}function o(e,t){function o(t,a){if(null==e[a])throw Error("Reference "+a+"is undefined");return e[a]}if(t&&t.flat){var r=t&&t.escape||"___",i=e[0],n;if(!i)return"";for(var l=new RegExp("\\"+r+"([0-9]+)"),s=0;i!=n;){if(1e4<s++)throw Error("Circular references in "+e);n=i,i=i.replace(l,o)}return i}return e.reduce(function e(t,a){return Array.isArray(a)&&(a=a.reduce(e,"")),t+a},"")}function r(e,t){return Array.isArray(e)?o(e,t):a(e,t)}r.parse=a,r.stringify=o,t.exports=r},{}],442:[function(e,t){"use strict";var a=e("pick-by-alias");t.exports=function(e){var t;return 1<arguments.length&&(e=arguments),"string"==typeof e?e=e.split(/\s/).map(parseFloat):"number"==typeof e&&(e=[e]),e.length&&"number"==typeof e[0]?1===e.length?t={width:e[0],height:e[0],x:0,y:0}:2===e.length?t={width:e[0],height:e[1],x:0,y:0}:t={x:e[0],y:e[1],width:e[2]-e[0]||0,height:e[3]-e[1]||0}:e&&(e=a(e,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),t={x:e.left||0,y:e.top||0},t.width=null==e.width?e.right?e.right-t.x:0:e.width,t.height=null==e.height?e.bottom?e.bottom-t.y:0:e.height),t}},{"pick-by-alias":448}],443:[function(e,t){function a(e){var t=e.match(i);return t?t.map(Number):[]}t.exports=function(e){var t=[];return e.replace(r,function(e,r,i){var n=r.toLowerCase();for(i=a(i),"m"==n&&2<i.length&&(t.push([r].concat(i.splice(0,2))),n="l",r="m"==r?"l":"L");;){if(i.length==o[n])return i.unshift(r),t.push(i);if(i.length<o[n])throw new Error("malformed path data");t.push([r].concat(i.splice(0,o[n])))}}),t};var o={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=/([astvzqmhlc])([^astvzqmhlc]*)/ig,i=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig},{}],444:[function(e,t){t.exports=function(e,t){t||(t=[0,""]),e+="";var a=parseFloat(e,10);return t[0]=a,t[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t}},{}],445:[function(e,t){(function(e){(function(){var a,o,r,i,n,l;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof e&&null!==e&&e.hrtime?(t.exports=function(){return(a()-n)/1e6},o=e.hrtime,a=function(){var e;return e=o(),1e9*e[0]+e[1]},i=a(),l=1e9*e.uptime(),n=i-l):Date.now?(t.exports=function(){return Date.now()-r},r=Date.now()):(t.exports=function(){return new Date().getTime()-r},r=new Date().getTime())}).call(this)}).call(this,e("_process"))},{_process:465}],446:[function(e,t){"use strict";t.exports=function(e){var t=e.length;if(32>t){for(var o=1,r=0;r<t;++r)for(var n=0;n<r;++n)if(e[r]<e[n])o=-o;else if(e[r]===e[n])return 0;return o}for(var l=a.mallocUint8(t),r=0;r<t;++r)l[r]=0;for(var o=1,r=0;r<t;++r)if(!l[r]){var s=1;l[r]=1;for(var n=e[r];n!==r;n=e[n]){if(l[n])return a.freeUint8(l),0;s+=1,l[n]=1}1&s||(o=-o)}return a.freeUint8(l),o};var a=e("typedarray-pool")},{"typedarray-pool":521}],447:[function(e,t,a){"use strict";var o=e("typedarray-pool"),r=e("invert-permutation");a.rank=function(e){var a=e.length;switch(a){case 0:case 1:return 0;case 2:return e[1];default:}var n=o.mallocUint32(a),l=o.mallocUint32(a),d=0,c,p,u;for(r(e,l),u=0;u<a;++u)n[u]=e[u];for(u=a-1;0<u;--u)p=l[u],c=n[u],n[u]=n[p],n[p]=c,l[u]=l[c],l[c]=p,d=(d+c)*u;return o.freeUint32(l),o.freeUint32(n),d},a.unrank=function(e,a,o){switch(e){case 0:return o?o:[];case 1:return o?(o[0]=0,o):[0];case 2:return o?(a?(o[0]=0,o[1]=1):(o[0]=1,o[1]=0),o):a?[0,1]:[1,0];default:}o=o||Array(e);var n=1,l,d,c;for(o[0]=0,c=1;c<e;++c)o[c]=c,n=0|n*c;for(c=e-1;0<c;--c)l=0|a/n,a=0|a-l*n,n=0|n/c,d=0|o[c],o[c]=0|o[l],o[l]=0|d;return o}},{"invert-permutation":398,"typedarray-pool":521}],448:[function(e,t){"use strict";function a(e){return o[e]?o[e]:("string"==typeof e&&(e=o[e]=e.split(/\s*,\s*|\s+/)),e)}t.exports=function(e,t,o){var r={},n,l;if("string"==typeof t&&(t=a(t)),Array.isArray(t)){var s={};for(l=0;l<t.length;l++)s[t[l]]=!0;t=s}for(n in t)t[n]=a(t[n]);var d={};for(n in t){var c=t[n];if(Array.isArray(c))for(l=0;l<c.length;l++){var p=c[l];if(o&&(d[p]=!0),p in e){if(r[n]=e[p],o)for(var u=l;u<c.length;u++)d[c[u]]=!0;break}}else n in e&&(t[n]&&(r[n]=e[n]),o&&(d[n]=!0))}if(o)for(n in e)d[n]||(r[n]=e[n]);return r};var o={}},{}],449:[function(e,t){"use strict";t.exports=function(e,t){function r(e,t){var o=g[t][e[t]];o.splice(o.indexOf(e),1)}function n(n,a,l){for(var s=0,d,c,u;2>s;++s)if(0<g[s][a].length){d=g[s][a][0],u=s;break}c=d[1^u];for(var h=0,m;2>h;++h){m=g[h][a];for(var y=0;y<m.length;++y){var f=m[y],e=f[1^h],p=o(t[n],t[a],t[c],t[e]);0<p&&(d=f,c=e,u=h)}}return l?c:(d&&r(d,u),c)}function l(e,i){var l=g[i][e][0],s=[e];r(l,i);for(var p=l[1^i];;){for(;p!==e;)s.push(p),p=n(s[s.length-2],p,!1);if(0===g[0][e].length+g[1][e].length)break;var h=s[s.length-1],a=e,m=s[1],c=n(h,a,!0);if(0>o(t[h],t[a],t[m],t[c]))break;s.push(e),p=n(h,a)}return s}function s(e,t){return t[1]===t[t.length-1]}for(var d=0|t.length,p=e.length,g=[Array(d),Array(d)],h=0;h<d;++h)g[0][h]=[],g[1][h]=[];for(var h=0,a;h<p;++h)a=e[h],g[0][a[0]].push(a),g[1][a[1]].push(a);for(var u=[],h=0;h<d;++h)0===g[0][h].length+g[1][h].length&&u.push([h]);for(var h=0;h<d;++h)for(var m=0,y;2>m;++m){for(y=[];0<g[m][h].length;){var f=g[0][h].length,x=l(h,m);s(y,x)?y.push.apply(y,x):(0<y.length&&u.push(y),y=x)}0<y.length&&u.push(y)}return u};var o=e("compare-angle")},{"compare-angle":115}],450:[function(e,t){"use strict";t.exports=function(t,o){for(var r=a(t,o.length),l=Array(o.length),s=Array(o.length),d=[],c=0,p;c<o.length;++c)p=r[c].length,s[c]=p,l[c]=!0,1>=p&&d.push(c);for(;0<d.length;){var g=d.pop();l[g]=!1;for(var h=r[g],c=0,n;c<h.length;++c)n=h[c],0==--s[n]&&d.push(n)}for(var m=Array(o.length),y=[],c=0;c<o.length;++c)if(l[c]){var g=y.length;m[c]=g,y.push(o[c])}else m[c]=-1;for(var f=[],c=0,x;c<t.length;++c)x=t[c],l[x[0]]&&l[x[1]]&&f.push([m[x[0]],m[x[1]]]);return[f,y]};var a=e("edges-to-adjacency-list")},{"edges-to-adjacency-list":157}],451:[function(e,t){"use strict";function o(e,t){for(var a=Array(e),o=0;o<e;++o)a[o]=t;return a}function r(e){for(var t=Array(e),a=0;a<e;++a)t[a]=[];return t}function i(e,t){function h(e){for(var o=e.length,r=[0],i=0;i<o;++i){var n=t[e[i]],a=t[e[(i+1)%o]],l=d(-n[0],n[1]),s=d(-n[0],a[1]),c=d(a[0],n[1]),u=d(a[0],a[1]);r=p(r,p(p(l,s),p(c,u)))}return 0<r[r.length-1]}function m(e){for(var t=e.length,a=0;a<t;++a)if(!U[e[a]])return!1;return!0}var y=g(e,t);e=y[0],t=y[1];for(var x=t.length,_=e.length,v=n(e,t.length),w=0;w<x;++w)if(1==v[w].length%2)throw new Error("planar-graph-to-polyline: graph must be manifold");var T=l(e,t);T=T.filter(h);for(var A=T.length,S=Array(A),C=Array(A),w=0;w<A;++w){S[w]=w;var L=Array(A),E=T[w].map(function(e){return t[e]}),z=s([E]),I=0;outer:for(var D=0;D<A;++D)if(L[D]=0,w!=D){for(var P=T[D],O=P.length,R=0,M;R<O;++R)if(M=z(t[P[R]]),0!==M){0>M&&(L[D]=1,I+=1);continue outer}L[D]=1,I+=1}C[w]=[I,w,L]}C.sort(function(e,t){return t[0]-e[0]});for(var w=0;w<A;++w)for(var L=C[w],B=L[1],F=L[2],D=0;D<A;++D)F[D]&&(S[D]=B);for(var N=r(A),w=0;w<A;++w)N[w].push(S[w]),N[S[w]].push(w);for(var V={},U=o(x,!1),w=0;w<A;++w)for(var P=T[w],O=P.length,D=0;D<O;++D){var H=P[D],a=P[(D+1)%O],b=ie(H,a)+":"+va(H,a);if(b in V){var G=V[b];N[G].push(w),N[w].push(G),U[H]=U[a]=!0}else V[b]=w}for(var Y=[],q=o(A,-1),w=0;w<A;++w)S[w]!==w||m(T[w])?q[w]=-1:(Y.push(w),q[w]=0);for(var y=[];0<Y.length;){var W=Y.pop(),X=N[W];u(X,function(e,t){return e-t});var Z=X.length,$=q[W],J;if(0===$){var P=T[W];J=[P]}for(var w=0,K;w<Z;++w)if((K=X[w],!(0<=q[K]))&&(q[K]=1^$,Y.push(K),0===$)){var P=T[K];m(P)||(P.reverse(),J.push(P))}0===$&&y.push(J)}return y}t.exports=i;var n=e("edges-to-adjacency-list"),l=e("planar-dual"),s=e("point-in-big-polygon"),d=e("two-product"),p=e("robust-sum"),u=e("uniq"),g=e("./lib/trim-leaves")},{"./lib/trim-leaves":450,"edges-to-adjacency-list":157,"planar-dual":449,"point-in-big-polygon":455,"robust-sum":491,"two-product":519,uniq:523}],452:[function(e,t){"use strict";t.exports=e("./quad")},{"./quad":454}],453:[function(e,t,a){arguments[4][99][0].apply(a,arguments)},{dup:99}],454:[function(e,t){"use strict";function a(e,t){for(var a=t[0],o=t[1],l=t[2],s=t[3],d=Array(e.length),c=0,p=e.length/2;c<p;c++)d[2*c]=r((e[2*c]-a)*(1/(l-a)),0,1),d[2*c+1]=r((e[2*c+1]-o)*(1/(s-o)),0,1);return d}var o=e("binary-search-bounds"),r=e("clamp"),i=e("parse-rect"),s=e("array-bounds"),d=e("pick-by-alias"),c=e("defined"),p=e("flatten-vertex-data"),u=e("is-obj"),g=e("dtype"),h=e("math-log2");t.exports=function(e,t){function r(e,t,a,o,n,s){if(!o.length)return null;var d=k[n]||(k[n]=[]),c=A[n]||(A[n]=[]),p=T[n]||(T[n]=[]),u=d.length;if(n++,n>b){for(var g=0;g<o.length;g++)d.push(o[g]),c.push(s),p.push(null,null,null,null);return u}if(d.push(o[0]),c.push(s),1>=o.length)return p.push(null,null,null,null),u;for(var h=.5*a,m=e+h,y=t+h,f=[],x=[],_=[],w=[],S=1,C=o.length;S<C;S++){var l=o[S],L=v[2*l],E=v[2*l+1];L<m?E<y?f.push(l):x.push(l):E<y?_.push(l):w.push(l)}return s<<=2,p.push(r(e,t,h,f,n,s),r(e,y,h,x,n,s+1),r(m,t,h,_,n,s+2),r(m,y,h,w,n,s+3)),u}function m(){function t(a,r,n,l,s,d){if(null!==s&&null!==d){if(!(w>a+n||A>r+n||S<a||C<r)&&!(l>=L)&&s!==d){var c=k[l];void 0===d&&(d=c.length);for(var p=s;p<d;p++){var u=c[p],g=e[2*u],h=e[2*u+1];g>=m&&g<=x&&h>=f&&h<=b&&z.push(u)}var y=T[l],_=y[4*s+0],v=y[4*s+1],E=y[4*s+2],I=y[4*s+3],D=o(y,s+1),P=.5*n,O=l+1;t(a,r,P,O,_,v||E||I||D),t(a,r+P,P,O,v,E||I||D),t(a+P,r,P,O,E,I||D),t(a+P,r+P,P,O,I,D)}}}function o(e,t){for(var a=null,o=0;null===a;)if(a=e[4*t+o],o++,o>e.length)return null;return a}for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];var l;if(u(r[r.length-1])){var s=r.pop();r.length||null==s.x&&null==s.l&&null==s.left||(r=[s],l={}),l=d(s,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else l={};r.length||(r=_);var p=i.apply(void 0,r),g=[ie(p.x,p.x+p.width),ie(p.y,p.y+p.height),va(p.x,p.x+p.width),va(p.y,p.y+p.height)],m=g[0],f=g[1],x=g[2],b=g[3],v=a([m,f,x,b],_),w=v[0],A=v[1],S=v[2],C=v[3],L=c(l.level,k.length);if(null!=l.d){var E;"number"==typeof l.d?E=[l.d,l.d]:l.d.length&&(E=l.d),L=ie(va(ae(-h(wa(E[0])/(_[2]-_[0]))),ae(-h(wa(E[1])/(_[3]-_[1])))),L)}if(L=ie(L,k.length),l.lod)return y(w,A,S,C,L);var z=[];return t(0,0,1,0,0,1),z}function y(e,t,a,r,i){for(var n=[],l=0;l<i;l++){var s=A[l],d=S[l][0],c=f(e,t,l),p=f(a,r,l),u=o.ge(s,c),g=o.gt(s,p,u,s.length-1);n[l]=[u+d,g+d]}return n}function f(e,t,a){for(var o=1,r=.5,n=.5,l=.5,s=0;s<a;s++)o<<=2,o+=e<r?t<n?0:1:t<n?2:3,l*=.5,r+=e<r?-l:l,n+=t<n?-l:l;return o}t||(t={}),e=p(e,"float64"),t=d(t,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var b=c(t.maxDepth,255),_=c(t.bounds,s(e,2));_[0]===_[2]&&_[2]++,_[1]===_[3]&&_[3]++;var v=a(e,_),w=e.length>>>1,n;t.dtype||(t.dtype="array"),"string"==typeof t.dtype?n=new(g(t.dtype))(w):t.dtype&&(n=t.dtype,Array.isArray(n)&&(n.length=w));for(var x=0;x<w;++x)n[x]=x;var k=[],T=[],A=[],S=[];r(0,0,1,n,0,1);for(var C=0,L=0,E;L<k.length;L++){if(E=k[L],n.set)n.set(E,C);else for(var z=0,I=E.length;z<I;z++)n[z+C]=E[z];var l=C+k[L].length;S[L]=[C,l],C=l}return n.range=m,n}},{"array-bounds":53,"binary-search-bounds":453,clamp:103,defined:149,dtype:154,"flatten-vertex-data":216,"is-obj":404,"math-log2":415,"parse-rect":442,"pick-by-alias":448}],455:[function(e,t){function a(){return!0}function o(e){return function(t,o){var r=e[t];return!!r&&!!r.queryPoint(o,a)}}function r(e){for(var t={},a=0;a<e.length;++a){var r=e[a],n=r[0][0],l=r[0][1],s=r[1][1],d=[ie(l,s),va(l,s)];n in t?t[n].push(d):t[n]=[d]}for(var c={},p=Object.keys(t),a=0,u;a<p.length;++a)u=t[p[a]],c[p[a]]=h(u);return o(c)}function n(e,t){return function(a){var r=m.le(t,a[0]);if(0>r)return 1;var i=e[r];if(!i)if(0<r&&t[r]===a[0])i=e[r-1];else return 1;for(var n=1;i;){var l=i.key,s=u(a,l[0],l[1]);if(l[0][0]<l[1][0]){if(0>s)i=i.left;else if(0<s)n=-1,i=i.right;else return 0;}else if(0<s)i=i.left;else if(0>s)n=1,i=i.right;else return 0}return n}}function l(){return 1}function d(e){return function(t){return e(t[0],t[1])?0:1}}function c(e,t){return function(a){return e(a[0],a[1])?0:t(a)}}t.exports=function(e){for(var o=e.length,p=[],u=[],h=0;h<o;++h)for(var m=e[h],y=m.length,f=y-1,x=0;x<y;f=x++){var _=m[f],a=m[x];_[0]===a[0]?u.push([_,a]):p.push([_,a])}if(0===p.length)return 0===u.length?l:d(r(u));var b=g(p),v=n(b.slabs,b.coordinates);return 0===u.length?v:c(r(u),v)};var u=e("robust-orientation")[3],g=e("slab-decomposition"),h=e("interval-tree-1d"),m=e("binary-search-bounds")},{"binary-search-bounds":79,"interval-tree-1d":397,"robust-orientation":486,"slab-decomposition":502}],456:[function(e,t){function a(e,t,a){var o=u.segments(e),r=u.segments(t),i=u.combine(o,r),n=a(i);return u.polygon(n)}/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var o=e("./lib/build-log"),r=e("./lib/epsilon"),n=e("./lib/intersecter"),l=e("./lib/segment-chainer"),s=e("./lib/segment-selector"),d=e("./lib/geojson"),c=!1,p=r(),u;u={buildLog:function(e){return!0===e?c=o():!1==e&&(c=!1),!1!==c&&c.list},epsilon:function(e){return p.epsilon(e)},segments:function(e){var t=n(!0,p,c);return e.regions.forEach(t.addRegion),{segments:t.calculate(e.inverted),inverted:e.inverted}},combine:function(e,t){var a=n(!1,p,c);return{combined:a.calculate(e.segments,e.inverted,t.segments,t.inverted),inverted1:e.inverted,inverted2:t.inverted}},selectUnion:function(e){return{segments:s.union(e.combined,c),inverted:e.inverted1||e.inverted2}},selectIntersect:function(e){return{segments:s.intersect(e.combined,c),inverted:e.inverted1&&e.inverted2}},selectDifference:function(e){return{segments:s.difference(e.combined,c),inverted:e.inverted1&&!e.inverted2}},selectDifferenceRev:function(e){return{segments:s.differenceRev(e.combined,c),inverted:!e.inverted1&&e.inverted2}},selectXor:function(e){return{segments:s.xor(e.combined,c),inverted:e.inverted1!==e.inverted2}},polygon:function(e){return{regions:l(e.segments,p,c),inverted:e.inverted}},polygonFromGeoJSON:function(e){return d.toPolygon(u,e)},polygonToGeoJSON:function(e){return d.fromPolygon(u,p,e)},union:function(e,t){return a(e,t,u.selectUnion)},intersect:function(e,t){return a(e,t,u.selectIntersect)},difference:function(e,t){return a(e,t,u.selectDifference)},differenceRev:function(e,t){return a(e,t,u.selectDifferenceRev)},xor:function(e,t){return a(e,t,u.selectXor)}},"object"==typeof window&&(window.PolyBool=u),t.exports=u},{"./lib/build-log":457,"./lib/epsilon":458,"./lib/geojson":459,"./lib/intersecter":460,"./lib/segment-chainer":462,"./lib/segment-selector":463}],457:[function(e,t){t.exports=function(){function e(e,t){return o.list.push({type:e,data:t?JSON.parse(JSON.stringify(t)):void 0}),o}var t=0,a=!1,o;return o={list:[],segmentId:function(){return t++},checkIntersection:function(t,a){return e("check",{seg1:t,seg2:a})},segmentChop:function(t,a){return e("div_seg",{seg:t,pt:a}),e("chop",{seg:t,pt:a})},statusRemove:function(t){return e("pop_seg",{seg:t})},segmentUpdate:function(t){return e("seg_update",{seg:t})},segmentNew:function(t,a){return e("new_seg",{seg:t,primary:a})},segmentRemove:function(t){return e("rem_seg",{seg:t})},tempStatus:function(t,a,o){return e("temp_status",{seg:t,above:a,below:o})},rewind:function(t){return e("rewind",{seg:t})},status:function(t,a,o){return e("status",{seg:t,above:a,below:o})},vert:function(t){return t===a?o:(a=t,e("vert",{x:t}))},log:function(t){return"string"!=typeof t&&(t=JSON.stringify(t,!1,"  ")),e("log",{txt:t})},reset:function(){return e("reset")},selected:function(t){return e("selected",{segs:t})},chainStart:function(t){return e("chain_start",{seg:t})},chainRemoveHead:function(t,a){return e("chain_rem_head",{index:t,pt:a})},chainRemoveTail:function(t,a){return e("chain_rem_tail",{index:t,pt:a})},chainNew:function(t,a){return e("chain_new",{pt1:t,pt2:a})},chainMatch:function(t){return e("chain_match",{index:t})},chainClose:function(t){return e("chain_close",{index:t})},chainAddHead:function(t,a){return e("chain_add_head",{index:t,pt:a})},chainAddTail:function(t,a){return e("chain_add_tail",{index:t,pt:a})},chainConnect:function(t,a){return e("chain_con",{index1:t,index2:a})},chainReverse:function(t){return e("chain_rev",{index:t})},chainJoin:function(t,a){return e("chain_join",{index1:t,index2:a})},done:function(){return e("done")}},o}},{}],458:[function(e,t){t.exports=function(e){"number"!=typeof e&&(e=1e-10);var t={epsilon:function(t){return"number"==typeof t&&(e=t),e},pointAboveOrOnLine:function(t,a,o){var r=a[0],i=a[1],n=o[0],l=o[1],s=t[0],d=t[1];return(n-r)*(d-i)-(l-i)*(s-r)>=-e},pointBetween:function(t,a,o){var r=t[1]-a[1],i=o[0]-a[0],n=t[0]-a[0],l=o[1]-a[1],s=n*i+r*l;if(s<e)return!1;return!(s-(i*i+l*l)>-e)},pointsSameX:function(t,a){return wa(t[0]-a[0])<e},pointsSameY:function(t,a){return wa(t[1]-a[1])<e},pointsSame:function(e,a){return t.pointsSameX(e,a)&&t.pointsSameY(e,a)},pointsCompare:function(e,a){return t.pointsSameX(e,a)?t.pointsSameY(e,a)?0:e[1]<a[1]?-1:1:e[0]<a[0]?-1:1},pointsCollinear:function(t,a,o){var r=t[0]-a[0],i=t[1]-a[1],n=a[0]-o[0],l=a[1]-o[1];return wa(r*l-n*i)<e},linesIntersect:function(t,a,o,r){var i=a[0]-t[0],n=a[1]-t[1],l=r[0]-o[0],s=r[1]-o[1],d=i*s-n*l;if(wa(d)<e)return!1;var c=t[0]-o[0],p=t[1]-o[1],u=(l*p-s*c)/d,g=(i*p-n*c)/d,h={alongA:0,alongB:0,pt:[t[0]+u*i,t[1]+u*n]};return h.alongA=u<=-e?-2:u<e?-1:u-1<=-e?0:u-1<e?1:2,h.alongB=g<=-e?-2:g<e?-1:g-1<=-e?0:g-1<e?1:2,h},pointInsideRegion:function(t,a){for(var o=t[0],r=t[1],n=a[a.length-1][0],l=a[a.length-1][1],s=!1,d=0;d<a.length;d++){var c=a[d][0],p=a[d][1];p-r>e!=l-r>e&&(n-c)*(r-p)/(l-p)+c-o>e&&(s=!s),n=c,l=p}return s}};return t}},{}],459:[function(e,t){t.exports={toPolygon:function(e,t){function a(t){function a(t){var a=t.slice(0,t.length-1);return e.segments({inverted:!1,regions:[a]})}if(0>=t.length)return e.segments({inverted:!1,regions:[]});for(var o=a(t[0]),r=1;r<t.length;r++)o=e.selectDifference(e.combine(o,a(t[r])));return o}if("Polygon"===t.type)return e.polygon(a(t.coordinates));if("MultiPolygon"===t.type){for(var o=e.segments({inverted:!1,regions:[]}),r=0;r<t.coordinates.length;r++)o=e.selectUnion(e.combine(o,a(t.coordinates[r])));return e.polygon(o)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(e,t,a){function o(e,a){return t.pointInsideRegion([.5*(e[0][0]+e[1][0]),.5*(e[0][1]+e[1][1])],a)}function r(e){return{region:e,children:[]}}function n(e,t){for(var a=0,l;a<e.children.length;a++)if(l=e.children[a],o(t,l.region))return void n(l,t);for(var s=r(t),a=0,l;a<e.children.length;a++)l=e.children[a],o(l.region,t)&&(s.children.push(l),e.children.splice(a,1),a--);e.children.push(s)}function l(e,t){for(var a=0,o=e[e.length-1][0],r=e[e.length-1][1],n=[],l=0;l<e.length;l++){var s=e[l][0],d=e[l][1];n.push([s,d]),a+=d*o-s*r,o=s,r=d}var c=0>a;return c!==t&&n.reverse(),n.push([n[0][0],n[0][1]]),n}function s(e){var t=[l(e.region,!1)];g.push(t);for(var a=0;a<e.children.length;a++)t.push(d(e.children[a]))}function d(e){for(var t=0;t<e.children.length;t++)s(e.children[t]);return l(e.region,!0)}a=e.polygon(e.segments(a));for(var c=r(null),p=0,u;p<a.regions.length;p++)u=a.regions[p],3>u.length||n(c,u);for(var g=[],p=0;p<c.children.length;p++)s(c.children[p]);return 0>=g.length?{type:"Polygon",coordinates:[]}:1==g.length?{type:"Polygon",coordinates:g[0]}:{type:"MultiPolygon",coordinates:g}}}},{}],460:[function(e,t){var a=e("./linked-list");t.exports=function(e,t,o){function r(e,t){return{id:o?o.segmentId():-1,start:e,end:t,myFill:{above:null,below:null},otherFill:null}}function i(e,t,a){return{id:o?o.segmentId():-1,start:e,end:t,myFill:{above:a.myFill.above,below:a.myFill.below},otherFill:null}}function n(e,a,o,r,i,n){var l=t.pointsCompare(a,i);return 0===l?t.pointsSame(o,n)?0:e===r?t.pointAboveOrOnLine(o,r?i:n,r?n:i)?1:-1:e?1:-1:l}function l(e,t){h.insertBefore(e,function(a){var o=n(e.isStart,e.pt,t,a.isStart,a.pt,a.other.pt);return 0>o})}function s(e,t){var o=a.node({isStart:!0,pt:e.start,seg:e,primary:t,other:null,status:null});return l(o,e.end),o}function d(e,t,o){var r=a.node({isStart:!1,pt:t.end,seg:t,primary:o,other:e,status:null});e.other=r,l(r,e.pt)}function c(e,t){var a=s(e,t);return d(a,e,t),a}function p(e,t){o&&o.segmentChop(e.seg,t),e.other.remove(),e.seg.end=t,e.other.pt=t,l(e.other,e.pt)}function u(e,t){var a=i(t,e.seg.end,e.seg);return p(e,t),c(a,e.primary)}function g(r,i){function n(e,a){var o=e.seg.start,r=e.seg.end,i=a.seg.start,n=a.seg.end;return t.pointsCollinear(o,i,n)?t.pointsCollinear(r,i,n)?1:t.pointAboveOrOnLine(r,i,n)?1:-1:t.pointAboveOrOnLine(o,i,n)?1:-1}function l(e){return c.findTransition(function(t){var a=n(e,t.ev);return 0<a})}function d(e,a){var r=e.seg,n=a.seg,l=r.start,s=r.end,d=n.start,c=n.end;o&&o.checkIntersection(r,n);var p=t.linesIntersect(l,s,d,c);if(!1===p){if(!t.pointsCollinear(l,s,d))return!1;if(t.pointsSame(l,c)||t.pointsSame(s,d))return!1;var i=t.pointsSame(l,d),g=t.pointsSame(s,c);if(i&&g)return a;var h=!i&&t.pointBetween(l,d,c),m=!g&&t.pointBetween(s,d,c);if(i)return m?u(a,s):u(e,c),a;h&&(g||(m?u(a,s):u(e,c)),u(a,l))}else 0===p.alongA&&(-1===p.alongB?u(e,d):0===p.alongB?u(e,p.pt):1===p.alongB&&u(e,c)),0===p.alongB&&(-1===p.alongA?u(a,l):0===p.alongA?u(a,p.pt):1===p.alongA&&u(a,s));return!1}for(var c=a.create(),p=[],g;!h.isEmpty();){if(g=h.getHead(),o&&o.vert(g.pt[0]),g.isStart){function t(){if(y){var e=d(g,y);if(e)return e}return!!f&&d(g,f)}o&&o.segmentNew(g.seg,g.primary);var m=l(g),y=m.before?m.before.ev:null,f=m.after?m.after.ev:null;o&&o.tempStatus(g.seg,!!y&&y.seg,!!f&&f.seg);var x=t();if(x){if(e){var b;b=null===g.seg.myFill.below||g.seg.myFill.above!==g.seg.myFill.below,b&&(x.seg.myFill.above=!x.seg.myFill.above)}else x.seg.otherFill=g.seg.myFill;o&&o.segmentUpdate(x.seg),g.other.remove(),g.remove()}if(h.getHead()!==g){o&&o.rewind(g.seg);continue}if(e){var b;b=null===g.seg.myFill.below||g.seg.myFill.above!==g.seg.myFill.below,g.seg.myFill.below=f?f.seg.myFill.above:r,g.seg.myFill.above=b?!g.seg.myFill.below:g.seg.myFill.below}else if(null===g.seg.otherFill){var _;_=f?g.primary===f.primary?f.seg.otherFill.above:f.seg.myFill.above:g.primary?i:r,g.seg.otherFill={above:_,below:_}}o&&o.status(g.seg,!!y&&y.seg,!!f&&f.seg),g.other.status=m.insert(a.node({ev:g}))}else{var v=g.status;if(null===v)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(c.exists(v.prev)&&c.exists(v.next)&&d(v.prev.ev,v.next.ev),o&&o.statusRemove(v.ev.seg),v.remove(),!g.primary){var w=g.seg.myFill;g.seg.myFill=g.seg.otherFill,g.seg.otherFill=w}p.push(g.seg)}h.getHead().remove()}return o&&o.done(),p}var h=a.create();return e?{addRegion:function(e){for(var a=e[e.length-1],o=0,n;o<e.length;o++){n=a,a=e[o];var l=t.pointsCompare(n,a);0===l||c(r(0>l?n:a,0>l?a:n),!0)}},calculate:function(e){return g(e,!1)}}:{calculate:function(e,t,a,o){return e.forEach(function(e){c(i(e.start,e.end,e),!0)}),a.forEach(function(e){c(i(e.start,e.end,e),!1)}),g(t,o)}}}},{"./linked-list":461}],461:[function(e,t){t.exports={create:function(){var e={root:{root:!0,next:null},exists:function(t){return null!==t&&t!==e.root},isEmpty:function(){return null===e.root.next},getHead:function(){return e.root.next},insertBefore:function(t,a){for(var o=e.root,r=e.root.next;null!==r;){if(a(r))return t.prev=r.prev,t.next=r,r.prev.next=t,void(r.prev=t);o=r,r=r.next}o.next=t,t.prev=o,t.next=null},findTransition:function(t){for(var a=e.root,o=e.root.next;null!==o&&!t(o);)a=o,o=o.next;return{before:a===e.root?null:a,after:o,insert:function(e){return e.prev=a,e.next=o,a.next=e,null!==o&&(o.prev=e),e}}}};return e},node:function(e){return e.prev=null,e.next=null,e.remove=function(){e.prev.next=e.next,e.next&&(e.next.prev=e.prev),e.prev=null,e.next=null},e}}},{}],462:[function(e,t){t.exports=function(e,t,a){var o=[],r=[];return e.forEach(function(e){function n(e,t,a){return(g.index=e,g.matches_head=t,g.matches_pt1=a,g===p)?(g=u,!1):(g=null,!0)}function l(e){a&&a.chainReverse(e),o[e].reverse()}function s(e,r){var i=o[e],n=o[r],l=i[i.length-1],s=i[i.length-2],d=n[0],c=n[1];t.pointsCollinear(s,l,d)&&(a&&a.chainRemoveTail(e,l),i.pop(),l=s),t.pointsCollinear(l,d,c)&&(a&&a.chainRemoveHead(r,d),n.shift()),a&&a.chainJoin(e,r),o[e]=i.concat(n),o.splice(r,1)}var d=e.start,c=e.end;if(t.pointsSame(d,c))return void console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");a&&a.chainStart(e);for(var p={index:0,matches_head:!1,matches_pt1:!1},u={index:0,matches_head:!1,matches_pt1:!1},g=p,h=0;h<o.length;h++){var m=o[h],y=m[0],f=m[1],x=m[m.length-1],b=m[m.length-2];if(t.pointsSame(y,d)){if(n(h,!0,!0))break;}else if(t.pointsSame(y,c)){if(n(h,!0,!1))break;}else if(t.pointsSame(x,d)){if(n(h,!1,!0))break;}else if(t.pointsSame(x,c)&&n(h,!1,!1))break}if(g===p)return o.push([d,c]),void(a&&a.chainNew(d,c));if(g===u){a&&a.chainMatch(p.index);var _=p.index,v=p.matches_pt1?c:d,w=p.matches_head,m=o[_],k=w?m[0]:m[m.length-1],T=w?m[1]:m[m.length-2],A=w?m[m.length-1]:m[0],C=w?m[m.length-2]:m[1];return(t.pointsCollinear(T,k,v)&&(w?(a&&a.chainRemoveHead(p.index,v),m.shift()):(a&&a.chainRemoveTail(p.index,v),m.pop()),k=T),t.pointsSame(A,v))?(o.splice(_,1),t.pointsCollinear(C,A,k)&&(w?(a&&a.chainRemoveTail(p.index,k),m.pop()):(a&&a.chainRemoveHead(p.index,k),m.shift())),a&&a.chainClose(p.index),void r.push(m)):void(w?(a&&a.chainAddHead(p.index,v),m.unshift(v)):(a&&a.chainAddTail(p.index,v),m.push(v)))}var L=p.index,E=u.index;a&&a.chainConnect(L,E);var S=o[L].length<o[E].length;p.matches_head?u.matches_head?S?(l(L),s(L,E)):(l(E),s(E,L)):s(E,L):u.matches_head?s(L,E):S?(l(L),s(E,L)):(l(E),s(L,E))}),r}},{}],463:[function(e,t){function a(e,t,a){var o=[];return e.forEach(function(e){var r=(e.myFill.above?8:0)+(e.myFill.below?4:0)+(e.otherFill&&e.otherFill.above?2:0)+(e.otherFill&&e.otherFill.below?1:0);0!==t[r]&&o.push({id:a?a.segmentId():-1,start:e.start,end:e.end,myFill:{above:1===t[r],below:2===t[r]},otherFill:null})}),a&&a.selected(o),o}t.exports={union:function(e,t){return a(e,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],t)},intersect:function(e,t){return a(e,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],t)},difference:function(e,t){return a(e,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],t)},differenceRev:function(e,t){return a(e,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],t)},xor:function(e,t){return a(e,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],t)}}},{}],464:[function(e,t){"use strict";function a(e,a,l,p,g){o.length<p.length&&(o=new Float64Array(p.length),r=new Float64Array(p.length),n=new Float64Array(p.length));for(var h=0;h<p.length;++h)o[h]=e[h]-p[h],r[h]=a[h]-e[h],n[h]=l[h]-e[h];for(var m=0,y=0,f=0,x=0,b=0,_=0,h=0;h<p.length;++h){var v=r[h],w=n[h],k=o[h];m+=v*v,y+=v*w,f+=w*w,x+=k*v,b+=k*w,_+=k*k}var d=wa(m*f-y*y),T=y*b-f*x,A=y*x-m*b,S;if(!(T+A<=d)){var C,L,E,z;0>T?(C=y+x,L=f+b,L>C?(E=L-C,z=m-2*y+f,E>=z?(T=1,A=0,S=m+2*x+_):(T=E/z,A=1-T,S=T*(m*T+y*A+2*x)+A*(y*T+f*A+2*b)+_)):(T=0,0>=L?(A=1,S=f+2*b+_):0<=b?(A=0,S=_):(A=-b/f,S=b*A+_))):0>A?(C=y+b,L=m+x,L>C?(E=L-C,z=m-2*y+f,E>=z?(A=1,T=0,S=f+2*b+_):(A=E/z,T=1-A,S=T*(m*T+y*A+2*x)+A*(y*T+f*A+2*b)+_)):(A=0,0>=L?(T=1,S=m+2*x+_):0<=x?(T=0,S=_):(T=-x/m,S=x*T+_))):(E=f+b-y-x,0>=E?(T=0,A=1,S=f+2*b+_):(z=m-2*y+f,E>=z?(T=1,A=0,S=m+2*x+_):(T=E/z,A=1-T,S=T*(m*T+y*A+2*x)+A*(y*T+f*A+2*b)+_)))}else if(0>T)0>A?0>x?(A=0,-x>=m?(T=1,S=m+2*x+_):(T=-x/m,S=x*T+_)):(T=0,0<=b?(A=0,S=_):-b>=f?(A=1,S=f+2*b+_):(A=-b/f,S=b*A+_)):(T=0,0<=b?(A=0,S=_):-b>=f?(A=1,S=f+2*b+_):(A=-b/f,S=b*A+_));else if(0>A)A=0,0<=x?(T=0,S=_):-x>=m?(T=1,S=m+2*x+_):(T=-x/m,S=x*T+_);else{var I=1/d;T*=I,A*=I,S=T*(m*T+y*A+2*x)+A*(y*T+f*A+2*b)+_}for(var D=1-T-A,h=0;h<p.length;++h)g[h]=D*e[h]+T*a[h]+A*l[h];return 0>S?0:S}var o=new Float64Array(4),r=new Float64Array(4),n=new Float64Array(4);t.exports=a},{}],465:[function(e,t){function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function r(t){if(p===setTimeout)return setTimeout(t,0);if((p===a||!p)&&setTimeout)return p=setTimeout,setTimeout(t,0);try{return p(t,0)}catch(a){try{return p.call(null,t,0)}catch(a){return p.call(this,t,0)}}}function i(t){if(u===clearTimeout)return clearTimeout(t);if((u===o||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{return u(t)}catch(a){try{return u.call(null,t)}catch(a){return u.call(this,t)}}}function n(){h&&y&&(h=!1,y.length?g=y.concat(g):m=-1,g.length&&l())}function l(){if(!h){var e=r(n);h=!0;for(var t=g.length;t;){for(y=g,g=[];++m<t;)y&&y[m].run();m=-1,t=g.length}y=null,h=!1,i(e)}}function s(e,t){this.fun=e,this.array=t}function d(){}var c=t.exports={},p,u;(function(){try{p="function"==typeof setTimeout?setTimeout:a}catch(t){p=a}try{u="function"==typeof clearTimeout?clearTimeout:o}catch(t){u=o}})();var g=[],h=!1,m=-1,y;c.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];g.push(new s(e,t)),1!==g.length||h||r(l)},s.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=d,c.addListener=d,c.once=d,c.off=d,c.removeListener=d,c.removeAllListeners=d,c.emit=d,c.prependListener=d,c.prependOnceListener=d,c.listeners=function(){return[]},c.binding=function(){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],466:[function(e,t){t.exports=e("gl-quat/slerp")},{"gl-quat/slerp":280}],467:[function(e,t){(function(a){for(var o=e("performance-now"),r="undefined"==typeof window?a:window,n=["moz","webkit"],l="AnimationFrame",s=r["request"+l],d=r["cancel"+l]||r["cancelRequest"+l],c=0;!s&&c<n.length;c++)s=r[n[c]+"Request"+l],d=r[n[c]+"Cancel"+l]||r[n[c]+"CancelRequest"+l];if(!s||!d){var p=0,u=0,g=[];s=function(e){if(0===g.length){var t=o(),a=va(0,1e3/60-(t-p));p=a+t,setTimeout(function(){var e=g.slice(0);g.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(p)}catch(t){setTimeout(function(){throw t},0)}},R(a))}return g.push({handle:++u,callback:e,cancelled:!1}),u},d=function(e){for(var t=0;t<g.length;t++)g[t].handle===e&&(g[t].cancelled=!0)}}t.exports=function(e){return s.call(r,e)},t.exports.cancel=function(){d.apply(r,arguments)},t.exports.polyfill=function(e){e||(e=r),e.requestAnimationFrame=s,e.cancelAnimationFrame=d}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"performance-now":445}],468:[function(e,t){"use strict";var o=e("big-rat/add");t.exports=function(e,t){for(var a=e.length,n=Array(a),r=0;r<a;++r)n[r]=o(e[r],t[r]);return n}},{"big-rat/add":63}],469:[function(e,t){"use strict";t.exports=function(e){for(var t=Array(e.length),o=0;o<e.length;++o)t[o]=a(e[o]);return t};var a=e("big-rat")},{"big-rat":66}],470:[function(e,t){"use strict";var o=e("big-rat"),l=e("big-rat/mul");t.exports=function(e,t){for(var a=o(t),s=e.length,n=Array(s),r=0;r<s;++r)n[r]=l(e[r],a);return n}},{"big-rat":66,"big-rat/mul":75}],471:[function(e,t){"use strict";var o=e("big-rat/sub");t.exports=function(e,t){for(var a=e.length,n=Array(a),r=0;r<a;++r)n[r]=o(e[r],t[r]);return n}},{"big-rat/sub":77}],472:[function(e,t){"use strict";var a=e("compare-cell"),r=e("compare-oriented-cell"),n=e("cell-orientation");t.exports=function(e){e.sort(r);for(var t=e.length,l=0,s=0;s<t;++s){var d=e[s],c=n(d);if(0!==c){if(0<l){var o=e[l-1];if(0===a(d,o)&&n(o)!==c){l-=1;continue}}e[l++]=d}}return e.length=l,e}},{"cell-orientation":100,"compare-cell":116,"compare-oriented-cell":117}],473:[function(e,t){"use strict";var a=e("array-bounds"),o=e("color-normalize"),r=e("update-diff"),n=e("pick-by-alias"),l=e("object-assign"),s=e("flatten-vertex-data"),d=e("to-float32"),c=d.float32,p=d.fract32;t.exports=function(e,t){function i(e){e?h(e):null===e&&m(),d()}function d(t){return"number"==typeof t?g(t):void(t&&!Array.isArray(t)&&(t=[t]),e._refresh(),x.forEach(function(e,a){if(e)return t&&(t[a]?e.draw=!0:e.draw=!1),e.draw?void g(a):void(e.draw=!0)}))}function g(e){"number"==typeof e&&(e=x[e]),null!=e&&e&&e.count&&e.color&&e.opacity&&e.positions&&1<e.positions.length&&(e.scaleRatio=[e.scale[0]*e.viewport.width,e.scale[1]*e.viewport.height],b(e),e.after&&e.after(e))}function h(e){if(e){null==e.length?!Array.isArray(e)&&(e=[e]):"number"==typeof e[0]&&(e=[{positions:e}]);var t=0,d=0;if(i.groups=x=e.map(function(e,c){var i=x[c];return e?("function"==typeof e?e={after:e}:"number"==typeof e[0]&&(e={positions:e}),e=n(e,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),i||(x[c]=i={id:c,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},e=l({},f,e)),r(i,e,[{lineWidth:function(e){return .5*+e},capSize:function(e){return .5*+e},opacity:parseFloat,errors:function(e){return e=s(e),d+=e.length,e},positions:function(e,o){return e=s(e,"float64"),o.count=ea(e.length/2),o.bounds=a(e,2),o.offset=t,t+=o.count,e}},{color:function(e,t){var a=t.count;if(e||(e="transparent"),!Array.isArray(e)||"number"==typeof e[0]){var r=e;e=Array(a);for(var n=0;n<a;n++)e[n]=r}if(e.length<a)throw Error("Not enough colors");for(var l=new Uint8Array(4*a),s=0,d;s<a;s++)d=o(e[s],"uint8"),l.set(d,4*s);return l},range:function(e,t){var a=t.bounds;return e||(e=a),t.scale=[1/(e[2]-e[0]),1/(e[3]-e[1])],t.translate=[-e[0],-e[1]],t.scaleFract=p(t.scale),t.translateFract=p(t.translate),e},viewport:function(e){var t;return Array.isArray(e)?t={x:e[0],y:e[1],width:e[2]-e[0],height:e[3]-e[1]}:e?(t={x:e.x||e.left||0,y:e.y||e.top||0},t.width=e.right?e.right-t.x:e.w||e.width||0,t.height=e.bottom?e.bottom-t.y:e.h||e.height||0):t={x:0,y:0,width:y.drawingBufferWidth,height:y.drawingBufferHeight},t}}]),i):i}),t||d){var u=x.reduce(function(e,t){return e+(t?t.count:0)},0),g=new Float64Array(2*u),h=new Uint8Array(4*u),m=new Float32Array(4*u);x.forEach(function(e){if(e){var t=e.positions,a=e.count,o=e.offset,r=e.color,i=e.errors;a&&(h.set(r,4*o),m.set(i,4*o),g.set(t,2*o))}}),_(c(g)),v(p(g)),w(h),k(m)}}}function m(){_.destroy(),v.destroy(),w.destroy(),k.destroy(),T.destroy()}if("function"==typeof e?(!t&&(t={}),t.regl=e):t=e,t.length&&(t.positions=t),e=t.regl,!e.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var y=e._gl,f={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},x=[],b,_,v,w,k,T;return w=e.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),_=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),v=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),k=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),T=e.buffer({usage:"static",type:"float",data:u}),h(t),b=e({vert:"\n\t\tprecision highp float;\n\n\t\tattribute vec2 position, positionFract;\n\t\tattribute vec4 error;\n\t\tattribute vec4 color;\n\n\t\tattribute vec2 direction, lineOffset, capOffset;\n\n\t\tuniform vec4 viewport;\n\t\tuniform float lineWidth, capSize;\n\t\tuniform vec2 scale, scaleFract, translate, translateFract;\n\n\t\tvarying vec4 fragColor;\n\n\t\tvoid main() {\n\t\t\tfragColor = color / 255.;\n\n\t\t\tvec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;\n\n\t\t\tvec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;\n\n\t\t\tvec2 position = position + dxy;\n\n\t\t\tvec2 pos = (position + translate) * scale\n\t\t\t\t+ (positionFract + translateFract) * scale\n\t\t\t\t+ (position + translate) * scaleFract\n\t\t\t\t+ (positionFract + translateFract) * scaleFract;\n\n\t\t\tpos += pixelOffset / viewport.zw;\n\n\t\t\tgl_Position = vec4(pos * 2. - 1., 0, 1);\n\t\t}\n\t\t",frag:"\n\t\tprecision mediump float;\n\n\t\tvarying vec4 fragColor;\n\n\t\tuniform float opacity;\n\n\t\tvoid main() {\n\t\t\tgl_FragColor = fragColor;\n\t\t\tgl_FragColor.a *= opacity;\n\t\t}\n\t\t",uniforms:{range:e.prop("range"),lineWidth:e.prop("lineWidth"),capSize:e.prop("capSize"),opacity:e.prop("opacity"),scale:e.prop("scale"),translate:e.prop("translate"),scaleFract:e.prop("scaleFract"),translateFract:e.prop("translateFract"),viewport:function(e,t){return[t.viewport.x,t.viewport.y,e.viewportWidth,e.viewportHeight]}},attributes:{color:{buffer:w,offset:function(e,t){return 4*t.offset},divisor:1},position:{buffer:_,offset:function(e,t){return 8*t.offset},divisor:1},positionFract:{buffer:v,offset:function(e,t){return 8*t.offset},divisor:1},error:{buffer:k,offset:function(e,t){return 16*t.offset},divisor:1},direction:{buffer:T,stride:24,offset:0},lineOffset:{buffer:T,stride:24,offset:8},capOffset:{buffer:T,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:e.prop("viewport")},viewport:e.prop("viewport"),stencil:!1,instances:e.prop("count"),count:u.length}),l(i,{update:h,draw:d,destroy:m,regl:e,gl:y,canvas:y.canvas,groups:x}),i};var u=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":53,"color-normalize":108,"flatten-vertex-data":216,"object-assign":437,"pick-by-alias":448,"to-float32":514,"update-diff":525}],474:[function(e,t){"use strict";function a(e,t){if(!(this instanceof a))return new a(e,t);if("function"==typeof e?(!t&&(t={}),t.regl=e):t=e,t.length&&(t.positions=t),e=t.regl,!e.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=e._gl,this.regl=e,this.passes=[],this.shaders=a.shaders.has(e)?a.shaders.get(e):a.shaders.set(e,a.createShaders(e)).get(e),this.update(t)}var r=e("color-normalize"),i=e("array-bounds"),n=e("object-assign"),l=e("glslify"),s=e("pick-by-alias"),d=e("flatten-vertex-data"),c=e("earcut"),p=e("array-normalize"),u=e("to-float32"),g=u.float32,h=u.fract32,m=e("es6-weak-map"),f=e("parse-rect");t.exports=a,a.dashMult=2,a.maxPatternLength=256,a.precisionThreshold=3e6,a.maxPoints=1e4,a.maxLines=2048,a.shaders=new m,a.createShaders=function(e){var t=e.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),a={primitive:"triangle strip",instances:e.prop("count"),count:4,offset:0,uniforms:{miterMode:function(e,t){return"round"===t.join?2:1},miterLimit:e.prop("miterLimit"),scale:e.prop("scale"),scaleFract:e.prop("scaleFract"),translateFract:e.prop("translateFract"),translate:e.prop("translate"),thickness:e.prop("thickness"),dashPattern:e.prop("dashTexture"),opacity:e.prop("opacity"),pixelRatio:e.context("pixelRatio"),id:e.prop("id"),dashSize:e.prop("dashLength"),viewport:function(e,t){return[t.viewport.x,t.viewport.y,e.viewportWidth,e.viewportHeight]},depth:e.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(e,t){return!t.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:e.prop("viewport")},viewport:e.prop("viewport")},o=e(n({vert:l(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;\nattribute vec4 color;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {\n\t// the order is important\n\treturn position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n}\n\nvoid main() {\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineOffset = lineTop * 2. - 1.;\n\n\tvec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);\n\ttangent = normalize(diff * scale * viewport.zw);\n\tvec2 normal = vec2(-tangent.y, tangent.x);\n\n\tvec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart\n\t\t+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd\n\n\t\t+ thickness * normal * .5 * lineOffset / viewport.zw;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n}\n"]),frag:l(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\n\nuniform float dashSize, pixelRatio, thickness, opacity, id;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvoid main() {\n\tfloat alpha = 1.;\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:t,divisor:0,stride:8,offset:0},lineTop:{buffer:t,divisor:0,stride:8,offset:4},aCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:e.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:e.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:e.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},a)),r;try{r=e(n({cull:{enable:!0,face:"back"},vert:l(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, nextCoord, prevCoord;\nattribute vec4 aColor, bColor;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, translate;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\nuniform float miterLimit, miterMode;\n\nvarying vec4 fragColor;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 tangent;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nconst float REVERSE_THRESHOLD = -.875;\nconst float MIN_DIFF = 1e-6;\n\n// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead\n// TODO: precalculate dot products, normalize things beforehead etc.\n// TODO: refactor to rectangular algorithm\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nbool isNaN( float val ){\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nvoid main() {\n\tvec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;\n\n  vec2 adjustedScale;\n  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;\n  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;\n\n  vec2 scaleRatio = adjustedScale * viewport.zw;\n\tvec2 normalWidth = thickness / scaleRatio;\n\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineBot = 1. - lineTop;\n\n\tfragColor = (lineStart * aColor + lineEnd * bColor) / 255.;\n\n\tif (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;\n\n\tif (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);\n\tif (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);\n\n\tvec2 prevDiff = aCoord - prevCoord;\n\tvec2 currDiff = bCoord - aCoord;\n\tvec2 nextDiff = nextCoord - bCoord;\n\n\tvec2 prevTangent = normalize(prevDiff * scaleRatio);\n\tvec2 currTangent = normalize(currDiff * scaleRatio);\n\tvec2 nextTangent = normalize(nextDiff * scaleRatio);\n\n\tvec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);\n\tvec2 currNormal = vec2(-currTangent.y, currTangent.x);\n\tvec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);\n\n\tvec2 startJoinDirection = normalize(prevTangent - currTangent);\n\tvec2 endJoinDirection = normalize(currTangent - nextTangent);\n\n\t// collapsed/unidirectional segment cases\n\t// FIXME: there should be more elegant solution\n\tvec2 prevTanDiff = abs(prevTangent - currTangent);\n\tvec2 nextTanDiff = abs(nextTangent - currTangent);\n\tif (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {\n\t\tstartJoinDirection = currNormal;\n\t}\n\tif (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {\n\t\tendJoinDirection = currNormal;\n\t}\n\tif (aCoord == bCoord) {\n\t\tendJoinDirection = startJoinDirection;\n\t\tcurrNormal = prevNormal;\n\t\tcurrTangent = prevTangent;\n\t}\n\n\ttangent = currTangent;\n\n\t//calculate join shifts relative to normals\n\tfloat startJoinShift = dot(currNormal, startJoinDirection);\n\tfloat endJoinShift = dot(currNormal, endJoinDirection);\n\n\tfloat startMiterRatio = abs(1. / startJoinShift);\n\tfloat endMiterRatio = abs(1. / endJoinShift);\n\n\tvec2 startJoin = startJoinDirection * startMiterRatio;\n\tvec2 endJoin = endJoinDirection * endMiterRatio;\n\n\tvec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;\n\tstartTopJoin = sign(startJoinShift) * startJoin * .5;\n\tstartBotJoin = -startTopJoin;\n\n\tendTopJoin = sign(endJoinShift) * endJoin * .5;\n\tendBotJoin = -endTopJoin;\n\n\tvec2 aTopCoord = aCoord + normalWidth * startTopJoin;\n\tvec2 bTopCoord = bCoord + normalWidth * endTopJoin;\n\tvec2 aBotCoord = aCoord + normalWidth * startBotJoin;\n\tvec2 bBotCoord = bCoord + normalWidth * endBotJoin;\n\n\t//miter anti-clipping\n\tfloat baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));\n\tfloat abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));\n\n\t//prevent close to reverse direction switch\n\tbool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\tbool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\n\tif (prevReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);\n\t\taBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\taTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {\n\t\t//handle miter clipping\n\t\tbTopCoord -= normalWidth * endTopJoin;\n\t\tbTopCoord += normalize(endTopJoin * normalWidth) * baClipping;\n\t}\n\n\tif (nextReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);\n\t\tbBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\tbTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {\n\t\t//handle miter clipping\n\t\taBotCoord -= normalWidth * startBotJoin;\n\t\taBotCoord += normalize(startBotJoin * normalWidth) * abClipping;\n\t}\n\n\tvec2 aTopPosition = (aTopCoord) * adjustedScale + translate;\n\tvec2 aBotPosition = (aBotCoord) * adjustedScale + translate;\n\n\tvec2 bTopPosition = (bTopCoord) * adjustedScale + translate;\n\tvec2 bBotPosition = (bBotCoord) * adjustedScale + translate;\n\n\t//position is normalized 0..1 coord on the screen\n\tvec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;\n\n\tstartCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\tendCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\n\tgl_Position = vec4(position  * 2.0 - 1.0, depth, 1);\n\n\tenableStartMiter = step(dot(currTangent, prevTangent), .5);\n\tenableEndMiter = step(dot(currTangent, nextTangent), .5);\n\n\t//bevel miter cutoffs\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n\n\t//round miter cutoffs\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n}\n"]),frag:l(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\nuniform float dashSize, pixelRatio, thickness, opacity, id, miterMode;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nvoid main() {\n\tfloat alpha = 1., distToStart, distToEnd;\n\tfloat cutoff = thickness * .5;\n\n\t//bevel miter\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToStart + 1., 0.), 1.);\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToEnd + 1., 0.), 1.);\n\t\t}\n\t}\n\n\t// round miter\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - startCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - endCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\t}\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:t,divisor:0,stride:8,offset:0},lineTop:{buffer:t,divisor:0,stride:8,offset:4},aColor:{buffer:e.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:e.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:e.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},a))}catch(t){r=o}var i=e({primitive:"triangle",elements:function(e,t){return t.triangles},offset:0,vert:l(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\n\nuniform vec4 color;\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio, id;\nuniform vec4 viewport;\nuniform float opacity;\n\nvarying vec4 fragColor;\n\nconst float MAX_LINES = 256.;\n\nvoid main() {\n\tfloat depth = (MAX_LINES - 4. - id) / (MAX_LINES);\n\n\tvec2 position = position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n\tfragColor.a *= opacity;\n}\n"]),frag:l(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n\tgl_FragColor = fragColor;\n}\n"]),uniforms:{scale:e.prop("scale"),color:e.prop("fill"),scaleFract:e.prop("scaleFract"),translateFract:e.prop("translateFract"),translate:e.prop("translate"),opacity:e.prop("opacity"),pixelRatio:e.context("pixelRatio"),id:e.prop("id"),viewport:function(e,t){return[t.viewport.x,t.viewport.y,e.viewportWidth,e.viewportHeight]}},attributes:{position:{buffer:e.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:e.prop("positionFractBuffer"),stride:8,offset:8}},blend:a.blend,depth:{enable:!1},scissor:a.scissor,stencil:a.stencil,viewport:a.viewport});return{fill:i,rect:o,miter:r}},a.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},a.prototype.render=function(){for(var e=[],t=arguments.length,a;t--;)e[t]=arguments[t];e.length&&(a=this).update.apply(a,e),this.draw()},a.prototype.draw=function(){for(var e=this,t=[],o=arguments.length;o--;)t[o]=arguments[o];return(t.length?t:this.passes).forEach(function(t){var o;return t&&Array.isArray(t)?(o=e).draw.apply(o,t):void(("number"==typeof t&&(t=e.passes[t]),!!(t&&1<t.count&&t.opacity))&&(e.regl._refresh(),t.fill&&t.triangles&&2<t.triangles.length&&e.shaders.fill(t),t.thickness&&(t.scale[0]*t.viewport.width>a.precisionThreshold||t.scale[1]*t.viewport.height>a.precisionThreshold?e.shaders.rect(t):"rect"===t.join||!t.join&&(2>=t.thickness||t.count>=a.maxPoints)?e.shaders.rect(t):e.shaders.miter(t))))}),this},a.prototype.update=function(e){var t=this;if(e){null==e.length?!Array.isArray(e)&&(e=[e]):"number"==typeof e[0]&&(e=[{positions:e}]);var o=this,u=o.regl,m=o.gl;if(e.forEach(function(e,b){var _=t.passes[b];if(void 0!==e){if(null===e)return void(t.passes[b]=null);if("number"==typeof e[0]&&(e={positions:e}),e=s(e,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow"}),_||(t.passes[b]=_={id:b,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:u.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:u.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:u.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:u.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},e=n({},a.defaults,e)),null!=e.thickness&&(_.thickness=parseFloat(e.thickness)),null!=e.opacity&&(_.opacity=parseFloat(e.opacity)),null!=e.miterLimit&&(_.miterLimit=parseFloat(e.miterLimit)),null!=e.overlay&&(_.overlay=!!e.overlay,b<a.maxLines&&(_.depth=2*(a.maxLines-1-b%a.maxLines)/a.maxLines-1)),null!=e.join&&(_.join=e.join),null!=e.hole&&(_.hole=e.hole),null!=e.fill&&(_.fill=e.fill?r(e.fill,"uint8"):null),null!=e.viewport&&(_.viewport=f(e.viewport)),_.viewport||(_.viewport=f([m.drawingBufferWidth,m.drawingBufferHeight])),null!=e.close&&(_.close=e.close),null===e.positions&&(e.positions=[]),e.positions){var v,w;if(e.positions.x&&e.positions.y){var T=e.positions.x,A=e.positions.y;w=_.count=va(T.length,A.length),v=new Float64Array(2*w);for(var S=0;S<w;S++)v[2*S]=T[S],v[2*S+1]=A[S]}else v=d(e.positions,"float64"),w=_.count=ea(v.length/2);var C=_.bounds=i(v,2);if(_.fill){for(var L=[],E={},z=0,I=0,D=0,P=_.count;I<P;I++){var l=v[2*I],O=v[2*I+1];isNaN(l)||isNaN(O)||null==l||null==O?(l=v[2*z],O=v[2*z+1],E[I]=z):z=I,L[D++]=l,L[D++]=O}for(var R=c(L,_.hole||[]),M=0,B=R.length;M<B;M++)null!=E[R[M]]&&(R[M]=E[R[M]]);_.triangles=R}var F=new Float64Array(v);p(F,2,C);var N=new Float64Array(2*w+6);_.close?v[0]===v[2*w-2]&&v[1]===v[2*w-1]?(N[0]=F[2*w-4],N[1]=F[2*w-3]):(N[0]=F[2*w-2],N[1]=F[2*w-1]):(N[0]=F[0],N[1]=F[1]),N.set(F,2),_.close?v[0]===v[2*w-2]&&v[1]===v[2*w-1]?(N[2*w+2]=F[2],N[2*w+3]=F[3],_.count-=1):(N[2*w+2]=F[0],N[2*w+3]=F[1],N[2*w+4]=F[2],N[2*w+5]=F[3]):(N[2*w+2]=F[2*w-2],N[2*w+3]=F[2*w-1],N[2*w+4]=F[2*w-2],N[2*w+5]=F[2*w-1]),_.positionBuffer(g(N)),_.positionFractBuffer(h(N))}if(e.range?_.range=e.range:!_.range&&(_.range=_.bounds),(e.range||e.positions)&&_.count){var V=_.bounds,U=V[2]-V[0],H=V[3]-V[1],G=_.range[2]-_.range[0],Y=_.range[3]-_.range[1];_.scale=[U/G,H/Y],_.translate=[-_.range[0]/G+V[0]/G||0,-_.range[1]/Y+V[1]/Y||0],_.scaleFract=h(_.scale),_.translateFract=h(_.translate)}if(e.dashes){var q=0,W;if(!e.dashes||2>e.dashes.length)q=1,W=new Uint8Array([255,255,255,255,255,255,255,255]);else{q=0;for(var X=0;X<e.dashes.length;++X)q+=e.dashes[X];W=new Uint8Array(q*a.dashMult);for(var Z=0,$=255,J=0;2>J;J++)for(var K=0;K<e.dashes.length;++K){for(var Q=0,ee=.5*(e.dashes[K]*a.dashMult);Q<ee;++Q)W[Z++]=$;$^=255}}_.dashLength=q,_.dashTexture({channels:1,data:W,width:W.length,height:1,mag:"linear",min:"linear"},0,0)}if(e.color){var te=_.count,ae=e.color;ae||(ae="transparent");var oe=new Uint8Array(4*te+4);if(!Array.isArray(ae)||"number"==typeof ae[0])for(var re=r(ae,"uint8"),ie=0;ie<te+1;ie++)oe.set(re,4*ie);else{for(var ne=0,le;ne<te;ne++)le=r(ae[ne],"uint8"),oe.set(le,4*ne);oe.set(r(ae[0],"uint8"),4*te)}_.colorBuffer({usage:"dynamic",type:"uint8",data:oe})}}}),e.length<this.passes.length){for(var l=e.length,y;l<this.passes.length;l++)(y=t.passes[l],!!y)&&(y.colorBuffer.destroy(),y.positionBuffer.destroy(),y.dashTexture.destroy());this.passes.length=e.length}for(var x=[],b=0;b<this.passes.length;b++)null!==t.passes[b]&&x.push(t.passes[b]);return this.passes=x,this}},a.prototype.destroy=function(){return this.passes.forEach(function(e){e.colorBuffer.destroy(),e.positionBuffer.destroy(),e.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":53,"array-normalize":54,"color-normalize":108,earcut:156,"es6-weak-map":209,"flatten-vertex-data":216,glslify:392,"object-assign":437,"parse-rect":442,"pick-by-alias":448,"to-float32":514}],475:[function(e,t){"use strict";function a(e,t){return n(e)||s(e,t)||c()}function o(e){return r(e)||l(e)||d()}function r(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}}function n(e){if(Array.isArray(e))return e}function l(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function s(e,t){var a=[],o=!0,r=!1,i=void 0;try{for(var n=e[Symbol.iterator](),l;!(o=(l=n.next()).done)&&(a.push(l.value),!(t&&a.length===t));o=!0);}catch(e){r=!0,i=e}finally{try{o||null==n["return"]||n["return"]()}finally{if(r)throw i}}return a}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function p(e,t){var a=this;if(!(this instanceof p))return new p(e,t);"function"==typeof e?(!t&&(t={}),t.regl=e):(t=e,e=null),t&&t.length&&(t.positions=t),e=t.regl;var o=e._gl,r=[],i=255,n;this.tooManyColors=v,n=e.texture({data:new Uint8Array(4*i),width:i,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),y(this,{regl:e,gl:o,groups:[],markerCache:[null],markerTextures:[null],palette:r,paletteIds:{},paletteTexture:n,maxColors:i,maxSize:100,canvas:o.canvas}),this.update(t);var l={uniforms:{pixelRatio:e.context("pixelRatio"),palette:n,paletteSize:function(){return[a.tooManyColors?0:i,n.height]},scale:e.prop("scale"),scaleFract:e.prop("scaleFract"),translate:e.prop("translate"),translateFract:e.prop("translateFract"),opacity:e.prop("opacity"),marker:e.prop("markerTexture")},attributes:{x:function(e,t){return t.xAttr||{buffer:t.positionBuffer,stride:8,offset:0}},y:function(e,t){return t.yAttr||{buffer:t.positionBuffer,stride:8,offset:4}},xFract:function(e,t){return t.xAttr?{constant:[0,0]}:{buffer:t.positionFractBuffer,stride:8,offset:0}},yFract:function(e,t){return t.yAttr?{constant:[0,0]}:{buffer:t.positionFractBuffer,stride:8,offset:4}},size:function(e,t){return t.size.length?{buffer:t.sizeBuffer,stride:2,offset:0}:{constant:[R(255*t.size/a.maxSize)]}},borderSize:function(e,t){return t.borderSize.length?{buffer:t.sizeBuffer,stride:2,offset:1}:{constant:[R(255*t.borderSize/a.maxSize)]}},colorId:function(e,t){return t.color.length?{buffer:t.colorBuffer,stride:a.tooManyColors?8:4,offset:0}:{constant:a.tooManyColors?r.slice(4*t.color,4*t.color+4):[t.color]}},borderColorId:function(e,t){return t.borderColor.length?{buffer:t.colorBuffer,stride:a.tooManyColors?8:4,offset:a.tooManyColors?4:2}:{constant:a.tooManyColors?r.slice(4*t.borderColor,4*t.borderColor+4):[t.borderColor]}},isActive:function(e,t){return!0===t.activation?{constant:[1]}:t.activation?t.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:e.prop("viewport")},viewport:e.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:e.prop("elements"),count:e.prop("count"),offset:e.prop("offset"),primitive:"points"},s=y({},l);s.frag=f(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragWidth, fragBorderColorLevel, fragColorLevel;\n\nuniform sampler2D marker;\nuniform float pixelRatio, opacity;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float dist = texture2D(marker, gl_PointCoord).r, delta = fragWidth;\n\n  // max-distance alpha\n  if (dist < 0.003) discard;\n\n  // null-border case\n  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {\n    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);\n    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);\n  }\n  else {\n    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);\n    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);\n\n    vec4 color = fragBorderColor;\n    color.a *= borderColorAmt;\n    color = mix(color, fragColor, colorAmt);\n    color.a *= opacity;\n\n    gl_FragColor = color;\n  }\n\n}\n"]),s.vert=f(["precision mediump float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform vec2 scale, scaleFract, translate, translateFract, paletteSize;\nuniform float pixelRatio;\nuniform sampler2D palette;\n\nconst float maxSize = 100.;\nconst float borderLevel = .5;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(palette,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = 2. * size * pixelRatio;\n  fragPointSize = size * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0, 1);\n\n  fragColor = color;\n  fragBorderColor = borderColor;\n  fragWidth = 1. / gl_PointSize;\n\n  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);\n  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);\n}"]),this.drawMarker=e(s);var d=y({},l);d.frag=f(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\n\nuniform float opacity;\nvarying float fragBorderRadius, fragWidth;\n\nfloat smoothStep(float edge0, float edge1, float x) {\n\tfloat t;\n\tt = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n\treturn t * t * (3.0 - 2.0 * t);\n}\n\nvoid main() {\n\tfloat radius, alpha = 1.0, delta = fragWidth;\n\n\tradius = length(2.0 * gl_PointCoord.xy - 1.0);\n\n\tif (radius > 1.0 + delta) {\n\t\tdiscard;\n\t}\n\n\talpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);\n\n\tfloat borderRadius = fragBorderRadius;\n\tfloat ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);\n\tvec4 color = mix(fragColor, fragBorderColor, ratio);\n\tcolor.a *= alpha * opacity;\n\tgl_FragColor = color;\n}\n"]),d.vert=f(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio;\nuniform sampler2D palette;\nuniform vec2 paletteSize;\n\nconst float maxSize = 100.;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(palette,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = (size + borderSize) * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0, 1);\n\n  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);\n  fragColor = color;\n  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;\n  fragWidth = 1. / gl_PointSize;\n}\n"]),v&&(d.frag=d.frag.replace("smoothstep","smoothStep"),s.frag=s.frag.replace("smoothstep","smoothStep")),this.drawCircle=e(d)}var u=e("color-normalize"),g=e("array-bounds"),h=e("color-id"),m=e("point-cluster"),y=e("object-assign"),f=e("glslify"),x=e("pick-by-alias"),b=e("update-diff"),_=e("flatten-vertex-data"),v=e("is-iexplorer"),i=e("to-float32"),w=e("parse-rect");p.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},p.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},p.prototype.draw=function(){for(var e=this,t=arguments.length,a=Array(t),o=0;o<t;o++)a[o]=arguments[o];var r=this.groups;if(1===a.length&&Array.isArray(a[0])&&(null===a[0][0]||Array.isArray(a[0][0]))&&(a=a[0]),this.regl._refresh(),a.length)for(var n=0;n<a.length;n++)this.drawItem(n,a[n]);else r.forEach(function(t,a){e.drawItem(a)});return this},p.prototype.drawItem=function(e,t){var a=this.groups,r=a[e];if("number"==typeof t&&(e=t,r=a[t],t=null),!!(r&&r.count&&r.opacity)){r.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,r,t));for(var n=[],l=1;l<r.activation.length;l++)r.activation[l]&&(!0===r.activation[l]||r.activation[l].data.length)&&n.push.apply(n,o(this.getMarkerDrawOptions(l,r,t)));n.length&&this.drawMarker(n)}},p.prototype.getMarkerDrawOptions=function(e,t,o){var r=t.range,n=t.tree,s=t.viewport,d=t.activation,c=t.selectionBuffer,p=t.count,u=this.regl;if(!n)return o?[y({},t,{markerTexture:this.markerTextures[e],activation:d[e],count:o.length,elements:o,offset:0})]:[y({},t,{markerTexture:this.markerTextures[e],activation:d[e],offset:0})];var g=[],h=n.range(r,{lod:!0,px:[(r[2]-r[0])/s.width,(r[3]-r[1])/s.height]});if(o){for(var m=d[e],f=m.data,x=new Uint8Array(p),b=0,_;b<o.length;b++)_=o[b],x[_]=f?f[_]:1;c.subdata(x)}for(var v=h.length;v--;){var w=a(h[v],2),k=w[0],T=w[1];g.push(y({},t,{markerTexture:this.markerTextures[e],activation:o?c:d[e],offset:k,count:T-k}))}return g},p.prototype.update=function(){for(var e=this,t=arguments.length,a=Array(t),o=0;o<t;o++)a[o]=arguments[o];if(a.length){1===a.length&&Array.isArray(a[0])&&(a=a[0]);var r=this.groups,n=this.gl,l=this.regl,s=this.maxSize,d=this.maxColors,c=this.palette;this.groups=r=a.map(function(t,a){var o=r[a];if(void 0===t)return o;null===t?t={positions:null}:"function"==typeof t?t={ondraw:t}:"number"==typeof t[0]&&(t={positions:t}),t=x(t,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"}),null===t.positions&&(t.positions=[]),null!=t.tooManyColors&&(e.tooManyColors=t.tooManyColors),o||(r[a]=o={id:a,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:l.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:l.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:l.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:l.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:l.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},t=y({},p.defaults,t)),t.positions&&!("marker"in t)&&(t.marker=o.marker,delete o.marker),t.marker&&!("positions"in t)&&(t.positions=o.positions,delete o.positions);var u=0,h=0;if(b(o,t,[{snap:!0,size:function(e){return null==e&&(e=p.defaults.size),u+=e&&e.length?1:0,e},borderSize:function(e){return null==e&&(e=p.defaults.borderSize),u+=e&&e.length?1:0,e},opacity:parseFloat,color:function(t){return null==t&&(t=p.defaults.color),t=e.updateColor(t),h++,t},borderColor:function(t){return null==t&&(t=p.defaults.borderColor),t=e.updateColor(t),h++,t},bounds:function(e,t,a){return"range"in a||(a.range=null),e},positions:function(e,t,a){var o=t.snap,r=t.positionBuffer,n=t.positionFractBuffer,s=t.selectionBuffer;if(e.x||e.y)return t.xAttr=e.x.length?{buffer:l.buffer(e.x),offset:0,stride:4,count:e.x.length}:{buffer:e.x.buffer,offset:4*e.x.offset||0,stride:4*(e.x.stride||1),count:e.x.count},t.yAttr=e.y.length?{buffer:l.buffer(e.y),offset:0,stride:4,count:e.y.length}:{buffer:e.y.buffer,offset:4*e.y.offset||0,stride:4*(e.y.stride||1),count:e.y.count},t.count=va(t.xAttr.count,t.yAttr.count),e;e=_(e,"float64");var d=t.count=ea(e.length/2),c=t.bounds=d?g(e,2):null;if(a.range||t.range||(delete t.range,a.range=c),a.marker||t.marker||(delete t.marker,a.marker=null),o&&(!0===o||d>o)?t.tree=m(e,{bounds:c}):o&&o.length&&(t.tree=o),t.tree){var p={primitive:"points",usage:"static",data:t.tree,type:"uint32"};t.elements?t.elements(p):t.elements=l.elements(p)}return r({data:i.float(e),usage:"dynamic"}),n({data:i.fract(e),usage:"dynamic"}),s({data:new Uint8Array(d),type:"uint8",usage:"stream"}),e}},{marker:function(t,a){var o=a.activation;if(o.forEach(function(e){return e&&e.destroy&&e.destroy()}),o.length=0,!t||"number"==typeof t[0]){var r=e.addMarker(t);o[r]=!0}else{for(var i=[],n=0,s=ie(t.length,a.count),d;n<s;n++)d=e.addMarker(t[n]),i[d]||(i[d]=new Uint8Array(a.count)),i[d][n]=1;for(var c=0;c<i.length;c++)if(i[c]){var p={data:i[c],type:"uint8",usage:"static"};o[c]?o[c](p):o[c]=l.buffer(p),o[c].data=i[c]}}return t},range:function(e,t){var a=t.bounds;if(a)return e||(e=a),t.scale=[1/(e[2]-e[0]),1/(e[3]-e[1])],t.translate=[-e[0],-e[1]],t.scaleFract=i.fract(t.scale),t.translateFract=i.fract(t.translate),e},viewport:function(e){var t=w(e||[n.drawingBufferWidth,n.drawingBufferHeight]);return t}}]),u){var f=o,v=f.count,k=f.size,T=f.borderSize,A=f.sizeBuffer,S=new Uint8Array(2*v);if(k.length||T.length)for(var C=0;C<v;C++)S[2*C]=R(255*(null==k[C]?k:k[C])/s),S[2*C+1]=R(255*(null==T[C]?T:T[C])/s);A({data:S,usage:"dynamic"})}if(h){var L=o,E=L.count,z=L.color,I=L.borderColor,D=L.colorBuffer,P;if(e.tooManyColors){if(z.length||I.length){P=new Uint8Array(8*E);for(var O=0,M;O<E;O++){M=z[O],P[8*O]=c[4*M],P[8*O+1]=c[4*M+1],P[8*O+2]=c[4*M+2],P[8*O+3]=c[4*M+3];var j=I[O];P[8*O+4]=c[4*j],P[8*O+5]=c[4*j+1],P[8*O+6]=c[4*j+2],P[8*O+7]=c[4*j+3]}}}else if(z.length||I.length){P=new Uint8Array(4*E+2);for(var B=0;B<E;B++)null!=z[B]&&(P[4*B]=z[B]%d,P[4*B+1]=ea(z[B]/d)),null!=I[B]&&(P[4*B+2]=I[B]%d,P[4*B+3]=ea(I[B]/d))}D({data:P||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return o})}},p.prototype.addMarker=function(e){var t=this.markerTextures,a=this.regl,o=this.markerCache,r=null==e?0:o.indexOf(e);if(0<=r)return r;var n;if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)n=e;else{n=new Uint8Array(e.length);for(var s=0,d=e.length;s<d;s++)n[s]=255*e[s]}var l=ea(re(n.length));return r=t.length,o.push(e),t.push(a.texture({channels:1,data:n,radius:l,mag:"linear",min:"linear"})),r},p.prototype.updateColor=function(e){var t=this.paletteIds,a=this.palette,o=this.maxColors;Array.isArray(e)||(e=[e]);var r=[];if("number"==typeof e[0]){var n=[];if(Array.isArray(e))for(var l=0;l<e.length;l+=4)n.push(e.slice(l,l+4));else for(var s=0;s<e.length;s+=4)n.push(e.subarray(s,s+4));e=n}for(var d=0,c;d<e.length;d++){c=e[d],c=u(c,"uint8");var p=h(c,!1);if(null==t[p]){var g=a.length;t[p]=ea(g/4),a[g]=c[0],a[g+1]=c[1],a[g+2]=c[2],a[g+3]=c[3]}r[d]=t[p]}return!this.tooManyColors&&a.length>4*o&&(this.tooManyColors=!0),this.updatePalette(a),1===r.length?r[0]:r},p.prototype.updatePalette=function(e){if(!this.tooManyColors){var t=this.maxColors,a=this.paletteTexture,o=ae(.25*e.length/t);if(1<o){e=e.slice();for(var r=.25*e.length%t;r<o*t;r++)e.push(0,0,0,0)}a.height<o&&a.resize(t,o),a.subimage({width:ie(.25*e.length,t),height:o,data:e},0,0)}},p.prototype.destroy=function(){return this.groups.forEach(function(e){e.sizeBuffer.destroy(),e.positionBuffer.destroy(),e.positionFractBuffer.destroy(),e.colorBuffer.destroy(),e.activation.forEach(function(e){return e&&e.destroy&&e.destroy()}),e.selectionBuffer.destroy(),e.elements&&e.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(e){return e&&e.destroy&&e.destroy()}),this};var k=e("object-assign");t.exports=function(e,t){var a=new p(e,t),o=a.render.bind(a);return k(o,{render:o,update:a.update.bind(a),draw:a.draw.bind(a),destroy:a.destroy.bind(a),regl:a.regl,gl:a.gl,canvas:a.gl.canvas,groups:a.groups,markers:a.markerCache,palette:a.palette}),o}},{"array-bounds":53,"color-id":106,"color-normalize":108,"flatten-vertex-data":216,glslify:476,"is-iexplorer":402,"object-assign":437,"parse-rect":442,"pick-by-alias":448,"point-cluster":452,"to-float32":514,"update-diff":525}],476:[function(e,t,a){arguments[4][392][0].apply(a,arguments)},{dup:392}],477:[function(e,t){"use strict";function a(e,t){return this instanceof a?void(this.traces=[],this.passes={},this.regl=e,this.scatter=s(e),this.canvas=this.scatter.canvas):new a(e,t)}function r(e,t,a){var o=null==e.id?e:e.id;return o<<16|(255&t)<<8|255&a}function i(e,t,a){var o=e[t],r=e[a],i,n,l,s,d,c,p,u;return 2<o.length?(i=o[0],l=o[2],n=o[1],s=o[3]):o.length?(i=n=o[0],l=s=o[1]):(i=o.x,n=o.y,l=o.x+o.width,s=o.y+o.height),2<r.length?(d=r[0],p=r[2],c=r[1],u=r[3]):r.length?(d=c=r[0],p=u=r[1]):(d=r.x,c=r.y,p=r.x+r.width,u=r.y+r.height),[d,n,p,s]}function l(e){if("number"==typeof e)return[e,e,e,e];if(2===e.length)return[e[0],e[1],e[0],e[1]];var t=g(e);return[t.x,t.y,t.x+t.width,t.y+t.height]}var s=e("regl-scatter2d"),d=e("pick-by-alias"),c=e("array-bounds"),p=e("raf"),u=e("array-range"),g=e("parse-rect"),h=e("flatten-vertex-data");t.exports=a,a.prototype.render=function(){for(var e=this,t=[],a=arguments.length,o;a--;)t[a]=arguments[a];return(t.length&&(o=this).update.apply(o,t),this.regl.attributes.preserveDrawingBuffer)?this.draw():(this.dirty?null==this.planned&&(this.planned=p(function(){e.draw(),e.dirty=!0,e.planned=null})):(this.draw(),this.dirty=!0,p(function(){e.dirty=!1})),this)},a.prototype.update=function(){for(var e=this,t=[],a=arguments.length,o;a--;)t[a]=arguments[a];if(t.length){for(var r=0;r<t.length;r++)e.updateItem(r,t[r]);this.traces=this.traces.filter(Boolean);for(var n=[],l=0,s=0;s<this.traces.length;s++){for(var d=e.traces[s],c=e.traces[s].passes,p=0;p<c.length;p++)n.push(e.passes[c[p]]);d.passOffset=l,l+=d.passes.length}return(o=this.scatter).update.apply(o,n),this}},a.prototype.updateItem=function(e,t){var a=this,s=this,p=s.regl;if(null===t)return this.traces[e]=null,this;if(!t)return this;var u=d(t,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),o=this.traces[e]||(this.traces[e]={id:e,buffer:p.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:g([p._gl.drawingBufferWidth,p._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(null!=u.color&&(o.color=u.color),null!=u.size&&(o.size=u.size),null!=u.marker&&(o.marker=u.marker),null!=u.borderColor&&(o.borderColor=u.borderColor),null!=u.borderSize&&(o.borderSize=u.borderSize),null!=u.opacity&&(o.opacity=u.opacity),u.viewport&&(o.viewport=g(u.viewport)),null!=u.diagonal&&(o.diagonal=u.diagonal),null!=u.upper&&(o.upper=u.upper),null!=u.lower&&(o.lower=u.lower),u.data){o.buffer(h(u.data)),o.columns=u.data.length,o.count=u.data[0].length,o.bounds=[];for(var y=0;y<o.columns;y++)o.bounds[y]=c(u.data[y],1)}var f;u.range&&(o.range=u.range,f=o.range&&"number"!=typeof o.range[0]),u.domain&&(o.domain=u.domain);var x=!1;null!=u.padding&&(Array.isArray(u.padding)&&u.padding.length===o.columns&&"number"==typeof u.padding[u.padding.length-1]?(o.padding=u.padding.map(l),x=!0):o.padding=l(u.padding));var b=o.columns,m=o.count,n=o.viewport.width,_=o.viewport.height,v=o.viewport.x,w=o.viewport.y,k=n/b,T=_/b;o.passes=[];for(var A=0;A<b;A++)for(var S=0;S<b;S++)if((o.diagonal||S!=A)&&(o.upper||!(A>S))&&(o.lower||!(A<S))){var C=r(o.id,A,S),L=a.passes[C]||(a.passes[C]={});if(u.data&&(L.positions=u.transpose?{x:{buffer:o.buffer,offset:S,count:m,stride:b},y:{buffer:o.buffer,offset:A,count:m,stride:b}}:{x:{buffer:o.buffer,offset:S*m,count:m},y:{buffer:o.buffer,offset:A*m,count:m}},L.bounds=i(o.bounds,A,S)),u.domain||u.viewport||u.data){var E=x?i(o.padding,A,S):o.padding;if(o.domain){var z=i(o.domain,A,S),I=z[0],D=z[1],P=z[2],O=z[3];L.viewport=[v+I*n+E[0],w+D*_+E[1],v+P*n-E[2],w+O*_-E[3]]}else L.viewport=[v+S*k+k*E[0],w+A*T+T*E[1],v+(S+1)*k-k*E[2],w+(A+1)*T-T*E[3]]}u.color&&(L.color=o.color),u.size&&(L.size=o.size),u.marker&&(L.marker=o.marker),u.borderSize&&(L.borderSize=o.borderSize),u.borderColor&&(L.borderColor=o.borderColor),u.opacity&&(L.opacity=o.opacity),u.range&&(L.range=f?i(o.range,A,S):o.range||L.bounds),o.passes.push(C)}return this},a.prototype.draw=function(){for(var e=this,t=[],a=arguments.length,o;a--;)t[a]=arguments[a];if(!t.length)this.scatter.draw();else{for(var r=[],n=0;n<t.length;n++)if("number"==typeof t[n]){var l=e.traces[t[n]],s=l.passes,d=l.passOffset;r.push.apply(r,u(d,d+s.length))}else if(t[n].length){var c=t[n],p=e.traces[n],g=p.passes,h=p.passOffset;g=g.map(function(e,t){r[h+t]=c})}(o=this.scatter).draw.apply(o,r)}return this},a.prototype.destroy=function(){return this.traces.forEach(function(e){e.buffer&&e.buffer.destroy&&e.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":53,"array-range":55,"flatten-vertex-data":216,"parse-rect":442,"pick-by-alias":448,raf:467,"regl-scatter2d":475}],478:[function(e,t,a){(function(e,o){"object"==typeof a&&"undefined"!=typeof t?t.exports=o():"function"==typeof Ca&&Ca.amd?Ca(o):e.createREGL=o()})(this,function(){function e(e,t){this.id=E++,this.type=e,this.data=t}function t(e){if(0===e.length)return[];var o=e.charAt(0),r=e.charAt(e.length-1);if(1<e.length&&o===r&&("\""===o||"'"===o))return["\""+e.substr(1,e.length-2).replace(/\\/g,"\\\\").replace(/"/g,"\\\"")+"\""];if(o=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e))return t(e.substr(0,o.index)).concat(t(o[1])).concat(t(e.substr(o.index+o[0].length)));if(o=e.split("."),1===o.length)return["\""+e.replace(/\\/g,"\\\\").replace(/"/g,"\\\"")+"\""];for(e=[],r=0;r<o.length;++r)e=e.concat(t(o[r]));return e}function o(e){return"["+t(e).join("][")+"]"}function i(){var t={"":0},o=[""];return{id:function(a){var r=t[a];return r?r:(r=t[a]=o.length,o.push(a),r)},str:function(e){return o[e]}}}function a(t,a,o){function r(){var a=window.innerWidth,r=window.innerHeight;t!==document.body&&(r=t.getBoundingClientRect(),a=r.right-r.left,r=r.bottom-r.top),i.width=o*a,i.height=o*r,te(i.style,{width:a+"px",height:r+"px"})}var i=document.createElement("canvas");return te(i.style,{border:0,margin:0,padding:0,top:0,left:0}),t.appendChild(i),t===document.body&&(i.style.position="absolute",te(t.style,{margin:0,padding:0})),window.addEventListener("resize",r,!1),r(),{canvas:i,onDestroy:function(){window.removeEventListener("resize",r),t.removeChild(i)}}}function n(e,t){function a(a){try{return e.getContext(a,t)}catch(e){return null}}return a("webgl")||a("experimental-webgl")||a("webgl-experimental")}function l(e){return"string"==typeof e?e.split():e}function s(e){return"string"==typeof e?document.querySelector(e):e}function p(o){var i=o||{},p,u,h,y;o={};var x=[],b=[],_="undefined"==typeof window?1:window.devicePixelRatio,v=!1,w=function(){},k=function(){};if("string"==typeof i?p=document.querySelector(i):"object"==typeof i&&("string"==typeof i.nodeName&&"function"==typeof i.appendChild&&"function"==typeof i.getBoundingClientRect?p=i:"function"==typeof i.drawArrays||"function"==typeof i.drawElements?(y=i,h=y.canvas):("gl"in i?y=i.gl:"canvas"in i?h=s(i.canvas):"container"in i&&(u=s(i.container)),"attributes"in i&&(o=i.attributes),"extensions"in i&&(x=l(i.extensions)),"optionalExtensions"in i&&(b=l(i.optionalExtensions)),"onDone"in i&&(w=i.onDone),"profile"in i&&(v=!!i.profile),"pixelRatio"in i&&(_=+i.pixelRatio))),p&&("canvas"===p.nodeName.toLowerCase()?h=p:u=p),!y){if(!h){if(p=a(u||document.body,w,_),!p)return null;h=p.canvas,k=p.onDestroy}y=n(h,o)}return y?{gl:y,canvas:h,container:u,extensions:x,optionalExtensions:b,pixelRatio:_,profile:v,onDone:w,onDestroy:k}:(k(),w("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function _(t,a){function o(e){e=e.toLowerCase();var a;try{a=r[e]=t.getExtension(e)}catch(e){}return!!a}for(var r={},e=0,i;e<a.extensions.length;++e)if(i=a.extensions[e],!o(i))return a.onDestroy(),a.onDone("\""+i+"\" extension is not supported by the current WebGL context, try upgrading your system or a different browser"),null;return a.optionalExtensions.forEach(o),{extensions:r,restore:function(){Object.keys(r).forEach(function(e){if(r[e]&&!o(e))throw Error("(regl): error restoring extension "+e)})}}}function z(t,a){for(var o=Array(t),r=0;r<t;++r)o[r]=a(r);return o}function r(e){var t,o;return t=(65535<e)<<4,e>>>=t,o=(255<e)<<3,e>>>=o,t|=o,o=(15<e)<<2,e>>>=o,t|=o,o=(3<e)<<1,t|o|e>>>o>>1}function d(){function e(e){a:{for(var t=16;268435456>=t;t*=16)if(e<=t){e=t;break a}e=0}return t=o[r(e)>>2],0<t.length?t.pop():new ArrayBuffer(e)}function t(e){o[r(e.byteLength)>>2].push(e)}var o=z(8,function(){return[]});return{alloc:e,free:t,allocType:function(t,a){var o=null;switch(t){case 5120:o=new Int8Array(e(a),0,a);break;case 5121:o=new Uint8Array(e(a),0,a);break;case 5122:o=new Int16Array(e(2*a),0,a);break;case 5123:o=new Uint16Array(e(2*a),0,a);break;case 5124:o=new Int32Array(e(4*a),0,a);break;case 5125:o=new Uint32Array(e(4*a),0,a);break;case 5126:o=new Float32Array(e(4*a),0,a);break;default:return null;}return o.length===a?o:o.subarray(0,a)},freeType:function(e){t(e.buffer)}}}function T(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||x(e.data))}function u(o,a,i,l,e,s){for(var c=0;c<a;++c)for(var p=o[c],u=0;u<i;++u)for(var g=p[u],h=0;h<l;++h)e[s++]=g[h]}function h(t,a,o,i,e){for(var l=1,s=o+1;s<a.length;++s)l*=a[s];var c=a[o];if(4==a.length-o){var p=a[o+1],r=a[o+2];for(a=a[o+3],s=0;s<c;++s)u(t[s],p,r,a,i,e),e+=l}else for(s=0;s<c;++s)h(t[s],a,o+1,i,e),e+=l}function w(e){return 0|ne[Object.prototype.toString.call(e)]}function k(e,t){for(var a=0;a<t.length;++a)e[a]=t[a]}function A(t,a,o,i,e,l,s){for(var n=0,d=0;d<o;++d)for(var c=0;c<i;++c)t[n++]=a[e*d+l*c+s]}function C(o,a,i,l){function s(e){this.id=n++,this.buffer=o.createBuffer(),this.type=e,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,i.profile&&(this.stats={size:0})}function p(e,t,a){e.byteLength=t.byteLength,o.bufferData(e.type,t,a)}function y(o,a,i,n,s,d){if(o.usage=i,Array.isArray(a)){if(o.dtype=n||5126,0<a.length)if(Array.isArray(a[0])){s=ce(a);for(var e=n=1;e<s.length;++e)n*=s[e];o.dimension=n,a=de(a,s,o.dtype),p(o,a,i),d?o.persistentData=a:re.freeType(a)}else"number"==typeof a[0]?(o.dimension=s,s=re.allocType(o.dtype,a.length),k(s,a),p(o,s,i),d?o.persistentData=s:re.freeType(s)):x(a[0])&&(o.dimension=a[0].length,o.dtype=n||w(a[0])||5126,a=de(a,[a.length,a[0].length],o.dtype),p(o,a,i),d?o.persistentData=a:re.freeType(a));}else if(x(a))o.dtype=n||w(a),o.dimension=s,p(o,a,i),d&&(o.persistentData=new Uint8Array(new Uint8Array(a.buffer)));else if(T(a)){s=a.shape;var c=a.stride,e=a.offset,u=0,g=0,m=0,y=0;1===s.length?(u=s[0],g=1,m=c[0],y=0):2===s.length&&(u=s[0],g=s[1],m=c[0],y=c[1]),o.dtype=n||w(a.data)||5126,o.dimension=g,s=re.allocType(o.dtype,u*g),A(s,a.data,u,g,m,y,e),p(o,s,i),d?o.persistentData=s:re.freeType(s)}}function e(e){a.bufferCount--;for(var t=0,r;t<l.state.length;++t)r=l.state[t],r.buffer===e&&(o.disableVertexAttribArray(t),r.buffer=null);o.deleteBuffer(e.buffer),e.buffer=null,delete g[e.id]}var n=0,g={};s.prototype.bind=function(){o.bindBuffer(this.type,this.buffer)},s.prototype.destroy=function(){e(this)};var d=[];return i.profile&&(a.getTotalBufferSize=function(){var e=0;return Object.keys(g).forEach(function(t){e+=g[t].stats.size}),e}),{create:function(t,r,n,c){function p(t){var a=35044,r=null,n=0,s=0,u=1;return Array.isArray(t)||x(t)||T(t)?r=t:"number"==typeof t?n=0|t:t&&("data"in t&&(r=t.data),"usage"in t&&(a=se[t.usage]),"type"in t&&(s=le[t.type]),"dimension"in t&&(u=0|t.dimension),"length"in t&&(n=0|t.length)),l.bind(),r?y(l,r,a,s,u,c):(n&&o.bufferData(l.type,n,a),l.dtype=s||5121,l.usage=a,l.dimension=u,l.byteLength=n),i.profile&&(l.stats.size=l.byteLength*pe[l.dtype]),p}a.bufferCount++;var l=new s(r);return g[l.id]=l,n||p(t),p._reglType="buffer",p._buffer=l,p.subdata=function(t,a){var r=0|(a||0),i;if(l.bind(),x(t))o.bufferSubData(l.type,r,t);else if(Array.isArray(t)){if(0<t.length)if("number"==typeof t[0]){var n=re.allocType(l.dtype,t.length);k(n,t),o.bufferSubData(l.type,r,n),re.freeType(n)}else(Array.isArray(t[0])||x(t[0]))&&(i=ce(t),n=de(t,i,l.dtype),o.bufferSubData(l.type,r,n),re.freeType(n));}else if(T(t)){i=t.shape;var s=t.stride,c=n=0,u=0,h=0;1===i.length?(n=i[0],c=1,u=s[0],h=0):2===i.length&&(n=i[0],c=i[1],u=s[0],h=s[1]),i=Array.isArray(t.data)?l.dtype:w(t.data),i=re.allocType(i,n*c),A(i,t.data,n,c,u,h,t.offset),o.bufferSubData(l.type,r,i),re.freeType(i)}return p},i.profile&&(p.stats=l.stats),p.destroy=function(){e(l)},p},createStream:function(e,t){var a=d.pop();return a||(a=new s(e)),a.bind(),y(a,t,35040,0,1,!1),a},destroyStream:function(e){d.push(e)},clear:function(){M(g).forEach(e),d.forEach(e)},getBuffer:function(e){return e&&e._buffer instanceof s?e._buffer:null},restore:function(){M(g).forEach(function(e){e.buffer=o.createBuffer(),o.bindBuffer(e.type,e.buffer),o.bufferData(e.type,e.persistentData||e.byteLength,e.usage)})},_initBuffer:y}}function I(o,a,i,s){function e(e){this.id=l++,n[this.id]=this,this.buffer=e,this.primType=4,this.type=this.vertCount=0}function p(t,e,r,n,s,l,c){if(t.buffer.bind(),e){var p=c;c||x(e)&&(!T(e)||x(e.data))||(p=a.oes_element_index_uint?5125:5123),i._initBuffer(t.buffer,e,r,p,3)}else o.bufferData(34963,l,r),t.buffer.dtype=p||5121,t.buffer.usage=r,t.buffer.dimension=3,t.buffer.byteLength=l;if(p=c,!c){switch(t.buffer.dtype){case 5121:case 5120:p=5121;break;case 5123:case 5122:p=5123;break;case 5125:case 5124:p=5125;}t.buffer.dtype=p}t.type=p,e=s,0>e&&(e=t.buffer.byteLength,5123===p?e>>=1:5125===p&&(e>>=2)),t.vertCount=e,e=n,0>n&&(e=4,n=t.buffer.dimension,1===n&&(e=0),2===n&&(e=1),3===n&&(e=4)),t.primType=e}function d(e){s.elementsCount--,delete n[e.id],e.buffer.destroy(),e.buffer=null}var n={},l=0,u={uint8:5121,uint16:5123};a.oes_element_index_uint&&(u.uint32=5125),e.prototype.bind=function(){this.buffer.bind()};var c=[];return{create:function(t){function o(t){if(!t)r(),n.primType=4,n.vertCount=0,n.type=5121;else if("number"==typeof t)r(t),n.primType=4,n.vertCount=0|t,n.type=5121;else{var a=null,i=35044,l=-1,s=-1,d=0,h=0;Array.isArray(t)||x(t)||T(t)?a=t:("data"in t&&(a=t.data),"usage"in t&&(i=se[t.usage]),"primitive"in t&&(l=ue[t.primitive]),"count"in t&&(s=0|t.count),"type"in t&&(h=u[t.type]),"length"in t)?d=0|t.length:(d=s,5123===h||5122===h)?d*=2:(5125===h||5124===h)&&(d*=4),p(n,a,i,l,s,d,h)}return o}var r=i.create(null,34963,!0),n=new e(r._buffer);return s.elementsCount++,o(t),o._reglType="elements",o._elements=n,o.subdata=function(e,t){return r.subdata(e,t),o},o.destroy=function(){d(n)},o},createStream:function(t){var a=c.pop();return a||(a=new e(i.create(null,34963,!0,!1)._buffer)),p(a,t,35040,-1,-1,0,0),a},destroyStream:function(e){c.push(e)},getElements:function(t){return"function"==typeof t&&t._elements instanceof e?t._elements:null},clear:function(){M(n).forEach(d)}}}function g(t){for(var a=re.allocType(5123,t.length),o=0;o<t.length;++o)if(isNaN(t[o]))a[o]=65535;else if(1/0===t[o])a[o]=31744;else if(-Infinity===t[o])a[o]=64512;else{ge[0]=t[o];var r=he[0],i=r>>>31<<15,n=(r<<1>>>24)-127,r=1023&r>>13;a[o]=-24>n?i:-14>n?i+(r+1024>>-14-n):15<n?i+31744:i+(n+15<<10)+r}return a}function v(e){return Array.isArray(e)||x(e)}function c(e){return"[object "+e+"]"}function m(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function O(e){return!!(Array.isArray(e)&&0!==e.length&&v(e[0]))}function R(e){return Object.prototype.toString.call(e)}function j(e){if(!e)return!1;var t=R(e);return!!(0<=we.indexOf(t))||m(e)||O(e)||T(e)}function b(e,t){36193===e.type?(e.data=g(t),re.freeType(t)):e.data=t}function F(t,o,r,i,n,l){if(t="undefined"==typeof Te[t]?fe[t]*ke[o]:Te[t],l&&(t*=6),n){for(i=0;1<=r;)i+=t*r*r,r/=2;return i}return t*r*i}function N(o,a,i,s,c,_,E){function e(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function n(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function r(t,a){if("object"==typeof a&&a){"premultiplyAlpha"in a&&(t.premultiplyAlpha=a.premultiplyAlpha),"flipY"in a&&(t.flipY=a.flipY),"alignment"in a&&(t.unpackAlignment=a.alignment),"colorSpace"in a&&(t.colorSpace=K[a.colorSpace]),"type"in a&&(t.type=Q[a.type]);var o=t.width,r=t.height,i=t.channels,n=!1;"shape"in a?(o=a.shape[0],r=a.shape[1],3===a.shape.length&&(i=a.shape[2],n=!0)):("radius"in a&&(o=r=a.radius),"width"in a&&(o=a.width),"height"in a&&(r=a.height),"channels"in a&&(i=a.channels,n=!0)),t.width=0|o,t.height=0|r,t.channels=0|i,o=!1,"format"in a&&(o=a.format,r=t.internalformat=G[o],t.format=se[r],o in Q&&!("type"in a)&&(t.type=Q[o]),o in U&&(t.compressed=!0),o=!0),!n&&o?t.channels=fe[t.format]:n&&!o&&t.channels!==ye[t.format]&&(t.format=t.internalformat=ye[t.channels])}}function H(e){o.pixelStorei(37440,e.flipY),o.pixelStorei(37441,e.premultiplyAlpha),o.pixelStorei(37443,e.colorSpace),o.pixelStorei(3317,e.unpackAlignment)}function t(){e.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function w(t,a){var o=null;if(j(a)?o=a:a&&(r(t,a),"x"in a&&(t.xOffset=0|a.x),"y"in a&&(t.yOffset=0|a.y),j(a.data)&&(o=a.data)),a.copy){var i=c.viewportWidth,n=c.viewportHeight;t.width=t.width||i-t.xOffset,t.height=t.height||n-t.yOffset,t.needsCopy=!0}else if(!o)t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4;else if(x(o))t.channels=t.channels||4,t.data=o,"type"in a||5121!==t.type||(t.type=0|ne[Object.prototype.toString.call(o)]);else if(m(o)){switch(t.channels=t.channels||4,i=o,n=i.length,t.type){case 5121:case 5123:case 5125:case 5126:n=re.allocType(t.type,n),n.set(i),t.data=n;break;case 36193:t.data=g(i);}t.alignment=1,t.needsFree=!0}else if(T(o)){i=o.data,Array.isArray(i)||5121!==t.type||(t.type=0|ne[Object.prototype.toString.call(i)]);var n=o.shape,s=o.stride,u,y,_,k;3===n.length?(_=n[2],k=s[2]):k=_=1,u=n[0],y=n[1],n=s[0],s=s[1],t.alignment=1,t.width=u,t.height=y,t.channels=_,t.format=t.internalformat=ye[_],t.needsFree=!0,u=k,o=o.offset,_=t.width,k=t.height,y=t.channels;for(var A=re.allocType(36193===t.type?5126:t.type,_*k*y),C=0,E=0;E<k;++E)for(var z=0;z<_;++z)for(var D=0;D<y;++D)A[C++]=i[n*z+s*E+u*D+o];b(t,A)}else if(R(o)===L||R(o)===xe)t.element=R(o)===L?o:o.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(R(o)===be)t.element=o,t.width=o.width,t.height=o.height,t.channels=4;else if(R(o)===_e)t.element=o,t.width=o.naturalWidth,t.height=o.naturalHeight,t.channels=4;else if(R(o)===ve)t.element=o,t.width=o.videoWidth,t.height=o.videoHeight,t.channels=4;else if(O(o)){for(i=t.width||o[0].length,n=t.height||o.length,s=t.channels,s=v(o[0][0])?s||o[0][0].length:s||1,u=S.shape(o),_=1,k=0;k<u.length;++k)_*=u[k];_=re.allocType(36193===t.type?5126:t.type,_),S.flatten(o,u,"",_),b(t,_),t.alignment=1,t.width=i,t.height=n,t.channels=s,t.format=t.internalformat=ye[s],t.needsFree=!0}}function C(e,t,a,r,i){var n=e.element,d=e.data,l=e.internalformat,c=e.format,p=e.type,u=e.width,g=e.height;H(e),n?o.texSubImage2D(t,i,a,r,c,p,n):e.compressed?o.compressedTexSubImage2D(t,i,a,r,l,u,g,d):e.needsCopy?(s(),o.copyTexSubImage2D(t,i,a,r,e.xOffset,e.yOffset,u,g)):o.texSubImage2D(t,i,a,r,u,g,c,p,d)}function k(){return de.pop()||new t}function h(e){e.needsFree&&re.freeType(e.data),t.call(e),de.push(e)}function l(){e.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function u(e,t,a){var o=e.images[0]=k();e.mipmask=1,o.width=e.width=t,o.height=e.height=a,o.channels=e.channels=4}function z(t,a){var o=null;if(j(a))o=t.images[0]=k(),n(o,t),w(o,a),t.mipmask=1;else if(r(t,a),Array.isArray(a.mipmap))for(var i=a.mipmap,l=0;l<i.length;++l)o=t.images[l]=k(),n(o,t),o.width>>=l,o.height>>=l,w(o,i[l]),t.mipmask|=1<<l;else o=t.images[0]=k(),n(o,t),w(o,a),t.mipmask=1;n(t,t.images[0])}function I(e,t){for(var a=e.images,r=0;r<a.length&&a[r];++r){var i=a[r],n=t,d=r,l=i.element,c=i.data,u=i.internalformat,g=i.format,m=i.type,y=i.width,x=i.height,b=i.channels;H(i),l?o.texImage2D(n,d,g,g,m,l):i.compressed?o.compressedTexImage2D(n,d,u,y,x,0,c):i.needsCopy?(s(),o.copyTexImage2D(n,d,g,i.xOffset,i.yOffset,y,x,0)):((i=!c)&&(c=re.zero.allocType(m,y*x*b)),o.texImage2D(n,d,g,y,x,0,g,m,c),i&&c&&re.zero.freeType(c))}}function B(){var t=P.pop()||new l;e.call(t);for(var a=t.mipmask=0;16>a;++a)t.images[a]=null;return t}function D(e){for(var t=e.images,a=0;a<t.length;++a)t[a]&&h(t[a]),t[a]=null;P.push(e)}function N(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function y(t,a){"min"in a&&(t.minFilter=V[a.min],0<=me.indexOf(t.minFilter)&&!("faces"in a)&&(t.genMipmaps=!0)),"mag"in a&&(t.magFilter=Y[a.mag]);var o=t.wrapS,r=t.wrapT;if("wrap"in a){var i=a.wrap;"string"==typeof i?o=r=A[i]:Array.isArray(i)&&(o=A[i[0]],r=A[i[1]])}else"wrapS"in a&&(o=A[a.wrapS]),"wrapT"in a&&(r=A[a.wrapT]);if(t.wrapS=o,t.wrapT=r,"anisotropic"in a&&(t.anisotropic=a.anisotropic),"mipmap"in a){switch(o=!1,typeof a.mipmap){case"string":t.mipmapHint=f[a.mipmap],o=t.genMipmaps=!0;break;case"boolean":o=t.genMipmaps=a.mipmap;break;case"object":t.genMipmaps=!1,o=!0;}!o||"min"in a||(t.minFilter=9984)}}function q(e,t){o.texParameteri(t,10241,e.minFilter),o.texParameteri(t,10240,e.magFilter),o.texParameteri(t,10242,e.wrapS),o.texParameteri(t,10243,e.wrapT),a.ext_texture_filter_anisotropic&&o.texParameteri(t,34046,e.anisotropic),e.genMipmaps&&(o.hint(33170,e.mipmapHint),o.generateMipmap(t))}function d(t){e.call(this),this.mipmask=0,this.internalformat=6408,this.id=ce++,this.refCount=1,this.target=t,this.texture=o.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new N,E.profile&&(this.stats={size:0})}function Z(e){o.activeTexture(33984),o.bindTexture(e.target,e.texture)}function $(){var e=ue[0];e?o.bindTexture(e.target,e.texture):o.bindTexture(3553,null)}function p(t){var a=t.texture,r=t.unit,e=t.target;0<=r&&(o.activeTexture(33984+r),o.bindTexture(e,null),ue[r]=null),o.deleteTexture(a),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete pe[t.id],_.textureCount--}var f={"don't care":4352,"dont care":4352,nice:4354,fast:4353},A={repeat:10497,clamp:33071,mirror:33648},Y={nearest:9728,linear:9729},V=te({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Y),K={none:0,browser:37444},Q={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},G={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},U={};a.ext_srgb&&(G.srgb=35904,G.srgba=35906),a.oes_texture_float&&(Q.float32=Q.float=5126),a.oes_texture_half_float&&(Q.float16=Q["half float"]=36193),a.webgl_depth_texture&&(te(G,{depth:6402,"depth stencil":34041}),te(Q,{uint16:5123,uint32:5125,"depth stencil":34042})),a.webgl_compressed_texture_s3tc&&te(U,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),a.webgl_compressed_texture_atc&&te(U,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),a.webgl_compressed_texture_pvrtc&&te(U,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),a.webgl_compressed_texture_etc1&&(U["rgb etc1"]=36196);var W=Array.prototype.slice.call(o.getParameter(34467));Object.keys(U).forEach(function(e){var t=U[e];0<=W.indexOf(t)&&(G[e]=t)});var ee=Object.keys(G);i.textureFormats=ee;var ae=[];Object.keys(G).forEach(function(e){ae[G[e]]=e});var J=[];Object.keys(Q).forEach(function(e){J[Q[e]]=e});var oe=[];Object.keys(Y).forEach(function(e){oe[Y[e]]=e});var ie=[];Object.keys(V).forEach(function(e){ie[V[e]]=e});var le=[];Object.keys(A).forEach(function(e){le[A[e]]=e});var se=ee.reduce(function(e,t){var a=G[t];return e[a]=6409===a||6406===a||6409===a||6410===a||6402===a||34041===a?a:32855===a||0<=t.indexOf("rgba")?6408:6407,e},{}),de=[],P=[],ce=0,pe={},X=i.maxTextureUnits,ue=Array(X).map(function(){return null});return te(d.prototype,{bind:function(){this.bindCount+=1;var t=this.unit;if(0>t){for(var a=0,r;a<X;++a){if(r=ue[a],r){if(0<r.bindCount)continue;r.unit=-1}ue[a]=this,t=a;break}E.profile&&_.maxTextureUnits<t+1&&(_.maxTextureUnits=t+1),this.unit=t,o.activeTexture(33984+t),o.bindTexture(this.target,this.texture)}return t},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&p(this)}}),E.profile&&(_.getTotalTextureSize=function(){var e=0;return Object.keys(pe).forEach(function(t){e+=pe[t].stats.size}),e}),{create2D:function(t,a){function r(t,a){var o=e.texInfo;N.call(o);var i=B();return"number"==typeof t?"number"==typeof a?u(i,0|t,0|a):u(i,0|t,0|t):t?(y(o,t),z(i,t)):u(i,1,1),o.genMipmaps&&(i.mipmask=(i.width<<1)-1),e.mipmask=i.mipmask,n(e,i),e.internalformat=i.internalformat,r.width=i.width,r.height=i.height,Z(e),I(i,3553),q(o,3553),$(),D(i),E.profile&&(e.stats.size=F(e.internalformat,e.type,i.width,i.height,o.genMipmaps,!1)),r.format=ae[e.internalformat],r.type=J[e.type],r.mag=oe[o.magFilter],r.min=ie[o.minFilter],r.wrapS=le[o.wrapS],r.wrapT=le[o.wrapT],r}var e=new d(3553);return pe[e.id]=e,_.textureCount++,r(t,a),r.subimage=function(t,a,o,i){a|=0,o|=0,i|=0;var l=k();return n(l,e),l.width=0,l.height=0,w(l,t),l.width=l.width||(e.width>>i)-a,l.height=l.height||(e.height>>i)-o,Z(e),C(l,3553,a,o,i),$(),h(l),r},r.resize=function(t,a){var i=0|t,n=0|a||i;if(i===e.width&&n===e.height)return r;r.width=e.width=i,r.height=e.height=n,Z(e);for(var l=e.channels,s=e.type,d=0,c;e.mipmask>>d;++d){var u=i>>d,g=n>>d;if(!u||!g)break;c=re.zero.allocType(s,u*g*l),o.texImage2D(3553,d,e.format,u,g,0,e.format,e.type,c),c&&re.zero.freeType(c)}return $(),E.profile&&(e.stats.size=F(e.internalformat,e.type,i,n,!1,!1)),r},r._reglType="texture2d",r._texture=e,E.profile&&(r.stats=e.stats),r.destroy=function(){e.decRef()},r},createCube:function(t,a,i,e,l,s){function g(t,o,i,l,s,e){var d=x.texInfo,c;for(N.call(d),c=0;6>c;++c)m[c]=B();if("number"==typeof t||!t)for(t=0|t||1,c=0;6>c;++c)u(m[c],t,t);else if("object"==typeof t)if(o)z(m[0],t),z(m[1],o),z(m[2],i),z(m[3],l),z(m[4],s),z(m[5],e);else if(y(d,t),r(x,t),"faces"in t)for(t=t.faces,c=0;6>c;++c)n(m[c],x),z(m[c],t[c]);else for(c=0;6>c;++c)z(m[c],t);for(n(x,m[0]),x.mipmask=d.genMipmaps?(m[0].width<<1)-1:m[0].mipmask,x.internalformat=m[0].internalformat,g.width=m[0].width,g.height=m[0].height,Z(x),c=0;6>c;++c)I(m[c],34069+c);for(q(d,34067),$(),E.profile&&(x.stats.size=F(x.internalformat,x.type,g.width,g.height,d.genMipmaps,!0)),g.format=ae[x.internalformat],g.type=J[x.type],g.mag=oe[d.magFilter],g.min=ie[d.minFilter],g.wrapS=le[d.wrapS],g.wrapT=le[d.wrapT],c=0;6>c;++c)D(m[c]);return g}var x=new d(34067);pe[x.id]=x,_.cubeCount++;var m=[,,,,,,];return g(t,a,i,e,l,s),g.subimage=function(t,a,o,r,i){o|=0,r|=0,i|=0;var l=k();return n(l,x),l.width=0,l.height=0,w(l,a),l.width=l.width||(x.width>>i)-o,l.height=l.height||(x.height>>i)-r,Z(x),C(l,34069+t,o,r,i),$(),h(l),g},g.resize=function(e){if(e|=0,e!==x.width){g.width=x.width=e,g.height=x.height=e,Z(x);for(var t=0;6>t;++t)for(var a=0;x.mipmask>>a;++a)o.texImage2D(34069+t,a,x.format,e>>a,e>>a,0,x.format,x.type,null);return $(),E.profile&&(x.stats.size=F(x.internalformat,x.type,g.width,g.height,!1,!0)),g}},g._reglType="textureCube",g._texture=x,E.profile&&(g.stats=x.stats),g.destroy=function(){x.decRef()},g},clear:function(){for(var e=0;e<X;++e)o.activeTexture(33984+e),o.bindTexture(3553,null),ue[e]=null;M(pe).forEach(p),_.cubeCount=0,_.textureCount=0},getTexture:function(){return null},restore:function(){for(var e=0,t;e<X;++e)t=ue[e],t&&(t.bindCount=0,t.unit=-1,ue[e]=null);M(pe).forEach(function(e){e.texture=o.createTexture(),o.bindTexture(e.target,e.texture);for(var t=0;32>t;++t)if(0!=(e.mipmask&1<<t))if(3553===e.target)o.texImage2D(3553,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);else for(var a=0;6>a;++a)o.texImage2D(34069+a,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);q(e.texInfo,e.target)})}}}function H(o,a,i,s,e,p){function g(e,t,o){this.target=e,this.texture=t,this.renderbuffer=o;var r=e=0;t?(e=t.width,r=t.height):o&&(e=o.width,r=o.height),this.width=e,this.height=r}function n(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function _(e){e&&(e.texture?e.texture._texture.refCount+=1:e.renderbuffer._renderbuffer.refCount+=1)}function r(e,t){t&&(t.texture?o.framebufferTexture2D(36160,e,t.target,t.texture._texture.texture,0):o.framebufferRenderbuffer(36160,e,36161,t.renderbuffer._renderbuffer.renderbuffer))}function w(t){var o=3553,r=null,i=null,n=t;return"object"==typeof t&&(n=t.data,"target"in t&&(o=0|t.target)),t=n._reglType,"texture2d"===t?r=n:"textureCube"===t?r=n:"renderbuffer"===t&&(i=n,o=36161),new g(o,r,i)}function t(t,o,r,i,n){return r?(t=s.create2D({width:t,height:o,format:i,type:n}),t._texture.refCount=0,new g(3553,t,null)):(t=e.create({width:t,height:o,format:i}),t._renderbuffer.refCount=0,new g(36161,null,t))}function m(e){return e&&(e.texture||e.renderbuffer)}function T(e,t,a){e&&(e.texture?e.texture.resize(t,a):e.renderbuffer&&e.renderbuffer.resize(t,a),e.width=t,e.height=a)}function d(){this.id=y++,f[this.id]=this,this.framebuffer=o.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function A(e){e.colorAttachments.forEach(n),n(e.depthAttachment),n(e.stencilAttachment),n(e.depthStencilAttachment)}function l(e){o.deleteFramebuffer(e.framebuffer),e.framebuffer=null,p.framebufferCount--,delete f[e.id]}function S(t){var a;o.bindFramebuffer(36160,t.framebuffer);var n=t.colorAttachments;for(a=0;a<n.length;++a)r(36064+a,n[a]);for(a=n.length;a<i.maxColorAttachments;++a)o.framebufferTexture2D(36160,36064+a,3553,null,0);o.framebufferTexture2D(36160,33306,3553,null,0),o.framebufferTexture2D(36160,36096,3553,null,0),o.framebufferTexture2D(36160,36128,3553,null,0),r(36096,t.depthAttachment),r(36128,t.stencilAttachment),r(33306,t.depthStencilAttachment),o.checkFramebufferStatus(36160),o.isContextLost(),o.bindFramebuffer(36160,h.next?h.next.framebuffer:null),h.cur=h.next,o.getError()}function u(o,a){function r(e,a){var o=0,l=0,s=!0,c=!0,p;p=null;var b=!0,C="rgba",L="uint8",z=1,I=null,D=null,P=null,O=!1;"number"==typeof e?(o=0|e,l=0|a||o):e?("shape"in e?(l=e.shape,o=l[0],l=l[1]):("radius"in e&&(o=l=e.radius),"width"in e&&(o=e.width),"height"in e&&(l=e.height)),("color"in e||"colors"in e)&&(p=e.color||e.colors,Array.isArray(p)),!p&&("colorCount"in e&&(z=0|e.colorCount),"colorTexture"in e&&(b=!!e.colorTexture,C="rgba4"),"colorType"in e&&(L=e.colorType,!b)&&("half float"===L||"float16"===L?C="rgba16f":("float"===L||"float32"===L)&&(C="rgba32f")),"colorFormat"in e&&(C=e.colorFormat,0<=v.indexOf(C)?b=!0:0<=x.indexOf(C)&&(b=!1))),("depthTexture"in e||"depthStencilTexture"in e)&&(O=e.depthTexture||e.depthStencilTexture),"depth"in e&&("boolean"==typeof e.depth?s=e.depth:(I=e.depth,c=!1)),"stencil"in e&&("boolean"==typeof e.stencil?c=e.stencil:(D=e.stencil,s=!1)),"depthStencil"in e&&("boolean"==typeof e.depthStencil?s=c=e.depthStencil:(P=e.depthStencil,c=s=!1))):o=l=1;var R=null,M=null,j=null,V=null;if(Array.isArray(p))R=p.map(w);else if(p)R=[w(p)];else for(R=Array(z),p=0;p<z;++p)R[p]=t(o,l,b,C,L);for(o=o||R[0].width,l=l||R[0].height,I?M=w(I):s&&!c&&(M=t(o,l,O,"depth","uint32")),D?j=w(D):c&&!s&&(j=t(o,l,!1,"stencil","uint8")),P?V=w(P):!I&&!D&&c&&s&&(V=t(o,l,O,"depth stencil","depth stencil")),s=null,p=0;p<R.length;++p)_(R[p],o,l),R[p]&&R[p].texture&&(c=Q[R[p].texture._texture.format]*Se[R[p].texture._texture.type],null===s&&(s=c));return _(M,o,l),_(j,o,l),_(V,o,l),A(i),i.width=o,i.height=l,i.colorAttachments=R,i.depthAttachment=M,i.stencilAttachment=j,i.depthStencilAttachment=V,r.color=R.map(m),r.depth=m(M),r.stencil=m(j),r.depthStencil=m(V),r.width=i.width,r.height=i.height,S(i),r}var i=new d;return p.framebufferCount++,r(o,a),te(r,{resize:function(e,t){var a=va(0|e,1),o=va(0|t||a,1);if(a===i.width&&o===i.height)return r;for(var n=i.colorAttachments,l=0;l<n.length;++l)T(n[l],a,o);return T(i.depthAttachment,a,o),T(i.stencilAttachment,a,o),T(i.depthStencilAttachment,a,o),i.width=r.width=a,i.height=r.height=o,S(i),r},_reglType:"framebuffer",_framebuffer:i,destroy:function(){l(i),A(i)},use:function(e){h.setFBO({framebuffer:r},e)}})}var h={cur:null,next:null,dirty:!1,setFBO:null},v=["rgba"],x=["rgba4","rgb565","rgb5 a1"];a.ext_srgb&&x.push("srgba"),a.ext_color_buffer_half_float&&x.push("rgba16f","rgb16f"),a.webgl_color_buffer_float&&x.push("rgba32f");var c=["uint8"];a.oes_texture_half_float&&c.push("half float","float16"),a.oes_texture_float&&c.push("float","float32");var y=0,f={};return te(h,{getFramebuffer:function(e){return"function"==typeof e&&"framebuffer"===e._reglType&&(e=e._framebuffer,e instanceof d)?e:null},create:u,createCube:function(e){function t(e){var r={color:null},i=0,n=null,c;c="rgba";var p="uint8",y=1;if("number"==typeof e?i=0|e:e?("shape"in e?i=e.shape[0]:("radius"in e&&(i=0|e.radius),"width"in e?i=0|e.width:"height"in e&&(i=0|e.height)),("color"in e||"colors"in e)&&(n=e.color||e.colors,Array.isArray(n)),n||("colorCount"in e&&(y=0|e.colorCount),"colorType"in e&&(p=e.colorType),"colorFormat"in e&&(c=e.colorFormat)),"depth"in e&&(r.depth=e.depth),"stencil"in e&&(r.stencil=e.stencil),"depthStencil"in e&&(r.depthStencil=e.depthStencil)):i=1,!n)for(e=Array(y),n={radius:i,format:c,type:p},c=0;c<y;++c)e[c]=s.createCube(n);else if(Array.isArray(n))for(e=[],c=0;c<n.length;++c)e[c]=n[c];else e=[n];for(r.color=Array(e.length),c=0;c<e.length;++c)y=e[c],i=i||y.width,r.color[c]={target:34069,data:e[c]};for(c=0;6>c;++c){for(y=0;y<e.length;++y)r.color[y].target=34069+c;0<c&&(r.depth=o[0].depth,r.stencil=o[0].stencil,r.depthStencil=o[0].depthStencil),o[c]?o[c](r):o[c]=u(r)}return te(t,{width:i,height:i,color:e})}var o=[,,,,,,];return t(e),te(t,{faces:o,resize:function(r){var i=0|r;if(i===t.width)return t;var n=t.color;for(r=0;r<n.length;++r)n[r].resize(i);for(r=0;6>r;++r)o[r].resize(i);return t.width=t.height=i,t},_reglType:"framebufferCube",destroy:function(){o.forEach(function(e){e.destroy()})}})},clear:function(){M(f).forEach(l)},restore:function(){h.cur=null,h.next=null,h.dirty=!0,M(f).forEach(function(e){e.framebuffer=o.createFramebuffer(),S(e)})}})}function f(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function Y(e,t,o){for(e=o.maxAttributes,t=Array(e),o=0;o<e;++o)t[o]=new f;return{Record:f,scope:{},state:t}}function X(o,a,i,l){function e(e,t,a,o){this.name=e,this.id=t,this.location=a,this.info=o}function s(e,t){for(var a=0;a<e.length;++a)if(e[a].id===t.id)return void(e[a].location=t.location);e.push(t)}function d(t,i,n){n=35632===t?r:p;var l=n[i];if(!l){var s=a.str(i),l=o.createShader(t);o.shaderSource(l,s),o.compileShader(l),n[i]=l}return l}function n(e,t){this.id=g++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],l.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function c(i){var n,c;n=d(35632,i.fragId),c=d(35633,i.vertId);var p=i.program=o.createProgram();o.attachShader(p,n),o.attachShader(p,c),o.linkProgram(p);var u=o.getProgramParameter(p,35718);l.profile&&(i.stats.uniformsCount=u);var g=i.uniforms;for(n=0;n<u;++n)if(c=o.getActiveUniform(p,n))if(1<c.size)for(var h=0,f;h<c.size;++h)f=c.name.replace("[0]","["+h+"]"),s(g,new e(f,a.id(f),o.getUniformLocation(p,f),c));else s(g,new e(c.name,a.id(c.name),o.getUniformLocation(p,c.name),c));for(u=o.getProgramParameter(p,35721),l.profile&&(i.stats.attributesCount=u),g=i.attributes,n=0;n<u;++n)(c=o.getActiveAttrib(p,n))&&s(g,new e(c.name,a.id(c.name),o.getAttribLocation(p,c.name),c))}var r={},p={},u={},h=[],g=0;return l.profile&&(i.getMaxUniformsCount=function(){var e=0;return h.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},i.getMaxAttributesCount=function(){var e=0;return h.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var e=o.deleteShader.bind(o);M(r).forEach(e),r={},M(p).forEach(e),p={},h.forEach(function(e){o.deleteProgram(e.program)}),h.length=0,u={},i.shaderCount=0},program:function(t,a,o){var r=u[a];r||(r=u[a]={});var l=r[t];return l||(l=new n(a,t),i.shaderCount++,c(l,o),r[t]=l,h.push(l)),l},restore:function(){r={},p={};for(var e=0;e<h.length;++e)c(h[e])},shader:d,frag:-1,vert:-1}}function $(t,o,a,i){function e(e){var n=null===o.next?5121:o.next.colorAttachments[0].texture._texture.type;var s=0,c=0,p=i.framebufferWidth,u=i.framebufferHeight,m=null;return x(e)?m=e:e&&(s=0|e.x,c=0|e.y,p=0|(e.width||i.framebufferWidth-s),u=0|(e.height||i.framebufferHeight-c),m=e.data||null),a(),e=4*(p*u),m||(5121===n?m=new Uint8Array(e):5126===n&&(m=m||new Float32Array(e))),t.pixelStorei(3333,4),t.readPixels(s,c,p,u,6408,n,m),m}function n(t){var a;return o.setFBO({framebuffer:t.framebuffer},function(){a=e(t)}),a}return function(t){return t&&"framebuffer"in t?n(t):e(t)}}function B(e){return Array.prototype.slice.call(e)}function V(e){return B(e).join("")}function U(){function t(){var e=[],t=[];return te(function(){e.push.apply(e,B(arguments))},{def:function(){var a="v"+r++;return t.push(a),0<arguments.length&&(e.push(a,"="),e.push.apply(e,B(arguments)),e.push(";")),a},toString:function(){return V([0<t.length?"var ;":"",V(e)])}})}function o(){function o(t,a){i(t,a,"=",r.def(t,a),";")}var r=t(),i=t(),a=r.toString,e=i.toString;return te(function(){r.apply(r,B(arguments))},{def:r.def,entry:r,exit:i,save:o,set:function(t,a,i){o(t,a),r(t,a,"=",i,";")},toString:function(){return a()+e()}})}var r=0,i=[],e=[],l=t(),s={};return{global:l,link:function(t){for(var a=0;a<e.length;++a)if(e[a]===t)return i[a];return a="g"+r++,i.push(a),e.push(t),a},block:t,proc:function(t,a){function r(){var e="a"+i.length;return i.push(e),e}var i=[];a=a||0;for(var e=0;e<a;++e)r();var e=o(),n=e.toString;return s[t]=te(e,{arg:r,toString:function(){return V(["function(",i.join(),"){",n(),"}"])}})},scope:o,cond:function(){var t=V(arguments),a=o(),r=o(),i=a.toString,e=r.toString;return te(a,{then:function(){return a.apply(a,B(arguments)),this},else:function(){return r.apply(r,B(arguments)),this},toString:function(){var a=e();return a&&(a="else{"+a+"}"),V(["if(",t,"){",i(),"}",a])}})},compile:function(){var t=["\"use strict\";",l,"return {"];Object.keys(s).forEach(function(e){t.push("\"",e,"\":",s[e].toString(),",")}),t.push("}");var a=V(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,i.concat(a)).apply(null,e)}}}function J(e){return Array.isArray(e)||x(e)||T(e)}function q(e){return e.sort(function(e,t){return"viewport"===e?-1:"viewport"===t?1:e<t?-1:1})}function G(t,a,o,r){this.thisDep=t,this.contextDep=a,this.propDep=o,this.append=r}function W(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function Z(e){return new G(!1,!1,!1,e)}function D(e,t){var a=e.type;return 0===a?(a=e.data.length,new G(!0,1<=a,2<=a,t)):4===a?(a=e.data,new G(a.thisDep,a.contextDep,a.propDep,t)):new G(3===a,2===a,1===a,t)}function ee(o,i,a,s,b,c,e,n,d,r,p,t,g,m,f){function _(e){return e.replace(".","_")}function l(e,t,a){var o=_(e);ce.push(e),de[o]=se[o]=!!a,pe[o]=t}function u(e,t,a){var o=_(e);ce.push(e),Array.isArray(a)?(se[o]=a.slice(),de[o]=a.slice()):se[o]=de[o]=a,ge[o]=t}function w(){var t=U(),o=t.link,n=t.global;t.id=ye++,t.batchId="0";var l=o(he),s=t.shared={props:"a0"};Object.keys(he).forEach(function(e){s[e]=n.def(l,".",e)});var e=t.next={},d=t.current={};Object.keys(ge).forEach(function(t){Array.isArray(se[t])&&(e[t]=n.def(s.next,".",t),d[t]=n.def(s.current,".",t))});var c=t.constants={};Object.keys(me).forEach(function(e){c[e]=n.def(JSON.stringify(me[e]))}),t.invoke=function(a,r){switch(r.type){case 0:var i=["this",s.context,s.props,t.batchId];return a.def(o(r.data),".call(",i.slice(0,va(r.data.length+1,4)),")");case 1:return a.def(s.props,r.data);case 2:return a.def(s.context,r.data);case 3:return a.def("this",r.data);case 4:return r.data.append(t,a),r.data.ref;}},t.attribCache={};var p={};return t.scopeAttrib=function(e){if(e=i.id(e),e in p)return p[e];var t=r.scope[e];return t||(t=r.scope[e]=new re),p[e]=o(t)},t}function C(t){var o=t["static"];t=t.dynamic;var r;if("profile"in o){var i=!!o.profile;r=Z(function(){return i}),r.enable=i}else if("profile"in t){var n=t.profile;r=D(n,function(e,t){return e.invoke(t,n)})}return r}function I(t){var a=t["static"],o=t.dynamic;if("framebuffer"in a){var r=a.framebuffer;return r?(r=n.getFramebuffer(r),Z(function(e,t){var a=e.link(r),o=e.shared;return t.set(o.framebuffer,".next",a),o=o.context,t.set(o,".framebufferWidth",a+".width"),t.set(o,".framebufferHeight",a+".height"),a})):Z(function(e,t){var a=e.shared;return t.set(a.framebuffer,".next","null"),a=a.context,t.set(a,".framebufferWidth",a+".drawingBufferWidth"),t.set(a,".framebufferHeight",a+".drawingBufferHeight"),"null"})}if("framebuffer"in o){var i=o.framebuffer;return D(i,function(t,a){var o=t.invoke(a,i),r=t.shared,n=r.framebuffer,o=a.def(n,".getFramebuffer(",o,")");return a.set(n,".next",o),r=r.context,a.set(r,".framebufferWidth",o+"?"+o+".width:"+r+".drawingBufferWidth"),a.set(r,".framebufferHeight",o+"?"+o+".height:"+r+".drawingBufferHeight"),o})}return null}function y(t,o){function r(t){if(t in i){var r=i[t];t=!0;var n=0|r.x,l=0|r.y,s,c;return"width"in r?s=0|r.width:t=!1,"height"in r?c=0|r.height:t=!1,new G(!t&&o&&o.thisDep,!t&&o&&o.contextDep,!t&&o&&o.propDep,function(t,a){var o=t.shared.context,i=s;"width"in r||(i=a.def(o,".","framebufferWidth","-",n));var d=c;return"height"in r||(d=a.def(o,".","framebufferHeight","-",l)),[n,l,i,d]})}if(t in e){var u=e[t];return t=D(u,function(t,a){var o=t.invoke(a,u),r=t.shared.context,i=a.def(o,".x|0"),e=a.def(o,".y|0"),n=a.def("\"width\" in ",o,"?",o,".width|0:","(",r,".","framebufferWidth","-",i,")"),o=a.def("\"height\" in ",o,"?",o,".height|0:","(",r,".","framebufferHeight","-",e,")");return[i,e,n,o]}),o&&(t.thisDep=t.thisDep||o.thisDep,t.contextDep=t.contextDep||o.contextDep,t.propDep=t.propDep||o.propDep),t}return o?new G(o.thisDep,o.contextDep,o.propDep,function(e,t){var a=e.shared.context;return[0,0,t.def(a,".","framebufferWidth"),t.def(a,".","framebufferHeight")]}):null}var i=t["static"],e=t.dynamic;if(t=r("viewport")){var n=t;t=new G(t.thisDep,t.contextDep,t.propDep,function(e,t){var a=n.append(e,t),o=e.shared.context;return t.set(o,".viewportWidth",a[2]),t.set(o,".viewportHeight",a[3]),a})}return{viewport:t,scissor_box:r("scissor.box")}}function x(t){function o(e){if(e in r){var t=i.id(r[e]);return e=Z(function(){return t}),e.id=t,e}if(e in n){var o=n[e];return D(o,function(e,t){var a=e.invoke(t,o);return t.def(e.shared.strings,".id(",a,")")})}return null}var r=t["static"],n=t.dynamic,l=o("frag"),s=o("vert"),e=null;return W(l)&&W(s)?(e=p.program(s.id,l.id),t=Z(function(t){return t.link(e)})):t=new G(l&&l.thisDep||s&&s.thisDep,l&&l.contextDep||s&&s.contextDep,l&&l.propDep||s&&s.propDep,function(t,a){var o=t.shared.shader,r;r=l?l.append(t,a):a.def(o,".","frag");var i;return i=s?s.append(t,a):a.def(o,".","vert"),a.def(o+".program("+i+","+r+")")}),{frag:l,vert:s,progVar:t,program:e}}function E(t){function a(t,i){if(t in o){var n=0|o[t];return Z(function(e){return i&&(e.OFFSET=n),n})}if(t in e){var l=e[t];return D(l,function(e,t){var a=e.invoke(t,l);return i&&(e.OFFSET=a),a})}return i&&r?Z(function(e){return e.OFFSET="0",0}):null}var o=t["static"],e=t.dynamic,r=function(){if("elements"in o){var t=o.elements;J(t)?t=c.getElements(c.create(t,!0)):t&&(t=c.getElements(t));var r=Z(function(e){if(t){var a=e.link(t);return e.ELEMENTS=a}return e.ELEMENTS=null});return r.value=t,r}if("elements"in e){var i=e.elements;return D(i,function(t,a){var o=t.shared,r=o.isBufferArgs,o=o.elements,n=t.invoke(a,i),l=a.def("null"),r=a.def(r,"(",n,")"),n=t.cond(r).then(l,"=",o,".createStream(",n,");")["else"](l,"=",o,".getElements(",n,");");return a.entry(n),a.exit(t.cond(r).then(o,".destroyStream(",l,");")),t.ELEMENTS=l})}return null}(),i=a("offset",!0);return{elements:r,primitive:function(){if("primitive"in o){var t=o.primitive;return Z(function(){return ue[t]})}if("primitive"in e){var i=e.primitive;return D(i,function(t,a){var o=t.constants.primTypes,r=t.invoke(a,i);return a.def(o,"[",r,"]")})}return r?W(r)?r.value?Z(function(e,t){return t.def(e.ELEMENTS,".primType")}):Z(function(){return 4}):new G(r.thisDep,r.contextDep,r.propDep,function(e,t){var a=e.ELEMENTS;return t.def(a,"?",a,".primType:",4)}):null}(),count:function(){if("count"in o){var t=0|o.count;return Z(function(){return t})}if("count"in e){var n=e.count;return D(n,function(e,t){return e.invoke(t,n)})}return r?W(r)?r?i?new G(i.thisDep,i.contextDep,i.propDep,function(e,t){return t.def(e.ELEMENTS,".vertCount-",e.OFFSET)}):Z(function(e,t){return t.def(e.ELEMENTS,".vertCount")}):Z(function(){return-1}):new G(r.thisDep||i.thisDep,r.contextDep||i.contextDep,r.propDep||i.propDep,function(e,t){var a=e.ELEMENTS;return e.OFFSET?t.def(a,"?",a,".vertCount-",e.OFFSET,":-1"):t.def(a,"?",a,".vertCount:-1")}):null}(),instances:a("instances",!1),offset:i}}function P(t){var o=t["static"],r=t.dynamic,i={};return ce.forEach(function(t){function e(e,n){if(t in o){var l=e(o[t]);i[a]=Z(function(){return l})}else if(t in r){var s=r[t];i[a]=D(s,function(e,t){return n(e,t,e.invoke(t,s))})}}var a=_(t);return"cull.enable"===t||"blend.enable"===t||"dither"===t||"stencil.enable"===t||"depth.enable"===t||"scissor.enable"===t||"polygonOffset.enable"===t||"sample.alpha"===t||"sample.enable"===t||"depth.mask"===t?e(function(e){return e},function(e,t,a){return a}):"depth.func"===t?e(function(e){return ze[e]},function(e,t,a){return t.def(e.constants.compareFuncs,"[",a,"]")}):"depth.range"===t?e(function(e){return e},function(e,t,o){return e=t.def("+",o,"[0]"),t=t.def("+",o,"[1]"),[e,t]}):"blend.func"===t?e(function(e){return[Ee["srcRGB"in e?e.srcRGB:e.src],Ee["dstRGB"in e?e.dstRGB:e.dst],Ee["srcAlpha"in e?e.srcAlpha:e.src],Ee["dstAlpha"in e?e.dstAlpha:e.dst]]},function(t,o,r){function i(t,a){return o.def("\"",t,a,"\" in ",r,"?",r,".",t,a,":",r,".",t)}t=t.constants.blendFuncs;var n=i("src","RGB"),l=i("dst","RGB"),n=o.def(t,"[",n,"]"),s=o.def(t,"[",i("src","Alpha"),"]"),l=o.def(t,"[",l,"]");return t=o.def(t,"[",i("dst","Alpha"),"]"),[n,l,s,t]}):"blend.equation"===t?e(function(e){return"string"==typeof e?[ie[e],ie[e]]:"object"==typeof e?[ie[e.rgb],ie[e.alpha]]:void 0},function(t,o,r){var i=t.constants.blendEquations,n=o.def(),e=o.def();return t=t.cond("typeof ",r,"===\"string\""),t.then(n,"=",e,"=",i,"[",r,"];"),t["else"](n,"=",i,"[",r,".rgb];",e,"=",i,"[",r,".alpha];"),o(t),[n,e]}):"blend.color"===t?e(function(e){return z(4,function(t){return+e[t]})},function(e,t,o){return z(4,function(e){return t.def("+",o,"[",e,"]")})}):"stencil.mask"===t?e(function(e){return 0|e},function(e,t,a){return t.def(a,"|0")}):"stencil.func"===t?e(function(e){return[ze[e.cmp||"keep"],e.ref||0,"mask"in e?e.mask:-1]},function(e,t,o){e=t.def("\"cmp\" in ",o,"?",e.constants.compareFuncs,"[",o,".cmp]",":",7680);var r=t.def(o,".ref|0");return t=t.def("\"mask\" in ",o,"?",o,".mask|0:-1"),[e,r,t]}):"stencil.opFront"===t||"stencil.opBack"===t?e(function(e){return["stencil.opBack"===t?1029:1028,Ie[e.fail||"keep"],Ie[e.zfail||"keep"],Ie[e.zpass||"keep"]]},function(a,o,r){function i(t){return o.def("\"",t,"\" in ",r,"?",e,"[",r,".",t,"]:",7680)}var e=a.constants.stencilOps;return["stencil.opBack"===t?1029:1028,i("fail"),i("zfail"),i("zpass")]}):"polygonOffset.offset"===t?e(function(e){return[0|e.factor,0|e.units]},function(e,t,o){return e=t.def(o,".factor|0"),t=t.def(o,".units|0"),[e,t]}):"cull.face"===t?e(function(e){var t=0;return"front"===e?t=1028:"back"==e&&(t=1029),t},function(e,t,a){return t.def(a,"===\"front\"?",1028,":",1029)}):"lineWidth"===t?e(function(e){return e},function(e,t,a){return a}):"frontFace"===t?e(function(e){return De[e]},function(e,t,a){return t.def(a+"===\"cw\"?2304:2305")}):"colorMask"===t?e(function(e){return e.map(function(e){return!!e})},function(e,t,o){return z(4,function(e){return"!!"+o+"["+e+"]"})}):"sample.coverage"===t?e(function(e){return["value"in e?e.value:1,!!e.invert]},function(e,t,o){return e=t.def("\"value\" in ",o,"?+",o,".value:1"),t=t.def("!!",o,".invert"),[e,t]}):void 0}),i}function O(t){var o=t["static"],r=t.dynamic,i={};return Object.keys(o).forEach(function(e){var t=o[e],a;if("number"==typeof t||"boolean"==typeof t)a=Z(function(){return t});else if("function"==typeof t){var r=t._reglType;"texture2d"===r||"textureCube"===r?a=Z(function(e){return e.link(t)}):("framebuffer"===r||"framebufferCube"===r)&&(a=Z(function(e){return e.link(t.color[0])}))}else v(t)&&(a=Z(function(e){return e.global.def("[",z(t.length,function(e){return t[e]}),"]")}));a.value=t,i[e]=a}),Object.keys(r).forEach(function(e){var t=r[e];i[e]=D(t,function(e,a){return e.invoke(a,t)})}),i}function R(t){var o=t["static"],r=t.dynamic,s={};return Object.keys(o).forEach(function(t){var a=o[t],r=i.id(t),e=new re;if(J(a))e.state=1,e.buffer=b.getBuffer(b.create(a,34962,!1,!0)),e.type=0;else{var d=b.getBuffer(a);if(d)e.state=1,e.buffer=d,e.type=0;else if("constant"in a){var p=a.constant;e.buffer="null",e.state=2,"number"==typeof p?e.x=p:Ce.forEach(function(t,a){a<p.length&&(e[t]=p[a])})}else{var d=J(a.buffer)?b.getBuffer(b.create(a.buffer,34962,!1,!0)):b.getBuffer(a.buffer),u=0|a.offset,g=0|a.stride,h=0|a.size,m=!!a.normalized,l=0;"type"in a&&(l=le[a.type]),a=0|a.divisor,e.buffer=d,e.state=1,e.size=h,e.normalized=m,e.type=l||d.dtype,e.offset=u,e.stride=g,e.divisor=a}}s[t]=Z(function(t){var a=t.attribCache;if(r in a)return a[r];var o={isStream:!1};return Object.keys(e).forEach(function(t){o[t]=e[t]}),e.buffer&&(o.buffer=t.link(e.buffer),o.type=o.type||o.buffer+".dtype"),a[r]=o})}),Object.keys(r).forEach(function(e){var t=r[e];s[e]=D(t,function(o,r){function a(e){r(s[e],"=",i,".",e,"|0;")}var i=o.invoke(r,t),e=o.shared,n=e.isBufferArgs,l=e.buffer,s={isStream:r.def(!1)},d=new re;d.state=1,Object.keys(d).forEach(function(e){s[e]=r.def(""+d[e])});var c=s.buffer,p=s.type;return r("if(",n,"(",i,")){",s.isStream,"=true;",c,"=",l,".createStream(",34962,",",i,");",p,"=",c,".dtype;","}else{",c,"=",l,".getBuffer(",i,");","if(",c,"){",p,"=",c,".dtype;","}else if(\"constant\" in ",i,"){",s.state,"=",2,";","if(typeof "+i+".constant === \"number\"){",s[Ce[0]],"=",i,".constant;",Ce.slice(1).map(function(e){return s[e]}).join("="),"=0;","}else{",Ce.map(function(e,t){return s[e]+"="+i+".constant.length>"+t+"?"+i+".constant["+t+"]:0;"}).join(""),"}}else{","if(",n,"(",i,".buffer)){",c,"=",l,".createStream(",34962,",",i,".buffer);","}else{",c,"=",l,".getBuffer(",i,".buffer);","}",p,"=\"type\" in ",i,"?",e.glTypes,"[",i,".type]:",c,".dtype;",s.normalized,"=!!",i,".normalized;"),a("size"),a("offset"),a("stride"),a("divisor"),r("}}"),r.exit("if(",s.isStream,"){",l,".destroyStream(",c,");","}"),s})}),s}function T(e){var t=e["static"],o=e.dynamic,r={};return Object.keys(t).forEach(function(e){var o=t[e];r[e]=Z(function(e){return"number"==typeof o||"boolean"==typeof o?""+o:e.link(o)})}),Object.keys(o).forEach(function(e){var t=o[e];r[e]=D(t,function(e,a){return e.invoke(a,t)})}),r}function h(t,a,o,r,i){var e=I(t,i),n=y(t,e,i),l=E(t,i),s=P(t,i),d=x(t,i),c=n.viewport;return c&&(s.viewport=c),c=_("scissor.box"),(n=n[c])&&(s[c]=n),n=0<Object.keys(s).length,e={framebuffer:e,draw:l,shader:d,state:s,dirty:n},e.profile=C(t,i),e.uniforms=O(o,i),e.attributes=R(a,i),e.context=T(r,i),e}function A(t,a,o){var r=t.shared.context,i=t.scope();Object.keys(o).forEach(function(e){a.save(r,"."+e),i(r,".",e,"=",o[e].append(t,a),";")}),a(i)}function M(t,o,r,i){var n=t.shared,l=n.gl,s=n.framebuffer,d;ne&&(d=o.def(n.extensions,".webgl_draw_buffers"));var c=t.constants,n=c.drawBuffer,c=c.backBuffer;t=r?r.append(t,o):o.def(s,".next"),i||o("if(",t,"!==",s,".cur){"),o("if(",t,"){",l,".bindFramebuffer(",36160,",",t,".framebuffer);"),ne&&o(d,".drawBuffersWEBGL(",n,"[",t,".colorAttachments.length]);"),o("}else{",l,".bindFramebuffer(",36160,",null);"),ne&&o(d,".drawBuffersWEBGL(",c,");"),o("}",s,".cur=",t,";"),i||o("}")}function j(t,a,o){var r=t.shared,i=r.gl,e=t.current,n=t.next,l=r.current,s=r.next,c=t.cond(l,".dirty");ce.forEach(function(a){if(a=_(a),!(a in o.state)){var r,p;if(a in n){r=n[a],p=e[a];var u=z(se[a].length,function(e){return c.def(r,"[",e,"]")});c(t.cond(u.map(function(e,t){return e+"!=="+p+"["+t+"]"}).join("||")).then(i,".",ge[a],"(",u,");",u.map(function(e,t){return p+"["+t+"]="+e}).join(";"),";"))}else r=c.def(s,".",a),u=t.cond(r,"!==",l,".",a),c(u),a in pe?u(t.cond(r).then(i,".enable(",pe[a],");")["else"](i,".disable(",pe[a],");"),l,".",a,"=",r,";"):u(i,".",ge[a],"(",r,");",l,".",a,"=",r,";")}}),0===Object.keys(o.state).length&&c(l,".dirty=false;"),a(c)}function B(t,a,o,r){var i=t.shared,l=t.current,s=i.current,d=i.gl;q(Object.keys(o)).forEach(function(i){var e=o[i];if(!r||r(e)){var c=e.append(t,a);if(pe[i]){var p=pe[i];W(e)?c?a(d,".enable(",p,");"):a(d,".disable(",p,");"):a(t.cond(c).then(d,".enable(",p,");")["else"](d,".disable(",p,");")),a(s,".",i,"=",c,";")}else if(v(c)){var u=l[i];a(d,".",ge[i],"(",c,");",c.map(function(e,t){return u+"["+t+"]="+e}).join(";"),";")}else a(d,".",ge[i],"(",c,");",s,".",i,"=",c,";")}})}function F(e,t){X&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function N(o,i,s,p,d){function e(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function u(t){b=i.def(),t(b,"=",e(),";"),"string"==typeof d?t(f,".count+=",d,";"):t(f,".count++;"),m&&(p?(_=i.def(),t(_,"=",n,".getNumPendingQueries();")):t(n,".beginQuery(",f,");"))}function g(t){t(f,".cpuTime+=",e(),"-",b,";"),m&&(p?t(n,".pushScopeStats(",_,",",n,".getNumPendingQueries(),",f,");"):t(n,".endQuery();"))}function h(e){var t=i.def(x,".profile");i(x,".profile=",e,";"),i.exit(x,".profile=",t,";")}var y=o.shared,f=o.stats,x=y.current,n=y.timer;s=s.profile;var b,_;if(s){if(W(s))return void(s.enable?(u(i),g(i.exit),h("true")):h("false"));s=s.append(o,i),h(s)}else s=i.def(x,".profile");y=o.block(),u(y),i("if(",s,"){",y,"}"),o=o.block(),g(o),i.exit("if(",s,"){",o,"}")}function V(t,o,a,r,i){function e(e){return 35664===e||35667===e||35671===e?2:35665===e||35668===e||35672===e?3:35666===e||35669===e||35673===e?4:1}function n(a,r,i){function e(){o("if(!",l,".buffer){",p,".enableVertexAttribArray(",u,");}");var e=i.type,a;a=i.size?o.def(i.size,"||",r):r,o("if(",l,".type!==",e,"||",l,".size!==",a,"||",n.map(function(e){return l+"."+e+"!=="+i[e]}).join("||"),"){",p,".bindBuffer(",34962,",",h,".buffer);",p,".vertexAttribPointer(",[u,a,e,i.normalized,i.stride,i.offset],");",l,".type=",e,";",l,".size=",a,";",n.map(function(e){return l+"."+e+"="+i[e]+";"}).join(""),"}"),X&&(e=i.divisor,o("if(",l,".divisor!==",e,"){",t.instancing,".vertexAttribDivisorANGLE(",[u,e],");",l,".divisor=",e,";}"))}function d(){o("if(",l,".buffer){",p,".disableVertexAttribArray(",u,");","}if(",Ce.map(function(e,t){return l+"."+e+"!=="+g[t]}).join("||"),"){",p,".vertexAttrib4f(",u,",",g,");",Ce.map(function(e,t){return l+"."+e+"="+g[t]+";"}).join(""),"}")}var p=s.gl,u=o.def(a,".location"),l=o.def(s.attributes,"[",u,"]");a=i.state;var h=i.buffer,g=[i.x,i.y,i.z,i.w],n=["buffer","normalized","offset","stride"];1===a?e():2===a?d():(o("if(",a,"===",1,"){"),e(),o("}else{"),d(),o("}"))}var s=t.shared;r.forEach(function(r){var s=r.name,d=a.attributes[s],c;if(d){if(!i(d))return;c=d.append(t,o)}else{if(!i(Pe))return;var p=t.scopeAttrib(s);c={},Object.keys(new re).forEach(function(e){c[e]=o.def(p,".",e)})}n(t.link(r),e(r.info.type),c)})}function H(o,a,s,d,e){for(var c=o.shared,p=c.gl,u=0,g;u<d.length;++u){var h=d[u],y=h.name,f=h.info.type,x=s.uniforms[y],h=o.link(h)+".location",b;if(x){if(!e(x))continue;if(W(x)){y=x.value,35678===f||35680===f?(f=o.link(y._texture||y.color[0]._texture),a(p,".uniform1i(",h,",",f+".bind());"),a.exit(f,".unbind();")):35674===f||35675===f||35676===f?(y=o.global.def("new Float32Array(["+Array.prototype.slice.call(y)+"])"),x=2,35675===f?x=3:35676===f&&(x=4),a(p,".uniformMatrix",x,"fv(",h,",false,",y,");")):(5126===f?g="1f":35664===f?g="2f":35665===f?g="3f":35666===f?g="4f":35670===f?g="1i":5124===f?g="1i":35671===f?g="2i":35667===f?g="2i":35672===f?g="3i":35668===f?g="3i":35673===f?g="4i":35669===f?g="4i":void 0,a(p,".uniform",g,"(",h,",",v(y)?Array.prototype.slice.call(y):y,");"));continue}else b=x.append(o,a)}else{if(!e(Pe))continue;b=a.def(c.uniforms,"[",i.id(y),"]")}switch(35678===f?a("if(",b,"&&",b,"._reglType===\"framebuffer\"){",b,"=",b,".color[0];","}"):35680===f&&a("if(",b,"&&",b,"._reglType===\"framebufferCube\"){",b,"=",b,".color[0];","}"),y=1,f){case 35678:case 35680:f=a.def(b,"._texture"),a(p,".uniform1i(",h,",",f,".bind());"),a.exit(f,".unbind();");continue;case 5124:case 35670:g="1i";break;case 35667:case 35671:g="2i",y=2;break;case 35668:case 35672:g="3i",y=3;break;case 35669:case 35673:g="4i",y=4;break;case 5126:g="1f";break;case 35664:g="2f",y=2;break;case 35665:g="3f",y=3;break;case 35666:g="4f",y=4;break;case 35674:g="Matrix2fv";break;case 35675:g="Matrix3fv";break;case 35676:g="Matrix4fv";}if(a(p,".uniform",g,"(",h,","),"M"===g.charAt(0)){var h=_a(f-35674+2,2),_=o.global.def("new Float32Array(",h,")");a("false,(Array.isArray(",b,")||",b," instanceof Float32Array)?",b,":(",z(h,function(e){return _+"["+e+"]="+b+"["+e+"]"}),",",_,")")}else 1<y?a(z(y,function(e){return b+"["+e+"]"})):a(b);a(");")}}function Y(o,a,i,s){function d(e){var t=m[e];return t?t.contextDep&&s.contextDynamic||t.propDep?t.append(o,i):t.append(o,a):a.def(h,".",e)}function e(){function e(){i(f,".drawElementsInstancedANGLE(",[n,r,x,y+"<<(("+x+"-5121)>>1)",t],");")}function a(){i(f,".drawArraysInstancedANGLE(",[n,y,r,t],");")}l?_?e():(i("if(",l,"){"),e(),i("}else{"),a(),i("}")):a()}function c(){function e(){i(g+".drawElements("+[n,r,x,y+"<<(("+x+"-5121)>>1)"]+");")}function t(){i(g+".drawArrays("+[n,y,r]+");")}l?_?e():(i("if(",l,"){"),e(),i("}else{"),t(),i("}")):t()}var p=o.shared,g=p.gl,h=p.draw,m=s.draw,l=function(){var t=m.elements,r=a;return t?((t.contextDep&&s.contextDynamic||t.propDep)&&(r=i),t=t.append(o,r)):t=r.def(h,".","elements"),t&&r("if("+t+")"+g+".bindBuffer(34963,"+t+".buffer.buffer);"),t}(),n=d("primitive"),y=d("offset"),r=function(){var t=m.count,r=a;return t?((t.contextDep&&s.contextDynamic||t.propDep)&&(r=i),t=t.append(o,r)):t=r.def(h,".","count"),t}();if(!("number"==typeof r))i("if(",r,"){"),i.exit("}");else if(0===r)return;var t,f;X&&(t=d("instances"),f=o.instancing);var x=l+".type",_=m.elements&&W(m.elements);X&&("number"!=typeof t||0<=t)?"string"==typeof t?(i("if(",t,">0){"),e(),i("}else if(",t,"<0){"),c(),i("}")):e():c()}function k(t,a,o,r,i){return a=w(),i=a.proc("body",i),X&&(a.instancing=i.def(a.shared.extensions,".angle_instanced_arrays")),t(a,i,o,r),a.compile().body}function S(e,t,a,o){F(e,t),V(e,t,a,o.attributes,function(){return!0}),H(e,t,a,o.uniforms,function(){return!0}),Y(e,t,t,a)}function L(t,a){var o=t.proc("draw",1);F(t,o),A(t,o,a.context),M(t,o,a.framebuffer),j(t,o,a),B(t,o,a.state),N(t,o,a,!1,!0);var r=a.shader.progVar.append(t,o);if(o(t.shared.gl,".useProgram(",r,".program);"),a.shader.program)S(t,o,a,a.shader.program);else{var i=t.global.def("{}"),e=o.def(r,".id"),n=o.def(i,"[",e,"]");o(t.cond(n).then(n,".call(this,a0);")["else"](n,"=",i,"[",e,"]=",t.link(function(e){return k(S,t,a,e,1)}),"(",r,");",n,".call(this,a0);"))}0<Object.keys(a.state).length&&o(t.shared.current,".dirty=true;")}function $(t,a,o,r){function i(){return!0}t.batchId="a1",F(t,a),V(t,a,o,r.attributes,i),H(t,a,o,r.uniforms,i),Y(t,a,a,o)}function K(t,a,o,r){function i(e){return e.contextDep&&n||e.propDep}function e(e){return!i(e)}F(t,a);var n=o.contextDep,s=a.def(),c=a.def();t.shared.props=c,t.batchId=s;var p=t.scope(),u=t.scope();a(p.entry,"for(",s,"=0;",s,"<","a1",";++",s,"){",c,"=","a0","[",s,"];",u,"}",p.exit),o.needsContext&&A(t,u,o.context),o.needsFramebuffer&&M(t,u,o.framebuffer),B(t,u,o.state,i),o.profile&&i(o.profile)&&N(t,u,o,!1,!0),r?(V(t,p,o,r.attributes,e),V(t,u,o,r.attributes,i),H(t,p,o,r.uniforms,e),H(t,u,o,r.uniforms,i),Y(t,p,u,o)):(a=t.global.def("{}"),r=o.shader.progVar.append(t,u),c=u.def(r,".id"),p=u.def(a,"[",c,"]"),u(t.shared.gl,".useProgram(",r,".program);","if(!",p,"){",p,"=",a,"[",c,"]=",t.link(function(e){return k($,t,o,e,2)}),"(",r,");}",p,".call(this,a0[",s,"],",s,");"))}function Q(t,o){function r(e){return e.contextDep&&i||e.propDep}var a=t.proc("batch",2);t.batchId="0",F(t,a);var i=!1,n=!0;Object.keys(o.context).forEach(function(e){i=i||o.context[e].propDep}),i||(A(t,a,o.context),n=!1);var l=o.framebuffer,s=!1;if(l?(l.propDep?i=s=!0:l.contextDep&&i&&(s=!0),s||M(t,a,l)):M(t,a,null),o.state.viewport&&o.state.viewport.propDep&&(i=!0),j(t,a,o),B(t,a,o.state,function(e){return!r(e)}),o.profile&&r(o.profile)||N(t,a,o,!1,"a1"),o.contextDep=i,o.needsContext=n,o.needsFramebuffer=s,n=o.shader.progVar,n.contextDep&&i||n.propDep)K(t,a,o,null);else if(n=n.append(t,a),a(t.shared.gl,".useProgram(",n,".program);"),o.shader.program)K(t,a,o,o.shader.program);else{var l=t.global.def("{}"),s=a.def(n,".id"),d=a.def(l,"[",s,"]");a(t.cond(d).then(d,".call(this,a0,a1);")["else"](d,"=",l,"[",s,"]=",t.link(function(e){return k(K,t,o,e,2)}),"(",n,");",d,".call(this,a0,a1);"))}0<Object.keys(o.state).length&&a(t.shared.current,".dirty=true;")}function ee(t,a){function o(o){var i=a.shader[o];i&&r.set(e.shader,"."+o,i.append(t,r))}var r=t.proc("scope",3);t.batchId="a2";var e=t.shared,n=e.current;A(t,r,a.context),a.framebuffer&&a.framebuffer.append(t,r),q(Object.keys(a.state)).forEach(function(o){var i=a.state[o].append(t,r);v(i)?i.forEach(function(e,a){r.set(t.next[o],"["+a+"]",e)}):r.set(e.next,"."+o,i)}),N(t,r,a,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(o){var i=a.draw[o];i&&r.set(e.draw,"."+o,""+i.append(t,r))}),Object.keys(a.uniforms).forEach(function(o){r.set(e.uniforms,"["+i.id(o)+"]",a.uniforms[o].append(t,r))}),Object.keys(a.attributes).forEach(function(e){var o=a.attributes[e].append(t,r),i=t.scopeAttrib(e);Object.keys(new re).forEach(function(e){r.set(i,"."+e,o[e])})}),o("vert"),o("frag"),0<Object.keys(a.state).length&&(r(n,".dirty=true;"),r.exit(n,".dirty=true;")),r("a1(",t.shared.context,",a0,",t.batchId,");")}function te(e){if("object"==typeof e&&!v(e)){for(var t=Object.keys(e),a=0;a<t.length;++a)if(ae.isDynamic(e[t[a]]))return!0;return!1}}function oe(t,a,o){function r(e,t){n.forEach(function(a){var o=i[a];ae.isDynamic(o)&&(o=e.invoke(t,o),t(u,".",a,"=",o,";"))})}var i=a["static"][o];if(i&&te(i)){var e=t.global,n=Object.keys(i),s=!1,d=!1,p=!1,u=t.global.def("{}");n.forEach(function(a){var o=i[a];if(ae.isDynamic(o))"function"==typeof o&&(o=i[a]=ae.unbox(o)),a=D(o,null),s=s||a.thisDep,p=p||a.propDep,d=d||a.contextDep;else{switch(e(u,".",a,"="),typeof o){case"number":e(o);break;case"string":e("\"",o,"\"");break;case"object":Array.isArray(o)&&e("[",o.join(),"]");break;default:e(t.link(o));}e(";")}}),a.dynamic[o]=new ae.DynamicVariable(4,{thisDep:s,contextDep:d,propDep:p,ref:u,append:r}),delete a["static"][o]}}var re=r.Record,ie={add:32774,subtract:32778,"reverse subtract":32779};a.ext_blend_minmax&&(ie.min=32775,ie.max=32776);var X=a.angle_instanced_arrays,ne=a.webgl_draw_buffers,se={dirty:!0,profile:f.profile},de={},ce=[],pe={},ge={};l("dither",3024),l("blend.enable",3042),u("blend.color","blendColor",[0,0,0,0]),u("blend.equation","blendEquationSeparate",[32774,32774]),u("blend.func","blendFuncSeparate",[1,0,1,0]),l("depth.enable",2929,!0),u("depth.func","depthFunc",513),u("depth.range","depthRange",[0,1]),u("depth.mask","depthMask",!0),u("colorMask","colorMask",[!0,!0,!0,!0]),l("cull.enable",2884),u("cull.face","cullFace",1029),u("frontFace","frontFace",2305),u("lineWidth","lineWidth",1),l("polygonOffset.enable",32823),u("polygonOffset.offset","polygonOffset",[0,0]),l("sample.alpha",32926),l("sample.enable",32928),u("sample.coverage","sampleCoverage",[1,!1]),l("stencil.enable",2960),u("stencil.mask","stencilMask",-1),u("stencil.func","stencilFunc",[519,0,-1]),u("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),u("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),l("scissor.enable",3089),u("scissor.box","scissor",[0,0,o.drawingBufferWidth,o.drawingBufferHeight]),u("viewport","viewport",[0,0,o.drawingBufferWidth,o.drawingBufferHeight]);var he={gl:o,context:g,strings:i,next:de,current:se,draw:t,elements:c,buffer:b,shader:p,attributes:r.state,uniforms:d,framebuffer:n,extensions:a,timer:m,isBufferArgs:J},me={primTypes:ue,compareFuncs:ze,blendFuncs:Ee,blendEquations:ie,stencilOps:Ie,glTypes:le,orientationType:De};ne&&(me.backBuffer=[1029],me.drawBuffer=z(s.maxDrawbuffers,function(e){return 0===e?[0]:z(e,function(e){return 36064+e})}));var ye=0;return{next:de,current:se,procs:function(){var t=w(),a=t.proc("poll"),o=t.proc("refresh"),r=t.block();a(r),o(r);var e=t.shared,i=e.gl,d=e.next,c=e.current;r(c,".dirty=false;"),M(t,a),M(t,o,null,!0);var p;X&&(p=t.link(X));for(var u=0;u<s.maxAttributes;++u){var g=o.def(e.attributes,"[",u,"]"),n=t.cond(g,".buffer");n.then(i,".enableVertexAttribArray(",u,");",i,".bindBuffer(",34962,",",g,".buffer.buffer);",i,".vertexAttribPointer(",u,",",g,".size,",g,".type,",g,".normalized,",g,".stride,",g,".offset);")["else"](i,".disableVertexAttribArray(",u,");",i,".vertexAttrib4f(",u,",",g,".x,",g,".y,",g,".z,",g,".w);",g,".buffer=null;"),o(n),X&&o(p,".vertexAttribDivisorANGLE(",u,",",g,".divisor);")}return Object.keys(pe).forEach(function(n){var e=pe[n],s=r.def(d,".",n),p=t.block();p("if(",s,"){",i,".enable(",e,")}else{",i,".disable(",e,")}",c,".",n,"=",s,";"),o(p),a("if(",s,"!==",c,".",n,"){",p,"}")}),Object.keys(ge).forEach(function(s){var e=ge[s],p=se[s],u=t.block(),g,h;u(i,".",e,"("),v(p)?(e=p.length,g=t.global.def(d,".",s),h=t.global.def(c,".",s),u(z(e,function(e){return g+"["+e+"]"}),");",z(e,function(e){return h+"["+e+"]="+g+"["+e+"];"}).join("")),a("if(",z(e,function(e){return g+"["+e+"]!=="+h+"["+e+"]"}).join("||"),"){",u,"}")):(g=r.def(d,".",s),h=r.def(c,".",s),u(g,");",c,".",s,"=",g,";"),a("if(",g,"!==",h,"){",u,"}")),o(u)}),t.compile()}(),compile:function(t,o,a,r,i){var e=w();return e.stats=e.link(i),Object.keys(o["static"]).forEach(function(t){oe(e,o,t)}),Le.forEach(function(a){oe(e,t,a)}),a=h(t,o,a,r,e),L(e,a),ee(e,a),Q(e,a),e.compile()}}}function P(e,t){for(var a=0;a<e.length;++a)if(e[a]===t)return a;return-1}var te=function(t,a){for(var o=Object.keys(a),r=0;r<o.length;++r)t[o[r]]=a[o[r]];return t},E=0,ae={DynamicVariable:e,define:function(t,a){return new e(t,o(a+""))},isDynamic:function(t){return"function"==typeof t&&!t._reglType||t instanceof e},unbox:function(t){return"function"==typeof t?new e(0,t):t},accessor:o},K={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},oe="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},re=d();re.zero=d();var ie=function(t,o){var a=1;o.ext_texture_filter_anisotropic&&(a=t.getParameter(34047));var r=1,i=1;o.webgl_draw_buffers&&(r=t.getParameter(34852),i=t.getParameter(36063));var l=!!o.oes_texture_float;if(l){l=t.createTexture(),t.bindTexture(3553,l),t.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var s=t.createFramebuffer();if(t.bindFramebuffer(36160,s),t.framebufferTexture2D(36160,36064,3553,l,0),t.bindTexture(3553,null),36053!==t.checkFramebufferStatus(36160))l=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(16384);var p=re.allocType(5126,4);t.readPixels(0,0,1,1,6408,5126,p),t.getError()?l=!1:(t.deleteFramebuffer(s),t.deleteTexture(l),l=1===p[0]),re.freeType(p)}}return p=!0,"undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(p=t.createTexture(),s=re.allocType(5121,36),t.activeTexture(33984),t.bindTexture(34067,p),t.texImage2D(34069,0,6408,3,3,0,6408,5121,s),re.freeType(s),t.bindTexture(34067,null),t.deleteTexture(p),p=!t.getError()),{colorBits:[t.getParameter(3410),t.getParameter(3411),t.getParameter(3412),t.getParameter(3413)],depthBits:t.getParameter(3414),stencilBits:t.getParameter(3415),subpixelBits:t.getParameter(3408),extensions:Object.keys(o).filter(function(e){return!!o[e]}),maxAnisotropic:a,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:t.getParameter(33901),lineWidthDims:t.getParameter(33902),maxViewportDims:t.getParameter(3386),maxCombinedTextureUnits:t.getParameter(35661),maxCubeMapSize:t.getParameter(34076),maxRenderbufferSize:t.getParameter(34024),maxTextureUnits:t.getParameter(34930),maxTextureSize:t.getParameter(3379),maxAttributes:t.getParameter(34921),maxVertexUniforms:t.getParameter(36347),maxVertexTextureUnits:t.getParameter(35660),maxVaryingVectors:t.getParameter(36348),maxFragmentUniforms:t.getParameter(36349),glsl:t.getParameter(35724),renderer:t.getParameter(7937),vendor:t.getParameter(7936),version:t.getParameter(7938),readFloat:l,npotTextureCube:p}},x=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},M=function(e){return Object.keys(e).map(function(t){return e[t]})},S={shape:function(e){for(var t=[];e.length;e=e[0])t.push(e.length);return t},flatten:function(t,a,o,r){var i=1;if(a.length)for(var l=0;l<a.length;++l)i*=a[l];else i=0;switch(o=r||re.allocType(o,i),a.length){case 0:break;case 1:for(r=a[0],a=0;a<r;++a)o[a]=t[a];break;case 2:for(r=a[0],a=a[1],l=i=0;l<r;++l)for(var s=t[l],n=0;n<a;++n)o[i++]=s[n];break;case 3:u(t,a[0],a[1],a[2],o,0);break;default:h(t,a,0,o,0);}return o}},ne={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},le={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},se={dynamic:35048,stream:35040,static:35044},de=S.flatten,ce=S.shape,pe=[];pe[5120]=1,pe[5122]=2,pe[5124]=4,pe[5121]=1,pe[5123]=2,pe[5125]=4,pe[5126]=4;var ue={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ge=new Float32Array(1),he=new Uint32Array(ge.buffer),me=[9984,9986,9985,9987],ye=[0,6409,6410,6407,6408],fe={};fe[6409]=fe[6406]=fe[6402]=1,fe[34041]=fe[6410]=2,fe[6407]=fe[35904]=3,fe[6408]=fe[35906]=4;var L=c("HTMLCanvasElement"),xe=c("CanvasRenderingContext2D"),be=c("ImageBitmap"),_e=c("HTMLImageElement"),ve=c("HTMLVideoElement"),we=Object.keys(ne).concat([L,xe,be,_e,ve]),ke=[];ke[5121]=1,ke[5126]=4,ke[36193]=2,ke[5123]=2,ke[5125]=4;var Te=[];Te[32854]=2,Te[32855]=2,Te[36194]=2,Te[34041]=4,Te[33776]=.5,Te[33777]=.5,Te[33778]=1,Te[33779]=1,Te[35986]=.5,Te[35987]=1,Te[34798]=1,Te[35840]=.5,Te[35841]=.25,Te[35842]=.5,Te[35843]=.25,Te[36196]=.5;var y=[];y[32854]=2,y[32855]=2,y[36194]=2,y[33189]=2,y[36168]=1,y[34041]=4,y[35907]=4,y[34836]=16,y[34842]=8,y[34843]=6;var Ae=function(o,a,i,l,s){function e(e){this.id=r++,this.refCount=1,this.renderbuffer=e,this.format=32854,this.height=this.width=0,s.profile&&(this.stats={size:0})}function d(e){var t=e.renderbuffer;o.bindRenderbuffer(36161,null),o.deleteRenderbuffer(t),e.renderbuffer=null,e.refCount=0,delete u[e.id],l.renderbufferCount--}var n={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};a.ext_srgb&&(n.srgba=35907),a.ext_color_buffer_half_float&&(n.rgba16f=34842,n.rgb16f=34843),a.webgl_color_buffer_float&&(n.rgba32f=34836);var p=[];Object.keys(n).forEach(function(e){p[n[e]]=e});var r=0,u={};return e.prototype.decRef=function(){0>=--this.refCount&&d(this)},s.profile&&(l.getTotalRenderbufferSize=function(){var e=0;return Object.keys(u).forEach(function(t){e+=u[t].stats.size}),e}),{create:function(t,a){function r(t,a){var l=0,c=0,u=32854;if("object"==typeof t&&t?("shape"in t?(c=t.shape,l=0|c[0],c=0|c[1]):("radius"in t&&(l=c=0|t.radius),"width"in t&&(l=0|t.width),"height"in t&&(c=0|t.height)),"format"in t&&(u=n[t.format])):"number"==typeof t?(l=0|t,c="number"==typeof a?0|a:l):t||(l=c=1),l!==i.width||c!==i.height||u!==i.format)return r.width=i.width=l,r.height=i.height=c,i.format=u,o.bindRenderbuffer(36161,i.renderbuffer),o.renderbufferStorage(36161,u,l,c),s.profile&&(i.stats.size=y[i.format]*i.width*i.height),r.format=p[i.format],r}var i=new e(o.createRenderbuffer());return u[i.id]=i,l.renderbufferCount++,r(t,a),r.resize=function(t,a){var n=0|t,l=0|a||n;return n===i.width&&l===i.height?r:(r.width=i.width=n,r.height=i.height=l,o.bindRenderbuffer(36161,i.renderbuffer),o.renderbufferStorage(36161,i.format,n,l),s.profile&&(i.stats.size=y[i.format]*i.width*i.height),r)},r._reglType="renderbuffer",r._renderbuffer=i,s.profile&&(r.stats=i.stats),r.destroy=function(){i.decRef()},r},clear:function(){M(u).forEach(d)},restore:function(){M(u).forEach(function(e){e.renderbuffer=o.createRenderbuffer(),o.bindRenderbuffer(36161,e.renderbuffer),o.renderbufferStorage(36161,e.format,e.width,e.height)}),o.bindRenderbuffer(36161,null)}}},Q=[];Q[6408]=4,Q[6407]=3;var Se=[];Se[5121]=1,Se[5126]=4,Se[36193]=2;var Ce=["x","y","z","w"],Le=["blend.func","blend.equation","stencil.func","stencil.opFront","stencil.opBack","sample.coverage","viewport","scissor.box","polygonOffset.offset"],Ee={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ze={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Ie={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},De={cw:2304,ccw:2305},Pe=new G(!1,!1,!1,function(){}),Oe=function(t,o){function i(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function l(t,a,o){var r=u.pop()||new i;r.startQueryIndex=t,r.endQueryIndex=a,r.sum=0,r.stats=o,n.push(r)}if(!o.ext_disjoint_timer_query)return null;var s=[],p=[],u=[],n=[],d=[],r=[];return{beginQuery:function(e){var t=s.pop()||o.ext_disjoint_timer_query.createQueryEXT();o.ext_disjoint_timer_query.beginQueryEXT(35007,t),p.push(t),l(p.length-1,p.length,e)},endQuery:function(){o.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:l,update:function(){var t,i;if(t=p.length,0!==t){r.length=va(r.length,t+1),d.length=va(d.length,t+1),d[0]=0;var l=r[0]=0;for(i=t=0;i<p.length;++i){var g=p[i];o.ext_disjoint_timer_query.getQueryObjectEXT(g,34919)?(l+=o.ext_disjoint_timer_query.getQueryObjectEXT(g,34918),s.push(g)):p[t++]=g,d[i+1]=l,r[i+1]=t}for(p.length=t,i=t=0;i<n.length;++i){var l=n[i],m=l.startQueryIndex,g=l.endQueryIndex;l.sum+=d[g]-d[m],m=r[m],g=r[g],g===m?(l.stats.gpuTime+=l.sum/1E6,u.push(l)):(l.startQueryIndex=m,l.endQueryIndex=g,n[t++]=l)}n.length=t}},getNumPendingQueries:function(){return p.length},clear:function(){s.push.apply(s,p);for(var e=0;e<s.length;e++)o.ext_disjoint_timer_query.deleteQueryEXT(s[e]);p.length=0,s.length=0},restore:function(){p.length=0,s.length=0}}};return function(o){function s(){if(0===L.length)x&&x.update(),Z=null;else{Z=K.next(s),w();for(var e=L.length-1,t;0<=e;--e)t=L[e],t&&t(q,null,0);y.flush(),x&&x.update()}}function b(){!Z&&0<L.length&&(Z=K.next(s))}function c(){Z&&(K.cancel(s),Z=null)}function e(e){e.preventDefault(),c(),G.forEach(function(e){e()})}function g(){y.getError(),E.restore(),T.restore(),R.restore(),Q.restore(),A.restore(),M.restore(),x&&x.restore(),re.procs.refresh(),b(),U.forEach(function(e){e()})}function d(t){function o(t){var a={},o={};return Object.keys(t).forEach(function(r){var i=t[r];ae.isDynamic(i)?o[r]=ae.unbox(i,r):a[r]=i}),{dynamic:o,static:a}}function r(e){for(;l.length<e;)l.push(null);return l}var i=o(t.context||{}),n=o(t.uniforms||{}),e=o(t.attributes||{}),s=o(function(e){function t(e){if(e in o){var t=o[e];delete o[e],Object.keys(t).forEach(function(a){o[e+"."+a]=t[a]})}}var o=te({},e);return delete o.uniforms,delete o.attributes,delete o.context,"stencil"in o&&o.stencil.op&&(o.stencil.opBack=o.stencil.opFront=o.stencil.op,delete o.stencil.op),t("blend"),t("depth"),t("cull"),t("stencil"),t("polygonOffset"),t("scissor"),t("sample"),o}(t));t={gpuTime:0,cpuTime:0,count:0};var i=re.compile(s,e,n,i,t),c=i.draw,p=i.batch,u=i.scope,l=[];return te(function(e,t){var a;if("function"==typeof e)return u.call(this,null,e,0);if("function"==typeof t){if("number"==typeof e)for(a=0;a<e;++a)u.call(this,null,t,a);else if(Array.isArray(e))for(a=0;a<e.length;++a)u.call(this,e[a],t,a);else return u.call(this,e,t,0);}else if("number"!=typeof e){if(!Array.isArray(e))return c.call(this,e);if(e.length)return p.call(this,e,e.length)}else if(0<e)return p.call(this,r(0|e),0|e)},{stats:t})}function n(e,t){var a=0;re.procs.poll();var o=t.color;o&&(y.clearColor(+o[0]||0,+o[1]||0,+o[2]||0,+o[3]||0),a|=16384),"depth"in t&&(y.clearDepth(+t.depth),a|=256),"stencil"in t&&(y.clearStencil(0|t.stencil),a|=1024),y.clear(a)}function f(e){return L.push(e),b(),{cancel:function(){function t(){var e=P(L,t);L[e]=L[L.length-1],--L.length,0>=L.length&&c()}var a=P(L,e);L[a]=t}}}function r(){var e=V.viewport,t=V.scissor_box;e[0]=e[1]=t[0]=t[1]=0,q.viewportWidth=q.framebufferWidth=q.drawingBufferWidth=e[2]=t[2]=y.drawingBufferWidth,q.viewportHeight=q.framebufferHeight=q.drawingBufferHeight=e[3]=t[3]=y.drawingBufferHeight}function w(){q.tick+=1,q.time=m(),r(),re.procs.poll()}function t(){r(),re.procs.refresh(),x&&x.update()}function m(){return(oe()-j)/1E3}if(o=p(o),!o)return null;var y=o.gl,k=y.getContextAttributes();y.isContextLost();var E=_(y,o);if(!E)return null;var l=i(),z={bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},v=E.extensions,x=Oe(y,v),j=oe(),D=y.drawingBufferWidth,B=y.drawingBufferHeight,q={tick:0,time:0,viewportWidth:D,viewportHeight:B,framebufferWidth:D,framebufferHeight:B,drawingBufferWidth:D,drawingBufferHeight:B,pixelRatio:o.pixelRatio},O=ie(y,v),D=Y(y,v,O,l),R=C(y,z,o,D),F=I(y,v,R,z),T=X(y,l,z,o),Q=N(y,v,O,function(){re.procs.poll()},q,z,o),A=Ae(y,v,O,z,o),M=H(y,v,O,Q,A,z),re=ee(y,l,v,O,R,F,Q,M,{},D,T,{elements:null,primitive:4,count:-1,offset:0,instances:-1},q,x,o),l=$(y,M,re.procs.poll,q,k,v,O),V=re.next,S=y.canvas,L=[],G=[],U=[],W=[o.onDestroy],Z=null;S&&(S.addEventListener("webglcontextlost",e,!1),S.addEventListener("webglcontextrestored",g,!1));var ne=M.setFBO=d({framebuffer:ae.define.call(null,1,"framebuffer")});return t(),k=te(d,{clear:function(e){if(!("framebuffer"in e))n(null,e);else if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;6>t;++t)ne(te({framebuffer:e.framebuffer.faces[t]},e),n);else ne(e,n)},prop:ae.define.bind(null,1),context:ae.define.bind(null,2),this:ae.define.bind(null,3),draw:d({}),buffer:function(e){return R.create(e,34962,!1,!1)},elements:function(e){return F.create(e,!1)},texture:Q.create2D,cube:Q.createCube,renderbuffer:A.create,framebuffer:M.create,framebufferCube:M.createCube,attributes:k,frame:f,on:function(e,t){var o;switch(e){case"frame":return f(t);case"lost":o=G;break;case"restore":o=U;break;case"destroy":o=W;}return o.push(t),{cancel:function(){for(var e=0;e<o.length;++e)if(o[e]===t){o[e]=o[o.length-1],o.pop();break}}}},limits:O,hasExtension:function(e){return 0<=O.extensions.indexOf(e.toLowerCase())},read:l,destroy:function(){L.length=0,c(),S&&(S.removeEventListener("webglcontextlost",e),S.removeEventListener("webglcontextrestored",g)),T.clear(),M.clear(),A.clear(),Q.clear(),F.clear(),R.clear(),x&&x.clear(),W.forEach(function(e){e()})},_gl:y,_refresh:t,poll:function(){w(),x&&x.update()},now:m,stats:z}),o.onDone(null,k),k}})},{}],479:[function(e,t){/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */"use strict";function a(e,t){if("string"!=typeof e)throw new TypeError("expected a string");if(1===t)return e;if(2===t)return e+e;var a=e.length*t;if(r!==e||"undefined"==typeof r)r=e,o="";else if(o.length>=a)return o.substr(0,a);for(;a>o.length&&1<t;)1&t&&(o+=e),t>>=1,e+=e;return o+=e,o=o.substr(0,a),o}var o="",r;t.exports=a},{}],480:[function(e,t){(function(e){t.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],481:[function(e,t){"use strict";t.exports=function(t){for(var e=t.length,o=t[t.length-1],r=e,n=e-2;0<=n;--n){var l=o,s=t[n];o=l+s;var d=o-l,c=s-d;c&&(t[--r]=o,o=c)}for(var p=0,n=r;n<e;++n){var l=t[n],s=o;o=l+s;var d=o-l,c=s-d;c&&(t[p++]=c)}return t[p++]=o,t.length=p,t}},{}],482:[function(e,t){"use strict";function a(e,t){for(var a=Array(e.length-1),o=1,n;o<e.length;++o){n=a[o-1]=Array(e.length-1);for(var l=0,s=0;l<e.length;++l)l!==t&&(n[s++]=e[o][l])}return a}function o(e){for(var t=Array(e),a=0;a<e;++a){t[a]=Array(e);for(var o=0;o<e;++o)t[a][o]=["m[",a,"][",o,"]"].join("")}return t}function r(e){return 1&e?"-":""}function n(e){if(1===e.length)return e[0];if(2===e.length)return["sum(",e[0],",",e[1],")"].join("");var t=e.length>>1;return["sum(",n(e.slice(0,t)),",",n(e.slice(t)),")"].join("")}function l(e){if(2===e.length)return["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("");for(var t=[],o=0;o<e.length;++o)t.push(["scale(",l(a(e,o)),",",r(o),e[0][o],")"].join(""));return n(t)}function s(e){var t=new Function("sum","scale","prod","compress",["function robustDeterminant",e,"(m){return compress(",l(o(e)),")};return robustDeterminant",e].join(""));return t(c,p,d,u)}var d=e("two-product"),c=e("robust-sum"),p=e("robust-scale"),u=e("robust-compress"),g=[function(){return[0]},function(e){return[e[0][0]]}];(function(){for(;g.length<6;)g.push(s(g.length));for(var e=[],a=["function robustDeterminant(m){switch(m.length){"],o=0;o<6;++o)e.push("det"+o),a.push("case ",o,":return det",o,"(m);");a.push("}var det=CACHE[m.length];if(!det)det=CACHE[m.length]=gen(m.length);return det(m);}return robustDeterminant"),e.push("CACHE","gen",a.join(""));var r=Function.apply(void 0,e);t.exports=r.apply(void 0,g.concat([g,s]));for(var o=0;o<g.length;++o)t.exports[o]=g[o]})()},{"robust-compress":481,"robust-scale":488,"robust-sum":491,"two-product":519}],483:[function(e,t){"use strict";var o=e("two-product"),n=e("robust-sum");t.exports=function(e,t){for(var a=o(e[0],t[0]),l=1;l<e.length;++l)a=n(a,o(e[l],t[l]));return a}},{"robust-sum":491,"two-product":519}],484:[function(e,t){"use strict";function a(e,t){for(var a=Array(e.length-1),o=1,n;o<e.length;++o){n=a[o-1]=Array(e.length-1);for(var l=0,s=0;l<e.length;++l)l!==t&&(n[s++]=e[o][l])}return a}function o(e){for(var t=Array(e),a=0;a<e;++a){t[a]=Array(e);for(var o=0;o<e;++o)t[a][o]=["m",o,"[",e-a-2,"]"].join("")}return t}function r(e){if(1===e.length)return e[0];if(2===e.length)return["sum(",e[0],",",e[1],")"].join("");var t=e.length>>1;return["sum(",r(e.slice(0,t)),",",r(e.slice(t)),")"].join("")}function n(e,t){if("m"===e.charAt(0)){if("w"===t.charAt(0)){var a=e.split("[");return["w",t.substr(1),"m",a[0].substr(1)].join("")}return["prod(",e,",",t,")"].join("")}return n(t,e)}function l(e){return!0&e?"-":""}function s(e){if(2===e.length)return[["diff(",n(e[0][0],e[1][1]),",",n(e[1][0],e[0][1]),")"].join("")];for(var t=[],o=0;o<e.length;++o)t.push(["scale(",r(s(a(e,o))),",",l(o),e[0][o],")"].join(""));return t}function d(e,t){for(var a=[],o=0;o<t-2;++o)a.push(["prod(m",e,"[",o,"],m",e,"[",o,"])"].join(""));return r(a)}function c(e){for(var t=[],n=[],l=o(e),c=0;c<e;++c)l[0][c]="1",l[e-1][c]="w"+c;for(var c=0;c<e;++c)0==(1&c)?t.push.apply(t,s(a(l,c))):n.push.apply(n,s(a(l,c)));for(var p=r(t),m=r(n),f="exactInSphere"+e,x=[],c=0;c<e;++c)x.push("m"+c);for(var b=["function ",f,"(",x.join(),"){"],c=0;c<e;++c){b.push("var w",c,"=",d(c,e),";");for(var _=0;_<e;++_)_!=c&&b.push("var w",c,"m",_,"=scale(w",c,",m",_,"[0]);")}b.push("var p=",p,",n=",m,",d=diff(p,n);return d[d.length-1];}return ",f);var v=new Function("sum","diff","prod","scale",b.join(""));return v(g,h,u,y)}function p(e){var t=f[e.length];return t||(t=f[e.length]=c(e.length)),t.apply(void 0,e)}var u=e("two-product"),g=e("robust-sum"),h=e("robust-subtract"),y=e("robust-scale"),f=[function(){return 0},function(){return 0},function(){return 0}];(function(){for(;f.length<=6;)f.push(c(f.length));for(var e=[],a=["slow"],o=0;o<=6;++o)e.push("a"+o),a.push("o"+o);for(var r=["function testInSphere(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"],o=2;o<=6;++o)r.push("case ",o,":return o",o,"(",e.slice(0,o).join(),");");r.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return testInSphere"),a.push(r.join(""));var n=Function.apply(void 0,a);t.exports=n.apply(void 0,[p].concat(f));for(var o=0;o<=6;++o)t.exports[o]=f[o]})()},{"robust-scale":488,"robust-subtract":490,"robust-sum":491,"two-product":519}],485:[function(e,t){"use strict";function a(e){for(var t="robustLinearSolve"+e+"d",a=["function ",t,"(A,b){return ["],r=0;r<e;++r){a.push("det([");for(var n=0;n<e;++n){0<n&&a.push(","),a.push("[");for(var l=0;l<e;++l)0<l&&a.push(","),l==r?a.push("+b[",n,"]"):a.push("+A[",n,"][",l,"]");a.push("]")}a.push("]),")}a.push("det(A)]}return ",t);var s=new Function("det",a.join(""));return 6>e?s(o[e]):s(o)}var o=e("robust-determinant"),r=[function(){return[0]},function(e,t){return[[t[0]],[e[0][0]]]}];(function(){for(;r.length<6;)r.push(a(r.length));for(var e=[],o=["function dispatchLinearSolve(A,b){switch(A.length){"],n=0;n<6;++n)e.push("s"+n),o.push("case ",n,":return s",n,"(A,b);");o.push("}var s=CACHE[A.length];if(!s)s=CACHE[A.length]=g(A.length);return s(A,b)}return dispatchLinearSolve"),e.push("CACHE","g",o.join(""));var l=Function.apply(void 0,e);t.exports=l.apply(void 0,r.concat([r,a]));for(var n=0;n<6;++n)t.exports[n]=r[n]})()},{"robust-determinant":482}],486:[function(e,t){"use strict";function a(e,t){for(var a=Array(e.length-1),o=1,n;o<e.length;++o){n=a[o-1]=Array(e.length-1);for(var l=0,s=0;l<e.length;++l)l!==t&&(n[s++]=e[o][l])}return a}function o(e){for(var t=Array(e),a=0;a<e;++a){t[a]=Array(e);for(var o=0;o<e;++o)t[a][o]=["m",o,"[",e-a-1,"]"].join("")}return t}function r(e){return 1&e?"-":""}function l(e){if(1===e.length)return e[0];if(2===e.length)return["sum(",e[0],",",e[1],")"].join("");var t=e.length>>1;return["sum(",l(e.slice(0,t)),",",l(e.slice(t)),")"].join("")}function s(e){if(2===e.length)return[["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("")];for(var t=[],o=0;o<e.length;++o)t.push(["scale(",l(s(a(e,o))),",",r(o),e[0][o],")"].join(""));return t}function d(e){for(var t=[],r=[],n=o(e),d=[],c=0;c<e;++c)0==(1&c)?t.push.apply(t,s(a(n,c))):r.push.apply(r,s(a(n,c))),d.push("m"+c);var m=l(t),y=l(r),f="orientation"+e+"Exact",x=["function ",f,"(",d.join(),"){var p=",m,",n=",y,",d=sub(p,n);return d[d.length-1];};return ",f].join(""),b=new Function("sum","prod","scale","sub",x);return b(u,p,g,h)}function c(e){var t=x[e.length];return t||(t=x[e.length]=d(e.length)),t.apply(void 0,e)}var p=e("two-product"),u=e("robust-sum"),g=e("robust-scale"),h=e("robust-subtract"),m=11102230246251565e-32,y=d(3),f=d(4),x=[function(){return 0},function(){return 0},function(e,t){return t[0]-e[0]},function(e,t,a){var o=(e[1]-a[1])*(t[0]-a[0]),i=(e[0]-a[0])*(t[1]-a[1]),r=o-i,n;if(0<o){if(0>=i)return r;n=o+i}else if(0>o){if(0<=i)return r;n=-(o+i)}else return r;var l=(3+16*m)*m*n;return r>=l||r<=-l?r:y(e,t,a)},function(e,t,a,o){var r=e[0]-o[0],i=t[0]-o[0],n=a[0]-o[0],l=e[1]-o[1],s=t[1]-o[1],d=a[1]-o[1],c=e[2]-o[2],p=t[2]-o[2],u=a[2]-o[2],g=i*d,h=n*s,y=n*l,x=r*d,b=r*s,_=i*l,v=c*(g-h)+p*(y-x)+u*(b-_),w=(wa(g)+wa(h))*wa(c)+(wa(y)+wa(x))*wa(p)+(wa(b)+wa(_))*wa(u),k=(7+56*m)*m*w;return v>k||-v>k?v:f(e,t,a,o)}];(function(){for(;x.length<=5;)x.push(d(x.length));for(var e=[],a=["slow"],o=0;o<=5;++o)e.push("a"+o),a.push("o"+o);for(var r=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"],o=2;o<=5;++o)r.push("case ",o,":return o",o,"(",e.slice(0,o).join(),");");r.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),a.push(r.join(""));var n=Function.apply(void 0,a);t.exports=n.apply(void 0,[c].concat(x));for(var o=0;o<=5;++o)t.exports[o]=x[o]})()},{"robust-scale":488,"robust-subtract":490,"robust-sum":491,"two-product":519}],487:[function(e,t){"use strict";var o=e("robust-sum"),n=e("robust-scale");t.exports=function(e,t){if(1===e.length)return n(t,e[0]);if(1===t.length)return n(e,t[0]);if(0===e.length||0===t.length)return[0];var a=[0];if(e.length<t.length)for(var l=0;l<e.length;++l)a=o(a,n(t,e[l]));else for(var l=0;l<t.length;++l)a=o(a,n(e,t[l]));return a}},{"robust-scale":488,"robust-sum":491}],488:[function(e,t){"use strict";var o=e("two-product"),r=e("two-sum");t.exports=function(l,e){var s=l.length;if(1===s){var n=o(l[0],e);return n[0]?n:[n[1]]}var d=Array(2*s),c=[.1,.1],p=[.1,.1],t=0;o(l[0],e,c),c[0]&&(d[t++]=c[0]);for(var u=1;u<s;++u){o(l[u],e,p);var g=c[1];r(g,p[0],c),c[0]&&(d[t++]=c[0]);var h=p[1],a=c[1],m=h+a,f=a-(m-h);c[1]=m,f&&(d[t++]=f)}return c[1]&&(d[t++]=c[1]),0===t&&(d[t++]=0),d.length=t,d}},{"two-product":519,"two-sum":520}],489:[function(e,t){"use strict";function a(e,t,a,o){for(var r=0;2>r;++r){var i=e[r],n=t[r],l=ie(i,n),s=va(i,n),c=a[r],p=o[r],u=ie(c,p),g=va(c,p);if(g<l||s<u)return!1}return!0}t.exports=function(e,t,r,i){var n=o(e,r,i),l=o(t,r,i);if(0<n&&0<l||0>n&&0>l)return!1;var s=o(r,e,t),d=o(i,e,t);return!(0<s&&0<d||0>s&&0>d)&&(0!==n||0!==l||0!==s||0!==d||a(e,t,r,i))};var o=e("robust-orientation")[3]},{"robust-orientation":486}],490:[function(e,t){"use strict";function o(e,t){var a=e+t,o=a-e,r=e-(a-o)+(t-o);return r?[r,a]:[a]}t.exports=function(t,e){var r=0|t.length,i=0|e.length;if(1==r&&1===i)return o(t[0],-e[0]);var n=Array(r+i),l=0,s=0,d=0,c=wa,p=t[s],u=c(p),g=-e[d],h=c(g),m,f;u<h?(f=p,s+=1,s<r&&(p=t[s],u=c(p))):(f=g,d+=1,d<i&&(g=-e[d],h=c(g))),s<r&&u<h||d>=i?(m=p,s+=1,s<r&&(p=t[s],u=c(p))):(m=g,d+=1,d<i&&(g=-e[d],h=c(g)));for(var _=m+f,v=_-m,w=f-v,k=w,T=_,A,S,C,L,E;s<r&&d<i;)u<h?(m=p,s+=1,s<r&&(p=t[s],u=c(p))):(m=g,d+=1,d<i&&(g=-e[d],h=c(g))),f=k,_=m+f,v=_-m,w=f-v,w&&(n[l++]=w),A=T+_,S=A-T,C=A-S,L=_-S,E=T-C,k=E+L,T=A;for(;s<r;)m=p,f=k,_=m+f,v=_-m,w=f-v,w&&(n[l++]=w),A=T+_,S=A-T,C=A-S,L=_-S,E=T-C,k=E+L,T=A,s+=1,s<r&&(p=t[s]);for(;d<i;)m=g,f=k,_=m+f,v=_-m,w=f-v,w&&(n[l++]=w),A=T+_,S=A-T,C=A-S,L=_-S,E=T-C,k=E+L,T=A,d+=1,d<i&&(g=-e[d]);return k&&(n[l++]=k),T&&(n[l++]=T),l||(n[l++]=0),n.length=l,n}},{}],491:[function(e,t){"use strict";function o(e,t){var a=e+t,o=a-e,r=e-(a-o)+(t-o);return r?[r,a]:[a]}t.exports=function(t,e){var r=0|t.length,i=0|e.length;if(1==r&&1===i)return o(t[0],e[0]);var n=Array(r+i),l=0,s=0,d=0,c=wa,p=t[s],u=c(p),g=e[d],h=c(g),m,f;u<h?(f=p,s+=1,s<r&&(p=t[s],u=c(p))):(f=g,d+=1,d<i&&(g=e[d],h=c(g))),s<r&&u<h||d>=i?(m=p,s+=1,s<r&&(p=t[s],u=c(p))):(m=g,d+=1,d<i&&(g=e[d],h=c(g)));for(var _=m+f,v=_-m,w=f-v,k=w,T=_,A,S,C,L,E;s<r&&d<i;)u<h?(m=p,s+=1,s<r&&(p=t[s],u=c(p))):(m=g,d+=1,d<i&&(g=e[d],h=c(g))),f=k,_=m+f,v=_-m,w=f-v,w&&(n[l++]=w),A=T+_,S=A-T,C=A-S,L=_-S,E=T-C,k=E+L,T=A;for(;s<r;)m=p,f=k,_=m+f,v=_-m,w=f-v,w&&(n[l++]=w),A=T+_,S=A-T,C=A-S,L=_-S,E=T-C,k=E+L,T=A,s+=1,s<r&&(p=t[s]);for(;d<i;)m=g,f=k,_=m+f,v=_-m,w=f-v,w&&(n[l++]=w),A=T+_,S=A-T,C=A-S,L=_-S,E=T-C,k=E+L,T=A,d+=1,d<i&&(g=e[d]);return k&&(n[l++]=k),T&&(n[l++]=T),l||(n[l++]=0),n.length=l,n}},{}],492:[function(e,t){"use strict";t.exports=function(e){return 0>e?-1:0<e?1:0}},{}],493:[function(e,t){"use strict";t.exports=function(e){return o(a(e))};var a=e("boundary-cells"),o=e("reduce-simplicial-complex")},{"boundary-cells":83,"reduce-simplicial-complex":472}],494:[function(e,t){"use strict";function a(e){for(var t=e.length,a=0,o=0;o<t;++o)a=0|va(a,e[o].length);return a-1}function o(e,t){for(var a=e.length,o=p.mallocUint8(a),r=0;r<a;++r)o[r]=0|e[r]<t;return o}function r(e,t){for(var o=e.length,r=0|t*(t+1)/2*o,n=p.mallocUint32(2*r),l=0,g=0;g<o;++g)for(var h=e[g],t=h.length,c=0;c<t;++c)for(var m=0;m<c;++m){var y=h[m],a=h[c];n[l++]=0|ie(y,a),n[l++]=0|va(y,a)}var f=0|l/2;u(s(n,[f,2]));for(var x=2,g=2;g<l;g+=2)(n[g-2]!==n[g]||n[g-1]!==n[g+1])&&(n[x++]=n[g],n[x++]=n[g+1]);return s(n,[0|x/2,2])}function i(e,t,o,r){for(var n=e.data,l=e.shape[0],d=p.mallocDouble(l),c=0,u=0;u<l;++u){var g=n[2*u],a=n[2*u+1];if(o[g]!==o[a]){var h=t[g],m=t[a];n[2*c]=g,n[2*c+1]=a,d[c++]=(m-r)/(m-h)}}return e.shape[0]=c,s(d,[c])}function n(e,t){var o=p.mallocInt32(2*t),r=e.shape[0],n=e.data;o[0]=0;for(var l=0,s=0,d;s<r;++s)if(d=n[2*s],d!==l){for(o[2*l+1]=s;++l<d;)o[2*l]=s,o[2*l+1]=s;o[2*l]=s}for(o[2*l+1]=r;++l<t;)o[2*l]=o[2*l+1]=r;return o}function l(e){for(var t=0|e.shape[0],a=e.data,o=Array(t),r=0;r<t;++r)o[r]=[a[2*r],a[2*r+1]];return o}t.exports=function(e,t,s,c){s=s||0,"undefined"==typeof c&&(c=a(e));var u=e.length;if(0===u||1>c)return{cells:[],vertexIds:[],vertexWeights:[]};var h=o(t,+s),m=r(e,c),y=i(m,t,h,+s),f=n(m,0|t.length),x=g(c)(e,m.data,f,h),b=l(m),_=[].slice.call(y.data,0,y.shape[0]);return p.free(h),p.free(m.data),p.free(y.data),p.free(f),{cells:x,vertexIds:b,vertexWeights:_}};var s=e("ndarray"),p=e("typedarray-pool"),u=e("ndarray-sort"),g=e("./lib/codegen")},{"./lib/codegen":495,ndarray:433,"ndarray-sort":431,"typedarray-pool":521}],495:[function(e,t){"use strict";function a(e){function t(e){if(!(0>=e.length)){c.push("R.push(");for(var t=0,a;t<e.length;++t){a=e[t],0<t&&c.push(","),c.push("[");for(var o=0,r;o<a.length;++o)r=a[o],0<o&&c.push(","),c.push("B(C,E,c[",r[0],"],c[",r[1],"])");c.push("]")}c.push(");")}}var a=0,n=Array(e+1);n[0]=[[]];for(var l=1,s;l<=e;++l){s=n[l]=r(l);for(var d=0;d<s.length;++d)a=va(a,s[l].length)}for(var c=["function B(C,E,i,j){","var a=Math.min(i,j)|0,b=Math.max(i,j)|0,l=C[2*a],h=C[2*a+1];","while(l<h){","var m=(l+h)>>1,v=E[2*m+1];","if(v===b){return m}","if(b<v){h=m}else{l=m+1}","}","return l;","};","function getContour",e,"d(F,E,C,S){","var n=F.length,R=[];","for(var i=0;i<n;++i){var c=F[i],l=c.length;"],l=e+1;1<l;--l){l<e+1&&c.push("else "),c.push("if(l===",l,"){");for(var p=[],d=0;d<l;++d)p.push("(S[c["+d+"]]<<"+d+")");c.push("var M=",p.join("+"),";if(M===0||M===",(1<<l)-1,"){continue}switch(M){");for(var s=n[l-1],d=0;d<s.length;++d)c.push("case ",d,":"),t(s[d]),c.push("break;");c.push("}}")}c.push("}return R;};return getContour",e,"d");var u=new Function("pool",c.join(""));return u(o)}t.exports=function(e){var t=i[e];return t||(t=i[e]=a(e)),t};var o=e("typedarray-pool"),r=e("marching-simplex-table"),i={}},{"marching-simplex-table":410,"typedarray-pool":521}],496:[function(e,t,a){"use strict";"use restrict";function o(e,a){var o=e.length,r=e.length-a.length,n=ie;if(r)return r;switch(o){case 0:return 0;case 1:return e[0]-a[0];case 2:var l=e[0]+e[1]-a[0]-a[1];return l?l:n(e[0],e[1])-n(a[0],a[1]);case 3:var s=e[0]+e[1],c=a[0]+a[1];if(l=s+e[2]-(c+a[2]),l)return l;var p=n(e[0],e[1]),u=n(a[0],a[1]),l=n(p,e[2])-n(u,a[2]);return l?l:n(p+e[2],s)-n(u+a[2],c);default:var g=e.slice(0);g.sort();var h=a.slice(0);h.sort();for(var m=0;m<o;++m)if(r=g[m]-h[m],r)return r;return 0;}}function r(e,t){return o(e[0],t[0])}function s(e,t){if(t){for(var a=e.length,n=Array(a),l=0;l<a;++l)n[l]=[e[l],t[l]];n.sort(r);for(var l=0;l<a;++l)e[l]=n[l][0],t[l]=n[l][1];return e}return e.sort(o),e}function d(e){if(0===e.length)return[];for(var t=1,r=e.length,n=1,l;n<r;++n)if(l=e[n],o(l,e[n-1])){if(n===t){t++;continue}e[t++]=l}return e.length=t,e}function p(e,t){for(var a=0,i=e.length-1,n=-1;a<=i;){var l=a+i>>1,d=o(e[l],t);0>=d?(0===d&&(n=l),a=l+1):0<d&&(i=l-1)}return n}function u(e,t){for(var a=Array(e.length),r=0,s=a.length;r<s;++r)a[r]=[];for(var d=[],r=0,u=t.length;r<u;++r)for(var n=t[r],c=n.length,g=1;g<1<<c;++g){d.length=y.popCount(g);for(var h=0,m=0;m<c;++m)g&1<<m&&(d[h++]=n[m]);var f=p(e,d);if(!(0>f))for(;a[f++].push(r),!(f>=e.length||0!==o(e[f],d)););}return a}function g(e,t){if(0>t)return[];for(var a=[],o=0,r;o<e.length;++o){r=e[o];for(var n=(1<<t+1)-1;n<1<<r.length;n=y.nextCombination(n)){for(var d=Array(t+1),p=0,u=0;u<r.length;++u)n&1<<u&&(d[p++]=r[u]);a.push(d)}}return s(a)}function h(e,t){for(var a=new f(t),o=0,r;o<e.length;++o){r=e[o];for(var n=0;n<r.length;++n)for(var s=n+1;s<r.length;++s)a.link(r[n],r[s])}for(var d=[],p=a.ranks,o=0;o<p.length;++o)p[o]=-1;for(var o=0,u;o<e.length;++o)u=a.find(e[o][0]),0>p[u]?(p[u]=d.length,d.push([e[o].slice(0)])):d[p[u]].push(e[o].slice(0));return d}function m(e){for(var t=d(s(g(e,0))),a=new f(t.length),o=0,r;o<e.length;++o){r=e[o];for(var n=0,u;n<r.length;++n){u=p(t,[r[n]]);for(var h=n+1;h<r.length;++h)a.link(u,p(t,[r[h]]))}}for(var m=[],y=a.ranks,o=0;o<y.length;++o)y[o]=-1;for(var o=0,x;o<e.length;++o)x=a.find(p(t,[e[o][0]])),0>y[x]?(y[x]=m.length,m.push([e[o].slice(0)])):m[y[x]].push(e[o].slice(0));return m}var y=e("bit-twiddle"),f=e("union-find");a.dimension=function(e){for(var t=0,a=0,o=e.length;a<o;++a)t=va(t,e[a].length);return t-1},a.countVertices=function(e){for(var t=-1,a=0,o=e.length,r;a<o;++a){r=e[a];for(var n=0,l=r.length;n<l;++n)t=va(t,r[n])}return t+1},a.cloneCells=function(e){for(var t=Array(e.length),a=0,o=e.length;a<o;++a)t[a]=e[a].slice(0);return t},a.compareCells=o,a.normalize=s,a.unique=d,a.findCell=p,a.incidence=u,a.dual=function(e,t){if(!t)return u(d(g(e,0)),e,0);for(var a=Array(t),o=0;o<t;++o)a[o]=[];for(var o=0,r=e.length,n;o<r;++o){n=e[o];for(var l=0,s=n.length;l<s;++l)a[n[l]].push(o)}return a},a.explode=function(e){for(var t=[],a=0,o=e.length;a<o;++a)for(var r=e[a],n=0|r.length,l=1,d;l<1<<n;++l){d=[];for(var c=0;c<n;++c)1&l>>>c&&d.push(r[c]);t.push(d)}return s(t)},a.skeleton=g,a.boundary=function(e){for(var t=[],a=0,o=e.length,r;a<o;++a){r=e[a];for(var n=0,d=r.length,p;n<d;++n){p=Array(r.length-1);for(var u=0,g=0;u<d;++u)u!=n&&(p[g++]=r[u]);t.push(p)}}return s(t)},a.connectedComponents=function(e,t){return t?h(e,t):m(e)}},{"bit-twiddle":80,"union-find":522}],497:[function(e,t,a){arguments[4][80][0].apply(a,arguments)},{dup:80}],498:[function(e,t,a){arguments[4][496][0].apply(a,arguments)},{"bit-twiddle":497,dup:496,"union-find":499}],499:[function(e,t){"use strict";"use restrict";function a(e){this.roots=Array(e),this.ranks=Array(e);for(var t=0;t<e;++t)this.roots[t]=t,this.ranks[t]=0}t.exports=a,a.prototype.length=function(){return this.roots.length},a.prototype.makeSet=function(){var e=this.roots.length;return this.roots.push(e),this.ranks.push(0),e},a.prototype.find=function(e){for(var t=this.roots;t[e]!==e;){var a=t[e];t[e]=t[a],e=a}return e},a.prototype.link=function(e,t){var a=this.find(e),o=this.find(t);if(a!==o){var r=this.ranks,i=this.roots,n=r[a],l=r[o];n<l?i[a]=o:l<n?i[o]=a:(i[o]=a,++r[a])}}},{}],500:[function(e,t){"use strict";function a(e,t,a){var r=wa(o(e,t,a)),i=re(_a(t[0]-a[0],2)+_a(t[1]-a[1],2));return r/i}t.exports=function(e,o,l){function d(e){if(A[e])return 1/0;var r=v[e],i=k[e];return 0>r||0>i?1/0:a(o[e],o[r],o[i])}function p(e,o){var r=t[e],a=t[o];t[e]=a,t[o]=r,E[r]=o,E[a]=e}function u(e){return T[t[e]]}function g(e){return 1&e?e-1>>1:(e>>1)-1}function h(e){for(var t=u(e);;){var a=t,o=2*e+1,r=2*(e+1),n=e;if(o<I){var l=u(o);l<a&&(n=o,a=l)}if(r<I){var s=u(r);s<a&&(n=r)}if(n===e)return e;p(e,n),e=n}}function m(e){for(var t=u(e),a;0<e;){if(a=g(e),0<=a){var o=u(a);if(t<o){p(e,a),e=a;continue}}return e}}function y(){if(0<I){var e=t[0];return p(0,I-1),I-=1,h(0),e}return-1}function f(e,o){var r=t[e];return T[r]===o?e:(T[r]=-Infinity,m(e),y(),T[r]=o,I+=1,m(I-1))}function x(e){if(!A[e]){A[e]=!0;var a=v[e],o=k[e];0<=v[o]&&(v[o]=a),0<=k[a]&&(k[a]=o),0<=E[a]&&f(E[a],d(a)),0<=E[o]&&f(E[o],d(o))}}function b(e,a){if(0>e[a])return a;var o=a,r=a;do{var i=e[r];if(!A[r]||0>i||i===r)break;if(r=i,i=e[r],!A[r]||0>i||i===r)break;r=i,o=e[o]}while(o!==r);for(var n=a;n!==r;n=e[n])e[n]=r;return r}for(var _=o.length,n=e.length,v=Array(_),k=Array(_),T=Array(_),A=Array(_),S=0;S<_;++S)v[S]=k[S]=-1,T[S]=1/0,A[S]=!1;for(var S=0,C;S<n;++S){if(C=e[S],2!==C.length)throw new Error("Input must be a graph");var L=C[1],s=C[0];k[s]=-1===k[s]?L:-2,v[L]=-1===v[L]?s:-2}for(var t=[],E=Array(_),S=0,z;S<_;++S)z=T[S]=d(S),z<1/0?(E[S]=t.length,t.push(S)):E[S]=-1;for(var I=t.length,S=I>>1;0<=S;--S)h(S);for(;;){var D=y();if(0>D||T[D]>l)break;x(D)}for(var P=[],S=0;S<_;++S)A[S]||(E[S]=P.length,P.push(o[S].slice()));var O=P.length,R=[];return e.forEach(function(e){var t=b(v,e[0]),a=b(k,e[1]);if(0<=t&&0<=a&&t!==a){var o=E[t],r=E[a];o!==r&&R.push([o,r])}}),r.unique(r.normalize(R)),{positions:P,edges:R}};var o=e("robust-orientation"),r=e("simplicial-complex")},{"robust-orientation":486,"simplicial-complex":498}],501:[function(e,t){"use strict";function o(e,t){var a,o;if(t[0][0]<t[1][0])a=t[0],o=t[1];else if(t[0][0]>t[1][0])a=t[1],o=t[0];else{var i=ie(e[0][1],e[1][1]),n=va(e[0][1],e[1][1]),l=ie(t[0][1],t[1][1]),s=va(t[0][1],t[1][1]);return n<l?n-l:i>s?i-s:n-s}var c,p;e[0][1]<e[1][1]?(c=e[0],p=e[1]):(c=e[1],p=e[0]);var u=r(o,a,c);return u?u:(u=r(o,a,p),u?u:p-o)}t.exports=function(e,t){var a,i;if(t[0][0]<t[1][0])a=t[0],i=t[1];else if(t[0][0]>t[1][0])a=t[1],i=t[0];else return o(t,e);var n,l;if(e[0][0]<e[1][0])n=e[0],l=e[1];else if(e[0][0]>e[1][0])n=e[1],l=e[0];else return-o(e,t);var s=r(a,i,l),d=r(a,i,n);if(0>s){if(0>=d)return s;}else if(0<s){if(0<=d)return s;}else if(d)return d;if(s=r(l,n,i),d=r(l,n,a),0>s){if(0>=d)return s;}else if(0<s){if(0<=d)return s;}else if(d)return d;return i[0]-l[0]};var r=e("robust-orientation")},{"robust-orientation":486}],502:[function(e,t){"use strict";function a(e,t,a){this.slabs=e,this.coordinates=t,this.horizontal=a}function r(t,e){return t.y-e}function i(e,t){for(var a=null;e;){var n=e.key,s,d;n[0][0]<n[1][0]?(s=n[0],d=n[1]):(s=n[1],d=n[0]);var p=c(s,d,t);if(0>p)e=e.left;else if(!(0<p)){if(t[0]!==n[1][0])return e;var o=i(e.right,t);if(o)return o;e=e.left}else if(t[0]!==n[1][0])a=e,e=e.right;else{var o=i(e.right,t);if(o)return o;e=e.left}}return a}function n(e,t,a,o){this.y=e,this.index=t,this.start=a,this.closed=o}function l(e,t,a,o){this.x=e,this.segment=t,this.create=a,this.index=o}t.exports=function(t){for(var o=t.length,r=2*o,c=Array(r),p=0;p<o;++p){var g=t[p],s=g[0][0]<g[1][0];c[2*p]=new l(g[0][0],g,s,p),c[2*p+1]=new l(g[1][0],g,!s,p)}c.sort(function(e,t){var a=e.x-t.x;return a?a:(a=e.create-t.create,a?a:ie(e.segment[0][1],e.segment[1][1])-ie(t.segment[0][1],t.segment[1][1]))});for(var h=d(u),m=[],y=[],f=[],b=-Infinity,p=0;p<r;){for(var _=c[p].x,x=[];p<r;){var v=c[p];if(v.x!==_)break;p+=1,v.segment[0][0]===v.x&&v.segment[1][0]===v.x?v.create&&(v.segment[0][1]<v.segment[1][1]?(x.push(new n(v.segment[0][1],v.index,!0,!0)),x.push(new n(v.segment[1][1],v.index,!1,!1))):(x.push(new n(v.segment[1][1],v.index,!0,!1)),x.push(new n(v.segment[0][1],v.index,!1,!0)))):v.create?h=h.insert(v.segment,v.index):h=h.remove(v.segment)}m.push(h.root),y.push(_),f.push(x)}return new a(m,y,f)};var s=e("binary-search-bounds"),d=e("functional-red-black-tree"),c=e("robust-orientation"),u=e("./lib/order-segments"),g=a.prototype;g.castUp=function(t){var a=s.le(this.coordinates,t[0]);if(0>a)return-1;var n=this.slabs[a],l=i(this.slabs[a],t),d=-1;if(l&&(d=l.value),this.coordinates[a]===t[0]){var p=null;if(l&&(p=l.key),0<a){var g=i(this.slabs[a-1],t);g&&(p?0<u(g.key,p)&&(p=g.key,d=g.value):(d=g.value,p=g.key))}var h=this.horizontal[a];if(0<h.length){var m=s.ge(h,t[1],r);if(m<h.length){var y=h[m];if(t[1]===y.y){if(y.closed)return y.index;for(;m<h.length-1&&h[m+1].y===t[1];)if(++m,y=h[m],y.closed)return y.index;if(y.y===t[1]&&!y.start){if(++m,m>=h.length)return d;y=h[m]}}if(!y.start)y.y!==t[1]&&(d=y.index);else if(p){var f=c(p[0],p[1],[t[0],y.y]);p[0][0]>p[1][0]&&(f=-f),0<f&&(d=y.index)}else d=y.index}}}return d}},{"./lib/order-segments":501,"binary-search-bounds":79,"functional-red-black-tree":219,"robust-orientation":486}],503:[function(e,t){"use strict";function o(e,t){var a=n(i(e,t),[t[t.length-1]]);return a[a.length-1]}function r(e,a,o,l){var s=-a/(l-a);0>s?s=0:1<s&&(s=1);for(var d=1-s,c=e.length,n=Array(c),r=0;r<c;++r)n[r]=s*e[r]+d*o[r];return n}var i=e("robust-dot-product"),n=e("robust-sum");t.exports=function(e,n){for(var l=[],d=[],c=o(e[e.length-1],n),u=e[e.length-1],g=e[0],h=0;h<e.length;++h,u=g){g=e[h];var m=o(g,n);if(0>c&&0<m||0<c&&0>m){var y=r(u,m,g,c);l.push(y),d.push(y.slice())}0>m?d.push(g.slice()):0<m?l.push(g.slice()):(l.push(g.slice()),d.push(g.slice())),c=m}return{positive:l,negative:d}},t.exports.positive=function(e,n){for(var l=[],d=o(e[e.length-1],n),c=e[e.length-1],p=e[0],u=0;u<e.length;++u,c=p){p=e[u];var g=o(p,n);(0>d&&0<g||0<d&&0>g)&&l.push(r(c,g,p,d)),0<=g&&l.push(p.slice()),d=g}return l},t.exports.negative=function(e,n){for(var l=[],d=o(e[e.length-1],n),c=e[e.length-1],p=e[0],u=0;u<e.length;++u,c=p){p=e[u];var g=o(p,n);(0>d&&0<g||0<d&&0>g)&&l.push(r(c,g,p,d)),0>=g&&l.push(p.slice()),d=g}return l}},{"robust-dot-product":483,"robust-sum":491}],504:[function(e,t,a){!function(){"use strict";function e(e){return o(r(e),arguments)}function t(t,a){return e.apply(null,[t].concat(a||[]))}function o(t,a){var o=1,r=t.length,l="",s,d,c,p,u,g,h,m,y;for(d=0;d<r;d++)if("string"==typeof t[d])l+=t[d];else if(Array.isArray(t[d])){if(p=t[d],p[2])for(s=a[o],c=0;c<p[2].length;c++){if(!s.hasOwnProperty(p[2][c]))throw new Error(e("[sprintf] property \"%s\" does not exist",p[2][c]));s=s[p[2][c]]}else s=p[1]?a[p[1]]:a[o++];if(n.not_type.test(p[8])&&n.not_primitive.test(p[8])&&s instanceof Function&&(s=s()),n.numeric_arg.test(p[8])&&"number"!=typeof s&&isNaN(s))throw new TypeError(e("[sprintf] expecting number but found %T",s));switch(n.number.test(p[8])&&(m=0<=s),p[8]){case"b":s=parseInt(s,10).toString(2);break;case"c":s=O(parseInt(s,10));break;case"d":case"i":s=parseInt(s,10);break;case"j":s=JSON.stringify(s,null,p[6]?parseInt(p[6]):0);break;case"e":s=p[7]?parseFloat(s).toExponential(p[7]):parseFloat(s).toExponential();break;case"f":s=p[7]?parseFloat(s).toFixed(p[7]):parseFloat(s);break;case"g":s=p[7]?+s.toPrecision(p[7])+"":parseFloat(s);break;case"o":s=(parseInt(s,10)>>>0).toString(8);break;case"s":s+="",s=p[7]?s.substring(0,p[7]):s;break;case"t":s=!!s+"",s=p[7]?s.substring(0,p[7]):s;break;case"T":s=Object.prototype.toString.call(s).slice(8,-1).toLowerCase(),s=p[7]?s.substring(0,p[7]):s;break;case"u":s=parseInt(s,10)>>>0;break;case"v":s=s.valueOf(),s=p[7]?s.substring(0,p[7]):s;break;case"x":s=(parseInt(s,10)>>>0).toString(16);break;case"X":s=(parseInt(s,10)>>>0).toString(16).toUpperCase();}n.json.test(p[8])?l+=s:(n.number.test(p[8])&&(!m||p[3])?(y=m?"+":"-",s=s.toString().replace(n.sign,"")):y="",g=p[4]?"0"===p[4]?"0":p[4].charAt(1):" ",h=p[6]-(y+s).length,u=p[6]?0<h?g.repeat(h):"":"",l+=p[5]?y+s+u:"0"===g?y+u+s:u+y+s)}return l}function r(e){if(i[e])return i[e];for(var t=e,a=[],o=0,r;t;){if(null!==(r=n.text.exec(t)))a.push(r[0]);else if(null!==(r=n.modulo.exec(t)))a.push("%");else if(null!==(r=n.placeholder.exec(t))){if(r[2]){o|=1;var l=[],s=r[2],d=[];if(null!==(d=n.key.exec(s))){for(l.push(d[1]);""!==(s=s.substring(d[0].length));)if(null!==(d=n.key_access.exec(s)))l.push(d[1]);else if(null!==(d=n.index_access.exec(s)))l.push(d[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");}else throw new SyntaxError("[sprintf] failed to parse named argument key");r[2]=l}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");a.push(r)}else throw new SyntaxError("[sprintf] unexpected placeholder");t=t.substring(r[0].length)}return i[e]=a}var n={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/},i=Object.create(null);"undefined"!=typeof a&&(a.sprintf=e,a.vsprintf=t),"undefined"!=typeof window&&(window.sprintf=e,window.vsprintf=t,"function"==typeof Ca&&Ca.amd&&Ca(function(){return{sprintf:e,vsprintf:t}}))}()},{}],505:[function(e,t){"use strict";var a=e("parenthesis");t.exports=function(e,t,r){if(null==e)throw Error("First argument should be a string");if(null==t)throw Error("Separator should be a string or a RegExp");r?("string"==typeof r||Array.isArray(r))&&(r={ignore:r}):r={},null==r.escape&&(r.escape=!0),null==r.ignore?r.ignore=["[]","()","{}","<>","\"\"","''","``","\u201C\u201D","\xAB\xBB"]:("string"==typeof r.ignore&&(r.ignore=[r.ignore]),r.ignore=r.ignore.map(function(e){return 1===e.length&&(e+=e),e}));var n=a.parse(e,{flat:!0,brackets:r.ignore}),l=n[0],s=l.split(t);if(r.escape){for(var d=[],c=0;c<s.length;c++){var p=s[c],u=s[c+1];"\\"===p[p.length-1]&&"\\"!==p[p.length-2]?(d.push(p+t+u),c++):d.push(p)}s=d}for(var c=0;c<s.length;c++)n[0]=s[c],s[c]=a.stringify(n,{flat:!0});return s}},{parenthesis:441}],506:[function(e,t){"use strict";t.exports=function(t){function a(a){var o=[a],p=[a];for(r[a]=n[a]=g,l[a]=!0,g+=1;0<p.length;){a=p[p.length-1];var y=t[a];if(s[a]<y.length){for(var e=s[a],f;e<y.length;++e){if(f=y[e],0>r[f]){r[f]=n[f]=g,l[f]=!0,g+=1,o.push(f),p.push(f);break}else l[f]&&(n[a]=0|ie(n[a],n[f]));0<=d[f]&&c[a].push(d[f])}s[a]=e}else{if(n[a]===r[a]){for(var x=[],b=[],_=0,e=o.length-1,k;0<=e;--e)if(k=o[e],l[k]=!1,x.push(k),b.push(c[k]),_+=c[k].length,d[k]=h.length,k===a){o.length=e;break}h.push(x);for(var T=Array(_),e=0;e<b.length;e++)for(var A=0;A<b[e].length;A++)T[--_]=b[e][A];m.push(T)}p.pop()}}}for(var o=t.length,r=Array(o),n=Array(o),l=Array(o),s=Array(o),d=Array(o),c=Array(o),p=0;p<o;++p)r[p]=-1,n[p]=0,l[p]=!1,s[p]=0,d[p]=-1,c[p]=[];for(var g=0,h=[],m=[],p=0;p<o;++p)0>r[p]&&a(p);for(var p=0,y,f;p<m.length;p++)if(f=m[p],0!==f.length){f.sort(function(e,t){return e-t}),y=[f[0]];for(var u=1;u<f.length;u++)f[u]!==f[u-1]&&y.push(f[u]);m[p]=y}return{components:h,adjacencyList:m}}},{}],507:[function(e,t){"use strict";function a(e,t){var a=e.length,o=["'use strict';"],s="surfaceNets"+e.join("_")+"d"+t;o.push("var contour=genContour({","order:[",e.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },"),"generic"===t&&o.push("getters:[0],");for(var d=[],c=[],p=0;p<a;++p)d.push("d"+p),c.push("d"+p);for(var p=0;p<1<<a;++p)d.push("v"+p),c.push("v"+p);for(var p=0;p<1<<a;++p)d.push("p"+p),c.push("p"+p);d.push("a","b","c"),c.push("a","c"),o.push("vertex:function vertexFunc(",d.join(),"){");for(var g=[],p=0;p<1<<a;++p)g.push("(p"+p+"<<"+p+")");o.push("var m=(",g.join("+"),")|0;if(m===0||m===",(1<<(1<<a))-1,"){return}");var h=[],m=[];128>=1<<(1<<a)?(o.push("switch(m){"),m=o):o.push("switch(m>>>7){");for(var p=0;p<1<<(1<<a);++p){if(128<1<<(1<<a)&&0==p%128){0<h.length&&m.push("}}");var y="vExtra"+h.length;o.push("case ",p>>>7,":",y,"(m&0x7f,",c.join(),");break;"),m=["function ",y,"(m,",c.join(),"){switch(m){"],h.push(m)}m.push("case ",127&p,":");for(var f=Array(a),x=Array(a),b=Array(a),_=Array(a),v=0,w=0;w<a;++w)f[w]=[],x[w]=[],b[w]=0,_[w]=0;for(var w=0;w<1<<a;++w)for(var T=0,A;T<a;++T)if((A=w^1<<T,!(A>w))&&!(p&1<<A)!=!(p&1<<w)){var S=1;p&1<<A?x[T].push("v"+A+"-v"+w):(x[T].push("v"+w+"-v"+A),S=-S),0>S?(f[T].push("-v"+w+"-v"+A),b[T]+=2):(f[T].push("v"+w+"+v"+A),b[T]-=2),v+=1;for(var C=0;C<a;++C)C!=T&&(A&1<<C?_[C]+=1:_[C]-=1)}for(var L=[],T=0;T<a;++T)if(0===f[T].length)L.push("d"+T+"-0.5");else{var E="";0>b[T]?E=b[T]+"*c":0<b[T]&&(E="+"+b[T]+"*c");var z=.5*(f[T].length/v),I=.5+.5*(_[T]/v);L.push("d"+T+"-"+I+"-"+z+"*("+f[T].join("+")+E+")/("+x[T].join("+")+")")}m.push("a.push([",L.join(),"]);","break;")}o.push("}},"),0<h.length&&m.push("}}");for(var D=[],p=0;p<1<<a-1;++p)D.push("v"+p);D.push("c0","c1","p0","p1","a","b","c"),o.push("cell:function cellFunc(",D.join(),"){");var P=n(a-1);o.push("if(p0){b.push(",P.map(function(e){return"["+e.map(function(e){return"v"+e})+"]"}).join(),")}else{b.push(",P.map(function(t){var a=t.slice();return a.reverse(),"["+a.map(function(e){return"v"+e})+"]"}).join(),")}}});function ",s,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",s,";");for(var p=0;p<h.length;++p)o.push(h[p].join(""));var O=new Function("genContour",o.join(""));return O(r)}function o(e,t){for(var a=l(e,t),o=a.length,r=Array(o),n=Array(o),s=0;s<o;++s)r[s]=[a[s]],n[s]=[s];return{positions:r,cells:n}}t.exports=function(e,t){if(0>=e.dimension)return{positions:[],cells:[]};if(1===e.dimension)return o(e,t);var r=e.order.join()+"-"+e.dtype,i=s[r],t=+t||0;return i||(i=s[r]=a(e.order,e.dtype)),i(e,t)};var r=e("ndarray-extract-contour"),n=e("triangulate-hypercube"),l=e("zero-crossings"),s={}},{"ndarray-extract-contour":422,"triangulate-hypercube":517,"zero-crossings":550}],508:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var o=function(){function e(e,t){var a=[],o=!0,r=!1,i=void 0;try{for(var n=e[Symbol.iterator](),l;!(o=(l=n.next()).done)&&(a.push(l.value),!(t&&a.length===t));o=!0);}catch(e){r=!0,i=e}finally{try{!o&&n["return"]&&n["return"]()}finally{if(r)throw i}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=2*Sa,i=function(e,t,a,o,r,i,n){var l=e.x,s=e.y;l*=t,s*=a;var d=o*l-r*s,c=r*l+o*s;return{x:d+i,y:c+n}},n=function(e,t){var a=.551915024494,o=te(e),r=M(e),i=te(e+t),n=M(e+t);return[{x:o-r*a,y:r+o*a},{x:i+n*a,y:n-i*a},{x:i,y:n}]},l=function(e,t,a,o){var r=0>e*o-t*a?-1:1,i=re(e*e+t*t),n=re(e*e+t*t),l=(e*a+t*o)/(i*n);return 1<l&&(l=1),-1>l&&(l=-1),r*v(l)},s=function(e,t,a,o,i,n,s,d,c,p,u,g){var h=_a(i,2),m=_a(n,2),y=_a(u,2),f=_a(g,2),x=h*m-h*f-m*y;0>x&&(x=0),x/=h*f+m*y,x=re(x)*(s===d?-1:1);var b=x*i/n*g,_=x*-n/i*u,v=(u-b)/i,w=(g-_)/n,k=l(1,0,v,w),T=l(v,w,(-u-b)/i,(-g-_)/n);return 0===d&&0<T&&(T-=r),1===d&&0>T&&(T+=r),[p*b-c*_+(e+a)/2,c*b+p*_+(t+o)/2,k,T]};a.default=function(e){var t=e.px,a=e.py,l=e.cx,d=e.cy,c=e.rx,p=e.ry,u=e.xAxisRotation,g=u===void 0?0:u,h=e.largeArcFlag,m=h===void 0?0:h,y=e.sweepFlag,f=y===void 0?0:y,x=[];if(0===c||0===p)return[];var b=M(g*r/360),_=te(g*r/360),v=_*(t-l)/2+b*(a-d)/2,w=-b*(t-l)/2+_*(a-d)/2;if(0===v&&0===w)return[];c=wa(c),p=wa(p);var k=_a(v,2)/_a(c,2)+_a(w,2)/_a(p,2);1<k&&(c*=re(k),p*=re(k));var T=s(t,a,l,d,c,p,m,f,b,_,v,w),A=o(T,4),S=A[0],C=A[1],L=A[2],E=A[3],z=wa(E)/(r/4);1e-7>wa(1-z)&&(z=1);var I=va(ae(z),1);E/=I;for(var D=0;D<I;D++)x.push(n(L,E)),L+=E;return x.map(function(e){var t=i(e[0],c,p,_,b,S,C),a=t.x,o=t.y,r=i(e[1],c,p,_,b,S,C),n=r.x,l=r.y,s=i(e[2],c,p,_,b,S,C),d=s.x,u=s.y;return{x1:a,y1:o,x2:n,y2:l,x:d,y:u}})},t.exports=a.default},{}],509:[function(e,t){"use strict";var a=e("parse-svg-path"),o=e("abs-svg-path"),r=e("normalize-svg-path"),n=e("is-svg-path"),s=e("assert");t.exports=function(e){if(Array.isArray(e)&&1===e.length&&"string"==typeof e[0]&&(e=e[0]),"string"==typeof e&&(s(n(e),"String is not an SVG path."),e=a(e)),s(Array.isArray(e),"Argument should be a string or an array of path segments."),e=o(e),e=r(e),!e.length)return[0,0,0,0];for(var t=[1/0,1/0,-Infinity,-Infinity],d=0,c=e.length,l;d<c;d++){l=e[d].slice(1);for(var p=0;p<l.length;p+=2)l[p+0]<t[0]&&(t[0]=l[p+0]),l[p+1]<t[1]&&(t[1]=l[p+1]),l[p+0]>t[2]&&(t[2]=l[p+0]),l[p+1]>t[3]&&(t[3]=l[p+1])}return t}},{"abs-svg-path":48,assert:56,"is-svg-path":407,"normalize-svg-path":510,"parse-svg-path":443}],510:[function(e,t){"use strict";function a(e,t,a,o){return["C",e,t,a,o,a,o]}function o(e,t,a,o,r,i){return["C",e/3+2/3*a,t/3+2/3*o,r/3+2/3*a,i/3+2/3*o,r,i]}t.exports=function(e){for(var t=[],n=0,l=0,s=0,d=0,p=null,u=null,g=0,h=0,m=0,f=e.length,b;m<f;m++){var _=e[m],v=_[0];switch(v){case"M":s=_[1],d=_[2];break;case"A":var w=r({px:g,py:h,cx:_[6],cy:_[7],rx:_[1],ry:_[2],xAxisRotation:_[3],largeArcFlag:_[4],sweepFlag:_[5]});if(!w.length)continue;for(var k=0,T;k<w.length;k++)T=w[k],_=["C",T.x1,T.y1,T.x2,T.y2,T.x,T.y],k<w.length-1&&t.push(_);break;case"S":var A=g,S=h;("C"==b||"S"==b)&&(A+=A-n,S+=S-l),_=["C",A,S,_[1],_[2],_[3],_[4]];break;case"T":"Q"==b||"T"==b?(p=2*g-p,u=2*h-u):(p=g,u=h),_=o(g,h,p,u,_[1],_[2]);break;case"Q":p=_[1],u=_[2],_=o(g,h,_[1],_[2],_[3],_[4]);break;case"L":_=a(g,h,_[1],_[2]);break;case"H":_=a(g,h,_[1],h);break;case"V":_=a(g,h,g,_[1]);break;case"Z":_=a(g,h,s,d);}b=v,g=_[_.length-2],h=_[_.length-1],4<_.length?(n=_[_.length-4],l=_[_.length-3]):(n=g,l=h),t.push(_)}return t};var r=e("svg-arc-to-cubic-bezier")},{"svg-arc-to-cubic-bezier":508}],511:[function(e,t){"use strict";function a(){if(null!=c)return c;var e=document.createElement("canvas").getContext("2d");if(e.canvas.width=e.canvas.height=1,!window.Path2D)return c=!1;var t=new Path2D("M0,0h1v1h-1v-1Z");e.fillStyle="black",e.fill(t);var a=e.getImageData(0,0,1,1);return c=a&&a.data&&255===a.data[3]}var o=e("svg-path-bounds"),r=e("parse-svg-path"),i=e("draw-svg-path"),n=e("is-svg-path"),l=e("bitmap-sdf"),s=document.createElement("canvas"),d=s.getContext("2d");t.exports=function(e,t){if(!n(e))throw Error("Argument should be valid svg path string");t||(t={});var c,p;t.shape?(c=t.shape[0],p=t.shape[1]):(c=s.width=t.w||t.width||200,p=s.height=t.h||t.height||200);var u=ie(c,p),g=t.stroke||0,m=t.viewbox||t.viewBox||o(e),y=[c/(m[2]-m[0]),p/(m[3]-m[1])],f=ie(y[0]||0,y[1]||0)/2;if(d.fillStyle="black",d.fillRect(0,0,c,p),d.fillStyle="white",g&&("number"!=typeof g&&(g=1),d.strokeStyle=0<g?"white":"black",d.lineWidth=wa(g)),d.translate(.5*c,.5*p),d.scale(f,f),a()){var x=new Path2D(e);d.fill(x),g&&d.stroke(x)}else{var b=r(e);i(d,b),d.fill(),g&&d.stroke()}d.setTransform(1,0,0,1,0,0);var _=l(d,{cutoff:null==t.cutoff?.5:t.cutoff,radius:null==t.radius?.5*u:t.radius});return _};var c},{"bitmap-sdf":81,"draw-svg-path":153,"is-svg-path":407,"parse-svg-path":443,"svg-path-bounds":509}],512:[function(e,t){(function(a){"use strict";function o(e){for(var t=e.cells,a=e.positions,o=new Float32Array(6*t.length),r=0,n=0,l=0,s;l<t.length;++l){s=t[l];for(var d=0,c;3>d;++d)c=a[s[d]],o[r++]=c[0],o[r++]=c[1]+1.4,n=va(c[0],n)}return{data:o,shape:n}}function r(e,t,a){var a=a||{},l=s[e];l||(l=s[e]={" ":{data:new Float32Array(0),shape:.2}});var d=l[t];if(!d)if(1>=t.length||!/\d/.test(t))d=l[t]=o(n(t,{triangles:!0,font:e,textAlign:a.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var c=t.split(/(\d|\s)/),p=Array(c.length),u=0,g=0,h=0;h<c.length;++h)p[h]=r(e,c[h]),u+=p[h].data.length,g+=p[h].shape,0<h&&(g+=.02);for(var m=new Float32Array(u),y=0,f=-.5*g,h=0,x;h<p.length;++h){x=p[h].data;for(var b=0;b<x.length;b+=2)m[y++]=x[b]+f,m[y++]=x[b+1];f+=p[h].shape+.02}d=l[t]={data:m,shape:g}}return d}t.exports=r;var n=e("vectorize-text"),l=window||a.global||{},s=l.__TEXT_CACHE||{};l.__TEXT_CACHE={}}).call(this,e("_process"))},{_process:465,"vectorize-text":526}],513:[function(e,t){(function(e){function a(e,t){if(e=e?e:"",t=t||{},e instanceof a)return e;if(!(this instanceof a))return new a(e,t);var r=o(e);this._originalInput=e,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=H(100*this._a)/100,this._format=t.format||r.format,this._gradientType=t.gradientType,1>this._r&&(this._r=H(this._r)),1>this._g&&(this._g=H(this._g)),1>this._b&&(this._b=H(this._b)),this._ok=r.ok,this._tc_id=U++}function o(e){var t={r:0,g:0,b:0},o=1,i=null,c=null,p=null,u=!1,g=!1;return"string"==typeof e&&(e=B(e)),"object"==typeof e&&(j(e.r)&&j(e.g)&&j(e.b)?(t=r(e.r,e.g,e.b),u=!0,g="%"===(e.r+"").substr(-1)?"prgb":"rgb"):j(e.h)&&j(e.s)&&j(e.v)?(i=P(e.s),c=P(e.v),t=d(e.h,i,c),u=!0,g="hsv"):j(e.h)&&j(e.s)&&j(e.l)&&(i=P(e.s),p=P(e.l),t=n(e.h,i,p),u=!0,g="hsl"),e.hasOwnProperty("a")&&(o=e.a)),o=S(o),{ok:u,format:e.format||g,r:G(255,Y(t.r,0)),g:G(255,Y(t.g,0)),b:G(255,Y(t.b,0)),a:o}}function r(e,t,a){return{r:255*C(e,255),g:255*C(t,255),b:255*C(a,255)}}function i(e,t,a){e=C(e,255),t=C(t,255),a=C(a,255);var o=Y(e,t,a),i=G(e,t,a),n=(o+i)/2,l,c;if(o==i)l=c=0;else{var p=o-i;c=.5<n?p/(2-o-i):p/(o+i);o===e?l=(t-a)/p+(t<a?6:0):o===t?l=(a-e)/p+2:o===a?l=(e-t)/p+4:void 0;l/=6}return{h:l,s:c,l:n}}function n(e,t,a){function o(e,a,o){return 0>o&&(o+=1),1<o&&(o-=1),o<1/6?e+6*(a-e)*o:o<1/2?a:o<2/3?e+6*((a-e)*(2/3-o)):e}var i,n,d;if(e=C(e,360),t=C(t,100),a=C(a,100),0===t)i=n=d=a;else{var c=.5>a?a*(1+t):a+t-a*t,u=2*a-c;i=o(u,c,e+1/3),n=o(u,c,e),d=o(u,c,e-1/3)}return{r:255*i,g:255*n,b:255*d}}function l(e,t,a){e=C(e,255),t=C(t,255),a=C(a,255);var o=Y(e,t,a),i=G(e,t,a),n=o-i,l,d;return d=0===o?0:n/o,o==i?l=0:(o===e?l=(t-a)/n+(t<a?6:0):o===t?l=(a-e)/n+2:o===a?l=(e-t)/n+4:void 0,l/=6),{h:l,s:d,v:o}}function d(e,a,o){e=6*C(e,360),a=C(a,100),o=C(o,100);var n=ea(e),i=e-n,l=o*(1-a),d=o*(1-i*a),c=o*(1-(1-i)*a),t=n%6,p=[o,d,l,l,c,o][t],r=[c,o,o,d,l,l][t],u=[l,l,c,o,o,d][t];return{r:255*p,g:255*r,b:255*u}}function c(e,t,a,o){var r=[D(H(e).toString(16)),D(H(t).toString(16)),D(H(a).toString(16))];return o&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function p(e,t,o,r,a){var i=[D(H(e).toString(16)),D(H(t).toString(16)),D(H(o).toString(16)),D(O(r))];return a&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)&&i[3].charAt(0)==i[3].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0)+i[3].charAt(0):i.join("")}function u(e,t,o,r){var a=[D(O(r)),D(H(e).toString(16)),D(H(t).toString(16)),D(H(o).toString(16))];return a.join("")}function g(e,t){t=0===t?0:t||10;var o=a(e).toHsl();return o.s-=t/100,o.s=L(o.s),a(o)}function h(e,t){t=0===t?0:t||10;var o=a(e).toHsl();return o.s+=t/100,o.s=L(o.s),a(o)}function m(e){return a(e).desaturate(100)}function y(e,t){t=0===t?0:t||10;var o=a(e).toHsl();return o.l+=t/100,o.l=L(o.l),a(o)}function f(e,t){t=0===t?0:t||10;var o=a(e).toRgb();return o.r=Y(0,G(255,o.r-H(255*-(t/100)))),o.g=Y(0,G(255,o.g-H(255*-(t/100)))),o.b=Y(0,G(255,o.b-H(255*-(t/100)))),a(o)}function x(e,t){t=0===t?0:t||10;var o=a(e).toHsl();return o.l-=t/100,o.l=L(o.l),a(o)}function b(e,t){var o=a(e).toHsl(),r=(o.h+t)%360;return o.h=0>r?360+r:r,a(o)}function _(e){var t=a(e).toHsl();return t.h=(t.h+180)%360,a(t)}function v(e){var t=a(e).toHsl(),o=t.h;return[a(e),a({h:(o+120)%360,s:t.s,l:t.l}),a({h:(o+240)%360,s:t.s,l:t.l})]}function w(e){var t=a(e).toHsl(),o=t.h;return[a(e),a({h:(o+90)%360,s:t.s,l:t.l}),a({h:(o+180)%360,s:t.s,l:t.l}),a({h:(o+270)%360,s:t.s,l:t.l})]}function k(e){var t=a(e).toHsl(),o=t.h;return[a(e),a({h:(o+72)%360,s:t.s,l:t.l}),a({h:(o+216)%360,s:t.s,l:t.l})]}function T(e,t,o){t=t||6,o=o||30;var r=a(e).toHsl(),i=360/o,n=[a(e)];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,n.push(a(r));return n}function A(e,t){t=t||6;for(var o=a(e).toHsv(),r=o.h,i=o.s,n=o.v,l=[],s=1/t;t--;)l.push(a({h:r,s:i,v:n})),n=(n+s)%1;return l}function S(e){return e=parseFloat(e),(isNaN(e)||0>e||1<e)&&(e=1),e}function C(e,t){z(e)&&(e="100%");var a=I(e);return e=G(t,Y(0,parseFloat(e))),a&&(e=parseInt(e*t,10)/100),1e-6>wa(e-t)?1:e%t/parseFloat(t)}function L(e){return G(1,Y(0,e))}function E(e){return parseInt(e,16)}function z(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)}function I(e){return"string"==typeof e&&-1!=e.indexOf("%")}function D(e){return 1==e.length?"0"+e:""+e}function P(e){return 1>=e&&(e=100*e+"%"),e}function O(e){return R(255*parseFloat(e)).toString(16)}function M(e){return E(e)/255}function j(e){return!!Z.CSS_UNIT.exec(e)}function B(e){e=e.replace(N,"").replace(V,"").toLowerCase();var t=!1;if(W[e])e=W[e],t=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};var a;return(a=Z.rgb.exec(e))?{r:a[1],g:a[2],b:a[3]}:(a=Z.rgba.exec(e))?{r:a[1],g:a[2],b:a[3],a:a[4]}:(a=Z.hsl.exec(e))?{h:a[1],s:a[2],l:a[3]}:(a=Z.hsla.exec(e))?{h:a[1],s:a[2],l:a[3],a:a[4]}:(a=Z.hsv.exec(e))?{h:a[1],s:a[2],v:a[3]}:(a=Z.hsva.exec(e))?{h:a[1],s:a[2],v:a[3],a:a[4]}:(a=Z.hex8.exec(e))?{r:E(a[1]),g:E(a[2]),b:E(a[3]),a:M(a[4]),format:t?"name":"hex8"}:(a=Z.hex6.exec(e))?{r:E(a[1]),g:E(a[2]),b:E(a[3]),format:t?"name":"hex"}:(a=Z.hex4.exec(e))?{r:E(a[1]+""+a[1]),g:E(a[2]+""+a[2]),b:E(a[3]+""+a[3]),a:M(a[4]+""+a[4]),format:t?"name":"hex8"}:!!(a=Z.hex3.exec(e))&&{r:E(a[1]+""+a[1]),g:E(a[2]+""+a[2]),b:E(a[3]+""+a[3]),format:t?"name":"hex"}}function F(e){var t,a;return e=e||{level:"AA",size:"small"},t=(e.level||"AA").toUpperCase(),a=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA"),"small"!==a&&"large"!==a&&(a="small"),{level:t,size:a}}var N=/^\s+/,V=/\s+$/,U=0,H=R,G=ie,Y=va,q=e.random;a.prototype={isDark:function(){return 128>this.getBrightness()},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e=this.toRgb(),t,a,o,r,i,n;return t=e.r/255,a=e.g/255,o=e.b/255,r=.03928>=t?t/12.92:_a((t+.055)/1.055,2.4),i=.03928>=a?a/12.92:_a((a+.055)/1.055,2.4),n=.03928>=o?o/12.92:_a((o+.055)/1.055,2.4),.2126*r+.7152*i+.0722*n},setAlpha:function(e){return this._a=S(e),this._roundA=H(100*this._a)/100,this},toHsv:function(){var e=l(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=l(this._r,this._g,this._b),t=H(360*e.h),a=H(100*e.s),o=H(100*e.v);return 1==this._a?"hsv("+t+", "+a+"%, "+o+"%)":"hsva("+t+", "+a+"%, "+o+"%, "+this._roundA+")"},toHsl:function(){var e=i(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=i(this._r,this._g,this._b),t=H(360*e.h),a=H(100*e.s),o=H(100*e.l);return 1==this._a?"hsl("+t+", "+a+"%, "+o+"%)":"hsla("+t+", "+a+"%, "+o+"%, "+this._roundA+")"},toHex:function(e){return c(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return p(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:H(this._r),g:H(this._g),b:H(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+H(this._r)+", "+H(this._g)+", "+H(this._b)+")":"rgba("+H(this._r)+", "+H(this._g)+", "+H(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:H(100*C(this._r,255))+"%",g:H(100*C(this._g,255))+"%",b:H(100*C(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+H(100*C(this._r,255))+"%, "+H(100*C(this._g,255))+"%, "+H(100*C(this._b,255))+"%)":"rgba("+H(100*C(this._r,255))+"%, "+H(100*C(this._g,255))+"%, "+H(100*C(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(1>this._a)&&(X[c(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+u(this._r,this._g,this._b,this._a),o=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var i=a(e);o="#"+u(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+o+")"},toString:function(e){var t=!!e;e=e||this._format;var a=!1,o=1>this._a&&0<=this._a,r=!t&&o&&("hex"===e||"hex6"===e||"hex3"===e||"hex4"===e||"hex8"===e||"name"===e);return r?"name"===e&&0===this._a?this.toName():this.toRgbString():("rgb"===e&&(a=this.toRgbString()),"prgb"===e&&(a=this.toPercentageRgbString()),("hex"===e||"hex6"===e)&&(a=this.toHexString()),"hex3"===e&&(a=this.toHexString(!0)),"hex4"===e&&(a=this.toHex8String(!0)),"hex8"===e&&(a=this.toHex8String()),"name"===e&&(a=this.toName()),"hsl"===e&&(a=this.toHslString()),"hsv"===e&&(a=this.toHsvString()),a||this.toHexString())},clone:function(){return a(this.toString())},_applyModification:function(e,t){var a=e.apply(null,[this].concat([].slice.call(t)));return this._r=a._r,this._g=a._g,this._b=a._b,this.setAlpha(a._a),this},lighten:function(){return this._applyModification(y,arguments)},brighten:function(){return this._applyModification(f,arguments)},darken:function(){return this._applyModification(x,arguments)},desaturate:function(){return this._applyModification(g,arguments)},saturate:function(){return this._applyModification(h,arguments)},greyscale:function(){return this._applyModification(m,arguments)},spin:function(){return this._applyModification(b,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(T,arguments)},complement:function(){return this._applyCombination(_,arguments)},monochromatic:function(){return this._applyCombination(A,arguments)},splitcomplement:function(){return this._applyCombination(k,arguments)},triad:function(){return this._applyCombination(v,arguments)},tetrad:function(){return this._applyCombination(w,arguments)}},a.fromRatio=function(e,t){if("object"==typeof e){var o={};for(var r in e)e.hasOwnProperty(r)&&(o[r]="a"==r?e[r]:P(e[r]));e=o}return a(e,t)},a.equals=function(e,t){return!!(e&&t)&&a(e).toRgbString()==a(t).toRgbString()},a.random=function(){return a.fromRatio({r:q(),g:q(),b:q()})},a.mix=function(e,t,o){o=0===o?0:o||50;var r=a(e).toRgb(),i=a(t).toRgb(),n=o/100,l={r:(i.r-r.r)*n+r.r,g:(i.g-r.g)*n+r.g,b:(i.b-r.b)*n+r.b,a:(i.a-r.a)*n+r.a};return a(l)},a.readability=function(e,t){var o=a(e),r=a(t);return(va(o.getLuminance(),r.getLuminance())+.05)/(ie(o.getLuminance(),r.getLuminance())+.05)},a.isReadable=function(e,t,o){var r=a.readability(e,t),i,n;switch(n=!1,i=F(o),i.level+i.size){case"AAsmall":case"AAAlarge":n=4.5<=r;break;case"AAlarge":n=3<=r;break;case"AAAsmall":n=7<=r;}return n},a.mostReadable=function(e,t,o){var r=null,n=0,l,s,d,c;o=o||{},s=o.includeFallbackColors,d=o.level,c=o.size;for(var p=0;p<t.length;p++)l=a.readability(e,t[p]),l>n&&(n=l,r=a(t[p]));return a.isReadable(e,r,{level:d,size:c})||!s?r:(o.includeFallbackColors=!1,a.mostReadable(e,["#fff","#000"],o))};var W=a.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},X=a.hexNames=function(e){var t={};for(var a in e)e.hasOwnProperty(a)&&(t[e[a]]=a);return t}(W),Z=function(){var e="(?:"+"[-\\+]?\\d*\\.\\d+%?"+")|(?:"+"[-\\+]?\\d+%?"+")",t="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",a="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?";return{CSS_UNIT:new RegExp(e),rgb:new RegExp("rgb"+t),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+t),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+t),hsva:new RegExp("hsva"+a),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();"undefined"!=typeof t&&t.exports?t.exports=a:"function"==typeof Ca&&Ca.amd?Ca(function(){return a}):window.tinycolor=a})(Math)},{}],514:[function(e,t){"use strict";function a(e){if(e instanceof Float32Array)return e;if("number"==typeof e)return new Float32Array([e])[0];var t=new Float32Array(e);return t.set(e),t}t.exports=a,t.exports.float32=t.exports.float=a,t.exports.fract32=t.exports.fract=function(e){if("number"==typeof e)return a(e-a(e));for(var t=a(e),o=0,r=t.length;o<r;o++)t[o]=e[o]-t[o];return t}},{}],515:[function(e,t){"use strict";function a(e,t){var a=i(getComputedStyle(e).getPropertyValue(t));return a[0]*r(a[1],e)}function o(e,t){var o=document.createElement("div");o.style["font-size"]="128"+e,t.appendChild(o);var r=a(o,"font-size")/128;return t.removeChild(o),r}function r(e,t){return t=t||document.body,e=(e||"px").trim().toLowerCase(),(t===window||t===document)&&(t=document.body),"%"===e?t.clientHeight/100:"ch"===e||"ex"===e?o(e,t):"em"===e?a(t,"font-size"):"rem"===e?a(document.body,"font-size"):"vw"===e?window.innerWidth/100:"vh"===e?window.innerHeight/100:"vmin"===e?ie(window.innerWidth,window.innerHeight)/100:"vmax"===e?va(window.innerWidth,window.innerHeight)/100:"in"===e?96:"cm"===e?96/2.54:"mm"===e?96/25.4:"pt"===e?96/72:"pc"===e?16:1}var i=e("parse-unit");t.exports=r},{"parse-unit":444}],516:[function(e,t,a){(function(e,o){"object"==typeof a&&"undefined"!=typeof t?o(a):"function"==typeof Ca&&Ca.amd?Ca(["exports"],o):o(e.topojson=e.topojson||{})})(this,function(e){"use strict";function t(e,t){var o=t.id,r=t.bbox,i=null==t.properties?{}:t.properties,n=a(e,t);return null==o&&null==r?{type:"Feature",properties:i,geometry:n}:null==r?{type:"Feature",id:o,properties:i,geometry:n}:{type:"Feature",id:o,bbox:r,properties:i,geometry:n}}function a(e,t){function a(e,t){t.length&&t.pop();for(var o=g[0>e?~e:e],a=0,r=o.length;a<r;++a)t.push(u(o[a].slice(),a));0>e&&c(t,r)}function r(e){return u(e.slice())}function i(e){for(var t=[],o=0,r=e.length;o<r;++o)a(e[o],t);return 2>t.length&&t.push(t[0].slice()),t}function n(e){for(var t=i(e);4>t.length;)t.push(t[0].slice());return t}function l(e){return e.map(n)}function d(e){var t=e.type,a;switch(t){case"GeometryCollection":return{type:t,geometries:e.geometries.map(d)};case"Point":a=r(e.coordinates);break;case"MultiPoint":a=e.coordinates.map(r);break;case"LineString":a=i(e.arcs);break;case"MultiLineString":a=e.arcs.map(i);break;case"Polygon":a=l(e.arcs);break;case"MultiPolygon":a=e.arcs.map(l);break;default:return null;}return{type:t,coordinates:a}}var u=s(e),g=e.arcs;return d(t)}function o(e,t,a){var o,l,s;if(1<arguments.length)o=r(e,t,a);else for(l=0,o=Array(s=e.arcs.length);l<s;++l)o[l]=l;return{type:"MultiLineString",arcs:p(e,o)}}function r(e,t,a){function o(e){var t=0>e?~e:e;(d[t]||(d[t]=[])).push({i:e,g:c})}function r(e){e.forEach(o)}function i(e){e.forEach(r)}function n(e){e.forEach(i)}function l(e){switch(c=e,e.type){case"GeometryCollection":e.geometries.forEach(l);break;case"LineString":r(e.arcs);break;case"MultiLineString":case"Polygon":i(e.arcs);break;case"MultiPolygon":n(e.arcs);}}var s=[],d=[],c;return l(t),d.forEach(null==a?function(e){s.push(e[0].i)}:function(e){a(e[0].g,e[e.length-1].g)&&s.push(e[0].i)}),s}function i(e){for(var t=-1,o=e.length,r=e[o-1],n=0,l;++t<o;)l=r,r=e[t],n+=l[0]*r[1]-l[1]*r[0];return wa(n)}function n(e,t){function r(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(r);break;case"Polygon":n(e.arcs);break;case"MultiPolygon":e.arcs.forEach(n);}}function n(e){e.forEach(function(t){t.forEach(function(t){(s[t=0>t?~t:t]||(s[t]=[])).push(e)})}),d.push(e)}function l(t){return i(a(e,{type:"Polygon",arcs:[t]}).coordinates[0])}var s={},d=[],c=[];return t.forEach(r),d.forEach(function(e){if(!e._){var t=[],a=[e];for(e._=1,c.push(t);e=a.pop();)t.push(e),e.forEach(function(e){e.forEach(function(e){s[0>e?~e:e].forEach(function(e){e._||(e._=1,a.push(e))})})})}}),d.forEach(function(e){delete e._}),{type:"MultiPolygon",arcs:c.map(function(a){var o=[],r;if(a.forEach(function(e){e.forEach(function(e){e.forEach(function(e){2>s[0>e?~e:e].length&&o.push(e)})})}),o=p(e,o),1<(r=o.length))for(var d=1,c=l(o[0]),u,g;d<r;++d)(u=l(o[d]))>c&&(g=o[0],o[0]=o[d],o[d]=g,c=u);return o})}}var l=function(e){return e},s=function(e){if(null==(i=e.transform))return l;var t=i.scale[0],a=i.scale[1],o=i.translate[0],r=i.translate[1],i,n,s;return function(e,l){return l||(n=s=0),e[0]=(n+=e[0])*t+o,e[1]=(s+=e[1])*a+r,e}},d=function(e){function a(e){t[0]=e[0],t[1]=e[1],l(t),t[0]<o&&(o=t[0]),t[0]>c&&(c=t[0]),t[1]<d&&(d=t[1]),t[1]>p&&(p=t[1])}function r(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(r);break;case"Point":a(e.coordinates);break;case"MultiPoint":e.coordinates.forEach(a);}}var i=e.bbox;if(!i){var l=s(e),t=[,,],o=1/0,d=o,c=-o,p=-o,u,n;for(n in e.arcs.forEach(function(e){for(var a=-1,r=e.length;++a<r;)u=e[a],t[0]=u[0],t[1]=u[1],l(t,a),t[0]<o&&(o=t[0]),t[0]>c&&(c=t[0]),t[1]<d&&(d=t[1]),t[1]>p&&(p=t[1])}),e.objects)r(e.objects[n]);i=e.bbox=[o,d,c,p]}return i},c=function(e,a){for(var o=e.length,r=o-a,n;r<--o;)n=e[r],e[r++]=e[o],e[o]=n},p=function(e,a){function o(t){var a=e.arcs[0>t?~t:t],o=a[0],r;return e.transform?(r=[0,0],a.forEach(function(e){r[0]+=e[0],r[1]+=e[1]})):r=a[a.length-1],0>t?[r,o]:[o,r]}function r(e,t){for(var a in e){var o=e[a];delete t[o.start],delete o.start,delete o.end,o.forEach(function(e){n[0>e?~e:e]=1}),d.push(o)}}var n={},l={},s={},d=[],c=-1;return a.forEach(function(o,r){var i=e.arcs[0>o?~o:o],n;!(3>i.length)||i[1][0]||i[1][1]||(n=a[++c],a[c]=o,a[r]=n)}),a.forEach(function(t){var a=o(t),e=a[0],r=a[1],i,n;if(i=s[e]){if(delete s[i.end],i.push(t),i.end=r,n=l[r]){delete l[n.start];var d=n===i?i:i.concat(n);l[d.start=i.start]=s[d.end=n.end]=d}else l[i.start]=s[i.end]=i;}else if(!(i=l[r]))i=[t],l[i.start=e]=s[i.end=r]=i;else if(delete l[i.start],i.unshift(t),i.start=e,n=s[e]){delete s[n.end];var c=n===i?i:n.concat(i);l[c.start=n.start]=s[c.end=i.end]=c}else l[i.start]=s[i.end]=i}),r(s,l),r(l,s),a.forEach(function(e){n[0>e?~e:e]||d.push([e])}),d},u=function(e,t){for(var a=0,o=e.length;a<o;){var r=a+o>>>1;e[r]<t?a=r+1:o=r}return a};e.bbox=d,e.feature=function(e,a){return"GeometryCollection"===a.type?{type:"FeatureCollection",features:a.geometries.map(function(a){return t(e,a)})}:t(e,a)},e.mesh=function(e){return a(e,o.apply(this,arguments))},e.meshArcs=o,e.merge=function(e){return a(e,n.apply(this,arguments))},e.mergeArcs=n,e.neighbors=function(e){function t(e,t){e.forEach(function(e){0>e&&(e=~e);var r=l[e];r?r.push(t):l[e]=[t]})}function a(e,a){e.forEach(function(e){t(e,a)})}function r(e,t){"GeometryCollection"===e.type?e.geometries.forEach(function(e){r(e,t)}):e.type in d&&d[e.type](e.arcs,t)}var l={},s=e.map(function(){return[]}),d={LineString:t,MultiLineString:a,Polygon:a,MultiPolygon:function(e,t){e.forEach(function(e){a(e,t)})}};for(var c in e.forEach(r),l)for(var o=l[c],p=o.length,g=0;g<p;++g)for(var h=g+1;h<p;++h){var m=o[g],y=o[h],f;(f=s[m])[c=u(f,y)]!==y&&f.splice(c,0,y),(f=s[y])[c=u(f,m)]!==m&&f.splice(c,0,m)}return s},e.quantize=function(e,t){function a(e){e[0]=R((e[0]-o)/l),e[1]=R((e[1]-s)/c)}function r(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(r);break;case"Point":a(e.coordinates);break;case"MultiPoint":e.coordinates.forEach(a);}}if(!(2<=(t=ea(t))))throw new Error("n must be \u22652");if(e.transform)throw new Error("already quantized");var i=d(e),o=i[0],l=(i[2]-o)/(t-1)||1,s=i[1],c=(i[3]-s)/(t-1)||1,p;for(p in e.arcs.forEach(function(e){for(var t=1,a=1,r=e.length,n=e[0],d=n[0]=R((n[0]-o)/l),p=n[1]=R((n[1]-s)/c),u,g,h;t<r;++t)n=e[t],g=R((n[0]-o)/l),h=R((n[1]-s)/c),(g!==d||h!==p)&&(u=e[a++],u[0]=g-d,d=g,u[1]=h-p,p=h);2>a&&(u=e[a++],u[0]=0,u[1]=0),e.length=a}),e.objects)r(e.objects[p]);return e.transform={scale:[l,c],translate:[o,s]},e},e.transform=s,e.untransform=function(e){if(null==(i=e.transform))return l;var t=i.scale[0],a=i.scale[1],o=i.translate[0],r=i.translate[1],i,n,s;return function(e,l){l||(n=s=0);var i=R((e[0]-o)/t),d=R((e[1]-r)/a);return e[0]=i-n,n=i,e[1]=d-s,s=d,e}},Object.defineProperty(e,"__esModule",{value:!0})})},{}],517:[function(e,t){"use strict";t.exports=function(e){if(0>e)return[];if(0===e)return[[0]];for(var t=0|R(r(e+1)),n=[],l=0;l<t;++l){for(var s=a.unrank(e,l),d=[0],c=0,p=0;p<s.length;++p)c+=1<<s[p],d.push(c);1>o(s)&&(d[0]=c,d[e]=0),n.push(d)}return n};var a=e("permutation-rank"),o=e("permutation-parity"),r=e("gamma")},{gamma:220,"permutation-parity":446,"permutation-rank":447}],518:[function(e,t){"use strict";function a(e,t,a){return re(_a(e,2)+_a(t,2)+_a(a,2))}function o(e){return ie(1,va(-1,e))}function r(e){var t=wa(e[0]),a=wa(e[1]),o=wa(e[2]),r=[0,0,0];t>va(a,o)?r[2]=1:a>va(t,o)?r[0]=1:r[1]=1;for(var n=0,l=0,s=0;3>s;++s)n+=e[s]*e[s],l+=r[s]*e[s];for(var s=0;3>s;++s)r[s]-=l/n*e[s];return p(r,r),r}function i(e,t,a,o,r,n,s,d){this.center=l(a),this.up=l(o),this.right=l(r),this.radius=l([n]),this.angle=l([s,d]),this.angle.bounds=[[-Infinity,-Sa/2],[1/0,Sa/2]],this.setDistanceLimits(e,t),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=Array(16);for(var c=0;16>c;++c)this.computedMatrix[c]=.5;this.recalcMatrix(0)}function n(e){e=e||{};var t=e.center||[0,0,0],o=e.up||[0,1,0],n=e.right||r(o),l=e.radius||1,s=e.theta||0,d=e.phi||0;if(t=[].slice.call(t,0,3),o=[].slice.call(o,0,3),p(o,o),n=[].slice.call(n,0,3),p(n,n),"eye"in e){var g=e.eye,h=[g[0]-t[0],g[1]-t[1],g[2]-t[2]];c(n,h,o),1e-6>a(n[0],n[1],n[2])?n=r(o):p(n,n),l=a(h[0],h[1],h[2]);var m=u(o,h)/l,y=u(n,h)/l;d=v(m),s=v(y)}return l=P(l),new i(e.zoomMin,e.zoomMax,t,o,n,l,s,d)}t.exports=n;var l=e("filtered-vector"),s=e("gl-mat4/invert"),d=e("gl-mat4/rotate"),c=e("gl-vec3/cross"),p=e("gl-vec3/normalize"),u=e("gl-vec3/dot"),g=i.prototype;g.setDistanceLimits=function(e,t){e=0<e?P(e):-Infinity,t=0<t?P(t):1/0,t=va(t,e),this.radius.bounds[0][0]=e,this.radius.bounds[1][0]=t},g.getDistanceLimits=function(e){var t=this.radius.bounds[0];return e?(e[0]=ka(t[0][0]),e[1]=ka(t[1][0]),e):[ka(t[0][0]),ka(t[1][0])]},g.recalcMatrix=function(e){this.center.curve(e),this.up.curve(e),this.right.curve(e),this.radius.curve(e),this.angle.curve(e);for(var t=this.computedUp,o=this.computedRight,r=0,n=0,l=0;3>l;++l)n+=t[l]*o[l],r+=t[l]*t[l];for(var s=re(r),d=0,l=0;3>l;++l)o[l]-=t[l]*n/r,d+=o[l]*o[l],t[l]/=s;for(var u=re(d),l=0;3>l;++l)o[l]/=u;var g=this.computedToward;c(g,t,o),p(g,g);for(var h=ka(this.computedRadius[0]),m=this.computedAngle[0],y=this.computedAngle[1],f=te(m),b=M(m),_=te(y),v=M(y),w=this.computedCenter,k=this.computedEye,T=this.computedMatrix,l=0,A;3>l;++l)A=f*_*o[l]+b*_*g[l]+v*t[l],T[4*l+1]=-f*v*o[l]+-b*v*g[l]+_*t[l],T[4*l+2]=A,T[4*l+3]=0;var S=T[1],C=T[5],L=T[9],E=T[2],z=T[6],I=T[10],D=C*I-L*z,P=L*E-S*I,O=S*z-C*E,R=a(D,P,O);D/=R,P/=R,O/=R,T[0]=D,T[4]=P,T[8]=O;for(var l=0;3>l;++l)k[l]=w[l]+T[2+4*l]*h;for(var l=0,d;3>l;++l){d=0;for(var B=0;3>B;++B)d+=T[l+4*B]*k[B];T[12+l]=-d}T[15]=1},g.getMatrix=function(e,t){this.recalcMatrix(e);var a=this.computedMatrix;if(t){for(var o=0;16>o;++o)t[o]=a[o];return t}return a};var h=[0,0,0];g.rotate=function(e,t,a,o){if(this.angle.move(e,t,a),o){this.recalcMatrix(e);var r=this.computedMatrix;h[0]=r[2],h[1]=r[6],h[2]=r[10];for(var n=this.computedUp,l=this.computedRight,s=this.computedToward,c=0;3>c;++c)r[4*c]=n[c],r[4*c+1]=l[c],r[4*c+2]=s[c];d(r,r,o,h);for(var c=0;3>c;++c)n[c]=r[4*c],l[c]=r[4*c+1];this.up.set(e,n[0],n[1],n[2]),this.right.set(e,l[0],l[1],l[2])}},g.pan=function(e,t,o,r){t=t||0,o=o||0,r=r||0,this.recalcMatrix(e);var i=this.computedMatrix,n=ka(this.computedRadius[0]),l=i[1],s=i[5],d=i[9],c=a(l,s,d);l/=c,s/=c,d/=c;var p=i[0],u=i[4],g=i[8],h=p*l+u*s+g*d;p-=l*h,u-=s*h,g-=d*h;var m=a(p,u,g);p/=m,u/=m,g/=m;var y=p*t+l*o,f=u*t+s*o,x=g*t+d*o;this.center.move(e,y,f,x);var b=ka(this.computedRadius[0]);b=va(1e-4,b+r),this.radius.set(e,P(b))},g.translate=function(e,t,a,o){this.center.move(e,t||0,a||0,o||0)},g.setMatrix=function(e,t,r,i){var n=1;"number"==typeof r&&(n=0|r),(0>n||3<n)&&(n=1);var l=(n+2)%3;t||(this.recalcMatrix(e),t=this.computedMatrix);var d=t[n],c=t[n+4],p=t[n+8];if(!i){var u=a(d,c,p);d/=u,c/=u,p/=u}else{var g=wa(d),h=wa(c),m=wa(p),y=va(g,h,m);g===y?(d=0>d?-1:1,c=p=0):m===y?(p=0>p?-1:1,d=c=0):(c=0>c?-1:1,d=p=0)}var f=t[l],x=t[l+4],b=t[l+8],v=f*d+x*c+b*p;f-=d*v,x-=c*v,b-=p*v;var k=a(f,x,b);f/=k,x/=k,b/=k;var T=c*b-p*x,A=p*f-d*b,S=d*x-c*f,C=a(T,A,S);T/=C,A/=C,S/=C,this.center.jump(e,void 0,void 0,void 0),this.radius.idle(e),this.up.jump(e,d,c,p),this.right.jump(e,f,x,b);var E,z;if(2==n){var I=t[1],D=t[5],P=t[9],O=I*f+D*x+P*b,R=I*T+D*A+P*S;E=0>F?-Sa/2:Sa/2,z=L(R,O)}else{var M=t[2],j=t[6],B=t[10],F=M*d+j*c+B*p,N=M*f+j*x+B*b,V=M*T+j*A+B*S;E=_(o(F)),z=L(V,N)}this.angle.jump(e,z,E),this.recalcMatrix(e);var U=t[2],H=t[6],G=t[10],Y=this.computedMatrix;s(Y,t);var q=Y[15],w=Y[12]/q,W=Y[13]/q,X=Y[14]/q,Z=ka(this.computedRadius[0]);this.center.jump(e,w-U*Z,W-H*Z,X-G*Z)},g.lastT=function(){return va(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},g.idle=function(e){this.center.idle(e),this.up.idle(e),this.right.idle(e),this.radius.idle(e),this.angle.idle(e)},g.flush=function(e){this.center.flush(e),this.up.flush(e),this.right.flush(e),this.radius.flush(e),this.angle.flush(e)},g.setDistance=function(e,t){0<t&&this.radius.set(e,P(t))},g.lookAt=function(e,t,r,i){this.recalcMatrix(e),t=t||this.computedEye,r=r||this.computedCenter,i=i||this.computedUp;var n=i[0],l=i[1],s=i[2],d=a(n,l,s);if(!(1e-6>d)){n/=d,l/=d,s/=d;var c=t[0]-r[0],p=t[1]-r[1],u=t[2]-r[2],g=a(c,p,u);if(!(1e-6>g)){c/=g,p/=g,u/=g;var h=this.computedRight,m=h[0],y=h[1],f=h[2],x=n*m+l*y+s*f;m-=x*n,y-=x*l,f-=x*s;var b=a(m,y,f);if(!(.01>b&&(m=l*u-s*p,y=s*c-n*u,f=n*p-l*c,b=a(m,y,f),1e-6>b))){m/=b,y/=b,f/=b,this.up.set(e,n,l,s),this.right.set(e,m,y,f),this.center.set(e,r[0],r[1],r[2]),this.radius.set(e,P(g));var v=l*f-s*y,w=s*m-n*f,k=n*y-l*m,T=a(v,w,k);v/=T,w/=T,k/=T;var A=n*c+l*p+s*u,S=m*c+y*p+f*u,C=v*c+w*p+k*u,E=_(o(A)),z=L(C,S),I=this.angle._state,D=I[I.length-1],O=I[I.length-2];D%=2*Sa;var R=wa(D+2*Sa-z),M=wa(D-z),j=wa(D-2*Sa-z);R<M&&(D+=2*Sa),j<M&&(D-=2*Sa),this.angle.jump(this.angle.lastT(),D,O),this.angle.set(e,z,E)}}}}},{"filtered-vector":215,"gl-mat4/invert":254,"gl-mat4/rotate":258,"gl-vec3/cross":317,"gl-vec3/dot":322,"gl-vec3/normalize":339}],519:[function(e,t){"use strict";t.exports=function(e,t,a){var o=e*t,r=134217729*e,i=r-(r-e),n=e-i,l=134217729*t,s=l-(l-t),d=t-s,c=n*d-(o-i*s-n*s-i*d);return a?(a[0]=c,a[1]=o,a):[c,o]};+(_a(2,27)+1)},{}],520:[function(e,t){"use strict";t.exports=function(e,t,a){var o=e+t,r=o-e,i=t-r,n=e-(o-r);return a?(a[0]=n+i,a[1]=o,a):[n+i,o]}},{}],521:[function(e,t,a){(function(t,o){"use strict";function r(e){if(e){var t=e.length||e.byteLength,a=x.log2(t);w[a].push(e)}}function i(e){var e=x.nextPow2(e),t=x.log2(e),a=w[t];return 0<a.length?a.pop():new ArrayBuffer(e)}function l(e){return new Uint8Array(i(e),0,e)}function s(e){return new Uint16Array(i(2*e),0,e)}function d(e){return new Uint32Array(i(4*e),0,e)}function c(e){return new Int8Array(i(e),0,e)}function p(e){return new Int16Array(i(2*e),0,e)}function u(e){return new Int32Array(i(4*e),0,e)}function g(e){return new Float32Array(i(4*e),0,e)}function h(e){return new Float64Array(i(8*e),0,e)}function m(e){return _?new Uint8ClampedArray(i(e),0,e):l(e)}function y(e){return new DataView(i(e),0,e)}function f(e){e=x.nextPow2(e);var t=x.log2(e),a=k[t];return 0<a.length?a.pop():new o(e)}var x=e("bit-twiddle"),b=e("dup");t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:b([32,0]),UINT16:b([32,0]),UINT32:b([32,0]),INT8:b([32,0]),INT16:b([32,0]),INT32:b([32,0]),FLOAT:b([32,0]),DOUBLE:b([32,0]),DATA:b([32,0]),UINT8C:b([32,0]),BUFFER:b([32,0])});var _="undefined"!=typeof Uint8ClampedArray,v=t.__TYPEDARRAY_POOL;v.UINT8C||(v.UINT8C=b([32,0])),v.BUFFER||(v.BUFFER=b([32,0]));var w=v.DATA,k=v.BUFFER;a.free=function(e){if(o.isBuffer(e))k[x.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,a=0|x.log2(t);w[a].push(e)}},a.freeUint8=a.freeUint16=a.freeUint32=a.freeInt8=a.freeInt16=a.freeInt32=a.freeFloat32=a.freeFloat=a.freeFloat64=a.freeDouble=a.freeUint8Clamped=a.freeDataView=function(e){r(e.buffer)},a.freeArrayBuffer=r,a.freeBuffer=function(e){k[x.log2(e.length)].push(e)},a.malloc=function(e,t){return void 0===t||"arraybuffer"===t?i(e):"uint8"===t?l(e):"uint16"===t?s(e):"uint32"===t?d(e):"int8"===t?c(e):"int16"===t?p(e):"int32"===t?u(e):"float"===t||"float32"===t?g(e):"double"===t||"float64"===t?h(e):"uint8_clamped"===t?m(e):"buffer"===t?f(e):"data"===t||"dataview"===t?y(e):null},a.mallocArrayBuffer=i,a.mallocUint8=l,a.mallocUint16=s,a.mallocUint32=d,a.mallocInt8=c,a.mallocInt16=p,a.mallocInt32=u,a.mallocFloat32=a.mallocFloat=g,a.mallocFloat64=a.mallocDouble=h,a.mallocUint8Clamped=m,a.mallocDataView=y,a.mallocBuffer=f,a.clearCache=function(){for(var e=0;32>e;++e)v.UINT8[e].length=0,v.UINT16[e].length=0,v.UINT32[e].length=0,v.INT8[e].length=0,v.INT16[e].length=0,v.INT32[e].length=0,v.FLOAT[e].length=0,v.DOUBLE[e].length=0,v.UINT8C[e].length=0,w[e].length=0,k[e].length=0}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global,e("buffer").Buffer)},{"bit-twiddle":80,buffer:93,dup:155}],522:[function(e,t){"use strict";"use restrict";function a(e){this.roots=Array(e),this.ranks=Array(e);for(var t=0;t<e;++t)this.roots[t]=t,this.ranks[t]=0}t.exports=a;var o=a.prototype;Object.defineProperty(o,"length",{get:function(){return this.roots.length}}),o.makeSet=function(){var e=this.roots.length;return this.roots.push(e),this.ranks.push(0),e},o.find=function(e){for(var t=e,a=this.roots;a[e]!==e;)e=a[e];for(;a[t]!==e;){var o=a[t];a[t]=e,t=o}return e},o.link=function(e,t){var a=this.find(e),o=this.find(t);if(a!==o){var r=this.ranks,i=this.roots,n=r[a],l=r[o];n<l?i[a]=o:l<n?i[o]=a:(i[o]=a,++r[a])}}},{}],523:[function(e,t){"use strict";function a(e,t){for(var o=1,r=e.length,n=e[0],l=e[0],s=1;s<r;++s)if(l=n,n=e[s],t(n,l)){if(s===o){o++;continue}e[o++]=n}return e.length=o,e}function o(e){for(var t=1,o=e.length,r=e[0],n=e[0],l=1;l<o;++l,n=r)if(n=r,r=e[l],r!==n){if(l===t){t++;continue}e[t++]=r}return e.length=t,e}t.exports=function(e,t,r){return 0===e.length?e:t?(r||e.sort(t),a(e,t)):(r||e.sort(),o(e))}},{}],524:[function(e,t){var a=/[\'\"]/;t.exports=function(e){return e?(a.test(e.charAt(0))&&(e=e.substr(1)),a.test(e.charAt(e.length-1))&&(e=e.substr(0,e.length-1)),e):""}},{}],525:[function(e,t){"use strict";t.exports=function(e,t,a){Array.isArray(a)||(a=[].slice.call(arguments,2));for(var o=0,r=a.length,n;o<r;o++)for(var l in n=a[o],n)if((void 0===t[l]||Array.isArray(t[l])||e[l]!==t[l])&&l in t){var s;if(!0===n[l])s=t[l];else if(!1===n[l])continue;else if("function"==typeof n[l]&&(s=n[l](t[l],e,t),void 0===s))continue;e[l]=s}return e}},{}],526:[function(e,t){"use strict";function a(e,t){return("object"!=typeof t||null===t)&&(t={}),o(e,t.canvas||r,t.context||i,t)}t.exports=a;var o=e("./lib/vtext"),r=null,i=null;"undefined"!=typeof document&&(r=document.createElement("canvas"),r.width=8192,r.height=1024,i=r.getContext("2d"))},{"./lib/vtext":527}],527:[function(e,t){"use strict";function a(e,t,o,r){for(var n="<"+e+">",l="</"+e+">",s=n.length,d=l.length,p="+"===t[0]||"-"===t[0],u=0,g=-d;-1<u&&(u=o.indexOf(n,u),-1!==u)&&!(g=o.indexOf(l,u+s),-1===g);){if(g<=u)break;for(var h=u;h<g+d;++h)if(h<u+s||h>=g)r[h]=null,o=o.substr(0,h)+" "+o.substr(h+1);else if(null!==r[h]){var m=r[h].indexOf(t[0]);-1===m?r[h]+=t:p&&(r[h]=r[h].substr(0,m+1)+(1+parseInt(r[h][m+1]))+r[h].substr(m+2))}var y=u+s,f=o.substr(y,g-y),x=f.indexOf(n);u=-1===x?g+d:x}return r}function o(e,t,a){for(var o=t.textAlign||"start",r=t.textBaseline||"alphabetic",l=[1073741824,1073741824],s=[0,0],d=e.length,n=0,c;n<d;++n){c=e[n];for(var u=0;2>u;++u)l[u]=0|ie(l[u],c[u]),s[u]=0|va(s[u],c[u])}var g=0;switch(o){case"center":g=-.5*(l[0]+s[0]);break;case"right":case"end":g=-s[0];break;case"left":case"start":g=-l[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+o+"'");}var h=0;switch(r){case"hanging":case"top":h=-l[1];break;case"middle":h=-.5*(l[1]+s[1]);break;case"alphabetic":case"ideographic":h=-3*a;break;case"bottom":h=-s[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+r+"'");}var m=1/a;return"lineHeight"in t?m*=+t.lineHeight:"width"in t?m=t.width/(s[0]-l[0]):"height"in t&&(m=t.height/(s[1]-l[1])),e.map(function(e){return[m*(e[0]+g),m*(e[1]+h)]})}function r(e,t,o,r,n,l){o=o.replace(/\n/g,""),o=!0===l.breaklines?o.replace(/\<br\>/g,"\n"):o.replace(/\<br\>/g," ");var s="",d=[];for(w=0;w<o.length;++w)d[w]=s;!0===l.bolds&&(d=a("b","b|",o,d)),!0===l.italics&&(d=a("i","i|",o,d)),!0===l.superscripts&&(d=a("sup","+1",o,d)),!0===l.subscripts&&(d=a("sub","-1",o,d));var p=[],u="";for(w=0;w<o.length;++w)null!==d[w]&&(u+=o[w],p.push(d[w]));var g=u.split("\n"),h=g.length,m=R(n*r),y=r,f=2*r,x=0,b=h*m+f;e.height<b&&(e.height=b),t.fillStyle="#000",t.fillRect(0,0,e.width,e.height),t.fillStyle="#fff";var _=0,v,w,k,T,A;for(v=0;v<h;++v){function e(){if(""!==C){var e=t.measureText(C).width;t.fillText(C,y+k,f+T),k+=e}}function a(e,a){function o(){return""+R(A)+"px "}var r=""+t.font;if(!0===l.subscripts){var i=e.indexOf("-"),n=a.indexOf("-"),s=-1<i?parseInt(e[1+i]):0,d=-1<n?parseInt(a[1+n]):0;s!==d&&(r=r.replace(o(),"?px "),A*=_a(.75,d-s),r=r.replace("?px ",o())),T+=.25*m*(d-s)}if(!0===l.superscripts){var c=e.indexOf("+"),p=a.indexOf("+"),u=-1<c?parseInt(e[1+c]):0,g=-1<p?parseInt(a[1+p]):0;u!==g&&(r=r.replace(o(),"?px "),A*=_a(.75,g-u),r=r.replace("?px ",o())),T-=.25*m*(g-u)}if(!0===l.bolds){var h=-1<e.indexOf("b|"),y=-1<a.indexOf("b|");!h&&y&&(f?r=r.replace("italic ","italic bold "):r="bold "+r),h&&!y&&(r=r.replace("bold ",""))}if(!0===l.italics){var f=-1<e.indexOf("i|"),x=-1<a.indexOf("i|");!f&&x&&(r="italic "+r),f&&!x&&(r=r.replace("italic ",""))}t.font=r}var S=g[v]+"\n";k=0,T=v*m,A=r;var C="";for(w=0;w<S.length;++w){var L=w+_<p.length?p[w+_]:p[p.length-1];s===L?C+=S[w]:(e(),C=S[w],L!==void 0&&(a(s,L),s=L))}e(),_+=S.length;var E=0|R(k+2*y);x<E&&(x=E)}var z=x,I=f+m*h,D=c(t.getImageData(0,0,z,I).data,[I,z,4]);return D.pick(-1,-1,0).transpose(1,0)}function n(e,t){var a=d(e,128);return t?p(a.cells,a.positions,.25):{edges:a.cells,positions:a.positions}}function l(e,t,a,r){var l=n(e,r),s=o(l.positions,t,a),d=l.edges,c="ccw"===t.orientation;if(u(s,d),t.polygons||t.polygon||t.polyline){for(var p=h(d,s),m=Array(p.length),y=0;y<p.length;++y){for(var f=p[y],x=Array(f.length),b=0;b<f.length;++b){for(var _=f[b],v=Array(_.length),w=0;w<_.length;++w)v[w]=s[_[w]].slice();c&&v.reverse(),x[b]=v}m[y]=x}return m}return t.triangles||t.triangulate||t.triangle?{cells:g(s,d,{delaunay:!1,exterior:!1,interior:!0}),positions:s}:{edges:d,positions:s}}function s(e,t,a){try{return l(e,t,a,!0)}catch(t){}try{return l(e,t,a,!1)}catch(t){}return t.polygons||t.polyline||t.polygon?[]:t.triangles||t.triangulate||t.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}t.exports=function(e,t,a,o){var i=64,n=1.25,l={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};o&&(o.size&&0<o.size&&(i=o.size),o.lineSpacing&&0<o.lineSpacing&&(n=o.lineSpacing),o.styletags&&o.styletags.breaklines&&(l.breaklines=!!o.styletags.breaklines),o.styletags&&o.styletags.bolds&&(l.bolds=!!o.styletags.bolds),o.styletags&&o.styletags.italics&&(l.italics=!!o.styletags.italics),o.styletags&&o.styletags.subscripts&&(l.subscripts=!!o.styletags.subscripts),o.styletags&&o.styletags.superscripts&&(l.superscripts=!!o.styletags.superscripts)),a.font=[o.fontStyle,o.fontVariant,o.fontWeight,i+"px",o.font].filter(function(e){return e}).join(" "),a.textAlign="start",a.textBaseline="alphabetic",a.direction="ltr";var d=r(t,a,e,i,n,l);return s(d,o,i)},t.exports.processPixels=s;var d=e("surface-nets"),c=e("ndarray"),p=e("simplify-planar-graph"),u=e("clean-pslg"),g=e("cdt2d"),h=e("planar-graph-to-polyline")},{cdt2d:94,"clean-pslg":104,ndarray:433,"planar-graph-to-polyline":451,"simplify-planar-graph":500,"surface-nets":507}],528:[function(e,t){(function(){"use strict";function e(t){t.permitHostObjects___&&t.permitHostObjects___(e)}function a(e){return"weakmap:"!=e.substr(0,8)||"___"!==e.substr(e.length-3)}function o(e){if(e!==Object(e))throw new TypeError("Not an object: "+e);var t=e[m];if(t&&t.key===e)return t;if(g(e)){t={key:e};try{return u(e,m,{value:t,writable:!1,enumerable:!1,configurable:!1}),t}catch(e){}}}function r(e){return e.prototype=null,Object.freeze(e)}function i(){b||"undefined"==typeof console||(b=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=e);var n=!1;if("function"==typeof WeakMap){var l=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var s=new l,d=Object.freeze({});if(s.set(d,1),1!==s.get(d))n=!0;else return void(t.exports=WeakMap)}}var c=Object.prototype.hasOwnProperty,p=Object.getOwnPropertyNames,u=Object.defineProperty,g=Object.isExtensible,h="weakmap:",m=h+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var y=new ArrayBuffer(25),f=new Uint8Array(y);crypto.getRandomValues(f),m=h+"rand:"+Array.prototype.map.call(f,function(e){return(e%36).toString(36)}).join("")+"___"}if(u(Object,"getOwnPropertyNames",{value:function(e){return p(e).filter(a)}}),"getPropertyNames"in Object){var x=Object.getPropertyNames;u(Object,"getPropertyNames",{value:function(e){return x(e).filter(a)}})}(function(){var e=Object.freeze;u(Object,"freeze",{value:function(t){return o(t),e(t)}});var t=Object.seal;u(Object,"seal",{value:function(e){return o(e),t(e)}});var a=Object.preventExtensions;u(Object,"preventExtensions",{value:function(e){return o(e),a(e)}})})();var b=!1,_=0,v=function(){function e(e,t){var a=o(e),r;return a?s in a?a[s]:t:(r=n.indexOf(e),0<=r?l[r]:t)}function t(e){var t=o(e);return t?s in t:0<=n.indexOf(e)}function a(e){var t=o(e),a,r;return t?s in t&&delete t[s]:(a=n.indexOf(e),!(0>a))&&(r=n.length-1,n[a]=void 0,l[a]=l[r],n[a]=n[r],n.length=r,l.length=r,!0)}this instanceof v||i();var n=[],l=[],s=_++;return Object.create(v.prototype,{get___:{value:r(e)},has___:{value:r(t)},set___:{value:r(function(e,t){var a=o(e),r;return a?a[s]=t:(r=n.indexOf(e),0<=r?l[r]=t:(r=n.length,l[r]=t,n[r]=e)),this})},delete___:{value:r(a)}})};v.prototype=Object.create(Object.prototype,{get:{value:function(e,t){return this.get___(e,t)},writable:!0,configurable:!0},has:{value:function(e){return this.has___(e)},writable:!0,configurable:!0},set:{value:function(e,t){return this.set___(e,t)},writable:!0,configurable:!0},delete:{value:function(e){return this.delete___(e)},writable:!0,configurable:!0}}),"function"==typeof l?function(){function a(){function t(e,t){return d?s.has(e)?s.get(e):d.get___(e,t):s.get(e,t)}function a(e){return s.has(e)||!!d&&d.has___(e)}function o(e){var t=!!s["delete"](e);return d?d.delete___(e)||t:t}this instanceof v||i();var s=new l,d=void 0,c=!1,p;return p=n?function(e,t){return s.set(e,t),s.has(e)||(!d&&(d=new v),d.set(e,t)),this}:function(t,a){if(c)try{s.set(t,a)}catch(o){d||(d=new v),d.set___(t,a)}else s.set(t,a);return this},Object.create(v.prototype,{get___:{value:r(t)},has___:{value:r(a)},set___:{value:r(p)},delete___:{value:r(o)},permitHostObjects___:{value:r(function(t){if(t===e)c=!0;else throw new Error("bogus call to permitHostObjects___")})}})}n&&"undefined"!=typeof Proxy&&(Proxy=void 0),a.prototype=v.prototype,t.exports=a,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),t.exports=v)}})()},{}],529:[function(e,t){var a=e("./hidden-store.js");t.exports=function(){var e={};return function(t){if(("object"!=typeof t||null===t)&&"function"!=typeof t)throw new Error("Weakmap-shim: Key must be object");var o=t.valueOf(e);return o&&o.identity===e?o:a(t,e)}}},{"./hidden-store.js":530}],530:[function(e,t){t.exports=function(e,t){var a={identity:t},o=e.valueOf;return Object.defineProperty(e,"valueOf",{value:function(e){return e===t?a:o.apply(this,arguments)},writable:!0}),a}},{}],531:[function(e,t){var a=e("./create-store.js");t.exports=function(){var e=a();return{get:function(t,a){var o=e(t);return o.hasOwnProperty("value")?o.value:a},set:function(t,a){return e(t).value=a,this},has:function(t){return"value"in e(t)},delete:function(t){return delete e(t).value}}}},{"./create-store.js":529}],532:[function(e,t){var a=e("get-canvas-context");t.exports=function(e){return a("webgl",e)}},{"get-canvas-context":221}],533:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function a(e,t,a,o){var r,n;if("object"==typeof e)r=e,n=t||{};else{if(!("number"==typeof e&&1888<=e&&2111>=e))throw new Error("Solar year outside range 1888-2111");if(!("number"==typeof t&&1<=t&&12>=t))throw new Error("Solar month outside range 1 - 12");if(!("number"==typeof a&&1<=a&&31>=a))throw new Error("Solar day outside range 1 - 31");r={year:e,month:t,day:a},n=o||{}}var l=u[r.year-u[0]],s=r.year<<9|r.month<<5|r.day;n.year=s>=l?r.year:r.year-1,l=u[n.year-u[0]];var c=4095&l>>9,g=15&l>>5,h=31&l,d=new Date(c,g-1,h),m=new Date(r.year,r.month-1,r.day),y;y=R((m-d)/86400000);var f=p[n.year-p[0]],x;for(x=0;13>x;x++){var b=f&1<<12-x?30:29;if(y<b)break;y-=b}var _=f>>13;return!_||x<_?(n.isIntercalary=!1,n.month=1+x):x===_?(n.isIntercalary=!0,n.month=x):(n.isIntercalary=!1,n.month=x),n.day=1+y,n}function o(e,t,a,o,r){var n,l;if("object"==typeof e)l=e,n=t||{};else{if(!("number"==typeof e&&1888<=e&&2111>=e))throw new Error("Lunar year outside range 1888-2111");if(!("number"==typeof t&&1<=t&&12>=t))throw new Error("Lunar month outside range 1 - 12");if(!("number"==typeof a&&1<=a&&30>=a))throw new Error("Lunar day outside range 1 - 30");var s;"object"==typeof o?(s=!1,n=o):(s=!!o,n=r||{}),l={year:e,month:t,day:a,isIntercalary:s}}var d=l.day-1;var c=p[l.year-p[0]],g=c>>13,h;h=g?l.month>g?l.month:l.isIntercalary?l.month:l.month-1:l.month-1;for(var m=0,y;m<h;m++)y=c&1<<12-m?30:29,d+=y;var f=u[l.year-u[0]],x=new Date(4095&f>>9,(15&f>>5)-1,(31&f)+d);return n.year=x.getFullYear(),n.month=1+x.getMonth(),n.day=x.getDate(),n}var r=e("../main"),i=e("object-assign"),n=r.instance();t.prototype=new r.baseCalendar,i(t.prototype,{name:"Chinese",jdEpoch:1721425.5,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(e,t){if("string"==typeof e){var a=e.match(s);return a?a[0]:""}var o=this._validateYear(e),r=e.month(),i=""+this.toChineseMonth(o,r);return t&&2>i.length&&(i="0"+i),this.isIntercalaryMonth(o,r)&&(i+="i"),i},monthNames:function(e){if("string"==typeof e){var t=e.match(d);return t?t[0]:""}var a=this._validateYear(e),o=e.month(),r=this.toChineseMonth(a,o),i=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][r-1];return this.isIntercalaryMonth(a,o)&&(i="\u95F0"+i),i},monthNamesShort:function(e){if("string"==typeof e){var t=e.match(c);return t?t[0]:""}var a=this._validateYear(e),o=e.month(),r=this.toChineseMonth(a,o),i=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][r-1];return this.isIntercalaryMonth(a,o)&&(i="\u95F0"+i),i},parseMonth:function(e,t){e=this._validateYear(e);var a=parseInt(t),o;if(!isNaN(a)){var r=t[t.length-1];o="i"===r||"I"===r}else"\u95F0"===t[0]&&(o=!0,t=t.substring(1)),"\u6708"===t[t.length-1]&&(t=t.substring(0,t.length-1)),a=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(t);var i=this.toMonthIndex(e,a,o);return i},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(e,t){if(e.year&&(e=e.year()),"number"!=typeof e||1888>e||2111<e)throw t.replace(/\{0\}/,this.local.name);return e},toMonthIndex:function(e,t,a){var o=this.intercalaryMonth(e);if(a&&t!==o||1>t||12<t)throw r.local.invalidMonth.replace(/\{0\}/,this.local.name);var i;return i=o?!a&&t<=o?t-1:t:t-1,i},toChineseMonth:function(e,t){e.year&&(e=e.year(),t=e.month());var a=this.intercalaryMonth(e),o=a?12:11;if(0>t||t>o)throw r.local.invalidMonth.replace(/\{0\}/,this.local.name);var i;return i=a?t<a?t+1:t:t+1,i},intercalaryMonth:function(e){e=this._validateYear(e);var t=p[e-p[0]];return t>>13},isIntercalaryMonth:function(e,t){e.year&&(e=e.year(),t=e.month());var a=this.intercalaryMonth(e);return!!a&&a===t},leapYear:function(e){return 0!==this.intercalaryMonth(e)},weekOfYear:function(e,t,a){var o=this._validateYear(e,r.local.invalidyear),i=u[o-u[0]],l;l=n.newDate(4095&i>>9,15&i>>5,31&i),l.add(4-(l.dayOfWeek()||7),"d");var s=this.toJD(e,t,a)-l.toJD();return 1+ea(s/7)},monthsInYear:function(e){return this.leapYear(e)?13:12},daysInMonth:function(e,t){e.year&&(t=e.month(),e=e.year()),e=this._validateYear(e);var a=p[e-p[0]],o=a>>13?12:11;if(t>o)throw r.local.invalidMonth.replace(/\{0\}/,this.local.name);var i=a&1<<12-t?30:29;return i},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,a){var i=this._validate(e,void 0,a,r.local.invalidDate);e=this._validateYear(i.year()),t=i.month(),a=i.day();var l=this.isIntercalaryMonth(e,t),s=this.toChineseMonth(e,t),d=o(e,s,a,l);return n.toJD(d.year,d.month,d.day)},fromJD:function(e){var t=n.fromJD(e),o=a(t.year(),t.month(),t.day()),r=this.toMonthIndex(o.year,o.month,o.isIntercalary);return this.newDate(o.year,r,o.day)},fromString:function(e){var t=e.match(l),a=this._validateYear(+t[1]),o=+t[2],r=!!t[3],i=this.toMonthIndex(a,o,r),n=+t[4];return this.newDate(a,i,n)},add:function(e,a,o){var r=e.year(),i=e.month(),n=this.isIntercalaryMonth(r,i),l=this.toChineseMonth(r,i),s=Object.getPrototypeOf(t.prototype).add.call(this,e,a,o);if("y"===o){var d=s.year(),c=s.month(),p=this.isIntercalaryMonth(d,l),u=n&&p?this.toMonthIndex(d,l,!0):this.toMonthIndex(d,l,!1);u!==c&&s.month(u)}return s}});var l=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,s=/^\d?\d[iI]?/m,d=/^??[]?/m,c=/^??[]?/m;r.calendars.chinese=t;var p=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],u=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":547,"object-assign":437}],534:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),o=e("object-assign");t.prototype=new a.baseCalendar,o(t.prototype,{name:"Coptic",jdEpoch:1825029.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=t.year()+(0>t.year()?1:0);return 3==e%4||-1==e%4},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,a.local.invalidYear||a.regionalOptions[""].invalidYear),13},weekOfYear:function(e,t,a){var o=this.newDate(e,t,a);return o.add(-o.dayOfWeek(),"d"),ea((o.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var o=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(13===o.month()&&this.leapYear(o.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,o){var r=this._validate(e,t,o,a.local.invalidDate);return e=r.year(),0>e&&e++,r.day()+30*(r.month()-1)+365*(e-1)+ea(e/4)+this.jdEpoch-1},fromJD:function(e){var t=ea(e)+.5-this.jdEpoch,a=ea((t-ea((t+366)/1461))/365)+1;0>=a&&a--,t=ea(e)+.5-this.newDate(a,1,1).toJD();var o=ea(t/30)+1,r=t-30*(o-1)+1;return this.newDate(a,o,r)}}),a.calendars.coptic=t},{"../main":547,"object-assign":437}],535:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),o=e("object-assign");t.prototype=new a.baseCalendar,o(t.prototype,{name:"Discworld",jdEpoch:1721425.5,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),400},weekOfYear:function(e,t,a){var o=this.newDate(e,t,a);return o.add(-o.dayOfWeek(),"d"),ea((o.dayOfYear()-1)/8)+1},daysInMonth:function(e,t){var o=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[o.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,t,o){var r=this._validate(e,t,o,a.local.invalidDate);return(r.day()+1)%8},weekDay:function(e,t,a){var o=this.dayOfWeek(e,t,a);return 2<=o&&6>=o},extraInfo:function(e,t,o){var i=this._validate(e,t,o,a.local.invalidDate);return{century:r[ea((i.year()-1)/100)+1]||""}},toJD:function(e,t,o){var r=this._validate(e,t,o,a.local.invalidDate);return e=r.year()+(0>r.year()?1:0),t=r.month(),o=r.day(),o+(1<t?16:0)+(2<t?32*(t-2):0)+400*(e-1)+this.jdEpoch-1},fromJD:function(e){e=ea(e+.5)-ea(this.jdEpoch)-1;var t=ea(e/400)+1;e-=400*(t-1),e+=15<e?16:0;var a=ea(e/32)+1,o=e-32*(a-1)+1;return this.newDate(0>=t?t-1:t,a,o)}});var r={20:"Fruitbat",21:"Anchovy"};a.calendars.discworld=t},{"../main":547,"object-assign":437}],536:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),o=e("object-assign");t.prototype=new a.baseCalendar,o(t.prototype,{name:"Ethiopian",jdEpoch:1724220.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=t.year()+(0>t.year()?1:0);return 3==e%4||-1==e%4},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,a.local.invalidYear||a.regionalOptions[""].invalidYear),13},weekOfYear:function(e,t,a){var o=this.newDate(e,t,a);return o.add(-o.dayOfWeek(),"d"),ea((o.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var o=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(13===o.month()&&this.leapYear(o.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,o){var r=this._validate(e,t,o,a.local.invalidDate);return e=r.year(),0>e&&e++,r.day()+30*(r.month()-1)+365*(e-1)+ea(e/4)+this.jdEpoch-1},fromJD:function(e){var t=ea(e)+.5-this.jdEpoch,a=ea((t-ea((t+366)/1461))/365)+1;0>=a&&a--,t=ea(e)+.5-this.newDate(a,1,1).toJD();var o=ea(t/30)+1,r=t-30*(o-1)+1;return this.newDate(a,o,r)}}),a.calendars.ethiopian=t},{"../main":547,"object-assign":437}],537:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function a(e,t){return e-t*ea(e/t)}var o=e("../main"),r=e("object-assign");t.prototype=new o.baseCalendar,r(t.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,o.local.invalidYear);return this._leapYear(t.year())},_leapYear:function(e){return e=0>e?e+1:e,7>a(7*e+1,19)},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,o.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,t,a){var o=this.newDate(e,t,a);return o.add(-o.dayOfWeek(),"d"),ea((o.dayOfYear()-1)/7)+1},daysInYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,o.local.invalidYear);return e=t.year(),this.toJD(-1===e?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,t){return e.year&&(t=e.month(),e=e.year()),this._validate(e,t,this.minDay,o.local.invalidMonth),12===t&&this.leapYear(e)?30:8===t&&5===a(this.daysInYear(e),10)?30:9===t&&3===a(this.daysInYear(e),10)?29:this.daysPerMonth[t-1]},weekDay:function(e,t,a){return 6!==this.dayOfWeek(e,t,a)},extraInfo:function(e,t,a){var r=this._validate(e,t,a,o.local.invalidDate);return{yearType:(this.leapYear(r)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(r)%10-3]}},toJD:function(e,t,a){var r=this._validate(e,t,a,o.local.invalidDate);e=r.year(),t=r.month(),a=r.day();var i=0>=e?e+1:e,n=this.jdEpoch+this._delay1(i)+this._delay2(i)+a+1;if(7>t){for(var l=7;l<=this.monthsInYear(e);l++)n+=this.daysInMonth(e,l);for(var l=1;l<t;l++)n+=this.daysInMonth(e,l)}else for(var l=7;l<t;l++)n+=this.daysInMonth(e,l);return n},_delay1:function(e){var t=ea((235*e-234)/19),o=29*t+ea((12084+13753*t)/25920);return 3>a(3*(o+1),7)&&o++,o},_delay2:function(e){var t=this._delay1(e-1),a=this._delay1(e),o=this._delay1(e+1);return 356==o-a?2:382==a-t?1:0},fromJD:function(e){e=ea(e)+.5;for(var t=ea(98496*(e-this.jdEpoch)/35975351)-1;e>=this.toJD(-1===t?1:t+1,7,1);)t++;for(var a=e<this.toJD(t,1,1)?7:1;e>this.toJD(t,a,this.daysInMonth(t,a));)a++;var o=e-this.toJD(t,a,1)+1;return this.newDate(t,a,o)}}),o.calendars.hebrew=t},{"../main":547,"object-assign":437}],538:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),o=e("object-assign");t.prototype=new a.baseCalendar,o(t.prototype,{name:"Islamic",jdEpoch:1948439.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);return 11>(11*t.year()+14)%30},weekOfYear:function(e,t,a){var o=this.newDate(e,t,a);return o.add(-o.dayOfWeek(),"d"),ea((o.dayOfYear()-1)/7)+1},daysInYear:function(e){return this.leapYear(e)?355:354},daysInMonth:function(e,t){var o=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(12===o.month()&&this.leapYear(o.year())?1:0)},weekDay:function(e,t,a){return 5!==this.dayOfWeek(e,t,a)},toJD:function(e,t,o){var r=this._validate(e,t,o,a.local.invalidDate);return e=r.year(),t=r.month(),o=r.day(),e=0>=e?e+1:e,o+ae(29.5*(t-1))+354*(e-1)+ea((3+11*e)/30)+this.jdEpoch-1},fromJD:function(e){e=ea(e)+.5;var t=ea((30*(e-this.jdEpoch)+10646)/10631);t=0>=t?t-1:t;var a=ie(12,ae((e-29-this.toJD(t,1,1))/29.5)+1),o=e-this.toJD(t,a,1)+1;return this.newDate(t,a,o)}}),a.calendars.islamic=t},{"../main":547,"object-assign":437}],539:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),o=e("object-assign");t.prototype=new a.baseCalendar,o(t.prototype,{name:"Julian",jdEpoch:1721423.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=0>t.year()?t.year()+1:t.year();return 0==e%4},weekOfYear:function(e,t,a){var o=this.newDate(e,t,a);return o.add(4-(o.dayOfWeek()||7),"d"),ea((o.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var o=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(2===o.month()&&this.leapYear(o.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,o){var r=this._validate(e,t,o,a.local.invalidDate);return e=r.year(),t=r.month(),o=r.day(),0>e&&e++,2>=t&&(e--,t+=12),ea(365.25*(e+4716))+ea(30.6001*(t+1))+o-1524.5},fromJD:function(t){var o=ea(t+.5),a=o+1524,r=ea((a-122.1)/365.25),i=ea(365.25*r),n=ea((a-i)/30.6001),e=n-ea(14>n?1:13),l=r-ea(2<e?4716:4715),s=a-i-ea(30.6001*n);return 0>=l&&l--,this.newDate(l,e,s)}}),a.calendars.julian=t},{"../main":547,"object-assign":437}],540:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function o(e,t){return e-t*ea(e/t)}function r(e,t){return o(e-1,t)+1}var i=e("../main"),n=e("object-assign");t.prototype=new i.baseCalendar,n(t.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,i.local.invalidYear),!1},formatYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,i.local.invalidYear);e=t.year();var a=ea(e/400);e%=400,e+=0>e?400:0;var o=ea(e/20);return a+"."+o+"."+e%20},forYear:function(e){if(e=e.split("."),3>e.length)throw"Invalid Mayan year";for(var t=0,a=0,o;a<e.length;a++){if(o=parseInt(e[a],10),19<wa(o)||0<a&&0>o)throw"Invalid Mayan year";t=20*t+o}return t},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,i.local.invalidYear),18},weekOfYear:function(e,t,a){return this._validate(e,t,a,i.local.invalidDate),0},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,i.local.invalidYear),360},daysInMonth:function(e,t){return this._validate(e,t,this.minDay,i.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(e,t,a){var o=this._validate(e,t,a,i.local.invalidDate);return o.day()},weekDay:function(e,t,a){return this._validate(e,t,a,i.local.invalidDate),!0},extraInfo:function(e,t,a){var o=this._validate(e,t,a,i.local.invalidDate),r=o.toJD(),n=this._toHaab(r),l=this._toTzolkin(r);return{haabMonthName:this.local.haabMonths[n[0]-1],haabMonth:n[0],haabDay:n[1],tzolkinDayName:this.local.tzolkinMonths[l[0]-1],tzolkinDay:l[0],tzolkinTrecena:l[1]}},_toHaab:function(e){e-=this.jdEpoch;var t=o(e+8+340,365);return[ea(t/20)+1,o(t,20)]},_toTzolkin:function(e){return e-=this.jdEpoch,[r(e+20,20),r(e+4,13)]},toJD:function(e,t,a){var o=this._validate(e,t,a,i.local.invalidDate);return o.day()+20*o.month()+360*o.year()+this.jdEpoch},fromJD:function(e){e=ea(e)+.5-this.jdEpoch;var t=ea(e/360);e%=360,e+=0>e?360:0;var a=ea(e/20),o=e%20;return this.newDate(t,a,o)}}),i.calendars.mayan=t},{"../main":547,"object-assign":437}],541:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),o=e("object-assign");t.prototype=new a.baseCalendar;var r=a.instance("gregorian");o(t.prototype,{name:"Nanakshahi",jdEpoch:2257673.5,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear||a.regionalOptions[""].invalidYear);return r.leapYear(t.year()+(1>t.year()?1:0)+1469)},weekOfYear:function(e,t,a){var o=this.newDate(e,t,a);return o.add(1-(o.dayOfWeek()||7),"d"),ea((o.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var o=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(12===o.month()&&this.leapYear(o.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,o){var i=this._validate(e,t,o,a.local.invalidMonth),e=i.year();0>e&&e++;for(var n=i.day(),l=1;l<i.month();l++)n+=this.daysPerMonth[l-1];return n+r.toJD(e+1468,3,13)},fromJD:function(e){e=ea(e+.5);for(var t=ea((e-(this.jdEpoch-1))/366);e>=this.toJD(t+1,1,1);)t++;for(var a=e-ea(this.toJD(t,1,1)+.5)+1,o=1;a>this.daysInMonth(t,o);)a-=this.daysInMonth(t,o),o++;return this.newDate(t,o,a)}}),a.calendars.nanakshahi=t},{"../main":547,"object-assign":437}],542:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),o=e("object-assign");t.prototype=new a.baseCalendar,o(t.prototype,{name:"Nepali",jdEpoch:1700709.5,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(e){return this.daysInYear(e)!==this.daysPerYear},weekOfYear:function(e,t,a){var o=this.newDate(e,t,a);return o.add(-o.dayOfWeek(),"d"),ea((o.dayOfYear()-1)/7)+1},daysInYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);if(e=t.year(),"undefined"==typeof this.NEPALI_CALENDAR_DATA[e])return this.daysPerYear;for(var o=0,r=this.minMonth;12>=r;r++)o+=this.NEPALI_CALENDAR_DATA[e][r];return o},daysInMonth:function(e,t){return e.year&&(t=e.month(),e=e.year()),this._validate(e,t,this.minDay,a.local.invalidMonth),"undefined"==typeof this.NEPALI_CALENDAR_DATA[e]?this.daysPerMonth[t-1]:this.NEPALI_CALENDAR_DATA[e][t]},weekDay:function(e,t,a){return 6!==this.dayOfWeek(e,t,a)},toJD:function(e,t,o){var r=this._validate(e,t,o,a.local.invalidDate);e=r.year(),t=r.month(),o=r.day();var i=a.instance(),n=0,l=t,s=e;this._createMissingCalendarData(e);var d=e-(9<l||9===l&&o>=this.NEPALI_CALENDAR_DATA[s][0]?56:57);for(9!==t&&(n=o,l--);9!==l;)0>=l&&(l=12,s--),n+=this.NEPALI_CALENDAR_DATA[s][l],l--;return 9===t?(n+=o-this.NEPALI_CALENDAR_DATA[s][0],0>n&&(n+=i.daysInYear(d))):n+=this.NEPALI_CALENDAR_DATA[s][9]-this.NEPALI_CALENDAR_DATA[s][0],i.newDate(d,1,1).add(n,"d").toJD()},fromJD:function(e){var t=a.instance(),o=t.fromJD(e),r=o.year(),i=o.dayOfYear(),n=r+56;this._createMissingCalendarData(n);for(var l=9,s=this.NEPALI_CALENDAR_DATA[n][0],d=this.NEPALI_CALENDAR_DATA[n][l]-s+1;i>d;)l++,12<l&&(l=1,n++),d+=this.NEPALI_CALENDAR_DATA[n][l];var c=this.NEPALI_CALENDAR_DATA[n][l]-(d-i);return this.newDate(n,l,c)},_createMissingCalendarData:function(e){var t=this.daysPerMonth.slice(0);t.unshift(17);for(var a=e-1;a<e+2;a++)"undefined"==typeof this.NEPALI_CALENDAR_DATA[a]&&(this.NEPALI_CALENDAR_DATA[a]=t)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),a.calendars.nepali=t},{"../main":547,"object-assign":437}],543:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function a(e,t){return e-t*ea(e/t)}var o=e("../main"),r=e("object-assign");t.prototype=new o.baseCalendar,r(t.prototype,{name:"Persian",jdEpoch:1948320.5,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xE6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xE6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,o.local.invalidYear);return 682>682*((t.year()-(0<t.year()?474:473))%2820+474+38)%2816},weekOfYear:function(e,t,a){var o=this.newDate(e,t,a);return o.add(-((o.dayOfWeek()+1)%7),"d"),ea((o.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var a=this._validate(e,t,this.minDay,o.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(12===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(e,t,a){return 5!==this.dayOfWeek(e,t,a)},toJD:function(e,t,r){var i=this._validate(e,t,r,o.local.invalidDate);e=i.year(),t=i.month(),r=i.day();var n=e-(0<=e?474:473),l=474+a(n,2820);return r+(7>=t?31*(t-1):30*(t-1)+6)+ea((682*l-110)/2816)+365*(l-1)+1029983*ea(n/2820)+this.jdEpoch-1},fromJD:function(e){e=ea(e)+.5;var t=e-this.toJD(475,1,1),o=ea(t/1029983),r=a(t,1029983),i=2820;if(1029982!==r){var n=ea(r/366),l=a(r,366);i=ea((2134*n+2816*l+2815)/1028522)+n+1}var s=i+2820*o+474;s=0>=s?s-1:s;var d=e-this.toJD(s,1,1)+1,c=186>=d?ae(d/31):ae((d-6)/30),p=e-this.toJD(s,c,1)+1;return this.newDate(s,c,p)}}),o.calendars.persian=t,o.calendars.jalali=t},{"../main":547,"object-assign":437}],544:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),o=e("object-assign"),r=a.instance();t.prototype=new a.baseCalendar,o(t.prototype,{name:"Taiwan",jdEpoch:2419402.5,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=this._t2gYear(t.year());return r.leapYear(e)},weekOfYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=this._t2gYear(t.year());return r.weekOfYear(e,t.month(),t.day())},daysInMonth:function(e,t){var o=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(2===o.month()&&this.leapYear(o.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,o){var i=this._validate(e,t,o,a.local.invalidDate),e=this._t2gYear(i.year());return r.toJD(e,i.month(),i.day())},fromJD:function(e){var t=r.fromJD(e),a=this._g2tYear(t.year());return this.newDate(a,t.month(),t.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&-1>=e?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(1<=e&&e<=this.yearsOffset?1:0)}}),a.calendars.taiwan=t},{"../main":547,"object-assign":437}],545:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),o=e("object-assign"),r=a.instance();t.prototype=new a.baseCalendar,o(t.prototype,{name:"Thai",jdEpoch:1523098.5,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=this._t2gYear(t.year());return r.leapYear(e)},weekOfYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear),e=this._t2gYear(t.year());return r.weekOfYear(e,t.month(),t.day())},daysInMonth:function(e,t){var o=this._validate(e,t,this.minDay,a.local.invalidMonth);return this.daysPerMonth[o.month()-1]+(2===o.month()&&this.leapYear(o.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,o){var i=this._validate(e,t,o,a.local.invalidDate),e=this._t2gYear(i.year());return r.toJD(e,i.month(),i.day())},fromJD:function(e){var t=r.fromJD(e),a=this._g2tYear(t.year());return this.newDate(a,t.month(),t.day())},_t2gYear:function(e){return e-this.yearsOffset-(1<=e&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&-1>=e?1:0)}}),a.calendars.thai=t},{"../main":547,"object-assign":437}],546:[function(e){function t(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}var a=e("../main"),o=e("object-assign");t.prototype=new a.baseCalendar,o(t.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,a.local.invalidYear);return 355===this.daysInYear(t.year())},weekOfYear:function(e,t,a){var o=this.newDate(e,t,a);return o.add(-o.dayOfWeek(),"d"),ea((o.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var t=0,a=1;12>=a;a++)t+=this.daysInMonth(e,a);return t},daysInMonth:function(e,t){for(var o=this._validate(e,t,this.minDay,a.local.invalidMonth),n=o.toJD()-24e5+.5,l=0,s=0;s<r.length;s++){if(r[s]>n)return r[l]-r[l-1];l++}return 30},weekDay:function(e,t,a){return 5!==this.dayOfWeek(e,t,a)},toJD:function(e,t,o){var i=this._validate(e,t,o,a.local.invalidDate),n=12*(i.year()-1)+i.month()-15292,l=i.day()+r[n-1]-1;return l+24e5-.5},fromJD:function(e){for(var t=e-24e5+.5,a=0,o=0;o<r.length&&!(r[o]>t);o++)a++;var n=a+15292,l=ea((n-1)/12),s=t-r[a-1]+1;return this.newDate(l+1,n-12*l,s)},isValid:function(e){var t=a.baseCalendar.prototype.isValid.apply(this,arguments);return t&&(e=null==e.year?e:e.year,t=1276<=e&&1500>=e),t},_validate:function(e,t,o,r){var i=a.baseCalendar.prototype._validate.apply(this,arguments);if(1276>i.year||1500<i.year)throw r.replace(/\{0\}/,this.local.name);return i}}),a.calendars.ummalqura=t;var r=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":547,"object-assign":437}],547:[function(e,t){function a(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function o(e,t,a,o){if(this._calendar=e,this._year=t,this._month=a,this._day=o,0===this._calendar._validateLevel&&!this._calendar.isValid(this._year,this._month,this._day))throw(s.local.invalidDate||s.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function r(e,t){return e=""+e,"000000".substring(0,t-e.length)+e}function i(){this.shortYearCutoff="+10"}function n(e){this.local=this.regionalOptions[e]||this.regionalOptions[""]}var l=e("object-assign");l(a.prototype,{instance:function(e,t){e=(e||"gregorian").toLowerCase(),t=t||"";var a=this._localCals[e+"-"+t];if(!a&&this.calendars[e]&&(a=new this.calendars[e](t),this._localCals[e+"-"+t]=a),!a)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,e);return a},newDate:function(e,t,a,o,r){return o=(null!=e&&e.year?e.calendar():"string"==typeof o?this.instance(o,r):o)||this.instance(),o.newDate(e,t,a)},substituteDigits:function(e){return function(t){return(t+"").replace(/[0-9]/g,function(t){return e[t]})}},substituteChineseDigits:function(e,t){return function(a){for(var o="",r=0,i;0<a;)i=a%10,o=(0==i?"":e[i]+t[r])+o,r++,a=ea(a/10);return 0===o.indexOf(e[1]+t[1])&&(o=o.substr(1)),o||e[0]}}}),l(o.prototype,{newDate:function(e,t,a){return this._calendar.newDate(null==e?this:e,t,a)},year:function(e){return 0===arguments.length?this._year:this.set(e,"y")},month:function(e){return 0===arguments.length?this._month:this.set(e,"m")},day:function(e){return 0===arguments.length?this._day:this.set(e,"d")},date:function(e,t,a){if(!this._calendar.isValid(e,t,a))throw(s.local.invalidDate||s.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=e,this._month=t,this._day=a,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(e,t){return this._calendar.add(this,e,t)},set:function(e,t){return this._calendar.set(this,e,t)},compareTo:function(e){if(this._calendar.name!==e._calendar.name)throw(s.local.differentCalendars||s.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,e._calendar.local.name);var t=this._year===e._year?this._month===e._month?this._day-e._day:this.monthOfYear()-e.monthOfYear():this._year-e._year;return 0==t?0:0>t?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(e){return this._calendar.fromJD(e)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(e){return this._calendar.fromJSDate(e)},toString:function(){return(0>this.year()?"-":"")+r(wa(this.year()),4)+"-"+r(this.month(),2)+"-"+r(this.day(),2)}}),l(i.prototype,{_validateLevel:0,newDate:function(e,t,a){return null==e?this.today():(e.year&&(this._validate(e,t,a,s.local.invalidDate||s.regionalOptions[""].invalidDate),a=e.day(),t=e.month(),e=e.year()),new o(this,e,t,a))},today:function(){return this.fromJSDate(new Date)},epoch:function(e){var t=this._validate(e,this.minMonth,this.minDay,s.local.invalidYear||s.regionalOptions[""].invalidYear);return 0>t.year()?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,s.local.invalidYear||s.regionalOptions[""].invalidYear);return(0>t.year()?"-":"")+r(wa(t.year()),4)},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,s.local.invalidYear||s.regionalOptions[""].invalidYear),12},monthOfYear:function(e,t){var a=this._validate(e,t,this.minDay,s.local.invalidMonth||s.regionalOptions[""].invalidMonth);return(a.month()+this.monthsInYear(a)-this.firstMonth)%this.monthsInYear(a)+this.minMonth},fromMonthOfYear:function(e,t){var a=(t+this.firstMonth-2*this.minMonth)%this.monthsInYear(e)+this.minMonth;return this._validate(e,a,this.minDay,s.local.invalidMonth||s.regionalOptions[""].invalidMonth),a},daysInYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,s.local.invalidYear||s.regionalOptions[""].invalidYear);return this.leapYear(t)?366:365},dayOfYear:function(e,t,a){var o=this._validate(e,t,a,s.local.invalidDate||s.regionalOptions[""].invalidDate);return o.toJD()-this.newDate(o.year(),this.fromMonthOfYear(o.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(e,t,a){var o=this._validate(e,t,a,s.local.invalidDate||s.regionalOptions[""].invalidDate);return(ea(this.toJD(o))+2)%this.daysInWeek()},extraInfo:function(e,t,a){return this._validate(e,t,a,s.local.invalidDate||s.regionalOptions[""].invalidDate),{}},add:function(e,t,a){return this._validate(e,this.minMonth,this.minDay,s.local.invalidDate||s.regionalOptions[""].invalidDate),this._correctAdd(e,this._add(e,t,a),t,a)},_add:function(e,t,a){if(this._validateLevel++,"d"===a||"w"===a){var o=e.toJD()+t*("w"===a?this.daysInWeek():1),r=e.calendar().fromJD(o);return this._validateLevel--,[r.year(),r.month(),r.day()]}try{var i=e.year()+("y"===a?t:0),n=e.monthOfYear()+("m"===a?t:0),r=e.day(),l=function(e){for(;n<e.minMonth;)i--,n+=e.monthsInYear(i);for(var t=e.monthsInYear(i);n>t-1+e.minMonth;)i++,n-=t,t=e.monthsInYear(i)};"y"===a?(e.month()!==this.fromMonthOfYear(i,n)&&(n=this.newDate(i,e.month(),this.minDay).monthOfYear()),n=ie(n,this.monthsInYear(i)),r=ie(r,this.daysInMonth(i,this.fromMonthOfYear(i,n)))):"m"==a&&(l(this),r=ie(r,this.daysInMonth(i,this.fromMonthOfYear(i,n))));var s=[i,this.fromMonthOfYear(i,n),r];return this._validateLevel--,s}catch(t){throw this._validateLevel--,t}},_correctAdd:function(e,t,a,o){if(!this.hasYearZero&&("y"===o||"m"===o)&&(0===t[0]||0<e.year()!=0<t[0])){var r={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[o],i=0>a?-1:1;t=this._add(e,a*r[0]+i*r[1],r[2])}return e.date(t[0],t[1],t[2])},set:function(e,t,a){this._validate(e,this.minMonth,this.minDay,s.local.invalidDate||s.regionalOptions[""].invalidDate);var o="y"===a?t:e.year(),r="m"===a?t:e.month(),i="d"===a?t:e.day();return("y"===a||"m"===a)&&(i=ie(i,this.daysInMonth(o,r))),e.date(o,r,i)},isValid:function(e,t,a){this._validateLevel++;var o=this.hasYearZero||0!==e;if(o){var r=this.newDate(e,t,this.minDay);o=t>=this.minMonth&&t-this.minMonth<this.monthsInYear(r)&&a>=this.minDay&&a-this.minDay<this.daysInMonth(r)}return this._validateLevel--,o},toJSDate:function(e,t,a){var o=this._validate(e,t,a,s.local.invalidDate||s.regionalOptions[""].invalidDate);return s.instance().fromJD(this.toJD(o)).toJSDate()},fromJSDate:function(e){return this.fromJD(s.instance().fromJSDate(e).toJD())},_validate:function(e,t,a,o){if(e.year){if(0===this._validateLevel&&this.name!==e.calendar().name)throw(s.local.differentCalendars||s.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,e.calendar().local.name);return e}try{if(this._validateLevel++,1===this._validateLevel&&!this.isValid(e,t,a))throw o.replace(/\{0\}/,this.local.name);var r=this.newDate(e,t,a);return this._validateLevel--,r}catch(t){throw this._validateLevel--,t}}}),n.prototype=new i,l(n.prototype,{name:"Gregorian",jdEpoch:1721425.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,s.local.invalidYear||s.regionalOptions[""].invalidYear),e=t.year()+(0>t.year()?1:0);return 0==e%4&&(0!=e%100||0==e%400)},weekOfYear:function(e,t,a){var o=this.newDate(e,t,a);return o.add(4-(o.dayOfWeek()||7),"d"),ea((o.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var a=this._validate(e,t,this.minDay,s.local.invalidMonth||s.regionalOptions[""].invalidMonth);return this.daysPerMonth[a.month()-1]+(2===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(e,t,a){return 6>(this.dayOfWeek(e,t,a)||7)},toJD:function(e,t,o){var r=this._validate(e,t,o,s.local.invalidDate||s.regionalOptions[""].invalidDate);e=r.year(),t=r.month(),o=r.day(),0>e&&e++,3>t&&(t+=12,e--);var i=ea(e/100),a=2-i+ea(i/4);return ea(365.25*(e+4716))+ea(30.6001*(t+1))+o+a-1524.5},fromJD:function(t){var o=ea(t+.5),r=ea((o-1867216.25)/36524.25);r=o+1+r-ea(r/4);var i=r+1524,n=ea((i-122.1)/365.25),l=ea(365.25*n),s=ea((i-l)/30.6001),e=i-l-ea(30.6001*s),d=s-(13.5<s?13:1),c=n-(2.5<d?4716:4715);return 0>=c&&c--,this.newDate(c,d,e)},toJSDate:function(e,t,a){var o=this._validate(e,t,a,s.local.invalidDate||s.regionalOptions[""].invalidDate),r=new Date(o.year(),o.month()-1,o.day());return r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0),r.setHours(12<r.getHours()?r.getHours()+2:0),r},fromJSDate:function(e){return this.newDate(e.getFullYear(),e.getMonth()+1,e.getDate())}});var s=t.exports=new a;s.cdate=o,s.baseCalendar=i,s.calendars.gregorian=n},{"object-assign":437}],548:[function(e){var t=e("object-assign"),a=e("./main");t(a.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),a.local=a.regionalOptions[""],t(a.cdate.prototype,{formatDate:function(e,t){return"string"!=typeof e&&(t=e,e=""),this._calendar.formatDate(e||"",this,t)}}),t(a.baseCalendar.prototype,{UNIX_EPOCH:a.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:a.instance().jdEpoch,TICKS_PER_DAY:864000000000,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(e,t,o){if("string"!=typeof e&&(o=t,t=e,e=""),!t)return"";if(t.calendar()!==this)throw a.local.invalidFormat||a.regionalOptions[""].invalidFormat;e=e||this.local.dateFormat,o=o||{};for(var r=o.dayNamesShort||this.local.dayNamesShort,i=o.dayNames||this.local.dayNames,n=o.monthNumbers||this.local.monthNumbers,l=o.monthNamesShort||this.local.monthNamesShort,s=o.monthNames||this.local.monthNames,d=o.calculateWeek||this.local.calculateWeek,c=function(t,a){for(var o=1;_+o<e.length&&e.charAt(_+o)===t;)o++;return _+=o-1,1<ea(o/(a||1))},p=function(e,t,a,o){var r=""+t;if(c(e,o))for(;r.length<a;)r="0"+r;return r},u=function(e,t,a,o){return c(e)?o[t]:a[t]},g=this,h=function(e){return"function"==typeof n?n.call(g,e,c("m")):f(p("m",e.month(),2))},m=function(e,t){return t?"function"==typeof s?s.call(g,e):s[e.month()-g.minMonth]:"function"==typeof l?l.call(g,e):l[e.month()-g.minMonth]},y=this.local.digits,f=function(e){return o.localNumbers&&y?y(e):e},x="",b=!1,_=0;_<e.length;_++)if(b)"'"!==e.charAt(_)||c("'")?x+=e.charAt(_):b=!1;else switch(e.charAt(_)){case"d":x+=f(p("d",t.day(),2));break;case"D":x+=u("D",t.dayOfWeek(),r,i);break;case"o":x+=p("o",t.dayOfYear(),3);break;case"w":x+=p("w",t.weekOfYear(),2);break;case"m":x+=h(t);break;case"M":x+=m(t,c("M"));break;case"y":x+=c("y",2)?t.year():(10>t.year()%100?"0":"")+t.year()%100;break;case"Y":c("Y",2),x+=t.formatYear();break;case"J":x+=t.toJD();break;case"@":x+=(t.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":x+=(t.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":c("'")?x+="'":b=!0;break;default:x+=e.charAt(_);}return x},parseDate:function(e,t,o){if(null==t)throw a.local.invalidArguments||a.regionalOptions[""].invalidArguments;if(t="object"==typeof t?t.toString():t+"",""===t)return null;e=e||this.local.dateFormat,o=o||{};var r=o.shortYearCutoff||this.shortYearCutoff;r="string"==typeof r?this.today().year()%100+parseInt(r,10):r;for(var i=o.dayNamesShort||this.local.dayNamesShort,n=o.dayNames||this.local.dayNames,l=o.parseMonth||this.local.parseMonth,s=o.monthNumbers||this.local.monthNumbers,d=o.monthNamesShort||this.local.monthNamesShort,c=o.monthNames||this.local.monthNames,p=-1,u=-1,g=-1,h=-1,m=-1,y=!1,f=!1,x=function(t,a){for(var o=1;S+o<e.length&&e.charAt(S+o)===t;)o++;return S+=o-1,1<ea(o/(a||1))},b=function(e,o){var r=x(e,o),i=[2,3,r?4:2,r?4:2,10,11,20]["oyYJ@!".indexOf(e)+1],n=new RegExp("^-?\\d{1,"+i+"}"),l=t.substring(A).match(n);if(!l)throw(a.local.missingNumberAt||a.regionalOptions[""].missingNumberAt).replace(/\{0\}/,A);return A+=l[0].length,parseInt(l[0],10)},_=this,v=function(){if("function"==typeof s){x("m");var e=s.call(_,t.substring(A));return A+=e.length,e}return b("m")},w=function(e,o,r,n){for(var l=x(e,n)?r:o,s=0;s<l.length;s++)if(t.substr(A,l[s].length).toLowerCase()===l[s].toLowerCase())return A+=l[s].length,s+_.minMonth;throw(a.local.unknownNameAt||a.regionalOptions[""].unknownNameAt).replace(/\{0\}/,A)},k=function(){if("function"==typeof c){var e=x("M")?c.call(_,t.substring(A)):d.call(_,t.substring(A));return A+=e.length,e}return w("M",d,c)},T=function(){if(t.charAt(A)!==e.charAt(S))throw(a.local.unexpectedLiteralAt||a.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,A);A++},A=0,S=0;S<e.length;S++)if(f)"'"!==e.charAt(S)||x("'")?T():f=!1;else switch(e.charAt(S)){case"d":h=b("d");break;case"D":w("D",i,n);break;case"o":m=b("o");break;case"w":b("w");break;case"m":g=v();break;case"M":g=k();break;case"y":var C=S;y=!x("y",2),S=C,u=b("y",2);break;case"Y":u=b("Y",2);break;case"J":p=b("J")+.5,"."===t.charAt(A)&&(A++,b("J"));break;case"@":p=b("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":p=b("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":A=t.length;break;case"'":x("'")?T():f=!0;break;default:T();}if(A<t.length)throw a.local.unexpectedText||a.regionalOptions[""].unexpectedText;if(-1===u?u=this.today().year():100>u&&y&&(u+=-1===r?1900:this.today().year()-this.today().year()%100-(u<=r?0:100)),"string"==typeof g&&(g=l.call(this,u,g)),-1<m){g=1,h=m;for(var L=this.daysInMonth(u,g);h>L;L=this.daysInMonth(u,g))g++,h-=L}return-1<p?this.fromJD(p):this.newDate(u,g,h)},determineDate:function(e,t,a,o,r){a&&"object"!=typeof a&&(r=o,o=a,a=null),"string"!=typeof o&&(r=o,o="");var i=this,n=function(e){try{return i.parseDate(o,e,r)}catch(t){}e=e.toLowerCase();for(var t=(e.match(/^c/)&&a?a.newDate():null)||i.today(),n=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,l=n.exec(e);l;)t.add(parseInt(l[1],10),l[2]||"d"),l=n.exec(e);return t};return t=t?t.newDate():null,e=null==e?t:"string"==typeof e?n(e):"number"==typeof e?isNaN(e)||e===1/0||e===-Infinity?t:i.today().add(e,"d"):i.newDate(e),e}})},{"./main":547,"object-assign":437}],549:[function(e,t){t.exports=e("cwise-compiler")({args:["array",{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\n        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_\n        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_\n        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {\n          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))\n        }\n      }",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg3_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"})},{"cwise-compiler":134}],550:[function(e,t){"use strict";t.exports=function(e,t){var o=[];return t=+t||0,a(e.hi(e.shape[0]-1),o,t),o};var a=e("./lib/zc-core")},{"./lib/zc-core":549}],551:[function(e,t){"use strict";t.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],552:[function(e,t){"use strict";var a=e("./arrow_paths"),o=e("../../plots/font_attributes"),r=e("../../plots/cartesian/constants"),i=e("../../plot_api/plot_template").templatedArray;t.exports=i("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:o({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:a.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:a.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",r.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",r.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",r.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",r.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:o({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../plot_api/plot_template":730,"../../plots/cartesian/constants":746,"../../plots/font_attributes":767,"./arrow_paths":551}],553:[function(e,t){"use strict";function a(e){var t=e._fullLayout;r.filterVisible(t.annotations).forEach(function(t){var a=i.getFromId(e,t.xref),r=i.getFromId(e,t.yref);t._extremes={},a&&o(t,a),r&&o(t,r)})}function o(e,t){var a=t._id,o=a.charAt(0),r=e[o],n=e["a"+o],l=e[o+"ref"],s=e["a"+o+"ref"],d=e["_"+o+"padplus"],c=e["_"+o+"padminus"],p={x:1,y:-1}[o]*e[o+"shift"],u=3*e.arrowsize*e.arrowwidth||0,g=u+p,h=u-p,m=3*e.startarrowsize*e.arrowwidth||0,y=m+p,f=m-p,x;if(s===l){var b=i.findExtremes(t,[t.r2c(r)],{ppadplus:g,ppadminus:h}),_=i.findExtremes(t,[t.r2c(n)],{ppadplus:va(d,y),ppadminus:va(c,f)});x={min:[b.min[0],_.min[0]],max:[b.max[0],_.max[0]]}}else y=n?y+n:y,f=n?f-n:f,x=i.findExtremes(t,[t.r2c(r)],{ppadplus:va(d,g,y),ppadminus:va(c,h,f)});e._extremes[a]=x}var r=e("../../lib"),i=e("../../plots/cartesian/axes"),n=e("./draw").draw;t.exports=function(e){var t=e._fullLayout,o=r.filterVisible(t.annotations);if(o.length&&e._fullData.length)return r.syncOrAsync([n,a],e)}},{"../../lib":692,"../../plots/cartesian/axes":740,"./draw":558}],554:[function(e,t){"use strict";function a(e,t){var a=e._fullLayout.annotations,r=[],n=[],l=[],s=(t||[]).length,d,c,p,u,g,h,m,y;for(d=0;d<a.length;d++)if(p=a[d],u=p.clicktoshow,u){for(c=0;c<s;c++)if(g=t[c],h=g.xaxis,m=g.yaxis,h._id===p.xref&&m._id===p.yref&&h.d2r(g.x)===o(p._xclick,h)&&m.d2r(g.y)===o(p._yclick,m)){y=p.visible?"onout"===u?n:l:r,y.push(d);break}c===s&&p.visible&&"onout"===u&&n.push(d)}return{on:r,off:n,explicitOff:l}}function o(e,t){return"log"===t.type?t.l2r(e):t.d2r(e)}var r=e("../../lib"),n=e("../../registry"),l=e("../../plot_api/plot_template").arrayEditor;t.exports={hasClickToShow:function(e,t){var o=a(e,t);return 0<o.on.length||0<o.explicitOff.length},onClick:function(e,t){var o=a(e,t),s=o.on,d=o.off.concat(o.explicitOff),c={},p=e._fullLayout.annotations,u,g;if(s.length||d.length){for(u=0;u<s.length;u++)g=l(e.layout,"annotations",p[s[u]]),g.modifyItem("visible",!0),r.extendFlat(c,g.getUpdateObj());for(u=0;u<d.length;u++)g=l(e.layout,"annotations",p[d[u]]),g.modifyItem("visible",!1),r.extendFlat(c,g.getUpdateObj());return n.call("update",e,{},c)}}}},{"../../lib":692,"../../plot_api/plot_template":730,"../../registry":823}],555:[function(e,t){"use strict";var a=e("../../lib"),o=e("../color");t.exports=function(e,t,r,i){i("opacity");var n=i("bgcolor"),l=i("bordercolor"),s=o.opacity(l);i("borderpad");var d=i("borderwidth"),c=i("showarrow");i("text",c?" ":r._dfltTitle.annotation),i("textangle"),a.coerceFont(i,"font",r.font),i("width"),i("align");var p=i("height");if(p&&i("valign"),c){var u=i("arrowside"),g,h;-1!==u.indexOf("end")&&(g=i("arrowhead"),h=i("arrowsize")),-1!==u.indexOf("start")&&(i("startarrowhead",g),i("startarrowsize",h)),i("arrowcolor",s?t.bordercolor:o.defaultLine),i("arrowwidth",2*(s&&d||1)),i("standoff"),i("startstandoff")}var m=i("hovertext"),y=r.hoverlabel||{};if(m){var f=i("hoverlabel.bgcolor",y.bgcolor||(o.opacity(n)?o.rgb(n):o.defaultLine)),x=i("hoverlabel.bordercolor",y.bordercolor||o.contrast(f));a.coerceFont(i,"hoverlabel.font",{family:y.font.family,size:y.font.size,color:y.font.color||x})}i("captureevents",!!m)}},{"../../lib":692,"../color":569}],556:[function(e,t){"use strict";var a=e("fast-isnumeric"),o=e("../../lib/to_log_range");t.exports=function(e,t,r,n){function l(e){var r=g[e],i=null;i=s?o(r,t.range):_a(10,r),a(i)||(i=null),n(h+e,i)}t=t||{};var s="log"===r&&"linear"===t.type,d="linear"===r&&"log"===t.type;if(s||d)for(var c=e._fullLayout.annotations,p=t._id.charAt(0),u=0,g,h;u<c.length;u++)g=c[u],h="annotations["+u+"].",g[p+"ref"]===t._id&&l(p),g["a"+p+"ref"]===t._id&&l("a"+p)}},{"../../lib/to_log_range":718,"fast-isnumeric":214}],557:[function(e,t){"use strict";function a(e,t,a){function s(a,r){return o.coerce(e,t,l,a,r)}var d=s("visible"),c=s("clicktoshow");if(d||c){n(e,t,a,s);for(var p=t.showarrow,u=["x","y"],g=[-10,-30],h={_fullLayout:a},m=0;2>m;m++){var y=u[m],f=r.coerceRef(e,t,h,y,"","paper");if("paper"!==f){var x=r.getFromId(h,f);x._annIndices.push(t._index)}if(r.coercePosition(t,h,s,f,y,.5),p){var b="a"+y,_=r.coerceRef(e,t,h,b,"pixel");"pixel"!==_&&_!==f&&(_=t[b]="pixel");var v="pixel"===_?g[m]:.4;r.coercePosition(t,h,s,_,b,v)}s(y+"anchor"),s(y+"shift")}if(o.noneOrAll(e,t,["x","y"]),p&&o.noneOrAll(e,t,["ax","ay"]),c){var w=s("xclick"),k=s("yclick");t._xclick=void 0===w?t.x:r.cleanPosition(w,h,t.xref),t._yclick=void 0===k?t.y:r.cleanPosition(k,h,t.yref)}}}var o=e("../../lib"),r=e("../../plots/cartesian/axes"),i=e("../../plots/array_container_defaults"),n=e("./common_defaults"),l=e("./attributes");t.exports=function(e,t){i(e,t,{name:"annotations",handleItemDefaults:a})}},{"../../lib":692,"../../plots/array_container_defaults":736,"../../plots/cartesian/axes":740,"./attributes":552,"./common_defaults":555}],558:[function(e,t){"use strict";function a(e,t){var a=e._fullLayout,r=a.annotations[t]||{},i=s.getFromId(e,r.xref),n=s.getFromId(e,r.yref);o(e,r,t,!1,i,n)}function o(e,t,a,o,n,s){function f(a){return a.call(c.font,G).attr({"text-anchor":{left:"start",right:"end"}[t.align]||"middle"}),u.convertToTspans(a,e,x),a}function x(){function a(e,t){return"auto"===t&&(e<1/3?t="left":e>2/3?t="right":t="center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[t]}var r=Y.selectAll("a");if(1===r.size()&&r.text()===Y.text()){var p=j.insert("a",":first-child").attr({"xlink:xlink:href":r.attr("xlink:href"),"xlink:xlink:show":r.attr("xlink:show")}).style({cursor:"pointer"});p.node().appendChild(V.node())}for(var m=j.select(".annotation-text-math-group"),f=!m.empty(),x=c.bBox((f?m:Y).node()),w=x.width,k=x.height,T=t.width||w,O=t.height||k,F=R(T+2*N),G=R(O+2*N),q=!1,W=["x","y"],X=0;X<W.length;X++){var Z=W[X],$=t[Z+"ref"]||Z,J=t["a"+Z+"ref"],K={x:n,y:s}[Z],Q=(z+("x"===Z?0:-90))*Sa/180,ee=F*te(Q),ae=G*M(Q),oe=wa(ee)+wa(ae),ne=t[Z+"anchor"],le=t[Z+"shift"]*("x"===Z?1:-1),se=E[Z],de,ce,pe,ue,ge;if(K){var he=K.r2fraction(t[Z]);(0>he||1<he)&&(J===$?(he=K.r2fraction(t["a"+Z]),(0>he||1<he)&&(q=!0)):q=!0),de=K._offset+K.r2p(t[Z]),ue=.5}else"x"===Z?(pe=t[Z],de=_.l+_.w*pe):(pe=1-t[Z],de=_.t+_.h*pe),ue=t.showarrow?.5:pe;if(t.showarrow){se.head=de;var me=t["a"+Z];ge=ee*a(.5,t.xanchor)-ae*a(.5,t.yanchor),J===$?(se.tail=K._offset+K.r2p(me),ce=ge):(se.tail=de+me,ce=ge+me),se.text=se.tail+ge;var ye=b["x"===Z?"width":"height"];if("paper"===$&&(se.head=l.constrain(se.head,1,ye-1)),"pixel"===J){var fe=-va(se.tail-3,se.text),xe=ie(se.tail+3,se.text)-ye;0<fe?(se.tail+=fe,se.text+=fe):0<xe&&(se.tail-=xe,se.text-=xe)}se.tail+=le,se.head+=le}else ge=oe*a(ue,ne),ce=ge,se.text=de+ge;se.text+=le,ge+=le,ce+=le,t["_"+Z+"padplus"]=oe/2+ce,t["_"+Z+"padminus"]=oe/2-ce,t["_"+Z+"size"]=oe,t["_"+Z+"shift"]=ge}if(!e._dragging&&q)return void j.remove();var be=0,_e=0;if("left"!==t.align&&(be=(T-w)*("center"===t.align?.5:1)),"top"!==t.valign&&(_e=(O-k)*("middle"===t.valign?.5:1)),f)m.select("svg").attr({x:N+be-1,y:N+_e}).call(c.setClipUrl,U?L:null,e);else{var ve=N+_e-x.top,we=N+be-x.left;Y.call(u.positionText,we,ve).call(c.setClipUrl,U?L:null,e)}H.select("rect").call(c.setRect,N,N,T,O),V.call(c.setRect,B/2,B/2,F-B,G-B),j.call(c.setTranslate,R(E.x.text-F/2),R(E.y.text-G/2)),D.attr({transform:"rotate("+z+","+E.x.text+","+E.y.text+")"});var ke=function(a,r){I.selectAll(".annotation-arrow-g").remove();var u=E.x.head,g=E.y.head,m=E.x.tail+a,f=E.y.tail+r,x=E.x.text+a,b=E.y.text+r,w=l.rotationXYMatrix(z,x,b),k=l.apply2DTransform(w),T=l.apply2DTransform2(w),L=+V.attr("width"),P=+V.attr("height"),O=x-.5*L,R=O+L,M=b-.5*P,B=M+P,F=[[O,M,O,B],[O,B,R,B],[R,B,R,M],[R,M,O,M]].map(T);if(!F.reduce(function(e,t){return e^!!l.segmentsIntersect(u,g,u+1e6,g+1e6,t[0],t[1],t[2],t[3])},!1)){F.forEach(function(e){var t=l.segmentsIntersect(m,f,u,g,e[0],e[1],e[2],e[3]);t&&(m=t.x,f=t.y)});var N=t.arrowwidth,U=t.arrowcolor,H=t.arrowside,G=I.append("g").style({opacity:d.opacity(U)}).classed("annotation-arrow-g",!0),Y=G.append("path").attr("d","M"+m+","+f+"L"+u+","+g).style("stroke-width",N+"px").call(d.stroke,d.rgb(U));if(y(Y,H,t),v.annotationPosition&&Y.node().parentNode&&!o){var q=u,W=g;if(t.standoff){var X=re(_a(u-m,2)+_a(g-f,2));q+=t.standoff*(m-u)/X,W+=t.standoff*(f-g)/X}var Z=G.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(m-q)+","+(f-W),transform:"translate("+q+","+W+")"}).style("stroke-width",N+6+"px").call(d.stroke,"rgba(0,0,0,0)").call(d.fill,"rgba(0,0,0,0)"),$,J;h.init({element:Z.node(),gd:e,prepFn:function(){var e=c.getTranslate(j);$=e.x,J=e.y,n&&n.autorange&&A(n._name+".autorange",!0),s&&s.autorange&&A(s._name+".autorange",!0)},moveFn:function(e,a){var o=k($,J),r=o[0]+e,i=o[1]+a;j.call(c.setTranslate,r,i),S("x",n?n.p2r(n.r2p(t.x)+e):t.x+e/_.w),S("y",s?s.p2r(s.r2p(t.y)+a):t.y-a/_.h),t.axref===t.xref&&S("ax",n.p2r(n.r2p(t.ax)+e)),t.ayref===t.yref&&S("ay",s.p2r(s.r2p(t.ay)+a)),G.attr("transform","translate("+e+","+a+")"),D.attr({transform:"rotate("+z+","+r+","+i+")"})},doneFn:function(){i.call("_guiRelayout",e,C());var t=document.querySelector(".js-notes-box-panel");t&&t.redraw(t.selectedObj)}})}}};if(t.showarrow&&ke(0,0),P){var Te;h.init({element:j.node(),gd:e,prepFn:function(){Te=D.attr("transform")},moveFn:function(e,a){var r="pointer";if(t.showarrow)t.axref===t.xref?S("ax",n.p2r(n.r2p(t.ax)+e)):S("ax",t.ax+e),t.ayref===t.yref?S("ay",s.p2r(s.r2p(t.ay)+a)):S("ay",t.ay+a),ke(e,a);else if(!o){var i,l;if(n)i=n.p2r(n.r2p(t.x)+e);else{var d=t._xsize/_.w,c=t.x+(t._xshift-t.xshift)/_.w-d/2;i=h.align(c+e/_.w,d,0,1,t.xanchor)}if(s)l=s.p2r(s.r2p(t.y)+a);else{var p=t._ysize/_.h,u=t.y-(t._yshift+t.yshift)/_.h-p/2;l=h.align(u-a/_.h,p,0,1,t.yanchor)}S("x",i),S("y",l),n&&s||(r=h.getCursor(n?.5:i,s?.5:l,t.xanchor,t.yanchor))}else return;D.attr({transform:"translate("+e+","+a+")"+Te}),g(j,r)},doneFn:function(){g(j),i.call("_guiRelayout",e,C());var t=document.querySelector(".js-notes-box-panel");t&&t.redraw(t.selectedObj)}})}}var b=e._fullLayout,_=e._fullLayout._size,v=e._context.edits,w,k;o?(w="annotation-"+o,k=o+".annotations"):(w="annotation",k="annotations");var T=m(e.layout,k,t),A=T.modifyBase,S=T.modifyItem,C=T.getUpdateObj;b._infolayer.selectAll("."+w+"[data-index=\""+a+"\"]").remove();var L="clip"+b._uid+"_ann"+a;if(!t._input||!1===t.visible)return void r.selectAll("#"+L).remove();var E={x:{},y:{}},z=+t.textangle||0,I=b._infolayer.append("g").classed(w,!0).attr("data-index",a+"").style("opacity",t.opacity),D=I.append("g").classed("annotation-text-g",!0),P=v[t.showarrow?"annotationTail":"annotationPosition"],O=t.captureevents||v.annotationText||P,j=D.append("g").style("pointer-events",O?"all":null).call(g,"pointer").on("click",function(){e._dragging=!1;var i={index:a,annotation:t._input,fullAnnotation:t,event:r.event};o&&(i.subplotId=o),e.emit("plotly_clickannotation",i)});t.hovertext&&j.on("mouseover",function(){var a=t.hoverlabel,o=a.font,r=this.getBoundingClientRect(),i=e.getBoundingClientRect();p.loneHover({x0:r.left-i.left,x1:r.right-i.left,y:(r.top+r.bottom)/2-i.top,text:t.hovertext,color:a.bgcolor,borderColor:a.bordercolor,fontFamily:o.family,fontSize:o.size,fontColor:o.color},{container:b._hoverlayer.node(),outerContainer:b._paper.node(),gd:e})}).on("mouseout",function(){p.loneUnhover(b._hoverlayer.node())});var B=t.borderwidth,F=t.borderpad,N=B+F,V=j.append("rect").attr("class","bg").style("stroke-width",B+"px").call(d.stroke,t.bordercolor).call(d.fill,t.bgcolor),U=t.width||t.height,H=b._topclips.selectAll("#"+L).data(U?[0]:[]);H.enter().append("clipPath").classed("annclip",!0).attr("id",L).append("rect"),H.exit().remove();var G=t.font,Y=j.append("text").classed("annotation-text",!0).text(t.text);v.annotationText?Y.call(u.makeEditable,{delegate:j,gd:e}).call(f).on("edit",function(a){t.text=a,this.call(f),S("text",a),n&&n.autorange&&A(n._name+".autorange",!0),s&&s.autorange&&A(s._name+".autorange",!0),i.call("_guiRelayout",e,C())}):Y.call(f)}var r=e("d3"),i=e("../../registry"),n=e("../../plots/plots"),l=e("../../lib"),s=e("../../plots/cartesian/axes"),d=e("../color"),c=e("../drawing"),p=e("../fx"),u=e("../../lib/svg_text_utils"),g=e("../../lib/setcursor"),h=e("../dragelement"),m=e("../../plot_api/plot_template").arrayEditor,y=e("./draw_arrow_head");t.exports={draw:function(e){var t=e._fullLayout;t._infolayer.selectAll(".annotation").remove();for(var o=0;o<t.annotations.length;o++)t.annotations[o].visible&&a(e,o);return n.previousPromises(e)},drawOne:a,drawRaw:o}},{"../../lib":692,"../../lib/setcursor":712,"../../lib/svg_text_utils":716,"../../plot_api/plot_template":730,"../../plots/cartesian/axes":740,"../../plots/plots":804,"../../registry":823,"../color":569,"../dragelement":587,"../drawing":590,"../fx":608,"./draw_arrow_head":559,d3:148}],559:[function(e,t){"use strict";var a=e("d3"),o=e("../color"),r=e("./arrow_paths");t.exports=function(e,t,i){function n(){e.style("stroke-dasharray","0px,100px")}function l(t,r,n,l){t.path&&(t.noRotate&&(n=0),a.select(s.parentNode).append("path").attr({class:e.attr("class"),d:t.path,transform:"translate("+r.x+","+r.y+")"+(n?"rotate("+180*n/Sa+")":"")+"scale("+l+")"}).style({fill:o.rgb(i.arrowcolor),"stroke-width":0}))}var s=e.node(),d=r[i.arrowhead||0],c=r[i.startarrowhead||0],p=(i.arrowwidth||1)*(i.arrowsize||1),u=(i.arrowwidth||1)*(i.startarrowsize||1),g=0<=t.indexOf("start"),h=0<=t.indexOf("end"),m=d.backoff*p+i.standoff,y=c.backoff*u+i.startstandoff,f,x,b,_;if("line"===s.nodeName){f={x:+e.attr("x1"),y:+e.attr("y1")},x={x:+e.attr("x2"),y:+e.attr("y2")};var v=f.x-x.x,w=f.y-x.y;if(b=L(w,v),_=b+Sa,m&&y&&m+y>re(v*v+w*w))return void n();if(m){if(m*m>v*v+w*w)return void n();var k=m*te(b),T=m*M(b);x.x+=k,x.y+=T,e.attr({x2:x.x,y2:x.y})}if(y){if(y*y>v*v+w*w)return void n();var A=y*te(b),S=y*M(b);f.x-=A,f.y-=S,e.attr({x1:f.x,y1:f.y})}}else if("path"===s.nodeName){var C=s.getTotalLength(),E="";if(C<m+y)return void n();var z=s.getPointAtLength(0),I=s.getPointAtLength(.1);b=L(z.y-I.y,z.x-I.x),f=s.getPointAtLength(ie(y,C)),E="0px,"+y+"px,";var D=s.getPointAtLength(C),P=s.getPointAtLength(C-.1);_=L(D.y-P.y,D.x-P.x),x=s.getPointAtLength(va(0,C-m));var O=E?y+m:m;E+=C-O+"px,"+C+"px",e.style("stroke-dasharray",E)}g&&l(c,f,b,u),h&&l(d,x,_,p)}},{"../color":569,"./arrow_paths":551,d3:148}],560:[function(e,t){"use strict";var a=e("./draw"),o=e("./click");t.exports={moduleType:"component",name:"annotations",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("annotations"),calcAutorange:e("./calc_autorange"),draw:a.draw,drawOne:a.drawOne,drawRaw:a.drawRaw,hasClickToShow:o.hasClickToShow,onClick:o.onClick,convertCoords:e("./convert_coords")}},{"../../plots/cartesian/include_components":751,"./attributes":552,"./calc_autorange":553,"./click":554,"./convert_coords":556,"./defaults":557,"./draw":558}],561:[function(e,t){"use strict";var a=e("../annotations/attributes"),o=e("../../plot_api/edit_types").overrideAll,r=e("../../plot_api/plot_template").templatedArray;t.exports=o(r("annotation",{visible:a.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:a.xanchor,xshift:a.xshift,yanchor:a.yanchor,yshift:a.yshift,text:a.text,textangle:a.textangle,font:a.font,width:a.width,height:a.height,opacity:a.opacity,align:a.align,valign:a.valign,bgcolor:a.bgcolor,bordercolor:a.bordercolor,borderpad:a.borderpad,borderwidth:a.borderwidth,showarrow:a.showarrow,arrowcolor:a.arrowcolor,arrowhead:a.arrowhead,startarrowhead:a.startarrowhead,arrowside:a.arrowside,arrowsize:a.arrowsize,startarrowsize:a.startarrowsize,arrowwidth:a.arrowwidth,standoff:a.standoff,startstandoff:a.startstandoff,hovertext:a.hovertext,hoverlabel:a.hoverlabel,captureevents:a.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":723,"../../plot_api/plot_template":730,"../annotations/attributes":552}],562:[function(e,t){"use strict";function a(e,t){var a=t.fullSceneLayout,i=a.domain,n=t.fullLayout._size,l={pdata:null,type:"linear",autorange:!1,range:[-Infinity,1/0]};e._xa={},o.extendFlat(e._xa,l),r.setConvert(e._xa),e._xa._offset=n.l+i.x[0]*n.w,e._xa.l2p=function(){return .5*(1+e._pdata[0]/e._pdata[3])*n.w*(i.x[1]-i.x[0])},e._ya={},o.extendFlat(e._ya,l),r.setConvert(e._ya),e._ya._offset=n.t+(1-i.y[1])*n.h,e._ya.l2p=function(){return .5*(1-e._pdata[1]/e._pdata[3])*n.h*(i.y[1]-i.y[0])}}var o=e("../../lib"),r=e("../../plots/cartesian/axes");t.exports=function(e){for(var t=e.fullSceneLayout,o=t.annotations,r=0;r<o.length;r++)a(o[r],e);e.fullLayout._infolayer.selectAll(".annotation-"+e.id).remove()}},{"../../lib":692,"../../plots/cartesian/axes":740}],563:[function(e,t){"use strict";function a(e,t,a,i){function s(a,r){return o.coerce(e,t,l,a,r)}function d(e){var o=e+"axis",i={_fullLayout:{}};return i._fullLayout[o]=a[o],r.coercePosition(t,i,s,e,e,.5)}var c=s("visible");c&&(n(e,t,i.fullLayout,s),d("x"),d("y"),d("z"),o.noneOrAll(e,t,["x","y","z"]),t.xref="x",t.yref="y",t.zref="z",s("xanchor"),s("yanchor"),s("xshift"),s("yshift"),t.showarrow&&(t.axref="pixel",t.ayref="pixel",s("ax",-10),s("ay",-30),o.noneOrAll(e,t,["ax","ay"])))}var o=e("../../lib"),r=e("../../plots/cartesian/axes"),i=e("../../plots/array_container_defaults"),n=e("../annotations/common_defaults"),l=e("./attributes");t.exports=function(e,t,o){i(e,t,{name:"annotations",handleItemDefaults:a,fullLayout:o.fullLayout})}},{"../../lib":692,"../../plots/array_container_defaults":736,"../../plots/cartesian/axes":740,"../annotations/common_defaults":555,"./attributes":561}],564:[function(e,t){"use strict";var a=e("../annotations/draw").drawRaw,o=e("../../plots/gl3d/project"),r=["x","y","z"];t.exports=function(e){for(var t=e.fullSceneLayout,n=e.dataScale,l=t.annotations,s=0;s<l.length;s++){for(var d=l[s],c=!1,p=0;3>p;p++){var u=r[p],g=d[u],h=t[u+"axis"],m=h.r2fraction(g);if(0>m||1<m){c=!0;break}}c?e.fullLayout._infolayer.select(".annotation-"+e.id+"[data-index=\""+s+"\"]").remove():(d._pdata=o(e.glplot.cameraParams,[t.xaxis.r2l(d.x)*n[0],t.yaxis.r2l(d.y)*n[1],t.zaxis.r2l(d.z)*n[2]]),a(e.graphDiv,d,s,e.id,d._xa,d._ya))}}},{"../../plots/gl3d/project":792,"../annotations/draw":558}],565:[function(e,t){"use strict";var a=e("../../registry"),o=e("../../lib");t.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:e("./attributes")}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),includeBasePlot:function(e,t){var r=a.subplotsRegistry.gl3d;if(r)for(var n=r.attrRegex,l=Object.keys(e),s=0,d;s<l.length;s++)d=l[s],n.test(d)&&(e[d].annotations||[]).length&&(o.pushUnique(t._basePlotModules,r),o.pushUnique(t._subplots.gl3d,d))},convert:e("./convert"),draw:e("./draw")}},{"../../lib":692,"../../registry":823,"./attributes":561,"./convert":562,"./defaults":563,"./draw":564}],566:[function(e,t){"use strict";t.exports=e("world-calendars/dist/main"),e("world-calendars/dist/plus"),e("world-calendars/dist/calendars/chinese"),e("world-calendars/dist/calendars/coptic"),e("world-calendars/dist/calendars/discworld"),e("world-calendars/dist/calendars/ethiopian"),e("world-calendars/dist/calendars/hebrew"),e("world-calendars/dist/calendars/islamic"),e("world-calendars/dist/calendars/julian"),e("world-calendars/dist/calendars/mayan"),e("world-calendars/dist/calendars/nanakshahi"),e("world-calendars/dist/calendars/nepali"),e("world-calendars/dist/calendars/persian"),e("world-calendars/dist/calendars/taiwan"),e("world-calendars/dist/calendars/thai"),e("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":533,"world-calendars/dist/calendars/coptic":534,"world-calendars/dist/calendars/discworld":535,"world-calendars/dist/calendars/ethiopian":536,"world-calendars/dist/calendars/hebrew":537,"world-calendars/dist/calendars/islamic":538,"world-calendars/dist/calendars/julian":539,"world-calendars/dist/calendars/mayan":540,"world-calendars/dist/calendars/nanakshahi":541,"world-calendars/dist/calendars/nepali":542,"world-calendars/dist/calendars/persian":543,"world-calendars/dist/calendars/taiwan":544,"world-calendars/dist/calendars/thai":545,"world-calendars/dist/calendars/ummalqura":546,"world-calendars/dist/main":547,"world-calendars/dist/plus":548}],567:[function(e,t){"use strict";function a(e){var t=h[e];return t?t:(t=h[e]=i.instance(e),t)}function o(e){return n.extendFlat({},c,{description:e})}function r(e){return"Sets the calendar system to use with `"+e+"` date data."}var i=e("./calendars"),n=e("../../lib"),l=e("../../constants/numerical"),s=l.EPOCHJD,d=l.ONEDAY,c={valType:"enumerated",values:Object.keys(i.calendars),editType:"calc",dflt:"gregorian"},p=function(e,t,a,o){var r={};return r[a]=c,n.coerce(e,t,r,a,o)},u="##",g={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:u,w:u,c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},h={},m={xcalendar:o(r("x"))},y=n.extendFlat({},m,{ycalendar:o(r("y"))}),f=n.extendFlat({},y,{zcalendar:o(r("z"))}),x=o("Sets the calendar system to use for `range` and `tick0` if this is a date axis. This does not set the calendar for interpreting data on this axis, that's specified in the trace or via the global `layout.calendar`");t.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:y,bar:y,box:y,heatmap:y,contour:y,histogram:y,histogram2d:y,histogram2dcontour:y,scatter3d:f,surface:f,mesh3d:f,scattergl:y,ohlc:m,candlestick:m},layout:{calendar:o("Sets the default calendar system to use for interpreting and displaying dates throughout the plot.")},subplots:{xaxis:{calendar:x},yaxis:{calendar:x},scene:{xaxis:{calendar:x},yaxis:{calendar:x},zaxis:{calendar:x}},polar:{radialaxis:{calendar:x}}},transforms:{filter:{valuecalendar:o("Sets the calendar system to use for `value`, if it is a date."),targetcalendar:o("Sets the calendar system to use for `target`, if it is an array of dates. If `target` is a string (eg *x*) we use the corresponding trace attribute (eg `xcalendar`) if it exists, even if `targetcalendar` is provided.")}}},layoutAttributes:c,handleDefaults:p,handleTraceDefaults:function(e,t,a,o){for(var r=0;r<a.length;r++)p(e,t,a[r]+"calendar",o.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:a,worldCalFmt:function(e,t,o){for(var r=ea((t+.05)/d)+s,n=a(o).fromJD(r),l=0,c,p,u,h,m;-1!==(l=e.indexOf("%",l));)c=e.charAt(l+1),"0"===c||"-"===c||"_"===c?(u=3,p=e.charAt(l+2),"_"===c&&(c="-")):(p=c,c="0",u=2),h=g[p],h?(m="##"===h?"##":n.formatDate(h[c]),e=e.substr(0,l)+m+e.substr(l+u),l+=m.length):l+=u;return e}}},{"../../constants/numerical":669,"../../lib":692,"./calendars":566}],568:[function(e,t,a){"use strict";a.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],a.defaultLine="#444",a.lightLine="#eee",a.background="#fff",a.borderLine="#BEC8D9",a.lightFraction=1000/11},{}],569:[function(e,t){"use strict";function a(e){if(r(e)||"string"!=typeof e)return e;var t=e.trim();if("rgb"!==t.substr(0,3))return e;var a=t.match(/^rgba?\s*\(([^()]*)\)$/);if(!a)return e;var o=a[1].trim().split(/\s*[\s,]\s*/),n="a"===t.charAt(3)&&4===o.length;if(!n&&3!==o.length)return e;for(var l=0;l<o.length;l++){if(!o[l].length)return e;if(o[l]=+o[l],!(0<=o[l]))return e;if(3==l)1<o[l]&&(o[l]=1);else if(1<=o[l])return e}var s=R(255*o[0])+", "+R(255*o[1])+", "+R(255*o[2]);return n?"rgba("+s+", "+o[3]+")":"rgb("+s+")"}var o=e("tinycolor2"),r=e("fast-isnumeric"),n=t.exports={},l=e("./attributes");n.defaults=l.defaults;var s=n.defaultLine=l.defaultLine;n.lightLine=l.lightLine;var d=n.background=l.background;n.tinyRGB=function(e){var t=e.toRgb();return"rgb("+R(t.r)+", "+R(t.g)+", "+R(t.b)+")"},n.rgb=function(e){return n.tinyRGB(o(e))},n.opacity=function(e){return e?o(e).getAlpha():0},n.addOpacity=function(e,t){var a=o(e).toRgb();return"rgba("+R(a.r)+", "+R(a.g)+", "+R(a.b)+", "+t+")"},n.combine=function(e,t){var a=o(e).toRgb();if(1===a.a)return o(e).toRgbString();var r=o(t||d).toRgb(),i=1===r.a?r:{r:255*(1-r.a)+r.r*r.a,g:255*(1-r.a)+r.g*r.a,b:255*(1-r.a)+r.b*r.a},n={r:i.r*(1-a.a)+a.r*a.a,g:i.g*(1-a.a)+a.g*a.a,b:i.b*(1-a.a)+a.b*a.a};return o(n).toRgbString()},n.contrast=function(e,t,a){var r=o(e);1!==r.getAlpha()&&(r=o(n.combine(e,d)));var i=r.isDark()?t?r.lighten(t):d:a?r.darken(a):s;return i.toString()},n.stroke=function(e,t){var a=o(t);e.style({stroke:n.tinyRGB(a),"stroke-opacity":a.getAlpha()})},n.fill=function(e,t){var a=o(t);e.style({fill:n.tinyRGB(a),"fill-opacity":a.getAlpha()})},n.clean=function(e){if(e&&"object"==typeof e){var t=Object.keys(e),o,r,l,s;for(o=0;o<t.length;o++)if(l=t[o],s=e[l],"color"===l.substr(l.length-5)){if(Array.isArray(s))for(r=0;r<s.length;r++)s[r]=a(s[r]);else e[l]=a(s);}else if("colorscale"===l.substr(l.length-10)&&Array.isArray(s))for(r=0;r<s.length;r++)Array.isArray(s[r])&&(s[r][1]=a(s[r][1]));else if(Array.isArray(s)){var d=s[0];if(!Array.isArray(d)&&d&&"object"==typeof d)for(r=0;r<s.length;r++)n.clean(s[r])}else s&&"object"==typeof s&&n.clean(s)}}},{"./attributes":568,"fast-isnumeric":214,tinycolor2:513}],570:[function(e,t){"use strict";var a=e("../../plots/cartesian/layout_attributes"),o=e("../../plots/font_attributes"),r=e("../../lib/extend").extendFlat,i=e("../../plot_api/edit_types").overrideAll;t.exports=i({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:a.linecolor,outlinewidth:a.linewidth,bordercolor:a.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:a.tickmode,nticks:a.nticks,tick0:a.tick0,dtick:a.dtick,tickvals:a.tickvals,ticktext:a.ticktext,ticks:r({},a.ticks,{dflt:""}),ticklen:a.ticklen,tickwidth:a.tickwidth,tickcolor:a.tickcolor,showticklabels:a.showticklabels,tickfont:o({}),tickangle:a.tickangle,tickformat:a.tickformat,tickformatstops:a.tickformatstops,tickprefix:a.tickprefix,showtickprefix:a.showtickprefix,ticksuffix:a.ticksuffix,showticksuffix:a.showticksuffix,separatethousands:a.separatethousands,exponentformat:a.exponentformat,showexponent:a.showexponent,title:{text:{valType:"string"},font:o({}),side:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},_deprecated:{title:{valType:"string"},titlefont:o({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":682,"../../plot_api/edit_types":723,"../../plots/cartesian/layout_attributes":753,"../../plots/font_attributes":767}],571:[function(e,t){"use strict";var a=e("./draw"),o=e("../colorscale/helpers").flipScale;t.exports=function(e,t,r){if("function"==typeof r)return r(e,t);var i=t[0].trace,n="cb"+i.uid,l=r.container,s=l?i[l]:i;if(e._fullLayout._infolayer.selectAll("."+n).remove(),s&&s.showscale){var d=t[0].t.cb=a(e,n),c=s.reversescale?o(s.colorscale):s.colorscale;d.fillgradient(c).zrange([s[r.min],s[r.max]]).options(s.colorbar)()}}},{"../colorscale/helpers":580,"./draw":574}],572:[function(e,t){"use strict";t.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],573:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../plot_api/plot_template"),r=e("../../plots/cartesian/tick_value_defaults"),i=e("../../plots/cartesian/tick_mark_defaults"),n=e("../../plots/cartesian/tick_label_defaults"),l=e("./attributes");t.exports=function(e,t,s){function d(e,t){return a.coerce(p,c,l,e,t)}var c=o.newContainer(t,"colorbar"),p=e.colorbar||{},u=d("thicknessmode");d("thickness","fraction"===u?30/(s.width-s.margin.l-s.margin.r):30);var g=d("lenmode");d("len","fraction"===g?1:s.height-s.margin.t-s.margin.b),d("x"),d("xanchor"),d("xpad"),d("y"),d("yanchor"),d("ypad"),a.noneOrAll(p,c,["x","y"]),d("outlinecolor"),d("outlinewidth"),d("bordercolor"),d("borderwidth"),d("bgcolor"),r(p,c,d,"linear");var h={outerTicks:!1,font:s.font};n(p,c,d,"linear",h),i(p,c,d,"linear",h),d("title.text",s._dfltTitle.colorbar),a.coerceFont(d,"title.font",s.font),d("title.side")}},{"../../lib":692,"../../plot_api/plot_template":730,"../../plots/cartesian/tick_label_defaults":760,"../../plots/cartesian/tick_mark_defaults":761,"../../plots/cartesian/tick_value_defaults":762,"./attributes":570}],574:[function(e,t){"use strict";var a=e("d3"),o=e("tinycolor2"),r=e("../../plots/plots"),i=e("../../registry"),n=e("../../plots/cartesian/axes"),l=e("../dragelement"),s=e("../../lib"),d=e("../../lib/extend").extendFlat,c=e("../../lib/setcursor"),p=e("../drawing"),u=e("../color"),g=e("../titles"),h=e("../../lib/svg_text_utils"),m=e("../../constants/alignment"),y=m.LINE_SPACING,f=m.FROM_TL,x=m.FROM_BR,b=e("../../plots/cartesian/axis_defaults"),_=e("../../plots/cartesian/position_defaults"),v=e("../../plots/cartesian/layout_attributes"),w=e("./attributes"),k=e("./constants").cn;t.exports=function(e,t){function m(){function w(e,t){return s.coerce(ne,le,v,e,t)}function C(){if(-1!==["top","bottom"].indexOf(S.title.side)){var r=he.select(".cbtitle"),i=r.select("text"),l=[-S.outlinewidth/2,S.outlinewidth/2],d=r.select(".h"+le._id+"title-math-group").node(),c=15.6;if(i.node()&&(c=parseInt(i.node().style.fontSize,10)*y),d?(fe=p.bBox(d).height,fe>c&&(l[1]-=(fe-c)/2)):i.node()&&!i.classed(k.jsPlaceholder)&&(fe=p.bBox(i.node()).height),fe){if(fe+=5,"top"===S.title.side)le.domain[1]-=fe/D.h,l[1]*=-1;else{le.domain[0]+=fe/D.h;var u=h.lineCount(i);l[1]+=(1-u)*c}r.attr("transform","translate("+l+")"),le.setScale()}}he.selectAll(".cbfills,.cblines").attr("transform","translate(0,"+R(D.h*(1-le.domain[1]))+")"),ye.attr("transform","translate(0,"+R(-D.t)+")");var g=he.select(".cbfills").selectAll("rect.cbfill").data(j);g.enter().append("rect").classed(k.cbfill,!0).style("stroke","none"),g.exit().remove();var m=O.map(le.c2p).map(Math.round).sort(function(e,t){return e-t});g.each(function(r,n){var i=[0===n?O[0]:(j[n]+j[n-1])/2,n===j.length-1?O[1]:(j[n]+j[n+1])/2].map(le.c2p).map(Math.round);i[1]=s.constrain(i[1]+(i[1]>i[0])?1:-1,m[0],m[1]);var l=a.select(this).attr({x:te,width:va(X,2),y:a.min(i),height:va(a.max(i)-a.min(i),2)});if(S.fillgradient)p.gradient(l,e,t,"vertical",S.fillgradient,"fill");else{var d=F(r).replace("e-","");l.attr("fill",o(d).toHexString())}});var f=he.select(".cblines").selectAll("path.cbline").data(S.line.color&&S.line.width?M:[]);return f.enter().append("path").classed(k.cbline,!0),f.exit().remove(),f.each(function(e){a.select(this).attr("d","M"+te+","+(R(le.c2p(e))+S.line.width/2%1)+"h"+X).call(p.lineGroupStyle,S.line.width,B(e),S.line.dash)}),ye.selectAll("g."+le._id+"tick,path").remove(),s.syncOrAsync([function(){var t=te+X+(S.outlinewidth||0)/2-("outside"===S.ticks?1:0),a=n.calcTicks(le),o=n.makeTransFn(le),r=n.makeLabelFns(le,t),i=n.getTickSigns(le)[2];return n.drawTicks(e,le,{vals:"inside"===le.ticks?n.clipEnds(le,a):a,layer:ye,path:n.makeTickPath(le,t,i),transFn:o}),n.drawLabels(e,le,{vals:a,layer:ye,transFn:o,labelXFn:r.labelXFn,labelYFn:r.labelYFn,labelAnchorFn:r.labelAnchorFn})},function(){if(-1===["top","bottom"].indexOf(S.title.side)){var t=le.title.font.size,o=le._offset+le._length/2,r=D.l+(le.position||0)*D.w+("right"===le.side?10+t*(le.showticklabels?1:.5):-10-t*(le.showticklabels?.5:0));L("h"+le._id+"title",{avoid:{selection:a.select(e).selectAll("g."+le._id+"tick"),side:S.title.side,offsetLeft:D.l,offsetTop:0,maxShift:I.width},attributes:{x:r,y:o,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}}])}function L(t,a){var o={propContainer:le,propName:A("title"),traceIndex:T().index,placeholder:I._dfltTitle.colorbar,containerGroup:he.select(".cbtitle")},r="h"===t.charAt(0)?t.substr(1):"h"+t;he.selectAll("."+r+",."+r+"-math-group").remove(),g.draw(e,t,d(o,a||{}))}function E(){var a=X+S.outlinewidth/2+p.bBox(ye.node()).width;if(de=me.select("text"),de.node()&&!de.classed(k.jsPlaceholder)){var o=me.select(".h"+le._id+"title-math-group").node(),i;i=o&&-1!==["top","bottom"].indexOf(S.title.side)?p.bBox(o).width:p.bBox(me.node()).right-te-D.l,a=va(a,i)}var n=2*S.xpad+a+S.borderwidth+S.outlinewidth/2,l=re-ie;he.select(".cbbg").attr({x:te-S.xpad-(S.borderwidth+S.outlinewidth)/2,y:ie-Q,width:va(n,2),height:va(l+2*Q,2)}).call(u.fill,S.bgcolor).call(u.stroke,S.bordercolor).style({"stroke-width":S.borderwidth}),he.selectAll(".cboutline").attr({x:te,y:ie+S.ypad+("top"===S.title.side?fe:0),width:va(X,2),height:va(l-2*S.ypad-fe,2)}).call(u.stroke,S.outlinecolor).style({fill:"None","stroke-width":S.outlinewidth});var s=({center:.5,right:1}[S.xanchor]||0)*n;he.attr("transform","translate("+(D.l-s)+","+D.t+")");var d={},c=f[S.yanchor],g=x[S.yanchor];"pixels"===S.lenmode?(d.y=S.y,d.t=l*c,d.b=l*g):(d.t=d.b=0,d.yt=S.y+S.len*c,d.yb=S.y-S.len*g);var h=f[S.xanchor],m=x[S.xanchor];if("pixels"===S.thicknessmode)d.x=S.x,d.l=n*h,d.r=n*m;else{var y=n-X;d.l=y*h,d.r=y*m,d.xl=S.x-S.thickness*h,d.xr=S.x+S.thickness*m}r.autoMargin(e,t,d)}var I=e._fullLayout,D=I._size;if("function"!=typeof S.fillcolor&&"function"!=typeof S.line.color&&!S.fillgradient)return void I._infolayer.selectAll("g."+t).remove();var O=S.zrange||a.extent(("function"==typeof S.fillcolor?S.fillcolor:S.line.color).domain()),M=[],j=[],B="function"==typeof S.line.color?S.line.color:function(){return S.line.color},F="function"==typeof S.fillcolor?S.fillcolor:function(){return S.fillcolor},N=S.levels.end+S.levels.size/100,V=S.levels.size,U=1.001*O[0]-.001*O[1],H=1.001*O[1]-.001*O[0],G,Y;for(Y=0;1e5>Y&&(G=S.levels.start+Y*V,0<V?!(G>=N):!(G<=N));Y++)G>U&&G<H&&M.push(G);if(S.fillgradient)j=[0];else if("function"!=typeof S.fillcolor)S.fillcolor&&"string"==typeof S.fillcolor&&(j=[0]);else if(S.filllevels)for(N=S.filllevels.end+S.filllevels.size/100,V=S.filllevels.size,Y=0;1e5>Y&&(G=S.filllevels.start+Y*V,0<V?!(G>=N):!(G<=N));Y++)G>O[0]&&G<O[1]&&j.push(G);else j=M.map(function(e){return e-S.levels.size/2}),j.push(j[j.length-1]+S.levels.size);0>S.levels.size&&(M.reverse(),j.reverse());var q=D.h,W=D.w,X=R(S.thickness*("fraction"===S.thicknessmode?W:1)),Z=X/D.w,$=R(S.len*("fraction"===S.lenmode?q:1)),J=$/D.h,K=S.xpad/D.w,Q=(S.borderwidth+S.outlinewidth)/2,ee=S.ypad/D.h,te=R(S.x*D.w+S.xpad),ae=S.x-Z*({middle:.5,right:1}[S.xanchor]||0),oe=S.y+J*(({top:-.5,bottom:.5}[S.yanchor]||0)-.5),re=R(D.h*(1-oe)),ie=re-$,ne={type:"linear",range:O,tickmode:S.tickmode,nticks:S.nticks,tick0:S.tick0,dtick:S.dtick,tickvals:S.tickvals,ticktext:S.ticktext,ticks:S.ticks,ticklen:S.ticklen,tickwidth:S.tickwidth,tickcolor:S.tickcolor,showticklabels:S.showticklabels,tickfont:S.tickfont,tickangle:S.tickangle,tickformat:S.tickformat,exponentformat:S.exponentformat,separatethousands:S.separatethousands,showexponent:S.showexponent,showtickprefix:S.showtickprefix,tickprefix:S.tickprefix,showticksuffix:S.showticksuffix,ticksuffix:S.ticksuffix,title:S.title,showline:!0,anchor:"free",side:"right",position:1},le={type:"linear",_id:"y"+t},se={letter:"y",font:I.font,noHover:!0,noTickson:!0,calendar:I.calendar},de;if(b(ne,le,w,se,I),_(ne,le,w,se),le.position=S.x+K+Z,m.axis=le,-1!==["top","bottom"].indexOf(S.title.side)&&(le.title.side=S.title.side,le.titlex=S.x+K,le.titley=oe+("top"===S.title.side?J-ee:ee)),S.line.color&&"auto"===S.tickmode){le.tickmode="linear",le.tick0=S.levels.start;var ce=S.levels.size,pe=s.constrain((re-ie)/50,4,15)+1,ue=(O[1]-O[0])/((S.nticks||pe)*ce);if(1<ue){var ge=_a(10,ea(P(ue)/z));ce*=ge*s.roundUp(ue/ge,[2,5,10]),2e-6>(wa(S.levels.start)/S.levels.size+1e-6)%1&&(le.tick0=0)}le.dtick=ce}le.domain=[oe+ee,oe+J-ee],le.setScale();var he=s.ensureSingle(I._infolayer,"g",t,function(e){e.classed(k.colorbar,!0).each(function(){var e=a.select(this);e.append("rect").classed(k.cbbg,!0),e.append("g").classed(k.cbfills,!0),e.append("g").classed(k.cblines,!0),e.append("g").classed(k.cbaxis,!0).classed(k.crisp,!0),e.append("g").classed(k.cbtitleunshift,!0).append("g").classed(k.cbtitle,!0),e.append("rect").classed(k.cboutline,!0),e.select(".cbtitle").datum(0)})});he.attr("transform","translate("+R(D.l)+","+R(D.t)+")");var me=he.select(".cbtitleunshift").attr("transform","translate(-"+R(D.l)+",-"+R(D.t)+")"),ye=he.select(".cbaxis"),fe=0;if(-1!==["top","bottom"].indexOf(S.title.side)){var xe=D.l+(S.x+K)*D.w,be=le.title.font.size,_e;_e="top"===S.title.side?(1-(oe+J-ee))*D.h+D.t+3+.75*be:(1-(oe+ee))*D.h+D.t-3-.25*be,L(le._id+"title",{attributes:{x:xe,y:_e,"text-anchor":"start"}})}var ve=s.syncOrAsync([r.previousPromises,C,r.previousPromises,E],e);if(ve&&ve.then&&(e._promises||[]).push(ve),e._context.edits.colorbarPosition){var we,ke,Te;l.init({element:he.node(),gd:e,prepFn:function(){we=he.attr("transform"),c(he)},moveFn:function(e,t){he.attr("transform",we+" translate("+e+","+t+")"),ke=l.align(ae+e/D.w,Z,0,1,S.xanchor),Te=l.align(oe-t/D.h,J,0,1,S.yanchor);var a=l.getCursor(ke,Te,S.xanchor,S.yanchor);c(he,a)},doneFn:function(){if(c(he),void 0!==ke&&void 0!==Te){var t={};t[A("x")]=ke,t[A("y")]=Te,i.call("_guiRestyle",e,t,T().index)}}})}return ve}function T(){var a=t.substr(2),o,r;for(o=0;o<e._fullData.length;o++)if(r=e._fullData[o],r.uid===a)return r}function A(e){var t=T(),a="colorbar.",o=t._module.colorbar.container;return o&&(a=o+"."+a),a+e}var S={};for(var C in w)S[C]=null;return S.fillcolor=null,S.line={color:null,width:null,dash:null},S.levels={start:null,end:null,size:null},S.filllevels=null,S.fillgradient=null,S.zrange=null,Object.keys(S).forEach(function(e){m[e]=function(t){return arguments.length?(S[e]=s.isPlainObject(S[e])?s.extendFlat(S[e],t):t,m):S[e]}}),m.options=function(e){for(var t in e)"function"==typeof m[t]&&m[t](e[t]);return m},m._opts=S,m}},{"../../constants/alignment":664,"../../lib":692,"../../lib/extend":682,"../../lib/setcursor":712,"../../lib/svg_text_utils":716,"../../plots/cartesian/axes":740,"../../plots/cartesian/axis_defaults":742,"../../plots/cartesian/layout_attributes":753,"../../plots/cartesian/position_defaults":756,"../../plots/plots":804,"../../registry":823,"../color":569,"../dragelement":587,"../drawing":590,"../titles":657,"./attributes":570,"./constants":572,d3:148,tinycolor2:513}],575:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e){return a.isPlainObject(e.colorbar)}},{"../../lib":692}],576:[function(e,t){"use strict";function a(e){return"`"+e+"`"}var o=e("./scales.js").scales,r=Object.keys(o);t.exports=function(e,t){e=e||"",t=t||{};var r=t.cLetter||"c",i="onlyIfNumerical"in t?t.onlyIfNumerical:!!e,n="noScale"in t?t.noScale:"marker.line"===e,l="showScaleDflt"in t?t.showScaleDflt:"z"===r,s="string"==typeof t.colorscaleDflt?o[t.colorscaleDflt]:null,d=t.editTypeOverride||"",c=e?e+".":"",p,u;"colorAttr"in t?(p=t.colorAttr,u=t.colorAttr):(p={z:"z",c:"color"}[r],u="in "+a(c+p));var g=i?" Has an effect only if "+u+"is set to a numerical array.":"",h=r+"auto",m=r+"min",y=r+"max",f=a(c+m),x=a(c+y),b={};b[m]=b[y]=void 0;var _={};_[h]=!1;var v={};return"color"===p&&(v.color={valType:"color",arrayOk:!0,editType:d||"style"}),v[h]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:b},v[m]={valType:"number",dflt:null,editType:d||"plot",impliedEdits:_},v[y]={valType:"number",dflt:null,editType:d||"plot",impliedEdits:_},v.colorscale={valType:"colorscale",editType:"calc",dflt:s,impliedEdits:{autocolorscale:!1}},v.autocolorscale={valType:"boolean",dflt:!1!==t.autoColorDflt,editType:"calc",impliedEdits:{colorscale:void 0}},v.reversescale={valType:"boolean",dflt:!1,editType:"plot"},n||(v.showscale={valType:"boolean",dflt:l,editType:"calc"}),v}},{"./scales.js":584}],577:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t,o){var r=e._fullLayout,i=o.vals,n=o.containerStr,l=o.cLetter,s=n?a.nestedProperty(t,n).get():t,d=l+"min",c=l+"max",p=s[l+"auto"],u=s[d],g=s[c],h=s.colorscale;(!1!==p||u===void 0)&&(u=a.aggNums(Math.min,null,i)),(!1!==p||g===void 0)&&(g=a.aggNums(Math.max,null,i)),u===g&&(u-=.5,g+=.5),s["_"+d]=s[d]=u,s["_"+c]=s[c]=g,s.autocolorscale&&(h=0>u*g?r.colorscale.diverging:0<=u?r.colorscale.sequential:r.colorscale.sequentialminus,s._colorscale=s.colorscale=h)}},{"../../lib":692}],578:[function(e,t){"use strict";var a=e("../../lib"),o=e("./helpers").hasColorscale;t.exports=function(e){function t(e,t){var a=e["_"+t];a!==void 0&&(e[t]=a)}function r(e,o){var r=o.container?a.nestedProperty(e,o.container).get():e;if(r){var i=r.zauto||r.cauto,n=o.min,l=o.max;(i||r[n]===void 0)&&t(r,n),(i||r[l]===void 0)&&t(r,l),r.autocolorscale&&t(r,"colorscale")}}for(var n=0;n<e.length;n++){var l=e[n],s=l._module;s.colorbar&&r(l,s.colorbar),o(l,"marker.line")&&r(l,{container:"marker.line",min:"cmin",max:"cmax"}),o(l,"line")&&r(l,{container:"line",min:"cmin",max:"cmax"})}}},{"../../lib":692,"./helpers":580}],579:[function(e,t){"use strict";function a(e,t){var a=t.slice(0,t.length-1);return t?r.nestedProperty(e,a).get()||{}:e}var o=e("fast-isnumeric"),r=e("../../lib"),i=e("../colorbar/has_colorbar"),n=e("../colorbar/defaults"),l=e("./scales").isValid;t.exports=function(e,t,r,s,d){var c=d.prefix,p=d.cLetter,u=a(e,c),g=a(t,c),h=a(t._template||{},c)||{},m=u[p+"min"],y=u[p+"max"],f=o(m)&&o(y)&&m<y;s(c+p+"auto",!f),s(c+p+"min"),s(c+p+"max");var x=u.colorscale,b=h.colorscale,_;if(void 0!==x&&(_=!l(x)),void 0!==b&&(_=!l(b)),s(c+"autocolorscale",_),s(c+"colorscale"),s(c+"reversescale"),!d.noScale&&"marker.line."!==c){var v;c&&(v=i(u));var w=s(c+"showscale",v);w&&n(u,g,r)}}},{"../../lib":692,"../colorbar/defaults":573,"../colorbar/has_colorbar":575,"./scales":584,"fast-isnumeric":214}],580:[function(e,t){"use strict";function a(e){for(var t=e.length,a=Array(t),o=t-1,r=0,n;0<=o;o--,r++)n=e[o],a[r]=[1-n[0],n[1]];return a}function o(e){var t={r:e[0],g:e[1],b:e[2],a:e[3]};return n(t).toRgbString()}var r=e("d3"),n=e("tinycolor2"),l=e("fast-isnumeric"),s=e("../../lib"),d=e("../color"),c=e("./scales").isValid;t.exports={hasColorscale:function(e,t){var a=t?s.nestedProperty(e,t).get()||{}:e,o=a.color,r=!1;if(s.isArrayOrTypedArray(o))for(var n=0;n<o.length;n++)if(l(o[n])){r=!0;break}return s.isPlainObject(a)&&(r||!0===a.showscale||l(a.cmin)&&l(a.cmax)||c(a.colorscale)||s.isPlainObject(a.colorbar))},extractScale:function(e,t){for(var o=t.cLetter,r=e.reversescale?a(e.colorscale):e.colorscale,n=e[o+"min"],l=e[o+"max"],s=r.length,d=Array(s),c=Array(s),p=0,u;p<s;p++)u=r[p],d[p]=n+u[0]*(l-n),c[p]=u[1];return{domain:d,range:c}},flipScale:a,makeColorScaleFunc:function(e,t){t=t||{};for(var a=e.domain,s=e.range,c=s.length,p=Array(c),u=0,g;u<c;u++)g=n(s[u]).toRgb(),p[u]=[g.r,g.g,g.b,g.a];var h=r.scale.linear().domain(a).range(p).clamp(!0),m=t.noNumericCheck,y=t.returnArray,f;return f=m&&y?h:m?function(e){return o(h(e))}:y?function(e){return l(e)?h(e):n(e).isValid()?e:d.defaultLine}:function(e){return l(e)?o(h(e)):n(e).isValid()?e:d.defaultLine},f.domain=h.domain,f.range=function(){return s},f}}},{"../../lib":692,"../color":569,"./scales":584,d3:148,"fast-isnumeric":214,tinycolor2:513}],581:[function(e,t){"use strict";var a=e("./scales"),o=e("./helpers");t.exports={moduleType:"component",name:"colorscale",attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyLayoutDefaults:e("./layout_defaults"),handleDefaults:e("./defaults"),crossTraceDefaults:e("./cross_trace_defaults"),calc:e("./calc"),scales:a.scales,defaultScale:a.defaultScale,getScale:a.get,isValidScale:a.isValid,hasColorscale:o.hasColorscale,flipScale:o.flipScale,extractScale:o.extractScale,makeColorScaleFunc:o.makeColorScaleFunc}},{"./attributes":576,"./calc":577,"./cross_trace_defaults":578,"./defaults":579,"./helpers":580,"./layout_attributes":582,"./layout_defaults":583,"./scales":584}],582:[function(e,t){"use strict";var a=e("./scales").scales;t.exports={editType:"calc",sequential:{valType:"colorscale",dflt:a.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:a.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:a.RdBu,editType:"calc"}}},{"./scales":584}],583:[function(e,t){"use strict";var a=e("../../lib"),o=e("./layout_attributes"),r=e("../../plot_api/plot_template");t.exports=function(e,t){function i(e,t){return a.coerce(n,l,o,e,t)}var n=e.colorscale,l=r.newContainer(t,"colorscale");i("sequential"),i("sequentialminus"),i("diverging")}},{"../../lib":692,"../../plot_api/plot_template":730,"./layout_attributes":582}],584:[function(e,t){"use strict";function a(e){var t=0;if(!Array.isArray(e)||2>e.length)return!1;if(!e[0]||!e[e.length-1])return!1;if(0!=+e[0][0]||1!=+e[e.length-1][0])return!1;for(var a=0,r;a<e.length;a++){if(r=e[a],2!==r.length||+r[0]<t||!o(r[1]).isValid())return!1;t=+r[0]}return!0}var o=e("tinycolor2"),r={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},i=r.RdBu;t.exports={scales:r,defaultScale:i,get:function(t,o){function n(){try{t=r[t]||JSON.parse(t)}catch(a){t=o}}return(o||(o=i),!t)?o:("string"==typeof t&&(n(),"string"==typeof t&&n()),a(t)?t:o)},isValid:function(e){return void 0!==r[e]||a(e)}}},{tinycolor2:513}],585:[function(e,t){"use strict";t.exports=function(e,t,a,o,r){var i=(e-a)/(o-a),n=i+t/(o-a),l=(i+n)/2;return"left"===r||"bottom"===r?i:"center"===r||"middle"===r?l:"right"===r||"top"===r?n:i<2/3-l?i:n>4/3-l?n:l}},{}],586:[function(e,t){"use strict";var a=e("../../lib"),o=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];t.exports=function(e,t,r,i){return e="left"===r?0:"center"===r?1:"right"===r?2:a.constrain(ea(3*e),0,2),t="bottom"===i?0:"middle"===i?1:"top"===i?2:a.constrain(ea(3*t),0,2),o[t][e]}},{"../../lib":692}],587:[function(e,t){"use strict";function a(){var e=document.createElement("div");e.className="dragcover";var t=e.style;return t.position="fixed",t.left=0,t.right=0,t.top=0,t.bottom=0,t.zIndex=999999999,t.background="none",document.body.appendChild(e),e}function o(e){e._dragging=!1,e._replotPending&&s.call("plot",e)}function r(t){return i(t.changedTouches?t.changedTouches[0]:t,document.body)}var i=e("mouse-event-offset"),n=e("has-hover"),l=e("has-passive-events"),s=e("../../registry"),d=e("../../lib"),c=e("../../plots/cartesian/constants"),p=e("../../constants/interactions"),u=t.exports={};u.align=e("./align"),u.getCursor=e("./cursor");var g=e("./unhover");u.unhover=g.wrapped,u.unhoverRaw=g.raw,u.init=function(t){function i(o){h._dragged=!1,h._dragging=!0;var e=r(o);return x=e[0],b=e[1],T=o.target,k=o,A=2===o.buttons||o.ctrlKey,"undefined"==typeof o.clientX&&"undefined"==typeof o.clientY&&(o.clientX=x,o.clientY=b),_=new Date().getTime(),_-h._mouseDownTime<y?m+=1:(m=1,h._mouseDownTime=_),t.prepFn&&t.prepFn(o,x,b),n&&!A?(w=a(),w.style.cursor=window.getComputedStyle(f).cursor):!n&&(w=document,v=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(f).cursor),document.addEventListener("mouseup",g),document.addEventListener("touchend",g),void(!1!==t.dragmode&&(o.preventDefault(),document.addEventListener("mousemove",s),document.addEventListener("touchmove",s)))}function s(a){a.preventDefault();var e=r(a),o=t.minDrag||c.MINDRAG,i=S(e[0]-x,e[1]-b,o),n=i[0],l=i[1];return(n||l)&&(h._dragged=!0,u.unhover(h)),void(h._dragged&&t.moveFn&&!A&&t.moveFn(n,l))}function g(a){if(!1!==t.dragmode&&(a.preventDefault(),document.removeEventListener("mousemove",s),document.removeEventListener("touchmove",s)),document.removeEventListener("mouseup",g),document.removeEventListener("touchend",g),n?d.removeElement(w):v&&(w.documentElement.style.cursor=v,v=null),!h._dragging)return void(h._dragged=!1);if(h._dragging=!1,new Date().getTime()-h._mouseDownTime>y&&(m=va(m-1,1)),h._dragged)t.doneFn&&t.doneFn();else if(t.clickFn&&t.clickFn(m,k),!A){var e;try{e=new MouseEvent("click",a)}catch(t){var i=r(a);e=document.createEvent("MouseEvents"),e.initMouseEvent("click",a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,i[0],i[1],a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,a.relatedTarget)}T.dispatchEvent(e)}return o(h),void(h._dragged=!1)}var h=t.gd,m=1,y=p.DBLCLICKDELAY,f=t.element,x,b,_,v,w,k,T,A;h._mouseDownTime||(h._mouseDownTime=0),f.style.pointerEvents="all",f.onmousedown=i,l?(f._ontouchstart&&f.removeEventListener("touchstart",f._ontouchstart),f._ontouchstart=i,f.addEventListener("touchstart",i,{passive:!1})):f.ontouchstart=i;var S=t.clampFn||function(e,t,a){return wa(e)<a&&(e=0),wa(t)<a&&(t=0),[e,t]}},u.coverSlip=a},{"../../constants/interactions":668,"../../lib":692,"../../plots/cartesian/constants":746,"../../registry":823,"./align":585,"./cursor":586,"./unhover":588,"has-hover":393,"has-passive-events":394,"mouse-event-offset":419}],588:[function(e,t){"use strict";var a=e("../../lib/events"),o=e("../../lib/throttle"),r=e("../../lib/get_graph_div"),i=e("../fx/constants"),n=t.exports={};n.wrapped=function(e,t,a){e=r(e),e._fullLayout&&o.clear(e._fullLayout._uid+i.HOVERID),n.raw(e,t,a)},n.raw=function(e,t){var o=e._fullLayout,r=e._hoverdata;t||(t={});t.target&&!1===a.triggerHandler(e,"plotly_beforehover",t)||(o._hoverlayer.selectAll("g").remove(),o._hoverlayer.selectAll("line").remove(),o._hoverlayer.selectAll("circle").remove(),e._hoverdata=void 0,t.target&&r&&e.emit("plotly_unhover",{event:t,points:r}))}},{"../../lib/events":681,"../../lib/get_graph_div":688,"../../lib/throttle":717,"../fx/constants":602}],589:[function(e,t,a){"use strict";a.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"}},{}],590:[function(e,t){"use strict";function a(e,t){return T.symbolFuncs[e%100](t)+(200<=e?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}function o(e,t,a,o){var i=c.select(e.node().parentNode),n=-1===t.indexOf("top")?-1===t.indexOf("bottom")?"middle":"bottom":"top",l=-1===t.indexOf("left")?-1===t.indexOf("right")?"middle":"start":"end",s=o?o/.8+1:0,r=(m.lineCount(e)-1)*x+1,d=I[l]*s,p=.75*a+I[n]*s+(I[n]-1)*r*a/2;e.attr("text-anchor",l),i.attr("transform","translate("+d+","+p+")")}function r(e,t){var a=e.ts||t.textfont.size;return i(a)&&0<a?a:0}function n(e,t,a,o){var r=e[0]-t[0],i=e[1]-t[1],n=a[0]-t[0],l=a[1]-t[1],s=_a(r*r+i*i,D/2),d=_a(n*n+l*l,D/2),p=(d*d*r-s*s*n)*o,u=(d*d*i-s*s*l)*o,g=3*d*(s+d),h=3*s*(s+d);return[[c.round(t[0]+(g&&p/g),2),c.round(t[1]+(g&&u/g),2)],[c.round(t[0]-(h&&p/h),2),c.round(t[1]-(h&&u/h),2)]]}function l(e){var t=e.getAttribute("data-unformatted");return null===t?void 0:t+e.getAttribute("data-math")+e.getAttribute("text-anchor")+e.getAttribute("style")}var c=e("d3"),i=e("fast-isnumeric"),s=e("tinycolor2"),d=e("../../registry"),p=e("../color"),u=e("../colorscale"),g=e("../../lib"),m=e("../../lib/svg_text_utils"),y=e("../../constants/xmlns_namespaces"),f=e("../../constants/alignment"),x=f.LINE_SPACING,b=e("../../constants/interactions").DESELECTDIM,_=e("../../traces/scatter/subtypes"),v=e("../../traces/scatter/make_bubble_size_func"),T=t.exports={};T.font=function(e,t,a,o){g.isPlainObject(t)&&(o=t.color,a=t.size,t=t.family),t&&e.style("font-family",t),a+1&&e.style("font-size",a+"px"),o&&e.call(p.fill,o)},T.setPosition=function(e,t,a){e.attr("x",t).attr("y",a)},T.setSize=function(e,t,a){e.attr("width",t).attr("height",a)},T.setRect=function(e,t,a,o,r){e.call(T.setPosition,t,a).call(T.setSize,o,r)},T.translatePoint=function(e,t,a,o){var r=a.c2p(e.x),n=o.c2p(e.y);if(i(r)&&i(n)&&t.node())"text"===t.node().nodeName?t.attr("x",r).attr("y",n):t.attr("transform","translate("+r+","+n+")");else return!1;return!0},T.translatePoints=function(e,t,a){e.each(function(e){var o=c.select(this);T.translatePoint(e,o,t,a)})},T.hideOutsideRangePoint=function(e,t,a,o,r,i){t.attr("display",a.isPtWithinRange(e,r)&&o.isPtWithinRange(e,i)?null:"none")},T.hideOutsideRangePoints=function(e,t){if(t._hasClipOnAxisFalse){var a=t.xaxis,o=t.yaxis;e.each(function(t){var r=t[0].trace,i=r.xcalendar,n=r.ycalendar,l="bar"===r.type?".bartext":".point,.textpoint";e.selectAll(l).each(function(e){T.hideOutsideRangePoint(e,c.select(this),a,o,i,n)})})}},T.crispRound=function(e,t,a){return t&&i(t)?e._context.staticPlot?t:1>t?1:R(t):a||0},T.singleLineStyle=function(e,t,a,o,r){t.style("fill","none");var i=(((e||[])[0]||{}).trace||{}).line||{},n=a||i.width||0,l=r||i.dash||"";p.stroke(t,o||i.color),T.dashLine(t,l,n)},T.lineGroupStyle=function(e,t,a,o){e.style("fill","none").each(function(e){var r=(((e||[])[0]||{}).trace||{}).line||{},i=t||r.width||0,n=o||r.dash||"";c.select(this).call(p.stroke,a||r.color).call(T.dashLine,n,i)})},T.dashLine=function(e,t,a){a=+a||0,t=T.dashStyle(t,a),e.style({"stroke-dasharray":t,"stroke-width":a+"px"})},T.dashStyle=function(e,t){t=+t||1;var a=va(t,3);return"solid"===e?e="":"dot"===e?e=a+"px,"+a+"px":"dash"===e?e=3*a+"px,"+3*a+"px":"longdash"===e?e=5*a+"px,"+5*a+"px":"dashdot"===e?e=3*a+"px,"+a+"px,"+a+"px,"+a+"px":"longdashdot"==e&&(e=5*a+"px,"+2*a+"px,"+a+"px,"+2*a+"px"),e},T.singleFillStyle=function(e){var t=c.select(e.node()),a=t.data(),o=(((a[0]||[])[0]||{}).trace||{}).fillcolor;o&&e.call(p.fill,o)},T.fillGroupStyle=function(e){e.style("stroke-width",0).each(function(e){var t=c.select(this);e[0].trace&&t.call(p.fill,e[0].trace.fillcolor)})};var A=e("./symbol_defs");T.symbolNames=[],T.symbolFuncs=[],T.symbolNeedLines={},T.symbolNoDot={},T.symbolNoFill={},T.symbolList=[],Object.keys(A).forEach(function(e){var t=A[e];T.symbolList=T.symbolList.concat([t.n,e,t.n+100,e+"-open"]),T.symbolNames[t.n]=e,T.symbolFuncs[t.n]=t.f,t.needLine&&(T.symbolNeedLines[t.n]=!0),t.noDot?T.symbolNoDot[t.n]=!0:T.symbolList=T.symbolList.concat([t.n+200,e+"-dot",t.n+300,e+"-open-dot"]),t.noFill&&(T.symbolNoFill[t.n]=!0)});var S=T.symbolNames.length;T.symbolNumber=function(e){if("string"==typeof e){var t=0;0<e.indexOf("-open")&&(t=100,e=e.replace("-open","")),0<e.indexOf("-dot")&&(t+=200,e=e.replace("-dot","")),e=T.symbolNames.indexOf(e),0<=e&&(e+=t)}return e%100>=S||400<=e?0:ea(va(e,0))};var C={x1:1,x2:0,y1:0,y2:0},L={x1:0,x2:0,y1:1,y2:0},E=c.format("~.1f"),z={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:C},horizontalreversed:{node:"linearGradient",attrs:C,reversed:!0},vertical:{node:"linearGradient",attrs:L},verticalreversed:{node:"linearGradient",attrs:L,reversed:!0}};T.gradient=function(e,t,a,o,r,n){for(var l=r.length,d=z[o],u=Array(l),h=0;h<l;h++)d.reversed?u[l-1-h]=[E(100*(1-r[h][0])),r[h][1]]:u[h]=[E(100*r[h][0]),r[h][1]];var m="g"+t._fullLayout._uid+"-"+a,y=t._fullLayout._defs.select(".gradients").selectAll("#"+m).data([o+u.join(";")],g.identity);y.exit().remove(),y.enter().append(d.node).each(function(){var e=c.select(this);d.attrs&&e.attr(d.attrs),e.attr("id",m);var t=e.selectAll("stop").data(u);t.exit().remove(),t.enter().append("stop"),t.each(function(e){var t=s(e[1]);c.select(this).attr({offset:e[0]+"%","stop-color":p.tinyRGB(t),"stop-opacity":t.getAlpha()})})}),e.style(n,"url(#"+m+")").style(n+"-opacity",null)},T.initGradients=function(e){var t=g.ensureSingle(e._fullLayout._defs,"g","gradients");t.selectAll("linearGradient,radialGradient").remove()},T.pointStyle=function(e,t,a){if(e.size()){var o=T.makePointStyleFns(t);e.each(function(e){T.singlePointStyle(e,c.select(this),t,o,a)})}},T.singlePointStyle=function(e,t,o,i,n){var l=o.marker,s=l.line;if(t.style("opacity",i.selectedOpacityFn?i.selectedOpacityFn(e):void 0===e.mo?l.opacity:e.mo),i.ms2mrc){var d;d="various"===e.ms||"various"===l.size?3:i.ms2mrc(e.ms),e.mrc=d,i.selectedSizeFn&&(d=e.mrc=i.selectedSizeFn(e));var c=T.symbolNumber(e.mx||l.symbol)||0;e.om=100<=c%200,t.attr("d",a(c,d))}var u=!1,h,m,y;if(e.so)y=s.outlierwidth,m=s.outliercolor,h=l.outliercolor;else{var f=(s||{}).width;y=(e.mlw+1||f+1||(e.trace?(e.trace.marker.line||{}).width:0)+1)-1||0,m="mlc"in e?e.mlcc=i.lineScale(e.mlc):g.isArrayOrTypedArray(s.color)?p.defaultLine:s.color,g.isArrayOrTypedArray(l.color)&&(h=p.defaultLine,u=!0),h="mc"in e?e.mcc=i.markerScale(e.mc):l.color||"rgba(0,0,0,0)",i.selectedColorFn&&(h=i.selectedColorFn(e))}if(e.om)t.call(p.stroke,h).style({"stroke-width":(y||1)+"px",fill:"none"});else{t.style("stroke-width",y+"px");var x=l.gradient,b=e.mgt;if(b?u=!0:b=x&&x.type,Array.isArray(b)&&(b=b[0],!z[b]&&(b=0)),b&&"none"!==b){var _=e.mgc;_?u=!0:_=x.color;var v=o.uid;u&&(v+="-"+e.i),T.gradient(t,n,v,b,[[0,_],[1,h]],"fill")}else p.fill(t,h);y&&p.stroke(t,m)}},T.makePointStyleFns=function(e){var t={},a=e.marker;return t.markerScale=T.tryColorscale(a,""),t.lineScale=T.tryColorscale(a,"line"),d.traceIs(e,"symbols")&&(t.ms2mrc=_.isBubble(e)?v(e):function(){return(a.size||6)/2}),e.selectedpoints&&g.extendFlat(t,T.makeSelectedPointStyleFns(e)),t},T.makeSelectedPointStyleFns=function(e){var t={},a=e.selected||{},o=e.unselected||{},r=e.marker||{},i=a.marker||{},n=o.marker||{},l=r.opacity,s=i.opacity,c=n.opacity,p=void 0!==s,u=void 0!==c;(g.isArrayOrTypedArray(l)||p||u)&&(t.selectedOpacityFn=function(e){var t=void 0===e.mo?r.opacity:e.mo;return e.selected?p?s:t:u?c:b*t});var h=r.color,m=i.color,y=n.color;(m||y)&&(t.selectedColorFn=function(e){var t=e.mcc||h;return e.selected?m||t:y||t});var f=r.size,x=i.size,_=n.size,v=void 0!==x,w=void 0!==_;return d.traceIs(e,"symbols")&&(v||w)&&(t.selectedSizeFn=function(e){var t=e.mrc||f/2;return e.selected?v?x/2:t:w?_/2:t}),t},T.makeSelectedTextStyleFns=function(e){var t={},a=e.selected||{},o=e.unselected||{},r=e.textfont||{},i=a.textfont||{},n=o.textfont||{},l=r.color,s=i.color,c=n.color;return t.selectedTextColorFn=function(e){var t=e.tc||l;return e.selected?s||t:c?c:s?t:p.addOpacity(t,b)},t},T.selectedPointStyle=function(e,t){if(e.size()&&t.selectedpoints){var o=T.makeSelectedPointStyleFns(t),r=t.marker||{},n=[];o.selectedOpacityFn&&n.push(function(e,t){e.style("opacity",o.selectedOpacityFn(t))}),o.selectedColorFn&&n.push(function(e,t){p.fill(e,o.selectedColorFn(t))}),o.selectedSizeFn&&n.push(function(e,t){var i=t.mx||r.symbol||0,n=o.selectedSizeFn(t);e.attr("d",a(T.symbolNumber(i),n)),t.mrc2=n}),n.length&&e.each(function(e){for(var t=c.select(this),a=0;a<n.length;a++)n[a](t,e)})}},T.tryColorscale=function(e,t){var a=t?g.nestedProperty(e,t).get():e;if(a){var o=a.colorscale,r=a.color;if(o&&g.isArrayOrTypedArray(r))return u.makeColorScaleFunc(u.extractScale(a,{cLetter:"c"}))}return g.identity};var I={start:1,end:-1,middle:0,bottom:1,top:-1};T.textPointStyle=function(e,t,a){if(e.size()){var i;if(t.selectedpoints){var n=T.makeSelectedTextStyleFns(t);i=n.selectedTextColorFn}e.each(function(e){var n=c.select(this),l=g.extractOption(e,t,"tx","text");if(!l&&0!==l)return void n.remove();var s=e.tp||t.textposition,d=r(e,t),p=i?i(e):e.tc||t.textfont.color;n.call(T.font,e.tf||t.textfont.family,d,p).text(l).call(m.convertToTspans,a).call(o,s,d,e.mrc)})}},T.selectedTextStyle=function(e,t){if(e.size()&&t.selectedpoints){var a=T.makeSelectedTextStyleFns(t);e.each(function(e){var i=c.select(this),n=a.selectedTextColorFn(e),l=e.tp||t.textposition,s=r(e,t);p.fill(i,n),o(i,l,s,e.mrc2||e.mrc)})}};var D=.5;T.smoothopen=function(e,t){if(3>e.length)return"M"+e.join("L");var a="M"+e[0],o=[],r;for(r=1;r<e.length-1;r++)o.push(n(e[r-1],e[r],e[r+1],t));for(a+="Q"+o[0][0]+" "+e[1],r=2;r<e.length-1;r++)a+="C"+o[r-2][1]+" "+o[r-1][0]+" "+e[r];return a+="Q"+o[e.length-3][1]+" "+e[e.length-1],a},T.smoothclosed=function(e,t){if(3>e.length)return"M"+e.join("L")+"Z";var a="M"+e[0],o=e.length-1,r=[n(e[o],e[0],e[1],t)],l;for(l=1;l<o;l++)r.push(n(e[l-1],e[l],e[l+1],t));for(r.push(n(e[o-1],e[o],e[0],t)),l=1;l<=o;l++)a+="C"+r[l-1][1]+" "+r[l][0]+" "+e[l];return a+="C"+r[o][1]+" "+r[0][0]+" "+e[0]+"Z",a};var P={hv:function(e,t){return"H"+c.round(t[0],2)+"V"+c.round(t[1],2)},vh:function(e,t){return"V"+c.round(t[1],2)+"H"+c.round(t[0],2)},hvh:function(e,t){return"H"+c.round((e[0]+t[0])/2,2)+"V"+c.round(t[1],2)+"H"+c.round(t[0],2)},vhv:function(e,t){return"V"+c.round((e[1]+t[1])/2,2)+"H"+c.round(t[0],2)+"V"+c.round(t[1],2)}},O=function(e,t){return"L"+c.round(t[0],2)+","+c.round(t[1],2)};T.steps=function(e){var t=P[e]||O;return function(e){for(var a="M"+c.round(e[0][0],2)+","+c.round(e[0][1],2),o=1;o<e.length;o++)a+=t(e[o-1],e[o]);return a}},T.makeTester=function(){var e=g.ensureSingleById(c.select("body"),"svg","js-plotly-tester",function(e){e.attr(y.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),t=g.ensureSingle(e,"path","js-reference-point",function(e){e.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});T.tester=e,T.testref=t},T.savedBBoxes={};var M=0;T.bBox=function(e,t,a){a||(a=l(e));var o;if(a){if(o=T.savedBBoxes[a],o)return g.extendFlat({},o);}else if(1===e.childNodes.length){var r=e.childNodes[0];if(a=l(r),a){var i=+r.getAttribute("x")||0,n=+r.getAttribute("y")||0,s=r.getAttribute("transform");if(!s){var d=T.bBox(r,!1,a);return i&&(d.left+=i,d.right+=i),n&&(d.top+=n,d.bottom+=n),d}if(a+="~"+i+"~"+n+"~"+s,o=T.savedBBoxes[a],o)return g.extendFlat({},o)}}var p,u;t?p=e:(u=T.tester.node(),p=e.cloneNode(!0),u.appendChild(p)),c.select(p).attr("transform",null).call(m.positionText,0,0);var h=p.getBoundingClientRect(),y=T.testref.node().getBoundingClientRect();t||u.removeChild(p);var f={height:h.height,width:h.width,left:h.left-y.left,top:h.top-y.top,right:h.right-y.left,bottom:h.bottom-y.top};return M>=1e4&&(T.savedBBoxes={},M=0),a&&(T.savedBBoxes[a]=f),M++,g.extendFlat({},f)},T.setClipUrl=function(e,t,a){if(!t)return void e.attr("clip-path",null);var o=a._context,r=o._exportedPlot?"":o._baseUrl||"";e.attr("clip-path","url("+r+"#"+t+")")},T.getTranslate=function(e){var t=/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,a=e.attr?"attr":"getAttribute",o=e[a]("transform")||"",r=o.replace(t,function(e,t,a){return[t,a].join(" ")}).split(" ");return{x:+r[0]||0,y:+r[1]||0}},T.setTranslate=function(e,t,a){var o=/(\btranslate\(.*?\);?)/,r=e.attr?"attr":"getAttribute",i=e.attr?"attr":"setAttribute",n=e[r]("transform")||"";return t=t||0,a=a||0,n=n.replace(o,"").trim(),n+=" translate("+t+", "+a+")",n=n.trim(),e[i]("transform",n),n},T.getScale=function(e){var t=/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,a=e.attr?"attr":"getAttribute",o=e[a]("transform")||"",r=o.replace(t,function(e,t,a){return[t,a].join(" ")}).split(" ");return{x:+r[0]||1,y:+r[1]||1}},T.setScale=function(e,t,a){var o=/(\bscale\(.*?\);?)/,r=e.attr?"attr":"getAttribute",i=e.attr?"attr":"setAttribute",n=e[r]("transform")||"";return t=t||1,a=a||1,n=n.replace(o,"").trim(),n+=" scale("+t+", "+a+")",n=n.trim(),e[i]("transform",n),n};var j=/\s*sc.*/;T.setPointGroupScale=function(e,t,a){if(t=t||1,a=a||1,!!e){var o=1===t&&1===a?"":" scale("+t+","+a+")";e.each(function(){var e=(this.getAttribute("transform")||"").replace(j,"");e+=o,e=e.trim(),this.setAttribute("transform",e)})}};var B=/translate\([^)]*\)\s*$/;T.setTextPointsScale=function(e,t,a){e&&e.each(function(){var e=c.select(this),o=e.select("text"),r;if(o.node()){var i=parseFloat(o.attr("x")||0),n=parseFloat(o.attr("y")||0),l=(e.attr("transform")||"").match(B);r=1===t&&1===a?[]:["translate("+i+","+n+")","scale("+t+","+a+")","translate("+-i+","+-n+")"],l&&r.push(l),e.attr("transform",r.join(" "))}})}},{"../../constants/alignment":664,"../../constants/interactions":668,"../../constants/xmlns_namespaces":670,"../../lib":692,"../../lib/svg_text_utils":716,"../../registry":823,"../../traces/scatter/make_bubble_size_func":1057,"../../traces/scatter/subtypes":1064,"../color":569,"../colorscale":581,"./symbol_defs":591,d3:148,"fast-isnumeric":214,tinycolor2:513}],591:[function(e,t){"use strict";var o=e("d3");t.exports={circle:{n:0,f:function(e){var t=o.round(e,2);return"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"}},square:{n:1,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"}},diamond:{n:2,f:function(e){var t=o.round(1.3*e,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"}},cross:{n:3,f:function(e){var t=o.round(.4*e,2),a=o.round(1.2*e,2);return"M"+a+","+t+"H"+t+"V"+a+"H-"+t+"V"+t+"H-"+a+"V-"+t+"H-"+t+"V-"+a+"H"+t+"V-"+t+"H"+a+"Z"}},x:{n:4,f:function(e){var t=o.round(.8*e/re(2),2),a="l"+t+","+t,r="l"+t+",-"+t,i="l-"+t+",-"+t,n="l-"+t+","+t;return"M0,"+t+a+r+i+r+i+n+i+n+a+n+a+"Z"}},"triangle-up":{n:5,f:function(e){var t=o.round(2*e/re(3),2),a=o.round(e/2,2),r=o.round(e,2);return"M-"+t+","+a+"H"+t+"L0,-"+r+"Z"}},"triangle-down":{n:6,f:function(e){var t=o.round(2*e/re(3),2),a=o.round(e/2,2),r=o.round(e,2);return"M-"+t+",-"+a+"H"+t+"L0,"+r+"Z"}},"triangle-left":{n:7,f:function(e){var t=o.round(2*e/re(3),2),a=o.round(e/2,2),r=o.round(e,2);return"M"+a+",-"+t+"V"+t+"L-"+r+",0Z"}},"triangle-right":{n:8,f:function(e){var t=o.round(2*e/re(3),2),a=o.round(e/2,2),r=o.round(e,2);return"M-"+a+",-"+t+"V"+t+"L"+r+",0Z"}},"triangle-ne":{n:9,f:function(e){var t=o.round(.6*e,2),a=o.round(1.2*e,2);return"M-"+a+",-"+t+"H"+t+"V"+a+"Z"}},"triangle-se":{n:10,f:function(e){var t=o.round(.6*e,2),a=o.round(1.2*e,2);return"M"+t+",-"+a+"V"+t+"H-"+a+"Z"}},"triangle-sw":{n:11,f:function(e){var t=o.round(.6*e,2),a=o.round(1.2*e,2);return"M"+a+","+t+"H-"+t+"V-"+a+"Z"}},"triangle-nw":{n:12,f:function(e){var t=o.round(.6*e,2),a=o.round(1.2*e,2);return"M-"+t+","+a+"V-"+t+"H"+a+"Z"}},pentagon:{n:13,f:function(e){var t=o.round(.951*e,2),a=o.round(.588*e,2),r=o.round(-e,2),i=o.round(-.309*e,2),n=o.round(.809*e,2);return"M"+t+","+i+"L"+a+","+n+"H-"+a+"L-"+t+","+i+"L0,"+r+"Z"}},hexagon:{n:14,f:function(e){var t=o.round(e,2),a=o.round(e/2,2),r=o.round(e*re(3)/2,2);return"M"+r+",-"+a+"V"+a+"L0,"+t+"L-"+r+","+a+"V-"+a+"L0,-"+t+"Z"}},hexagon2:{n:15,f:function(e){var t=o.round(e,2),a=o.round(e/2,2),r=o.round(e*re(3)/2,2);return"M-"+a+","+r+"H"+a+"L"+t+",0L"+a+",-"+r+"H-"+a+"L-"+t+",0Z"}},octagon:{n:16,f:function(e){var t=o.round(.924*e,2),a=o.round(.383*e,2);return"M-"+a+",-"+t+"H"+a+"L"+t+",-"+a+"V"+a+"L"+a+","+t+"H-"+a+"L-"+t+","+a+"V-"+a+"Z"}},star:{n:17,f:function(e){var t=1.4*e,a=o.round(.225*t,2),r=o.round(.951*t,2),i=o.round(.363*t,2),n=o.round(.588*t,2),l=o.round(-t,2),s=o.round(-.309*t,2),d=o.round(.118*t,2),c=o.round(.809*t,2),p=o.round(.382*t,2);return"M"+a+","+s+"H"+r+"L"+i+","+d+"L"+n+","+c+"L0,"+p+"L-"+n+","+c+"L-"+i+","+d+"L-"+r+","+s+"H-"+a+"L0,"+l+"Z"}},hexagram:{n:18,f:function(e){var t=o.round(.66*e,2),a=o.round(.38*e,2),r=o.round(.76*e,2);return"M-"+r+",0l-"+a+",-"+t+"h"+r+"l"+a+",-"+t+"l"+a+","+t+"h"+r+"l-"+a+","+t+"l"+a+","+t+"h-"+r+"l-"+a+","+t+"l-"+a+",-"+t+"h-"+r+"Z"}},"star-triangle-up":{n:19,f:function(e){var t=o.round(.8*(e*re(3)),2),a=o.round(.8*e,2),r=o.round(1.6*e,2),i=o.round(4*e,2),n="A "+i+","+i+" 0 0 1 ";return"M-"+t+","+a+n+t+","+a+n+"0,-"+r+n+"-"+t+","+a+"Z"}},"star-triangle-down":{n:20,f:function(e){var t=o.round(.8*(e*re(3)),2),a=o.round(.8*e,2),r=o.round(1.6*e,2),i=o.round(4*e,2),n="A "+i+","+i+" 0 0 1 ";return"M"+t+",-"+a+n+"-"+t+",-"+a+n+"0,"+r+n+t+",-"+a+"Z"}},"star-square":{n:21,f:function(e){var t=o.round(1.1*e,2),a=o.round(2*e,2),r="A "+a+","+a+" 0 0 1 ";return"M-"+t+",-"+t+r+"-"+t+","+t+r+t+","+t+r+t+",-"+t+r+"-"+t+",-"+t+"Z"}},"star-diamond":{n:22,f:function(e){var t=o.round(1.4*e,2),a=o.round(1.9*e,2),r="A "+a+","+a+" 0 0 1 ";return"M-"+t+",0"+r+"0,"+t+r+t+",0"+r+"0,-"+t+r+"-"+t+",0Z"}},"diamond-tall":{n:23,f:function(e){var t=o.round(.7*e,2),a=o.round(1.4*e,2);return"M0,"+a+"L"+t+",0L0,-"+a+"L-"+t+",0Z"}},"diamond-wide":{n:24,f:function(e){var t=o.round(1.4*e,2),a=o.round(.7*e,2);return"M0,"+a+"L"+t+",0L0,-"+a+"L-"+t+",0Z"}},hourglass:{n:25,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"H-"+t+"L"+t+",-"+t+"H-"+t+"Z"},noDot:!0},bowtie:{n:26,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"V-"+t+"L-"+t+","+t+"V-"+t+"Z"},noDot:!0},"circle-cross":{n:27,f:function(e){var t=o.round(e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(e){var t=o.round(e,2),a=o.round(e/re(2),2);return"M"+a+","+a+"L-"+a+",-"+a+"M"+a+",-"+a+"L-"+a+","+a+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(e){var t=o.round(e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(e){var t=o.round(1.3*e,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"ZM0,-"+t+"V"+t+"M-"+t+",0H"+t},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(e){var t=o.round(1.3*e,2),a=o.round(.65*e,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"ZM-"+a+",-"+a+"L"+a+","+a+"M-"+a+","+a+"L"+a+",-"+a},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(e){var t=o.round(1.4*e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(e){var t=o.round(1.2*e,2),a=o.round(.85*e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+a+","+a+"L-"+a+",-"+a+"M"+a+",-"+a+"L-"+a+","+a},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(e){var t=o.round(e/2,2),a=o.round(e,2);return"M"+t+","+a+"V-"+a+"m-"+a+",0V"+a+"M"+a+","+t+"H-"+a+"m0,-"+a+"H"+a},needLine:!0,noFill:!0},"y-up":{n:37,f:function(e){var t=o.round(1.2*e,2),a=o.round(1.6*e,2),r=o.round(.8*e,2);return"M-"+t+","+r+"L0,0M"+t+","+r+"L0,0M0,-"+a+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(e){var t=o.round(1.2*e,2),a=o.round(1.6*e,2),r=o.round(.8*e,2);return"M-"+t+",-"+r+"L0,0M"+t+",-"+r+"L0,0M0,"+a+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(e){var t=o.round(1.2*e,2),a=o.round(1.6*e,2),r=o.round(.8*e,2);return"M"+r+","+t+"L0,0M"+r+",-"+t+"L0,0M-"+a+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(e){var t=o.round(1.2*e,2),a=o.round(1.6*e,2),r=o.round(.8*e,2);return"M-"+r+","+t+"L0,0M-"+r+",-"+t+"L0,0M"+a+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(e){var t=o.round(1.4*e,2);return"M"+t+",0H-"+t},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(e){var t=o.round(1.4*e,2);return"M0,"+t+"V-"+t},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(e){var t=o.round(e,2);return"M"+t+",-"+t+"L-"+t+","+t},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(e){var t=o.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t},needLine:!0,noDot:!0,noFill:!0}}},{d3:148}],592:[function(e,t){"use strict";t.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],593:[function(e,t){"use strict";function a(e,t,a,r){var s=t["error_"+r]||{},d=s.visible&&-1!==["linear","log"].indexOf(a.type),c=[];if(d){for(var p=l(s),u=0;u<e.length;u++){var g=e[u],h=g.i;if(void 0===h)h=u;else if(null===h)continue;var m=g[r];if(o(a.c2l(m))){var y=p(m,h);if(o(y[0])&&o(y[1])){var f=g[r+"s"]=m-y[0],x=g[r+"h"]=m+y[1];c.push(f,x)}}}var b=n.findExtremes(a,c,{padded:!0}),_=a._id;t._extremes[_].min=t._extremes[_].min.concat(b.min),t._extremes[_].max=t._extremes[_].max.concat(b.max)}}var o=e("fast-isnumeric"),r=e("../../registry"),n=e("../../plots/cartesian/axes"),l=e("./compute_error");t.exports=function(e){for(var t=e.calcdata,o=0;o<t.length;o++){var l=t[o],s=l[0].trace;if(!0===s.visible&&r.traceIs(s,"errorBarsOK")){var d=n.getFromId(e,s.xaxis),c=n.getFromId(e,s.yaxis);a(l,s,d,"x"),a(l,s,c,"y")}}}},{"../../plots/cartesian/axes":740,"../../registry":823,"./compute_error":594,"fast-isnumeric":214}],594:[function(e,t){"use strict";function a(e,t){return"percent"===e?function(e){return wa(e*t/100)}:"constant"===e?function(){return wa(t)}:"sqrt"===e?function(e){return re(wa(e))}:void 0}t.exports=function(e){var t=e.type,o=e.symmetric;if("data"===t){var r=e.array||[];if(o)return function(e,t){var a=+r[t];return[a,a]};var i=e.arrayminus||[];return function(e,t){var a=+r[t],o=+i[t];return isNaN(a)&&isNaN(o)?[NaN,NaN]:[o||0,a||0]}}var n=a(t,e.value),l=a(t,e.valueminus);return o||void 0===e.valueminus?function(e){var t=n(e);return[t,t]}:function(e){return[l(e),n(e)]}}},{}],595:[function(e,t){"use strict";var a=e("fast-isnumeric"),o=e("../../registry"),r=e("../../lib"),i=e("../../plot_api/plot_template"),n=e("./attributes");t.exports=function(e,t,l,s){function d(e,t){return r.coerce(u,p,n,e,t)}var c="error_"+s.axis,p=i.newContainer(t,c),u=e[c]||{},g=u.array!==void 0||u.value!==void 0||"sqrt"===u.type,h=d("visible",g);if(!1!==h){var m=d("type","array"in u?"data":"percent"),y=!0;"sqrt"!==m&&(y=d("symmetric",!(("data"===m?"arrayminus":"valueminus")in u))),"data"===m?(d("array"),d("traceref"),!y&&(d("arrayminus"),d("tracerefminus"))):("percent"===m||"constant"===m)&&(d("value"),!y&&d("valueminus"));var f="copy_"+s.inherit+"style";if(s.inherit){var x=t["error_"+s.inherit];(x||{}).visible&&d(f,!(u.color||a(u.thickness)||a(u.width)))}s.inherit&&p[f]||(d("color",l),d("thickness"),d("width",o.traceIs(t,"gl3d")?0:4))}}},{"../../lib":692,"../../plot_api/plot_template":730,"../../registry":823,"./attributes":592,"fast-isnumeric":214}],596:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../plot_api/edit_types").overrideAll,r=e("./attributes"),i={error_x:a.extendFlat({},r),error_y:a.extendFlat({},r)};delete i.error_x.copy_zstyle,delete i.error_y.copy_zstyle,delete i.error_y.copy_ystyle;var n={error_x:a.extendFlat({},r),error_y:a.extendFlat({},r),error_z:a.extendFlat({},r)};delete n.error_x.copy_ystyle,delete n.error_y.copy_ystyle,delete n.error_z.copy_ystyle,delete n.error_z.copy_zstyle,t.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:i,bar:i,histogram:i,scatter3d:o(n,"calc","nested"),scattergl:o(i,"calc","nested")}},supplyDefaults:e("./defaults"),calc:e("./calc"),makeComputeError:e("./compute_error"),plot:e("./plot"),style:e("./style"),hoverInfo:function(e,t,a){(t.error_y||{}).visible&&(a.yerr=e.yh-e.y,!t.error_y.symmetric&&(a.yerrneg=e.y-e.ys)),(t.error_x||{}).visible&&(a.xerr=e.xh-e.x,!t.error_x.symmetric&&(a.xerrneg=e.x-e.xs))}}},{"../../lib":692,"../../plot_api/edit_types":723,"./attributes":592,"./calc":593,"./compute_error":594,"./defaults":595,"./plot":597,"./style":598}],597:[function(e,t){"use strict";function a(e,t,a){var o={x:t.c2p(e.x),y:a.c2p(e.y)};return void 0!==e.yh&&(o.yh=a.c2p(e.yh),o.ys=a.c2p(e.ys),!r(o.ys)&&(o.noYS=!0,o.ys=a.c2p(e.ys,!0))),void 0!==e.xh&&(o.xh=t.c2p(e.xh),o.xs=t.c2p(e.xs),!r(o.xs)&&(o.noXS=!0,o.xs=t.c2p(e.xs,!0))),o}var o=e("d3"),r=e("fast-isnumeric"),i=e("../drawing"),n=e("../../traces/scatter/subtypes");t.exports=function(e,t,l,s){var c=l.xaxis,p=l.yaxis,d=s&&0<s.duration,u;t.each(function(t){var g=t[0].trace,h=g.error_x||{},m=g.error_y||{},y;g.ids&&(y=function(e){return e.id});var f=n.hasMarkers(g)&&0<g.marker.maxdisplayed;m.visible||h.visible||(t=[]);var x=o.select(this).selectAll("g.errorbar").data(t,y);if(x.exit().remove(),!!t.length){h.visible||x.selectAll("path.xerror").remove(),m.visible||x.selectAll("path.yerror").remove(),x.style("opacity",1);var b=x.enter().append("g").classed("errorbar",!0);d&&b.style("opacity",0).transition().duration(s.duration).style("opacity",1),i.setClipUrl(x,l.layerClipId,e),x.each(function(e){var t=o.select(this),i=a(e,c,p);if(!f||e.vis){var n=t.select("path.yerror"),l;if(m.visible&&r(i.x)&&r(i.yh)&&r(i.ys)){var g=m.width;l="M"+(i.x-g)+","+i.yh+"h"+2*g+"m-"+g+",0V"+i.ys,i.noYS||(l+="m-"+g+",0h"+2*g),u=!n.size(),u?n=t.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0):d&&(n=n.transition().duration(s.duration).ease(s.easing)),n.attr("d",l)}else n.remove();var y=t.select("path.xerror");if(h.visible&&r(i.y)&&r(i.xh)&&r(i.xs)){var x=(h.copy_ystyle?m:h).width;l="M"+i.xh+","+(i.y-x)+"v"+2*x+"m0,-"+x+"H"+i.xs,i.noXS||(l+="m0,-"+x+"v"+2*x),u=!y.size(),u?y=t.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0):d&&(y=y.transition().duration(s.duration).ease(s.easing)),y.attr("d",l)}else y.remove()}})}})}},{"../../traces/scatter/subtypes":1064,"../drawing":590,d3:148,"fast-isnumeric":214}],598:[function(e,t){"use strict";var a=e("d3"),o=e("../color");t.exports=function(e){e.each(function(e){var t=e[0].trace,r=t.error_y||{},i=t.error_x||{},n=a.select(this);n.selectAll("path.yerror").style("stroke-width",r.thickness+"px").call(o.stroke,r.color),i.copy_ystyle&&(i=r),n.selectAll("path.xerror").style("stroke-width",i.thickness+"px").call(o.stroke,i.color)})}},{"../color":569,d3:148}],599:[function(e,t){"use strict";var a=e("../../plots/font_attributes");t.exports={hoverlabel:{bgcolor:{valType:"color",arrayOk:!0,editType:"none"},bordercolor:{valType:"color",arrayOk:!0,editType:"none"},font:a({arrayOk:!0,editType:"none"}),namelength:{valType:"integer",min:-1,arrayOk:!0,editType:"none"},editType:"calc"}}},{"../../plots/font_attributes":767}],600:[function(e,t){"use strict";function a(e,t,a,r){r=r||o.identity,Array.isArray(e)&&(t[0][a]=r(e))}var o=e("../../lib"),r=e("../../registry");t.exports=function(e){function t(e){return function(t){return o.coerceHoverinfo({hoverinfo:t},{_module:e._module},l)}}for(var n=e.calcdata,l=e._fullLayout,s=0;s<n.length;s++){var d=n[s],c=d[0].trace;if(!r.traceIs(c,"pie")){var p=r.traceIs(c,"2dMap")?a:o.fillArray;p(c.hoverinfo,d,"hi",t(c)),c.hovertemplate&&p(c.hovertemplate,d,"ht"),c.hoverlabel&&(p(c.hoverlabel.bgcolor,d,"hbg"),p(c.hoverlabel.bordercolor,d,"hbc"),p(c.hoverlabel.font.size,d,"hts"),p(c.hoverlabel.font.color,d,"htc"),p(c.hoverlabel.font.family,d,"htf"),p(c.hoverlabel.namelength,d,"hnl"))}}}},{"../../lib":692,"../../registry":823}],601:[function(e,t){"use strict";var a=e("../../registry"),o=e("./hover").hover;t.exports=function(e,t,r){function i(){e.emit("plotly_click",{points:e._hoverdata,event:t})}var n=a.getComponentMethod("annotations","onClick")(e,e._hoverdata);r!==void 0&&o(e,t,r,!0),e._hoverdata&&t&&t.target&&(n&&n.then?n.then(i):i(),t.stopImmediatePropagation&&t.stopImmediatePropagation())}},{"../../registry":823,"./hover":605}],602:[function(e,t){"use strict";t.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],603:[function(e,t){"use strict";var a=e("../../lib"),o=e("./attributes"),r=e("./hoverlabel_defaults");t.exports=function(e,t,i,n){r(e,t,function(r,i){return a.coerce(e,t,o,r,i)},n.hoverlabel)}},{"../../lib":692,"./attributes":599,"./hoverlabel_defaults":606}],604:[function(e,t,a){"use strict";function o(e){return n[e]||e}function r(e,t){if(!Array.isArray(t))return e[t];else if(Array.isArray(e)&&Array.isArray(e[t[0]]))return e[t[0]][t[1]]}var i=e("../../lib");a.getSubplot=function(e){return e.subplot||e.xaxis+e.yaxis||e.geo},a.isTraceInSubplots=function(e,t){if("splom"===e.type){for(var o=e.xaxes||[],r=e.yaxes||[],n=0;n<o.length;n++)for(var l=0;l<r.length;l++)if(-1!==t.indexOf(o[n]+r[l]))return!0;return!1}return-1!==t.indexOf(a.getSubplot(e))},a.flat=function(e,t){for(var a=Array(e.length),o=0;o<e.length;o++)a[o]=t;return a},a.p2c=function(e,t){for(var a=Array(e.length),o=0;o<e.length;o++)a[o]=e[o].p2c(t);return a},a.getDistanceFunction=function(e,t,o,r){return"closest"===e?r||a.quadrature(t,o):"x"===e?t:o},a.getClosest=function(e,t,a){if(!1!==a.index)0<=a.index&&a.index<e.length?a.distance=0:a.index=!1;else for(var o=0,r;o<e.length;o++)r=t(e[o]),r<=a.distance&&(a.index=o,a.distance=r);return a},a.inbox=function(e,t,a){return 0>e*t||0===e?a:1/0},a.quadrature=function(e,t){return function(a){var o=e(a),r=t(a);return re(o*o+r*r)}},a.makeEventData=function(e,t,o){var r="index"in e?e.index:e.pointNumber,i={data:t._input,fullData:t,curveNumber:t.index,pointNumber:r};if(t._indexToPoints){var n=t._indexToPoints[r];1===n.length?i.pointIndex=n[0]:i.pointIndices=n}else i.pointIndex=r;return t._module.eventData?i=t._module.eventData(i,e,t,o,r):("xVal"in e?i.x=e.xVal:"x"in e&&(i.x=e.x),"yVal"in e?i.y=e.yVal:"y"in e&&(i.y=e.y),e.xa&&(i.xaxis=e.xa),e.ya&&(i.yaxis=e.ya),void 0!==e.zLabelVal&&(i.z=e.zLabelVal)),a.appendArrayPointValue(i,t,r),i},a.appendArrayPointValue=function(e,t,a){var n=t._arrayAttrs;if(n)for(var l=0;l<n.length;l++){var s=n[l],d=o(s);if(void 0===e[d]){var c=i.nestedProperty(t,s).get(),p=r(c,a);void 0!==p&&(e[d]=p)}}},a.appendArrayMultiPointValues=function(e,t,a){var n=t._arrayAttrs;if(n)for(var l=0;l<n.length;l++){var s=n[l],d=o(s);if(void 0===e[d]){for(var c=i.nestedProperty(t,s).get(),p=Array(a.length),u=0;u<a.length;u++)p[u]=r(c,a[u]);e[d]=p}}};var n={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color"}},{"../../lib":692}],605:[function(e,t,a){"use strict";function o(e,t,a,o){function g(e,t){for(var a=null,o=1/0,r=0,n;r<e.length;r++)n=e[r].spikeDistance,n<o&&n<=t&&(a=e[r],o=n);return a}function y(e){return e?{xa:e.xa,ya:e.ya,x:void 0===e.xSpike?(e.x0+e.x1)/2:e.xSpike,y:void 0===e.ySpike?(e.y0+e.y1)/2:e.ySpike,distance:e.distance,spikeDistance:e.spikeDistance,curveNumber:e.trace.index,color:e.color,pointNumber:e.index}:null}a||(a="xy");var x=Array.isArray(a)?a:[a],T=e._fullLayout,A=T._plots||[],S=A[a],C=T._has("cartesian");if(S){var L=S.overlays.map(function(e){return e.id});x=x.concat(L)}for(var E=x.length,z=Array(E),I=Array(E),D=!1,P=0;P<E;P++){var O=x[P],R=A[O];if(R){D=!0,z[P]=v.getFromId(e,R.xaxis._id),I[P]=v.getFromId(e,R.yaxis._id);continue}var M=T[O]._subplot;z[P]=M.xaxis,I[P]=M.yaxis}var j=t.hovermode||T.hovermode;if(j&&!D&&(j="closest"),-1===["x","y","closest"].indexOf(j)||!e.calcdata||e.querySelector(".zoombox")||e._dragging)return _.unhoverRaw(e,t);var B=-1===T.hoverdistance?1/0:T.hoverdistance,F=-1===T.spikedistance?1/0:T.spikedistance,N=[],V=[],U={hLinePoint:null,vLinePoint:null},H=!1,G,Y,q,W,X,Z,$,J,K,Q,ee,te,ae;if(Array.isArray(t))for(j="array",q=0;q<t.length;q++)X=e.calcdata[t[q].curveNumber||0],Z=X[0].trace,"skip"!==X[0].trace.hoverinfo&&(V.push(X),"h"===Z.orientation&&(H=!0));else{for(W=0;W<e.calcdata.length;W++)X=e.calcdata[W],Z=X[0].trace,"skip"!==Z.hoverinfo&&k.isTraceInSubplots(Z,x)&&(V.push(X),"h"===Z.orientation&&(H=!0));var oe=!t.target,re,ne;if(oe)re="xpx"in t?t.xpx:z[0]._length/2,ne="ypx"in t?t.ypx:I[0]._length/2;else{if(!1===m.triggerHandler(e,"plotly_beforehover",t))return;var le=t.target.getBoundingClientRect();if(re=t.clientX-le.left,ne=t.clientY-le.top,0>re||re>z[0]._length||0>ne||ne>I[0]._length)return _.unhoverRaw(e,t)}if(t.pointerX=re+z[0]._offset,t.pointerY=ne+I[0]._offset,G="xval"in t?k.flat(x,t.xval):k.p2c(z,re),Y="yval"in t?k.flat(x,t.yval):k.p2c(I,ne),!i(G[0])||!i(Y[0]))return h.warn("Fx.hover failed",t,e),_.unhoverRaw(e,t)}var se=1/0;for(W=0;W<V.length;W++)if(X=V[W],X&&X[0]&&X[0].trace&&!0===X[0].trace.visible&&(Z=X[0].trace,-1===["carpet","contourcarpet"].indexOf(Z._module.name))){if("splom"===Z.type?(J=0,$=x[J]):($=k.getSubplot(Z),J=x.indexOf($)),K=j,te={cd:X,trace:Z,xa:z[J],ya:I[J],maxHoverDistance:B,maxSpikeDistance:F,index:!1,distance:ie(se,B),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:b.defaultLine,name:Z.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},T[$]&&(te.subplot=T[$]._subplot),T._splomScenes&&T._splomScenes[Z.uid]&&(te.scene=T._splomScenes[Z.uid]),ae=N.length,"array"===K){var de=t[W];"pointNumber"in de?(te.index=de.pointNumber,K="closest"):(K="","xval"in de&&(Q=de.xval,K="x"),"yval"in de&&(ee=de.yval,K=K?"closest":"y"))}else Q=G[J],ee=Y[J];if(0!==B)if(Z._module&&Z._module.hoverPoints){var ce=Z._module.hoverPoints(te,Q,ee,K,T._hoverlayer);if(ce)for(var pe=0,ue;pe<ce.length;pe++)ue=ce[pe],i(ue.x0)&&i(ue.y0)&&N.push(s(ue,j))}else h.log("Unrecognized trace type in hover:",Z);if("closest"===j&&N.length>ae&&(N.splice(0,ae),se=N[0].distance),C&&0!==F&&0===N.length){te.distance=F,te.index=!1;var ge=Z._module.hoverPoints(te,Q,ee,"closest",T._hoverlayer);if(ge&&(ge=ge.filter(function(e){return e.spikeDistance<=F})),ge&&ge.length){var he=ge.filter(function(e){return e.xa.showspikes}),me;if(he.length){var ye=he[0];i(ye.x0)&&i(ye.y0)&&(me=y(ye),(!U.vLinePoint||U.vLinePoint.spikeDistance>me.spikeDistance)&&(U.vLinePoint=me))}var fe=ge.filter(function(e){return e.ya.showspikes});if(fe.length){var xe=fe[0];i(xe.x0)&&i(xe.y0)&&(me=y(xe),(!U.hLinePoint||U.hLinePoint.spikeDistance>me.spikeDistance)&&(U.hLinePoint=me))}}}}var be={fullLayout:T,container:T._hoverlayer,outerContainer:T._paperdiv,event:t},_e=e._spikepoints,ve={vLinePoint:U.vLinePoint,hLinePoint:U.hLinePoint};if(e._spikepoints=ve,C&&0!==F&&0!==N.length){var we=N.filter(function(e){return e.ya.showspikes}),ke=g(we,F);U.hLinePoint=y(ke);var Te=N.filter(function(e){return e.xa.showspikes}),Ae=g(Te,F);U.vLinePoint=y(Ae)}if(0===N.length){var Se=_.unhoverRaw(e,t);return C&&(null!==U.hLinePoint||null!==U.vLinePoint)&&p(_e)&&d(U,be),Se}C&&p(_e)&&d(U,be),N.sort(function(e,t){return e.distance-t.distance});var Ce=e._hoverdata,Le=[];for(q=0;q<N.length;q++){var Ee=N[q],ze=k.makeEventData(Ee,Ee.trace,Ee.cd),Ie=!1;Ee.cd[Ee.index]&&Ee.cd[Ee.index].ht&&(Ie=Ee.cd[Ee.index].ht),N[q].hovertemplate=Ie||Ee.trace.hovertemplate||!1,N[q].eventData=[ze],Le.push(ze)}e._hoverdata=Le;var De="y"===j&&(1<V.length||1<N.length)||"closest"===j&&H&&1<N.length,Pe=b.combine(T.plot_bgcolor||b.background,T.paper_bgcolor),Oe={hovermode:j,rotateLabels:De,bgColor:Pe,container:T._hoverlayer,outerContainer:T._paperdiv,commonLabelOpts:T.hoverlabel,hoverdistance:T.hoverdistance},Re=r(N,Oe,e);if(n(N,De?"xa":"ya",T),l(Re,De),t.target&&t.target.tagName){var Me=w.getComponentMethod("annotations","hasClickToShow")(e,Le);f(u.select(t.target),Me?"pointer":"")}t.target&&!o&&c(e,t,Ce)&&(Ce&&e.emit("plotly_unhover",{event:t,points:Ce}),e.emit("plotly_hover",{event:t,points:e._hoverdata,xaxes:z,yaxes:I,xvals:G,yvals:Y}))}function r(e,t,a){var o=t.hovermode,r=t.rotateLabels,n=t.bgColor,l=t.container,s=t.outerContainer,d=t.commonLabelOpts||{},c=t.fontFamily||T.HOVERFONT,p=t.fontSize||T.HOVERFONTSIZE,g=e[0],m=g.xa,f=g.ya,_="y"===o?"yLabel":"xLabel",v=g[_],w=(v+""||"").split(" ")[0],k=s.node().getBoundingClientRect(),S=k.top,C=k.width,L=k.height,E=void 0!==v&&g.distance<=t.hoverdistance&&("x"===o||"y"===o);if(E){var P=!0,O,M;for(O=0;O<e.length;O++)if(P&&void 0===e[O].zLabel&&(P=!1),M=e[O].hoverinfo||e[O].trace.hoverinfo,M){var j=Array.isArray(M)?M:M.split("+");if(-1===j.indexOf("all")&&-1===j.indexOf(o)){E=!1;break}}P&&(E=!1)}var B=l.selectAll("g.axistext").data(E?[0]:[]);B.enter().append("g").classed("axistext",!0),B.exit().remove(),B.each(function(){var t=u.select(this),r=h.ensureSingle(t,"path","",function(e){e.style({"stroke-width":"1px"})}),i=h.ensureSingle(t,"text","",function(e){e.attr("data-notex",1)}),n=d.bgcolor||b.defaultLine,l=d.bordercolor||b.contrast(n),s=b.contrast(n);r.style({fill:n,stroke:l}),i.text(v).call(x.font,d.font.family||c,d.font.size||p,d.font.color||s).call(y.positionText,0,0).call(y.convertToTspans,a),t.attr("transform","");var k=i.node().getBoundingClientRect();if("x"===o){i.attr("text-anchor","middle").call(y.positionText,0,"top"===m.side?S-k.bottom-z-I:S-k.top+z+I);var T="top"===m.side?"-":"";r.attr("d","M0,0L"+z+","+T+z+"H"+(I+k.width/2)+"v"+T+(2*I+k.height)+"H-"+(I+k.width/2)+"V"+T+z+"H-"+z+"Z"),t.attr("transform","translate("+(m._offset+(g.x0+g.x1)/2)+","+(f._offset+("top"===m.side?0:f._length))+")")}else{i.attr("text-anchor","right"===f.side?"start":"end").call(y.positionText,("right"===f.side?1:-1)*(I+z),S-k.top-k.height/2);var A="right"===f.side?"":"-";r.attr("d","M0,0L"+A+z+","+z+"V"+(I+k.height/2)+"h"+A+(2*I+k.width)+"V-"+(I+k.height/2)+"H"+A+z+"V-"+z+"Z"),t.attr("transform","translate("+(m._offset+("right"===f.side?m._length:0))+","+(f._offset+(g.y0+g.y1)/2)+")")}e=e.filter(function(e){return void 0!==e.zLabelVal||(e[_]||"").split(" ")[0]===w})});var F=l.selectAll("g.hovertext").data(e,function(e){return[e.trace.index,e.index,e.x0,e.y0,e.name,e.attr,e.xa,e.ya||""].join(",")});return F.enter().append("g").classed("hovertext",!0).each(function(){var e=u.select(this);e.append("rect").call(b.fill,b.addOpacity(n,.8)),e.append("text").classed("name",!0),e.append("path").style("stroke-width","1px"),e.append("text").classed("nums",!0).call(x.font,c,p)}),F.exit().remove(),F.each(function(e){var t=u.select(this).attr("transform",""),i="",l="",s=e.bgcolor||e.color,d=b.combine(b.opacity(s)?s:b.defaultLine,n),g=b.combine(b.opacity(e.color)?e.color:b.defaultLine,n),m=e.borderColor||b.contrast(d);if(void 0!==e.nameOverride&&(e.name=e.nameOverride),e.name){i=y.plainText(e.name||"");var f=R(e.nameLength);-1<f&&i.length>f&&(3<f?i=i.substr(0,f-3)+"...":i=i.substr(0,f))}void 0===e.zLabel?E&&e[o+"Label"]===v?l=e[("x"===o?"y":"x")+"Label"]||"":void 0===e.xLabel?void 0!==e.yLabel&&(l=e.yLabel):void 0===e.yLabel?l=e.xLabel:l="("+e.xLabel+", "+e.yLabel+")":(void 0!==e.xLabel&&(l+="x: "+e.xLabel+"<br>"),void 0!==e.yLabel&&(l+="y: "+e.yLabel+"<br>"),l+=(l?"z: ":"")+e.zLabel),(e.text||0===e.text)&&!Array.isArray(e.text)&&(l+=(l?"<br>":"")+e.text),void 0!==e.extraText&&(l+=(l?"<br>":"")+e.extraText),""===l&&(""===i&&t.remove(),l=i);var _=e.hovertemplate||!1,w=e.hovertemplateLabels||e,k=e.eventData[0]||{};_&&(l=h.hovertemplateString(_,w,k),l=l.replace(D,function(e,t){return i=t,""}));var T=t.select("text.nums").call(x.font,e.fontFamily||c,e.fontSize||p,e.fontColor||m).text(l).attr("data-notex",1).call(y.positionText,0,0).call(y.convertToTspans,a),P=t.select("text.name"),O=0;i&&i!==l?(P.call(x.font,e.fontFamily||c,e.fontSize||p,g).text(i).attr("data-notex",1).call(y.positionText,0,0).call(y.convertToTspans,a),O=P.node().getBoundingClientRect().width+2*I):(P.remove(),t.select("rect").remove()),t.select("path").style({fill:d,stroke:m});var M=T.node().getBoundingClientRect(),j=e.xa._offset+(e.x0+e.x1)/2,B=e.ya._offset+(e.y0+e.y1)/2,F=wa(e.x1-e.x0),N=wa(e.y1-e.y0),V=M.width+z+I+O,U,H;e.ty0=S-M.top,e.bx=M.width+2*I,e.by=M.height+2*I,e.anchor="start",e.txwidth=M.width,e.tx2width=O,e.offset=0,r?(e.pos=j,U=B+N/2+V<=L,H=0<=B-N/2-V,("top"===e.idealAlign||!U)&&H?(B-=N/2,e.anchor="end"):U?(B+=N/2,e.anchor="start"):e.anchor="middle"):(e.pos=B,U=j+F/2+V<=C,H=0<=j-F/2-V,("left"===e.idealAlign||!U)&&H?(j-=F/2,e.anchor="end"):U?(j+=F/2,e.anchor="start"):e.anchor="middle"),T.attr("text-anchor",e.anchor),O&&P.attr("text-anchor",e.anchor),t.attr("transform","translate("+j+","+B+")"+(r?"rotate("+A+")":""))}),F}function n(e,t,a){function o(e){var t=e[0],a=e[e.length-1];if(d=t.pmin-t.pos-t.dp+t.size,c=a.pos+a.dp+a.size-t.pmax,.01<d){for(u=e.length-1;0<=u;u--)e[u].dp+=d;s=!1}if(!(.01>c)){if(-.01>d){for(u=e.length-1;0<=u;u--)e[u].dp-=c;s=!1}if(s){var o=0;for(p=0;p<e.length;p++)g=e[p],g.pos+g.dp+g.size>t.pmax&&o++;for(p=e.length-1;0<=p&&!(0>=o);p--)g=e[p],g.pos>t.pmax-1&&(g.del=!0,o--);for(p=0;p<e.length&&!(0>=o);p++)if(g=e[p],g.pos<t.pmin+1)for(g.del=!0,o--,c=2*g.size,u=e.length-1;0<=u;u--)e[u].dp-=c;for(p=e.length-1;0<=p&&!(0>=o);p--)g=e[p],g.pos+g.dp+g.size>t.pmax&&(g.del=!0,o--)}}}for(var r=0,n=1,l=e.map(function(e,o){var r=e[t],i="x"===r._id.charAt(0),l=r.range;return!o&&l&&l[0]>l[1]!==i&&(n=-1),[{i:o,traceIndex:e.trace.index,dp:0,pos:e.pos,posref:e.posref,size:e.by*(i?C:1)/2,pmin:0,pmax:i?a.width:a.height}]}).sort(function(e,t){return e[0].posref-t[0].posref||n*(t[0].traceIndex-e[0].traceIndex)}),s,d,c,p,u,g,h;!s&&r<=e.length;){for(r++,s=!0,p=0;p<l.length-1;){var m=l[p],y=l[p+1],f=m[m.length-1],x=y[0];if(d=f.pos+f.dp+f.size-x.pos-x.dp+x.size,.01<d&&f.pmin===x.pmin&&f.pmax===x.pmax){for(u=y.length-1;0<=u;u--)y[u].dp+=d;for(m.push.apply(m,y),l.splice(p+1,1),h=0,u=m.length-1;0<=u;u--)h+=m[u].dp;for(c=h/m.length,u=m.length-1;0<=u;u--)m[u].dp-=c;s=!1}else p++}l.forEach(o)}for(p=l.length-1;0<=p;p--){var b=l[p];for(u=b.length-1;0<=u;u--){var _=b[u],v=e[_.i];v.offset=_.dp,v.del=_.del}}}function l(e,t){e.each(function(e){var a=u.select(this);if(e.del)return void a.remove();var o="end"===e.anchor?-1:1,r=a.select("text.nums"),i={start:1,end:-1,middle:0}[e.anchor],n=i*(z+I),l=n+i*(e.txwidth+I),s=0,d=e.offset;"middle"===e.anchor&&(n-=e.tx2width/2,l+=e.txwidth/2+I),t&&(d*=-E,s=e.offset*L),a.select("path").attr("d","middle"===e.anchor?"M-"+(e.bx/2+e.tx2width/2)+","+(d-e.by/2)+"h"+e.bx+"v"+e.by+"h-"+e.bx+"Z":"M0,0L"+(o*z+s)+","+(z+d)+"v"+(e.by/2-z)+"h"+o*e.bx+"v-"+e.by+"H"+(o*z+s)+"V"+(d-z)+"Z"),r.call(y.positionText,n+s,d+e.ty0-e.by/2+I),e.tx2width&&(a.select("text.name").call(y.positionText,l+i*I+s,d+e.ty0-e.by/2+I),a.select("rect").call(x.setRect,l+(i-1)*e.tx2width/2+s,d-e.by/2-1,e.tx2width,e.by+2))})}function s(e,t){function a(t,a,o){var r=l(a,o);r&&(e[t]=r)}var o=e.index,r=e.trace||{},i=e.cd[0],n=e.cd[o]||{},l=Array.isArray(o)?function(e,t){return h.castOption(i,o,e)||h.extractOption({},r,"",t)}:function(e,t){return h.extractOption(n,r,e,t)};if(a("hoverinfo","hi","hoverinfo"),a("bgcolor","hbg","hoverlabel.bgcolor"),a("borderColor","hbc","hoverlabel.bordercolor"),a("fontFamily","htf","hoverlabel.font.family"),a("fontSize","hts","hoverlabel.font.size"),a("fontColor","htc","hoverlabel.font.color"),a("nameLength","hnl","hoverlabel.namelength"),e.posref="y"===t?e.xa._offset+(e.x0+e.x1)/2:e.ya._offset+(e.y0+e.y1)/2,e.x0=h.constrain(e.x0,0,e.xa._length),e.x1=h.constrain(e.x1,0,e.xa._length),e.y0=h.constrain(e.y0,0,e.ya._length),e.y1=h.constrain(e.y1,0,e.ya._length),void 0!==e.xLabelVal&&(e.xLabel="xLabel"in e?e.xLabel:v.hoverLabelText(e.xa,e.xLabelVal),e.xVal=e.xa.c2d(e.xLabelVal)),void 0!==e.yLabelVal&&(e.yLabel="yLabel"in e?e.yLabel:v.hoverLabelText(e.ya,e.yLabelVal),e.yVal=e.ya.c2d(e.yLabelVal)),void 0!==e.zLabelVal&&void 0===e.zLabel&&(e.zLabel=e.zLabelVal+""),!isNaN(e.xerr)&&!("log"===e.xa.type&&0>=e.xerr)){var s=v.tickText(e.xa,e.xa.c2l(e.xerr),"hover").text;e.xLabel+=void 0===e.xerrneg?" \xB1 "+s:" +"+s+" / -"+v.tickText(e.xa,e.xa.c2l(e.xerrneg),"hover").text,"x"===t&&(e.distance+=1)}if(!isNaN(e.yerr)&&!("log"===e.ya.type&&0>=e.yerr)){var d=v.tickText(e.ya,e.ya.c2l(e.yerr),"hover").text;e.yLabel+=void 0===e.yerrneg?" \xB1 "+d:" +"+d+" / -"+v.tickText(e.ya,e.ya.c2l(e.yerrneg),"hover").text,"y"===t&&(e.distance+=1)}var c=e.hoverinfo||e.trace.hoverinfo;return c&&"all"!==c&&(c=Array.isArray(c)?c:c.split("+"),-1===c.indexOf("x")&&(e.xLabel=void 0),-1===c.indexOf("y")&&(e.yLabel=void 0),-1===c.indexOf("z")&&(e.zLabel=void 0),-1===c.indexOf("text")&&(e.text=void 0),-1===c.indexOf("name")&&(e.name=void 0)),e}function d(e,t){var a=t.container,o=t.fullLayout,r=t.event,i=!!e.hLinePoint,n=!!e.vLinePoint,l,s;if(a.selectAll(".spikeline").remove(),!!(n||i)){var d=b.combine(o.plot_bgcolor,o.paper_bgcolor);if(i){var c=e.hLinePoint,p,u;l=c&&c.xa,s=c&&c.ya;var h=s.spikesnap;"cursor"===h?(p=r.pointerX,u=r.pointerY):(p=l._offset+c.x,u=s._offset+c.y);var m=1.5>g.readability(c.color,d)?b.contrast(d):c.color,y=s.spikemode,f=s.spikethickness,_=s.spikecolor||m,v=s._boundingBox,w=(v.left+v.right)/2<p?v.right:v.left,k,T;(-1!==y.indexOf("toaxis")||-1!==y.indexOf("across"))&&(-1!==y.indexOf("toaxis")&&(k=w,T=p),-1!==y.indexOf("across")&&(k=s._counterSpan[0],T=s._counterSpan[1]),a.insert("line",":first-child").attr({x1:k,x2:T,y1:u,y2:u,"stroke-width":f,stroke:_,"stroke-dasharray":x.dashStyle(s.spikedash,f)}).classed("spikeline",!0).classed("crisp",!0),a.insert("line",":first-child").attr({x1:k,x2:T,y1:u,y2:u,"stroke-width":f+2,stroke:d}).classed("spikeline",!0).classed("crisp",!0)),-1!==y.indexOf("marker")&&a.insert("circle",":first-child").attr({cx:w+("right"===s.side?-f:f),cy:u,r:f,fill:_}).classed("spikeline",!0)}if(n){var A=e.vLinePoint,S,C;l=A&&A.xa,s=A&&A.ya;var L=l.spikesnap;"cursor"===L?(S=r.pointerX,C=r.pointerY):(S=l._offset+A.x,C=s._offset+A.y);var E=1.5>g.readability(A.color,d)?b.contrast(d):A.color,z=l.spikemode,I=l.spikethickness,D=l.spikecolor||E,P=l._boundingBox,O=(P.top+P.bottom)/2<C?P.bottom:P.top,R,M;(-1!==z.indexOf("toaxis")||-1!==z.indexOf("across"))&&(-1!==z.indexOf("toaxis")&&(R=O,M=C),-1!==z.indexOf("across")&&(R=l._counterSpan[0],M=l._counterSpan[1]),a.insert("line",":first-child").attr({x1:S,x2:S,y1:R,y2:M,"stroke-width":I,stroke:D,"stroke-dasharray":x.dashStyle(l.spikedash,I)}).classed("spikeline",!0).classed("crisp",!0),a.insert("line",":first-child").attr({x1:S,x2:S,y1:R,y2:M,"stroke-width":I+2,stroke:d}).classed("spikeline",!0).classed("crisp",!0)),-1!==z.indexOf("marker")&&a.insert("circle",":first-child").attr({cx:S,cy:O-("top"===l.side?-I:I),r:I,fill:D}).classed("spikeline",!0)}}}function c(e,t,a){if(!a||a.length!==e._hoverdata.length)return!0;for(var o=a.length-1;0<=o;o--){var r=a[o],n=e._hoverdata[o];if(r.curveNumber!==n.curveNumber||r.pointNumber+""!==n.pointNumber+""||r.pointNumbers+""!==n.pointNumbers+"")return!0}return!1}function p(e,t){return!t||!(t.vLinePoint===e._spikepoints.vLinePoint&&t.hLinePoint===e._spikepoints.hLinePoint)}var u=e("d3"),i=e("fast-isnumeric"),g=e("tinycolor2"),h=e("../../lib"),m=e("../../lib/events"),y=e("../../lib/svg_text_utils"),f=e("../../lib/override_cursor"),x=e("../drawing"),b=e("../color"),_=e("../dragelement"),v=e("../../plots/cartesian/axes"),w=e("../../registry"),k=e("./helpers"),T=e("./constants"),A=T.YANGLE,S=Sa*A/180,C=1/M(S),L=te(S),E=M(S),z=T.HOVERARROWSIZE,I=T.HOVERTEXTPAD;a.hover=function(e,t,a,r){e=h.getGraphDiv(e),h.throttle(e._fullLayout._uid+T.HOVERID,T.HOVERMINTIME,function(){o(e,t,a,r)})},a.loneHover=function(e,t){var a={color:e.color||b.defaultLine,x0:e.x0||e.x||0,x1:e.x1||e.x||0,y0:e.y0||e.y||0,y1:e.y1||e.y||0,xLabel:e.xLabel,yLabel:e.yLabel,zLabel:e.zLabel,text:e.text,name:e.name,idealAlign:e.idealAlign,borderColor:e.borderColor,fontFamily:e.fontFamily,fontSize:e.fontSize,fontColor:e.fontColor,trace:e.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:e.hovertemplate||!1,eventData:e.eventData||!1,hovertemplateLabels:e.hovertemplateLabels||!1},o=u.select(t.container),i=t.outerContainer?u.select(t.outerContainer):o,n={hovermode:"closest",rotateLabels:!1,bgColor:t.bgColor||b.background,container:o,outerContainer:i},s=r([a],n,t.gd);return l(s,n.rotateLabels),s.node()},a.multiHovers=function(e,t){Array.isArray(e)||(e=[e]);var a=e.map(function(e){return{color:e.color||b.defaultLine,x0:e.x0||e.x||0,x1:e.x1||e.x||0,y0:e.y0||e.y||0,y1:e.y1||e.y||0,xLabel:e.xLabel,yLabel:e.yLabel,zLabel:e.zLabel,text:e.text,name:e.name,idealAlign:e.idealAlign,borderColor:e.borderColor,fontFamily:e.fontFamily,fontSize:e.fontSize,fontColor:e.fontColor,trace:e.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:e.hovertemplate||!1,eventData:e.eventData||!1,hovertemplateLabels:e.hovertemplateLabels||!1}}),o=u.select(t.container),i=t.outerContainer?u.select(t.outerContainer):o,n={hovermode:"closest",rotateLabels:!1,bgColor:t.bgColor||b.background,container:o,outerContainer:i},s=r(a,n,t.gd),c=5,p=0;return s.sort(function(e,t){return e.y0-t.y0}).each(function(e){var t=e.y0-e.by/2;e.offset=t-c<p?p-t+c:0,p=t+e.by+e.offset}),l(s,n.rotateLabels),s.node()};var D=/<extra>([\s\S]*)<\/extra>/},{"../../lib":692,"../../lib/events":681,"../../lib/override_cursor":703,"../../lib/svg_text_utils":716,"../../plots/cartesian/axes":740,"../../registry":823,"../color":569,"../dragelement":587,"../drawing":590,"./constants":602,"./helpers":604,d3:148,"fast-isnumeric":214,tinycolor2:513}],606:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t,o,r){r=r||{},o("hoverlabel.bgcolor",r.bgcolor),o("hoverlabel.bordercolor",r.bordercolor),o("hoverlabel.namelength",r.namelength),a.coerceFont(o,"hoverlabel.font",r.font)}},{"../../lib":692}],607:[function(e,t){"use strict";t.exports=function(e,t){e=e||{},t=t||{};var a=t.description?" "+t.description:"",o=t.keys||[];if(0<o.length){for(var r=[],n=0;n<o.length;n++)r[n]="`"+o[n]+"`";a+="Finally, the template string has access to ",a=1===o.length?"variable "+r[0]:"variables "+r.slice(0,-1).join(", ")+" and "+r.slice(-1)+"."}return{valType:"string",dflt:"",arrayOk:!0,editType:"none"}}},{}],608:[function(e,t){"use strict";var a=e("d3"),o=e("../../lib"),r=e("../dragelement"),i=e("./helpers"),n=e("./layout_attributes"),l=e("./hover");t.exports={moduleType:"component",name:"fx",constants:e("./constants"),schema:{layout:n},attributes:e("./attributes"),layoutAttributes:n,supplyLayoutGlobalDefaults:e("./layout_global_defaults"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),getDistanceFunction:i.getDistanceFunction,getClosest:i.getClosest,inbox:i.inbox,quadrature:i.quadrature,appendArrayPointValue:i.appendArrayPointValue,castHoverOption:function(e,t,a){return o.castOption(e,t,"hoverlabel."+a)},castHoverinfo:function(e,t,a){return o.castOption(e,a,"hoverinfo",function(a){return o.coerceHoverinfo({hoverinfo:a},{_module:e._module},t)})},hover:l.hover,unhover:r.unhover,loneHover:l.loneHover,multiHovers:l.multiHovers,loneUnhover:function(e){var t=o.isD3Selection(e)?e:a.select(e);t.selectAll("g.hovertext").remove(),t.selectAll(".spikeline").remove()},click:e("./click")}},{"../../lib":692,"../dragelement":587,"./attributes":599,"./calc":600,"./click":601,"./constants":602,"./defaults":603,"./helpers":604,"./hover":605,"./layout_attributes":609,"./layout_defaults":610,"./layout_global_defaults":611,d3:148}],609:[function(e,t){"use strict";var a=e("./constants"),o=e("../../plots/font_attributes")({editType:"none"});o.family.dflt=a.HOVERFONT,o.size.dflt=a.HOVERFONTSIZE,t.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1],editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:20,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:o,namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":767,"./constants":602}],610:[function(e,t){"use strict";function a(e){for(var t=!0,a=0,o;a<e.length;a++)if(o=e[a],"h"!==o.orientation){t=!1;break}return t}var o=e("../../lib"),r=e("./layout_attributes");t.exports=function(e,t,i){function n(a,i){return o.coerce(e,t,r,a,i)}var l=n("clickmode"),s=n("dragmode");"select"===s&&n("selectdirection");var d;t._has("cartesian")?-1<l.indexOf("select")?d="closest":(t._isHoriz=a(i),d=t._isHoriz?"y":"x"):d="closest";var c=n("hovermode",d);c&&(n("hoverdistance"),n("spikedistance"));var p=t._has("mapbox"),u=t._has("geo"),g=t._basePlotModules.length;"zoom"===t.dragmode&&((p||u)&&1===g||p&&u&&2===g)&&(t.dragmode="pan")}},{"../../lib":692,"./layout_attributes":609}],611:[function(e,t){"use strict";var a=e("../../lib"),o=e("./hoverlabel_defaults"),r=e("./layout_attributes");t.exports=function(e,t){o(e,t,function(o,i){return a.coerce(e,t,r,o,i)})}},{"../../lib":692,"./hoverlabel_defaults":606,"./layout_attributes":609}],612:[function(e,t){"use strict";function a(e,t,a){var o=t[a+"axes"],r=Object.keys((e._splomAxes||{})[a]||{});return Array.isArray(o)?o:r.length?r:void 0}function o(e,t,a,o,r,n){var l=t(e+"gap",a),s=t("domain."+e);t(e+"side",o);for(var d=Array(r),c=s[0],p=(s[1]-c)/(r-l),u=0,g;u<r;u++)g=c+p*u,d[n?r-1-u:u]=[g,g+p*(1-l)];return d}function r(e,t,a,o,r){function n(e,a){-1!==t.indexOf(a)&&o[a]===void 0?(l[e]=a,o[a]=e):l[e]=""}var l=Array(a),s;if(Array.isArray(e))for(s=0;s<a;s++)n(s,e[s]);else for(n(0,r),s=1;s<a;s++)n(s,r+(s+1));return l}var i=e("../../lib"),n=e("../../lib/regex").counter,l=e("../../plots/domain").attributes,s=e("../../plots/cartesian/constants").idRegex,d=e("../../plot_api/plot_template"),c={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[n("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[s.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[s.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:l({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};t.exports={moduleType:"component",name:"grid",schema:{layout:{grid:c}},layoutAttributes:c,sizeDefaults:function(e,t){function r(e,t){return i.coerce(n,f,c,e,t)}var n=e.grid||{},l=a(t,n,"x"),s=a(t,n,"y");if(e.grid||l||s){var p=Array.isArray(n.subplots)&&Array.isArray(n.subplots[0]),u=Array.isArray(l),g=Array.isArray(s),h=u&&l!==n.xaxes&&g&&s!==n.yaxes,m,y;p?(m=n.subplots.length,y=n.subplots[0].length):(g&&(m=s.length),u&&(y=l.length));var f=d.newContainer(t,"grid"),x=r("rows",m),b=r("columns",y);if(!(1<x*b))return void delete t.grid;if(!p&&!u&&!g){var _="independent"===r("pattern");_&&(p=!0)}f._hasSubplotGrid=p;var v=r("roworder"),w=p?.2:.1,k=p?.3:.1,T,A;h&&t._splomGridDflt&&(T=t._splomGridDflt.xside,A=t._splomGridDflt.yside),f._domains={x:o("x",r,w,T,b),y:o("y",r,k,A,x,"top to bottom"===v)}}},contentDefaults:function(e,t){var o=t.grid;if(o&&o._domains){var n=e.grid||{},l=t._subplots,s=o._hasSubplotGrid,d=o.rows,c=o.columns,p="independent"===o.pattern,u=o._axisMap={},g,h,m,y,f,x,b;if(s){var _=n.subplots||[];x=o.subplots=Array(d);var v=1;for(g=0;g<d;g++){var w=x[g]=Array(c),k=_[g]||[];for(h=0;h<c;h++)if(p?(f=1==v?"xy":"x"+v+"y"+v,v++):f=k[h],w[h]="",-1!==l.cartesian.indexOf(f)){if(b=f.indexOf("y"),m=f.slice(0,b),y=f.slice(b),void 0!==u[m]&&u[m]!==h||void 0!==u[y]&&u[y]!==g)continue;w[h]=f,u[m]=h,u[y]=g}}}else{var T=a(t,n,"x"),A=a(t,n,"y");o.xaxes=r(T,l.xaxis,c,u,"x"),o.yaxes=r(A,l.yaxis,d,u,"y")}var S=o._anchors={},C="top to bottom"===o.roworder;for(var L in u){var E=L.charAt(0),z=o[E+"side"],I,D,P;if(8>z.length)S[L]="free";else if("x"===E){if("t"===z.charAt(0)===C?(I=0,D=1,P=d):(I=d-1,D=-1,P=-1),s){var O=u[L];for(g=I;g!==P;g+=D)if(f=x[g][O],f&&(b=f.indexOf("y"),f.slice(0,b)===L)){S[L]=f.slice(b);break}}else for(g=I;g!==P;g+=D)if(y=o.yaxes[g],-1!==l.cartesian.indexOf(L+y)){S[L]=y;break}}else if("l"===z.charAt(0)?(I=0,D=1,P=c):(I=c-1,D=-1,P=-1),s){var R=u[L];for(g=I;g!==P;g+=D)if(f=x[R][g],f&&(b=f.indexOf("y"),f.slice(b)===L)){S[L]=f.slice(0,b);break}}else for(g=I;g!==P;g+=D)if(m=o.xaxes[g],-1!==l.cartesian.indexOf(m+L)){S[L]=m;break}}}}}},{"../../lib":692,"../../lib/regex":708,"../../plot_api/plot_template":730,"../../plots/cartesian/constants":746,"../../plots/domain":766}],613:[function(e,t){"use strict";var a=e("../../plots/cartesian/constants"),o=e("../../plot_api/plot_template").templatedArray;t.exports=o("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",a.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",a.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../plot_api/plot_template":730,"../../plots/cartesian/constants":746}],614:[function(e,t){"use strict";var a=e("fast-isnumeric"),o=e("../../lib/to_log_range");t.exports=function(e,t,r,n){t=t||{};var l="log"===r&&"linear"===t.type,s="linear"===r&&"log"===t.type;if(l||s)for(var d=e._fullLayout.images,c=t._id.charAt(0),p=0,u,g;p<d.length;p++)if(u=d[p],g="images["+p+"].",u[c+"ref"]===t._id){var h=u[c],m=u["size"+c],y=null,f=null;if(l){y=o(h,t.range);var x=m/_a(10,y)/2;f=2*P(x+re(1+x*x))/z}else y=_a(10,h),f=y*(_a(10,m/2)-_a(10,-m/2));a(y)?!a(f)&&(f=null):(y=null,f=null),n(g+c,y),n(g+"size"+c,f)}}},{"../../lib/to_log_range":718,"fast-isnumeric":214}],615:[function(e,t){"use strict";function a(e,t,a){function l(a,r){return o.coerce(e,t,n,a,r)}var s=l("source"),d=l("visible",!!s);if(!d)return t;l("layer"),l("xanchor"),l("yanchor"),l("sizex"),l("sizey"),l("sizing"),l("opacity");for(var c={_fullLayout:a},p=["x","y"],u=0;2>u;u++){var g=p[u],h=r.coerceRef(e,t,c,g,"paper");r.coercePosition(t,c,l,h,g,0)}return t}var o=e("../../lib"),r=e("../../plots/cartesian/axes"),i=e("../../plots/array_container_defaults"),n=e("./attributes");t.exports=function(e,t){i(e,t,{name:"images",handleItemDefaults:a})}},{"../../lib":692,"../../plots/array_container_defaults":736,"../../plots/cartesian/axes":740,"./attributes":613}],616:[function(e,t){"use strict";var a=e("d3"),o=e("../drawing"),r=e("../../plots/cartesian/axes"),i=e("../../constants/xmlns_namespaces");t.exports=function(e){function t(t){var o=a.select(this);if(!(this.img&&this.img.src===t.source)){o.attr("xmlns",i.svg);var r=new Promise(function(e){function a(){o.remove(),e()}var r=new Image;this.img=r,r.setAttribute("crossOrigin","anonymous"),r.onerror=a,r.onload=function(){var t=document.createElement("canvas");t.width=this.width,t.height=this.height;var a=t.getContext("2d");a.drawImage(this,0,0);var r=t.toDataURL("image/png");o.attr("xlink:href",r),e()},o.on("error",a),r.src=t.source}.bind(this));e._promises.push(r)}}function n(t){var i=a.select(this),n=r.getFromId(e,t.xref),s=r.getFromId(e,t.yref),d=l._size,c=n?wa(n.l2p(t.sizex)-n.l2p(0)):t.sizex*d.w,p=s?wa(s.l2p(t.sizey)-s.l2p(0)):t.sizey*d.h,u=c*m.x[t.xanchor].offset,g=p*m.y[t.yanchor].offset,h=m.x[t.xanchor].sizing+m.y[t.yanchor].sizing,y=(n?n.r2p(t.x)+n._offset:t.x*d.w+d.l)+u,f=(s?s.r2p(t.y)+s._offset:d.h-t.y*d.h+d.t)+g;switch(t.sizing){case"fill":h+=" slice";break;case"stretch":h="none";}i.attr({x:y,y:f,width:c,height:p,preserveAspectRatio:h,opacity:t.opacity});var x=n?n._id:"",b=s?s._id:"",_=x+b;o.setClipUrl(i,_?"clip"+l._uid+_:null,e)}var l=e._fullLayout,s=[],d={},c=[],p,u;for(u=0;u<l.images.length;u++){var g=l.images[u];if(g.visible)if("below"===g.layer&&"paper"!==g.xref&&"paper"!==g.yref){p=g.xref+g.yref;var h=l._plots[p];if(!h){c.push(g);continue}h.mainplot&&(p=h.mainplot.id),d[p]||(d[p]=[]),d[p].push(g)}else"above"===g.layer?s.push(g):c.push(g)}var m={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}},y=l._imageLowerLayer.selectAll("image").data(c),f=l._imageUpperLayer.selectAll("image").data(s);y.enter().append("image"),f.enter().append("image"),y.exit().remove(),f.exit().remove(),y.each(function(e){t.bind(this)(e),n.bind(this)(e)}),f.each(function(e){t.bind(this)(e),n.bind(this)(e)});var x=Object.keys(l._plots);for(u=0;u<x.length;u++){p=x[u];var b=l._plots[p];if(b.imagelayer){var _=b.imagelayer.selectAll("image").data(d[p]||[]);_.enter().append("image"),_.exit().remove(),_.each(function(e){t.bind(this)(e),n.bind(this)(e)})}}}},{"../../constants/xmlns_namespaces":670,"../../plots/cartesian/axes":740,"../drawing":590,d3:148}],617:[function(e,t){"use strict";t.exports={moduleType:"component",name:"images",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("images"),draw:e("./draw"),convertCoords:e("./convert_coords")}},{"../../plots/cartesian/include_components":751,"./attributes":613,"./convert_coords":614,"./defaults":615,"./draw":616}],618:[function(e,t){"use strict";var a=e("../../plots/font_attributes"),o=e("../color/attributes");t.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:o.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:a({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},x:{valType:"number",min:-2,max:3,dflt:1.02,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,dflt:1,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":767,"../color/attributes":568}],619:[function(e,t){"use strict";t.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,textOffsetX:40}},{}],620:[function(e,t){"use strict";var a=e("../../registry"),o=e("../../lib"),r=e("../../plot_api/plot_template"),i=e("./attributes"),n=e("../../plots/layout_attributes"),l=e("./helpers");t.exports=function(e,t,s){function d(e,t){return o.coerce(c,v,i,e,t)}for(var c=e.legend||{},p=0,u=!1,g="normal",h=0,m,y,f,x,b;h<s.length;h++)b=s[h],b.visible&&((b.showlegend||b._dfltShowLegend)&&(p++,b.showlegend&&(u=!0,(a.traceIs(b,"pie")||!0===b._input.showlegend)&&p++)),(a.traceIs(b,"bar")&&"stack"===t.barmode||-1!==["tonextx","tonexty"].indexOf(b.fill))&&(g=l.isGrouped({traceorder:g})?"grouped+reversed":"reversed"),void 0!==b.legendgroup&&""!==b.legendgroup&&(g=l.isReversed({traceorder:g})?"reversed+grouped":"grouped"));var _=o.coerce(e,t,n,"showlegend",u&&1<p);if(!1!==_||c.uirevision){var v=r.newContainer(t,"legend");if(d("uirevision",t.uirevision),!1!==_){if(d("bgcolor",t.paper_bgcolor),d("bordercolor"),d("borderwidth"),o.coerceFont(d,"font",t.font),d("orientation"),"h"===v.orientation){var w=e.xaxis;a.getComponentMethod("rangeslider","isVisible")(w)?(m=0,f="left",y=1.1,x="bottom"):(m=0,f="left",y=-.1,x="top")}d("traceorder",g),l.isGrouped(t.legend)&&d("tracegroupgap"),d("x",m),d("xanchor",f),d("y",y),d("yanchor",x),d("valign"),o.noneOrAll(c,v,["x","y"])}}}},{"../../lib":692,"../../plot_api/plot_template":730,"../../plots/layout_attributes":795,"../../registry":823,"./attributes":618,"./helpers":624}],621:[function(e,t){"use strict";function a(e,t,a,o,r){var i=a.data()[0][0].trace,n={event:r,node:a.node(),curveNumber:i.index,expandedIndex:i._expandedIndex,data:e.data,layout:e.layout,frames:e._transitionData._frames,config:e._context,fullData:e._fullData,fullLayout:e._fullLayout};i._group&&(n.group=i._group),"pie"===i.type&&(n.label=a.datum()[0].label);var l=m.triggerHandler(e,"plotly_legendclick",n);if(!1!==l)if(1===o)t._clickTimeout=setTimeout(function(){_(a,e,o)},z);else if(2===o){t._clickTimeout&&clearTimeout(t._clickTimeout),e._legendMouseDownTime=0;var s=m.triggerHandler(e,"plotly_legenddoubleclick",n);!1!==s&&_(a,e,o)}}function o(e,t,a){function o(a){b.convertToTspans(a,t,function(){n(e,t)})}var i=e.data()[0][0],l=t._fullLayout,s=i.trace,d=h.traceIs(s,"pie"),c=s.index,u=d?i.label:s.name,g=t._context.edits.legendText&&!d,m=p.ensureSingle(e,"text","legendtext");m.attr("text-anchor","start").classed("user-select-none",!0).call(f.font,l.legend.font).text(g?r(u,a):u),b.positionText(m,v.textOffsetX,0),g?m.call(b.makeEditable,{gd:t,text:u}).call(o).on("edit",function(e){this.text(r(e,a)).call(o);var n=i.trace._fullInput||{},l={};if(h.hasTransform(n,"groupby")){var s=h.getTransformIndices(n,"groupby"),d=s[s.length-1],u=p.keyedContainer(n,"transforms["+d+"].styles","target","value.name");u.set(i.trace._group,e),l=u.constructUpdate()}else l.name=e;return h.call("_guiRestyle",t,l,c)}):o(m)}function r(e,t){var a=va(4,t);if(e&&e.trim().length>=a/2)return e;e=e||"";for(var o=a-e.length;0<o;o--)e+=" ";return e}function i(e,t){var o=1,r=p.ensureSingle(e,"rect","legendtoggle",function(e){e.style("cursor","pointer").attr("pointer-events","all").call(x.fill,"rgba(0,0,0,0)")}),i;r.on("mousedown",function(){i=new Date().getTime(),i-t._legendMouseDownTime<z?o+=1:(o=1,t._legendMouseDownTime=i)}),r.on("mouseup",function(){if(!(t._dragged||t._editing)){var r=t._fullLayout.legend;new Date().getTime()-t._legendMouseDownTime>z&&(o=va(o-1,1)),a(t,r,e,o,c.event)}})}function n(e,t){var a=e.data()[0][0];if(!a.trace.showlegend)return void e.remove();var o=e.select("g[class*=math-group]"),r=o.node(),i=t._fullLayout.legend,n=i.font.size*T,l,s;if(r){var d=f.bBox(r);l=d.height,s=d.width,f.setTranslate(o,0,l/4)}else{var c=e.select(".legendtext"),p=b.lineCount(c),u=c.node();l=n*p,s=u?f.bBox(u).width:0;b.positionText(c,v.textOffsetX,n*(.3+(1-p)/2)),a.lineHeight=n}l=va(l,16)+3,a.height=l,a.width=s}function l(e,t,a){var o=e._fullLayout,r=o.legend,l=r.borderwidth,s=E.isGrouped(r),p=0;if(r._width=0,r._height=0,E.isVertical(r))s&&t.each(function(e,t){f.setTranslate(this,0,t*r.tracegroupgap)}),a.each(function(e){var t=e[0],a=t.height,o=t.width;f.setTranslate(this,l,5+l+r._height+a/2),r._height+=a,r._width=va(r._width,o)}),r._width+=45+2*l,r._height+=10+2*l,s&&(r._height+=(r._lgroupsLength-1)*r.tracegroupgap),p=40;else if(s){for(var u=[r._width],g=t.data(),h=0,d=g.length;h<d;h++){var n=g[h].map(function(e){return e[0].width}),m=40+va.apply(null,n);r._width+=r.tracegroupgap+m,u.push(r._width)}t.each(function(e,t){f.setTranslate(this,u[t],0)}),t.each(function(){var e=c.select(this),t=e.selectAll("g.traces"),a=0;t.each(function(e){var t=e[0],o=t.height;f.setTranslate(this,0,5+l+a+o/2),a+=o}),r._height=va(r._height,a)}),r._height+=10+2*l,r._width+=2*l}else{var y=0,x=0,b=0,_=0,v=0,w=r.tracegroupgap||5,k;a.each(function(e){b=va(40+e[0].width,b),v+=40+e[0].width+w}),k=o._size.w>l+v-w,a.each(function(e){var t=e[0],a=k?40+e[0].width:b;l+_+w+a>o._size.w&&(_=0,y+=x,r._height+=x,x=0),f.setTranslate(this,l+_,5+l+t.height/2+y),r._width+=w+a,r._height=va(r._height,t.height),_+=w+a,x=va(t.height,x)}),r._width+=2*l,r._height+=10+2*l}r._width=ae(r._width),r._height=ae(r._height);var T=e._context.edits.legendText||e._context.edits.legendPosition;a.each(function(e){var t=e[0],a=c.select(this).select(".legendtoggle");f.setRect(a,0,-t.height/2,(T?0:r._width)+p,t.height)})}function s(e){var t=e._fullLayout,a=t.legend,o="left";p.isRightAnchor(a)?o="right":p.isCenterAnchor(a)&&(o="center");var r="top";p.isBottomAnchor(a)?r="bottom":p.isMiddleAnchor(a)&&(r="middle"),u.autoMargin(e,"legend",{x:a.x,y:a.y,l:a._width*A[o],r:a._width*S[o],b:a._height*S[r],t:a._height*A[r]})}function d(e){var t=e._fullLayout,a=t.legend,o="left";p.isRightAnchor(a)?o="right":p.isCenterAnchor(a)&&(o="center"),u.autoMargin(e,"legend",{x:a.x,y:.5,l:a._width*A[o],r:a._width*S[o],b:0,t:0})}var c=e("d3"),p=e("../../lib"),u=e("../../plots/plots"),h=e("../../registry"),m=e("../../lib/events"),y=e("../dragelement"),f=e("../drawing"),x=e("../color"),b=e("../../lib/svg_text_utils"),_=e("./handle_click"),v=e("./constants"),w=e("../../constants/interactions"),k=e("../../constants/alignment"),T=k.LINE_SPACING,A=k.FROM_TL,S=k.FROM_BR,C=e("./get_legend_data"),L=e("./style"),E=e("./helpers"),z=w.DBLCLICKDELAY;t.exports=function(t){var r=t._fullLayout,n="legend"+r._uid;if(r._infolayer&&t.calcdata){t._legendMouseDownTime||(t._legendMouseDownTime=0);var g=r.legend,m=r.showlegend&&C(t.calcdata,g),b=r.hiddenlabels||[];if(!r.showlegend||!m.length)return r._infolayer.selectAll(".legend").remove(),r._topdefs.select("#"+n).remove(),void u.autoMargin(t,"legend");for(var _=0,w=0;w<m.length;w++)for(var e=0;e<m[w].length;e++){var k=m[w][e][0],T=k.trace,A=h.traceIs(T,"pie"),S=A?k.label:T.name;_=va(_,S&&S.length||0)}var E=!1,z=p.ensureSingle(r._infolayer,"g","legend",function(e){e.attr("pointer-events","all"),E=!0}),I=p.ensureSingleById(r._topdefs,"clipPath",n,function(e){e.append("rect")}),D=p.ensureSingle(z,"rect","bg",function(e){e.attr("shape-rendering","crispEdges")});D.call(x.stroke,g.bordercolor).call(x.fill,g.bgcolor).style("stroke-width",g.borderwidth+"px");var P=p.ensureSingle(z,"g","scrollbox"),O=p.ensureSingle(z,"rect","scrollbar",function(e){e.attr({rx:20,ry:3,width:0,height:0}).call(x.fill,"#808BA4")}),R=P.selectAll("g.groups").data(m);R.enter().append("g").attr("class","groups"),R.exit().remove();var M=R.selectAll("g.traces").data(p.identity);M.enter().append("g").attr("class","traces"),M.exit().remove(),M.call(L,t).style("opacity",function(e){var t=e[0].trace;return h.traceIs(t,"pie")?-1===b.indexOf(e[0].label)?1:.5:"legendonly"===t.visible?.5:1}).each(function(){c.select(this).call(o,t,_).call(i,t)}),p.syncOrAsync([u.previousPromises,function(){function o(e,a,o){g._scrollY=t._fullLayout.legend._scrollY=e,f.setTranslate(P,0,-e),f.setRect(O,b,v.scrollBarMargin+e*o,v.scrollBarWidth,a),I.select("rect").attr({y:g.borderwidth+e})}E&&(l(t,R,M),s(t));var i=r.width,u=r.height;l(t,R,M),g._height>u?d(t):s(t);var m=r._size,e=m.l+m.w*g.x,x=m.t+m.h*(1-g.y);p.isRightAnchor(g)?e-=g._width:p.isCenterAnchor(g)&&(e-=g._width/2),p.isBottomAnchor(g)?x-=g._height:p.isMiddleAnchor(g)&&(x-=g._height/2);var b=g._width,_=m.w;b>_?(e=m.l,b=_):(e+b>i&&(e=i-b),0>e&&(e=0),b=ie(i-e,g._width));var w=g._height,k=m.h;if(w>k?(x=m.t,w=k):(x+w>u&&(x=u-w),0>x&&(x=0),w=ie(u-x,g._height)),f.setTranslate(z,e,x),O.on(".drag",null),z.on("wheel",null),g._height<=w||t._context.staticPlot)D.attr({width:b-g.borderwidth,height:w-g.borderwidth,x:g.borderwidth/2,y:g.borderwidth/2}),f.setTranslate(P,0,0),I.select("rect").attr({width:b-2*g.borderwidth,height:w-2*g.borderwidth,x:g.borderwidth,y:g.borderwidth}),f.setClipUrl(P,n,t),f.setRect(O,0,0,0,0),delete g._scrollY;else{var T=va(v.scrollBarMinHeight,w*w/g._height),A=w-T-2*v.scrollBarMargin,S=g._height-w,C=A/S,L=ie(g._scrollY||0,S);D.attr({width:b-2*g.borderwidth+v.scrollBarWidth+v.scrollBarMargin,height:w-g.borderwidth,x:g.borderwidth/2,y:g.borderwidth/2}),I.select("rect").attr({width:b-2*g.borderwidth+v.scrollBarWidth+v.scrollBarMargin,height:w-2*g.borderwidth,x:g.borderwidth,y:g.borderwidth+L}),f.setClipUrl(P,n,t),o(L,T,C),z.on("wheel",function(){L=p.constrain(g._scrollY+c.event.deltaY/A*S,0,S),o(L,T,C),0!==L&&L!==S&&c.event.preventDefault()});var j=c.behavior.drag().on("dragstart",function(){B=c.event.sourceEvent.clientY,F=L}).on("drag",function(){var t=c.event.sourceEvent;2===t.buttons||t.ctrlKey||(L=p.constrain((t.clientY-B)/C+F,0,S),o(L,T,C))}),B,F;O.call(j)}if(t._context.edits.legendPosition){var N,V,U,H;z.classed("cursor-move",!0),y.init({element:z.node(),gd:t,prepFn:function(){var e=f.getTranslate(z);U=e.x,H=e.y},moveFn:function(e,t){var a=U+e,o=H+t;f.setTranslate(z,a,o),N=y.align(a,0,m.l,m.l+m.w,g.xanchor),V=y.align(o,0,m.t+m.h,m.t,g.yanchor)},doneFn:function(){void 0!==N&&void 0!==V&&h.call("_guiRelayout",t,{"legend.x":N,"legend.y":V})},clickFn:function(o,i){var e=r._infolayer.selectAll("g.traces").filter(function(){var e=this.getBoundingClientRect();return i.clientX>=e.left&&i.clientX<=e.right&&i.clientY>=e.top&&i.clientY<=e.bottom});0<e.size()&&a(t,z,e,o,i)}})}}],t)}}},{"../../constants/alignment":664,"../../constants/interactions":668,"../../lib":692,"../../lib/events":681,"../../lib/svg_text_utils":716,"../../plots/plots":804,"../../registry":823,"../color":569,"../dragelement":587,"../drawing":590,"./constants":619,"./get_legend_data":622,"./handle_click":623,"./helpers":624,"./style":626,d3:148}],622:[function(e,t){"use strict";var a=e("../../registry"),o=e("./helpers");t.exports=function(e,t){function r(e,a){if(""===e||!o.isGrouped(t)){var r="~~i"+c;l.push(r),n[r]=[[a]],c++}else-1===l.indexOf(e)?(l.push(e),s=!0,n[e]=[[a]]):n[e].push([a])}var n={},l=[],s=!1,d={},c=0,p,u;for(p=0;p<e.length;p++){var g=e[p],h=g[0],m=h.trace,y=m.legendgroup;if(m.visible&&m.showlegend)if(a.traceIs(m,"pie"))for(d[y]||(d[y]={}),u=0;u<g.length;u++){var f=g[u].label;d[y][f]||(r(y,{label:f,color:g[u].color,i:g[u].i,trace:m,pts:g[u].pts}),d[y][f]=!0)}else r(y,h)}if(!l.length)return[];var x=l.length,b,_;if(s&&o.isGrouped(t))for(_=Array(x),p=0;p<x;p++)b=n[l[p]],_[p]=o.isReversed(t)?b.reverse():b;else{for(_=[Array(x)],p=0;p<x;p++)b=n[l[p]][0],_[0][o.isReversed(t)?x-p-1:p]=b;x=1}return t._lgroupsLength=x,_}},{"../../registry":823,"./helpers":624}],623:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../registry"),r=!0;t.exports=function(e,t,n){function l(e,t,a){var o=y.indexOf(e),r=m[t];return r||(r=m[t]=[]),-1===y.indexOf(e)&&(y.push(e),o=y.length-1),r[o]=a,o}function s(e,t){var r=e._fullInput;if(o.hasTransform(r,"groupby")){var i=f[r.index];if(!i){var n=o.getTransformIndices(r,"groupby"),s=n[n.length-1];i=a.keyedContainer(r,"transforms["+s+"].styles","target","value.visible"),f[r.index]=i}var d=i.get(e._group);void 0===d&&(d=!0),!1!==d&&i.set(e._group,t),x[r.index]=l(r.index,"visible",!1!==r.visible)}else{var c=!1!==r.visible&&t;l(r.index,"visible",c)}}if(!(t._dragged||t._editing)){var c=t._fullLayout.hiddenlabels?t._fullLayout.hiddenlabels.slice():[],p=e.data()[0][0],u=t._fullData,g=p.trace,h=g.legendgroup,m={},y=[],f=[],x=[],b,d,_,v,w,k;if(1===n&&r&&t.data&&t._context.showTips?(a.notifier(a._(t,"Double-click on legend to isolate one trace"),"long"),r=!1):r=!1,o.traceIs(g,"pie")){var T=p.label,A=c.indexOf(T);1===n?-1===A?c.push(T):c.splice(A,1):2==n&&(c=[],t.calcdata[0].forEach(function(e){T!==e.label&&c.push(e.label)}),t._fullLayout.hiddenlabels&&t._fullLayout.hiddenlabels.length===c.length&&-1===A&&(c=[])),o.call("_guiRelayout",t,"hiddenlabels",c)}else{var S=h&&h.length,C=[],L;if(S)for(b=0;b<u.length;b++)L=u[b],L.visible&&L.legendgroup===h&&C.push(b);if(1===n){var E;switch(g.visible){case!0:E="legendonly";break;case!1:E=!1;break;case"legendonly":E=!0;}if(S)for(b=0;b<u.length;b++)!1!==u[b].visible&&u[b].legendgroup===h&&s(u[b],E);else s(g,E)}else if(2===n){var z=!0,I,D,P;for(b=0;b<u.length;b++)if(I=u[b]===g,!I&&(D=S&&u[b].legendgroup===h,!D&&!0===u[b].visible&&!o.traceIs(u[b],"notLegendIsolatable"))){z=!1;break}for(b=0;b<u.length;b++)if(!1!==u[b].visible){if(o.traceIs(u[b],"notLegendIsolatable"))continue;switch(g.visible){case"legendonly":s(u[b],!0);break;case!0:P=!!z||"legendonly",I=u[b]===g,D=I||S&&u[b].legendgroup===h,s(u[b],!!D||P);}}}for(b=0;b<f.length;b++)if(_=f[b],_){var O=_.constructUpdate(),R=Object.keys(O);for(d=0;d<R.length;d++)v=R[d],k=m[v]=m[v]||[],k[x[b]]=O[v]}for(w=Object.keys(m),b=0;b<w.length;b++)for(v=w[b],d=0;d<y.length;d++)m[v].hasOwnProperty(d)||(m[v][d]=void 0);o.call("_guiRestyle",t,m,y)}}}},{"../../lib":692,"../../registry":823}],624:[function(e,t,a){"use strict";a.isGrouped=function(e){return-1!==(e.traceorder||"").indexOf("grouped")},a.isVertical=function(e){return"h"!==e.orientation},a.isReversed=function(e){return-1!==(e.traceorder||"").indexOf("reversed")}},{}],625:[function(e,t){"use strict";t.exports={moduleType:"component",name:"legend",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),draw:e("./draw"),style:e("./style")}},{"./attributes":618,"./defaults":620,"./draw":621,"./style":626}],626:[function(e,t){"use strict";var a=e("d3"),o=e("../../registry"),r=e("../../lib"),n=e("../drawing"),l=e("../color"),s=e("../../traces/scatter/subtypes"),c=e("../../traces/pie/style_one");t.exports=function(e,t){e.each(function(e){var o=a.select(this),i=r.ensureSingle(o,"g","layers");i.style("opacity",e[0].trace.opacity);var n=t._fullLayout.legend.valign,l=e[0].lineHeight,s=e[0].height;if("middle"===n||!l||!s)i.attr("transform",null);else{var d={top:1,bottom:-1}[n];i.attr("transform","translate(0,"+d*(.5*(l-s+3))+")")}var c=i.selectAll("g.legendfill").data([e]);c.enter().append("g").classed("legendfill",!0);var p=i.selectAll("g.legendlines").data([e]);p.enter().append("g").classed("legendlines",!0);var u=i.selectAll("g.legendsymbols").data([e]);u.enter().append("g").classed("legendsymbols",!0),u.selectAll("g.legendpoints").data([e]).enter().append("g").classed("legendpoints",!0)}).each(function(e){var t=e[0].trace,r=t.marker||{},i=r.line||{},n=a.select(this).select("g.legendpoints").selectAll("path.legendbar").data(o.traceIs(t,"bar")?[e]:[]);n.enter().append("path").classed("legendbar",!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),n.exit().remove(),n.each(function(e){var t=a.select(this),o=e[0],n=(o.mlw+1||i.width+1)-1;t.style("stroke-width",n+"px").call(l.fill,o.mc||r.color),n&&t.call(l.stroke,o.mlc||i.color)})}).each(function(e){var t=e[0].trace,r=a.select(this).select("g.legendpoints").selectAll("path.legendbox").data(o.traceIs(t,"box-violin")&&t.visible?[e]:[]);r.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),r.exit().remove(),r.each(function(){var e=t.line.width,o=a.select(this);o.style("stroke-width",e+"px").call(l.fill,t.fillcolor),e&&l.stroke(o,t.line.color)})}).each(function(e){var t=e[0].trace,r=a.select(this).select("g.legendpoints").selectAll("path.legendpie").data(o.traceIs(t,"pie")&&t.visible?[e]:[]);r.enter().append("path").classed("legendpie",!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),r.exit().remove(),r.size()&&r.call(c,e[0],t)}).each(function(e){var o=e[0].trace,r=o.visible&&o.fill&&"none"!==o.fill,i=s.hasLines(o),l=o.contours,d=!1,c=!1;if(l){var p=l.coloring;"lines"===p?d=!0:i="none"===p||"heatmap"===p||l.showlines,"constraint"===l.type?r="="!==l._operation:("fill"===p||"heatmap"===p)&&(c=!0)}var u=s.hasMarkers(o)||s.hasText(o),g=r||c,h=i||d,m=u||!g?"M5,0":h?"M5,-2":"M5,-3",y=a.select(this),f=y.select(".legendfill").selectAll("path").data(r||c?[e]:[]);f.enter().append("path").classed("js-fill",!0),f.exit().remove(),f.attr("d",m+"h30v6h-30z").call(r?n.fillGroupStyle:function(e){if(e.size()){var a="legendfill-"+o.uid;n.gradient(e,t,a,"horizontalreversed",o.colorscale,"fill")}});var x=y.select(".legendlines").selectAll("path").data(i||d?[e]:[]);x.enter().append("path").classed("js-line",!0),x.exit().remove(),x.attr("d",m+(d?"l30,0.0001":"h30")).call(i?n.lineGroupStyle:function(e){if(e.size()){var a="legendline-"+o.uid;n.lineGroupStyle(e),n.gradient(e,t,a,"horizontalreversed",o.colorscale,"stroke")}})}).each(function(e){function o(e,t,a){var o=r.nestedProperty(d,e).get(),i=r.isArrayOrTypedArray(o)&&t?t(o):o;if(a){if(i<a[0])return a[0];if(i>a[1])return a[1]}return i}function i(e){return e[0]}var l=e[0],d=l.trace,c=s.hasMarkers(d),p=s.hasText(d),u=s.hasLines(d),g,h;if(c||p||u){var m={},y={};if(c){m.mc=o("marker.color",i),m.mx=o("marker.symbol",i),m.mo=o("marker.opacity",r.mean,[.2,1]),m.mlc=o("marker.line.color",i),m.mlw=o("marker.line.width",r.mean,[0,5]),y.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var f=o("marker.size",r.mean,[2,16]);m.ms=f,y.marker.size=f}u&&(y.line={width:o("line.width",i,[0,10])}),p&&(m.tx="Aa",m.tp=o("textposition",i),m.ts=10,m.tc=o("textfont.color",i),m.tf=o("textfont.family",i)),g=[r.minExtend(l,m)],h=r.minExtend(d,y),h.selectedpoints=null}var x=a.select(this).select("g.legendpoints"),b=x.selectAll("path.scatterpts").data(c?g:[]);b.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform","translate(20,0)"),b.exit().remove(),b.call(n.pointStyle,h,t),c&&(g[0].mrc=3);var _=x.selectAll("g.pointtext").data(p?g:[]);_.enter().append("g").classed("pointtext",!0).append("text").attr("transform","translate(20,0)"),_.exit().remove(),_.selectAll("text").call(n.textPointStyle,h,t)}).each(function(e){var t=e[0].trace,o=a.select(this).select("g.legendpoints").selectAll("path.legendcandle").data("candlestick"===t.type&&t.visible?[e,e]:[]);o.enter().append("path").classed("legendcandle",!0).attr("d",function(e,t){return t?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform","translate(20,0)").style("stroke-miterlimit",1),o.exit().remove(),o.each(function(e,o){var r=t[o?"increasing":"decreasing"],i=r.line.width,n=a.select(this);n.style("stroke-width",i+"px").call(l.fill,r.fillcolor),i&&l.stroke(n,r.line.color)})}).each(function(e){var t=e[0].trace,o=a.select(this).select("g.legendpoints").selectAll("path.legendohlc").data("ohlc"===t.type&&t.visible?[e,e]:[]);o.enter().append("path").classed("legendohlc",!0).attr("d",function(e,t){return t?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform","translate(20,0)").style("stroke-miterlimit",1),o.exit().remove(),o.each(function(e,o){var r=t[o?"increasing":"decreasing"],i=r.line.width,s=a.select(this);s.style("fill","none").call(n.dashLine,r.line.dash,i),i&&l.stroke(s,r.line.color)})})}},{"../../lib":692,"../../registry":823,"../../traces/pie/style_one":1026,"../../traces/scatter/subtypes":1064,"../color":569,"../drawing":590,d3:148}],627:[function(e,t){"use strict";function a(e,t){var a=t.currentTarget,o=a.getAttribute("data-attr"),r=a.getAttribute("data-val")||!0,n=e._fullLayout,l={},s=g.list(e,null,!0),d="on",c,u;if("zoom"===o){var h="in"===r?.5:2,m=(1+h)/2,y=(1-h)/2,f;for(u=0;u<s.length;u++)if(c=s[u],!c.fixedrange)if(f=c._name,"auto"===r)l[f+".autorange"]=!0;else if("reset"===r){if(void 0===c._rangeInitial)l[f+".autorange"]=!0;else{var x=c._rangeInitial.slice();l[f+".range[0]"]=x[0],l[f+".range[1]"]=x[1]}void 0!==c._showSpikeInitial&&(l[f+".showspikes"]=c._showSpikeInitial,"on"===d&&!c._showSpikeInitial&&(d="off"))}else{var b=[c.r2l(c.range[0]),c.r2l(c.range[1])],_=[m*b[0]+y*b[1],m*b[1]+y*b[0]];l[f+".range[0]"]=c.l2r(_[0]),l[f+".range[1]"]=c.l2r(_[1])}n._cartesianSpikesEnabled=d}else{if("hovermode"===o&&("x"===r||"y"===r))r=n._isHoriz?"y":"x",a.setAttribute("data-val",r);else if("hovermode"===o&&"closest"===r){for(u=0;u<s.length;u++)c=s[u],"on"!==d||c.showspikes||(d="off");n._cartesianSpikesEnabled=d}l[o]=r}p.call("_guiRelayout",e,l)}function o(e,t){for(var a=t.currentTarget,o=a.getAttribute("data-attr"),r=a.getAttribute("data-val")||!0,n=e._fullLayout._subplots.gl3d,l={},s=o.split("."),d=0;d<n.length;d++)l[n[d]+"."+s[1]]=r;var c="pan"===r?r:"zoom";l.dragmode=c,p.call("_guiRelayout",e,l)}function r(e,t){for(var a=t.currentTarget,o=a.getAttribute("data-attr"),r=e._fullLayout,n=r._subplots.gl3d,l={},s=0;s<n.length;s++){var d=n[s],c=d+".camera",u=r[d]._scene;"resetDefault"===o?l[c]=null:"resetLastSave"===o&&(l[c]=h.extendDeep({},u.cameraInitial))}p.call("_guiRelayout",e,l)}function i(e,t){var a=t.currentTarget,o=a._previousVal,r=e._fullLayout,n=r._subplots.gl3d,l=["xaxis","yaxis","zaxis"],s={},d={};if(o)d=o,a._previousVal=null;else{for(var c=0;c<n.length;c++){var p=n[c],u=r[p],g=p+".hovermode";s[g]=u.hovermode,d[g]=!1;for(var h=0;3>h;h++){var m=l[h],y=p+"."+m+".showspikes";d[y]=!1,s[y]=u[m].showspikes}}a._previousVal=s}return d}function n(e,t){for(var a=t.currentTarget,o=a.getAttribute("data-attr"),r=a.getAttribute("data-val")||!0,n=e._fullLayout,l=n._subplots.geo,s=0;s<l.length;s++){var d=l[s],u=n[d];if("zoom"===o){var g=u.projection.scale,h="in"===r?2*g:.5*g;p.call("_guiRelayout",e,d+".projection.scale",h)}else"reset"===o&&c(e,"geo")}}function l(e){var t=e._fullLayout;return!t.hovermode&&(t._has("cartesian")?t._isHoriz?"y":"x":"closest")}function s(e){var t=l(e);p.call("_guiRelayout",e,"hovermode",t)}function d(e){for(var t=e._fullLayout,a=g.list(e,null,!0),o={},r=0,n,l;r<a.length;r++)n=a[r],l=n._name,o[l+".showspikes"]="on"===t._cartesianSpikesEnabled||n._showSpikeInitial;return o}function c(e,t){for(var a=e._fullLayout,o=a._subplots[t],r={},n=0;n<o.length;n++)for(var l=o[n],s=a[l]._subplot,d=s.viewInitial,c=Object.keys(d),u=0,g;u<c.length;u++)g=c[u],r[l+"."+g]=d[g];p.call("_guiRelayout",e,r)}var p=e("../../registry"),u=e("../../plots/plots"),g=e("../../plots/cartesian/axis_ids"),h=e("../../lib"),m=e("../../../build/ploticon"),y=h._,f=t.exports={};f.toImage={name:"toImage",title:function(e){var t=e._context.toImageButtonOptions||{},a=t.format||"png";return"png"===a?y(e,"Download plot as a png"):y(e,"Download plot")},icon:m.camera,click:function(e){var t=e._context.toImageButtonOptions,a={format:t.format||"png"};h.notifier(y(e,"Taking snapshot - this may take a few seconds"),"long"),"svg"!==a.format&&h.isIE()&&(h.notifier(y(e,"IE only supports svg.  Changing format to svg."),"long"),a.format="svg"),["filename","width","height","scale"].forEach(function(e){t[e]&&(a[e]=t[e])}),p.call("downloadImage",e,a).then(function(t){h.notifier(y(e,"Snapshot succeeded")+" - "+t,"long")}).catch(function(){h.notifier(y(e,"Sorry, there was a problem downloading your snapshot!"),"long")})}},f.sendDataToCloud={name:"sendDataToCloud",title:function(e){return y(e,"Edit in Chart Studio")},icon:m.disk,click:function(e){u.sendDataToCloud(e)}},f.zoom2d={name:"zoom2d",title:function(e){return y(e,"Zoom")},attr:"dragmode",val:"zoom",icon:m.zoombox,click:a},f.pan2d={name:"pan2d",title:function(e){return y(e,"Pan")},attr:"dragmode",val:"pan",icon:m.pan,click:a},f.select2d={name:"select2d",title:function(e){return y(e,"Box Select")},attr:"dragmode",val:"select",icon:m.selectbox,click:a},f.lasso2d={name:"lasso2d",title:function(e){return y(e,"Lasso Select")},attr:"dragmode",val:"lasso",icon:m.lasso,click:a},f.zoomIn2d={name:"zoomIn2d",title:function(e){return y(e,"Zoom in")},attr:"zoom",val:"in",icon:m.zoom_plus,click:a},f.zoomOut2d={name:"zoomOut2d",title:function(e){return y(e,"Zoom out")},attr:"zoom",val:"out",icon:m.zoom_minus,click:a},f.autoScale2d={name:"autoScale2d",title:function(e){return y(e,"Autoscale")},attr:"zoom",val:"auto",icon:m.autoscale,click:a},f.resetScale2d={name:"resetScale2d",title:function(e){return y(e,"Reset axes")},attr:"zoom",val:"reset",icon:m.home,click:a},f.hoverClosestCartesian={name:"hoverClosestCartesian",title:function(e){return y(e,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:m.tooltip_basic,gravity:"ne",click:a},f.hoverCompareCartesian={name:"hoverCompareCartesian",title:function(e){return y(e,"Compare data on hover")},attr:"hovermode",val:function(e){return e._fullLayout._isHoriz?"y":"x"},icon:m.tooltip_compare,gravity:"ne",click:a},f.zoom3d={name:"zoom3d",title:function(e){return y(e,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:m.zoombox,click:o},f.pan3d={name:"pan3d",title:function(e){return y(e,"Pan")},attr:"scene.dragmode",val:"pan",icon:m.pan,click:o},f.orbitRotation={name:"orbitRotation",title:function(e){return y(e,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:m["3d_rotate"],click:o},f.tableRotation={name:"tableRotation",title:function(e){return y(e,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:m["z-axis"],click:o},f.resetCameraDefault3d={name:"resetCameraDefault3d",title:function(e){return y(e,"Reset camera to default")},attr:"resetDefault",icon:m.home,click:r},f.resetCameraLastSave3d={name:"resetCameraLastSave3d",title:function(e){return y(e,"Reset camera to last save")},attr:"resetLastSave",icon:m.movie,click:r},f.hoverClosest3d={name:"hoverClosest3d",title:function(e){return y(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:m.tooltip_basic,gravity:"ne",click:function(e,t){var a=i(e,t);p.call("_guiRelayout",e,a)}},f.zoomInGeo={name:"zoomInGeo",title:function(e){return y(e,"Zoom in")},attr:"zoom",val:"in",icon:m.zoom_plus,click:n},f.zoomOutGeo={name:"zoomOutGeo",title:function(e){return y(e,"Zoom out")},attr:"zoom",val:"out",icon:m.zoom_minus,click:n},f.resetGeo={name:"resetGeo",title:function(e){return y(e,"Reset")},attr:"reset",val:null,icon:m.autoscale,click:n},f.hoverClosestGeo={name:"hoverClosestGeo",title:function(e){return y(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:m.tooltip_basic,gravity:"ne",click:s},f.hoverClosestGl2d={name:"hoverClosestGl2d",title:function(e){return y(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:m.tooltip_basic,gravity:"ne",click:s},f.hoverClosestPie={name:"hoverClosestPie",title:function(e){return y(e,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:m.tooltip_basic,gravity:"ne",click:s},f.toggleHover={name:"toggleHover",title:function(e){return y(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:m.tooltip_basic,gravity:"ne",click:function(e,t){var a=i(e,t);a.hovermode=l(e),p.call("_guiRelayout",e,a)}},f.resetViews={name:"resetViews",title:function(e){return y(e,"Reset views")},icon:m.home,click:function(e,t){var o=t.currentTarget;o.setAttribute("data-attr","zoom"),o.setAttribute("data-val","reset"),a(e,t),o.setAttribute("data-attr","resetLastSave"),r(e,t),c(e,"geo"),c(e,"mapbox")}},f.toggleSpikelines={name:"toggleSpikelines",title:function(e){return y(e,"Toggle Spike Lines")},icon:m.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(e){var t=e._fullLayout;t._cartesianSpikesEnabled="on"===t._cartesianSpikesEnabled?"off":"on";var a=d(e);p.call("_guiRelayout",e,a)}},f.resetViewMapbox={name:"resetViewMapbox",title:function(e){return y(e,"Reset view")},attr:"reset",icon:m.home,click:function(e){c(e,"mapbox")}}},{"../../../build/ploticon":2,"../../lib":692,"../../plots/cartesian/axis_ids":743,"../../plots/plots":804,"../../registry":823}],628:[function(e,t,a){"use strict";a.manage=e("./manage")},{"./manage":629}],629:[function(e,t){"use strict";function a(e,t,a,n){function l(e){if(e.length){for(var a=[],o=0,r;o<e.length;o++)r=e[o],-1===t.indexOf(r)&&a.push(p[r]);_.push(a)}}var s=e._fullLayout,d=e._fullData,c=s._has("cartesian"),u=s._has("gl3d"),g=s._has("geo"),h=s._has("pie"),m=s._has("gl2d"),y=s._has("ternary"),f=s._has("mapbox"),x=s._has("polar"),b=o(s),_=[],v=["toImage"];n&&v.push("sendDataToCloud"),l(v);var w=[],k=[],T=[],A=[];return 1<(c||m||h||y)+g+u+f+x?(k=["toggleHover"],T=["resetViews"]):g?(w=["zoomInGeo","zoomOutGeo"],k=["hoverClosestGeo"],T=["resetGeo"]):u?(k=["hoverClosest3d"],T=["resetCameraDefault3d","resetCameraLastSave3d"]):f?(k=["toggleHover"],T=["resetViewMapbox"]):m?k=["hoverClosestGl2d"]:h?k=["hoverClosestPie"]:k=["toggleHover"],c&&(k=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(c||m)&&!b&&(w=["zoomIn2d","zoomOut2d","autoScale2d"],"resetViews"!==T[0]&&(T=["resetScale2d"])),u?A=["zoom3d","pan3d","orbitRotation","tableRotation"]:(c||m)&&!b||y?A=["zoom2d","pan2d"]:f||g?A=["pan2d"]:x&&(A=["zoom2d"]),r(d)&&A.push("select2d","lasso2d"),l(A),l(w.concat(T)),l(k),i(_,a)}function o(e){for(var t=l.list({_fullLayout:e},null,!0),a=0;a<t.length;a++)if(!t[a].fixedrange)return!1;return!0}function r(e){for(var t=!1,a=0;a<e.length&&!t;a++){var o=e[a];!o._module||!o._module.selectPoints||(d.traceIs(o,"scatter-like")?(s.hasMarkers(o)||s.hasText(o))&&(t=!0):d.traceIs(o,"box-violin")?("all"===o.boxpoints||"all"===o.points)&&(t=!0):t=!0)}return t}function i(e,t){if(t.length)if(Array.isArray(t[0]))for(var a=0;a<t.length;a++)e.push(t[a]);else e.push(t);return e}function n(e){for(var t=0,a;t<e.length;t++){a=e[t];for(var o=0,r;o<a.length;o++)if(r=a[o],"string"==typeof r)if(void 0!==p[r])e[t][o]=p[r];else throw new Error("*modeBarButtons* configuration options invalid button name")}return e}var l=e("../../plots/cartesian/axis_ids"),s=e("../../traces/scatter/subtypes"),d=e("../../registry"),c=e("./modebar"),p=e("./buttons");t.exports=function(e){var t=e._fullLayout,o=e._context,r=t._modeBar;if(!o.displayModeBar&&!o.watermark)return void(r&&(r.destroy(),delete t._modeBar));if(!Array.isArray(o.modeBarButtonsToRemove))throw new Error("*modeBarButtonsToRemove* configuration options must be an array.");if(!Array.isArray(o.modeBarButtonsToAdd))throw new Error("*modeBarButtonsToAdd* configuration options must be an array.");var i=o.modeBarButtons,l;l=Array.isArray(i)&&i.length?n(i):!o.displayModeBar&&o.watermark?[]:a(e,o.modeBarButtonsToRemove,o.modeBarButtonsToAdd,o.showSendToCloud),r?r.update(e,l):t._modeBar=c(e,l)}},{"../../plots/cartesian/axis_ids":743,"../../registry":823,"../../traces/scatter/subtypes":1064,"./buttons":627,"./modebar":630}],630:[function(e,t){"use strict";function a(e){this.container=e.container,this.element=document.createElement("div"),this.update(e.graphInfo,e.buttons),this.container.appendChild(this.element)}var o=e("d3"),r=e("fast-isnumeric"),i=e("../../lib"),n=e("../../../build/ploticon"),l=new DOMParser,s=a.prototype;s.update=function(e,t){this.graphInfo=e;var a=this.graphInfo._context,o=this.graphInfo._fullLayout,r="modebar-"+o._uid;this.element.setAttribute("id",r),this._uid=r,this.element.className="hover"===a.displayModeBar?"modebar modebar--hover":"modebar","v"===o.modebar.orientation&&(this.element.className+=" vertical",t=t.reverse()),i.deleteRelatedStyleRule(r),i.addRelatedStyleRule(r,"#"+r,"background-color: "+o.modebar.bgcolor),i.addRelatedStyleRule(r,"#"+r+" .modebar-btn .icon path","fill: "+o.modebar.color),i.addRelatedStyleRule(r,"#"+r+" .modebar-btn:hover .icon path","fill: "+o.modebar.activecolor),i.addRelatedStyleRule(r,"#"+r+" .modebar-btn.active .icon path","fill: "+o.modebar.activecolor);var n=!this.hasButtons(t),l=this.hasLogo!==a.displaylogo,s=this.locale!==a.locale;if(this.locale=a.locale,(n||l||s)&&(this.removeAllButtons(),this.updateButtons(t),a.watermark||a.displaylogo)){var d=this.getLogo();a.watermark&&(d.className+=" watermark"),"v"===o.modebar.orientation?this.element.prepend(d):this.element.appendChild(d),this.hasLogo=!0}this.updateActiveButton()},s.updateButtons=function(e){var t=this;this.buttons=e,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(e){var a=t.createGroup();e.forEach(function(e){var o=e.name;if(!o)throw new Error("must provide button 'name' in button config");if(-1!==t.buttonsNames.indexOf(o))throw new Error("button name '"+o+"' is taken");t.buttonsNames.push(o);var r=t.createButton(e);t.buttonElements.push(r),a.appendChild(r)}),t.element.appendChild(a)})},s.createGroup=function(){var e=document.createElement("div");return e.className="modebar-group",e},s.createButton=function(e){var t=this,a=document.createElement("a");a.setAttribute("rel","tooltip"),a.className="modebar-btn";var r=e.title;void 0===r?r=e.name:"function"==typeof r&&(r=r(this.graphInfo)),(r||0===r)&&a.setAttribute("data-title",r),void 0!==e.attr&&a.setAttribute("data-attr",e.attr);var i=e.val;void 0!==i&&("function"==typeof i&&(i=i(this.graphInfo)),a.setAttribute("data-val",i));var l=e.click;if("function"!=typeof l)throw new Error("must provide button 'click' function in button config");else a.addEventListener("click",function(a){e.click(t.graphInfo,a),t.updateActiveButton(a.currentTarget)});a.setAttribute("data-toggle",e.toggle||!1),e.toggle&&o.select(a).classed("active",!0);var s=e.icon;return"function"==typeof s?a.appendChild(s()):a.appendChild(this.createIcon(s||n.question)),a.setAttribute("data-gravity",e.gravity||"n"),a},s.createIcon=function(e){var t=r(e.height)?+e.height:e.ascent-e.descent,a;if(e.path){a=document.createElementNS("http://www.w3.org/2000/svg","svg"),a.setAttribute("viewBox",[0,0,e.width,t].join(" ")),a.setAttribute("class","icon");var o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d",e.path),e.transform?o.setAttribute("transform",e.transform):void 0!==e.ascent&&o.setAttribute("transform","matrix(1 0 0 -1 0 "+e.ascent+")"),a.appendChild(o)}if(e.svg){var i=l.parseFromString(e.svg,"application/xml");a=i.childNodes[0]}return a.setAttribute("height","1em"),a.setAttribute("width","1em"),a},s.updateActiveButton=function(e){var t=this.graphInfo._fullLayout,a=e===void 0?null:e.getAttribute("data-attr");this.buttonElements.forEach(function(e){var r=e.getAttribute("data-val")||!0,n=e.getAttribute("data-attr"),l="true"===e.getAttribute("data-toggle"),s=o.select(e);if(l)n===a&&s.classed("active",!s.classed("active"));else{var d=null===n?n:i.nestedProperty(t,n).get();s.classed("active",d===r)}})},s.hasButtons=function(e){var t=this.buttons;if(!t)return!1;if(e.length!==t.length)return!1;for(var a=0;a<e.length;++a){if(e[a].length!==t[a].length)return!1;for(var o=0;o<e[a].length;o++)if(e[a][o].name!==t[a][o].name)return!1}return!0},s.getLogo=function(){var e=this.createGroup(),t=document.createElement("a");return t.href="https://plot.ly/",t.target="_blank",t.setAttribute("data-title",i._(this.graphInfo,"Produced with Plotly")),t.className="modebar-btn plotlyjsicon modebar-btn--logo",t.appendChild(this.createIcon(n.newplotlylogo)),e.appendChild(t),e},s.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},s.destroy=function(){i.removeElement(this.container.querySelector(".modebar")),i.deleteRelatedStyleRule(this._uid)},t.exports=function(e,t){var r=e._fullLayout,i=new a({graphInfo:e,container:r._paperdiv.node(),buttons:t});return r._privateplot&&o.select(i.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),i}},{"../../../build/ploticon":2,"../../lib":692,d3:148,"fast-isnumeric":214}],631:[function(e,t){"use strict";var a=e("../../plots/font_attributes"),o=e("../color/attributes"),r=e("../../plot_api/plot_template").templatedArray,i=r("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});t.exports={visible:{valType:"boolean",editType:"plot"},buttons:i,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:a({editType:"plot"}),bgcolor:{valType:"color",dflt:o.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:o.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":730,"../../plots/font_attributes":767,"../color/attributes":568}],632:[function(e,t){"use strict";t.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],633:[function(e,t){"use strict";function a(e,t,a,o){function i(a,o){return r.coerce(e,t,s.buttons,a,o)}var n=o.calendar,l=i("visible");if(l){var d=i("step");"all"!==d&&(n&&"gregorian"!==n&&("month"===d||"year"===d)?t.stepmode="backward":i("stepmode"),i("count")),i("label")}}function o(e,t,a){for(var o=a.filter(function(a){return t[a].anchor===e._id}),r=0,n=0,l;n<o.length;n++)l=t[o[n]].domain,l&&(r=va(l[1],r));return[e.domain[0],r+d.yPad]}var r=e("../../lib"),i=e("../color"),n=e("../../plot_api/plot_template"),l=e("../../plots/array_container_defaults"),s=e("./attributes"),d=e("./constants");t.exports=function(e,t,c,p,u){function g(e,t){return r.coerce(h,m,s,e,t)}var h=e.rangeselector||{},m=n.newContainer(t,"rangeselector"),y=l(h,m,{name:"buttons",handleItemDefaults:a,calendar:u}),f=g("visible",0<y.length);if(f){var x=o(t,c,p);g("x",x[0]),g("y",x[1]),r.noneOrAll(e,t,["x","y"]),g("xanchor"),g("yanchor"),r.coerceFont(g,"font",c.font);var b=g("bgcolor");g("activecolor",i.contrast(b,d.lightAmount,d.darkAmount)),g("bordercolor"),g("borderwidth")}}},{"../../lib":692,"../../plot_api/plot_template":730,"../../plots/array_container_defaults":736,"../color":569,"./attributes":631,"./constants":632}],634:[function(e,t){"use strict";function a(e){for(var t=f.list(e,"x",!0),a=[],o=0,r;o<t.length;o++)r=t[o],r.rangeselector&&r.rangeselector.visible&&a.push(r);return a}function o(e){return e._id}function r(e,t,a){if("all"===t.step)return!0===e.autorange;var o=Object.keys(a);return e.range[0]===a[o[0]]&&e.range[1]===a[o[1]]}function i(e,t,a){var o=m.ensureSingle(e,"rect","selector-rect",function(e){e.attr("shape-rendering","crispEdges")});o.attr({rx:w.rx,ry:w.ry}),o.call(g.stroke,t.bordercolor).call(g.fill,n(t,a)).style("stroke-width",t.borderwidth+"px")}function n(e,t){return t._isActive||t._isHovered?e.activecolor:e.bgcolor}function l(e,t,a,o){var r=m.ensureSingle(e,"text","selector-text",function(e){e.classed("user-select-none",!0).attr("text-anchor","middle")});r.call(h.font,t.font).text(s(a)).call(function(e){y.convertToTspans(e,o)})}function s(e){return e.label?e.label:"all"===e.step?"all":e.count+e.step.charAt(0)}function c(e,t,a,o,r){var i=0,n=0,l=a.borderwidth;t.each(function(){var e=p.select(this),t=e.select(".selector-text"),o=a.font.size*b,r=va(o*y.lineCount(t),16)+3;n=va(n,r)}),t.each(function(){var e=p.select(this),t=e.select(".selector-rect"),o=e.select(".selector-text"),r=o.node()&&h.bBox(o.node()).width,s=a.font.size*b,d=y.lineCount(o),c=va(r+10,w.minButtonWidth);e.attr("transform","translate("+(l+i)+","+l+")"),t.attr({x:0,y:0,width:c,height:n}),y.positionText(o,c/2,n/2-(d-1)*s/2+3),i+=c+5});var s=e._fullLayout._size,d=s.l+s.w*a.x,c=s.t+s.h*(1-a.y),g="left";m.isRightAnchor(a)&&(d-=i,g="right"),m.isCenterAnchor(a)&&(d-=i/2,g="center");var f="top";m.isBottomAnchor(a)&&(c-=n,f="bottom"),m.isMiddleAnchor(a)&&(c-=n/2,f="middle"),i=ae(i),n=ae(n),d=R(d),c=R(c),u.autoMargin(e,o+"-range-selector",{x:a.x,y:a.y,l:i*_[g],r:i*v[g],b:n*v[f],t:n*_[f]}),r.attr("transform","translate("+d+","+c+")")}var p=e("d3"),d=e("../../registry"),u=e("../../plots/plots"),g=e("../color"),h=e("../drawing"),m=e("../../lib"),y=e("../../lib/svg_text_utils"),f=e("../../plots/cartesian/axis_ids"),x=e("../../constants/alignment"),b=x.LINE_SPACING,_=x.FROM_TL,v=x.FROM_BR,w=e("./constants"),k=e("./get_update_object");t.exports=function(e){var t=e._fullLayout,n=t._infolayer.selectAll(".rangeselector").data(a(e),o);n.enter().append("g").classed("rangeselector",!0),n.exit().remove(),n.style({cursor:"pointer","pointer-events":"all"}),n.each(function(t){var a=p.select(this),o=t,n=o.rangeselector,s=a.selectAll("g.button").data(m.filterVisible(n.buttons));s.enter().append("g").classed("button",!0),s.exit().remove(),s.each(function(t){var a=p.select(this),s=k(o,t);t._isActive=r(o,t,s),a.call(i,n,t),a.call(l,n,t,e),a.on("click",function(){e._dragged||d.call("_guiRelayout",e,s)}),a.on("mouseover",function(){t._isHovered=!0,a.call(i,n,t)}),a.on("mouseout",function(){t._isHovered=!1,a.call(i,n,t)})}),c(e,s,n,o._name,a)})}},{"../../constants/alignment":664,"../../lib":692,"../../lib/svg_text_utils":716,"../../plots/cartesian/axis_ids":743,"../../plots/plots":804,"../../registry":823,"../color":569,"../drawing":590,"./constants":632,"./get_update_object":635,d3:148}],635:[function(e,t){"use strict";function a(e,t){var a=e.range,r=new Date(e.r2l(a[1])),i=t.step,n=t.count,l;switch(t.stepmode){case"backward":l=e.l2r(+o.time[i].utc.offset(r,-n));break;case"todate":var s=o.time[i].utc.offset(r,-n);l=e.l2r(+o.time[i].utc.ceil(s));}var d=a[1];return[l,d]}var o=e("d3");t.exports=function(e,t){var o=e._name,r={};if("all"===t.step)r[o+".autorange"]=!0;else{var i=a(e,t);r[o+".range[0]"]=i[0],r[o+".range[1]"]=i[1]}return r}},{d3:148}],636:[function(e,t){"use strict";t.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:e("./attributes")}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),draw:e("./draw")}},{"./attributes":631,"./defaults":633,"./draw":634}],637:[function(e,t){"use strict";var a=e("../color/attributes");t.exports={bgcolor:{valType:"color",dflt:a.background,editType:"plot"},bordercolor:{valType:"color",dflt:a.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":568}],638:[function(e,t){"use strict";var a=e("../../plots/cartesian/axis_ids").list,o=e("../../plots/cartesian/autorange").getAutoRange,r=e("./constants");t.exports=function(e){for(var t=a(e,"x",!0),n=0;n<t.length;n++){var l=t[n],s=l[r.name];s&&s.visible&&s.autorange&&(s._input.autorange=!0,s._input.range=s.range=o(e,l))}}},{"../../plots/cartesian/autorange":739,"../../plots/cartesian/axis_ids":743,"./constants":639}],639:[function(e,t){"use strict";t.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],640:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../plot_api/plot_template"),r=e("../../plots/cartesian/axis_ids"),i=e("./attributes"),n=e("./oppaxis_attributes");t.exports=function(e,t,l){function s(e,t){return a.coerce(u,g,i,e,t)}function d(e,t){return a.coerce(m,y,n,e,t)}var c=e[l],p=t[l];if(c.rangeslider||t._requestRangeslider[p._id]){a.isPlainObject(c.rangeslider)||(c.rangeslider={});var u=c.rangeslider,g=o.newContainer(p,"rangeslider"),h=s("visible"),m,y;if(h){s("bgcolor",t.plot_bgcolor),s("bordercolor"),s("borderwidth"),s("thickness"),s("autorange",!p.isValidRange(u.range)),s("range");var f=t._subplots;if(f)for(var x=f.cartesian.filter(function(e){return e.substr(0,e.indexOf("y"))===r.name2id(l)}).map(function(e){return e.substr(e.indexOf("y"),e.length)}),b=a.simpleMap(x,r.id2name),_=0,v;_<b.length;_++){v=b[_],m=u[v]||{},y=o.newContainer(g,v,"yaxis");var w=t[v],k;m.range&&w.isValidRange(m.range)&&(k="fixed");var T=d("rangemode",k);"match"!==T&&d("range",w.range.slice())}g._input=u}}}},{"../../lib":692,"../../plot_api/plot_template":730,"../../plots/cartesian/axis_ids":743,"./attributes":637,"./oppaxis_attributes":644}],641:[function(e,t){"use strict";function a(t,a,r,i){var n=t.select("rect."+T.slideBoxClassName).node(),l=t.select("rect."+T.grabAreaMinClassName).node(),s=t.select("rect."+T.grabAreaMaxClassName).node();t.on("mousedown",function(){function e(d){var e=+d.clientX-g,c,m,b;switch(p){case n:b="ew-resize",c=y+e,m=f+e;break;case l:b="col-resize",c=y+e,m=f;break;case s:b="col-resize",c=y,m=f+e;break;default:b="ew-resize",c=h,m=h+e;}if(m<c){var _=m;m=c,c=_}i._pixelMin=c,i._pixelMax=m,k(u.select(x),b),o(t,a,r,i)}function d(){x.removeEventListener("mousemove",e),x.removeEventListener("mouseup",d),m.removeElement(x)}var c=u.event,p=c.target,g=c.clientX,h=g-t.node().getBoundingClientRect().left,y=i.d2p(r._rl[0]),f=i.d2p(r._rl[1]),x=w.coverSlip();x.addEventListener("mousemove",e),x.addEventListener("mouseup",d)})}function o(e,t,a,o){function r(e){return a.l2r(m.constrain(e,o._rl[0],o._rl[1]))}var i=r(o.p2d(o._pixelMin)),n=r(o.p2d(o._pixelMax));window.requestAnimationFrame(function(){g.call("_guiRelayout",t,a._name+".range",[i,n])})}function r(e,t,a,o,r,i){function n(e){return m.constrain(e,0,o._width)}function l(e){return m.constrain(e,0,o._height)}function s(e){return m.constrain(e,-d,o._width+d)}var d=T.handleWidth/2,c=n(o.d2p(a._rl[0])),p=n(o.d2p(a._rl[1]));if(e.select("rect."+T.slideBoxClassName).attr("x",c).attr("width",p-c),e.select("rect."+T.maskMinClassName).attr("width",c),e.select("rect."+T.maskMaxClassName).attr("x",p).attr("width",o._width-p),"match"!==i.rangemode){var u=o._height-l(o.d2pOppAxis(r._rl[1])),g=o._height-l(o.d2pOppAxis(r._rl[0]));e.select("rect."+T.maskMinOppAxisClassName).attr("x",c).attr("height",u).attr("width",p-c),e.select("rect."+T.maskMaxOppAxisClassName).attr("x",c).attr("y",g).attr("height",o._height-g).attr("width",p-c),e.select("rect."+T.slideBoxClassName).attr("y",u).attr("height",g-u)}var h=.5,y=R(s(c-d))-h,f=R(s(p-d))+h;e.select("g."+T.grabberMinClassName).attr("transform","translate("+y+","+h+")"),e.select("g."+T.grabberMaxClassName).attr("transform","translate("+f+","+h+")")}function i(e,t,a,o){var r=m.ensureSingle(e,"rect",T.bgClassName,function(e){e.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),i=0==o.borderwidth%2?o.borderwidth:o.borderwidth-1,n=-o._offsetShift,l=y.crispRound(t,o.borderwidth);r.attr({width:o._width+i,height:o._height+i,transform:"translate("+n+","+n+")",fill:o.bgcolor,stroke:o.bordercolor,"stroke-width":l})}function n(e,t,a,o){var r=t._fullLayout,i=m.ensureSingleById(r._topdefs,"clipPath",o._clipId,function(e){e.append("rect").attr({x:0,y:0})});i.select("rect").attr({width:o._width,height:o._height})}function l(e,t,a,o){var r=t.calcdata,i=e.selectAll("g."+T.rangePlotClassName).data(a._subplotsWith,m.identity);i.enter().append("g").attr("class",function(e){return T.rangePlotClassName+" "+e}).call(y.setClipUrl,o._clipId,t),i.order(),i.exit().remove();var n;i.each(function(e,l){var i=u.select(this),d=v.getFromId(t,e,"y"),c=d._name,p=o[c],g={data:[],layout:{xaxis:{type:a.type,domain:[0,1],range:o.range.slice(),calendar:a.calendar},width:o._width,height:o._height,margin:{t:0,b:0,l:0,r:0}},_context:t._context};g.layout[c]={type:d.type,domain:[0,1],range:"match"===p.rangemode?d.range.slice():p.range.slice(),calendar:d.calendar},h.supplyDefaults(g);var m=g._fullLayout.xaxis,y=g._fullLayout[c];m.clearCalc(),m.setScale(),y.clearCalc(),y.setScale();var f={id:e,plotgroup:i,xaxis:m,yaxis:y,isRangePlot:!0};0===l?n=f:(f.mainplot="xy",f.mainplotinfo=n),_.rangePlot(t,f,s(r,e))})}function s(e,t){for(var a=[],o=0;o<e.length;o++){var r=e[o],n=r[0].trace;n.xaxis+n.yaxis===t&&a.push(r)}return a}function d(e,t,a,o,r){var i=m.ensureSingle(e,"rect",T.maskMinClassName,function(e){e.attr({x:0,y:0,"shape-rendering":"crispEdges"})});i.attr("height",o._height).call(f.fill,T.maskColor);var n=m.ensureSingle(e,"rect",T.maskMaxClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});if(n.attr("height",o._height).call(f.fill,T.maskColor),"match"!==r.rangemode){var l=m.ensureSingle(e,"rect",T.maskMinOppAxisClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});l.attr("width",o._width).call(f.fill,T.maskOppAxisColor);var s=m.ensureSingle(e,"rect",T.maskMaxOppAxisClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});s.attr("width",o._width).style("border-top",T.maskOppBorder).call(f.fill,T.maskOppAxisColor)}}function c(e,t,a,o){if(!t._context.staticPlot){var r=m.ensureSingle(e,"rect",T.slideBoxClassName,function(e){e.attr({y:0,cursor:T.slideBoxCursor,"shape-rendering":"crispEdges"})});r.attr({height:o._height,fill:T.slideBoxFill})}}function p(e,t,a,o){var r=m.ensureSingle(e,"g",T.grabberMinClassName),i=m.ensureSingle(e,"g",T.grabberMaxClassName),n={x:0,width:T.handleWidth,rx:T.handleRadius,fill:f.background,stroke:f.defaultLine,"stroke-width":T.handleStrokeWidth,"shape-rendering":"crispEdges"},l={y:R(o._height/4),height:R(o._height/2)},s=m.ensureSingle(r,"rect",T.handleMinClassName,function(e){e.attr(n)});s.attr(l);var d=m.ensureSingle(i,"rect",T.handleMaxClassName,function(e){e.attr(n)});if(d.attr(l),!t._context.staticPlot){var c={width:T.grabAreaWidth,x:0,y:0,fill:T.grabAreaFill,cursor:T.grabAreaCursor},p=m.ensureSingle(r,"rect",T.grabAreaMinClassName,function(e){e.attr(c)});p.attr("height",o._height);var u=m.ensureSingle(i,"rect",T.grabAreaMaxClassName,function(e){e.attr(c)});u.attr("height",o._height)}}var u=e("d3"),g=e("../../registry"),h=e("../../plots/plots"),m=e("../../lib"),y=e("../drawing"),f=e("../color"),b=e("../titles"),_=e("../../plots/cartesian"),v=e("../../plots/cartesian/axis_ids"),w=e("../dragelement"),k=e("../../lib/setcursor"),T=e("./constants");t.exports=function(e){for(var t=e._fullLayout,o=t._rangeSliderData,s=0,g;s<o.length;s++)g=o[s][T.name],g._clipId=g._id+"-"+t._uid;var h=t._infolayer.selectAll("g."+T.containerClassName).data(o,function(e){return e._name});h.exit().each(function(e){var a=e[T.name];t._topdefs.select("#"+a._clipId).remove()}).remove();0===o.length||(h.enter().append("g").classed(T.containerClassName,!0).attr("pointer-events","all"),h.each(function(o){var s=u.select(this),g=o[T.name],h=t[v.id2name(o.anchor)],f=g[v.id2name(o.anchor)];if(g.range){var _=m.simpleMap(g.range,o.r2l),w=m.simpleMap(o.range,o.r2l),k;k=w[0]<w[1]?[ie(_[0],w[0]),va(_[1],w[1])]:[va(_[0],w[0]),ie(_[1],w[1])],g.range=g._input.range=m.simpleMap(k,o.l2r)}o.cleanRange("rangeslider.range");var A=t.margin,S=t._size,C=o.domain,L=g._tickHeight,E=g._oppBottom;g._width=S.w*(C[1]-C[0]);var z=R(A.l+S.w*C[0]),x=R(S.t+S.h*(1-E)+L+g._offsetShift+T.extraPad);s.attr("transform","translate("+z+","+x+")");var y=o.r2l(g.range[0]),I=o.r2l(g.range[1]),D=I-y;if(g.p2d=function(e){return e/g._width*D+y},g.d2p=function(e){return(e-y)/D*g._width},g._rl=[y,I],"match"!==f.rangemode){var P=h.r2l(f.range[0]),O=h.r2l(f.range[1]);g.d2pOppAxis=function(e){return(e-P)/(O-P)*g._height}}s.call(i,e,o,g).call(n,e,o,g).call(l,e,o,g).call(d,e,o,g,f).call(c,e,o,g).call(p,e,o,g),a(s,e,o,g),r(s,e,o,g,h,f),"bottom"===o.side&&b.draw(e,o._id+"title",{propContainer:o,propName:o._name+".title",placeholder:t._dfltTitle.x,attributes:{x:o._offset+o._length/2,y:x+g._height+g._offsetShift+10+1.5*o.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":692,"../../lib/setcursor":712,"../../plots/cartesian":752,"../../plots/cartesian/axis_ids":743,"../../plots/plots":804,"../../registry":823,"../color":569,"../dragelement":587,"../drawing":590,"../titles":657,"./constants":639,d3:148}],642:[function(e,t,a){"use strict";function o(e){var t=e&&e[n];return t&&t.visible}var r=e("../../plots/cartesian/axis_ids"),i=e("./constants"),n=i.name;a.isVisible=o,a.makeData=function(e){var t=r.list({_fullLayout:e},"x",!0),a=e.margin,l=[];if(!e._has("gl2d"))for(var s=0,d;s<t.length;s++)if(d=t[s],o(d)){l.push(d);var c=d[n];c._id=n+d._id,c._height=(e.height-a.b-a.t)*c.thickness,c._offsetShift=ea(c.borderwidth/2)}e._rangeSliderData=l},a.autoMarginOpts=function(e,t){for(var a=t[n],o=1/0,l=t._counterAxes,s=0;s<l.length;s++){var d=l[s],c=r.getFromId(e,d);o=ie(o,c.domain[0])}a._oppBottom=o;var p="bottom"===t.side&&t._boundingBox.height||0;return a._tickHeight=p,{x:0,y:o,l:0,r:0,t:0,b:a._height+e._fullLayout.margin.b+p,pad:i.extraPad+2*a._offsetShift}}},{"../../plots/cartesian/axis_ids":743,"./constants":639}],643:[function(e,t){"use strict";var a=e("../../lib"),o=e("./attributes"),r=e("./oppaxis_attributes"),i=e("./helpers");t.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:a.extendFlat({},o,{yaxis:r})}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),calcAutorange:e("./calc_autorange"),draw:e("./draw"),isVisible:i.isVisible,makeData:i.makeData,autoMarginOpts:i.autoMarginOpts}},{"../../lib":692,"./attributes":637,"./calc_autorange":638,"./defaults":640,"./draw":641,"./helpers":642,"./oppaxis_attributes":644}],644:[function(e,t){"use strict";t.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],645:[function(e,t){"use strict";var a=e("../annotations/attributes"),o=e("../../traces/scatter/attributes").line,r=e("../drawing/attributes").dash,i=e("../../lib/extend").extendFlat,n=e("../../plot_api/plot_template").templatedArray;t.exports=n("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:i({},a.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:i({},a.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:i({},o.color,{editType:"arraydraw"}),width:i({},o.width,{editType:"calc+arraydraw"}),dash:i({},r,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},editType:"arraydraw"})},{"../../lib/extend":682,"../../plot_api/plot_template":730,"../../traces/scatter/attributes":1040,"../annotations/attributes":552,"../drawing/attributes":589}],646:[function(e,t){"use strict";function a(e){return r(e.line.width,e.xsizemode,e.x0,e.x1,e.path,!1)}function o(e){return r(e.line.width,e.ysizemode,e.y0,e.y1,e.path,!0)}function r(e,t,a,o,r,i){var l=e/2,c=i;if("pixel"===t){var p=r?d.extractPathCoords(r,i?s.paramIsY:s.paramIsX):[a,o],u=n.aggNums(Math.max,null,p),g=n.aggNums(Math.min,null,p),h=0>g?wa(g)+l:l,m=0<u?u+l:l;return{ppad:l,ppadplus:c?h:m,ppadminus:c?m:h}}return{ppad:l}}function i(e,t,a,o,r){var n="category"===e.type||"multicategory"===e.type?e.r2c:e.d2c;if(t!==void 0)return[n(t),n(a)];if(o){var l=1/0,c=-Infinity,p=o.match(s.segmentRE),u,g,h,m,y;for("date"===e.type&&(n=d.decodeDate(n)),u=0;u<p.length;u++)g=p[u],h=r[g.charAt(0)].drawn,void 0===h||(m=p[u].substr(1).match(s.paramRE),m&&!(m.length<h)&&(y=n(m[h]),y<l&&(l=y),y>c&&(c=y)));if(c>=l)return[l,c]}}var n=e("../../lib"),l=e("../../plots/cartesian/axes"),s=e("./constants"),d=e("./helpers");t.exports=function(e){var t=e._fullLayout,r=n.filterVisible(t.shapes);if(r.length&&e._fullData.length)for(var d=0,c;d<r.length;d++){c=r[d],c._extremes={};var p,u;if("paper"!==c.xref){var g="pixel"===c.xsizemode?c.xanchor:c.x0,h="pixel"===c.xsizemode?c.xanchor:c.x1;p=l.getFromId(e,c.xref),u=i(p,g,h,c.path,s.paramIsX),u&&(c._extremes[p._id]=l.findExtremes(p,u,a(c)))}if("paper"!==c.yref){var m="pixel"===c.ysizemode?c.yanchor:c.y0,y="pixel"===c.ysizemode?c.yanchor:c.y1;p=l.getFromId(e,c.yref),u=i(p,m,y,c.path,s.paramIsY),u&&(c._extremes[p._id]=l.findExtremes(p,u,o(c)))}}}},{"../../lib":692,"../../plots/cartesian/axes":740,"./constants":647,"./helpers":650}],647:[function(e,t){"use strict";t.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],648:[function(e,t){"use strict";function a(e,t,a){function s(a,r){return o.coerce(e,t,n,a,r)}var d=s("visible");if(d){s("layer"),s("opacity"),s("fillcolor"),s("line.color"),s("line.width"),s("line.dash");for(var c=e.path?"path":"rect",p=s("type",c),u=s("xsizemode"),g=s("ysizemode"),h=["x","y"],m=0;2>m;m++){var y=h[m],f=y+"anchor",x="x"===y?u:g,b={_fullLayout:a},_=r.coerceRef(e,t,b,y,"","paper"),v,w,k;if("paper"===_?w=k=o.identity:(v=r.getFromId(b,_),v._shapeIndices.push(t._index),k=l.rangeToShapePosition(v),w=l.shapePositionToRange(v)),"path"!==p){var T=y+"0",A=y+"1",S=e[T],C=e[A];e[T]=w(e[T],!0),e[A]=w(e[A],!0),"pixel"===x?(s(T,0),s(A,10)):(r.coercePosition(t,b,s,_,T,.25),r.coercePosition(t,b,s,_,A,.75)),t[T]=k(t[T]),t[A]=k(t[A]),e[T]=S,e[A]=C}if("pixel"===x){var L=e[f];e[f]=w(e[f],!0),r.coercePosition(t,b,s,_,f,.25),t[f]=k(t[f]),e[f]=L}}"path"===p?s("path"):o.noneOrAll(e,t,["x0","x1","y0","y1"])}}var o=e("../../lib"),r=e("../../plots/cartesian/axes"),i=e("../../plots/array_container_defaults"),n=e("./attributes"),l=e("./helpers");t.exports=function(e,t){i(e,t,{name:"shapes",handleItemDefaults:a})}},{"../../lib":692,"../../plots/array_container_defaults":736,"../../plots/cartesian/axes":740,"./attributes":645,"./helpers":650}],649:[function(e,t){"use strict";function a(e,t){function a(a){var l={"data-index":t,"fill-rule":"evenodd",d:i(e,n)},s=n.line.width?n.line.color:"rgba(0,0,0,0)",d=a.append("path").attr(l).style("opacity",n.opacity).call(p.stroke,s).call(p.fill,n.fillcolor).call(u.dashLine,n.line.dash,n.line.width);o(d,e,n),e._context.edits.shapePosition&&r(e,d,n,t,a)}e._fullLayout._paperdiv.selectAll(".shapelayer [data-index=\""+t+"\"]").remove();var n=e._fullLayout.shapes[t]||{};if(n._input&&!1!==n.visible)if("below"!==n.layer)a(e._fullLayout._shapeUpperLayer);else if("paper"===n.xref||"paper"===n.yref)a(e._fullLayout._shapeLowerLayer);else{var l=e._fullLayout._plots[n.xref+n.yref];if(l){var s=l.mainplotinfo||l;a(s.shapelayer)}else a(e._fullLayout._shapeLowerLayer)}}function o(e,t,a){var o=(a.xref+a.yref).replace(/paper/g,"");u.setClipUrl(e,o?"clip"+t._fullLayout._uid+o:null,t)}function r(e,t,a,r,n){function p(){var e=va(a.line.width,10),o=n.append("g").attr("data-index",r);o.append("path").attr("d",t.attr("d")).style({cursor:"move","stroke-width":e,"stroke-opacity":"0"});var i={"fill-opacity":"0"},l=10<e/2?e/2:10;return o.append("circle").attr({"data-line-point":"start-point",cx:A?P(a.xanchor)+a.x0:P(a.x0),cy:S?O(a.yanchor)-a.y0:O(a.y0),r:l}).style(i).classed("cursor-grab",!0),o.append("circle").attr({"data-line-point":"end-point",cx:A?P(a.xanchor)+a.x1:P(a.x1),cy:S?O(a.yanchor)-a.y1:O(a.y1),r:l}).style(i).classed("cursor-grab",!0),o}function h(e){if(C)ee="path"===e.target.tagName?"move":"start-point"===e.target.attributes["data-line-point"].value?"resize-over-start-point":"resize-over-end-point";else{var a=B.element.getBoundingClientRect(),o=a.right-a.left,r=a.bottom-a.top,i=e.clientX-a.left,n=e.clientY-a.top,l=!L&&o>10&&r>10&&!e.shiftKey?m.getCursor(i/o,1-n/r):"move";f(t,l),ee=l.split("-")[0]}}function y(o){A&&(H=P(a.xanchor)),S&&(G=O(a.yanchor)),"path"===a.type?Q=a.path:(F=A?a.x0:P(a.x0),N=S?a.y0:O(a.y0),V=A?a.x1:P(a.x1),U=S?a.y1:O(a.y1)),F<V?(W=F,J="x0",X=V,K="x1"):(W=V,J="x1",X=F,K="x0"),!S&&N<U||S&&N>U?(Y=N,Z="y0",q=U,$="y1"):(Y=U,Z="y1",q=N,$="y0"),h(o),w(n,a),T(t,a,e),B.moveFn="move"===ee?_:v}function _(o,r){if("path"===a.type){var s=function(e){return e},d=s,c=s;A?z("xanchor",a.xanchor=R(H+o)):(d=function(e){return R(P(e)+o)},I&&"date"===I.type&&(d=b.encodeDate(d))),S?z("yanchor",a.yanchor=M(G+r)):(c=function(e){return M(O(e)+r)},D&&"date"===D.type&&(c=b.encodeDate(c))),z("path",a.path=l(Q,d,c))}else A?z("xanchor",a.xanchor=R(H+o)):(z("x0",a.x0=R(F+o)),z("x1",a.x1=R(V+o))),S?z("yanchor",a.yanchor=M(G+r)):(z("y0",a.y0=M(N+r)),z("y1",a.y1=M(U+r)));t.attr("d",i(e,a)),w(n,a)}function v(o,r){if(L){var s=function(e){return e},d=s,c=s;A?z("xanchor",a.xanchor=R(H+o)):(d=function(e){return R(P(e)+o)},I&&"date"===I.type&&(d=b.encodeDate(d))),S?z("yanchor",a.yanchor=M(G+r)):(c=function(e){return M(O(e)+r)},D&&"date"===D.type&&(c=b.encodeDate(c))),z("path",a.path=l(Q,d,c))}else if(!C){var p=~ee.indexOf("n")?Y+r:Y,u=~ee.indexOf("s")?q+r:q,g=~ee.indexOf("w")?W+o:W,h=~ee.indexOf("e")?X+o:X;~ee.indexOf("n")&&S&&(p=Y-r),~ee.indexOf("s")&&S&&(u=q-r),(!S&&u-p>10||S&&p-u>10)&&(z(Z,a[Z]=S?p:M(p)),z($,a[$]=S?u:M(u))),h-g>10&&(z(J,a[J]=A?g:R(g)),z(K,a[K]=A?h:R(h)))}else if("resize-over-start-point"===ee){var m=F+o,y=S?N-r:N+r;z("x0",a.x0=A?m:R(m)),z("y0",a.y0=S?y:M(y))}else if("resize-over-end-point"===ee){var f=V+o,x=S?U-r:U+r;z("x1",a.x1=A?f:R(f)),z("y1",a.y1=S?x:M(x))}t.attr("d",i(e,a)),w(n,a)}function w(e,t){(A||S)&&function(){var a="path"!==t.type,o=e.selectAll(".visual-cue").data([0]),r=1;o.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":r}).classed("visual-cue",!0);var i=P(A?t.xanchor:d.midRange(a?[t.x0,t.x1]:b.extractPathCoords(t.path,x.paramIsX))),n=O(S?t.yanchor:d.midRange(a?[t.y0,t.y1]:b.extractPathCoords(t.path,x.paramIsY)));if(i=b.roundPositionForSharpStrokeRendering(i,r),n=b.roundPositionForSharpStrokeRendering(n,r),A&&S){var l="M"+(i-1-r)+","+(n-1-r)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";o.attr("d",l)}else if(A){var s="M"+(i-1-r)+","+(n-9-r)+"v18 h2 v-18 Z";o.attr("d",s)}else{var c="M"+(i-9-r)+","+(n-1-r)+"h18 v2 h-18 Z";o.attr("d",c)}}()}function k(e){e.selectAll(".visual-cue").remove()}function T(e,t,a){var o=t.xref,r=t.yref,i=c.getFromId(a,o),n=c.getFromId(a,r),l="";"paper"===o||i.autorange||(l+=o),"paper"===r||n.autorange||(l+=r),u.setClipUrl(e,l?"clip"+a._fullLayout._uid+l:null,a)}var A="pixel"===a.xsizemode,S="pixel"===a.ysizemode,C="line"===a.type,L="path"===a.type,E=g(e.layout,"shapes",a),z=E.modifyItem,I=c.getFromId(e,a.xref),D=c.getFromId(e,a.yref),P=b.getDataToPixel(e,I),O=b.getDataToPixel(e,D,!0),R=b.getPixelToData(e,I),M=b.getPixelToData(e,D,!0),j=function(){return C?p():t}(),B={element:j.node(),gd:e,prepFn:y,doneFn:function(){f(t),k(n),o(t,e,a),s.call("_guiRelayout",e,E.getUpdateObj())},clickFn:function(){k(n)}},F,N,V,U,H,G,Y,q,W,X,Z,$,J,K,Q,ee;m.init(B),j.node().onmousemove=h}function i(e,t){var a=t.type,o=c.getFromId(e,t.xref),r=c.getFromId(e,t.yref),i=e._fullLayout._size,l,s,d,p,u,g,h,m;if(o?(l=b.shapePositionToRange(o),s=function(e){return o._offset+o.r2p(l(e,!0))}):s=function(e){return i.l+i.w*e},r?(d=b.shapePositionToRange(r),p=function(e){return r._offset+r.r2p(d(e,!0))}):p=function(e){return i.t+i.h*(1-e)},"path"===a)return o&&"date"===o.type&&(s=b.decodeDate(s)),r&&"date"===r.type&&(p=b.decodeDate(p)),n(t,s,p);if("pixel"===t.xsizemode){var y=s(t.xanchor);u=y+t.x0,g=y+t.x1}else u=s(t.x0),g=s(t.x1);if("pixel"===t.ysizemode){var f=p(t.yanchor);h=f-t.y0,m=f-t.y1}else h=p(t.y0),m=p(t.y1);if("line"===a)return"M"+u+","+h+"L"+g+","+m;if("rect"===a)return"M"+u+","+h+"H"+g+"V"+m+"H"+u+"Z";var x=(u+g)/2,_=(h+m)/2,v=wa(x-u),w=wa(_-h),k="A"+v+","+w,T=x+v+","+_;return"M"+T+k+" 0 1,1 "+(x+","+(_-w))+k+" 0 0,1 "+T+"Z"}function n(e,t,a){var o=e.path,r=e.xsizemode,i=e.ysizemode,n=e.xanchor,l=e.yanchor;return o.replace(x.segmentRE,function(e){var o=0,s=e.charAt(0),c=x.paramIsX[s],p=x.paramIsY[s],u=x.numParams[s],g=e.substr(1).replace(x.paramRE,function(e){return c[o]?"pixel"===r?e=t(n)+ +e:e=t(e):p[o]&&("pixel"===i?e=a(l)-+e:e=a(e)),o++,o>u&&(e="X"),e});return o>u&&(g=g.replace(/[\s,]*X.*/,""),d.log("Ignoring extra params in segment "+e)),s+g})}function l(e,t,a){return e.replace(x.segmentRE,function(e){var o=0,r=e.charAt(0),i=x.paramIsX[r],n=x.paramIsY[r],l=x.numParams[r],s=e.substr(1).replace(x.paramRE,function(e){return o>=l?e:(i[o]?e=t(e):n[o]&&(e=a(e)),o++,e)});return r+s})}var s=e("../../registry"),d=e("../../lib"),c=e("../../plots/cartesian/axes"),p=e("../color"),u=e("../drawing"),g=e("../../plot_api/plot_template").arrayEditor,m=e("../dragelement"),f=e("../../lib/setcursor"),x=e("./constants"),b=e("./helpers");t.exports={draw:function(e){var t=e._fullLayout;for(var o in t._shapeUpperLayer.selectAll("path").remove(),t._shapeLowerLayer.selectAll("path").remove(),t._plots){var r=t._plots[o].shapelayer;r&&r.selectAll("path").remove()}for(var n=0;n<t.shapes.length;n++)t.shapes[n].visible&&a(e,n)},drawOne:a}},{"../../lib":692,"../../lib/setcursor":712,"../../plot_api/plot_template":730,"../../plots/cartesian/axes":740,"../../registry":823,"../color":569,"../dragelement":587,"../drawing":590,"./constants":647,"./helpers":650}],650:[function(e,t,a){"use strict";var o=e("./constants"),r=e("../../lib");a.rangeToShapePosition=function(e){return"log"===e.type?e.r2d:function(e){return e}},a.shapePositionToRange=function(e){return"log"===e.type?e.d2r:function(e){return e}},a.decodeDate=function(e){return function(t){return t.replace&&(t=t.replace("_"," ")),e(t)}},a.encodeDate=function(e){return function(t){return e(t).replace(" ","_")}},a.extractPathCoords=function(e,t){var a=[],i=e.match(o.segmentRE);return i.forEach(function(e){var i=t[e.charAt(0)].drawn;if(void 0!==i){var n=e.substr(1).match(o.paramRE);!n||n.length<i||a.push(r.cleanNumber(n[i]))}}),a},a.getDataToPixel=function(e,t,o){var r=e._fullLayout._size,i;if(t){var n=a.shapePositionToRange(t);i=function(e){return t._offset+t.r2p(n(e,!0))},"date"===t.type&&(i=a.decodeDate(i))}else i=o?function(e){return r.t+r.h*(1-e)}:function(e){return r.l+r.w*e};return i},a.getPixelToData=function(e,t,o){var r=e._fullLayout._size,i;if(t){var n=a.rangeToShapePosition(t);i=function(e){return n(t.p2r(e-t._offset))}}else i=o?function(e){return 1-(e-r.t)/r.h}:function(e){return(e-r.l)/r.w};return i},a.roundPositionForSharpStrokeRendering=function(e,t){var a=1===R(t%2),o=R(e);return a?o+.5:o}},{"../../lib":692,"./constants":647}],651:[function(e,t){"use strict";var a=e("./draw");t.exports={moduleType:"component",name:"shapes",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("shapes"),calcAutorange:e("./calc_autorange"),draw:a.draw,drawOne:a.drawOne}},{"../../plots/cartesian/include_components":751,"./attributes":645,"./calc_autorange":646,"./defaults":648,"./draw":649}],652:[function(e,t){"use strict";var a=e("../../plots/font_attributes"),o=e("../../plots/pad_attributes"),r=e("../../lib/extend").extendDeepAll,i=e("../../plot_api/edit_types").overrideAll,n=e("../../plots/animation_attributes"),l=e("../../plot_api/plot_template").templatedArray,s=e("./constants"),d=l("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});t.exports=i(l("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:d,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:r(o({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:n.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:a({})},font:a({}),activebgcolor:{valType:"color",dflt:s.gripBgActiveColor},bgcolor:{valType:"color",dflt:s.railBgColor},bordercolor:{valType:"color",dflt:s.railBorderColor},borderwidth:{valType:"number",min:0,dflt:s.railBorderWidth},ticklen:{valType:"number",min:0,dflt:s.tickLength},tickcolor:{valType:"color",dflt:s.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:s.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":682,"../../plot_api/edit_types":723,"../../plot_api/plot_template":730,"../../plots/animation_attributes":735,"../../plots/font_attributes":767,"../../plots/pad_attributes":803,"./constants":653}],653:[function(e,t){"use strict";t.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],654:[function(e,t){"use strict";function a(e,t,a){function s(a,o){return r.coerce(e,t,l,a,o)}for(var d=n(e,t,{name:"steps",handleItemDefaults:o}),c=0,p=0;p<d.length;p++)d[p].visible&&c++;var u;if(u=2>c?t.visible=!1:s("visible"),!!u){t._stepCount=c;var g=t._visibleSteps=r.filterVisible(d),h=s("active");(d[h]||{}).visible||(t.active=g[0]._index),s("x"),s("y"),r.noneOrAll(e,t,["x","y"]),s("xanchor"),s("yanchor"),s("len"),s("lenmode"),s("pad.t"),s("pad.r"),s("pad.b"),s("pad.l"),r.coerceFont(s,"font",a.font);var m=s("currentvalue.visible");m&&(s("currentvalue.xanchor"),s("currentvalue.prefix"),s("currentvalue.suffix"),s("currentvalue.offset"),r.coerceFont(s,"currentvalue.font",t.font)),s("transition.duration"),s("transition.easing"),s("bgcolor"),s("activebgcolor"),s("bordercolor"),s("borderwidth"),s("ticklen"),s("tickwidth"),s("tickcolor"),s("minorticklen")}}function o(e,t){function a(a,o){return r.coerce(e,t,c,a,o)}var o;if(o="skip"===e.method||Array.isArray(e.args)?a("visible"):t.visible=!1,o){a("method"),a("args");var i=a("label","step-"+t._index);a("value",i),a("execute")}}var r=e("../../lib"),n=e("../../plots/array_container_defaults"),l=e("./attributes"),s=e("./constants"),d=s.name,c=l.steps;t.exports=function(e,t){n(e,t,{name:d,handleItemDefaults:a})}},{"../../lib":692,"../../plots/array_container_defaults":736,"./attributes":652,"./constants":653}],655:[function(e,t){"use strict";function a(e){return L.autoMarginIdRoot+e._index}function o(e,t){for(var a=e[L.name],o=[],r=0,n;r<a.length;r++)n=a[r],n.visible&&(n._gd=t,o.push(n));return o}function r(e){return e._index}function n(e,t){var o=T.tester.selectAll("g."+L.labelGroupClass).data(t._visibleSteps);o.enter().append("g").classed(L.labelGroupClass,!0);var r=0,n=0;o.each(function(e){var a=k.select(this),o=c(a,{step:e},t),i=o.node();if(i){var l=T.bBox(i);n=va(n,l.height),r=va(r,l.width)}}),o.remove();var l=t._dims={};l.inputAreaWidth=va(L.railWidth,L.gripHeight);var d=e._fullLayout._size;l.lx=d.l+d.w*t.x,l.ly=d.t+d.h*(1-t.y),l.outerLength="fraction"===t.lenmode?R(d.w*t.len):t.len,l.inputAreaStart=0,l.inputAreaLength=R(l.outerLength-t.pad.l-t.pad.r);var p=l.inputAreaLength-2*L.stepInset,u=p/(t._stepCount-1),g=r+L.labelPadding;if(l.labelStride=va(1,ae(g/u)),l.labelHeight=n,l.currentValueMaxWidth=0,l.currentValueHeight=0,l.currentValueTotalHeight=0,l.currentValueMaxLines=1,t.currentvalue.visible){var h=T.tester.append("g");o.each(function(e){var a=s(h,t,e.label),o=a.node()&&T.bBox(a.node())||{width:0,height:0},r=S.lineCount(a);l.currentValueMaxWidth=va(l.currentValueMaxWidth,ae(o.width)),l.currentValueHeight=va(l.currentValueHeight,ae(o.height)),l.currentValueMaxLines=va(l.currentValueMaxLines,r)}),l.currentValueTotalHeight=l.currentValueHeight+t.currentvalue.offset,h.remove()}l.height=l.currentValueTotalHeight+L.tickOffset+t.ticklen+L.labelOffset+l.labelHeight+t.pad.t+t.pad.b;var m="left";A.isRightAnchor(t)&&(l.lx-=l.outerLength,m="right"),A.isCenterAnchor(t)&&(l.lx-=l.outerLength/2,m="center");var y="top";A.isBottomAnchor(t)&&(l.ly-=l.height,y="bottom"),A.isMiddleAnchor(t)&&(l.ly-=l.height/2,y="middle"),l.outerLength=ae(l.outerLength),l.height=ae(l.height),l.lx=R(l.lx),l.ly=R(l.ly);var f={y:t.y,b:l.height*D[y],t:l.height*I[y]};"fraction"===t.lenmode?(f.l=0,f.xl=t.x-t.len*I[m],f.r=0,f.xr=t.x+t.len*D[m]):(f.x=t.x,f.l=l.outerLength*I[m],f.r=l.outerLength*D[m]),i.autoMargin(e,a(t),f)}function l(e,t,a){(a.steps[a.active]||{}).visible||(a.active=a._visibleSteps[0]._index),t.call(s,a).call(w,a).call(p,a).call(m,a).call(v,e,a).call(d,e,a);var o=a._dims;T.setTranslate(t,o.lx+a.pad.l,o.ly+a.pad.t),t.call(f,a,!1),t.call(s,a)}function s(e,t,a){if(t.currentvalue.visible){var o=t._dims,r,i;switch(t.currentvalue.xanchor){case"right":r=o.inputAreaLength-L.currentValueInset-o.currentValueMaxWidth,i="left";break;case"center":r=.5*o.inputAreaLength,i="middle";break;default:r=L.currentValueInset,i="left";}var n=A.ensureSingle(e,"text",L.labelClass,function(e){e.classed("user-select-none",!0).attr({"text-anchor":i,"data-notex":1})}),l=t.currentvalue.prefix?t.currentvalue.prefix:"";if("string"==typeof a)l+=a;else{var s=t.steps[t.active].label;l+=s}t.currentvalue.suffix&&(l+=t.currentvalue.suffix),n.call(T.font,t.currentvalue.font).text(l).call(S.convertToTspans,t._gd);var d=S.lineCount(n),c=(o.currentValueMaxLines+1-d)*t.currentvalue.font.size*z;return S.positionText(n,r,c),n}}function d(e,t,a){var o=A.ensureSingle(e,"rect",L.gripRectClass,function(o){o.call(h,t,e,a).style("pointer-events","all")});o.attr({width:L.gripWidth,height:L.gripHeight,rx:L.gripRadius,ry:L.gripRadius}).call(x.stroke,a.bordercolor).call(x.fill,a.bgcolor).style("stroke-width",a.borderwidth+"px")}function c(e,t,a){var o=A.ensureSingle(e,"text",L.labelClass,function(e){e.classed("user-select-none",!0).attr({"text-anchor":"middle","data-notex":1})});return o.call(T.font,a.font).text(t.step.label).call(S.convertToTspans,a._gd),o}function p(e,t){var a=A.ensureSingle(e,"g",L.labelsClass),o=t._dims,r=a.selectAll("g."+L.labelGroupClass).data(o.labelSteps);r.enter().append("g").classed(L.labelGroupClass,!0),r.exit().remove(),r.each(function(e){var a=k.select(this);a.call(c,e,t),T.setTranslate(a,b(t,e.fraction),L.tickOffset+t.ticklen+t.font.size*z+L.labelOffset+o.currentValueTotalHeight)})}function u(e,t,a,o,r){var i=R(o*(a._stepCount-1)),n=a._visibleSteps[i]._index;n!==a.active&&g(e,t,a,n,!0,r)}function g(e,t,a,o,r,n){var l=a.active;a.active=o,C(e.layout,L.name,a).applyUpdate("active",o);var d=a.steps[a.active];t.call(f,a,n),t.call(s,a),e.emit("plotly_sliderchange",{slider:a,step:a.steps[a.active],interaction:r,previousActive:l}),d&&d.method&&r&&(t._nextMethod?(t._nextMethod.step=d,t._nextMethod.doCallback=r,t._nextMethod.doTransition=n):(t._nextMethod={step:d,doCallback:r,doTransition:n},t._nextMethodRaf=window.requestAnimationFrame(function(){var a=t._nextMethod.step;a.method&&(a.execute&&i.executeAPICommand(e,a.method,a.args),t._nextMethod=null,t._nextMethodRaf=null)})))}function h(e,t,a){function o(){return a.data()[0]}var r=a.node(),i=k.select(t);e.on("mousedown",function(){var e=o();t.emit("plotly_sliderstart",{slider:e});var n=a.select("."+L.gripRectClass);k.event.stopPropagation(),k.event.preventDefault(),n.call(x.fill,e.activebgcolor);var l=_(e,k.mouse(r)[0]);u(t,a,e,l,!0),e._dragging=!0,i.on("mousemove",function(){var e=o(),i=_(e,k.mouse(r)[0]);u(t,a,e,i,!1)}),i.on("mouseup",function(){var e=o();e._dragging=!1,n.call(x.fill,e.bgcolor),i.on("mouseup",null),i.on("mousemove",null),t.emit("plotly_sliderend",{slider:e,step:e.steps[e.active]})})})}function m(e,t){var a=e.selectAll("rect."+L.tickRectClass).data(t._visibleSteps),o=t._dims;a.enter().append("rect").classed(L.tickRectClass,!0),a.exit().remove(),a.attr({width:t.tickwidth+"px","shape-rendering":"crispEdges"}),a.each(function(e,a){var r=0==a%o.labelStride,i=k.select(this);i.attr({height:r?t.ticklen:t.minorticklen}).call(x.fill,r?t.tickcolor:t.tickcolor),T.setTranslate(i,b(t,a/(t._stepCount-1))-.5*t.tickwidth,(r?L.tickOffset:L.minorTickOffset)+o.currentValueTotalHeight)})}function y(e){var t=e._dims;t.labelSteps=[];for(var a=e._stepCount,o=0;o<a;o+=t.labelStride)t.labelSteps.push({fraction:o/(a-1),step:e._visibleSteps[o]})}function f(e,t,a){for(var o=e.select("rect."+L.gripRectClass),r=0,n=0;n<t._stepCount;n++)if(t._visibleSteps[n]._index===t.active){r=n;break}var l=b(t,r/(t._stepCount-1));if(!t._invokingCommand){var s=o;a&&0<t.transition.duration&&(s=s.transition().duration(t.transition.duration).ease(t.transition.easing)),s.attr("transform","translate("+(l-.5*L.gripWidth)+","+t._dims.currentValueTotalHeight+")")}}function b(e,t){var a=e._dims;return a.inputAreaStart+L.stepInset+(a.inputAreaLength-2*L.stepInset)*ie(1,va(0,t))}function _(e,t){var a=e._dims;return ie(1,va(0,(t-L.stepInset-a.inputAreaStart)/(a.inputAreaLength-2*L.stepInset-2*a.inputAreaStart)))}function v(e,t,a){var o=a._dims,r=A.ensureSingle(e,"rect",L.railTouchRectClass,function(o){o.call(h,t,e,a).style("pointer-events","all")});r.attr({width:o.inputAreaLength,height:va(o.inputAreaWidth,L.tickOffset+a.ticklen+o.labelHeight)}).call(x.fill,a.bgcolor).attr("opacity",0),T.setTranslate(r,0,o.currentValueTotalHeight)}function w(e,t){var a=t._dims,o=a.inputAreaLength-2*L.railInset,r=A.ensureSingle(e,"rect",L.railRectClass);r.attr({width:o,height:L.railWidth,rx:L.railRadius,ry:L.railRadius,"shape-rendering":"crispEdges"}).call(x.stroke,t.bordercolor).call(x.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px"),T.setTranslate(r,L.railInset,.5*(a.inputAreaWidth-L.railWidth)+a.currentValueTotalHeight)}var k=e("d3"),i=e("../../plots/plots"),x=e("../color"),T=e("../drawing"),A=e("../../lib"),S=e("../../lib/svg_text_utils"),C=e("../../plot_api/plot_template").arrayEditor,L=e("./constants"),E=e("../../constants/alignment"),z=E.LINE_SPACING,I=E.FROM_TL,D=E.FROM_BR;t.exports=function(e){function t(t){t._commandObserver&&(t._commandObserver.remove(),delete t._commandObserver),i.autoMargin(e,a(t))}var s=e._fullLayout,d=o(s,e),c=s._infolayer.selectAll("g."+L.containerClassName).data(0<d.length?[0]:[]);if(c.enter().append("g").classed(L.containerClassName,!0).style("cursor","ew-resize"),c.exit().each(function(){k.select(this).selectAll("g."+L.groupClassName).each(t)}).remove(),0!==d.length){var p=c.selectAll("g."+L.groupClassName).data(d,r);p.enter().append("g").classed(L.groupClassName,!0),p.exit().each(t).remove();for(var u=0,h;u<d.length;u++)h=d[u],n(e,h);p.each(function(t){var a=k.select(this);y(t),i.manageCommandObserver(e,t,t._visibleSteps,function(t){var o=a.data()[0];o.active===t.index||o._dragging||g(e,a,o,t.index,!1,!0)}),l(e,k.select(this),t)})}}},{"../../constants/alignment":664,"../../lib":692,"../../lib/svg_text_utils":716,"../../plot_api/plot_template":730,"../../plots/plots":804,"../color":569,"../drawing":590,"./constants":653,d3:148}],656:[function(e,t){"use strict";var a=e("./constants");t.exports={moduleType:"component",name:a.name,layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),draw:e("./draw")}},{"./attributes":652,"./constants":653,"./defaults":654,"./draw":655}],657:[function(e,t){"use strict";var a=e("d3"),o=e("fast-isnumeric"),r=e("../../plots/plots"),i=e("../../registry"),n=e("../../lib"),l=e("../drawing"),s=e("../color"),c=e("../../lib/svg_text_utils"),p=e("../../constants/interactions");t.exports={draw:function(e,t,d){function g(e){n.syncOrAsync([h,m],e)}function h(t){var o;return w?(o="",w.rotate&&(o+="rotate("+[w.rotate,v.x,v.y]+")"),w.offset&&(o+="translate(0, "+w.offset+")")):o=null,t.attr("transform",o),t.style({"font-family":z,"font-size":a.round(I,2)+"px",fill:s.rgb(D),opacity:A*s.opacity(D),"font-weight":r.fontWeight}).attr(v).call(c.convertToTspans,e),r.previousPromises(e)}function m(e){var t=a.select(e.node().parentNode);if(_&&_.selection&&_.side&&L){t.attr("transform",null);var r=0,i={left:"right",right:"left",top:"bottom",bottom:"top"}[_.side],s=-1===["left","top"].indexOf(_.side)?1:-1,d=o(_.pad)?_.pad:2,c=l.bBox(t.node()),p={left:0,top:0,right:T.width,bottom:T.height},u=_.maxShift||(p[_.side]-c[_.side])*("left"===_.side||"top"===_.side?-1:1);if(0>u)r=u;else{var g=_.offsetLeft||0,h=_.offsetTop||0;c.left-=g,c.right-=g,c.top-=h,c.bottom-=h,_.selection.each(function(){var e=l.bBox(this);n.bBoxIntersect(c,e,d)&&(r=va(r,s*(e[_.side]-c[i])+d))}),r=ie(u,r)}if(0<r||0>u){var m={left:[-r,0],right:[r,0],top:[0,-r],bottom:[0,r]}[_.side];t.attr("transform","translate("+m+")")}}}var y=d.propContainer,f=d.propName,x=d.placeholder,b=d.traceIndex,_=d.avoid||{},v=d.attributes,w=d.transform,k=d.containerGroup,T=e._fullLayout,A=1,S=!1,C=y.title,L=(C&&C.text?C.text:"").trim(),E=C&&C.font?C.font:{},z=E.family,I=E.size,D=E.color,P;"title.text"===f?P="titleText":-1===f.indexOf("axis")?f.indexOf(!0)&&(P="colorbarTitleText"):P="axisTitleText";var O=e._context.edits[P];""===L?A=0:L.replace(u," % ")===x.replace(u," % ")&&(A=.2,S=!0,!O&&(L=""));var R=L||O;k||(k=n.ensureSingle(T._infolayer,"g","g-"+t));var M=k.selectAll("text").data(R?[0]:[]);return(M.enter().append("text"),M.text(L).attr("class",t),M.exit().remove(),!R)?k:(M.call(g),O&&(L?M.on(".opacity",null):function(){A=0,S=!0,M.text(x).on("mouseover.opacity",function(){a.select(this).transition().duration(p.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){a.select(this).transition().duration(p.HIDE_PLACEHOLDER).style("opacity",0)})}(),M.call(c.makeEditable,{gd:e}).on("edit",function(t){void 0===b?i.call("_guiRelayout",e,f,t):i.call("_guiRestyle",e,f,t,b)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(g)}).on("input",function(e){this.text(e||" ").call(c.positionText,v.x,v.y)})),M.classed("js-placeholder",S),k)}};var u=/ [XY][0-9]* /},{"../../constants/interactions":668,"../../lib":692,"../../lib/svg_text_utils":716,"../../plots/plots":804,"../../registry":823,"../color":569,"../drawing":590,d3:148,"fast-isnumeric":214}],658:[function(e,t){"use strict";var a=e("../../plots/font_attributes"),o=e("../color/attributes"),r=e("../../lib/extend").extendFlat,i=e("../../plot_api/edit_types").overrideAll,n=e("../../plots/pad_attributes"),l=e("../../plot_api/plot_template").templatedArray,s=l("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});t.exports=i(l("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:s,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:r(n({editType:"arraydraw"}),{}),font:a({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:o.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":682,"../../plot_api/edit_types":723,"../../plot_api/plot_template":730,"../../plots/font_attributes":767,"../../plots/pad_attributes":803,"../color/attributes":568}],659:[function(e,t){"use strict";t.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],660:[function(e,t){"use strict";function a(e,t,a){function l(a,o){return r.coerce(e,t,n,a,o)}var s=i(e,t,{name:"buttons",handleItemDefaults:o}),d=l("visible",0<s.length);d&&(l("active"),l("direction"),l("type"),l("showactive"),l("x"),l("y"),r.noneOrAll(e,t,["x","y"]),l("xanchor"),l("yanchor"),l("pad.t"),l("pad.r"),l("pad.b"),l("pad.l"),r.coerceFont(l,"font",a.font),l("bgcolor",a.paper_bgcolor),l("bordercolor"),l("borderwidth"))}function o(e,t){function a(a,o){return r.coerce(e,t,d,a,o)}var o=a("visible","skip"===e.method||Array.isArray(e.args));o&&(a("method"),a("args"),a("label"),a("execute"))}var r=e("../../lib"),i=e("../../plots/array_container_defaults"),n=e("./attributes"),l=e("./constants"),s=l.name,d=n.buttons;t.exports=function(e,t){i(e,t,{name:s,handleItemDefaults:a})}},{"../../lib":692,"../../plots/array_container_defaults":736,"./attributes":658,"./constants":659}],661:[function(e,t){"use strict";function a(e){return e._index}function o(e){return-1==+e.attr(L.menuIndexAttrName)}function r(e,t){return+e.attr(L.menuIndexAttrName)===t._index}function i(e,t,a,o,r,i,s,d){t.active=s,S(e.layout,L.name,t).applyUpdate("active",s),"buttons"===t.type?l(e,o,null,null,t):"dropdown"===t.type&&(r.attr(L.menuIndexAttrName,"-1"),n(e,o,r,i,t),!d&&l(e,o,r,i,t))}function n(e,t,a,o,i){var n=T.ensureSingle(t,"g",L.headerClassName,function(e){e.style("pointer-events","all")}),s=i._dims,d=i.active,p=i.buttons[d]||L.blankHeaderOpts,u={y:i.pad.t,yPad:0,x:i.pad.l,xPad:0,index:0},g={width:s.headerWidth,height:s.headerHeight};n.call(c,i,p,e).call(x,i,u,g);var y=T.ensureSingle(t,"text",L.headerArrowClassName,function(e){e.classed("user-select-none",!0).attr("text-anchor","end").call(k.font,i.font).text(L.arrowSymbol[i.direction])});y.attr({x:s.headerWidth-L.arrowOffsetX+i.pad.l,y:s.headerHeight/2+L.textOffsetY+i.pad.t}),n.on("click",function(){a.call(b,(r(a,i)?-1:i._index)+""),l(e,t,a,o,i)}),n.on("mouseover",function(){n.call(h)}),n.on("mouseout",function(){n.call(m,i)}),k.setTranslate(t,s.lx,s.ly)}function l(e,t,a,r,n){a||(a=t,a.attr("pointer-events","all"));var l=o(a)&&"buttons"!==n.type?[]:n.buttons,p="dropdown"===n.type?L.dropdownButtonClassName:L.buttonClassName,u=a.selectAll("g."+p).data(T.filterVisible(l)),y=u.enter().append("g").classed(p,!0),f=u.exit();"dropdown"===n.type?(y.attr("opacity","0").transition().attr("opacity","1"),f.transition().attr("opacity","0").remove()):f.remove();var b=0,w=0,k=n._dims,A=-1!==["up","down"].indexOf(n.direction);"dropdown"===n.type&&(A?w=k.headerHeight+L.gapButtonHeader:b=k.headerWidth+L.gapButtonHeader),"dropdown"===n.type&&"up"===n.direction&&(w=-L.gapButtonHeader+L.gapButton-k.openHeight),"dropdown"===n.type&&"left"===n.direction&&(b=-L.gapButtonHeader+L.gapButton-k.openWidth);var S={x:k.lx+b+n.pad.l,y:k.ly+w+n.pad.t,yPad:L.gapButton,xPad:L.gapButton,index:0},C={l:S.x+n.borderwidth,t:S.y+n.borderwidth};u.each(function(o,l){var s=_.select(this);s.call(c,n,o,e).call(x,n,S),s.on("click",function(){_.event.defaultPrevented||(i(e,n,o,t,a,r,l),o.execute&&v.executeAPICommand(e,o.method,o.args),e.emit("plotly_buttonclicked",{menu:n,button:o,active:n.active}))}),s.on("mouseover",function(){s.call(h)}),s.on("mouseout",function(){s.call(m,n),u.call(g,n)})}),u.call(g,n),A?(C.w=va(k.openWidth,k.headerWidth),C.h=S.y-C.t):(C.w=S.x-C.l,C.h=va(k.openHeight,k.headerHeight)),C.direction=n.direction,r&&(u.size()?s(e,t,a,r,n,C):d(r))}function s(e,t,a,o,r,n){var l=r.direction,s=r._dims,d=r.active,c,p,u;if("up"===l||"down"===l)for(p=0,u=0;u<d;u++)p+=s.heights[u]+L.gapButton;else for(c=0,u=0;u<d;u++)c+=s.widths[u]+L.gapButton;o.enable(n,c,p),o.hbar&&o.hbar.attr("opacity","0").transition().attr("opacity","1"),o.vbar&&o.vbar.attr("opacity","0").transition().attr("opacity","1")}function d(e){var t=!!e.hbar,a=!!e.vbar;t&&e.hbar.transition().attr("opacity","0").each("end",function(){t=!1,a||e.disable()}),a&&e.vbar.transition().attr("opacity","0").each("end",function(){a=!1,t||e.disable()})}function c(e,t,a,o){e.call(p,t).call(u,t,a,o)}function p(e,t){var a=T.ensureSingle(e,"rect",L.itemRectClassName,function(e){e.attr({rx:L.rx,ry:L.ry,"shape-rendering":"crispEdges"})});a.call(w.stroke,t.bordercolor).call(w.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px")}function u(e,t,a,o){var r=T.ensureSingle(e,"text",L.itemTextClassName,function(e){e.classed("user-select-none",!0).attr({"text-anchor":"start","data-notex":1})});r.call(k.font,t.font).text(a.label).call(A.convertToTspans,o)}function g(e,t){var a=t.active;e.each(function(e,o){var r=_.select(this);o===a&&t.showactive&&r.select("rect."+L.itemRectClassName).call(w.fill,L.activeColor)})}function h(e){e.select("rect."+L.itemRectClassName).call(w.fill,L.hoverColor)}function m(e,t){e.select("rect."+L.itemRectClassName).call(w.fill,t.bgcolor)}function y(e,t){var a=t._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},o=k.tester.selectAll("g."+L.dropdownButtonClassName).data(T.filterVisible(t.buttons));o.enter().append("g").classed(L.dropdownButtonClassName,!0);var r=-1!==["up","down"].indexOf(t.direction);o.each(function(o,n){var i=_.select(this);i.call(c,t,o,e);var l=i.select("."+L.itemTextClassName),s=l.node()&&k.bBox(l.node()).width,d=va(s+L.textPadX,L.minWidth),p=t.font.size*C,u=A.lineCount(l),g=va(p*u,L.minHeight)+L.textOffsetY;g=ae(g),d=ae(d),a.widths[n]=d,a.heights[n]=g,a.height1=va(a.height1,g),a.width1=va(a.width1,d),r?(a.totalWidth=va(a.totalWidth,d),a.openWidth=a.totalWidth,a.totalHeight+=g+L.gapButton,a.openHeight+=g+L.gapButton):(a.totalWidth+=d+L.gapButton,a.openWidth+=d+L.gapButton,a.totalHeight=va(a.totalHeight,g),a.openHeight=a.totalHeight)}),r?a.totalHeight-=L.gapButton:a.totalWidth-=L.gapButton,a.headerWidth=a.width1+L.arrowPadX,a.headerHeight=a.height1,"dropdown"===t.type&&(r?(a.width1+=L.arrowPadX,a.totalHeight=a.height1):a.totalWidth=a.width1,a.totalWidth+=L.arrowPadX),o.remove();var i=a.totalWidth+t.pad.l+t.pad.r,n=a.totalHeight+t.pad.t+t.pad.b,l=e._fullLayout._size;a.lx=l.l+l.w*t.x,a.ly=l.t+l.h*(1-t.y);var s="left";T.isRightAnchor(t)&&(a.lx-=i,s="right"),T.isCenterAnchor(t)&&(a.lx-=i/2,s="center");var d="top";T.isBottomAnchor(t)&&(a.ly-=n,d="bottom"),T.isMiddleAnchor(t)&&(a.ly-=n/2,d="middle"),a.totalWidth=ae(a.totalWidth),a.totalHeight=ae(a.totalHeight),a.lx=R(a.lx),a.ly=R(a.ly),v.autoMargin(e,f(t),{x:t.x,y:t.y,l:i*({right:1,center:.5}[s]||0),r:i*({left:1,center:.5}[s]||0),b:n*({top:1,middle:.5}[d]||0),t:n*({bottom:1,middle:.5}[d]||0)})}function f(e){return L.autoMarginIdRoot+e._index}function x(e,t,a,o){o=o||{};var r=e.select("."+L.itemRectClassName),i=e.select("."+L.itemTextClassName),n=t.borderwidth,l=a.index,s=t._dims;k.setTranslate(e,n+a.x,n+a.y);var d=-1!==["up","down"].indexOf(t.direction),c=o.height||(d?s.heights[l]:s.height1);r.attr({x:0,y:0,width:o.width||(d?s.width1:s.widths[l]),height:c});var p=t.font.size*C,u=A.lineCount(i);A.positionText(i,L.textOffsetX,c/2-(u-1)*p/2+L.textOffsetY),d?a.y+=s.heights[l]+a.yPad:a.x+=s.widths[l]+a.xPad,a.index++}function b(e,t){e.attr(L.menuIndexAttrName,t||"-1").selectAll("g."+L.dropdownButtonClassName).remove()}var _=e("d3"),v=e("../../plots/plots"),w=e("../color"),k=e("../drawing"),T=e("../../lib"),A=e("../../lib/svg_text_utils"),S=e("../../plot_api/plot_template").arrayEditor,C=e("../../constants/alignment").LINE_SPACING,L=e("./constants"),E=e("./scrollbox");t.exports=function(e){function t(t){v.autoMargin(e,f(t))}var o=e._fullLayout,s=T.filterVisible(o[L.name]),d=o._menulayer.selectAll("g."+L.containerClassName).data(0<s.length?[0]:[]);if(d.enter().append("g").classed(L.containerClassName,!0).style("cursor","pointer"),d.exit().each(function(){_.select(this).selectAll("g."+L.headerGroupClassName).each(t)}).remove(),0!==s.length){var c=d.selectAll("g."+L.headerGroupClassName).data(s,a);c.enter().append("g").classed(L.headerGroupClassName,!0);for(var p=T.ensureSingle(d,"g",L.dropdownButtonGroupClassName,function(e){e.style("pointer-events","all")}),u=0,g;u<s.length;u++)g=s[u],y(e,g);var h="updatemenus"+o._uid,m=new E(e,p,h);c.enter().size()&&(p.node().parentNode.appendChild(p.node()),p.call(b)),c.exit().each(function(e){p.call(b),t(e)}).remove(),c.each(function(t){var a=_.select(this),o="dropdown"===t.type?p:null;v.manageCommandObserver(e,t,t.buttons,function(r){i(e,t,t.buttons[r.index],a,o,m,r.index,!0)}),"dropdown"===t.type?(n(e,a,p,m,t),r(p,t)&&l(e,a,p,m,t)):l(e,a,null,null,t)})}}},{"../../constants/alignment":664,"../../lib":692,"../../lib/svg_text_utils":716,"../../plot_api/plot_template":730,"../../plots/plots":804,"../color":569,"../drawing":590,"./constants":659,"./scrollbox":663,d3:148}],662:[function(e,t,a){arguments[4][656][0].apply(a,arguments)},{"./attributes":658,"./constants":659,"./defaults":660,"./draw":661,dup:656}],663:[function(e,t){"use strict";function a(e,t,a){this.gd=e,this.container=t,this.id=a,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}t.exports=a;var o=e("d3"),r=e("../color"),i=e("../drawing"),n=e("../../lib");a.barWidth=2,a.barLength=20,a.barRadius=2,a.barPad=1,a.barColor="#808BA4",a.prototype.enable=function(e,n,s){var d=this.gd._fullLayout,c=d.width,p=d.height;this.position=e;var u=this.position.l,l=this.position.w,g=this.position.t,t=this.position.h,h=this.position.direction,m="down"===h,y="left"===h,f="up"===h,x=l,b=t,_,v,w,k;m||y||"right"===h||f||(this.position.direction="down",m=!0);var T=m||f;T?(_=u,v=_+x,m?(w=g,k=ie(w+b,p),b=k-w):(k=g+b,w=va(k-b,0),b=k-w)):(w=g,k=w+b,y?(v=u+x,_=va(v-x,0),x=v-_):(_=u,v=ie(_+x,c),x=v-_)),this._box={l:_,t:w,w:x,h:b};var A=l>x,S=a.barLength+2*a.barPad,C=a.barWidth+2*a.barPad,L=u,E=g+t;E+C>p&&(E=p-C);var z=this.container.selectAll("rect.scrollbar-horizontal").data(A?[0]:[]);z.exit().on(".drag",null).remove(),z.enter().append("rect").classed("scrollbar-horizontal",!0).call(r.fill,a.barColor),A?(this.hbar=z.attr({rx:a.barRadius,ry:a.barRadius,x:L,y:E,width:S,height:C}),this._hbarXMin=L+S/2,this._hbarTranslateMax=x-S):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var I=t>b,D=a.barWidth+2*a.barPad,P=a.barLength+2*a.barPad,O=u+l,R=g;O+D>c&&(O=c-D);var M=this.container.selectAll("rect.scrollbar-vertical").data(I?[0]:[]);M.exit().on(".drag",null).remove(),M.enter().append("rect").classed("scrollbar-vertical",!0).call(r.fill,a.barColor),I?(this.vbar=M.attr({rx:a.barRadius,ry:a.barRadius,x:O,y:R,width:D,height:P}),this._vbarYMin=R+P/2,this._vbarTranslateMax=b-P):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var j=this.id,B=_-.5,F=I?v+D+.5:v+.5,N=w-.5,V=A?k+C+.5:k+.5,U=d._topdefs.selectAll("#"+j).data(A||I?[0]:[]);if(U.exit().remove(),U.enter().append("clipPath").attr("id",j).append("rect"),A||I?(this._clipRect=U.select("rect").attr({x:ea(B),y:ea(N),width:ae(F)-ea(B),height:ae(V)-ea(N)}),this.container.call(i.setClipUrl,j,this.gd),this.bg.attr({x:u,y:g,width:l,height:t})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(i.setClipUrl,null),delete this._clipRect),A||I){var H=o.behavior.drag().on("dragstart",function(){o.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(H);var G=o.behavior.drag().on("dragstart",function(){o.event.sourceEvent.preventDefault(),o.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));A&&this.hbar.on(".drag",null).call(G),I&&this.vbar.on(".drag",null).call(G)}this.setTranslate(n,s)},a.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(i.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},a.prototype._onBoxDrag=function(){var e=this.translateX,t=this.translateY;this.hbar&&(e-=o.event.dx),this.vbar&&(t-=o.event.dy),this.setTranslate(e,t)},a.prototype._onBoxWheel=function(){var e=this.translateX,t=this.translateY;this.hbar&&(e+=o.event.deltaY),this.vbar&&(t+=o.event.deltaY),this.setTranslate(e,t)},a.prototype._onBarDrag=function(){var e=this.translateX,t=this.translateY;if(this.hbar){var a=e+this._hbarXMin,r=a+this._hbarTranslateMax,i=n.constrain(o.event.x,a,r),l=this.position.w-this._box.w;e=(i-a)/(r-a)*l}if(this.vbar){var s=t+this._vbarYMin,d=s+this._vbarTranslateMax,c=n.constrain(o.event.y,s,d),p=this.position.h-this._box.h;t=(c-s)/(d-s)*p}this.setTranslate(e,t)},a.prototype.setTranslate=function(e,t){var a=this.position.w-this._box.w,o=this.position.h-this._box.h;if(e=n.constrain(e||0,0,a),t=n.constrain(t||0,0,o),this.translateX=e,this.translateY=t,this.container.call(i.setTranslate,this._box.l-this.position.l-e,this._box.t-this.position.t-t),this._clipRect&&this._clipRect.attr({x:ea(this.position.l+e-.5),y:ea(this.position.t+t-.5)}),this.hbar){var r=e/a;this.hbar.call(i.setTranslate,e+r*this._hbarTranslateMax,t)}if(this.vbar){var l=t/o;this.vbar.call(i.setTranslate,e,t+l*this._vbarTranslateMax)}}},{"../../lib":692,"../color":569,"../drawing":590,d3:148}],664:[function(e,t){"use strict";t.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],665:[function(e,t){"use strict";t.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],666:[function(e,t){"use strict";t.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],667:[function(e,t){"use strict";t.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],668:[function(e,t){"use strict";t.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DBLCLICKDELAY:300,DESELECTDIM:.2}},{}],669:[function(e,t){"use strict";t.exports={BADNUM:void 0,FP_SAFE:Number.MAX_VALUE/1e4,ONEAVGYEAR:315576e5,ONEAVGMONTH:26298e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:1-1e-6,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],670:[function(e,t,a){"use strict";a.xmlns="http://www.w3.org/2000/xmlns/",a.svg="http://www.w3.org/2000/svg",a.xlink="http://www.w3.org/1999/xlink",a.svgAttrs={xmlns:a.svg,"xmlns:xlink":a.xlink}},{}],671:[function(e,t,a){"use strict";a.version="1.43.1",e("es6-promise").polyfill(),e("../build/plotcss"),e("./fonts/mathjax_config")();for(var o=e("./registry"),r=a.register=o.register,n=e("./plot_api"),l=Object.keys(n),s=0,d;s<l.length;s++)d=l[s],"_"!==d.charAt(0)&&(a[d]=n[d]),r({moduleType:"apiMethod",name:d,fn:n[d]});r(e("./traces/scatter")),r([e("./components/fx"),e("./components/legend"),e("./components/annotations"),e("./components/annotations3d"),e("./components/shapes"),e("./components/images"),e("./components/updatemenus"),e("./components/sliders"),e("./components/rangeslider"),e("./components/rangeselector"),e("./components/grid"),e("./components/errorbars"),e("./components/colorscale")]),r([e("./locale-en"),e("./locale-en-us")]),a.Icons=e("../build/ploticon"),a.Plots=e("./plots/plots"),a.Fx=e("./components/fx"),a.Snapshot=e("./snapshot"),a.PlotSchema=e("./plot_api/plot_schema"),a.Queue=e("./lib/queue"),a.d3=e("d3")},{"../build/plotcss":1,"../build/ploticon":2,"./components/annotations":560,"./components/annotations3d":565,"./components/colorscale":581,"./components/errorbars":596,"./components/fx":608,"./components/grid":612,"./components/images":617,"./components/legend":625,"./components/rangeselector":636,"./components/rangeslider":643,"./components/shapes":651,"./components/sliders":656,"./components/updatemenus":662,"./fonts/mathjax_config":672,"./lib/queue":707,"./locale-en":721,"./locale-en-us":720,"./plot_api":725,"./plot_api/plot_schema":729,"./plots/plots":804,"./registry":823,"./snapshot":828,"./traces/scatter":1052,d3:148,"es6-promise":203}],672:[function(e,t){"use strict";t.exports=function(){if("undefined"!=typeof MathJax){var e="local"!==(window.PlotlyConfig||{}).MathJaxConfig;e&&(MathJax.Hub.Config({messageStyle:"none",skipStartupTypeset:!0,displayAlign:"left",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}}),MathJax.Hub.Configured())}}},{}],673:[function(e,t,a){"use strict";a.isLeftAnchor=function(e){return"left"===e.xanchor||"auto"===e.xanchor&&e.x<=1/3},a.isCenterAnchor=function(e){return"center"===e.xanchor||"auto"===e.xanchor&&e.x>1/3&&e.x<2/3},a.isRightAnchor=function(e){return"right"===e.xanchor||"auto"===e.xanchor&&e.x>=2/3},a.isTopAnchor=function(e){return"top"===e.yanchor||"auto"===e.yanchor&&e.y>=2/3},a.isMiddleAnchor=function(e){return"middle"===e.yanchor||"auto"===e.yanchor&&e.y>1/3&&e.y<2/3},a.isBottomAnchor=function(e){return"bottom"===e.yanchor||"auto"===e.yanchor&&e.y<=1/3}},{}],674:[function(e,t){"use strict";function o(e){return wa(e[1]-e[0])>u-1e-15}function r(e,t){return d(t-e,u)}function i(e,t){if(o(t))return!0;var a,r;t[0]<t[1]?(a=t[0],r=t[1]):(a=t[1],r=t[0]),a=s(a,u),r=s(r,u),a>r&&(r+=u);var i=s(e,u),n=i+u;return i>=a&&i<=r||n>=a&&n<=r}function n(e,t,a,r,i,n,l){function s(e,t){return[e*te(t)+i,n-e*M(t)]}function d(e,t,a){return"A"+[e,e]+" "+[0,b,a]+" "+s(e,t)}i=i||0,n=n||0;var g=o([a,r]),h,m,y,f,x;g?(h=0,m=c,y=u):a<r?(h=a,y=r):(h=r,y=a),e<t?(f=e,x=t):(f=t,x=e);var b=wa(y-h)<=c?0:1,_;return g?null===f?_="M"+s(x,h)+d(x,m,0)+d(x,y,0)+"Z":_="M"+s(f,h)+d(f,m,0)+d(f,y,0)+"ZM"+s(x,h)+d(x,m,1)+d(x,y,1)+"Z":null===f?(_="M"+s(x,h)+d(x,y,0),l&&(_+="L0,0Z")):_="M"+s(f,h)+"L"+s(x,h)+d(x,y,0)+"L"+s(f,y)+d(f,h,1)+"Z",_}var l=e("./mod"),s=l.mod,d=l.modHalf,c=Sa,u=2*c;t.exports={deg2rad:function(e){return e/180*c},rad2deg:function(e){return 180*(e/c)},angleDelta:r,angleDist:function(e,t){return wa(r(e,t))},isFullCircle:o,isAngleInsideSector:i,isPtInsideSector:function(e,t,a,o){if(!i(t,o))return!1;var r,n;return a[0]<a[1]?(r=a[0],n=a[1]):(r=a[1],n=a[0]),e>=r&&e<=n},pathArc:function(e,t,a,o,r){return n(null,e,t,a,o,r,0)},pathSector:function(e,t,a,o,r){return n(null,e,t,a,o,r,1)},pathAnnulus:function(e,t,a,o,r,i){return n(e,t,a,o,r,i,1)}}},{"./mod":699}],675:[function(e,t,a){"use strict";function o(e){return s.isView(e)&&!(e instanceof n)}function r(e){return l(e)||o(e)}function i(e,t,a){if(r(e)){if(r(e[0])){for(var o=a,n=0;n<e.length;n++)o=t(o,e[n].length);return o}return e.length}return 0}var l=Array.isArray,s="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer:{isView:function(){return!1}},n="undefined"==typeof DataView?function(){}:DataView;a.isTypedArray=o,a.isArrayOrTypedArray=r,a.isArray1D=function(e){return!r(e[0])},a.ensureArray=function(e,t){return l(e)||(e=[]),e.length=t,e},a.concat=function(){var e=[],t=!0,a=0,o,r,n,s,d,c,p,u;for(n=0;n<arguments.length;n++)s=arguments[n],c=s.length,c&&(r?e.push(s):(r=s,d=c),l(s)?o=!1:(t=!1,a?o!==s.constructor&&(o=!1):o=s.constructor),a+=c);if(!a)return[];if(!e.length)return r;if(t)return r.concat.apply(r,e);if(o){for(p=new o(a),p.set(r),n=0;n<e.length;n++)s=e[n],p.set(s,d),d+=s.length;return p}for(p=Array(a),u=0;u<r.length;u++)p[u]=r[u];for(n=0;n<e.length;n++){for(s=e[n],u=0;u<s.length;u++)p[d+u]=s[u];d+=u}return p},a.maxRowLength=function(e){return i(e,Math.max,0)},a.minRowLength=function(e){return i(e,Math.min,1/0)}},{}],676:[function(e,t){"use strict";var a=e("fast-isnumeric"),o=e("../constants/numerical").BADNUM,r=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;t.exports=function(e){return"string"==typeof e&&(e=e.replace(r,"")),a(e)?+e:o}},{"../constants/numerical":669,"fast-isnumeric":214}],677:[function(e,t){"use strict";t.exports=function(e){var t=e._fullLayout;t._glcanvas&&t._glcanvas.size()&&t._glcanvas.each(function(e){e.regl&&e.regl.clear({color:!0,depth:!0})})}},{}],678:[function(e,t){"use strict";t.exports=function(e){e._responsiveChartHandler&&(window.removeEventListener("resize",e._responsiveChartHandler),delete e._responsiveChartHandler)}},{}],679:[function(e,t,a){"use strict";function o(e,t){var o=a.valObjectMeta[t.valType];if(t.arrayOk&&u(e))return!0;if(o.validateFunction)return o.validateFunction(e,t);var r={},i=r;return o.coerceFunction(e,{set:function(e){i=e}},r,t),i!==r}var r=e("fast-isnumeric"),i=e("tinycolor2"),n=e("../plots/attributes"),l=e("../components/colorscale/scales"),s=e("../constants/interactions").DESELECTDIM,d=e("./nested_property"),c=e("./regex").counter,p=e("./mod").modHalf,u=e("./array").isArrayOrTypedArray;a.valObjectMeta={data_array:{coerceFunction:function(e,t,a){u(e)?t.set(e):a!==void 0&&t.set(a)}},enumerated:{coerceFunction:function(e,t,a,o){o.coerceNumber&&(e=+e),-1===o.values.indexOf(e)?t.set(a):t.set(e)},validateFunction:function(e,t){t.coerceNumber&&(e=+e);for(var a=t.values,o=0,r;o<a.length;o++)if(r=a[o]+"","/"===r.charAt(0)&&"/"===r.charAt(r.length-1)){var n=new RegExp(r.substr(1,r.length-2));if(n.test(e))return!0}else if(e===a[o])return!0;return!1}},boolean:{coerceFunction:function(e,t,a){!0===e||!1===e?t.set(e):t.set(a)}},number:{coerceFunction:function(e,t,a,o){!r(e)||o.min!==void 0&&e<o.min||o.max!==void 0&&e>o.max?t.set(a):t.set(+e)}},integer:{coerceFunction:function(e,t,a,o){e%1||!r(e)||o.min!==void 0&&e<o.min||o.max!==void 0&&e>o.max?t.set(a):t.set(+e)}},string:{coerceFunction:function(e,t,a,o){if("string"!=typeof e){!0!==o.strict&&"number"==typeof e?t.set(e+""):t.set(a)}else o.noBlank&&!e?t.set(a):t.set(e)}},color:{coerceFunction:function(e,t,a){i(e).isValid()?t.set(e):t.set(a)}},colorlist:{coerceFunction:function(e,t,a){Array.isArray(e)&&e.length?e.every(function(e){return i(e).isValid()})?t.set(e):t.set(a):t.set(a)}},colorscale:{coerceFunction:function(e,t,a){t.set(l.get(e,a))}},angle:{coerceFunction:function(e,t,a){"auto"===e?t.set("auto"):r(e)?t.set(p(+e,360)):t.set(a)}},subplotid:{coerceFunction:function(e,t,a,o){var r=o.regex||c(a);return"string"==typeof e&&r.test(e)?void t.set(e):void t.set(a)},validateFunction:function(e,t){var a=t.dflt;return!(e!==a)||!("string"!=typeof e)&&!!c(a).test(e)}},flaglist:{coerceFunction:function(e,t,a,o){if("string"!=typeof e)return void t.set(a);if(-1!==(o.extras||[]).indexOf(e))return void t.set(e);for(var r=e.split("+"),n=0;n<r.length;){var l=r[n];-1===o.flags.indexOf(l)||r.indexOf(l)<n?r.splice(n,1):n++}r.length?t.set(r.join("+")):t.set(a)}},any:{coerceFunction:function(e,t,a){e===void 0?t.set(a):t.set(e)}},info_array:{coerceFunction:function(e,t,o,r){function n(e,t,o){var r;return void 0===o&&(o=t.dflt),a.valObjectMeta[t.valType].coerceFunction(e,{set:function(e){r=e}},o,t),r}var l=2===r.dimensions||"1-2"===r.dimensions&&Array.isArray(e)&&Array.isArray(e[0]);if(!Array.isArray(e))return void t.set(o);var s=r.items,d=[],c=Array.isArray(s),p=c&&l&&Array.isArray(s[0]),u=l&&c&&!p,g=c&&!u?s.length:e.length,h,m,y,f,x,b;if(o=Array.isArray(o)?o:[],l)for(h=0;h<g;h++)for(d[h]=[],y=Array.isArray(e[h])?e[h]:[],x=u?s.length:c?s[h].length:y.length,m=0;m<x;m++)f=u?s[m]:c?s[h][m]:s,b=n(y[m],f,(o[h]||[])[m]),void 0!==b&&(d[h][m]=b);else for(h=0;h<g;h++)b=n(e[h],c?s[h]:s,o[h]),void 0!==b&&(d[h]=b);t.set(d)},validateFunction:function(e,t){if(!Array.isArray(e))return!1;var a=t.items,r=Array.isArray(a),n=2===t.dimensions;if(!t.freeLength&&e.length!==a.length)return!1;for(var l=0;l<e.length;l++)if(n){if(!Array.isArray(e[l])||!t.freeLength&&e[l].length!==a[l].length)return!1;for(var s=0;s<e[l].length;s++)if(!o(e[l][s],r?a[l][s]:a))return!1}else if(!o(e[l],r?a[l]:a))return!1;return!0}}},a.coerce=function(e,t,r,i,n){var l=d(r,i).get(),s=d(e,i),c=d(t,i),p=s.get(),g=t._template;if(void 0===p&&g&&(p=d(g,i).get(),g=0),void 0===n&&(n=l.dflt),l.arrayOk&&u(p))return c.set(p),p;var h=a.valObjectMeta[l.valType].coerceFunction;h(p,c,n,l);var m=c.get();return g&&m===n&&!o(p,l)&&(p=d(g,i).get(),h(p,c,n,l),m=c.get()),m},a.coerce2=function(e,t,o,r,i){var n=d(e,r),l=a.coerce(e,t,o,r,i),s=n.get();return!(s===void 0||null===s)&&l},a.coerceFont=function(e,t,a){var o={};return a=a||{},o.family=e(t+".family",a.family),o.size=e(t+".size",a.size),o.color=e(t+".color",a.color),o},a.coerceHoverinfo=function(e,t,o){var r=t._module.attributes,i=r.hoverinfo?r:n,l=i.hoverinfo,s;if(1===o._dataLength){var d="all"===l.dflt?l.flags.slice():l.dflt.split("+");d.splice(d.indexOf("name"),1),s=d.join("+")}return a.coerce(e,t,i,"hoverinfo",s)},a.coerceSelectionMarkerOpacity=function(e,t){if(e.marker){var a=e.marker.opacity;if(void 0!==a){var o,r;u(a)||e.selected||e.unselected||(o=a,r=s*a),t("selected.marker.opacity",o),t("unselected.marker.opacity",r)}}},a.validate=o},{"../components/colorscale/scales":584,"../constants/interactions":668,"../plots/attributes":737,"./array":675,"./mod":699,"./nested_property":700,"./regex":708,"fast-isnumeric":214,tinycolor2:513}],680:[function(e,t,a){"use strict";function o(e){return e&&k.componentsRegistry.calendars&&"string"==typeof e&&"gregorian"!==e}function r(e,t){return(e+_a(10,t)+"").substr(1)}function i(e,t,a,o,i){if((t||a||o||i)&&(e+=" "+r(t,2)+":"+r(a,2),(o||i)&&(e+=":"+r(o,2),i))){for(var n=4;0==i%10;)n-=1,i/=10;e+="."+r(i,n)}return e}function n(e,t,a,r){e=e.replace(O,function(e){var a=ie(+e.charAt(1)||6,6),o=(t/1e3%1+2).toFixed(a).substr(2).replace(/0+$/,"")||"0";return o});var i=new Date(ea(t+.05));if(o(r))try{e=k.getComponentMethod("calendars","worldCalFmt")(e,t,r)}catch(t){return"Invalid"}return a(e)(i)}function l(e,t){var a=p(e+.05,f),o=r(ea(a/b),2)+":"+r(p(ea(a/_),60),2);if("M"!==t){s(t)||(t=0);var i=ie(p(e/v,60),M[t]),n=(100+i).toFixed(t).substr(1);0<t&&(n=n.replace(/0+$/,"").replace(/[\.]$/,"")),o+=":"+n}return o}var c=e("d3"),s=e("fast-isnumeric"),d=e("./loggers"),p=e("./mod").mod,u=e("../constants/numerical"),g=u.BADNUM,f=u.ONEDAY,b=u.ONEHOUR,_=u.ONEMIN,v=u.ONESEC,w=u.EPOCHJD,k=e("../registry"),T=c.time.format.utc,A=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m,C=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m,L=new Date().getFullYear()-70;a.dateTick0=function(e,t){return o(e)?t?k.getComponentMethod("calendars","CANONICAL_SUNDAY")[e]:k.getComponentMethod("calendars","CANONICAL_TICK")[e]:t?"2000-01-02":"2000-01-01"},a.dfltRange=function(e){return o(e)?k.getComponentMethod("calendars","DFLTRANGE")[e]:["2000-01-01","2001-01-01"]},a.isJSDate=function(e){return"object"==typeof e&&null!==e&&"function"==typeof e.getTime};var E,z;a.dateTime2ms=function(e,t){if(a.isJSDate(e)){var r=e.getTimezoneOffset()*_,i=(e.getUTCMinutes()-e.getMinutes())*_+(e.getUTCSeconds()-e.getSeconds())*v+(e.getUTCMilliseconds()-e.getMilliseconds());if(i){var n=3*_;r=r-n/2+p(i-r+n/2,n)}return e=+e-r,e>=E&&e<=z?e:g}if("string"!=typeof e&&"number"!=typeof e)return g;e+="";var l=o(t),c=e.charAt(0);l&&("G"===c||"g"===c)&&(e=e.substr(1),t="");var u=l&&"chinese"===t.substr(0,7),h=e.match(u?C:A);if(!h)return g;var x=h[1],T=h[3]||"1",I=+(h[5]||1),d=+(h[7]||0),D=+(h[9]||0),P=+(h[11]||0);if(l){if(2===x.length)return g;x=+x;var S;try{var O=k.getComponentMethod("calendars","getCal")(t);if(u){var R="i"===T.charAt(T.length-1);T=parseInt(T,10),S=O.newDate(x,O.toMonthIndex(x,T,R),I)}else S=O.newDate(x,+T,I)}catch(t){return g}return S?(S.toJD()-w)*f+d*b+D*_+P*v:g}x=2===x.length?(+x+2e3-L)%100+L:+x,T-=1;var M=new Date(Date.UTC(2e3,T,I,d,D));return M.setUTCFullYear(x),M.getUTCMonth()===T?M.getUTCDate()===I?M.getTime()+P*v:g:g},E=a.MIN_MS=a.dateTime2ms("-9999"),z=a.MAX_MS=a.dateTime2ms("9999-12-31 23:59:59.9999"),a.isDateTime=function(e,t){return a.dateTime2ms(e,t)!==g};var I=90*f,D=3*b,P=5*_;a.ms2DateTime=function(e,t,a){if("number"!=typeof e||!(e>=E&&e<=z))return g;t||(t=0);var n=ea(10*p(e+.05,1)),l=R(e-n/10),c,u,y,x,A,S;if(o(a)){var C=ea(l/f)+w,L=ea(p(e,f));try{c=k.getComponentMethod("calendars","getCal")(a).fromJD(C).formatDate("yyyy-mm-dd")}catch(t){c=T("G%Y-%m-%d")(new Date(l))}if("-"===c.charAt(0))for(;11>c.length;)c="-0"+c.substr(1);else for(;10>c.length;)c="0"+c;u=t<I?ea(L/b):0,y=t<I?ea(L%b/_):0,x=t<D?ea(L%_/v):0,A=t<P?10*(L%v)+n:0}else S=new Date(l),c=T("%Y-%m-%d")(S),u=t<I?S.getUTCHours():0,y=t<I?S.getUTCMinutes():0,x=t<D?S.getUTCSeconds():0,A=t<P?10*S.getUTCMilliseconds()+n:0;return i(c,u,y,x,A)},a.ms2DateTimeLocal=function(e){if(!(e>=E+f&&e<=z-f))return g;var t=ea(10*p(e+.05,1)),a=new Date(R(e-t/10)),o=c.time.format("%Y-%m-%d")(a),r=a.getHours(),n=a.getMinutes(),l=a.getSeconds(),s=10*a.getUTCMilliseconds()+t;return i(o,r,n,l,s)},a.cleanDate=function(e,t,r){if(e===g)return t;if(a.isJSDate(e)||"number"==typeof e&&isFinite(e)){if(o(r))return d.error("JS Dates and milliseconds are incompatible with world calendars",e),t;if(e=a.ms2DateTimeLocal(+e),!e&&void 0!==t)return t}else if(!a.isDateTime(e,r))return d.error("unrecognized date",e),t;return e};var O=/%\d?f/g,M=[59,59.9,59.99,59.999,59.9999];a.formatDate=function(e,t,a,r,i,s){if(i=o(i)&&i,!t)if("y"===a)t=s.year;else if("m"===a)t=s.month;else if("d"===a)t=s.dayMonth+"\n"+s.year;else return l(e,a)+"\n"+n(s.dayMonthYear,e,r,i);return n(t,e,r,i)};var j=3*f;a.incrementMonth=function(t,e,a){a=o(a)&&a;var r=p(t,f);if(t=R(t-r),a)try{var i=R(t/f)+w,n=k.getComponentMethod("calendars","getCal")(a),l=n.fromJD(i);return e%12?n.add(l,e,"m"):n.add(l,e/12,"y"),(l.toJD()-w)*f+r}catch(o){d.error("invalid ms "+t+" in calendar "+a)}var s=new Date(t+j);return s.setUTCMonth(s.getUTCMonth()+e)+r-j},a.findExactDates=function(e,t){for(var a=0,r=0,n=0,l=0,c=o(t)&&k.getComponentMethod("calendars","getCal")(t),p=0,u,g;p<e.length;p++){if(g=e[p],!s(g)){l++;continue}if(!(g%f))if(c)try{u=c.fromJD(g/f+w),1===u.day()?1===u.month()?a++:r++:n++}catch(t){}else u=new Date(g),1===u.getUTCDate()?0===u.getUTCMonth()?a++:r++:n++}r+=a,n+=r;var h=e.length-l;return{exactYears:a/h,exactMonths:r/h,exactDays:n/h}}},{"../constants/numerical":669,"../registry":823,"./loggers":696,"./mod":699,d3:148,"fast-isnumeric":214}],681:[function(e,t){"use strict";var a=e("events").EventEmitter;t.exports={init:function(e){if(e._ev instanceof a)return e;var t=new a,o=new a;return e._ev=t,e._internalEv=o,e.on=t.on.bind(t),e.once=t.once.bind(t),e.removeListener=t.removeListener.bind(t),e.removeAllListeners=t.removeAllListeners.bind(t),e._internalOn=o.on.bind(o),e._internalOnce=o.once.bind(o),e._removeInternalListener=o.removeListener.bind(o),e._removeAllInternalListeners=o.removeAllListeners.bind(o),e.emit=function(a,r){"undefined"!=typeof jQuery&&jQuery(e).trigger(a,r),t.emit(a,r),o.emit(a,r)},e},triggerHandler:function(e,t,a){function o(e){return e.listener?(l.removeListener(t,e.listener),!e.fired)?(e.fired=!0,e.listener.apply(l,[a])):void 0:e.apply(l,[a])}var r,n;"undefined"!=typeof jQuery&&(r=jQuery(e).triggerHandler(t,a));var l=e._ev;if(!l)return r;var s=l._events[t];if(!s)return r;s=Array.isArray(s)?s:[s];var d;for(d=0;d<s.length-1;d++)o(s[d]);return n=o(s[d]),void 0===r?n:r},purge:function(e){return delete e._ev,delete e.on,delete e.once,delete e.removeListener,delete e.removeAllListeners,delete e.emit,delete e._ev,delete e._internalEv,delete e._internalOn,delete e._internalOnce,delete e._removeInternalListener,delete e._removeAllInternalListeners,e}}},{events:92}],682:[function(e,t,a){"use strict";function o(e,t){var a,o;for(a=0;a<e.length;a++){if(o=e[a],null!==o&&"object"==typeof o)return!1;void 0!==o&&(t[a]=o)}return!0}function r(e,t,a,s){var d=e[0],c=e.length,p,u,g,h,m,y,f;if(2===c&&l(d)&&l(e[1])&&0===d.length){if(f=o(e[1],d),f)return d;d.splice(0,d.length)}for(var x=1;x<c;x++)for(u in p=e[x],p)g=d[u],h=p[u],s&&l(h)?d[u]=h:t&&h&&(n(h)||(m=l(h)))?(m?(m=!1,y=g&&l(g)?g:[]):y=g&&n(g)?g:{},d[u]=r([y,h],t,a,s)):("undefined"!=typeof h||a)&&(d[u]=h);return d}var n=e("./is_plain_object.js"),l=Array.isArray;a.extendFlat=function(){return r(arguments,!1,!1,!1)},a.extendDeep=function(){return r(arguments,!0,!1,!1)},a.extendDeepAll=function(){return r(arguments,!0,!0,!1)},a.extendDeepNoArrays=function(){return r(arguments,!0,!1,!0)}},{"./is_plain_object.js":693}],683:[function(e,t){"use strict";t.exports=function(e){for(var t={},a=[],o=0,r=0,n;r<e.length;r++)n=e[r],1!==t[n]&&(t[n]=1,a[o++]=n);return a}},{}],684:[function(e,t){"use strict";function a(e){return!0===e.visible}function o(e){return!0===e[0].trace.visible}function r(e){return Array.isArray(e)&&Array.isArray(e[0])&&e[0][0]&&e[0][0].trace}t.exports=function(e){for(var t=r(e)?o:a,n=[],l=0,s;l<e.length;l++)s=e[l],t(s)&&n.push(s);return n}},{}],685:[function(e,t,a){"use strict";function o(e,t){var a=s[e];return a(t)}var r=e("country-regex"),n=e("../lib"),l=Object.keys(r),s={"ISO-3":n.identity,"USA-states":n.identity,"country names":function(e){for(var t=0;t<l.length;t++){var a=l[t],o=new RegExp(r[a]);if(o.test(e.trim().toLowerCase()))return a}return n.log("Unrecognized country name: "+e+"."),!1}};a.locationToFeature=function(e,t,a){if(!t||"string"!=typeof t)return!1;var r=o(e,t);if(r){for(var l=0,s;l<a.length;l++)if(s=a[l],s.id===r)return s;n.log(["Location with id",r,"does not have a matching topojson feature at this resolution."].join(" "))}return!1}},{"../lib":692,"country-regex":122}],686:[function(e,t,a){"use strict";var o=e("../constants/numerical").BADNUM;a.calcTraceToLineCoords=function(e){for(var t=e[0].trace,a=t.connectgaps,r=[],n=[],l=0;l<e.length;l++){var s=e[l],d=s.lonlat;d[0]===o?!a&&0<n.length&&(r.push(n),n=[]):n.push(d)}return 0<n.length&&r.push(n),r},a.makeLine=function(e){return 1===e.length?{type:"LineString",coordinates:e[0]}:{type:"MultiLineString",coordinates:e}},a.makePolygon=function(e){if(1===e.length)return{type:"Polygon",coordinates:e};for(var t=Array(e.length),a=0;a<e.length;a++)t[a]=[e[a]];return{type:"MultiPolygon",coordinates:t}},a.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":669}],687:[function(e,t,a){"use strict";function o(o,r,i,n,l,s,p,g){var h=i-o,a=l-o,m=p-l,c=n-r,d=s-r,e=g-s,y=h*e-m*c;if(0==y)return null;var f=(a*e-m*d)/y,t=(a*c-h*d)/y;return 0>t||1<t||0>f||1<f?null:{x:o+h*f,y:r+c*f}}function r(e,t,a,o,r){var i=o*e+r*t;if(0>i)return o*o+r*r;if(i>a){var n=o-e,l=r-t;return n*n+l*l}var s=o*t-r*e;return s*s/a}var i=e("./mod").mod;a.segmentsIntersect=o,a.segmentDistance=function(e,t,a,i,n,l,s,d){if(o(e,t,a,i,n,l,s,d))return 0;var c=a-e,p=i-t,u=s-n,g=d-l,h=c*c+p*p,m=u*u+g*g,y=ie(r(c,p,h,n-e,l-t),r(c,p,h,s-e,d-t),r(u,g,m,e-n,t-l),r(u,g,m,a-n,i-l));return re(y)};var n,l,s;a.getTextLocation=function(e,t,a,o){if((e!==l||o!==s)&&(n={},l=e,s=o),n[a])return n[a];var r=e.getPointAtLength(i(a-o/2,t)),d=e.getPointAtLength(i(a+o/2,t)),c=k((d.y-r.y)/(d.x-r.x)),p=e.getPointAtLength(i(a,t)),u=(4*p.x+r.x+d.x)/6,g=(4*p.y+r.y+d.y)/6,h={x:u,y:g,theta:c};return n[a]=h,h},a.clearLocationCache=function(){l=null},a.getVisibleSegment=function(e,t,a){function o(t){var a=e.getPointAtLength(t);0===t?u=a:t===d&&(g=a);var o=a.x<r?r-a.x:a.x>i?a.x-i:0,s=a.y<n?n-a.y:a.y>l?a.y-l:0;return re(o*o+s*s)}for(var r=t.left,i=t.right,n=t.top,l=t.bottom,s=0,d=e.getTotalLength(),c=d,p=o(s),u,g;p;){if(s+=p+a,s>c)return;p=o(s)}for(p=o(c);p;){if(c-=p+a,s>c)return;p=o(c)}return{min:s,max:c,len:c-s,total:d,isClosed:0===s&&c===d&&.1>wa(u.x-g.x)&&.1>wa(u.y-g.y)}},a.findPointOnPath=function(e,t,a,o){o=o||{};for(var r=o.pathLength||e.getTotalLength(),n=o.tolerance||1e-3,l=o.iterationLimit||30,s=e.getPointAtLength(0)[a]>e.getPointAtLength(r)[a]?-1:1,d=0,c=0,p=r,u,g,h;d<l;){if(u=(c+p)/2,g=e.getPointAtLength(u),h=g[a]-t,wa(h)<n)return g;0<s*h?p=u:c=u,d++}return g}},{"./mod":699}],688:[function(e,t){"use strict";t.exports=function(e){var t;if("string"==typeof e){if(t=document.getElementById(e),null===t)throw new Error("No DOM element with id '"+e+"' exists on the page.");return t}if(null===e||void 0===e)throw new Error("DOM element provided is null or undefined");return e}},{}],689:[function(e,t){"use strict";function a(e,t){var a=e;return a[3]*=t,a}function o(e){if(i(e))return p;var t=l(e);return t.length?t:p}function r(e){return i(e)?e:1}var i=e("fast-isnumeric"),n=e("tinycolor2"),l=e("color-normalize"),s=e("../components/colorscale"),d=e("../components/color/attributes").defaultLine,c=e("./array").isArrayOrTypedArray,p=l(d);t.exports={formatColor:function(e,t,n){var d=e.color,u=c(d),g=c(t),h=[],m,y,f,x,b;if(m=void 0===e.colorscale?o:s.makeColorScaleFunc(s.extractScale(e,{cLetter:"c"})),y=u?function(e,t){return void 0===e[t]?p:l(m(e[t]))}:o,f=g?function(e,t){return void 0===e[t]?1:r(e[t])}:r,u||g)for(var _=0;_<n;_++)x=y(d,_),b=f(t,_),h[_]=a(x,b);else h=a(l(d),t);return h},parseColorScale:function(e,t){return void 0===t&&(t=1),e.map(function(e){var a=e[0],o=n(e[1]),r=o.toRgb();return{index:a,rgb:[r.r,r.g,r.b,t]}})}}},{"../components/color/attributes":568,"../components/colorscale":581,"./array":675,"color-normalize":108,"fast-isnumeric":214,tinycolor2:513}],690:[function(e,t){"use strict";function a(e){return[e]}var o=e("./identity");t.exports={keyFun:function(e){return e.key},repeat:a,descend:o,wrap:a,unwrap:function(e){return e[0]}}},{"./identity":691}],691:[function(e,t){"use strict";t.exports=function(e){return e}},{}],692:[function(e,t){"use strict";function a(e){var t={};for(var a in e)for(var o=e[a],r=0;r<o.length;r++)t[o[r]]=+a;return t}var o=e("d3"),r=e("fast-isnumeric"),i=e("../constants/numerical"),n=i.FP_SAFE,l=i.BADNUM,s=t.exports={};s.nestedProperty=e("./nested_property"),s.keyedContainer=e("./keyed_container"),s.relativeAttr=e("./relative_attr"),s.isPlainObject=e("./is_plain_object"),s.toLogRange=e("./to_log_range"),s.relinkPrivateKeys=e("./relink_private");var d=e("./array");s.isTypedArray=d.isTypedArray,s.isArrayOrTypedArray=d.isArrayOrTypedArray,s.isArray1D=d.isArray1D,s.ensureArray=d.ensureArray,s.concat=d.concat,s.maxRowLength=d.maxRowLength,s.minRowLength=d.minRowLength;var c=e("./mod");s.mod=c.mod,s.modHalf=c.modHalf;var p=e("./coerce");s.valObjectMeta=p.valObjectMeta,s.coerce=p.coerce,s.coerce2=p.coerce2,s.coerceFont=p.coerceFont,s.coerceHoverinfo=p.coerceHoverinfo,s.coerceSelectionMarkerOpacity=p.coerceSelectionMarkerOpacity,s.validate=p.validate;var u=e("./dates");s.dateTime2ms=u.dateTime2ms,s.isDateTime=u.isDateTime,s.ms2DateTime=u.ms2DateTime,s.ms2DateTimeLocal=u.ms2DateTimeLocal,s.cleanDate=u.cleanDate,s.isJSDate=u.isJSDate,s.formatDate=u.formatDate,s.incrementMonth=u.incrementMonth,s.dateTick0=u.dateTick0,s.dfltRange=u.dfltRange,s.findExactDates=u.findExactDates,s.MIN_MS=u.MIN_MS,s.MAX_MS=u.MAX_MS;var g=e("./search");s.findBin=g.findBin,s.sorterAsc=g.sorterAsc,s.sorterDes=g.sorterDes,s.distinctVals=g.distinctVals,s.roundUp=g.roundUp,s.sort=g.sort,s.findIndexOfMin=g.findIndexOfMin;var h=e("./stats");s.aggNums=h.aggNums,s.len=h.len,s.mean=h.mean,s.midRange=h.midRange,s.variance=h.variance,s.stdev=h.stdev,s.interp=h.interp;var m=e("./matrix");s.init2dArray=m.init2dArray,s.transposeRagged=m.transposeRagged,s.dot=m.dot,s.translationMatrix=m.translationMatrix,s.rotationMatrix=m.rotationMatrix,s.rotationXYMatrix=m.rotationXYMatrix,s.apply2DTransform=m.apply2DTransform,s.apply2DTransform2=m.apply2DTransform2;var y=e("./angles");s.deg2rad=y.deg2rad,s.rad2deg=y.rad2deg,s.angleDelta=y.angleDelta,s.angleDist=y.angleDist,s.isFullCircle=y.isFullCircle,s.isAngleInsideSector=y.isAngleInsideSector,s.isPtInsideSector=y.isPtInsideSector,s.pathArc=y.pathArc,s.pathSector=y.pathSector,s.pathAnnulus=y.pathAnnulus;var f=e("./anchor_utils");s.isLeftAnchor=f.isLeftAnchor,s.isCenterAnchor=f.isCenterAnchor,s.isRightAnchor=f.isRightAnchor,s.isTopAnchor=f.isTopAnchor,s.isMiddleAnchor=f.isMiddleAnchor,s.isBottomAnchor=f.isBottomAnchor;var x=e("./geometry2d");s.segmentsIntersect=x.segmentsIntersect,s.segmentDistance=x.segmentDistance,s.getTextLocation=x.getTextLocation,s.clearLocationCache=x.clearLocationCache,s.getVisibleSegment=x.getVisibleSegment,s.findPointOnPath=x.findPointOnPath;var b=e("./extend");s.extendFlat=b.extendFlat,s.extendDeep=b.extendDeep,s.extendDeepAll=b.extendDeepAll,s.extendDeepNoArrays=b.extendDeepNoArrays;var _=e("./loggers");s.log=_.log,s.warn=_.warn,s.error=_.error;var v=e("./regex");s.counterRegex=v.counter;var w=e("./throttle");s.throttle=w.throttle,s.throttleDone=w.done,s.clearThrottle=w.clear,s.getGraphDiv=e("./get_graph_div"),s.clearResponsive=e("./clear_responsive"),s.makeTraceGroups=e("./make_trace_groups"),s._=e("./localize"),s.notifier=e("./notifier"),s.filterUnique=e("./filter_unique"),s.filterVisible=e("./filter_visible"),s.pushUnique=e("./push_unique"),s.cleanNumber=e("./clean_number"),s.ensureNumber=function(e){return r(e)?(e=+e,e<-n||e>n?l:r(e)?+e:l):l},s.isIndex=function(e,t){return!(void 0!==t&&e>=t)&&r(e)&&0<=e&&0==e%1},s.noop=e("./noop"),s.identity=e("./identity"),s.repeat=function(e,t){for(var a=Array(t),o=0;o<t;o++)a[o]=e;return a},s.swapAttrs=function(e,t,a,o){a||(a="x"),o||(o="y");for(var r=0;r<t.length;r++){var n=t[r],l=s.nestedProperty(e,n.replace("?",a)),d=s.nestedProperty(e,n.replace("?",o)),c=l.get();l.set(d.get()),d.set(c)}},s.raiseToTop=function(e){e.parentNode.appendChild(e)},s.cancelTransition=function(e){return e.transition().duration(0)},s.constrain=function(e,t,a){return t>a?va(a,ie(t,e)):va(t,ie(a,e))},s.bBoxIntersect=function(e,t,a){return a=a||0,e.left<=t.right+a&&t.left<=e.right+a&&e.top<=t.bottom+a&&t.top<=e.bottom+a},s.simpleMap=function(e,t,a,o){for(var r=e.length,n=Array(r),l=0;l<r;l++)n[l]=t(e[l],a,o);return n},s.randstr=function e(t,a,o,r){if(o||(o=16),void 0===a&&(a=24),0>=a)return"0";var n=P(_a(2,a))/P(o),l="",d,c,p;for(d=2;n==1/0;d*=2)n=P(_a(2,a/d))/P(o)*d;var u=n-ea(n);for(d=0;d<ea(n);d++)p=ea(Math.random()*o).toString(o),l=p+l;u&&(c=_a(o,u),p=ea(Math.random()*c).toString(o),l=p+l);var g=parseInt(l,o);return t&&t[l]||g!==1/0&&g>=_a(2,a)?10<r?(s.warn("randstr failed uniqueness"),l):e(t,a,o,(r||0)+1):l},s.OptionControl=function(e,t){e||(e={}),t||(t="opt");var a={};return a.optionList=[],a._newoption=function(o){o[t]=e,a[o.name]=o,a.optionList.push(o)},a["_"+t]=e,a},s.smooth=function(e,t){if(t=R(t)||0,2>t)return e;var a=e.length,o=2*a,r=2*t-1,n=Array(r),l=Array(a),s,d,c,p;for(s=0;s<r;s++)n[s]=(1-te(Sa*(s+1)/t))/(2*t);for(s=0;s<a;s++){for(p=0,d=0;d<r;d++)c=s+d+1-t,c<-a?c-=o*R(c/o):c>=o&&(c-=o*ea(c/o)),0>c?c=-1-c:c>=a&&(c=o-1-c),p+=e[c]*n[d];l[s]=p}return l},s.syncOrAsync=function(e,t,a){function o(){return s.syncOrAsync(e,t,a)}for(var r,i;e.length;)if(i=e.splice(0,1)[0],r=i(t),r&&r.then)return r.then(o).then(void 0,s.promiseError);return a&&a(t)},s.stripTrailingSlash=function(e){return"/"===e.substr(-1)?e.substr(0,e.length-1):e},s.noneOrAll=function(e,t,a){if(e){var o=!1,r=!0,n,l;for(n=0;n<a.length;n++)l=e[a[n]],void 0!==l&&null!==l?o=!0:r=!1;if(o&&!r)for(n=0;n<a.length;n++)e[a[n]]=t[a[n]]}},s.mergeArray=function(e,t,a){if(s.isArrayOrTypedArray(e))for(var o=ie(e.length,t.length),r=0;r<o;r++)t[r][a]=e[r]},s.fillArray=function(e,t,a,o){if(o=o||s.identity,s.isArrayOrTypedArray(e))for(var r=0;r<t.length;r++)t[r][a]=o(e[r])},s.castOption=function(e,t,a,o){o=o||s.identity;var r=s.nestedProperty(e,a).get();return s.isArrayOrTypedArray(r)?Array.isArray(t)&&s.isArrayOrTypedArray(r[t[0]])?o(r[t[0]][t[1]]):o(r[t]):r},s.extractOption=function(e,t,a,o){if(a in e)return e[a];var r=s.nestedProperty(t,o).get();if(!Array.isArray(r))return r},s.tagSelected=function(e,t,o){function r(t){return t!==void 0&&t<e.length}var n=t.selectedpoints,l=t._indexToPoints,d;l&&(d=a(l));for(var c=0,p;c<n.length;c++)if(p=n[c],s.isIndex(p)){var u=d?d[p]:p,g=o?o[u]:u;r(g)&&(e[g].selected=1)}},s.selIndices2selPoints=function(e){var t=e.selectedpoints,o=e._indexToPoints;if(o){for(var r=a(o),n=[],l=0,d;l<t.length;l++)if(d=t[l],s.isIndex(d)){var c=r[d];s.isIndex(c)&&n.push(c)}return n}return t},s.getTargetArray=function(e,t){var a=t.target;if("string"==typeof a&&a){var o=s.nestedProperty(e,a).get();return!!Array.isArray(o)&&o}return!!Array.isArray(a)&&a},s.minExtend=function(e,t){var a={};"object"!=typeof t&&(t={});var o=Object.keys(e),r,n,l;for(r=0;r<o.length;r++)if(n=o[r],l=e[n],"_"===n.charAt(0)||"function"==typeof l)continue;else a[n]="module"===n?l:Array.isArray(l)?"colorscale"===n?l.slice():l.slice(0,3):l&&"object"==typeof l?s.minExtend(e[n],t[n]):l;for(o=Object.keys(t),r=0;r<o.length;r++)n=o[r],l=t[n],"object"==typeof l&&n in a&&"object"==typeof a[n]||(a[n]=l);return a},s.titleCase=function(e){return e.charAt(0).toUpperCase()+e.substr(1)},s.containsAny=function(e,t){for(var a=0;a<t.length;a++)if(-1!==e.indexOf(t[a]))return!0;return!1},s.isPlotDiv=function(e){var t=o.select(e);return t.node()instanceof HTMLElement&&t.size()&&t.classed("js-plotly-plot")},s.removeElement=function(e){var t=e&&e.parentNode;t&&t.removeChild(e)},s.addStyleRule=function(e,t){s.addRelatedStyleRule("global",e,t)},s.addRelatedStyleRule=function(e,t,a){var o="plotly.js-style-"+e,r=document.getElementById(o);r||(r=document.createElement("style"),r.setAttribute("id",o),r.appendChild(document.createTextNode("")),document.head.appendChild(r));var i=r.sheet;i.insertRule?i.insertRule(t+"{"+a+"}",0):i.addRule?i.addRule(t,a,0):s.warn("addStyleRule failed")},s.deleteRelatedStyleRule=function(e){var t=document.getElementById("plotly.js-style-"+e);t&&s.removeElement(t)},s.isIE=function(){return"undefined"!=typeof window.navigator.msSaveBlob},s.isD3Selection=function(e){return e&&"function"==typeof e.classed},s.ensureSingle=function(e,t,a,o){var r=e.select(t+(a?"."+a:""));if(r.size())return r;var i=e.append(t);return a&&i.classed(a,!0),o&&i.call(o),i},s.ensureSingleById=function(e,t,a,o){var r=e.select(t+"#"+a);if(r.size())return r;var i=e.append(t).attr("id",a);return o&&i.call(o),i},s.objectFromPath=function(e,t){for(var a=e.split("."),o=n={},r=0,n;r<a.length;r++){var l=a[r],s=null,d=a[r].match(/(.*)\[([0-9]+)\]/);d?(l=d[1],s=d[2],n=n[l]=[],n[s]=r==a.length-1?t:{},n=n[s]):(n[l]=r==a.length-1?t:{},n=n[l])}return o};var k=/^([^\[\.]+)\.(.+)?/,T=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;s.expandObjectPaths=function(e){var t,a,o,r,i,n,l;if("object"==typeof e&&!Array.isArray(e))for(a in e)e.hasOwnProperty(a)&&((t=a.match(k))?(r=e[a],o=t[1],delete e[a],e[o]=s.extendDeepNoArrays(e[o]||{},s.objectFromPath(a,s.expandObjectPaths(r))[o])):(t=a.match(T))?(r=e[a],o=t[1],i=parseInt(t[2]),delete e[a],e[o]=e[o]||[],"."===t[3]?(l=t[4],n=e[o][i]=e[o][i]||{},s.extendDeepNoArrays(n,s.objectFromPath(l,s.expandObjectPaths(r)))):e[o][i]=s.expandObjectPaths(r)):e[a]=s.expandObjectPaths(e[a]));return e},s.numSeparate=function(e,t,a){if(a||(a=!1),"string"!=typeof t||0===t.length)throw new Error("Separator string required for formatting!");"number"==typeof e&&(e+="");var o=/(\d+)(\d{3})/,r=t.charAt(0),i=t.charAt(1),n=e.split("."),l=n[0],s=1<n.length?r+n[1]:"";if(i&&(1<n.length||4<l.length||a))for(;o.test(l);)l=l.replace(o,"$1"+i+"$2");return l+s};var A=/%{([^\s%{}:]*)(:[^}]*)?}/g,S=/^\w*$/;s.templateString=function(e,t){var a={};return e.replace(A,function(e,o){return S.test(o)?t[o]||"":(a[o]=a[o]||s.nestedProperty(t,o).get,a[o]()||"")})};var C=/^:/,L=0,E=10;s.hovertemplateString=function(e,t){var a=arguments,r={};return e.replace(A,function(e,n,l){var d,c,p;for(p=2;p<a.length;p++){if(d=a[p],d.hasOwnProperty(n)){c=d[n];break}if(S.test(n)||(c=r[n]||s.nestedProperty(d,n).get(),c&&(r[n]=c)),void 0!==c)break}return void 0===c&&(L<E&&(s.warn("Variable '"+n+"' in hovertemplate could not be found!"),c=e),L===E&&s.warn("Too many hovertemplate warnings - additional warnings will be suppressed"),L++),l?c=o.format(l.replace(C,""))(c):t.hasOwnProperty(n+"Label")&&(c=t[n+"Label"]),c})};var z=57;s.subplotSort=function(e,t){for(var a=ie(e.length,t.length)+1,o=0,r=0,n=0;n<a;n++){var l=e.charCodeAt(n)||0,s=t.charCodeAt(n)||0,d=48<=l&&l<=z,c=48<=s&&s<=z;if(d&&(o=10*o+l-48),c&&(r=10*r+s-48),!d||!c){if(o!==r)return o-r;if(l!==s)return l-s}}return r-o};var I=2e9;s.seedPseudoRandom=function(){I=2e9},s.pseudoRandom=function(){var e=I;return I=(69069*I+1)%4294967296,429496729>wa(I-e)?s.pseudoRandom():I/4294967296}},{"../constants/numerical":669,"./anchor_utils":673,"./angles":674,"./array":675,"./clean_number":676,"./clear_responsive":678,"./coerce":679,"./dates":680,"./extend":682,"./filter_unique":683,"./filter_visible":684,"./geometry2d":687,"./get_graph_div":688,"./identity":691,"./is_plain_object":693,"./keyed_container":694,"./localize":695,"./loggers":696,"./make_trace_groups":697,"./matrix":698,"./mod":699,"./nested_property":700,"./noop":701,"./notifier":702,"./push_unique":706,"./regex":708,"./relative_attr":709,"./relink_private":710,"./search":711,"./stats":714,"./throttle":717,"./to_log_range":718,d3:148,"fast-isnumeric":214}],693:[function(e,t){"use strict";t.exports=function(e){return window&&window.process&&window.process.versions?"[object Object]"===Object.prototype.toString.call(e):"[object Object]"===Object.prototype.toString.call(e)&&Object.getPrototypeOf(e)===Object.prototype}},{}],694:[function(e,t){"use strict";var a=e("./nested_property"),o=/^\w*$/,r=1,n=2,l=3,s=4;t.exports=function(e,t,d,c){d=d||"name",c=c||"value";var p={},u,g,h;t&&t.length?(h=a(e,t),g=h.get()):g=e,t=t||"";var m={};if(g)for(u=0;u<g.length;u++)m[g[u][d]]=u;var y=o.test(c),f={set:function(e,t){var o=null===t?s:0;if(!g){if(!h||o===s)return;g=[],h.set(g)}var r=m[e];if(void 0===r){if(o===s)return;o|=l,r=g.length,m[e]=r}else t!==(y?g[r][c]:a(g[r],c).get())&&(o|=n);var i=g[r]=g[r]||{};return i[d]=e,y?i[c]=t:a(i,c).set(t),null!==t&&(o&=~s),p[r]|=o,f},get:function(e){if(g){var t=m[e];return void 0===t?void 0:y?g[t][c]:a(g[t],c).get()}},rename:function(e,t){var a=m[e];return void 0===a?f:(p[a]|=r,m[t]=a,delete m[e],g[a][d]=t,f)},remove:function(e){var t=m[e];if(t===void 0)return f;var o=g[t];if(2<Object.keys(o).length)return p[t]|=n,f.set(e,null);if(y){for(u=t;u<g.length;u++)p[u]|=l;for(u=t;u<g.length;u++)m[g[u][d]]--;g.splice(t,1),delete m[e]}else a(o,c).set(null),p[t]=p[t]|n|s;return f},constructUpdate:function(){for(var e={},o=Object.keys(p),l=0,u,h;l<o.length;l++)h=o[l],u=t+"["+h+"]",g[h]?(p[h]&r&&(e[u+"."+d]=g[h][d]),p[h]&n&&(y?e[u+"."+c]=p[h]&s?null:g[h][c]:e[u+"."+c]=p[h]&s?null:a(g[h],c).get())):e[u]=null;return e}};return f}},{"./nested_property":700}],695:[function(e,t){"use strict";var a=e("../registry");t.exports=function(e,t){for(var o=e._context.locale,r=0,n;2>r;r++){n=e._context.locales;for(var l=0,s;2>l;l++){if(s=(n[o]||{}).dictionary,s){var d=s[t];if(d)return d}n=a.localeRegistry}var c=o.split("-")[0];if(c===o)break;o=c}return t}},{"../registry":823}],696:[function(e,t){"use strict";function a(e,t){if(e&&e.apply)try{return void e.apply(console,t)}catch(t){}for(var a=0;a<t.length;a++)try{e(t[a])}catch(o){console.log(t[a])}}var o=e("../plot_api/plot_config"),r=t.exports={};r.log=function(){if(1<o.logging){for(var e=["LOG:"],t=0;t<arguments.length;t++)e.push(arguments[t]);a(console.trace||console.log,e)}},r.warn=function(){if(0<o.logging){for(var e=["WARN:"],t=0;t<arguments.length;t++)e.push(arguments[t]);a(console.trace||console.log,e)}},r.error=function(){if(0<o.logging){for(var e=["ERROR:"],t=0;t<arguments.length;t++)e.push(arguments[t]);a(console.error,e)}}},{"../plot_api/plot_config":728}],697:[function(e,t){"use strict";t.exports=function(e,t,a){var o=e.selectAll("g."+a.replace(/\s/g,".")).data(t,function(e){return e[0].trace.uid});return o.exit().remove(),o.enter().append("g").attr("class",a),o.order(),o}},{}],698:[function(e,t,o){"use strict";o.init2dArray=function(e,t){for(var a=Array(e),o=0;o<e;o++)a[o]=Array(t);return a},o.transposeRagged=function(e){var a=0,o=e.length,r,n;for(r=0;r<o;r++)a=va(a,e[r].length);var l=Array(a);for(r=0;r<a;r++)for(l[r]=Array(o),n=0;n<o;n++)l[r][n]=e[n][r];return l},o.dot=function(e,t){if(!(e.length&&t.length)||e.length!==t.length)return null;var a=e.length,r,n;if(e[0].length)for(r=Array(a),n=0;n<a;n++)r[n]=o.dot(e[n],t);else if(t[0].length){var l=o.transposeRagged(t);for(r=Array(l.length),n=0;n<l.length;n++)r[n]=o.dot(e,l[n])}else for(r=0,n=0;n<a;n++)r+=e[n]*t[n];return r},o.translationMatrix=function(e,t){return[[1,0,e],[0,1,t],[0,0,1]]},o.rotationMatrix=function(e){var t=e*Sa/180;return[[te(t),-M(t),0],[M(t),te(t),0],[0,0,1]]},o.rotationXYMatrix=function(e,t,a){return o.dot(o.dot(o.translationMatrix(t,a),o.rotationMatrix(e)),o.translationMatrix(-t,-a))},o.apply2DTransform=function(e){return function(){var t=arguments;3===t.length&&(t=t[0]);var a=1===arguments.length?t[0]:[t[0],t[1]];return o.dot(e,[a[0],a[1],1]).slice(0,2)}},o.apply2DTransform2=function(e){var t=o.apply2DTransform(e);return function(e){return t(e.slice(0,2)).concat(t(e.slice(2,4)))}}},{}],699:[function(e,t){"use strict";t.exports={mod:function(e,t){var a=e%t;return 0>a?a+t:a},modHalf:function(e,t){return wa(e)>t/2?e-R(e/t)*t:e}}},{}],700:[function(e,t){"use strict";function a(e,t){return function(){var o=e,r,n,l,s,d;for(s=0;s<t.length-1;s++){if(r=t[s],-1===r){for(n=!0,l=[],d=0;d<o.length;d++)l[d]=a(o[d],t.slice(s+1))(),l[d]!==l[0]&&(n=!1);return n?l[0]:l}if("number"==typeof r&&!p(o))return;if(o=o[r],"object"!=typeof o||null===o)return}if("object"==typeof o&&null!==o)return l=o[t[s]],null===l?void 0:l}}function o(e,t){return e===void 0||null===e&&!t.match(u)}function r(e,t,a){return function(r){var d=e,c="",u=[[e,c]],g=o(r,a),h,m;for(m=0;m<t.length-1;m++){if(h=t[m],"number"==typeof h&&!p(d))throw"array index but container is not an array";if(-1===h)if(g=!l(d,t.slice(m+1),r,a),g)break;else return;if(!s(d,h,t[m+1],g))break;if(d=d[h],"object"!=typeof d||null===d)throw"container is not an object";c=n(c,h),u.push([d,c])}if(!g)d[t[m]]=r;else if(m===t.length-1&&(delete d[t[m]],Array.isArray(d)&&+t[m]==d.length-1))for(;d.length&&void 0===d[d.length-1];)d.pop()}}function n(e,t){var a=t;return c(t)?a="["+t+"]":e&&(a="."+t),e+a}function l(e,t,a,n){var l=p(a),d=!0,c=a,u=n.replace("-1",0),g=!l&&o(a,u),h=t[0],m;for(m=0;m<e.length;m++)(u=n.replace("-1",m),l&&(c=a[m%a.length],g=o(c,u)),g&&(d=!1),!!s(e,m,h,g))&&r(e[m],t,n.replace("-1",m))(c);return d}function s(e,t,a,o){if(e[t]===void 0){if(o)return!1;e[t]="number"==typeof a?[]:{}}return!0}function d(e,t,a){return{set:function(){throw"bad container"},get:function(){},astr:t,parts:a,obj:e}}var c=e("fast-isnumeric"),p=e("./array").isArrayOrTypedArray;t.exports=function(e,t){if(c(t))t=t+"";else if("string"!=typeof t||"[-1]"===t.substr(t.length-4))throw"bad property string";for(var o=0,n=t.split("."),l,s,p;o<n.length;){if(l=(n[o]+"").match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/),l){if(l[1])n[o]=l[1];else if(0===o)n.splice(0,1);else throw"bad property string";for(s=l[2].substr(1,l[2].length-2).split("]["),p=0;p<s.length;p++)o++,n.splice(o,0,+s[p])}o++}return"object"==typeof e?{set:r(e,n,t),get:a(e,n),astr:t,parts:n,obj:e}:d(e,t,n)};var u=/(^|\.)args\[/},{"./array":675,"fast-isnumeric":214}],701:[function(e,t){"use strict";t.exports=function(){}},{}],702:[function(e,t){"use strict";var a=e("d3"),o=e("fast-isnumeric"),r=[];t.exports=function(e,t){function n(e){e.duration(700).style("opacity",0).each("end",function(e){var t=r.indexOf(e);-1!==t&&r.splice(t,1),a.select(this).remove()})}if(-1===r.indexOf(e)){r.push(e);var l=1e3;o(t)?l=t:"long"===t&&(l=3e3);var i=a.select("body").selectAll(".plotly-notifier").data([0]);i.enter().append("div").classed("plotly-notifier",!0);var s=i.selectAll(".notifier-note").data(r);s.enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(e){var t=a.select(this);t.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){t.transition().call(n)});for(var o=t.append("p"),r=e.split(/<br\s*\/?>/g),s=0;s<r.length;s++)s&&o.append("br"),o.append("span").text(r[s]);t.transition().duration(700).style("opacity",1).transition().delay(l).call(n)})}}},{d3:148,"fast-isnumeric":214}],703:[function(e,t){"use strict";var a=e("./setcursor"),o="data-savedcursor",r="!!";t.exports=function(e,t){var n=e.attr(o);if(t){if(!n){for(var l=(e.attr("class")||"").split(" "),s=0,d;s<l.length;s++)d=l[s],0===d.indexOf("cursor-")&&e.attr(o,d.substr(7)).classed(d,!1);e.attr(o)||e.attr(o,r)}a(e,t)}else n&&(e.attr(o,null),n===r?a(e):a(e,n))}},{"./setcursor":712}],704:[function(e,t){"use strict";var a=e("./matrix").dot,o=e("../constants/numerical").BADNUM,r=t.exports={};r.tester=function(e){function t(e,t){var a=e[0],r=e[1];return!(a===o||a<n||a>l||r===o||r<s||r>d)&&!(t&&u(e))}function a(e,t){var a=e[0],c=e[1];if(a===o||a<n||a>l||c===o||c<s||c>d)return!1;var p=r.length,u=r[0][0],g=r[0][1],h=0,m,y,f,x,b;for(m=1;m<p;m++)if(y=u,f=g,u=r[m][0],g=r[m][1],x=ie(y,u),a<x||a>va(y,u)||c>va(f,g))continue;else if(c<ie(f,g))a!==x&&h++;else{if(b=u===y?c:f+(a-y)*(g-f)/(u-y),c===b)return!(1===m&&t);c<=b&&a!==x&&h++}return 1==h%2}var r=e.slice(),n=r[0][0],l=n,s=r[0][1],d=s,c;for(r.push(r[0]),c=1;c<r.length;c++)n=ie(n,r[c][0]),l=va(l,r[c][0]),s=ie(s,r[c][1]),d=va(d,r[c][1]);var p=!1,u;5===r.length&&(r[0][0]===r[1][0]?r[2][0]===r[3][0]&&r[0][1]===r[3][1]&&r[1][1]===r[2][1]&&(p=!0,u=function(e){return e[0]===r[0][0]}):r[0][1]===r[1][1]&&r[2][1]===r[3][1]&&r[0][0]===r[3][0]&&r[1][0]===r[2][0]&&(p=!0,u=function(e){return e[1]===r[0][1]}));var g=!0,h=r[0];for(c=1;c<r.length;c++)if(h[0]!==r[c][0]||h[1]!==r[c][1]){g=!1;break}return{xmin:n,xmax:l,ymin:s,ymax:d,pts:r,contains:p?t:a,isRect:p,degenerate:g}};var n=r.isSegmentBent=function(e,t,o,r){var n=e[t],l=[e[o][0]-n[0],e[o][1]-n[1]],s=a(l,l),d=re(s),c=[-l[1]/d,l[0]/d],p,u,g;for(p=t+1;p<o;p++)if(u=[e[p][0]-n[0],e[p][1]-n[1]],g=a(u,l),0>g||g>s||wa(a(u,c))>r)return!0;return!1};r.filter=function(e,t){function a(a){e.push(a);var s=o.length,d=r;o.splice(l+1);for(var c=d+1;c<e.length;c++)(c===e.length-1||n(e,d,c+1,t))&&(o.push(e[c]),o.length<s-2&&(r=c,l=o.length-1),d=c)}var o=[e[0]],r=0,l=0;if(1<e.length){var s=e.pop();a(s)}return{addPt:a,raw:e,filtered:o}}},{"../constants/numerical":669,"./matrix":698}],705:[function(e,t){(function(a){"use strict";var o=e("./show_no_webgl_msg"),r=e("regl");t.exports=function(e,t){var i=e._fullLayout,n=!0;return i._glcanvas.each(function(o){if(!o.regl&&(!o.pick||i._has("parcoords"))){try{o.regl=r({canvas:this,attributes:{antialias:!o.pick,preserveDrawingBuffer:!0},pixelRatio:e._context.plotGlPixelRatio||a.devicePixelRatio,extensions:t||[]})}catch(t){n=!1}n&&this.addEventListener("webglcontextlost",function(t){e&&e.emit&&e.emit("plotly_webglcontextlost",{event:t,layer:o.key})},!1)}}),n||o({container:i._glcontainer.node()}),n}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./show_no_webgl_msg":713,regl:478}],706:[function(e,t){"use strict";t.exports=function(e,t){if(t instanceof RegExp){var a=t.toString(),o;for(o=0;o<e.length;o++)if(e[o]instanceof RegExp&&e[o].toString()===a)return e;e.push(t)}else(t||0===t)&&-1===e.indexOf(t)&&e.push(t);return e}},{}],707:[function(e,t){"use strict";function a(e,t){for(var a=[],r=0,n;r<t.length;r++)n=t[r],a[r]=n===e?n:"object"==typeof n?Array.isArray(n)?o.extendDeep([],n):o.extendDeepAll({},n):n;return a}var o=e("../lib"),r=e("../plot_api/plot_config"),n={};n.add=function(e,t,a,o,i){var n,l;return e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},l=e.undoQueue.index,e.autoplay?void(e.undoQueue.inSequence||(e.autoplay=!1)):void(!e.undoQueue.sequence||e.undoQueue.beginSequence?(n={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},e.undoQueue.queue.splice(l,e.undoQueue.queue.length-l,n),e.undoQueue.index+=1):n=e.undoQueue.queue[l-1],e.undoQueue.beginSequence=!1,n&&(n.undo.calls.unshift(t),n.undo.args.unshift(a),n.redo.calls.push(o),n.redo.args.push(i)),e.undoQueue.queue.length>r.queueLength&&(e.undoQueue.queue.shift(),e.undoQueue.index--))},n.startSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!0,e.undoQueue.beginSequence=!0},n.stopSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!1,e.undoQueue.beginSequence=!1},n.undo=function(e){var t,a;if(e.framework&&e.framework.isPolar)return void e.framework.undo();if(!(void 0===e.undoQueue||isNaN(e.undoQueue.index)||0>=e.undoQueue.index)){for(e.undoQueue.index--,t=e.undoQueue.queue[e.undoQueue.index],e.undoQueue.inSequence=!0,a=0;a<t.undo.calls.length;a++)n.plotDo(e,t.undo.calls[a],t.undo.args[a]);e.undoQueue.inSequence=!1,e.autoplay=!1}},n.redo=function(e){var t,a;if(e.framework&&e.framework.isPolar)return void e.framework.redo();if(!(void 0===e.undoQueue||isNaN(e.undoQueue.index)||e.undoQueue.index>=e.undoQueue.queue.length)){for(t=e.undoQueue.queue[e.undoQueue.index],e.undoQueue.inSequence=!0,a=0;a<t.redo.calls.length;a++)n.plotDo(e,t.redo.calls[a],t.redo.args[a]);e.undoQueue.inSequence=!1,e.autoplay=!1,e.undoQueue.index++}},n.plotDo=function(e,t,o){e.autoplay=!0,o=a(e,o),t.apply(null,o)},t.exports=n},{"../lib":692,"../plot_api/plot_config":728}],708:[function(e,t,a){"use strict";a.counter=function(e,t,a,o){var r=(t||"")+(a?"":"$"),i=!1===o?"":"^";return"xy"===e?new RegExp(i+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+r):new RegExp(i+e+"([2-9]|[1-9][0-9]+)?"+r)}},{}],709:[function(e,t){"use strict";var a=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,o=/^[^\.\[\]]+$/;t.exports=function(e,t){for(;t;){var r=e.match(a);if(r)e=r[1];else if(e.match(o))e="";else throw new Error("bad relativeAttr call:"+[e,t]);if("^"===t.charAt(0))t=t.slice(1);else break}return e&&"["!==t.charAt(0)?e+"."+t:e+t}},{}],710:[function(e,t){"use strict";var a=e("./array").isArrayOrTypedArray,o=e("./is_plain_object");t.exports=function e(t,r){for(var i in r){var n=r[i],l=t[i];if(l!==n)if("_"===i.charAt(0)||"function"==typeof n){if(i in t)continue;t[i]=n}else if(a(n)&&a(l)&&o(n[0])){if("customdata"==i||"ids"==i)continue;for(var s=ie(n.length,l.length),d=0;d<s;d++)l[d]!==n[d]&&o(n[d])&&o(l[d])&&e(l[d],n[d])}else o(n)&&o(l)&&(e(l,n),Object.keys(l).length||delete t[i])}}},{"./array":675,"./is_plain_object":693}],711:[function(e,t,a){"use strict";function o(e,t){return e<t}function r(e,t){return e<=t}function i(e,t){return e>t}function l(e,t){return e>=t}var s=e("fast-isnumeric"),d=e("./loggers"),c=e("./identity"),p=1e-9;a.findBin=function(e,t,a){if(s(t.start))return a?ae((e-t.start)/t.size-p)-1:ea((e-t.start)/t.size+p);var u=0,g=t.length,h=0,m=1<g?(t[g-1]-t[0])/(g-1):1,y,f;for(f=0<=m?a?o:r:a?l:i,e+=m*p*(a?-1:1)*(0<=m?1:-1);u<g&&100>h++;)y=ea((u+g)/2),f(t[y],e)?u=y+1:g=y;return 90<h&&d.log("Long binary search..."),u-1},a.sorterAsc=function(e,t){return e-t},a.sorterDes=function(e,t){return t-e},a.distinctVals=function(e){var t=e.slice();t.sort(a.sorterAsc);for(var o=t.length-1,r=t[o]-t[0]||1,n=r/(o||1)/1e4,l=[t[0]],s=0;s<o;s++)t[s+1]>t[s]+n&&(r=ie(r,t[s+1]-t[s]),l.push(t[s+1]));return{vals:l,minDiff:r}},a.roundUp=function(e,t,a){for(var o=0,r=t.length-1,i=0,n=a?0:1,l=a?1:0,s=a?ae:ea,d;o<r&&100>i++;)d=s((o+r)/2),t[d]<=e?o=d+n:r=d-l;return t[o]},a.sort=function(e,t){for(var a=0,o=0,r=1,n;r<e.length;r++)if(n=t(e[r],e[r-1]),0>n?a=1:0<n&&(o=1),a&&o)return e.sort(t);return o?e:e.reverse()},a.findIndexOfMin=function(e,t){t=t||c;for(var a=1/0,o=0,r,n;o<e.length;o++)n=t(e[o]),n<a&&(a=n,r=o);return r}},{"./identity":691,"./loggers":696,"fast-isnumeric":214}],712:[function(e,t){"use strict";t.exports=function(e,t){(e.attr("class")||"").split(" ").forEach(function(t){0===t.indexOf("cursor-")&&e.classed(t,!1)}),t&&e.classed("cursor-"+t,!0)}},{}],713:[function(e,t){"use strict";var a=e("../components/color"),o=function(){};t.exports=function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=o);e.destroy=function(){e.container.parentNode.removeChild(e.container)};var r=document.createElement("div");r.className="no-webgl",r.style.cursor="pointer",r.style.fontSize="24px",r.style.color=a.defaults[0],r.style.position="absolute",r.style.left=r.style.top="0px",r.style.width=r.style.height="100%",r.style["background-color"]=a.lightLine,r.style["z-index"]=30;var i=document.createElement("p");return i.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",i.style.position="relative",i.style.top="50%",i.style.left="50%",i.style.height="30%",i.style.width="50%",i.style.margin="-15% 0 0 -25%",r.appendChild(i),e.container.appendChild(r),e.container.style.background="#FFFFFF",e.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":569}],714:[function(e,t,o){"use strict";var r=e("fast-isnumeric"),n=e("./array").isArrayOrTypedArray;o.aggNums=function(e,t,l,s){var d,c;if((!s||s>l.length)&&(s=l.length),r(t)||(t=!1),n(l[0])){for(c=Array(s),d=0;d<s;d++)c[d]=o.aggNums(e,t,l[d]);l=c}for(d=0;d<s;d++)r(t)?r(l[d])&&(t=e(+t,+l[d])):t=l[d];return t},o.len=function(e){return o.aggNums(function(e){return e+1},0,e)},o.mean=function(e,t){return t||(t=o.len(e)),o.aggNums(function(e,t){return e+t},0,e)/t},o.midRange=function(e){return void 0===e||0===e.length?void 0:(o.aggNums(Math.max,null,e)+o.aggNums(Math.min,null,e))/2},o.variance=function(e,t,i){return t||(t=o.len(e)),r(i)||(i=o.mean(e,t)),o.aggNums(function(e,t){return e+_a(t-i,2)},0,e)/t},o.stdev=function(e,t,a){return re(o.variance(e,t,a))},o.interp=function(e,t){if(!r(t))throw"n should be a finite number";if(t=t*e.length-.5,0>t)return e[0];if(t>e.length-1)return e[e.length-1];var a=t%1;return a*e[ae(t)]+(1-a)*e[ea(t)]}},{"./array":675,"fast-isnumeric":214}],715:[function(e,t){"use strict";var a=e("color-normalize");t.exports=function(e){return e?a(e):[0,0,0,1]}},{"color-normalize":108}],716:[function(e,t,a){"use strict";function o(e,t){return e.node().getBoundingClientRect()[t]}function r(e){return e.replace(y,"\\lt ").replace(f,"\\gt ")}function i(e,t,a){var o,i,n,l;MathJax.Hub.Queue(function(){return i=u.extendDeepAll({},MathJax.Hub.config),n=MathJax.Hub.processSectionDelay,void 0!==MathJax.Hub.processSectionDelay&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]},displayAlign:"left"})},function(){if(o=MathJax.Hub.config.menuSettings.renderer,"SVG"!==o)return MathJax.Hub.setRenderer("SVG")},function(){var a="math-output-"+u.randstr({},64);return l=p.select("body").append("div").attr({id:a}).style({visibility:"hidden",position:"absolute"}).style({"font-size":t.fontSize+"px"}).text(r(e)),MathJax.Hub.Typeset(l.node())},function(){var t=p.select("body").select("#MathJax_SVG_glyphs");if(l.select(".MathJax_SVG").empty()||!l.select("svg").node())u.log("There was an error in the tex syntax.",e),a();else{var r=l.select("svg").node().getBoundingClientRect();a(l.select(".MathJax_SVG"),t,r)}return(l.remove(),"SVG"!==o)?MathJax.Hub.setRenderer(o):void 0},function(){return void 0!==n&&(MathJax.Hub.processSectionDelay=n),MathJax.Hub.Config(i)})}function n(e,t){if(!e)return null;var a=e.match(t),o=a&&(a[3]||a[4]);return o&&l(o)}function l(e){return e.replace(P,function(e,t){var a;return a="#"===t.charAt(0)?s("x"===t.charAt(1)?parseInt(t.substr(2),16):parseInt(t.substr(1),10)):D[t],a||e})}function s(e){var t=String.fromCodePoint;if(!(1114111<e)){var a=t;if(a)return a(e);var o=O;return 65535>=e?o(e):o((e>>10)+55232,e%1024+56320)}}function d(e,t){function a(){m++;var t=document.createElementNS(g.svg,"tspan");p.select(t).attr({class:"line",dy:m*h+"em"}),e.appendChild(t),f=t;var a=c;if(c=[{node:t}],1<a.length)for(var r=1;r<a.length;r++)o(a[r])}function o(e){var t=e.type,a={},o;if("a"===t){o="a";var i=e.target,n=e.href,l=e.popup;n&&(a={"xlink:xlink:show":"_blank"===i||"_"!==i.charAt(0)?"new":"replace",target:i,"xlink:xlink:href":n},l&&(a.onclick="window.open(this.href.baseVal,this.target.baseVal,\""+l+"\");return false;"))}else o="tspan";e.style&&(a.style=e.style);var s=document.createElementNS(g.svg,o);if("sup"===t||"sub"===t){r(f,"\u200B"),f.appendChild(s);var d=document.createElementNS(g.svg,"tspan");r(d,"\u200B"),p.select(d).attr("dy",_[t]),a.dy=b[t],f.appendChild(s),f.appendChild(d)}else f.appendChild(s);p.select(s).attr(a),f=e.node=s,c.push(e)}function r(e,t){e.appendChild(document.createTextNode(t))}function s(e){if(1===c.length)return void u.log("Ignoring unexpected end tag </"+e+">.",t);var a=c.pop();e!==a.type&&u.log("Start tag <"+a.type+"> doesnt match end tag <"+e+">. Pretending it did match.",t),f=c[c.length-1].node}t=t.replace(k," ");var d=!1,c=[],m=-1,y=S.test(t),f;y?a():(f=e,c=[{node:e}]);for(var w=t.split(T),D=0;D<w.length;D++){var P=w[D],O=P.match(A),R=O&&O[2].toLowerCase(),M=x[R];if("br"===R)a();else if(M===void 0)r(f,l(P));else if(O[1])s(R);else{var j=O[4],B={type:R},F=n(j,C);if(F?(F=F.replace(I,"$1 fill:"),M&&(F+=";"+M)):M&&(F=M),F&&(B.style=F),"a"===R){d=!0;var N=n(j,L);if(N){var V=document.createElement("a");V.href=N,-1!==v.indexOf(V.protocol)&&(B.href=encodeURI(decodeURI(N)),B.target=n(j,E)||"_blank",B.popup=n(j,z))}}o(B)}}return d}function c(e,t,a){var o=a.horizontalAlign,r=a.verticalAlign||"top",i=e.node().getBoundingClientRect(),n=t.node().getBoundingClientRect(),l,s,d;return s="bottom"===r?function(){return i.bottom-l.height}:"middle"===r?function(){return i.top+(i.height-l.height)/2}:function(){return i.top},d="right"===o?function(){return i.right-l.width}:"center"===o?function(){return i.left+(i.width-l.width)/2}:function(){return i.left},function(){return l=this.node().getBoundingClientRect(),this.style({top:s()-n.top+"px",left:d()-n.left+"px","z-index":1e3}),this}}var p=e("d3"),u=e("../lib"),g=e("../constants/xmlns_namespaces"),h=e("../constants/alignment").LINE_SPACING,m=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;a.convertToTspans=function(e,t,r){function n(){c.empty()||(u=e.attr("class")+"-math",c.select("svg."+u).remove()),e.text("").style("white-space","pre");var t=d(e.node(),l);t&&e.style("pointer-events","all"),a.positionText(e),r&&r.call(e)}var l=e.text(),s=!e.attr("data-notex")&&"undefined"!=typeof MathJax&&l.match(m),c=p.select(e.node().parentNode);if(!c.empty()){var u=e.attr("class")?e.attr("class").split(" ")[0]:"text";return u+="-math",c.selectAll("svg."+u).remove(),c.selectAll("g."+u+"-group").remove(),e.style("display",null).attr({"data-unformatted":l,"data-math":"N"}),s?(t&&t._promises||[]).push(new Promise(function(t){e.style("display","none");var a=parseInt(e.node().style.fontSize,10);i(s[2],{fontSize:a},function(i,s,d){c.selectAll("svg."+u).remove(),c.selectAll("g."+u+"-group").remove();var p=i&&i.select("svg");if(!p||!p.node())return n(),void t();var g=c.append("g").classed(u+"-group",!0).attr({"pointer-events":"none","data-unformatted":l,"data-math":"Y"});g.node().appendChild(p.node()),s&&s.node()&&p.node().insertBefore(s.node().cloneNode(!0),p.node().firstChild),p.attr({class:u,height:d.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var h=e.node().style.fill||"black";p.select("g").attr({fill:h,stroke:h});var m=o(p,"width"),y=o(p,"height"),f=+e.attr("x")-m*{start:0,middle:.5,end:1}[e.attr("text-anchor")||"start"],x=a||o(e,"height"),b=-x/4;"y"===u[0]?(g.attr({transform:"rotate("+[-90,+e.attr("x"),+e.attr("y")]+") translate("+[-m/2,b-y/2]+")"}),p.attr({x:+e.attr("x"),y:+e.attr("y")})):"l"===u[0]?p.attr({x:e.attr("x"),y:b-y/2}):"a"===u[0]?p.attr({x:0,y:b}):p.attr({x:f,y:+e.attr("y")+b-y/2}),r&&r.call(e,g),t(g)})})):n(),e}};var y=/(<|&lt;|&#60;)/g,f=/(>|&gt;|&#62;)/g,x={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},b={sub:"0.3em",sup:"-0.6em"},_={sub:"-0.21em",sup:"0.42em"},v=["http:","https:","mailto:","",void 0,":"],w=new RegExp("</?("+Object.keys(x).join("|")+")( [^>]*)?/?>","g"),k=/(\r\n?|\n)/g,T=/(<[^<>]*>)/,A=/<(\/?)([^ >]*)(\s+(.*))?>/i,S=/<br(\s+.*)?>/i,C=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,L=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,E=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,z=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i,I=/(^|;)\s*color:/;a.plainText=function(e){return(e||"").replace(w," ")};var D={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xA0",times:"\xD7",plusmn:"\xB1",deg:"\xB0"},P=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;a.convertEntities=l,a.lineCount=function(e){return e.selectAll("tspan.line").size()||1},a.positionText=function(e,t,a){return e.each(function(){function e(e,t){return void 0===t?(t=o.attr(e),null===t&&(o.attr(e,0),t=0)):o.attr(e,t),t}var o=p.select(this),r=e("x",t),i=e("y",a);"text"===this.nodeName&&o.selectAll("tspan.line").attr({x:r,y:i})})},a.makeEditable=function(e,t){function a(){r(),e.style({opacity:0});var t=s.attr("class"),a;a=t?"."+t.split(" ")[0]+"-math-group":"[class*=-math-group]",a&&p.select(e.node().parentNode).select(a).style({opacity:0})}function o(e){var t=e.node(),a=document.createRange();a.selectNodeContents(t);var o=window.getSelection();o.removeAllRanges(),o.addRange(a),t.focus()}function r(){var a=p.select(i),r=a.select(".svg-container"),n=r.append("div"),s=e.node().style,d=parseFloat(s.fontSize||12),u=t.text;void 0===u&&(u=e.attr("data-unformatted")),n.classed("plugin-editable editable",!0).style({position:"absolute","font-family":s.fontFamily||"Arial","font-size":d,color:t.fill||s.fill||"black",opacity:1,"background-color":t.background||"transparent",outline:"#ffffff33 1px solid",margin:[-d/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(u).call(c(e,r,t)).on("blur",function(){i._editing=!1,e.text(this.textContent).style({opacity:1});var t=p.select(this).attr("class"),a;a=t?"."+t.split(" ")[0]+"-math-group":"[class*=-math-group]",a&&p.select(e.node().parentNode).select(a).style({opacity:0});var o=this.textContent;p.select(this).transition().duration(0).remove(),p.select(document).on("mouseup",null),l.edit.call(e,o)}).on("focus",function(){var e=this;i._editing=!0,p.select(document).on("mouseup",function(){return p.event.target!==e&&void(document.activeElement===n.node()&&n.node().blur())})}).on("keyup",function(){27===p.event.which?(i._editing=!1,e.style({opacity:1}),p.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),l.cancel.call(e,this.textContent)):(l.input.call(e,this.textContent),p.select(this).call(c(e,r,t)))}).on("keydown",function(){13===p.event.which&&this.blur()}).call(o)}var i=t.gd,n=t.delegate,l=p.dispatch("edit","input","cancel"),s=n||e;if(e.style({"pointer-events":n?"none":"all"}),1!==e.size())throw new Error("boo");return t.immediate?a():s.on("click",a),p.rebind(e,l,"on")}},{"../constants/alignment":664,"../constants/xmlns_namespaces":670,"../lib":692,d3:148}],717:[function(e,t,a){"use strict";function o(e){e&&null!==e.timer&&(clearTimeout(e.timer),e.timer=null)}var r={};a.throttle=function(e,t,a){function i(){a(),n.ts=Date.now(),n.onDone&&(n.onDone(),n.onDone=null)}var n=r[e],l=Date.now();if(!n){for(var s in r)r[s].ts<l-6e4&&delete r[s];n=r[e]={ts:0,timer:null}}return o(n),l>n.ts+t?void i():void(n.timer=setTimeout(function(){i(),n.timer=null},t))},a.done=function(e){var t=r[e];return t&&t.timer?new Promise(function(e){var a=t.onDone;t.onDone=function(){a&&a(),e(),t.onDone=null}}):Promise.resolve()},a.clear=function(e){if(e)o(r[e]),delete r[e];else for(var t in r)a.clear(t)}},{}],718:[function(e,t){"use strict";var a=e("fast-isnumeric");t.exports=function(e,t){if(0<e)return P(e)/z;var o=P(ie(t[0],t[1]))/z;return a(o)||(o=P(va(t[0],t[1]))/z-6),o}},{"fast-isnumeric":214}],719:[function(e,t){"use strict";var a=t.exports={},o=e("../plots/geo/constants").locationmodeToLayer,r=e("topojson-client").feature;a.getTopojsonName=function(e){return[e.scope.replace(/ /g,"-"),"_",e.resolution.toString(),"m"].join("")},a.getTopojsonPath=function(e,t){return e+t+".json"},a.getTopojsonFeatures=function(e,t){var a=o[e.locationmode],i=t.objects[a];return r(t,i).features}},{"../plots/geo/constants":769,"topojson-client":516}],720:[function(e,t){"use strict";t.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],721:[function(e,t){"use strict";t.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],722:[function(e,t){"use strict";var a=e("../registry");t.exports=function(e){for(var t=a.layoutArrayContainers,o=a.layoutArrayRegexes,r=e.split("[")[0],n=0,l,s;n<o.length;n++)if(s=e.match(o[n]),s&&0===s.index){l=s[0];break}if(l||(l=t[t.indexOf(r)]),!l)return!1;var d=e.substr(l.length);return d?(s=d.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/),!!s&&{array:l,index:+s[1],property:s[3]||""}):{array:l,index:"",property:""}}},{"../registry":823}],723:[function(e,t){"use strict";function a(e){for(var t={},a=0;a<e.length;a++)t[e[a]]=!1;return t}function o(e,t,a){var o=n({},e);for(var i in o){var s=o[i];l(s)&&(o[i]=r(s,t,a,i))}return"from-root"===a&&(o.editType=t),o}function r(e,t,a,l){if(e.valType){var s=n({},e);if(s.editType=t,Array.isArray(e.items)){s.items=Array(e.items.length);for(var d=0;d<e.items.length;d++)s.items[d]=r(e.items[d],t,"from-root")}return s}return o(e,t,"_"===l.charAt(0)?"nested":"from-root")}var i=e("../lib"),n=i.extendFlat,l=i.isPlainObject,s={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},d={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw"]},c=s.flags.slice().concat(["fullReplot"]),p=d.flags.slice().concat("layoutReplot");t.exports={traces:s,layout:d,traceFlags:function(){return a(c)},layoutFlags:function(){return a(p)},update:function(e,t){var a=t.editType;if(a&&"none"!==a)for(var o=a.split("+"),r=0;r<o.length;r++)e[o[r]]=!0},overrideAll:o}},{"../lib":692}],724:[function(e,t,a){"use strict";function o(e,t){var a=e[t],o=t.charAt(0);a&&"paper"!==a&&(e[t]=y(a,o))}function r(e){function t(t,a){var o=e[t],r=e.title&&e.title[a];o&&!r&&(!e.title&&(e.title={}),e.title[a]=e[t],delete e[t])}e&&(("string"==typeof e.title||"number"==typeof e.title)&&(e.title={text:e.title}),t("titlefont","font"),t("titleposition","position"),t("titleside","side"),t("titleoffset","offset"))}function i(e){if(!g.isPlainObject(e))return!1;var t=e.name;return delete e.name,delete e.showlegend,("string"==typeof t||"number"==typeof t)&&t+""}function n(e,t,a,o){if(a&&!o)return e;if(o&&!a)return t;if(!e.trim())return t;if(!t.trim())return e;var r=ie(e.length,t.length),n;for(n=0;n<r&&!(e.charAt(n)!==t.charAt(n));n++);var l=e.substr(0,n);return l.trim()}function l(e){var t="middle",a="center";return"string"==typeof e&&(-1===e.indexOf("top")?-1!==e.indexOf("bottom")&&(t="bottom"):t="top",-1===e.indexOf("left")?-1!==e.indexOf("right")&&(a="right"):a="left"),t+" "+a}function s(e,t){return t in e&&"object"==typeof e[t]&&0===Object.keys(e[t]).length}function d(e){var t=e.search(b);if(0<t)return e.substr(0,t)}var c=e("fast-isnumeric"),p=e("gl-mat4/fromQuat"),u=e("../registry"),g=e("../lib"),h=e("../plots/plots"),m=e("../plots/cartesian/axis_ids"),y=m.cleanId,f=m.getFromTrace,x=e("../components/color");a.clearPromiseQueue=function(e){Array.isArray(e._promises)&&0<e._promises.length&&g.log("Clearing previous rejected promises from queue."),e._promises=[]},a.cleanLayout=function(e){var t,n;e||(e={}),e.xaxis1&&(!e.xaxis&&(e.xaxis=e.xaxis1),delete e.xaxis1),e.yaxis1&&(!e.yaxis&&(e.yaxis=e.yaxis1),delete e.yaxis1),e.scene1&&(!e.scene&&(e.scene=e.scene1),delete e.scene1);var l=(h.subplotsRegistry.cartesian||{}).attrRegex,d=(h.subplotsRegistry.polar||{}).attrRegex,c=(h.subplotsRegistry.ternary||{}).attrRegex,u=(h.subplotsRegistry.gl3d||{}).attrRegex,m=Object.keys(e);for(t=0;t<m.length;t++){var f=m[t];if(l&&l.test(f)){var b=e[f];b.anchor&&"free"!==b.anchor&&(b.anchor=y(b.anchor)),b.overlaying&&(b.overlaying=y(b.overlaying)),b.type||(b.isdate?b.type="date":b.islog?b.type="log":!1===b.isdate&&!1===b.islog&&(b.type="linear")),("withzero"===b.autorange||"tozero"===b.autorange)&&(b.autorange=!0,b.rangemode="tozero"),delete b.islog,delete b.isdate,delete b.categories,s(b,"domain")&&delete b.domain,void 0!==b.autotick&&(void 0===b.tickmode&&(b.tickmode=b.autotick?"auto":"linear"),delete b.autotick),r(b)}else if(d&&d.test(f)){var _=e[f];r(_.radialaxis)}else if(c&&c.test(f)){var v=e[f];r(v.aaxis),r(v.baxis),r(v.caxis)}else if(u&&u.test(f)){var w=e[f],k=w.cameraposition;if(Array.isArray(k)&&4===k[0].length){var T=k[0],A=k[1],S=k[2],C=p([],T),L=[];for(n=0;3>n;++n)L[n]=A[n]+S*C[2+4*n];w.camera={eye:{x:L[0],y:L[1],z:L[2]},center:{x:A[0],y:A[1],z:A[2]},up:{x:0,y:0,z:1}},delete w.cameraposition}r(w.xaxis),r(w.yaxis),r(w.zaxis)}}var E=Array.isArray(e.annotations)?e.annotations.length:0;for(t=0;t<E;t++){var z=e.annotations[t];g.isPlainObject(z)&&(z.ref&&("paper"===z.ref?(z.xref="paper",z.yref="paper"):"data"===z.ref&&(z.xref="x",z.yref="y"),delete z.ref),o(z,"xref"),o(z,"yref"))}var I=Array.isArray(e.shapes)?e.shapes.length:0;for(t=0;t<I;t++){var D=e.shapes[t];g.isPlainObject(D)&&(o(D,"xref"),o(D,"yref"))}var P=e.legend;return P&&(3<P.x?(P.x=1.02,P.xanchor="left"):-2>P.x&&(P.x=-.02,P.xanchor="right"),3<P.y?(P.y=1.02,P.yanchor="bottom"):-2>P.y&&(P.y=-.02,P.yanchor="top")),r(e),"rotate"===e.dragmode&&(e.dragmode="orbit"),x.clean(e),e.template&&e.template.layout&&a.cleanLayout(e.template.layout),e},a.cleanData=function(e){for(var t=0;t<e.length;t++){var o=e[t],d;if("histogramy"===o.type&&"xbins"in o&&!("ybins"in o)&&(o.ybins=o.xbins,delete o.xbins),o.error_y&&"opacity"in o.error_y){var c=x.defaults,p=o.error_y.color||(u.traceIs(o,"bar")?x.defaultLine:c[t%c.length]);o.error_y.color=x.addOpacity(x.rgb(p),x.opacity(p)*o.error_y.opacity),delete o.error_y.opacity}if("bardir"in o&&("h"===o.bardir&&(u.traceIs(o,"bar")||"histogram"===o.type.substr(0,9))&&(o.orientation="h",a.swapXYData(o)),delete o.bardir),"histogramy"===o.type&&a.swapXYData(o),("histogramx"===o.type||"histogramy"===o.type)&&(o.type="histogram"),"scl"in o&&(o.colorscale=o.scl,delete o.scl),"reversescl"in o&&(o.reversescale=o.reversescl,delete o.reversescl),o.xaxis&&(o.xaxis=y(o.xaxis,"x")),o.yaxis&&(o.yaxis=y(o.yaxis,"y")),u.traceIs(o,"gl3d")&&o.scene&&(o.scene=h.subplotsRegistry.gl3d.cleanId(o.scene)),!u.traceIs(o,"pie")&&!u.traceIs(o,"bar"))if(Array.isArray(o.textposition))for(d=0;d<o.textposition.length;d++)o.textposition[d]=l(o.textposition[d]);else o.textposition&&(o.textposition=l(o.textposition));var m=u.getModule(o);if(m&&m.colorbar){var f=m.colorbar.container,b=f?o[f]:o;b&&b.colorscale&&("YIGnBu"===b.colorscale&&(b.colorscale="YlGnBu"),"YIOrRd"===b.colorscale&&(b.colorscale="YlOrRd"))}if("surface"===o.type&&g.isPlainObject(o.contours)){var _=["x","y","z"];for(d=0;d<_.length;d++){var v=o.contours[_[d]];g.isPlainObject(v)&&(v.highlightColor&&(v.highlightcolor=v.highlightColor,delete v.highlightColor),v.highlightWidth&&(v.highlightwidth=v.highlightWidth,delete v.highlightWidth))}}if("candlestick"===o.type||"ohlc"===o.type){var w=!1!==(o.increasing||{}).showlegend,k=!1!==(o.decreasing||{}).showlegend,T=i(o.increasing),A=i(o.decreasing);if(!1!==T&&!1!==A){var S=n(T,A,w,k);S&&(o.name=S)}else(T||A)&&!o.name&&(o.name=T||A)}if(Array.isArray(o.transforms)){var C=o.transforms;for(d=0;d<C.length;d++){var L=C[d];if(g.isPlainObject(L))switch(L.type){case"filter":L.filtersrc&&(L.target=L.filtersrc,delete L.filtersrc),L.calendar&&(!L.valuecalendar&&(L.valuecalendar=L.calendar),delete L.calendar);break;case"groupby":if(L.styles=L.styles||L.style,L.styles&&!Array.isArray(L.styles)){var E=L.styles,z=Object.keys(E);L.styles=[];for(var I=0;I<z.length;I++)L.styles.push({target:z[I],value:E[z[I]]})}}}}s(o,"line")&&delete o.line,"marker"in o&&(s(o.marker,"line")&&delete o.marker.line,s(o,"marker")&&delete o.marker),x.clean(o),o.autobinx&&(delete o.autobinx,delete o.xbins),o.autobiny&&(delete o.autobiny,delete o.ybins),r(o),o.colorbar&&r(o.colorbar),o.marker&&o.marker.colorbar&&r(o.marker.colorbar),o.line&&o.line.colorbar&&r(o.line.colorbar),o.aaxis&&r(o.aaxis),o.baxis&&r(o.baxis)}},a.swapXYData=function(e){var t;if(g.swapAttrs(e,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(e.z)&&Array.isArray(e.z[0])&&(e.transpose?delete e.transpose:e.transpose=!0),e.error_x&&e.error_y){var a=e.error_y,o="copy_ystyle"in a?a.copy_ystyle:!(a.color||a.thickness||a.width);g.swapAttrs(e,["error_?.copy_ystyle"]),o&&g.swapAttrs(e,["error_?.color","error_?.thickness","error_?.width"])}if("string"==typeof e.hoverinfo){var r=e.hoverinfo.split("+");for(t=0;t<r.length;t++)"x"===r[t]?r[t]="y":"y"===r[t]&&(r[t]="x");e.hoverinfo=r.join("+")}},a.coerceTraceIndices=function(e,t){if(c(t))return[t];if(!Array.isArray(t)||!t.length)return e.data.map(function(e,t){return t});if(Array.isArray(t)){for(var a=[],o=0;o<t.length;o++)g.isIndex(t[o],e.data.length)?a.push(t[o]):g.warn("trace index (",t[o],") is not a number or is out of bounds");return a}return t},a.manageArrayContainers=function(e,t,a){var o=e.obj,r=e.parts,i=r.length,n=r[i-1],l=c(n);if(l&&null===t){var s=r.slice(0,i-1).join("."),d=g.nestedProperty(o,s).get();d.splice(n,1)}else l&&void 0===e.get()?(void 0===e.get()&&(a[e.astr]=null),e.set(t)):e.set(t)};var b=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;a.hasParent=function(e,t){for(var a=d(t);a;){if(a in e)return!0;a=d(a)}return!1};var _=["x","y","z"];a.clearAxisTypes=function(e,t,a){for(var o=0,r;o<t.length;o++){r=e._fullData[o];for(var n=0,l;3>n;n++)if(l=f(e,r,_[n]),l&&"log"!==l.type){var s=l._name,d=l._id.substr(1);if("scene"===d.substr(0,5)){if(void 0!==a[d])continue;s=d+"."+s}var c=s+".type";void 0===a[s]&&void 0===a[c]&&g.nestedProperty(e.layout,c).set(null)}}}},{"../components/color":569,"../lib":692,"../plots/cartesian/axis_ids":743,"../plots/plots":804,"../registry":823,"fast-isnumeric":214,"gl-mat4/fromQuat":251}],725:[function(e,t,a){"use strict";var o=e("./plot_api");a.plot=o.plot,a.newPlot=o.newPlot,a.restyle=o.restyle,a.relayout=o.relayout,a.redraw=o.redraw,a.update=o.update,a._guiRestyle=o._guiRestyle,a._guiRelayout=o._guiRelayout,a._guiUpdate=o._guiUpdate,a._storeDirectGUIEdit=o._storeDirectGUIEdit,a.react=o.react,a.extendTraces=o.extendTraces,a.prependTraces=o.prependTraces,a.addTraces=o.addTraces,a.deleteTraces=o.deleteTraces,a.moveTraces=o.moveTraces,a.purge=o.purge,a.addFrames=o.addFrames,a.deleteFrames=o.deleteFrames,a.animate=o.animate,a.setPlotConfig=o.setPlotConfig,a.toImage=e("./to_image"),a.validate=e("./validate"),a.downloadImage=e("../snapshot/download");var r=e("./template_api");a.makeTemplate=r.makeTemplate,a.validateTemplate=r.validateTemplate},{"../snapshot/download":825,"./plot_api":727,"./template_api":732,"./to_image":733,"./validate":734}],726:[function(e,t,a){"use strict";var o=e("../lib/is_plain_object"),r=e("../lib/noop"),n=e("../lib/loggers"),l=e("../lib/search").sorterAsc,s=e("../registry");a.containerArrayMatch=e("./container_array_match");var d=a.isAddVal=function(e){return"add"===e||o(e)},c=a.isRemoveVal=function(e){return null===e||"remove"===e};a.applyContainerArrayChanges=function(e,t,a,o,p){var u=t.astr,g=s.getComponentMethod(u,"supplyLayoutDefaults"),h=s.getComponentMethod(u,"draw"),m=s.getComponentMethod(u,"drawOne"),y=o.replot||o.recalc||g===r||h===r,f=e.layout,x=e._fullLayout;if(a[""]){1<Object.keys(a).length&&n.warn("Full array edits are incompatible with other edits",u);var b=a[""][""];if(c(b))t.set(null);else if(Array.isArray(b))t.set(b);else return n.warn("Unrecognized full array edit value",u,b),!0;return!y&&(g(f,x),h(e),!0)}var _=Object.keys(a).map(Number).sort(l),v=t.get(),w=v||[],k=p(x,u).get(),T=[],A=-1,S=w.length,C,L,E,z,I,D,P,O;for(C=0;C<_.length;C++){if(E=_[C],z=a[E],I=Object.keys(z),D=z[""],P=d(D),0>E||E>w.length-(P?0:1)){n.warn("index out of range",u,E);continue}if(void 0!==D)1<I.length&&n.warn("Insertion & removal are incompatible with edits to the same index.",u,E),c(D)?T.push(E):P?("add"===D&&(D={}),w.splice(E,0,D),k&&k.splice(E,0,{})):n.warn("Unrecognized full object edit value",u,E,D),-1===A&&(A=E);else for(L=0;L<I.length;L++)O=u+"["+E+"].",p(w[E],I[L],O).set(z[I[L]])}for(C=T.length-1;0<=C;C--)w.splice(T[C],1),k&&k.splice(T[C],1);if(w.length?!v&&t.set(w):t.set(null),y)return!1;if(g(f,x),m!==r){var R;if(-1===A)R=_;else{for(S=va(w.length,S),R=[],C=0;C<_.length&&(E=_[C],!(E>=A));C++)R.push(E);for(C=A;C<S;C++)R.push(C)}for(C=0;C<R.length;C++)m(e,R[C])}else h(e);return!0}},{"../lib/is_plain_object":693,"../lib/loggers":696,"../lib/noop":701,"../lib/search":711,"../registry":823,"./container_array_match":722}],727:[function(e,t,a){"use strict";function o(e){var t=e._fullLayout;t._redrawFromAutoMarginCount?t._redrawFromAutoMarginCount--:e.emit("plotly_afterplot")}function r(e,t){try{e._fullLayout._paper.style("background",t)}catch(t){Y.error(t)}}function n(e,t){var a=te.combine(t,"white");r(e,a)}function l(e,t){if(!e._context){e._context=Y.extendDeep({},le);var a=H.select("base");e._context._baseUrl=a.size()&&a.attr("href")?window.location.href.split("#")[0]:""}var o=e._context,l,s,d;if(t){for(s=Object.keys(t),l=0;l<s.length;l++)d=s[l],"editable"!==d&&"edits"!==d&&d in o&&("setBackground"===d&&"opaque"===t[d]?o[d]=n:o[d]=t[d]);t.plot3dPixelRatio&&!o.plotGlPixelRatio&&(o.plotGlPixelRatio=o.plot3dPixelRatio);var c=t.editable;if(c!==void 0)for(o.editable=c,s=Object.keys(o.edits),l=0;l<s.length;l++)o.edits[s[l]]=c;if(t.edits)for(s=Object.keys(t.edits),l=0;l<s.length;l++)d=s[l],d in o.edits&&(o.edits[d]=t.edits[d]);o._exportedPlot=t._exportedPlot}o.staticPlot&&(o.editable=!1,o.edits={},o.autosizable=!1,o.scrollZoom=!1,o.doubleClick=!1,o.showTips=!1,o.showLink=!1,o.displayModeBar=!1),"hover"!==o.displayModeBar||G||(o.displayModeBar=!0),("transparent"===o.setBackground||"function"!=typeof o.setBackground)&&(o.setBackground=r),o._hasZeroHeight=o._hasZeroHeight||0===e.clientHeight,o._hasZeroWidth=o._hasZeroWidth||0===e.clientWidth}function s(e,t,a){var o=H.select(e).selectAll(".plot-container").data([0]);o.enter().insert("div",":first-child").classed("plot-container plotly",!0);var r=o.selectAll(".svg-container").data([0]);r.enter().append("div").classed("svg-container",!0).style("position","relative"),r.html(""),t&&(e.data=t),a&&(e.layout=a),K.manager.fillLayout(e),r.style({width:e._fullLayout.width+"px",height:e._fullLayout.height+"px"}),e.framework=K.manager.framework(e),e.framework({data:e.data,layout:e.layout},r.node()),e.framework.setUndoPoint();var i=e.framework.svg(),n=1,l=e._fullLayout.title?e._fullLayout.title.text:"";""!==l&&l||(n=0);var s=function(){this.call(ne.convertToTspans,e)},d=i.select(".title-group text").call(s);if(e._context.edits.titleText){var c=Y._(e,"Click to enter Plot title");l&&l!==c||(n=.2,d.attr({"data-unformatted":c}).text(c).style({opacity:n}).on("mouseover.opacity",function(){H.select(this).transition().duration(100).style("opacity",1)}).on("mouseout.opacity",function(){H.select(this).transition().duration(1e3).style("opacity",0)}));var p=function(){this.call(ne.makeEditable,{gd:e}).on("edit",function(t){e.framework({layout:{title:{text:t}}}),this.text(t).call(s),this.call(p)}).on("cancel",function(){var e=this.attr("data-unformatted");this.text(e).call(s)})};d.call(p)}return e._context.setBackground(e,e._fullLayout.paper_bgcolor),J.addLinks(e),Promise.resolve()}function d(e,t){var a=[],o,r;for(o=0;o<e.length;o++)r=e[o],0>r?a.push(t+1+r):a.push(r);return a}function c(e,t,a){var o,r;for(o=0;o<t.length;o++){if(r=t[o],r!==parseInt(r,10))throw new Error("all values in "+a+" must be integers");if(r>=e.data.length||r<-e.data.length)throw new Error(a+" must be valid indices for gd.data.");if(-1<t.indexOf(r,o+1)||0<=r&&-1<t.indexOf(-e.data.length+r)||0>r&&-1<t.indexOf(e.data.length+r))throw new Error("each index in "+a+" must be unique.")}}function p(e,t,a){if(!Array.isArray(e.data))throw new Error("gd.data must be an array.");if("undefined"==typeof t)throw new Error("currentIndices is a required argument.");else Array.isArray(t)||(t=[t]);if(c(e,t,"currentIndices"),"undefined"==typeof a||Array.isArray(a)||(a=[a]),"undefined"!=typeof a&&c(e,a,"newIndices"),"undefined"!=typeof a&&t.length!==a.length)throw new Error("current and new indices must be of equal length.")}function u(e,t,a){var o,r;if(!Array.isArray(e.data))throw new Error("gd.data must be an array.");if("undefined"==typeof t)throw new Error("traces must be defined.");for(Array.isArray(t)||(t=[t]),o=0;o<t.length;o++)if(r=t[o],"object"!=typeof r||Array.isArray(r)||null===r)throw new Error("all values in traces array must be non-array objects");if("undefined"==typeof a||Array.isArray(a)||(a=[a]),"undefined"!=typeof a&&a.length!==t.length)throw new Error("if indices is specified, traces.length must equal indices.length")}function g(e,t,a,o){var r=Y.isPlainObject(o);if(!Array.isArray(e.data))throw new Error("gd.data must be an array");if(!Y.isPlainObject(t))throw new Error("update must be a key:value object");if("undefined"==typeof a)throw new Error("indices must be an integer or array of integers");for(var i in c(e,a,"indices"),t){if(!Array.isArray(t[i])||t[i].length!==a.length)throw new Error("attribute "+i+" must be an array of length equal to indices array length");if(r&&(!(i in o)||!Array.isArray(o[i])||o[i].length!==t[i].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}function h(e,t,a,o){var r=Y.isPlainObject(o),n=[],l,s,c,p,u;for(var g in Array.isArray(a)||(a=[a]),a=d(a,e.data.length-1),t)for(var h=0;h<a.length;h++){if(l=e.data[a[h]],c=q(l,g),s=c.get(),p=t[g][h],!Y.isArrayOrTypedArray(p))throw new Error("attribute: "+g+" index: "+h+" must be an array");if(!Y.isArrayOrTypedArray(s))throw new Error("cannot extend missing or non-array attribute: "+g);if(s.constructor!==p.constructor)throw new Error("cannot extend array with an array of a different type: "+g);u=r?o[g][h]:o,i(u)||(u=-1),n.push({prop:c,target:s,insert:p,maxp:ea(u)})}return n}function m(e,t,a,o,r){g(e,t,a,o);for(var n=h(e,t,a,o),l={},s={},d=0;d<n.length;d++){var c=n[d].prop,p=n[d].maxp,u=r(n[d].target,n[d].insert,p);c.set(u[0]),Array.isArray(l[c.astr])||(l[c.astr]=[]),l[c.astr].push(u[1]),Array.isArray(s[c.astr])||(s[c.astr]=[]),s[c.astr].push(n[d].target.length)}return{update:l,maxPoints:s}}function y(e,t){var a=new e.constructor(e.length+t.length);return a.set(e),a.set(t,e.length),a}function f(e,t,r,i){e=Y.getGraphDiv(e),de.clearPromiseQueue(e);var n={};if("string"==typeof t)n[t]=r;else if(Y.isPlainObject(t))n=Y.extendFlat({},t),void 0===i&&(i=r);else return Y.warn("Restyle fail.",t,r,i),Promise.reject();Object.keys(n).length&&(e.changed=!0);var l=de.coerceTraceIndices(e,i),s=v(e,n,l),d=s.flags;d.calc&&(e.calcdata=void 0),d.clearAxisTypes&&de.clearAxisTypes(e,l,{});var c=[];d.fullReplot?c.push(a.plot):(c.push(J.previousPromises),J.supplyDefaults(e),d.markerSize&&(J.doCalcdata(e),A(c)),d.style&&c.push(ce.doTraceStyle),d.colorbars&&c.push(ce.doColorBars),c.push(o)),c.push(J.rehover),X.add(e,f,[e,s.undoit,s.traces],f,[e,s.redoit,s.traces]);var p=Y.syncOrAsync(c,e);return p&&p.then||(p=Promise.resolve()),p.then(function(){return e.emit("plotly_restyle",s.eventData),e})}function x(e){return void 0===e?null:e}function b(e,t){return t?function(t,a,o){var r=q(t,a),i=r.set;return r.set=function(t){_((o||"")+a,r.get(),t,e),i(t)},r}:q}function _(e,t,a,o){if(Array.isArray(t)||Array.isArray(a))for(var r=Array.isArray(t)?t:[],n=Array.isArray(a)?a:[],l=va(r.length,n.length),s=0;s<l;s++)_(e+"["+s+"]",r[s],n[s],o);else if(Y.isPlainObject(t)||Y.isPlainObject(a)){var d=Y.isPlainObject(t)?t:{},c=Y.isPlainObject(a)?a:{},p=Y.extendFlat({},d,c);for(var u in p)_(e+"."+u,d[u],c[u],o)}else void 0===o[e]&&(o[e]=x(t))}function v(e,t,a){function o(){return a.map(function(){})}function r(e){var t=Q.id2name(e);-1===A.indexOf(t)&&A.push(t)}function n(e){return"LAYOUT"+e+".autorange"}function l(e){return"LAYOUT"+e+".range"}function s(e){for(var t=e;t<g.length;t++)if(g[t]._input===h[e])return g[t]}function d(r,n,l){if(Array.isArray(r))return void r.forEach(function(e){d(e,n,l)});if(!(r in t||de.hasParent(t,r))){var i;if("LAYOUT"===r.substr(0,6))i=y(e.layout,r.replace("LAYOUT",""));else{var c=a[l],p=u._tracePreGUI[s(c)._fullInput.uid];i=b(p,m)(h[c],r)}r in T||(T[r]=o()),void 0===T[r][l]&&(T[r][l]=x(i.get())),void 0!==n&&i.set(n)}}function c(e){return function(t){return g[t][e]}}function p(e){return function(t,o){return!1===t?g[a[o]][e]:null}}var u=e._fullLayout,g=e._fullData,h=e.data,m=u._guiEditing,y=b(u._preGUI,m),f=Y.extendDeepAll({},t),_;w(t);var v=pe.traceFlags(),k={},T={},A;for(var S in t){if(de.hasParent(t,S))throw new Error("cannot set "+S+"and a parent attribute simultaneously");var C=t[S],L,E,z,I,D,P;if(("autobinx"==S||"autobiny"==S)&&(S=S.charAt(S.length-1)+"bins",C=Array.isArray(C)?C.map(p(S)):!1===C?a.map(c(S)):null),k[S]=C,"LAYOUT"===S.substr(0,6)){z=y(e.layout,S.replace("LAYOUT","")),T[S]=[x(z.get())],z.set(Array.isArray(C)?C[0]:C),v.calc=!0;continue}for(T[S]=o(),_=0;_<a.length;_++){L=h[a[_]],E=s(a[_]);var O=u._tracePreGUI[E._fullInput.uid];if(z=b(O,m)(L,S),I=z.get(),D=Array.isArray(C)?C[_%C.length]:C,void 0!==D){var R=z.parts[z.parts.length-1],M=S.substr(0,S.length-R.length-1),j=M?M+".":"",B=M?q(E,M).get():E;if(P=$.getTraceValObject(E,z.parts),P&&P.impliedEdits&&null!==D)for(var F in P.impliedEdits)d(Y.relativeAttr(S,F),P.impliedEdits[F],_);else if(("thicknessmode"===R||"lenmode"===R)&&I!==D&&("fraction"===D||"pixels"===D)&&B){var N=u._size,V=B.orient,U="top"===V||"bottom"===V;if("thicknessmode"===R){var H=U?N.h:N.w;d(j+"thickness",B.thickness*("fraction"===D?1/H:H),_)}else{var G=U?N.w:N.h;d(j+"len",B.len*("fraction"===D?1/G:G),_)}}else if("type"==S&&"pie"===D!=("pie"===I)){var W="x",X="y";("bar"===D||"bar"===I)&&"h"===L.orientation&&(W="y",X="x"),Y.swapAttrs(L,["?","?src"],"labels",W),Y.swapAttrs(L,["d?","?0"],"label",W),Y.swapAttrs(L,["?","?src"],"values",X),"pie"===I?(q(L,"marker.color").set(q(L,"marker.colors").get()),u._pielayer.selectAll("g.trace").remove()):Z.traceIs(L,"cartesian")&&q(L,"marker.colors").set(q(L,"marker.color").get())}T[S][_]=x(I);if(-1!==["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(S)){if("orientation"==S){z.set(D);var K=L.x&&!L.y?"h":"v";if((z.get()||K)===E.orientation)continue}else"orientationaxes"==S&&(L.orientation={v:"h",h:"v"}[E.orientation]);de.swapXYData(L),v.calc=v.clearAxisTypes=!0}else-1===J.dataArrayContainers.indexOf(z.parts[0])?(P?P.arrayOk&&!Z.traceIs(E,"regl")&&(Y.isArrayOrTypedArray(D)||Y.isArrayOrTypedArray(I))?v.calc=!0:pe.update(v,P):v.calc=!0,z.set(D)):(de.manageArrayContainers(z,D,T),v.calc=!0)}}if(-1!==["swapxyaxes","orientationaxes"].indexOf(S)&&Q.swap(e,a),"orientationaxes"==S){var ee=q(e.layout,"hovermode");"x"===ee.get()?ee.set("y"):"y"===ee.get()&&ee.set("x")}if(-1!==["orientation","type"].indexOf(S)){for(A=[],_=0;_<a.length;_++){var te=h[a[_]];Z.traceIs(te,"cartesian")&&(r(te.xaxis||"x"),r(te.yaxis||"y"))}d(A.map(n),!0,0),d(A.map(l),[0,1],0)}}return(v.calc||v.plot)&&(v.fullReplot=!0),{flags:v,undoit:T,redoit:k,traces:a,eventData:Y.extendDeepNoArrays([],[f,a])}}function w(e){function t(t,a){e[a]=e[t],delete e[t]}var a=Y.counterRegex("axis",".title",!1,!1),o=/colorbar\.title$/,r=Object.keys(e),n,l,s;for(n=0;n<r.length;n++)l=r[n],s=e[l],("title"===l||a.test(l)||o.test(l))&&("string"==typeof s||"number"==typeof s)?t(l,l.replace("title","title.text")):-1<l.indexOf("titlefont")?t(l,l.replace("titlefont","title.font")):-1<l.indexOf("titleposition")?t(l,l.replace("titleposition","title.position")):-1<l.indexOf("titleside")?t(l,l.replace("titleside","title.side")):-1<l.indexOf("titleoffset")&&t(l,l.replace("titleoffset","title.offset"))}function k(e,t,a){if(e=Y.getGraphDiv(e),de.clearPromiseQueue(e),e.framework&&e.framework.isPolar)return Promise.resolve(e);var r={};if("string"==typeof t)r[t]=a;else if(Y.isPlainObject(t))r=Y.extendFlat({},t);else return Y.warn("Relayout fail.",t,a),Promise.reject();Object.keys(r).length&&(e.changed=!0);var i=S(e,r),n=i.flags;n.calc&&(e.calcdata=void 0);var l=[J.previousPromises];n.layoutReplot?l.push(ce.layoutReplot):Object.keys(r).length&&(T(e,n,i)||J.supplyDefaults(e),n.legend&&l.push(ce.doLegend),n.layoutstyle&&l.push(ce.layoutStyles),n.axrange&&A(l,i.rangesAltered),n.ticks&&l.push(ce.doTicksRelayout),n.modebar&&l.push(ce.doModeBar),n.camera&&l.push(ce.doCamera),l.push(o)),l.push(J.rehover),X.add(e,k,[e,i.undoit],k,[e,i.redoit]);var s=Y.syncOrAsync(l,e);return s&&s.then||(s=Promise.resolve(e)),s.then(function(){return e.emit("plotly_relayout",i.eventData),e})}function T(e,t,a){if(!t.axrange)return!1;for(var o in t)if("axrange"!==o&&t[o])return!1;for(o in a.rangesAltered){var r=Q.id2name(o),i=e.layout[r],n=e._fullLayout[r];n.autorange=i.autorange,n.range=i.range.slice(),n.cleanRange()}return!0}function A(e,t){var a=t?function(e){var a={skipTitle:!0};for(var o in t)if(Q.getFromId(e,o).automargin){a={};break}return Q.draw(e,Object.keys(t),a)}:function(e){return Q.draw(e,"redraw")};e.push(ce.doAutoRangeAndConstraints,a,ce.drawData,ce.finalDraw)}function S(e,t){function o(e,r){if(Array.isArray(e))return void e.forEach(function(e){o(e,r)});if(!(e in t||de.hasParent(t,e))){var i=d(n,e);e in A||(A[e]=x(i.get())),void 0!==r&&i.set(r)}}function r(e){var t=Q.name2id(e.split(".")[0]);return S[t]=1,t}var n=e.layout,l=e._fullLayout,s=l._guiEditing,d=b(l._preGUI,s),c=Object.keys(t),u=Q.list(e),g=Y.extendDeepAll({},t),h={},m,y,a;for(w(t),c=Object.keys(t),y=0;y<c.length;y++)if(0===c[y].indexOf("allaxes")){for(a=0;a<u.length;a++){var f=u[a]._id.substr(1),_=-1===f.indexOf("scene")?"":f+".",v=c[y].replace("allaxes",_+u[a]._name);t[v]||(t[v]=t[c[y]])}delete t[c[y]]}var k=pe.layoutFlags(),T={},A={},S={},L;for(var E in t){if(de.hasParent(t,E))throw new Error("cannot set "+E+"and a parent attribute simultaneously");for(var I=d(n,E),p=t[E],D=I.parts.length,O=D-1;0<O&&"string"!=typeof I.parts[O];)O--;var R=I.parts[O],M=I.parts[O-1]+"."+R,B=I.parts.slice(0,O).join("."),F=q(e.layout,B).get(),N=q(l,B).get(),V=I.get();if(void 0!==p){T[E]=p,A[E]="reverse"===R?p:x(V);var U=$.getLayoutValObject(l,I.parts);if(U&&U.impliedEdits&&null!==p)for(var H in U.impliedEdits)o(Y.relativeAttr(E,H),U.impliedEdits[H]);if(-1!==["width","height"].indexOf(E)){if(p){o("autosize",null);var G="height"==E?"width":"height";o(G,l[G])}else l[E]=e._initialAutoSize[E];}else if("autosize"==E)o("width",p?null:l.width),o("height",p?null:l.height);else if(M.match(me))r(M),q(l,B+"._inputRange").set(null);else if(M.match(ye)){r(M),q(l,B+"._inputRange").set(null);var W=q(l,B).get();W._inputDomain&&(W._input.domain=W._inputDomain.slice())}else M.match(fe)&&q(l,B+"._inputDomain").set(null);if("type"===R){var X=F,J="linear"===N.type&&"log"===p,K="log"===N.type&&"linear"===p;if(J||K){if(!X||!X.range)o(B+".autorange",!0);else if(!N.autorange){var ee=X.range[0],te=X.range[1];J?(0>=ee&&0>=te&&o(B+".autorange",!0),0>=ee?ee=te/1e6:0>=te&&(te=ee/1e6),o(B+".range[0]",P(ee)/z),o(B+".range[1]",P(te)/z)):(o(B+".range[0]",_a(10,ee)),o(B+".range[1]",_a(10,te)))}else J&&(X.range=X.range[1]>X.range[0]?[1,2]:[2,1]);Array.isArray(l._subplots.polar)&&l._subplots.polar.length&&l[I.parts[0]]&&"radialaxis"===I.parts[1]&&delete l[I.parts[0]]._subplot.viewInitial["radialaxis.range"],Z.getComponentMethod("annotations","convertCoords")(e,N,p,o),Z.getComponentMethod("images","convertCoords")(e,N,p,o)}else o(B+".autorange",!0),o(B+".range",null);q(l,B+"._inputRange").set(null)}else if(R.match(ue)){var ae=q(l,E).get(),oe=(p||{}).type;oe&&"-"!==oe||(oe="linear"),Z.getComponentMethod("annotations","convertCoords")(e,ae,oe,o),Z.getComponentMethod("images","convertCoords")(e,ae,oe,o)}var re=se.containerArrayMatch(E);if(re){m=re.array,y=re.index;var ie=re.property;""!==y&&""===ie&&(se.isAddVal(p)?A[E]=null:se.isRemoveVal(p)?A[E]=(q(n,m).get()||[])[y]:Y.warn("unrecognized full object value",t)),pe.update(k,U||{editType:"calc"}),h[m]||(h[m]={});var ne=h[m][y];ne||(ne=h[m][y]={}),ne[ie]=p,delete t[E]}else"reverse"===R?(F.range?F.range.reverse():(o(B+".autorange",!0),F.range=[1,0]),N.autorange?k.calc=!0:k.plot=!0):(l._has("scatter-like")&&l._has("regl")&&"dragmode"==E&&("lasso"===p||"select"===p)&&"lasso"!==V&&"select"!==V?k.plot=!0:U?pe.update(k,U):k.calc=!0,I.set(p))}}for(m in h){var le=se.applyContainerArrayChanges(e,d(n,m),h[m],k,d);le||(k.plot=!0)}var ce=l._axisConstraintGroups||[];for(L in S)for(y=0;y<ce.length;y++){var ge=ce[y];if(ge[L])for(var he in k.calc=!0,ge)S[he]||(Q.getFromId(e,he)._constraintShrinkable=!0)}return(C(e)||t.height||t.width)&&(k.plot=!0),(k.plot||k.calc)&&(k.layoutReplot=!0),{flags:k,rangesAltered:S,undoit:A,redoit:T,eventData:g}}function C(e){var t=e._fullLayout,a=t.width,o=t.height;return e.layout.autosize&&J.plotAutoSize(e,e.layout,t),t.width!==a||t.height!==o}function L(e,t,r,i){if(e=Y.getGraphDiv(e),de.clearPromiseQueue(e),e.framework&&e.framework.isPolar)return Promise.resolve(e);Y.isPlainObject(t)||(t={}),Y.isPlainObject(r)||(r={}),Object.keys(t).length&&(e.changed=!0),Object.keys(r).length&&(e.changed=!0);var n=de.coerceTraceIndices(e,i),l=v(e,Y.extendFlat({},t),n),s=l.flags,d=S(e,Y.extendFlat({},r)),c=d.flags;(s.calc||c.calc)&&(e.calcdata=void 0),s.clearAxisTypes&&de.clearAxisTypes(e,n,r);var p=[];if(s.fullReplot&&c.layoutReplot){var u=e.data,g=e.layout;e.data=void 0,e.layout=void 0,p.push(function(){return a.plot(e,u,g)})}else s.fullReplot?p.push(a.plot):c.layoutReplot?p.push(ce.layoutReplot):(p.push(J.previousPromises),T(e,c,d)||J.supplyDefaults(e),s.style&&p.push(ce.doTraceStyle),s.colorbars&&p.push(ce.doColorBars),c.legend&&p.push(ce.doLegend),c.layoutstyle&&p.push(ce.layoutStyles),c.axrange&&A(p,d.rangesAltered),c.ticks&&p.push(ce.doTicksRelayout),c.modebar&&p.push(ce.doModeBar),c.camera&&p.push(ce.doCamera),p.push(o));p.push(J.rehover),X.add(e,L,[e,l.undoit,d.undoit,l.traces],L,[e,l.redoit,d.redoit,l.traces]);var h=Y.syncOrAsync(p,e);return h&&h.then||(h=Promise.resolve(e)),h.then(function(){return e.emit("plotly_update",{data:l.eventData,layout:d.eventData}),e})}function E(e){return function(t){t._fullLayout._guiEditing=!0;var a=e.apply(null,arguments);return t._fullLayout._guiEditing=!1,a}}function I(e,t){for(var a=0;a<t.length;a++){var o=t[a],r=e.match(o.pattern);if(r)return{head:r[1],attr:o.attr}}}function D(e,t){var a=q(t,e).get();if(a!==void 0)return a;var o=e.split(".");for(o.pop();1<o.length;)if(o.pop(),a=q(t,o.join(".")+".uirevision").get(),void 0!==a)return a;return t.uirevision}function O(e,t){for(var a=0;a<t.length;a++)if(t[a]._fullInput.uid===e)return a;return-1}function R(e,t,a){for(var o=0;o<t.length;o++)if(t[o].uid===e)return o;return t[a].uid?-1:a}function M(e,t){var a=Y.isPlainObject(e),o=Array.isArray(e);return a||o?(a&&Y.isPlainObject(t)||o&&Array.isArray(t))&&JSON.stringify(e)===JSON.stringify(t):e===t}function j(e,t,a,o){var r=o._preGUI,n=[],l={},s,d,c,p,u,g,h,m;for(s in r){if(u=I(s,xe),!u)Y.warn("unrecognized GUI edit: "+s);else if(d=u.attr||u.head+".uirevision",c=q(o,d).get(),p=c&&D(d,t),p&&p===c&&(g=r[s],null===g&&(g=void 0),h=q(t,s),m=h.get(),M(m,g))){void 0===m&&"autorange"===s.substr(s.length-9)&&n.push(s.substr(0,s.length-10)),h.set(x(q(o,s).get()));continue}delete r[s],"range["===s.substr(s.length-8,6)&&(l[s.substr(0,s.length-9)]=1)}for(var y=0,f;y<n.length;y++)if(f=n[y],l[f]){var b=q(t,f).get();b&&delete b.autorange}var _=o._tracePreGUI;for(var v in _){var w=_[v],k=null,T;for(s in w){if(!k){var A=O(v,a);if(0>A){delete _[v];break}var S=a[A];T=S._fullInput;var C=R(v,e,T.index);if(0>C){delete _[v];break}k=e[C]}if(u=I(s,be),!u)Y.warn("unrecognized GUI edit: "+s+" in trace uid "+v);else if(u.attr?(c=q(o,u.attr).get(),p=c&&D(u.attr,t)):(c=T.uirevision,p=k.uirevision,void 0===p&&(p=t.uirevision)),p&&p===c&&(g=w[s],null===g&&(g=void 0),h=q(k,s),m=h.get(),M(m,g))){h.set(x(q(T,s).get()));continue}delete w[s]}}}function B(e,t,a,o){function r(e){return $.getTraceValObject(c,e)}if(t.length!==a.length)return{fullReplot:!0,calc:!0};var n=pe.traceFlags();n.arrays={};var l={getValObject:r,flags:n,immutable:o,gd:e},s={},d,c;for(d=0;d<t.length;d++)c=a[d]._fullInput,J.hasMakesDataTransform(c)&&(c=a[d]),s[c.uid]||(s[c.uid]=1,N(t[d]._fullInput,c,[],l));return(n.calc||n.plot)&&(n.fullReplot=!0),n}function F(e,t,a,o){var r=pe.layoutFlags();r.arrays={};return N(t,a,[],{getValObject:function(e){return $.getLayoutValObject(a,e)},flags:r,immutable:o,gd:e}),(r.plot||r.calc)&&(r.layoutReplot=!0),r}function N(e,t,a,o){function r(){var e=u.editType;return c&&-1!==e.indexOf("arraydraw")?void Y.pushUnique(s.arrays[c],p):void pe.update(s,u)}function n(e){return"data_array"===e.valType||e.arrayOk}var l=o.getValObject,s=o.flags,d=o.immutable,c=o.inArray,p=o.arrayIndex,u,g;for(g in e){if(s.calc)return;var h=e[g],m=t[g];if("_"!==g.charAt(0)&&"function"!=typeof h&&h!==m){if(("tick0"===g||"dtick"===g)&&"geo"!==a[0]){var y=t.tickmode;if("auto"===y||"array"===y||!y)continue}if(!("range"===g&&t.autorange)&&("zmin"!==g&&"zmax"!==g||"contourcarpet"!==t.type)){var f=a.concat(g);if(u=l(f),u&&!(u._compareAsJSON&&JSON.stringify(h)===JSON.stringify(m))){var x=u.valType,b=n(u),_=Array.isArray(h),v=Array.isArray(m),w;if(_&&v){var k="_input_"+g,T=e[k],A=t[k];if(Array.isArray(T)&&T===A)continue}if(void 0===m)b&&_?s.calc=!0:r();else if(u._isLinkedToArray){var S=[],C=!1;c||(s.arrays[g]=S);var L=ie(h.length,m.length),E=va(h.length,m.length);if(L!==E)if("arraydraw"===u.editType)C=!0;else{r();continue}for(w=0;w<L;w++)N(h[w],m[w],f.concat(w),Y.extendFlat({inArray:g,arrayIndex:w},o));if(C)for(w=L;w<E;w++)S.push(w)}else!x&&Y.isPlainObject(h)?N(h,m,f,o):b?_&&v?d&&(s.calc=!0):_===v?r():s.calc=!0:_&&v?(h.length!==m.length||h+""!==m+"")&&r():r()}}}}for(g in t)if(!(g in e||"_"===g.charAt(0)||"function"==typeof t[g])){if(u=l(a.concat(g)),n(u)&&Array.isArray(t[g]))return void(s.calc=!0);r()}}function V(e,t){for(var a in e)if("_"!==a.charAt(0)){var o=e[a],r=t[a];if(o!==r)if(Y.isPlainObject(o)&&Y.isPlainObject(r)){if(V(o,r))return!0;}else if(Array.isArray(o)&&Array.isArray(r)){if(o.length!==r.length)return!0;for(var n=0;n<o.length;n++)if(o[n]!==r[n]){if(!(Y.isPlainObject(o[n])&&Y.isPlainObject(r[n])))return!0;if(V(o[n],r[n]))return!0}}else return!0}}function U(e){var t=H.select(e),a=e._fullLayout;if(a._container=t.selectAll(".plot-container").data([0]),a._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),a._paperdiv=a._container.selectAll(".svg-container").data([0]),a._paperdiv.enter().append("div").classed("svg-container",!0).style("position","relative"),a._glcontainer=a._paperdiv.selectAll(".gl-container").data([{}]),a._glcontainer.enter().append("div").classed("gl-container",!0),a._paperdiv.selectAll(".main-svg").remove(),a._paper=a._paperdiv.insert("svg",":first-child").classed("main-svg",!0),a._toppaper=a._paperdiv.append("svg").classed("main-svg",!0),!a._uid){var o={};H.selectAll("defs").each(function(){this.id&&(o[this.id.split("-")[1]]=1)}),a._uid=Y.randstr(o)}a._paperdiv.selectAll(".main-svg").attr(re.svgAttrs),a._defs=a._paper.append("defs").attr("id","defs-"+a._uid),a._clips=a._defs.append("g").classed("clips",!0),a._topdefs=a._toppaper.append("defs").attr("id","topdefs-"+a._uid),a._topclips=a._topdefs.append("g").classed("clips",!0),a._bgLayer=a._paper.append("g").classed("bglayer",!0),a._draggers=a._paper.append("g").classed("draglayer",!0);var r=a._paper.append("g").classed("layer-below",!0);a._imageLowerLayer=r.append("g").classed("imagelayer",!0),a._shapeLowerLayer=r.append("g").classed("shapelayer",!0),a._cartesianlayer=a._paper.append("g").classed("cartesianlayer",!0),a._polarlayer=a._paper.append("g").classed("polarlayer",!0),a._ternarylayer=a._paper.append("g").classed("ternarylayer",!0),a._geolayer=a._paper.append("g").classed("geolayer",!0),a._pielayer=a._paper.append("g").classed("pielayer",!0),a._glimages=a._paper.append("g").classed("glimages",!0);var i=a._toppaper.append("g").classed("layer-above",!0);a._imageUpperLayer=i.append("g").classed("imagelayer",!0),a._shapeUpperLayer=i.append("g").classed("shapelayer",!0),a._infolayer=a._toppaper.append("g").classed("infolayer",!0),a._menulayer=a._toppaper.append("g").classed("menulayer",!0),a._zoomlayer=a._toppaper.append("g").classed("zoomlayer",!0),a._hoverlayer=a._toppaper.append("g").classed("hoverlayer",!0),e.emit("plotly_framework")}var H=e("d3"),i=e("fast-isnumeric"),G=e("has-hover"),Y=e("../lib"),q=Y.nestedProperty,W=e("../lib/events"),X=e("../lib/queue"),Z=e("../registry"),$=e("./plot_schema"),J=e("../plots/plots"),K=e("../plots/polar/legacy"),Q=e("../plots/cartesian/axes"),ee=e("../components/drawing"),te=e("../components/color"),ae=e("../components/colorbar/connect"),oe=e("../plots/cartesian/graph_interact").initInteractions,re=e("../constants/xmlns_namespaces"),ne=e("../lib/svg_text_utils"),le=e("./plot_config"),se=e("./manage_arrays"),de=e("./helpers"),ce=e("./subroutines"),pe=e("./edit_types"),ue=e("../plots/cartesian/constants").AX_NAME_PATTERN,ge=0,he=5;a.plot=function(e,t,r,n){function d(){if(y)return a.addFrames(e,y)}function c(){for(var t=_._basePlotModules,a=0;a<t.length;a++)t[a].drawFramework&&t[a].drawFramework(e);if(!_._glcanvas&&_._has("gl")&&(_._glcanvas=_._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(e){return e.key}),_._glcanvas.enter().append("canvas").attr("class",function(e){return"gl-canvas gl-canvas-"+e.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"visible","pointer-events":"none"})),_._glcanvas){_._glcanvas.attr("width",_.width).attr("height",_.height);var o=_._glcanvas.data()[0].regl;if(o&&(ea(_.width)!==o._gl.drawingBufferWidth||ea(_.height)!==o._gl.drawingBufferHeight)){if(A)Y.error("WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.");else return Y.log("WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug. Clearing graph and plotting again."),J.cleanPlot([],{},e._fullData,_),J.supplyDefaults(e),_=e._fullLayout,J.doCalcdata(e),A++,c()}}return J.previousPromises(e)}function p(){var t=e.calcdata,a,o,r;for(J.clearAutoMarginIds(e),ce.drawMarginPushers(e),Q.allowAutoMargin(e),a=0;a<t.length;a++){o=t[a],r=o[0].trace;var n=r._module.colorbar;!0===r.visible&&n?ae(e,o,n):J.autoMargin(e,"cb"+r.uid)}return J.doAutoMargin(e),J.previousPromises(e)}function u(){return JSON.stringify(_._size)===T?void 0:Y.syncOrAsync([p,ce.layoutStyles],e)}function g(){return w?Y.syncOrAsync([Z.getComponentMethod("shapes","calcAutorange"),Z.getComponentMethod("annotations","calcAutorange"),h],e):void h()}function h(){e._transitioning||(ce.doAutoRangeAndConstraints(e),b&&Q.saveRangeInitial(e),Z.getComponentMethod("rangeslider","calcAutorange")(e))}function m(){return Q.draw(e,b?"":"redraw")}var y;if(e=Y.getGraphDiv(e),W.init(e),Y.isPlainObject(t)){var f=t;t=f.data,r=f.layout,n=f.config,y=f.frames}var x=W.triggerHandler(e,"plotly_beforeplot",[t,r,n]);if(!1===x)return Promise.reject();t||r||Y.isPlotDiv(e)||Y.warn("Calling Plotly.plot as if redrawing but this container doesn't yet have a plot.",e),l(e,n),r||(r={}),H.select(e).classed("js-plotly-plot",!0),ee.makeTester(),Array.isArray(e._promises)||(e._promises=[]);var b=0===(e.data||[]).length&&Array.isArray(t);if(Array.isArray(t)&&(de.cleanData(t),b?e.data=t:e.data.push.apply(e.data,t),e.empty=!1),(!e.layout||b)&&(e.layout=de.cleanLayout(r)),e._dragging&&!e._transitioning)return e._replotPending=!0,Promise.reject();e._replotPending=!1,J.supplyDefaults(e);var _=e._fullLayout,v=_._has("cartesian");if(!_._has("polar")&&t&&t[0]&&t[0].r)return Y.log("Legacy polar charts are deprecated!"),s(e,t,r);_._replotting=!0,b&&U(e),e.framework!==U&&(e.framework=U,U(e)),ee.initGradients(e),b&&Q.saveShowSpikeInitial(e);var w=!e.calcdata||e.calcdata.length!==(e._fullData||[]).length;w&&J.doCalcdata(e);for(var k=0;k<e.calcdata.length;k++)e.calcdata[k][0].trace=e._fullData[k];e._context.responsive?!e._responsiveChartHandler&&(e._responsiveChartHandler=function(){J.resize(e)},window.addEventListener("resize",e._responsiveChartHandler)):Y.clearResponsive(e);var T=JSON.stringify(_._size),A=0,S=[J.previousPromises,d,c,p,u];v&&S.push(g),S.push(ce.layoutStyles),v&&S.push(m),S.push(ce.drawData,ce.finalDraw,oe,J.addLinks,J.rehover,J.doAutoMargin,J.previousPromises);var C=Y.syncOrAsync(S,e);return C&&C.then||(C=Promise.resolve()),C.then(function(){return o(e),e})},a.setPlotConfig=function(e){return Y.extendFlat(le,e)},a.redraw=function(e){if(e=Y.getGraphDiv(e),!Y.isPlotDiv(e))throw new Error("This element is not a Plotly plot: "+e);return de.cleanData(e.data),de.cleanLayout(e.layout),e.calcdata=void 0,a.plot(e).then(function(){return e.emit("plotly_redraw"),e})},a.newPlot=function(e,t,o,r){return e=Y.getGraphDiv(e),J.cleanPlot([],{},e._fullData||[],e._fullLayout||{}),J.purge(e),a.plot(e,t,o,r)},a.extendTraces=function e(t,o,r,i){t=Y.getGraphDiv(t);var n=m(t,o,r,i,function(e,t,a){var o,r;if(!Y.isTypedArray(e))o=e.concat(t),r=0<=a&&a<o.length?o.splice(0,o.length-a):[];else if(0>a){var i=new e.constructor(0),n=y(e,t);0>a?(o=n,r=i):(o=i,r=n)}else if(o=new e.constructor(a),r=new e.constructor(e.length+t.length-a),a===t.length)o.set(t),r.set(e);else if(a<t.length){var l=t.length-a;o.set(t.subarray(l)),r.set(e),r.set(t.subarray(0,l),e.length)}else{var s=a-t.length,d=e.length-s;o.set(e.subarray(d)),o.set(t,s),r.set(e.subarray(0,d))}return[o,r]}),l=a.redraw(t),s=[t,n.update,r,n.maxPoints];return X.add(t,a.prependTraces,s,e,arguments),l},a.prependTraces=function e(t,o,r,i){t=Y.getGraphDiv(t);var n=m(t,o,r,i,function(e,t,a){var o,r;if(!Y.isTypedArray(e))o=t.concat(e),r=0<=a&&a<o.length?o.splice(a,o.length):[];else if(0>=a){var i=new e.constructor(0),n=y(t,e);0>a?(o=n,r=i):(o=i,r=n)}else if(o=new e.constructor(a),r=new e.constructor(e.length+t.length-a),a===t.length)o.set(t),r.set(e);else if(a<t.length){var l=t.length-a;o.set(t.subarray(0,l)),r.set(t.subarray(l)),r.set(e,l)}else{var s=a-t.length;o.set(t),o.set(e.subarray(0,s),t.length),r.set(e.subarray(s))}return[o,r]}),l=a.redraw(t),s=[t,n.update,r,n.maxPoints];return X.add(t,a.extendTraces,s,e,arguments),l},a.addTraces=function e(t,o,r){t=Y.getGraphDiv(t);var n=[],l=a.deleteTraces,s=e,d=[t,n],c=[t,o],g,h;for(u(t,o,r),Array.isArray(o)||(o=[o]),o=o.map(function(e){return Y.extendFlat({},e)}),de.cleanData(o),g=0;g<o.length;g++)t.data.push(o[g]);for(g=0;g<o.length;g++)n.push(-o.length+g);if("undefined"==typeof r)return h=a.redraw(t),X.add(t,l,d,s,c),h;Array.isArray(r)||(r=[r]);try{p(t,n,r)}catch(e){throw t.data.splice(t.data.length-o.length,o.length),e}return X.startSequence(t),X.add(t,l,d,s,c),h=a.moveTraces(t,n,r),X.stopSequence(t),h},a.deleteTraces=function e(t,o){t=Y.getGraphDiv(t);var r=[],n=a.addTraces,l=[t,r,o],s=[t,o],p,u;if("undefined"==typeof o)throw new Error("indices must be an integer or array of integers.");else Array.isArray(o)||(o=[o]);for(c(t,o,"indices"),o=d(o,t.data.length-1),o.sort(Y.sorterDes),p=0;p<o.length;p+=1)u=t.data.splice(o[p],1)[0],r.push(u);var g=a.redraw(t);return X.add(t,n,l,e,s),g},a.moveTraces=function e(t,o,r){t=Y.getGraphDiv(t);var n=[],l=[],s=[t,r,o],c=[t,o,r],u;if(p(t,o,r),o=Array.isArray(o)?o:[o],"undefined"==typeof r)for(r=[],u=0;u<o.length;u++)r.push(-o.length+u);for(r=Array.isArray(r)?r:[r],o=d(o,t.data.length-1),r=d(r,t.data.length-1),u=0;u<t.data.length;u++)-1===o.indexOf(u)&&n.push(t.data[u]);for(u=0;u<o.length;u++)l.push({newIndex:r[u],trace:t.data[o[u]]});for(l.sort(function(e,t){return e.newIndex-t.newIndex}),u=0;u<l.length;u+=1)n.splice(l[u].newIndex,0,l[u].trace);t.data=n;var g=a.redraw(t);return X.add(t,e,s,e,c),g},a.restyle=f,a._storeDirectGUIEdit=function(e,t,a){for(var o in a){var r=q(e,o);_(o,r.get(),a[o],t)}},a.relayout=k;var me=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,ye=/^[xyz]axis[0-9]*\.autorange$/,fe=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;a.update=L,a._guiRestyle=E(f),a._guiRelayout=E(k),a._guiUpdate=E(L);var xe=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],be=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];a.react=function(e,t,r,n){function s(){return a.addFrames(e,d)}var d,c;e=Y.getGraphDiv(e);var p=e._fullData,u=e._fullLayout;if(!Y.isPlotDiv(e)||!p||!u)c=a.newPlot(e,t,r,n);else{if(Y.isPlainObject(t)){var g=t;t=g.data,r=g.layout,n=g.config,d=g.frames}var h=!1;if(n){var m=Y.extendDeep({},e._context);e._context=void 0,l(e,n),h=V(m,e._context)}e.data=t||[],de.cleanData(e.data),e.layout=r||{},de.cleanLayout(e.layout),j(e.data,e.layout,p,u),J.supplyDefaults(e,{skipUpdateCalc:!0});var y=e._fullData,f=e._fullLayout,x=void 0===f.datarevision,b=B(e,p,y,x),_=F(e,u,f,x);C(e)&&(_.layoutReplot=!0),b.calc||_.calc?e.calcdata=void 0:J.supplyDefaultsUpdateCalc(e.calcdata,y);var v=[];if(d&&(e._transitionData={},J.createTransitionData(e),v.push(s)),b.fullReplot||_.layoutReplot||h)e._fullLayout._skipDefaults=!0,v.push(a.plot);else{for(var w in _.arrays){var k=_.arrays[w];if(k.length){var T=Z.getComponentMethod(w,"drawOne");if(T!==Y.noop)for(var S=0;S<k.length;S++)T(e,k[S]);else{var L=Z.getComponentMethod(w,"draw");if(L===Y.noop)throw new Error("cannot draw components: "+w);L(e)}}}v.push(J.previousPromises),b.style&&v.push(ce.doTraceStyle),b.colorbars&&v.push(ce.doColorBars),_.legend&&v.push(ce.doLegend),_.layoutstyle&&v.push(ce.layoutStyles),_.axrange&&A(v),_.ticks&&v.push(ce.doTicksRelayout),_.modebar&&v.push(ce.doModeBar),_.camera&&v.push(ce.doCamera),v.push(o)}v.push(J.rehover),c=Y.syncOrAsync(v,e),c&&c.then||(c=Promise.resolve(e))}return c.then(function(){return e.emit("plotly_react",{data:t,layout:r}),e})},a.animate=function(e,t,a){function o(e){return Array.isArray(s)?e>=s.length?s[0]:s[e]:s}function r(e){return Array.isArray(d)?e>=d.length?d[0]:d[e]:d}function n(e,t){var a=0;return function(){if(e&&++a===t)return e()}}if(e=Y.getGraphDiv(e),!Y.isPlotDiv(e))throw new Error("This element is not a Plotly plot: "+e+". It's likely that you've failed to create a plot before animating it. For more details, see https://plot.ly/javascript/animations/");var l=e._transitionData;l._frameQueue||(l._frameQueue=[]),a=J.supplyAnimationDefaults(a);var s=a.transition,d=a.frame;return void 0===l._frameWaitingCnt&&(l._frameWaitingCnt=0),new Promise(function(d,c){function p(){if(0!==l._frameQueue.length){for(;l._frameQueue.length;){var t=l._frameQueue.pop();t.onInterrupt&&t.onInterrupt()}e.emit("plotly_animationinterrupted",[])}}function u(t){if(0!==t.length){for(var s=0;s<t.length;s++){var p="byname"===t[s].type?J.computeFrame(e,t[s].name):t[s].data;var u=r(s),g=o(s);g.duration=ie(g.duration,u.duration);var h={frame:p,name:t[s].name,frameOpts:u,transitionOpts:g};s==t.length-1&&(h.onComplete=n(d,2),h.onInterrupt=c),l._frameQueue.push(h)}"immediate"===a.mode&&(l._lastFrameAt=-Infinity),l._animationRaf||m()}}function g(){e.emit("plotly_animated"),window.cancelAnimationFrame(l._animationRaf),l._animationRaf=null}function h(){l._currentFrame&&l._currentFrame.onComplete&&l._currentFrame.onComplete();var t=l._currentFrame=l._frameQueue.shift();if(t){var a=t.name?t.name.toString():null;e._fullLayout._currentFrame=a,l._lastFrameAt=Date.now(),l._timeToNext=t.frameOpts.duration,J.transition(e,t.frame.data,t.frame.layout,de.coerceTraceIndices(e,t.frame.traces),t.frameOpts,t.transitionOpts).then(function(){t.onComplete&&t.onComplete()}),e.emit("plotly_animatingframe",{name:a,frame:t.frame,animation:{frame:t.frameOpts,transition:t.transitionOpts}})}else g()}function m(){e.emit("plotly_animating"),l._lastFrameAt=-Infinity,l._timeToNext=0,l._runningTransitions=0,l._currentFrame=null;var t=function(){l._animationRaf=window.requestAnimationFrame(t),Date.now()-l._lastFrameAt>l._timeToNext&&h()};t()}function y(e){return e.transitionOpts=Array.isArray(s)?f>=s.length?s[f]:s[0]:s,f++,e}var f=0,x=[],b=void 0===t||null===t,_=Array.isArray(t),v=!b&&!_&&Y.isPlainObject(t),w,k;if(v)x.push({type:"object",data:y(Y.extendFlat({},t))});else if(b||-1!==["string","number"].indexOf(typeof t))for(w=0;w<l._frames.length;w++)k=l._frames[w],k&&(b||k.group+""===t+"")&&x.push({type:"byname",name:k.name+"",data:y({name:k.name})});else if(_)for(w=0;w<t.length;w++){var T=t[w];-1===["number","string"].indexOf(typeof T)?Y.isPlainObject(T)&&x.push({type:"object",data:y(Y.extendFlat({},T))}):(T+="",x.push({type:"byname",name:T,data:y({name:T})}))}for(w=0;w<x.length;w++)if(k=x[w],"byname"===k.type&&!l._frameHash[k.data.name])return Y.warn("animate failure: frame not found: \""+k.data.name+"\""),void c();-1!==["next","immediate"].indexOf(a.mode)&&p(),"reverse"===a.direction&&x.reverse();var A=e._fullLayout._currentFrame;if(A&&a.fromcurrent){var S=-1;for(w=0;w<x.length;w++)if(k=x[w],"byname"===k.type&&k.name===A){S=w;break}if(0<S&&S<x.length-1){var C=[];for(w=0;w<x.length;w++)k=x[w],("byname"!==x[w].type||w>S)&&C.push(k);x=C}}0<x.length?u(x):(e.emit("plotly_animated"),d())})},a.addFrames=function(e,t,a){if(e=Y.getGraphDiv(e),null===t||void 0===t)return Promise.resolve();if(!Y.isPlotDiv(e))throw new Error("This element is not a Plotly plot: "+e+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plot.ly/javascript/animations/");var o=e._transitionData._frames,r=e._transitionData._frameHash,n,l,s,d;if(!Array.isArray(t))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+t);var c=o.length+2*t.length,p=[],u={};for(n=t.length-1;0<=n;n--)if(Y.isPlainObject(t[n])){var g=t[n].name,h=(r[g]||u[g]||{}).name,m=t[n].name,y=r[h]||u[h];h&&m&&"number"==typeof m&&y&&ge<he&&(ge++,Y.warn("addFrames: overwriting frame \""+(r[h]||u[h]).name+"\" with a frame whose name of type \"number\" also equates to \""+h+"\". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings."),ge===he&&Y.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),u[g]={name:g},p.push({frame:J.supplyFrameDefaults(t[n]),index:a&&void 0!==a[n]&&null!==a[n]?a[n]:c+n})}p.sort(function(e,t){return e.index>t.index?-1:e.index<t.index?1:0});var f=[],x=[],b=o.length;for(n=p.length-1;0<=n;n--){if(l=p[n].frame,"number"==typeof l.name&&Y.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!l.name)for(;r[l.name="frame "+e._transitionData._counter++];);if(r[l.name]){for(s=0;s<o.length&&(o[s]||{}).name!==l.name;s++);f.push({type:"replace",index:s,value:l}),x.unshift({type:"replace",index:s,value:o[s]})}else d=va(0,ie(p[n].index,b)),f.push({type:"insert",index:d,value:l}),x.unshift({type:"delete",index:d}),b++}var _=J.modifyFrames,v=J.modifyFrames,w=[e,x],k=[e,f];return X&&X.add(e,_,w,v,k),J.modifyFrames(e,f)},a.deleteFrames=function(e,t){if(e=Y.getGraphDiv(e),!Y.isPlotDiv(e))throw new Error("This element is not a Plotly plot: "+e);var a=e._transitionData._frames,o=[],r=[],n,l;if(!t)for(t=[],n=0;n<a.length;n++)t.push(n);for(t=t.slice(0),t.sort(),n=t.length-1;0<=n;n--)l=t[n],o.push({type:"delete",index:l}),r.unshift({type:"insert",index:l,value:a[l]});var s=J.modifyFrames,d=J.modifyFrames,c=[e,r],p=[e,o];return X&&X.add(e,s,c,d,p),J.modifyFrames(e,o)},a.purge=function(e){e=Y.getGraphDiv(e);var t=e._fullLayout||{},a=e._fullData||[];return J.cleanPlot([],{},a,t),J.purge(e),W.purge(e),t._container&&t._container.remove(),delete e._context,e}},{"../components/color":569,"../components/colorbar/connect":571,"../components/drawing":590,"../constants/xmlns_namespaces":670,"../lib":692,"../lib/events":681,"../lib/queue":707,"../lib/svg_text_utils":716,"../plots/cartesian/axes":740,"../plots/cartesian/constants":746,"../plots/cartesian/graph_interact":750,"../plots/plots":804,"../plots/polar/legacy":812,"../registry":823,"./edit_types":723,"./helpers":724,"./manage_arrays":726,"./plot_config":728,"./plot_schema":729,"./subroutines":731,d3:148,"fast-isnumeric":214,"has-hover":393}],728:[function(e,t){"use strict";t.exports={staticPlot:!1,plotlyServerURL:"https://plot.ly",editable:!1,edits:{annotationPosition:!1,annotationTail:!1,annotationText:!1,axisTitleText:!1,colorbarPosition:!1,colorbarTitleText:!1,legendPosition:!1,legendText:!1,shapePosition:!1,titleText:!1},autosizable:!1,responsive:!1,queueLength:0,fillFrame:!1,frameMargins:0,scrollZoom:!1,doubleClick:"reset+autosize",showTips:!0,showAxisDragHandles:!0,showAxisRangeEntryBoxes:!0,showLink:!1,sendData:!0,showSendToCloud:!1,linkText:"Edit chart",showSources:!1,displayModeBar:"hover",modeBarButtonsToRemove:[],modeBarButtonsToAdd:[],modeBarButtons:!1,toImageButtonOptions:{},displaylogo:!0,watermark:!1,plotGlPixelRatio:2,setBackground:"transparent",topojsonURL:"https://cdn.plot.ly/",mapboxAccessToken:null,logging:1,globalTransforms:[],locale:"en-US",locales:{}}},{}],729:[function(e,t,a){"use strict";function o(e,t){var a=e._basePlotModules,o,r,n,l;if(a){var s;for(o=0;o<a.length;o++){if(n=a[o],n.attrRegex&&n.attrRegex.test(t)){if(n.layoutAttrOverrides)return n.layoutAttrOverrides;!s&&n.layoutAttributes&&(s=n.layoutAttributes)}var d=n.baseLayoutAttrOverrides;if(d&&t in d)return d[t]}if(s)return s}var c=e._modules;if(c)for(o=0;o<c.length;o++)if(l=c[o].layoutAttributes,l&&t in l)return l[t];for(r in x.componentsRegistry)if(n=x.componentsRegistry[r],!n.schema&&t===n.name)return n.layoutAttributes;return t in v?v[t]:"radialaxis"===t||"angularaxis"===t?A[t]:A.layout[t]||!1}function r(e,t,a){if(!e)return!1;if(e._isLinkedToArray)if(n(t[a]))a++;else if(a<t.length)return!1;for(;a<t.length;a++){var o=e[t[a]];if(E(o))e=o;else break;if(a===t.length-1)break;if(e._isLinkedToArray){if(a++,!n(t[a]))return!1;}else if("info_array"===e.valType){a++;var r=t[a];if(!n(r))return!1;var l=e.items;if(Array.isArray(l)){if(r>=l.length)return!1;if(2===e.dimensions){if(a++,t.length===a)return e;var s=t[a];if(!n(s))return!1;e=l[r][s]}else e=l[r]}else e=l}}return e}function n(e){return e===R(e)&&0<=e}function l(e){var t,o;"area"===e?(t={attributes:T},o={}):(t=x.modules[e]._module,o=t.basePlotModule);var r={type:null},i=L({},_),n=L({},t.attributes);a.crawl(n,function(e,t,a,o,r){b.nestedProperty(i,r).set(void 0),e===void 0&&b.nestedProperty(n,r).set(void 0)}),L(r,i),L(r,n),o.attributes&&L(r,o.attributes),r.type=e;var l={meta:t.meta||{},attributes:p(r)};if(t.layoutAttributes){var s={};L(s,t.layoutAttributes),l.layoutAttributes=p(s)}return l}function s(){var e={},t,a;for(t in L(e,v),x.subplotsRegistry)if(a=x.subplotsRegistry[t],a.layoutAttributes)if(Array.isArray(a.attr))for(var o=0;o<a.attr.length;o++)y(e,a,a.attr[o]);else{var r="subplot"===a.attr?a.name:a.attr;y(e,a,r)}for(t in e=m(e),x.componentsRegistry){a=x.componentsRegistry[t];var n=a.schema;if(n&&(n.subplots||n.layout)){var l=n.subplots;if(l&&l.xaxis&&!l.yaxis)for(var s in l.xaxis)delete e.yaxis[s]}else a.layoutAttributes&&f(e,a.layoutAttributes,a.name)}return{layoutAttributes:p(e)}}function d(e){var t=x.transformsRegistry[e],a=L({},t.attributes);return Object.keys(x.componentsRegistry).forEach(function(t){var o=x.componentsRegistry[t];o.schema&&o.schema.transforms&&o.schema.transforms[e]&&Object.keys(o.schema.transforms[e]).forEach(function(t){f(a,o.schema.transforms[e][t],t)})}),{attributes:p(a)}}function c(){var e={frames:b.extendDeepAll({},w)};return p(e),e.frames}function p(e){return u(e),g(e),h(e),e}function u(e){function t(){return{valType:"string",editType:"none"}}a.crawl(e,function(e,o,r){a.isValObject(e)?"data_array"===e.valType?(e.role="data",r[o+"src"]=t(o)):!0===e.arrayOk&&(r[o+"src"]=t(o)):E(e)&&(e.role="object")})}function g(e){a.crawl(e,function(e,t,a){if(e){var o=e._isLinkedToArray;o&&(delete e._isLinkedToArray,a[t]={items:{}},a[t].items[o]=e,a[t].role="object")}})}function h(e){function t(e){for(var a in e)if(E(e[a]))t(e[a]);else if(Array.isArray(e[a]))for(var o=0;o<e[a].length;o++)t(e[a][o]);else e[a]instanceof RegExp&&(e[a]=e[a].toString())}t(e)}function m(e){return C(e,{radialaxis:A.radialaxis,angularaxis:A.angularaxis}),C(e,A.layout),e}function y(e,t,a){var o=b.nestedProperty(e,a),r=L({},t.layoutAttributes);r._isSubplotObj=!0,o.set(r)}function f(e,t,a){var o=b.nestedProperty(e,a);o.set(L(o.get()||{},t))}var x=e("../registry"),b=e("../lib"),_=e("../plots/attributes"),v=e("../plots/layout_attributes"),w=e("../plots/frame_attributes"),k=e("../plots/animation_attributes"),T=e("../plots/polar/legacy/area_attributes"),A=e("../plots/polar/legacy/axis_attributes"),S=e("./edit_types"),C=b.extendFlat,L=b.extendDeepAll,E=b.isPlainObject,z="_isSubplotObj",I="_isLinkedToArray",D="_deprecated",P=[z,I,"_arrayAttrRegexps",D];a.IS_SUBPLOT_OBJ=z,a.IS_LINKED_TO_ARRAY=I,a.DEPRECATED=D,a.UNDERSCORE_ATTRS=P,a.get=function(){var e={};x.allTypes.concat("area").forEach(function(t){e[t]=l(t)});var t={};return Object.keys(x.transformsRegistry).forEach(function(e){t[e]=d(e)}),{defs:{valObjects:b.valObjectMeta,metaKeys:P.concat(["description","role","editType","impliedEdits"]),editType:{traces:S.traces,layout:S.layout},impliedEdits:{}},traces:e,layout:s(),transforms:t,frames:c(),animation:p(k)}},a.crawl=function(e,t,o,r){var i=o||0;r=r||"",Object.keys(e).forEach(function(o){var n=e[o];if(-1===P.indexOf(o)){var l=(r?r+".":"")+o;t(n,o,e,i,l),a.isValObject(n)||E(n)&&"impliedEdits"!==o&&a.crawl(n,t,i+1,l)}})},a.isValObject=function(e){return e&&e.valType!==void 0},a.findArrayAttributes=function(e){function t(e,t,a,r){n=n.slice(0,r).concat([t]),l=l.slice(0,r).concat([e&&e._isLinkedToArray]);var i=e&&("data_array"===e.valType||!0===e.arrayOk)&&("colorbar"!==n[r-1]||"ticktext"!==t&&"tickvals"!==t);i&&o(s,0,"")}function o(e,t,a){var i=e[n[t]],s=a+n[t];if(t===n.length-1)b.isArrayOrTypedArray(i)&&r.push(d+s);else if(!l[t])b.isPlainObject(i)&&o(i,t+1,s+".");else if(Array.isArray(i))for(var c=0;c<i.length;c++)b.isPlainObject(i[c])&&o(i[c],t+1,s+"["+c+"].")}var r=[],n=[],l=[],s,d;s=e,d="",a.crawl(_,t),e._module&&e._module.attributes&&a.crawl(e._module.attributes,t);var c=e.transforms;if(c)for(var p=0;p<c.length;p++){var u=c[p],g=u._module;g&&(d="transforms["+p+"].",s=u,a.crawl(g.attributes,t))}return r},a.getTraceValObject=function(e,t){var a=t[0],o=1,l,s;if("transforms"===a){if(1===t.length)return _.transforms;var d=e.transforms;if(!Array.isArray(d)||!d.length)return!1;var c=t[1];if(!n(c)||c>=d.length)return!1;l=(x.transformsRegistry[d[c].type]||{}).attributes,s=l&&l[t[2]],o=3}else if("area"===e.type)s=T[a];else{var p=e._module;if(p||(p=(x.modules[e.type||_.type.dflt]||{})._module),!p)return!1;if(l=p.attributes,s=l&&l[a],!s){var u=p.basePlotModule;u&&u.attributes&&(s=u.attributes[a])}s||(s=_[a])}return r(s,t,o)},a.getLayoutValObject=function(e,t){var a=o(e,t[0]);return r(a,t,1)}},{"../lib":692,"../plots/animation_attributes":735,"../plots/attributes":737,"../plots/frame_attributes":768,"../plots/layout_attributes":795,"../plots/polar/legacy/area_attributes":810,"../plots/polar/legacy/axis_attributes":811,"../registry":823,"./edit_types":723}],730:[function(e,t,a){"use strict";function o(e){return e&&"string"==typeof e}function r(e){var t=e.length-1;return"s"!==e.charAt(t)&&i.warn("bad argument to arrayDefaultKey: "+e),e.substr(0,e.length-1)+"defaults"}var i=e("../lib"),n=e("../plots/attributes"),l="templateitemname",s={name:{valType:"string",editType:"none"}};s[l]={valType:"string",editType:"calc"},a.templatedArray=function(e,t){return t._isLinkedToArray=e,t.name=s.name,t[l]=s[l],t},a.traceTemplater=function(e){function t(t){o=i.coerce(t,{},n,"type");var l={type:o,_template:null};if(o in a){r=e[o];var s=a[o]%r.length;a[o]++,l._template=r[s]}else;return l}var a={},o,r;for(o in e)r=e[o],Array.isArray(r)&&r.length&&(a[o]=0);return{newTrace:t}},a.newContainer=function(e,t,a){var o=e._template,r=o&&(o[t]||a&&o[a]);i.isPlainObject(r)||(r=null);var n=e[t]={_template:r};return n},a.arrayTemplater=function(e,t,a){function i(e){var t={name:e.name,_input:e},r=t[l]=e[l];if(!o(r))return t._template=d,t;for(var n=0,s;n<c.length;n++)if(s=c[n],s.name===r)return p[r]=1,t._template=s,t;return t[a]=e[a]||!1,t._template=!1,t}function n(){for(var e=[],t=0;t<c.length;t++){var a=c[t],r=a.name;if(o(r)&&!p[r]){var n={_template:a,name:r,_input:{_templateitemname:r}};n[l]=a[l],e.push(n),p[r]=1}}return e}var s=e._template,d=s&&s[r(t)],c=s&&s[t];Array.isArray(c)&&c.length||(c=[]);var p={};return{newItem:i,defaultItems:n}},a.arrayDefaultKey=r,a.arrayEditor=function(e,t,a){function o(){g={},p&&(g[u]={},g[u][l]=p)}function r(e,t){g[e]=t}function n(e,t){p?i.nestedProperty(g[u],e).set(t):g[u+"."+e]=t}function s(){var e=g;return o(),e}var d=(i.nestedProperty(e,t).get()||[]).length,c=a._index,p=c>=d&&(a._input||{})._templateitemname;p&&(c=d);var u=t+"["+c+"]",g;return o(),{modifyBase:r,modifyItem:n,getUpdateObj:s,applyUpdate:function(t,a){t&&n(t,a);var o=s();for(var r in o)i.nestedProperty(e,r).set(o[r])}}}},{"../lib":692,"../plots/attributes":737}],731:[function(e,t,a){"use strict";function o(e,t,a){for(var o=0;o<a.length;o++){var r=a[o][0],n=a[o][1];if(!(r[0]>=e[1]||r[1]<=e[0])&&n[0]<t[1]&&n[1]>t[0])return!0}return!1}function r(e){function t(e,t,a){var o=e._lw/2;return"x"===e._id.charAt(0)?t?"top"===a?t._offset-h-o:t._offset+t._length+h+o:g.t+g.h*(1-(e.position||0))+o%1:t?"right"===a?t._offset+t._length+h+o:t._offset-h-o:g.l+g.w*(e.position||0)+o%1}function r(e){return"M"+H+","+e+"H"+G}function n(e){return"M"+S._offset+","+e+"h"+S._length}function s(e){return"M"+e+","+$+"V"+Z}function d(e){return"M"+e+","+C._offset+"v"+C._length}function c(e,t,a){if(!e.showline||k!==e._mainSubplot)return"";if(!e._anchorAxis)return a(e._mainLinePosition);var o=t(e._mainLinePosition);return e.mirror&&(o+=t(e._mainMirrorPosition)),o}var p=e._fullLayout,g=p._size,h=g.p,y=v.list(e,"",!0),b,k,T,A,S,C;if(p._paperdiv.style({width:e._context.responsive&&p.autosize&&!e._context._hasZeroWidth&&!e.layout.width?"100%":p.width+"px",height:e._context.responsive&&p.autosize&&!e._context._hasZeroHeight&&!e.layout.height?"100%":p.height+"px"}).selectAll(".main-svg").call(x.setSize,p.width,p.height),e._context.setBackground(e,p.paper_bgcolor),a.drawMainTitle(e),_.manage(e),!p._has("cartesian"))return e._promises.length&&Promise.all(e._promises);for(b=0;b<y.length;b++){A=y[b];var L=A._anchorAxis;A._linepositions={},A._lw=x.crispRound(e,A.linewidth,1),A._mainLinePosition=t(A,L,A.side),A._mainMirrorPosition=A.mirror&&L?t(A,L,w.OPPOSITE_SIDE[A.side]):null}var E=[],z=[],I=[],D=1===f.opacity(p.paper_bgcolor)&&1===f.opacity(p.plot_bgcolor)&&p.paper_bgcolor===p.plot_bgcolor;for(k in p._plots)if(T=p._plots[k],T.mainplot)T.bg&&T.bg.remove(),T.bg=void 0;else{var P=T.xaxis.domain,O=T.yaxis.domain,R=T.plotgroup;if(o(P,O,I)){var M=R.node(),j=T.bg=m.ensureSingle(R,"rect","bg");M.insertBefore(j.node(),M.childNodes[0]),z.push(k)}else R.select("rect.bg").remove(),I.push([P,O]),D||(E.push(k),z.push(k))}var B=p._bgLayer.selectAll(".bg").data(E);for(B.enter().append("rect").classed("bg",!0),B.exit().remove(),B.each(function(e){p._plots[e].bg=u.select(this)}),b=0;b<z.length;b++)T=p._plots[z[b]],S=T.xaxis,C=T.yaxis,T.bg&&T.bg.call(x.setRect,S._offset-h,C._offset-h,S._length+2*h,C._length+2*h).call(f.fill,p.plot_bgcolor).style("stroke-width",0);if(!p._hasOnlyLargeSploms)for(k in p._plots){T=p._plots[k],S=T.xaxis,C=T.yaxis;var F=T.clipId="clip"+p._uid+k+"plot",N=m.ensureSingleById(p._clips,"clipPath",F,function(e){e.classed("plotclip",!0).append("rect")});T.clipRect=N.select("rect").attr({width:S._length,height:C._length}),x.setTranslate(T.plot,S._offset,C._offset);var V,U;T._hasClipOnAxisFalse?(V=null,U=F):(V=F,U=null),x.setClipUrl(T.plot,V,e),T.layerClipId=U}var H,G,Y,q,W,X,Z,$,J,K,Q,ee,te;for(k in p._plots){T=p._plots[k],S=T.xaxis,C=T.yaxis;var ae="M0,0";i(S,k)&&(W=l(S,"left",C,y),H=S._offset-(W?h+W:0),X=l(S,"right",C,y),G=S._offset+S._length+(X?h+X:0),Y=t(S,C,"bottom"),q=t(S,C,"top"),te=!S._anchorAxis||k!==S._mainSubplot,te&&("allticks"===S.mirror||"all"===S.mirror)&&(S._linepositions[k]=[Y,q]),ae=c(S,r,n),te&&S.showline&&("all"===S.mirror||"allticks"===S.mirror)&&(ae+=r(Y)+r(q)),T.xlines.style("stroke-width",S._lw+"px").call(f.stroke,S.showline?S.linecolor:"rgba(0,0,0,0)")),T.xlines.attr("d",ae);var oe="M0,0";i(C,k)&&(Q=l(C,"bottom",S,y),Z=C._offset+C._length+(Q?h:0),ee=l(C,"top",S,y),$=C._offset-(ee?h:0),J=t(C,S,"left"),K=t(C,S,"right"),te=!C._anchorAxis||k!==C._mainSubplot,te&&("allticks"===C.mirror||"all"===C.mirror)&&(C._linepositions[k]=[J,K]),oe=c(C,s,d),te&&C.showline&&("all"===C.mirror||"allticks"===C.mirror)&&(oe+=s(J)+s(K)),T.ylines.style("stroke-width",C._lw+"px").call(f.stroke,C.showline?C.linecolor:"rgba(0,0,0,0)")),T.ylines.attr("d",oe)}return v.makeClipPaths(e),e._promises.length&&Promise.all(e._promises)}function i(e,t){return(e.ticks||e.showline)&&(t===e._mainSubplot||"all"===e.mirror||"allticks"===e.mirror)}function n(e,t,a){if(!a.showline||!a._lw)return!1;if("all"===a.mirror||"allticks"===a.mirror)return!0;var o=a._anchorAxis;if(!o)return!1;var r=w.FROM_BL[t];return a.side===t?o.domain[r]===e.domain[r]:a.mirror&&o.domain[1-r]===e.domain[1-r]}function l(e,t,a,o){if(n(e,t,a))return a._lw;for(var r=0,l;r<o.length;r++)if(l=o[r],l._mainAxis===a._mainAxis&&n(e,t,l))return l._lw;return 0}function s(e,t){var a=e.title,o=e._size,r=0;switch("start"===t?r=a.pad.l:"end"===t&&(r=-a.pad.r),a.xref){case"paper":return o.l+o.w*a.x+r;case"container":default:return e.width*a.x+r;}}function d(e,t){var a=e.title,o=e._size,r=0;if("0em"!==t&&t?t===w.CAP_SHIFT+"em"&&(r=a.pad.t):r=-a.pad.b,"auto"===a.y)return o.t/2;switch(a.yref){case"paper":return o.t+o.h-o.h*a.y+r;case"container":default:return e.height-e.height*a.y+r;}}function c(e){var t=e.title,a="middle";return m.isRightAnchor(t)?a="end":m.isLeftAnchor(t)&&(a="start"),a}function p(e){var t=e.title,a="0em";return m.isTopAnchor(t)?a=w.CAP_SHIFT+"em":m.isMiddleAnchor(t)&&(a=w.MID_SHIFT+"em"),a}var u=e("d3"),g=e("../registry"),h=e("../plots/plots"),m=e("../lib"),y=e("../lib/clear_gl_canvases"),f=e("../components/color"),x=e("../components/drawing"),b=e("../components/titles"),_=e("../components/modebar"),v=e("../plots/cartesian/axes"),w=e("../constants/alignment"),k=e("../plots/cartesian/constraints"),T=k.enforce,A=k.clean,S=e("../plots/cartesian/autorange").doAutoRange;a.layoutStyles=function(e){return m.syncOrAsync([h.doAutoMargin,r],e)},a.drawMainTitle=function(e){var t=e._fullLayout,a=c(t),o=p(t);b.draw(e,"gtitle",{propContainer:t,propName:"title.text",placeholder:t._dfltTitle.plot,attributes:{x:s(t,a),y:d(t,o),"text-anchor":a,dy:o}})},a.doTraceStyle=function(e){var t=e.calcdata,o=[],r;for(r=0;r<t.length;r++){var n=t[r],l=n[0]||{},s=l.trace||{},d=s._module||{},c=d.arraysToCalcdata;c&&c(n,s);var p=d.editStyle;p&&o.push({fn:p,cd0:l})}if(o.length){for(r=0;r<o.length;r++){var u=o[r];u.fn(e,u.cd0)}y(e),a.redrawReglTraces(e)}return h.style(e),g.getComponentMethod("legend","draw")(e),h.previousPromises(e)},a.doColorBars=function(e){for(var t=0,a;t<e.calcdata.length;t++)if(a=e.calcdata[t][0],(a.t||{}).cb){var o=a.trace,r=a.t.cb;g.traceIs(o,"contour")&&r.line({width:!1===o.contours.showlines?0:o.line.width,dash:o.line.dash,color:"line"===o.contours.coloring?r._opts.line.color:o.line.color});var n=o._module.colorbar,l=n.container,s=(l?o[l]:o).colorbar;r.options(s)()}return h.previousPromises(e)},a.layoutReplot=function(e){var t=e.layout;return e.layout=void 0,g.call("plot",e,"",t)},a.doLegend=function(e){return g.getComponentMethod("legend","draw")(e),h.previousPromises(e)},a.doTicksRelayout=function(e){return v.draw(e,"redraw"),e._fullLayout._hasOnlyLargeSploms&&(g.subplotsRegistry.splom.updateGrid(e),y(e),a.redrawReglTraces(e)),a.drawMainTitle(e),h.previousPromises(e)},a.doModeBar=function(e){var t=e._fullLayout;_.manage(e);for(var a=0,o;a<t._basePlotModules.length;a++)o=t._basePlotModules[a].updateFx,o&&o(e);return h.previousPromises(e)},a.doCamera=function(e){for(var t=e._fullLayout,a=t._subplots.gl3d,o=0;o<a.length;o++){var r=t[a[o]],n=r._scene;n.setCamera(r.camera)}},a.drawData=function(e){var t=e._fullLayout,o=e.calcdata,r;for(r=0;r<o.length;r++){var n=o[r][0].trace;!0===n.visible&&n._module.colorbar||t._infolayer.select(".cb"+n.uid).remove()}y(e);var l=t._basePlotModules;for(r=0;r<l.length;r++)l[r].plot(e);return a.redrawReglTraces(e),h.style(e),g.getComponentMethod("shapes","draw")(e),g.getComponentMethod("annotations","draw")(e),t._replotting=!1,h.previousPromises(e)},a.redrawReglTraces=function(e){var t=e._fullLayout;if(t._has("regl")){var a=e._fullData,o=[],r=[],n,l;for(t._hasOnlyLargeSploms&&t._splomGrid.draw(),n=0;n<a.length;n++){var s=a[n];!0===s.visible&&("splom"===s.type?t._splomScenes[s.uid].draw():"scattergl"===s.type?m.pushUnique(o,s.xaxis+s.yaxis):"scatterpolargl"===s.type&&m.pushUnique(r,s.subplot))}for(n=0;n<o.length;n++)l=t._plots[o[n]],l._scene&&l._scene.draw();for(n=0;n<r.length;n++)l=t[r[n]]._subplot,l._scene&&l._scene.draw()}},a.doAutoRangeAndConstraints=function(e){for(var t=v.list(e,"",!0),a=0,o;a<t.length;a++)o=t[a],A(e,o),o.setScale(),S(e,o);T(e)},a.finalDraw=function(e){g.getComponentMethod("shapes","draw")(e),g.getComponentMethod("images","draw")(e),g.getComponentMethod("annotations","draw")(e),g.getComponentMethod("rangeslider","draw")(e),g.getComponentMethod("rangeselector","draw")(e)},a.drawMarginPushers=function(e){g.getComponentMethod("legend","draw")(e),g.getComponentMethod("rangeselector","draw")(e),g.getComponentMethod("sliders","draw")(e),g.getComponentMethod("updatemenus","draw")(e)}},{"../components/color":569,"../components/drawing":590,"../components/modebar":628,"../components/titles":657,"../constants/alignment":664,"../lib":692,"../lib/clear_gl_canvases":677,"../plots/cartesian/autorange":739,"../plots/cartesian/axes":740,"../plots/cartesian/constraints":748,"../plots/plots":804,"../registry":823,d3:148}],732:[function(e,t,a){"use strict";function o(e,t){function a(t,a,r){if(g(a)&&g(t))o(t,a);else if(Array.isArray(a)&&Array.isArray(t)){var i=f.arrayTemplater({_template:e},r);for(s=0;s<a.length;s++){var n=a[s],l=i.newItem(n)._template;l&&o(l,n)}var d=i.defaultItems();for(s=0;s<d.length;s++)a.push(d[s]._template);for(s=0;s<a.length;s++)delete a[s].templateitemname}}e=u.extendDeep({},e);var n=Object.keys(e).sort(),l,s;for(l=0;l<n.length;l++){var d=n[l],c=e[d];if(d in t?a(c,t[d],d):t[d]=c,r(d)===d)for(var p in t){var h=r(p);p===h||h!==d||p in e||a(c,t[p],d)}}}function r(e){return e.replace(/[0-9]+$/,"")}function n(e,t,a,o,l){var s=l&&a(l);for(var c in e){var p=e[c],h=d(e,c,o),m=d(e,c,l),y=a(m);if(!y){var x=r(c);x!==c&&(m=d(e,x,l),y=a(m))}if(!(s&&s===y)){if(!y||y._noTemplating||"data_array"===y.valType||y.arrayOk&&Array.isArray(p))continue;if(!y.valType&&g(p))n(p,t,a,h,m);else if(y._isLinkedToArray&&Array.isArray(p)){for(var b=!1,_=0,v={},w=0,k;w<p.length;w++)if(k=p[w],g(k)){var T=k.name;if(T)v[T]||(n(k,t,a,d(p,_,h),d(p,_,m)),_++,v[T]=1);else if(!b){var A=f.arrayDefaultKey(c),S=d(e,A,o),C=d(p,_,h);n(k,t,a,C,d(p,_,m));var L=u.nestedProperty(t,C),E=u.nestedProperty(t,S);E.set(L.get()),L.set(null),b=!0}}}else{var z=u.nestedProperty(t,h);z.set(p)}}}}function l(e,t){return h.getLayoutValObject(e,u.nestedProperty({},t).parts)}function s(e,t){return h.getTraceValObject(e,u.nestedProperty({},t).parts)}function d(e,t,a){var o;return o=a?Array.isArray(e)?a+"["+t+"]":a+"."+t:t,o}function c(e){for(var t=0;t<e.length;t++)if(g(e[t]))return!0}function p(e){var t;switch(e.code){case"data":t="The template has no key data.";break;case"layout":t="The template has no key layout.";break;case"missing":t=e.path?"There are no templates for item "+e.path+" with name "+e.templateitemname:"There are no templates for trace "+e.index+", of type "+e.traceType+".";break;case"unused":t=e.path?"The template item at "+e.path+" was not used in constructing the plot.":e.dataCount?"Some of the templates of type "+e.traceType+" were not used. The template has "+e.templateCount+" traces, the data only has "+e.dataCount+" of this type.":"The template has "+e.templateCount+" traces of type "+e.traceType+" but there are none in the data.";break;case"reused":t="Some of the templates of type "+e.traceType+" were used more than once. The template has "+e.templateCount+" traces, the data has "+e.dataCount+" of this type.";}return e.msg=t,e}var u=e("../lib"),g=u.isPlainObject,h=e("./plot_schema"),m=e("../plots/plots"),y=e("../plots/attributes"),f=e("./plot_template"),x=e("./plot_config");a.makeTemplate=function(e){e=u.extendDeep({_context:x},{data:e.data,layout:e.layout}),m.supplyDefaults(e);var t=e.data||[],a=e.layout||{};a._basePlotModules=e._fullLayout._basePlotModules,a._modules=e._fullLayout._modules;var r={data:{},layout:{}};t.forEach(function(e){var t={};n(e,t,s.bind(null,e));var a=u.coerce(e,{},y,"type"),o=r.data[a];o||(o=r.data[a]=[]),o.push(t)}),n(a,r.layout,l.bind(null,a)),delete r.layout.template;var d=a.template;if(g(d)){var c=d.layout,p,h,f,b,_,v;g(c)&&o(c,r.layout);var w=d.data;if(g(w)){for(h in r.data)if(f=w[h],Array.isArray(f)){for(_=r.data[h],v=_.length,b=f.length,p=0;p<v;p++)o(f[p%b],_[p]);for(p=v;p<b;p++)_.push(u.extendDeep({},f[p]))}for(h in w)h in r.data||(r.data[h]=u.extendDeep([],w[h]))}}return r},a.validateTemplate=function(e,t){function a(e,t){for(var o in e)if("_"!==o.charAt(0)&&g(e[o])){var n=r(o),l=[],s;for(s=0;s<t.length;s++)l.push(d(e,o,t[s])),n!==o&&l.push(d(e,n,t[s]));for(s=0;s<l.length;s++)v[l[s]]=1;a(e[o],l)}}function o(e,t){for(var a in e)if(-1===a.indexOf("defaults")&&g(e[a])){var r=d(e,a,t);v[r]?o(e[a],r):f.push({code:"unused",path:r})}}function n(e,t){for(var a in e)if("_"!==a.charAt(0)){var o=e[a],r=d(e,a,t);g(o)?(Array.isArray(e)&&!1===o._template&&o.templateitemname&&f.push({code:"missing",path:r,templateitemname:o.templateitemname}),n(o,r)):Array.isArray(o)&&c(o)&&n(o,r)}}var l=u.extendDeep({},{_context:x,data:e.data,layout:e.layout}),s=l.layout||{};g(t)||(t=s.template||{});var h=t.layout,y=t.data,f=[];l.layout=s,l.layout.template=t,m.supplyDefaults(l);var b=l._fullLayout,_=l._fullData,v={};if(g(h)?(a(b,["layout"]),o(h,"layout")):f.push({code:"layout"}),!g(y))f.push({code:"data"});else{for(var w={},k=0,T,A;k<_.length;k++)A=_[k],T=A.type,w[T]=(w[T]||0)+1,A._fullInput._template||f.push({code:"missing",index:A._fullInput.index,traceType:T});for(T in y){var S=y[T].length,C=w[T]||0;S>C?f.push({code:"unused",traceType:T,templateCount:S,dataCount:C}):C>S&&f.push({code:"reused",traceType:T,templateCount:S,dataCount:C})}}return(n({data:_,layout:b},""),f.length)?f.map(p):void 0}},{"../lib":692,"../plots/attributes":737,"../plots/plots":804,"./plot_config":728,"./plot_schema":729,"./plot_template":730}],733:[function(e,t){"use strict";var a=e("./plot_api"),o=e("../lib"),r=e("../snapshot/helpers"),i=e("../snapshot/tosvg"),n=e("../snapshot/svgtoimg"),l={format:{valType:"enumerated",values:["png","jpeg","webp","svg"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}},s=/^data:image\/\w+;base64,/;t.exports=function(e,t){function d(e){return!(e in t)||o.validate(t[e],l[e])}function c(e,a){return o.coerce(t,f,l,e,a)}function p(){return new Promise(function(e){setTimeout(e,r.getDelay(T._fullLayout))})}function u(){return new Promise(function(e,t){var r=i(T,x,v),l=T._fullLayout.width,s=T._fullLayout.height;if(a.purge(T),document.body.removeChild(T),"svg"===x)return k?e(r):e("data:image/svg+xml,"+encodeURIComponent(r));var d=document.createElement("canvas");d.id=o.randstr(),n({format:x,width:l,height:s,scale:v,canvas:d,svg:r,promise:!0}).then(e).catch(t)})}function g(e){return k?e.replace(s,""):e}t=t||{};var h,m,y;if(o.isPlainObject(e)?(h=e.data||[],m=e.layout||{},y=e.config||{}):(e=o.getGraphDiv(e),h=o.extendDeep([],e.data),m=o.extendDeep({},e.layout),y=e._context),!d("width")||!d("height"))throw new Error("Height and width should be pixel values.");if(!d("format"))throw new Error("Image format is not jpeg, png, svg or webp.");var f={},x=c("format"),b=c("width"),_=c("height"),v=c("scale"),w=c("setBackground"),k=c("imageDataOnly"),T=document.createElement("div");T.style.position="absolute",T.style.left="-5000px",document.body.appendChild(T);var A=o.extendFlat({},m);b&&(A.width=b),_&&(A.height=_);var S=o.extendFlat({},y,{_exportedPlot:!0,staticPlot:!0,setBackground:w}),C=r.getRedrawFunc(T);return new Promise(function(e,t){a.plot(T,h,A,S).then(C).then(p).then(u).then(function(t){e(g(t))}).catch(function(e){t(e)})})}},{"../lib":692,"../snapshot/helpers":827,"../snapshot/svgtoimg":829,"../snapshot/tosvg":831,"./plot_api":727}],734:[function(e,t){"use strict";function a(e,t,o,r,c,g){g=g||[];for(var h=Object.keys(e),b=0,_;b<h.length;b++)if(_=h[b],"transforms"!==_){var v=g.slice();v.push(_);var p=e[_],w=t[_],T=d(o,_),A="info_array"===(T||{}).valType,S="colorscale"===(T||{}).valType,C=(T||{}).items;if(!s(o,_))r.push(l("schema",c,v));else if(y(p)&&y(w))a(p,w,T,r,c,v);else if(A&&f(p)){p.length>w.length&&r.push(l("unused",c,v.concat(w.length)));var L=w.length,E=Array.isArray(C);E&&(L=ie(L,C.length));var z,I,D,P,O;if(2===T.dimensions){for(I=0;I<L;I++)if(f(p[I])){p[I].length>w[I].length&&r.push(l("unused",c,v.concat(I,w[I].length)));var R=w[I].length;for(z=0;z<(E?ie(R,C[I].length):R);z++)D=E?C[I][z]:C,P=p[I][z],O=w[I][z],u.validate(P,D)?O!==P&&O!==+P&&r.push(l("dynamic",c,v.concat(I,z),P,O)):r.push(l("value",c,v.concat(I,z),P))}else r.push(l("array",c,v.concat(I),p[I]));}else for(I=0;I<L;I++)D=E?C[I]:C,P=p[I],O=w[I],u.validate(P,D)?O!==P&&O!==+P&&r.push(l("dynamic",c,v.concat(I),P,O)):r.push(l("value",c,v.concat(I),P))}else if(T.items&&!A&&f(p)){var M=C[Object.keys(C)[0]],B=[],F,N;for(F=0;F<w.length;F++){var V=w[F]._index||F;if(N=v.slice(),N.push(V),y(p[V])&&y(w[F])){B.push(V);var U=p[V],H=w[F];y(U)&&!1!==U.visible&&!1===H.visible?r.push(l("invisible",c,N)):a(U,H,M,r,c,N)}}for(F=0;F<p.length;F++)N=v.slice(),N.push(F),y(p[F])?-1===B.indexOf(F)&&r.push(l("unused",c,N)):r.push(l("object",c,N,p[F]))}else!y(p)&&y(w)?r.push(l("object",c,v,p)):x(p)||!x(w)||A||S?_ in t?u.validate(p,T)?"enumerated"===T.valType&&(T.coerceNumber&&p!==+w||p!==w)&&r.push(l("dynamic",c,v,p,w)):r.push(l("value",c,v,p)):r.push(l("unused",c,v,p)):r.push(l("array",c,v,p))}return r}function o(e,t){for(var a=e.layout.layoutAttributes,o=0;o<t.length;o++){var r=t[o],n=e.traces[r.type],l=n.layoutAttributes;l&&(r.subplot?u.extendFlat(a[n.attributes.subplot.dflt],l):u.extendFlat(a,l))}return a}function r(e){return f(e)?"In data trace "+e[1]+", ":"In "+e+", "}function l(e,t,a,o,r){a=a||"";var i,n;f(t)?(i=t[0],n=t[1]):(i=t,n=null);var l=p(a),s=b[e](t,l,o,r);return u.log(s),{code:e,container:i,trace:n,path:a,astr:l,msg:s}}function s(e,t){var a=c(t),o=a.keyMinusId,r=a.id;return!!(o in e&&e[o]._isSubplotObj&&r)||t in e}function d(e,t){if(t in e)return e[t];var a=c(t);return e[a.keyMinusId]}function c(e){var t=e.match(_);return{keyMinusId:t&&t[1],id:t&&t[2]}}function p(e){if(!f(e))return e+"";for(var t="",a=0,o;a<e.length;a++)o=e[a],"number"==typeof o?t=t.substr(0,t.length-1)+"["+o+"]":t+=o,a<e.length-1&&(t+=".");return t}var u=e("../lib"),g=e("../plots/plots"),h=e("./plot_schema"),m=e("./plot_config"),y=u.isPlainObject,f=Array.isArray,x=u.isArrayOrTypedArray;t.exports=function(e,t){var r=h.get(),n=[],s={_context:u.extendFlat({},m)},d,c;f(e)?(s.data=u.extendDeep([],e),d=e):(s.data=[],d=[],n.push(l("array","data"))),y(t)?(s.layout=u.extendDeep({},t),c=t):(s.layout={},c={},1<arguments.length&&n.push(l("object","layout"))),g.supplyDefaults(s);for(var p=s._fullData,x=d.length,b=0;b<x;b++){var _=d[b],v=["data",b];if(!y(_)){n.push(l("object",v));continue}var w=p[b],k=w.type,T=r.traces[k].attributes;T.type={valType:"enumerated",values:[k]},!1===w.visible&&!1!==_.visible&&n.push(l("invisible",v)),a(_,w,T,n,v);var A=_.transforms,S=w.transforms;if(A){f(A)||n.push(l("array",v,["transforms"])),v.push("transforms");for(var C=0;C<A.length;C++){var L=["transforms",C],E=A[C].type;if(!y(A[C])){n.push(l("object",v,L));continue}var z=r.transforms[E]?r.transforms[E].attributes:{};z.type={valType:"enumerated",values:Object.keys(r.transforms)},a(A[C],S[C],z,n,v,L)}}}var I=s._fullLayout,D=o(r,p);return a(c,I,D,n,"layout"),0===n.length?void 0:n};var b={object:function(e,t){var a;return a="layout"===e&&""===t?"The layout argument":"data"===e[0]&&""===t?"Trace "+e[1]+" in the data argument":r(e)+"key "+t,a+" must be linked to an object container"},array:function(e,t){var a;return a="data"===e?"The data argument":r(e)+"key "+t,a+" must be linked to an array container"},schema:function(e,t){return r(e)+"key "+t+" is not part of the schema"},unused:function(e,t,a){var o=y(a)?"container":"key";return r(e)+o+" "+t+" did not get coerced"},dynamic:function(e,t,a,o){return[r(e)+"key",t,"(set to '"+a+"')","got reset to","'"+o+"'","during defaults."].join(" ")},invisible:function(e,t){return(t?r(e)+"item "+t:"Trace "+e[1])+" got defaulted to be not visible"},value:function(e,t,a){return[r(e)+"key "+t,"is set to an invalid value ("+a+")"].join(" ")}},_=u.counterRegex("([a-z]+)")},{"../lib":692,"../plots/plots":804,"./plot_config":728,"./plot_schema":729}],735:[function(e,t){"use strict";t.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"]}}}},{}],736:[function(e,t){"use strict";var a=e("../lib"),o=e("../plot_api/plot_template");t.exports=function(e,t,r){var n=r.name,l=r.inclusionAttr||"visible",s=t[n],d=a.isArrayOrTypedArray(e[n])?e[n]:[],c=t[n]=[],p=o.arrayTemplater(t,n,l),u,g;for(u=0;u<d.length;u++){var h=d[u];a.isPlainObject(h)?g=p.newItem(h):(g=p.newItem({}),g[l]=!1),g._index=u,!1!==g[l]&&r.handleItemDefaults(h,g,t,r),c.push(g)}var m=p.defaultItems();for(u=0;u<m.length;u++)g=m[u],g._index=c.length,r.handleItemDefaults({},g,t,r,{}),c.push(g);if(a.isArrayOrTypedArray(s)){var y=ie(s.length,c.length);for(u=0;u<y;u++)a.relinkPrivateKeys(c[u],s[u])}return c}},{"../lib":692,"../plot_api/plot_template":730}],737:[function(e,t){"use strict";var a=e("../components/fx/attributes");t.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot"},ids:{valType:"data_array",editType:"calc"},customdata:{valType:"data_array",editType:"calc"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:a.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":599}],738:[function(e,t){"use strict";t.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],739:[function(e,t){"use strict";function a(e,t){function a(e,t){return va(e,l(t))}var n=[],l=o(t),s=r(e,t),d=s.min,c=s.max,p,u;if(0===d.length||0===c.length)return g.simpleMap(t.range,t.r2l);var h=d[0].val,m=c[0].val;for(p=1;p<d.length&&h===m;p++)h=ie(h,d[p].val);for(p=1;p<c.length&&h===m;p++)m=va(m,c[p].val);var y=!1;if(t.range){var f=g.simpleMap(t.range,t.r2l);y=f[1]<f[0]}"reversed"===t.autorange&&(y=!0,t.autorange=!0);var x=t.rangemode,b="tozero"===x,_="nonnegative"===x,v=t._length,w=0,k,T,A,S,C,L;for(p=0;p<d.length;p++)for(k=d[p],u=0;u<c.length;u++)T=c[u],L=T.val-k.val,0<L&&(C=v-l(k)-l(T),C>v/10?L/C>w&&(A=k,S=T,w=L/C):L/v>w&&(A={val:k.val,pad:0},S={val:T.val,pad:0},w=L/v));if(h===m){var E=h-1,z=h+1;if(!b)n=_?[va(0,E),va(1,z)]:[E,z];else if(0===h)n=[0,1];else{var I=(0<h?c:d).reduce(a,0),D=h/(1-ie(.5,I/v));n=0<h?[0,D]:[D,0]}}else b?(0<=A.val&&(A={val:0,pad:0}),0>=S.val&&(S={val:0,pad:0})):_&&(0>A.val-w*l(A)&&(A={val:0,pad:0}),0>=S.val&&(S={val:1,pad:0})),w=(S.val-A.val)/(v-l(A)-l(S)),n=[A.val-w*l(A),S.val+w*l(S)];return y&&n.reverse(),g.simpleMap(n,t.l2r||Number)}function o(e){var t=e._length/20;return"domain"===e.constrain&&e._inputDomain&&(t*=(e._inputDomain[1]-e._inputDomain[0])/(e.domain[1]-e.domain[0])),function(e){return e.pad+(e.extrapad?t:0)}}function r(e,t){function a(e,t){for(u=0;u<t.length;u++){var a=e[t[u]],r=(a._extremes||{})[o];if(!0===a.visible&&r){for(g=0;g<r.min.length;g++)h=r.min[g],n(c,h.val,h.pad,{extrapad:h.extrapad});for(g=0;g<r.max.length;g++)h=r.max[g],l(p,h.val,h.pad,{extrapad:h.extrapad})}}}var o=t._id,r=e._fullData,s=e._fullLayout,c=[],p=[],u,g,h;return a(r,t._traceIndices),a(s.annotations||[],t._annIndices||[]),a(s.shapes||[],t._shapeIndices||[]),{min:c,max:p}}function n(e,t,a,o){s(e,t,a,o,c)}function l(e,t,a,o){s(e,t,a,o,p)}function s(e,t,a,o,r){for(var i=o.tozero,n=o.extrapad,l=!0,s=0,d;s<e.length&&l;s++)if(d=e[s],r(d.val,t)&&d.pad>=a&&(d.extrapad||!n)){l=!1;break}else r(t,d.val)&&d.pad<=a&&(n||!d.extrapad)&&(e.splice(s,1),s--);if(l){var c=i&&0===t;e.push({val:t,pad:c?0:a,extrapad:!c&&n})}}function d(e){return u(e)&&wa(e)<h}function c(e,t){return e<=t}function p(e,t){return e>=t}var u=e("fast-isnumeric"),g=e("../../lib"),h=e("../../constants/numerical").FP_SAFE,m=e("../../registry");t.exports={getAutoRange:a,makePadFn:o,doAutoRange:function(e,t){if(t.autorange){t.range=a(e,t),t._r=t.range.slice(),t._rl=g.simpleMap(t._r,t.r2l);var o=t._input,r={};r[t._attr+".range"]=t.range,r[t._attr+".autorange"]=t.autorange,m.call("_storeDirectGUIEdit",e.layout,e._fullLayout._preGUI,r),o.range=t.range.slice(),o.autorange=t.autorange}var i=t._anchorAxis;if(i&&i.rangeslider){var n=i.rangeslider[t._name];n&&"auto"===n.rangemode&&(n.range=a(e,t)),i._input.rangeslider[t._name]=g.extendFlat({},n)}},findExtremes:function(e,t,a){function o(e){if(Array.isArray(e))return f=!0,function(t){return va(+(e[t]||0),0)};var t=va(+(e||0),0);return function(){return t}}function r(a){A=t[a];u(A)&&(L=x(a),E=b(a),z=A-w(a),I=A+_(a),y&&z<I/10&&(z=I/10),S=e.c2l(z),C=e.c2l(I),m&&(S=ie(0,S),C=va(0,C)),d(S)&&n(s,S,E,D),d(C)&&l(c,C,L,D))}a||(a={}),e._m||e.setScale();var s=[],c=[],p=t.length,g=a.padded||!1,m=a.tozero&&("linear"===e.type||"-"===e.type),y="log"===e.type,f=!1,x=o((0<e._m?a.ppadplus:a.ppadminus)||a.ppad||0),b=o((0<e._m?a.ppadminus:a.ppadplus)||a.ppad||0),_=o(a.vpadplus||a.vpad),w=o(a.vpadminus||a.vpad),k,T,A,S,C,L,E,z,I;if(!f){if(z=1/0,I=-Infinity,y)for(k=0;k<p;k++)T=t[k],T<z&&0<T&&(z=T),T>I&&T<h&&(I=T);else for(k=0;k<p;k++)T=t[k],T<z&&T>-h&&(z=T),T>I&&T<h&&(I=T);t=[z,I],p=2}var D={tozero:m,extrapad:g},P=ie(6,p);for(k=0;k<P;k++)r(k);for(k=p-1;k>=P;k--)r(k);return{min:s,max:c}},concatExtremes:r}},{"../../constants/numerical":669,"../../lib":692,"../../registry":823,"fast-isnumeric":214}],740:[function(e,t){"use strict";function a(e){return+e}function o(e){return e+""}function r(e,t,a,o,r){function n(t){return 2>(1+100*(t-e)/a.dtick)%100}for(var l=0,s=0,d=0,c=0,p=0;p<t.length;p++)0==t[p]%1?d++:!G(t[p])&&c++,n(t[p])&&l++,n(t[p]+a.dtick/2)&&s++;var u=t.length-c;if(d===u&&"date"!==a.type)1>a.dtick?e=o-.5*a.dtick:(e-=.5,e+a.dtick<o&&(e+=a.dtick));else if(s<.1*u&&(l>.3*u||n(o)||n(r))){var g=a.dtick/2;e+=e+g<o?g:-g}return e}function i(e,t,a,o,r){var i=W.findExactDates(t,r),n=.8;if(i.exactDays>n){var l=+a.substr(1);i.exactYears>n&&0==l%12?e=he.tickIncrement(e,"M6","reverse")+1.5*ne:i.exactMonths>n?e=he.tickIncrement(e,"M1","reverse")+15.5*ne:e-=ne/2;var s=he.tickIncrement(e,a);if(s<=o)return s}return e}function n(e){var t=e.tickvals,a=e.ticktext,o=Array(t.length),r=W.simpleMap(e.range,e.r2l),n=1.0001*r[0]-1e-4*r[1],l=1.0001*r[1]-1e-4*r[0],s=ie(n,l),c=va(n,l),p=0;Array.isArray(a)||(a=[]);var u="category"===e.type?e.d2l_noadd:e.d2l;"log"===e.type&&"L"!==(e.dtick+"").charAt(0)&&(e.dtick="L"+_a(10,ea(ie(e.range[0],e.range[1]))-1));for(var g=0,h;g<t.length;g++)h=u(t[g]),h>s&&h<c&&(o[p]=void 0===a[g]?he.tickText(e,h):d(e,h,a[g]+""),p++);return p<t.length&&o.splice(p,t.length-p),o}function l(e,t,a){return t*W.roundUp(e/t,a)}function s(e){var t=e.dtick;if(e._tickexponent=0,G(t)||"string"==typeof t||(t=1),("category"===e.type||"multicategory"===e.type)&&(e._tickround=null),"date"===e.type){var a=e.r2l(e.tick0),o=e.l2r(a).replace(/(^-|i)/g,""),r=o.length;if("M"===(t+"").charAt(0))e._tickround=10<r||"01-01"!==o.substr(5)?"d":0==+t.substr(1)%12?"y":"m";else if(t>=ne&&10>=r||t>=15*ne)e._tickround="d";else if(t>=se&&16>=r||t>=le)e._tickround="M";else if(t>=de&&19>=r||t>=se)e._tickround="S";else{var i=e.l2r(a+t).replace(/^-/,"").length;e._tickround=va(r,i)-20,0>e._tickround&&(e._tickround=4)}}else if(G(t)||"L"===t.charAt(0)){var n=e.range.map(e.r2d||Number);G(t)||(t=+t.substr(1)),e._tickround=2-ea(P(t)/z+.01);var l=va(wa(n[0]),wa(n[1])),s=ea(P(l)/z+.01);3<wa(s)&&(f(e.exponentformat)&&!b(s)?e._tickexponent=3*R((s-1)/3):e._tickexponent=s)}else e._tickround=null}function d(e,t,a){var o=e.tickfont||{};return{x:t,dx:0,dy:0,text:a||"",fontSize:o.size,font:o.family,fontColor:o.color}}function c(e,t,a,o){var r=e._tickround,i=a&&e.hoverformat||he.getTickFormat(e);o&&(G(r)?r=4:r={y:"m",m:"d",d:"M",M:"S",S:4}[r]);var n=W.formatDate(t.x,i,r,e._dateFormat,e.calendar,e._extraFormat),l=n.indexOf("\n"),s;-1!==l&&(s=n.substr(l+1),n=n.substr(0,l)),o&&("00:00:00"===n||"00:00"===n?(n=s,s=""):8===n.length&&(n=n.replace(/:00$/,""))),s&&(a?"d"===r?n+=", "+s:n=s+(n?", "+n:""):(!e._inCalcTicks||s!==e._prevDateHead)&&(n+="<br>"+s,e._prevDateHead=s)),t.text=n}function p(e,t,a,o,r){var i=e.dtick,n=t.x,l=e.tickformat,s="string"==typeof i&&i.charAt(0);if("never"===r&&(r=""),o&&"L"!==s&&(i="L3",s="L"),l||"L"===s)t.text=_(_a(10,n),e,r,o);else if(G(i)||"D"===s&&.1>W.mod(n+.01,1)){var d=R(n),c=wa(d),p=e.exponentformat;"power"===p||f(p)&&b(d)?(t.text=0===d?1:1===d?"10":"10<sup>"+(1<d?"":ce)+c+"</sup>",t.fontSize*=1.25):("e"===p||"E"===p)&&2<c?t.text="1"+p+(0<d?"+":ce)+c:(t.text=_(_a(10,n),e,"","fakehover"),"D1"===i&&"y"===e._id.charAt(0)&&(t.dy-=t.fontSize/6))}else if("D"===s)t.text=R(_a(10,W.mod(n,1)))+"",t.fontSize*=.75;else throw"unrecognized dtick "+(i+"");if("D1"===e.dtick){var u=(t.text+"").charAt(0);("0"===u||"1"===u)&&("y"===e._id.charAt(0)?t.dx-=t.fontSize/4:(t.dy+=t.fontSize/2,t.dx+=(e.range[1]>e.range[0]?1:-1)*t.fontSize*(0>n?.5:.25)))}}function u(e,t){var a=e._categories[R(t.x)];a===void 0&&(a=""),t.text=a+""}function g(e,t,a){var o=R(t.x),r=e._categories[o]||[],i=r[1]===void 0?"":r[1]+"",n=r[0]===void 0?"":r[0]+"";a?t.text=n+" - "+i:(t.text=i,t.text2=n)}function h(e,t,a,o,r){"never"===r?r="":"all"===e.showexponent&&1e-6>wa(t.x/e.dtick)&&(r="hide"),t.text=_(t.x,e,r,o)}function m(e,t,a,o,r){if("radians"===e.thetaunit&&!a){var i=t.x/180;if(0==i)t.text="0";else{var n=y(i);if(100<=n[1])t.text=_(W.deg2rad(t.x),e,r,o);else{var l=0>t.x;t.text=1===n[1]?1===n[0]?"\u03C0":n[0]+"\u03C0":["<sup>",n[0],"</sup>","\u2044","<sub>",n[1],"</sub>","\u03C0"].join(""),l&&(t.text=ce+t.text)}}}else t.text=_(t.x,e,r,o)}function y(e){function t(e,t){return 1e-6>=wa(e-t)}function o(e,a){return t(a,0)?e:o(a,e%a)}var r=function(a){for(var o=1;!t(R(a*o)/o,a);)o*=10;return o}(e),i=e*r,n=wa(o(i,r));return[R(i/n),R(r/n)]}function f(e){return"SI"===e||"B"===e}function b(e){return 14<e||-15>e}function _(t,a,o,r){var n=0>t,l=a._tickround,d=o||a.exponentformat||"B",c=a._tickexponent,p=he.getTickFormat(a),u=a.separatethousands;if(r){var g={exponentformat:d,dtick:"none"===a.showexponent?a.dtick:G(t)?wa(t)||1:1,range:"none"===a.showexponent?a.range.map(a.r2d):[0,t||1]};s(g),l=(+g._tickround||0)+4,c=g._tickexponent,a.hoverformat&&(p=a.hoverformat)}if(p)return a._numFormat(p)(t).replace(/-/g,ce);var h=_a(10,-l)/2;if("none"===d&&(c=0),t=wa(t),t<h)t="0",n=!1;else{if(t+=h,c&&(t*=_a(10,-c),l+=c),0===l)t=ea(t)+"";else if(0>l){t=R(t)+"",t=t.substr(0,t.length+l);for(var e=l;0>e;e++)t+="0"}else{t+="";var m=t.indexOf(".")+1;m&&(t=t.substr(0,m+l).replace(/\.?0+$/,""))}t=W.numSeparate(t,a._separators,u)}if(c&&"hide"!==d){f(d)&&b(c)&&(d="power");var y;y=0>c?ce+-c:"power"===d?c+"":"+"+c,"e"===d||"E"===d?t+=d+y:"power"===d?t+="\xD710<sup>"+y+"</sup>":"B"===d&&9===c?t+="B":f(d)&&(t+=Se[c/3+5])}return n?ce+t:t}function v(e,t){var a=[],o=function(e,t){var o=e.xbnd[t];null!==o&&a.push(W.extendFlat({},e,{x:o}))},r;if(t.length){for(r=0;r<t.length;r++)o(t[r],0);o(t[r-1],1)}return a}function w(e,t){for(var a=[],o={},r=0,n;r<t.length;r++)n=t[r],o[n.text2]?o[n.text2].push(n.x):o[n.text2]=[n.x];for(var l in o)a.push(d(e,W.interp(o[l],.5),l));return a}function k(e,t){var a=[],o=function(e,t){var o=e.xbnd[t];null!==o&&a.push(W.extendFlat({},e,{x:o}))},r,n;if(e.showdividers&&t.length){for(r=0;r<t.length;r++){var l=t[r];l.text2!==n&&o(l,0),n=l.text2}o(t[r-1],1)}return a}function T(e,t){var a=e._id.charAt(0),o=e._tickAngles[t]||0,r=W.deg2rad(o),i=M(r),n=te(r),l=0,s=0;return e._selections[t].each(function(){var e=D(this),t=J.bBox(e.node()),a=t.width,o=t.height;l=va(l,n*a,i*o),s=va(s,i*a,n*o)}),{x:s,y:l}[a]}function A(e){return[e.text,e.x,e.axInfo,e.font,e.fontSize,e.fontColor].join("_")}function S(e,t,a){var o=t._id+"divider",r=a.vals,i=a.layer.selectAll("path."+o).data(r,A);i.exit().remove(),i.enter().insert("path",":first-child").classed(o,1).classed("crisp",1).call($.stroke,t.dividercolor).style("stroke-width",J.crispRound(e,t.dividerwidth,1)+"px"),i.attr("transform",a.transFn).attr("d",a.path)}function C(e,t){var a=e._fullLayout,o=t._id,r=o.charAt(0),i=a._size,n=t.title.font.size,l;if("multicategory"===t.type)l=t._labelLength;else{l=10+n*1.5+(t.linewidth?t.linewidth-1:0)}var s,d,c,p;"x"===r?(d="free"===t.anchor?{_offset:i.t+(1-(t.position||0))*i.h,_length:0}:ye.getFromId(e,t.anchor),c=t._offset+t._length/2,p="top"===t.side?-l-n*(t.showticklabels?1:0):d._length+l+n*(t.showticklabels?1.5:.5),p+=d._offset):(d="free"===t.anchor?{_offset:i.l+(t.position||0)*i.w,_length:0}:ye.getFromId(e,t.anchor),p=t._offset+t._length/2,c="right"===t.side?d._length+l+n*(t.showticklabels?1:.5):-l-n*(t.showticklabels?.5:0),c+=d._offset,s={rotate:"-90",offset:0});var u;if("multicategory"!==t.type){var g=t._selections[t._id+"tick"];if(u={selection:g,side:t.side},g&&g.node()&&g.node().parentNode){var h=J.getTranslate(g.node().parentNode);u.offsetLeft=h.x,u.offsetTop=h.y}}return Z.draw(e,o+"title",{propContainer:t,propName:t._name+".title.text",placeholder:a._dfltTitle[r],avoid:u,transform:s,attributes:{x:c,y:p,"text-anchor":"middle"}})}function L(e,t){var a=e.l2p(t);return 1<a&&a<e._length-1}function E(e,t,a,o){function r(e){function a(e){return"number"==typeof e&&wa(e-c)<o}if(!e.showline||!e.linewidth)return!1;var o=va((e.linewidth+t.zerolinewidth)/2,1);if(a(e._mainLinePosition)||a(e._mainMirrorPosition))return!0;var r=e._linepositions||{};for(var i in r)if(a(r[i][0])||a(r[i][1]))return!0}var n=a._mainAxis;if(n){var l=e._fullLayout,s=t._id.charAt(0),d=he.counterLetter(t._id),c=t._offset+(wa(o[0])<wa(o[1])==("x"===s)?0:t._length),p=l._plots[a._mainSubplot];if(!(p.mainplotinfo||p).overlays.length)return r(a,c);for(var u=he.list(e,d),g=0,h;g<u.length;g++)if(h=u[g],h._mainAxis===n&&r(h,c))return!0}}function I(e,t){for(var a=e._fullData,o=t._mainSubplot,r=t._id.charAt(0),n=0,l;n<a.length;n++)if(l=a[n],!0===l.visible&&l.xaxis+l.yaxis===o&&(q.traceIs(l,"bar")&&l.orientation==={x:"h",y:"v"}[r]||l.fill&&l.fill.charAt(l.fill.length-1)===r))return!0;return!1}function D(e){var t=H.select(e),a=t.select(".text-math-group");return a.empty()?t.select("text"):a}function O(e){return e._id+".automargin"}function j(e){return e._id+".rangeslider"}function B(e,t){var a=[],o,r;for(o=0;o<t.length;o++){var n=[],l=e._fullData[t[o]].xaxis,s=e._fullData[t[o]].yaxis;if(l&&s){for(r=0;r<a.length;r++)(-1!==a[r].x.indexOf(l)||-1!==a[r].y.indexOf(s))&&n.push(r);if(!n.length){a.push({x:[l],y:[s]});continue}var d=a[n[0]],c;if(1<n.length)for(r=1;r<n.length;r++)c=a[n[r]],F(d.x,c.x),F(d.y,c.y);F(d.x,[l]),F(d.y,[s])}}return a}function F(e,t){for(var a=0;a<t.length;a++)-1===e.indexOf(t[a])&&e.push(t[a])}function N(e,t,a){var o=[],r=[],n=e.layout,l,s;for(l=0;l<t.length;l++)o.push(he.getFromId(e,t[l]));for(l=0;l<a.length;l++)r.push(he.getFromId(e,a[l]));var d=Object.keys(K),c=["anchor","domain","overlaying","position","side","tickangle","editType"],p=["linear","log"];for(l=0;l<d.length;l++){var u=d[l],g=o[0][u],h=r[0][u],m=!0,y=!1,f=!1;if("_"!==u.charAt(0)&&"function"!=typeof g&&-1===c.indexOf(u)){for(s=1;s<o.length&&m;s++){var x=o[s][u];"type"===u&&-1!==p.indexOf(g)&&-1!==p.indexOf(x)&&g!==x?y=!0:x!==g&&(m=!1)}for(s=1;s<r.length&&m;s++){var b=r[s][u];"type"===u&&-1!==p.indexOf(h)&&-1!==p.indexOf(b)&&h!==b?f=!0:r[s][u]!==h&&(m=!1)}m&&(y&&(n[o[0]._name].type="linear"),f&&(n[r[0]._name].type="linear"),V(n,u,o,r,e._fullLayout._dfltTitle))}}for(l=0;l<e._fullLayout.annotations.length;l++){var _=e._fullLayout.annotations[l];-1!==t.indexOf(_.xref)&&-1!==a.indexOf(_.yref)&&W.swapAttrs(n.annotations[l],["?"])}}function V(e,t,a,o,r){var n=W.nestedProperty,l=n(e[a[0]._name],t).get(),s=n(e[o[0]._name],t).get(),d;for("title"===t&&(l&&l.text===r.x&&(l.text=r.y),s&&s.text===r.y&&(s.text=r.x)),d=0;d<a.length;d++)n(e,a[d]._name+"."+t).set(s);for(d=0;d<o.length;d++)n(e,o[d]._name+"."+t).set(l)}function U(e){return"angularaxis"===e._id}var H=e("d3"),G=e("fast-isnumeric"),Y=e("../../plots/plots"),q=e("../../registry"),W=e("../../lib"),X=e("../../lib/svg_text_utils"),Z=e("../../components/titles"),$=e("../../components/color"),J=e("../../components/drawing"),K=e("./layout_attributes"),Q=e("./clean_ticks"),ee=e("../../constants/numerical"),oe=ee.ONEAVGYEAR,re=ee.ONEAVGMONTH,ne=ee.ONEDAY,le=ee.ONEHOUR,se=ee.ONEMIN,de=ee.ONESEC,ce=ee.MINUS_SIGN,pe=ee.BADNUM,ue=e("../../constants/alignment").MID_SHIFT,ge=e("../../constants/alignment").LINE_SPACING,he=t.exports={};he.setConvert=e("./set_convert");var me=e("./axis_autotype"),ye=e("./axis_ids");he.id2name=ye.id2name,he.name2id=ye.name2id,he.cleanId=ye.cleanId,he.list=ye.list,he.listIds=ye.listIds,he.getFromId=ye.getFromId,he.getFromTrace=ye.getFromTrace;var fe=e("./autorange");he.getAutoRange=fe.getAutoRange,he.findExtremes=fe.findExtremes,he.coerceRef=function(e,t,a,o,r,i){var n=o.charAt(o.length-1),l=a._fullLayout._subplots[n+"axis"],s=o+"ref",d={};return r||(r=l[0]||i),i||(i=r),d[s]={valType:"enumerated",values:l.concat(i?[i]:[]),dflt:r},W.coerce(e,t,d,s)},he.coercePosition=function(e,t,a,o,r,i){var n,l;if("paper"===o||"pixel"===o)n=W.ensureNumber,l=a(r,i);else{var s=he.getFromId(t,o);i=s.fraction2r(i),l=a(r,i),n=s.cleanPos}e[r]=n(l)},he.cleanPosition=function(e,t,a){var o="paper"===a||"pixel"===a?W.ensureNumber:he.getFromId(t,a).cleanPos;return o(e)};var xe=he.getDataConversions=function(e,t,r,n){var l="x"===r||"y"===r||"z"===r?r:n,s;if(!Array.isArray(l))s=he.getFromTrace(e,t,l);else if(s={type:me(n),_categories:[]},he.setConvert(s),"category"===s.type)for(var d=0;d<n.length;d++)s.d2c(n[d]);return s?{d2c:s.d2c,c2d:s.c2d}:"ids"===l?{d2c:o,c2d:o}:{d2c:a,c2d:a}};he.getDataToCoordFunc=function(e,t,a,o){return xe(e,t,a,o).d2c},he.counterLetter=function(e){var t=e.charAt(0);return"x"===t?"y":"y"===t?"x":void 0},he.minDtick=function(e,t,a,o){-1===["log","category","multicategory"].indexOf(e.type)&&o?e._minDtick===void 0?(e._minDtick=t,e._forceTick0=a):e._minDtick&&(2e-6>(e._minDtick/t+1e-6)%1&&2e-6>((a-e._forceTick0)/t%1+1.000001)%1?(e._minDtick=t,e._forceTick0=a):(2e-6<(t/e._minDtick+1e-6)%1||2e-6<((a-e._forceTick0)/e._minDtick%1+1.000001)%1)&&(e._minDtick=0)):e._minDtick=0},he.saveRangeInitial=function(e,t){for(var a=he.list(e,"",!0),o=!1,r=0;r<a.length;r++){var n=a[r],l=n._rangeInitial===void 0,s=l||n.range[0]!==n._rangeInitial[0]||n.range[1]!==n._rangeInitial[1];(l&&!1===n.autorange||t&&s)&&(n._rangeInitial=n.range.slice(),o=!0)}return o},he.saveShowSpikeInitial=function(e,t){for(var a=he.list(e,"",!0),o=!1,r="on",n=0;n<a.length;n++){var l=a[n],s=void 0===l._showSpikeInitial,d=s||l.showspikes!==l._showspikes;(s||t&&d)&&(l._showSpikeInitial=l.showspikes,o=!0),"on"!==r||l.showspikes||(r="off")}return e._fullLayout._cartesianSpikesEnabled=r,o},he.autoBin=function(e,t,a,o,n,l){var s=W.aggNums(Math.min,null,e),d=W.aggNums(Math.max,null,e);if("category"===t.type||"multicategory"===t.type)return{start:s-.5,end:d+.5,size:va(1,R(l)||1),_dataSpan:d-s};n||(n=t.calendar);var c;if(c="log"===t.type?{type:"linear",range:[s,d]}:{type:t.type,range:W.simpleMap([s,d],t.c2r,0,n),calendar:n},he.setConvert(c),l=l&&Q.dtick(l,c.type),l)c.dtick=l,c.tick0=Q.tick0(void 0,c.type,n);else{var p;if(a)p=(d-s)/a;else{var u=W.distinctVals(e),g=_a(10,ea(P(u.minDiff)/z)),h=g*W.roundUp(u.minDiff/g,[.9,1.9,4.9,9.9],!0);p=va(h,2*W.stdev(e)/_a(e.length,o?.25:.4)),G(p)||(p=1)}he.autoTicks(c,p)}var m=c.dtick,y=he.tickIncrement(he.tickFirst(c),m,"reverse",n),f,x;if("number"==typeof m)y=r(y,e,c,s,d),x=1+ea((d-y)/m),f=y+x*m;else for("M"===c.dtick.charAt(0)&&(y=i(y,e,m,s,n)),f=y,x=0;f<=d;)f=he.tickIncrement(f,m,!1,n),x++;return{start:t.c2r(y,0,n),end:t.c2r(f,0,n),size:m,_dataSpan:d-s}},he.prepTicks=function(e){var t=W.simpleMap(e.range,e.r2l);if("auto"===e.tickmode||!e.dtick){var a=e.nticks,o;a||("category"===e.type||"multicategory"===e.type?(o=e.tickfont?1.2*(e.tickfont.size||12):15,a=e._length/o):(o="y"===e._id.charAt(0)?40:80,a=W.constrain(e._length/o,4,9)+1),"radialaxis"===e._name&&(a*=2)),"array"===e.tickmode&&(a*=100),he.autoTicks(e,wa(t[1]-t[0])/a),0<e._minDtick&&e.dtick<2*e._minDtick&&(e.dtick=e._minDtick,e.tick0=e.l2r(e._forceTick0))}e.tick0||(e.tick0="date"===e.type?"2000-01-01":0),"date"===e.type&&.1>e.dtick&&(e.dtick=.1),s(e)},he.calcTicks=function(e){he.prepTicks(e);var t=W.simpleMap(e.range,e.r2l);if("array"===e.tickmode)return n(e);e._tmin=he.tickFirst(e);var a=1.0001*t[0]-1e-4*t[1],o=1.0001*t[1]-1e-4*t[0],r=t[1]<t[0];if(e._tmin<a!==r)return[];var l=[];("category"===e.type||"multicategory"===e.type)&&(o=r?va(-.5,o):ie(e._categories.length-.5,o));for(var s=null,d=va(1e3,e._length||0),c=e._tmin;(r?c>=o:c<=o)&&!(l.length>d||c===s);c=he.tickIncrement(c,e.dtick,r,e.calendar))s=c,l.push(c);U(e)&&360===wa(t[1]-t[0])&&l.pop(),e._tmax=l[l.length-1],e._prevDateHead="",e._inCalcTicks=!0;for(var p=Array(l.length),u=0;u<l.length;u++)p[u]=he.tickText(e,l[u]);return e._inCalcTicks=!1,p};var be=[2,5,10],_e=[1,2,3,6,12],ve=[1,2,5,10,15,30],we=[1,2,3,7,14],ke=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],Te=[-.301,0,.301,.699,1],Ae=[15,30,45,90,180];he.autoTicks=function(e,t){function a(e){return _a(e,ea(P(t)/z))}var o;if("date"===e.type){e.tick0=W.dateTick0(e.calendar);var r=2*t;r>oe?(t/=oe,o=a(10),e.dtick="M"+12*l(t,o,be)):r>re?(t/=re,e.dtick="M"+l(t,1,_e)):r>ne?(e.dtick=l(t,ne,we),e.tick0=W.dateTick0(e.calendar,!0)):r>le?e.dtick=l(t,le,_e):r>se?e.dtick=l(t,se,ve):r>de?e.dtick=l(t,de,ve):(o=a(10),e.dtick=l(t,o,be))}else if("log"===e.type){e.tick0=0;var i=W.simpleMap(e.range,e.r2l);if(.7<t)e.dtick=ae(t);else if(1>wa(i[1]-i[0])){var n=1.5*wa((i[1]-i[0])/t);t=wa(_a(10,i[1])-_a(10,i[0]))/n,o=a(10),e.dtick="L"+l(t,o,be)}else e.dtick=.3<t?"D2":"D1"}else"category"===e.type||"multicategory"===e.type?(e.tick0=0,e.dtick=ae(va(t,1))):U(e)?(e.tick0=0,o=1,e.dtick=l(t,o,Ae)):(e.tick0=0,o=a(10),e.dtick=l(t,o,be));if(0===e.dtick&&(e.dtick=1),!G(e.dtick)&&"string"!=typeof e.dtick){var s=e.dtick;throw e.dtick=1,"ax.dtick error: "+(s+"")}},he.tickIncrement=function(e,t,a,o){var r=a?-1:1;if(G(t))return e+r*t;var i=t.charAt(0),n=r*+t.substr(1);if("M"===i)return W.incrementMonth(e,n,o);if("L"===i)return P(_a(10,e)+n)/z;if("D"===i){var l="D2"===t?Te:ke,s=e+.01*r,d=W.roundUp(W.mod(s,1),l,a);return ea(s)+P(H.round(_a(10,d),1))/z}throw"unrecognized dtick "+(t+"")},he.tickFirst=function(e){var t=e.r2l||Number,a=W.simpleMap(e.range,t),o=a[1]<a[0],r=o?ea:ae,i=1.0001*a[0]-1e-4*a[1],n=e.dtick,l=t(e.tick0);if(G(n)){var s=r((i-l)/n)*n+l;return("category"===e.type||"multicategory"===e.type)&&(s=W.constrain(s,0,e._categories.length-1)),s}var d=n.charAt(0),c=+n.substr(1);if("M"===d){for(var p=0,u=l,g,h,m;10>p;){if(g=he.tickIncrement(u,n,o,e.calendar),0>=(g-i)*(u-i))return o?ie(u,g):va(u,g);h=(i-(u+g)/2)/(g-u),m=d+(wa(R(h))||1)*c,u=he.tickIncrement(u,m,0>h?!o:o,e.calendar),p++}return W.error("tickFirst did not converge",e),u}if("L"===d)return P(r((_a(10,i)-l)/c)*c+l)/z;if("D"===d){var y="D2"===n?Te:ke,f=W.roundUp(W.mod(i,1),y,o);return ea(i)+P(H.round(_a(10,f),1))/z}throw"unrecognized dtick "+(n+"")},he.tickText=function(e,t,a){function o(o){if(void 0===o)return!0;if(a)return"none"===o;var r={first:e._tmin,last:e._tmax}[o];return"all"!==o&&t!==r}var r=d(e,t),n="array"===e.tickmode,l=a||n,s=e.type,y="category"===s?e.d2l_noadd:e.d2l,f;if(n&&Array.isArray(e.ticktext)){var x=W.simpleMap(e.range,e.r2l),b=wa(x[1]-x[0])/1e4;for(f=0;f<e.ticktext.length&&!(wa(t-y(e.tickvals[f]))<b);f++);if(f<e.ticktext.length)return r.text=e.ticktext[f]+"",r}var _=a?"never":"none"!==e.exponentformat&&o(e.showexponent)?"hide":"";if("date"===s?c(e,r,a,l):"log"===s?p(e,r,a,l,_):"category"===s?u(e,r):"multicategory"===s?g(e,r,a):U(e)?m(e,r,a,l,_):h(e,r,a,l,_),e.tickprefix&&!o(e.showtickprefix)&&(r.text=e.tickprefix+r.text),e.ticksuffix&&!o(e.showticksuffix)&&(r.text+=e.ticksuffix),"boundaries"===e.tickson||e.showdividers){var v=function(t){var a=e.l2p(t);return 0<=a&&a<=e._length?t:null};r.xbnd=[v(r.x-.5),v(r.x+e.dtick-.5)]}return r},he.hoverLabelText=function(e,t,a){if(a!==pe&&a!==t)return he.hoverLabelText(e,t)+" - "+he.hoverLabelText(e,a);var o="log"===e.type&&0>=t,r=he.tickText(e,e.c2l(o?-t:t),"hover").text;return o?0===t?"0":ce+r:r};var Se=["f","p","n","\u03BC","m","","k","M","G","T"];he.getTickFormat=function(e){function t(e){return"string"==typeof e?+e.replace("M","")*re:e}function a(e,t){var a=["L","D"];if(typeof e==typeof t){if("number"==typeof e)return e-t;var o=a.indexOf(e.charAt(0)),r=a.indexOf(t.charAt(0));return o===r?+e.replace(/(L|D)/g,"")-+t.replace(/(L|D)/g,""):o-r}return"number"==typeof e?1:-1}function o(e,t,a){var o=a||function(e){return e},r=t[0],i=t[1];return(!r&&"number"!=typeof r||o(r)<=o(e))&&(!i&&"number"!=typeof i||o(i)>=o(e))}function r(e,t){var o=null===t[0],r=null===t[1],i=0<=a(e,t[0]),n=0>=a(e,t[1]);return(o||i)&&(r||n)}var n,l,s;if(e.tickformatstops&&0<e.tickformatstops.length)switch(e.type){case"date":case"linear":{for(n=0;n<e.tickformatstops.length;n++)if(s=e.tickformatstops[n],s.enabled&&o(e.dtick,s.dtickrange,t)){l=s;break}break}case"log":{for(n=0;n<e.tickformatstops.length;n++)if(s=e.tickformatstops[n],s.enabled&&r(e.dtick,s.dtickrange)){l=s;break}break}default:}return l?l.value:e.tickformat},he.getSubplots=function(e,t){var a=e._fullLayout._subplots,o=a.cartesian.concat(a.gl2d||[]),r=t?he.findSubplotsWithAxis(o,t):o;return r.sort(function(e,t){var a=e.substr(1).split("y"),o=t.substr(1).split("y");return a[0]===o[0]?+a[1]-+o[1]:+a[0]-+o[0]}),r},he.findSubplotsWithAxis=function(e,t){for(var a=new RegExp("x"===t._id.charAt(0)?"^"+t._id+"y":t._id+"$"),o=[],r=0,n;r<e.length;r++)n=e[r],a.test(n)&&o.push(n);return o},he.makeClipPaths=function(e){var t=e._fullLayout;if(!t._hasOnlyLargeSploms){var a={_offset:0,_length:t.width,_id:""},o={_offset:0,_length:t.height,_id:""},r=he.list(e,"x",!0),n=he.list(e,"y",!0),l=[],s,d;for(s=0;s<r.length;s++)for(l.push({x:r[s],y:o}),d=0;d<n.length;d++)0===s&&l.push({x:a,y:n[d]}),l.push({x:r[s],y:n[d]});var c=t._clips.selectAll(".axesclip").data(l,function(e){return e.x._id+e.y._id});c.enter().append("clipPath").classed("axesclip",!0).attr("id",function(e){return"clip"+t._uid+e.x._id+e.y._id}).append("rect"),c.exit().remove(),c.each(function(e){H.select(this).select("rect").attr({x:e.x._offset||0,y:e.y._offset||0,width:e.x._length||1,height:e.y._length||1})})}},he.draw=function(e,t,a){var o=e._fullLayout;"redraw"===t&&o._paper.selectAll("g.subplot").each(function(e){var t=e[0],a=o._plots[t],r=a.xaxis,i=a.yaxis;a.xaxislayer.selectAll("."+r._id+"tick").remove(),a.yaxislayer.selectAll("."+i._id+"tick").remove(),a.xaxislayer.selectAll("."+r._id+"tick2").remove(),a.yaxislayer.selectAll("."+i._id+"tick2").remove(),a.xaxislayer.selectAll("."+r._id+"divider").remove(),a.yaxislayer.selectAll("."+i._id+"divider").remove(),a.gridlayer&&a.gridlayer.selectAll("path").remove(),a.zerolinelayer&&a.zerolinelayer.selectAll("path").remove(),o._infolayer.select(".g-"+r._id+"title").remove(),o._infolayer.select(".g-"+i._id+"title").remove()});var r=t&&"redraw"!==t?t:he.listIds(e);return W.syncOrAsync(r.map(function(t){return function(){if(t){var o=he.getFromId(e,t),r=he.drawOne(e,o,a);return o._r=o.range.slice(),o._rl=W.simpleMap(o._r,o.r2l),r}}}))},he.drawOne=function(e,t,a){function o(e,t){e[0]=ie(e[0],t[0]),e[1]=va(e[1],t[1])}function r(){if(t.showticklabels){var a=e.getBoundingClientRect(),r=x.node().getBoundingClientRect();t._boundingBox={width:r.width,height:r.height,left:r.left-a.left,right:r.right-a.left,top:r.top-a.top,bottom:r.bottom-a.top}}else{var n=c._size,l;"x"===u?(l="free"===t.anchor?n.t+n.h*(1-t.position):n.t+n.h*(1-t._anchorAxis.domain[{bottom:0,top:1}[t.side]]),t._boundingBox={top:l,bottom:l,left:t._offset,right:t._offset+t._length,width:t._length,height:0}):(l="free"===t.anchor?n.l+n.w*t.position:n.l+n.w*t._anchorAxis.domain[{left:0,right:1}[t.side]],t._boundingBox={left:l,right:l,bottom:t._offset+t._length,top:t._offset,height:t._length,width:0})}if(b){for(var s=t._counterSpan=[1/0,-Infinity],d=0;d<b.length;d++){var p=c._plots[b[d]],g=p["x"===u?"yaxis":"xaxis"];o(s,[g._offset,g._offset+g._length])}"free"===t.anchor&&o(s,"x"===u?[t._boundingBox.bottom,t._boundingBox.top]:[t._boundingBox.right,t._boundingBox.left])}}function n(){var a,o;ae&&(o=q.getComponentMethod("rangeslider","autoMarginOpts")(e,t)),Y.autoMargin(e,j(t),o);var r=t.side.charAt(0);t.automargin&&(!ae||"b"!==r)&&(a={x:0,y:0,r:0,l:0,t:0,b:0},"x"===u?(a.y="free"===t.anchor?t.position:t._anchorAxis.domain["t"===r?1:0],a[r]+=t._boundingBox.height):(a.x="free"===t.anchor?t.position:t._anchorAxis.domain["r"===r?1:0],a[r]+=t._boundingBox.width),t.title.text!==c._dfltTitle[u]&&(a[r]+=t.title.font.size)),Y.autoMargin(e,O(t),a)}a=a||{};var l,s,d;t.setScale();var c=e._fullLayout,p=t._id,u=p.charAt(0),g=he.counterLetter(p),h=t._mainSubplot,m=t._mainLinePosition,y=t._mainMirrorPosition,f=c._plots[h],x=f[u+"axislayer"],b=t._subplotsWith,_=t._vals=he.calcTicks(t),A=[t.mirror,m,y].join("_");for(l=0;l<_.length;l++)_[l].axInfo=A;if(t.visible){t._selections={},t._tickAngles={};var L=he.makeTransFn(t),E,z;if("boundaries"===t.tickson){var I=v(t,_);z=he.clipEnds(t,I),E="inside"===t.ticks?z:I}else z=he.clipEnds(t,_),E="inside"===t.ticks?z:_;var D=t._gridVals=z,P=k(t,_);if(!c._hasOnlyLargeSploms){var R={};for(l=0;l<b.length;l++){s=b[l],d=c._plots[s];var M=d[g+"axis"],B=M._mainAxis._id;if(!R[B]){R[B]=1;var F="x"===u?"M0,"+M._offset+"v"+M._length:"M"+M._offset+",0h"+M._length;he.drawGrid(e,t,{vals:D,counterAxis:M,layer:d.gridlayer.select("."+p),path:F,transFn:L}),he.drawZeroLine(e,t,{counterAxis:M,layer:d.zerolinelayer,path:F,transFn:L})}}}var N=he.getTickSigns(t),V=[];if(t.ticks){var U=he.makeTickPath(t,m,N[2]),H,G;t._anchorAxis&&t.mirror&&!0!==t.mirror?(H=he.makeTickPath(t,y,N[3]),G=U+H):(H="",G=U);var X;if(t.showdividers&&"outside"===t.ticks&&"boundaries"===t.tickson){var Z={};for(l=0;l<P.length;l++)Z[P[l].x]=1;X=function(e){return Z[e.x]?H:G}}else X=G;he.drawTicks(e,t,{vals:E,layer:x,path:X,transFn:L}),V=Object.keys(t._linepositions||{})}for(l=0;l<V.length;l++){s=V[l],d=c._plots[s];var $=t._linepositions[s]||[],J=he.makeTickPath(t,$[0],N[0])+he.makeTickPath(t,$[1],N[1]);he.drawTicks(e,t,{vals:E,layer:d[u+"axislayer"],path:J,transFn:L})}var K=[function(){var a=he.makeLabelFns(t,m);return he.drawLabels(e,t,{vals:_,layer:x,transFn:L,labelXFn:a.labelXFn,labelYFn:a.labelYFn,labelAnchorFn:a.labelAnchorFn})}];if("multicategory"===t.type){var Q=0,ee={x:2,y:10}[u],te=N[2]*("inside"===t.ticks?-1:1);K.push(function(){Q+=T(t,p+"tick")+ee,Q+=t._tickAngles[p+"tick"]?t.tickfont.size*ge:0;var a=m+Q*te,o=he.makeLabelFns(t,a);return he.drawLabels(e,t,{vals:w(t,_),layer:x,cls:p+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:L,labelXFn:o.labelXFn,labelYFn:o.labelYFn,labelAnchorFn:o.labelAnchorFn})}),K.push(function(){return Q+=T(t,p+"tick2"),t._labelLength=Q,S(e,t,{vals:P,layer:x,path:he.makeTickPath(t,m,te,Q),transFn:L})})}var ae=q.getComponentMethod("rangeslider","isVisible")(t);return K.push(r,n),a.skipTitle||ae&&t._boundingBox&&"bottom"===t.side||K.push(function(){return C(e,t)}),W.syncOrAsync(K)}},he.getTickSigns=function(e){var t=e._id.charAt(0),a={x:"top",y:"right"}[t],o=e.side===a?1:-1,r=[-1,1,o,-o];return"inside"!==e.ticks==("x"===t)&&(r=r.map(function(e){return-e})),r},he.makeTransFn=function(e){var t=e._id.charAt(0),a=e._offset;return"x"===t?function(t){return"translate("+(a+e.l2p(t.x))+",0)"}:function(t){return"translate(0,"+(a+e.l2p(t.x))+")"}},he.makeTickPath=function(e,t,a,o){o=o===void 0?e.ticklen:o;var r=e._id.charAt(0),i=(e.linewidth||1)/2;return"x"===r?"M0,"+(t+i*a)+"v"+o*a:"M"+(t+i*a)+",0h"+o*a},he.makeLabelFns=function(e,t,a){var o=e._id.charAt(0),r=(e.linewidth||1)/2,i="boundaries"!==e.tickson&&"outside"===e.ticks,n=i?e.ticklen:0,l=0;if(a&&"outside"===e.ticks){var s=W.deg2rad(a);n=e.ticklen*te(s)+1,l=e.ticklen*M(s)}e.showticklabels&&(i||e.showline)&&(n+=.2*e.tickfont.size);var d={labelStandoff:n,labelShift:l},c,p,u,g;return"x"===o?(g="bottom"===e.side?1:-1,c=l*g,p=t+(n+r)*g,u="bottom"===e.side?1:-.2,d.labelXFn=function(e){return e.dx+c},d.labelYFn=function(e){return e.dy+p+e.fontSize*u},d.labelAnchorFn=function(e){return G(e)&&0!==e&&180!==e?0>e*g?"end":"start":"middle"}):"y"===o&&(g="right"===e.side?1:-1,c=n+r,p=-l*g,u=90===wa(e.tickangle)?.5:0,d.labelXFn=function(e){return e.dx+t+(c+e.fontSize*u)*g},d.labelYFn=function(e){return e.dy+p+e.fontSize*ue},d.labelAnchorFn=function(t){return G(t)&&90===wa(t)?"middle":"right"===e.side?"start":"end"}),d},he.drawTicks=function(e,t,a){a=a||{};var o=t._id+"tick",r=a.layer.selectAll("path."+o).data(t.ticks?a.vals:[],A);r.exit().remove(),r.enter().append("path").classed(o,1).classed("ticks",1).classed("crisp",!1!==a.crisp).call($.stroke,t.tickcolor).style("stroke-width",J.crispRound(e,t.tickwidth,1)+"px").attr("d",a.path),r.attr("transform",a.transFn)},he.drawGrid=function(e,t,a){a=a||{};var o=t._id+"grid",r=a.vals,n=a.counterAxis;if(!1===t.showgrid)r=[];else if(n&&he.shouldShowZeroLine(e,t,n))for(var l="array"===t.tickmode,s=0,d;s<r.length;s++)if(d=r[s].x,l?!d:wa(d)<t.dtick/100)if(r=r.slice(0,s).concat(r.slice(s+1)),l)s--;else break;var c=a.layer.selectAll("path."+o).data(r,A);c.exit().remove(),c.enter().append("path").classed(o,1).classed("crisp",!1!==a.crisp),t._gw=J.crispRound(e,t.gridwidth,1),c.attr("transform",a.transFn).attr("d",a.path).call($.stroke,t.gridcolor||"#ddd").style("stroke-width",t._gw+"px"),"function"==typeof a.path&&c.attr("d",a.path)},he.drawZeroLine=function(e,t,a){a=a||a;var o=t._id+"zl",r=he.shouldShowZeroLine(e,t,a.counterAxis),i=a.layer.selectAll("path."+o).data(r?[{x:0,id:t._id}]:[]);i.exit().remove(),i.enter().append("path").classed(o,1).classed("zl",1).classed("crisp",!1!==a.crisp).each(function(){a.layer.selectAll("path").sort(function(e,t){return ye.idSort(e.id,t.id)})}),i.attr("transform",a.transFn).attr("d",a.path).call($.stroke,t.zerolinecolor||$.defaultLine).style("stroke-width",J.crispRound(e,t.zerolinewidth,t._gw||1)+"px")},he.drawLabels=function(e,t,a){function o(e,a,o){var r=(e-1)*a;if("x"===l){if(-60>o||60<o)return-.5*r;if("top"===t.side)return-r}else{if(o*="left"===t.side?1:-1,-30>o)return-r;if(30>o)return-.5*r}return 0}function r(e,t){e.each(function(e){var r=H.select(this),i=r.select(".text-math-group"),n=u(t,e),l=a.transFn.call(r.node(),e)+(G(t)&&0!=+t?" rotate("+t+","+c(e)+","+(p(e)-e.fontSize/2)+")":""),s=o(X.lineCount(r),ge*e.fontSize,G(t)?+t:0);if(s&&(l+=" translate(0, "+s+")"),i.empty())r.select("text").attr({transform:l,"text-anchor":n});else{var d=J.bBox(i.node()).width,g=d*{end:-.5,start:.5}[n];i.attr("transform",l+(g?"translate("+g+",0)":""))}})}function i(){r(m,g);var e=null;if(d.length&&"x"===l&&!G(g)&&("log"!==t.type||"D"!==(t.dtick+"").charAt(0))){e=0;var o=0,n=[],c;if(m.each(function(e){o=va(o,e.fontSize);var a=t.l2p(e.x),r=D(this),i=J.bBox(r.node());n.push({top:0,bottom:10,height:10,left:a-i.width/2,right:a+i.width/2+2,width:i.width+2})}),("boundaries"===t.tickson||t.showdividers)&&!a.secondary){var p=2;for(t.ticks&&(p+=t.tickwidth/2),c=0;c<n.length;c++){var u=d[c].xbnd,h=n[c];if(null!==u[0]&&h.left-t.l2p(u[0])<p||null!==u[1]&&t.l2p(u[1])-h.right<p){e=90;break}}}else{var y=d.length,f=wa((d[y-1].x-d[0].x)*t._m)/(y-1),x=f<2.5*o||"multicategory"===t.type;for(c=0;c<n.length-1;c++)if(W.bBoxIntersect(n[c],n[c+1])){e=x?90:30;break}}e&&r(m,e)}t._tickAngles&&(t._tickAngles[s]=null===e?G(g)?g:0:e)}a=a||{};var n=t._id,l=n.charAt(0),s=a.cls||n+"tick",d=a.vals,c=a.labelXFn,p=a.labelYFn,u=a.labelAnchorFn,g=a.secondary?0:t.tickangle,h=(t._tickAngles||{})[s],m=a.layer.selectAll("g."+s).data(t.showticklabels?d:[],A),y=[];m.enter().append("g").classed(s,1).append("text").attr("text-anchor","middle").each(function(t){var a=H.select(this),o=e._promises.length;a.call(X.positionText,c(t),p(t)).call(J.font,t.font,t.fontSize,t.fontColor).text(t.text).call(X.convertToTspans,e),e._promises[o]?y.push(e._promises.pop().then(function(){r(a,g)})):r(a,g)}),m.exit().remove(),a.repositionOnUpdate&&m.each(function(e){H.select(this).select("text").call(X.positionText,c(e),p(e))}),r(m,h||g),t._selections&&(t._selections[s]=m);var f=W.syncOrAsync([function(){return y.length&&Promise.all(y)},i]);return f&&f.then&&e._promises.push(f),f},he.shouldShowZeroLine=function(e,t,a){var o=W.simpleMap(t.range,t.r2l);return 0>=o[0]*o[1]&&t.zeroline&&("linear"===t.type||"-"===t.type)&&t._gridVals.length&&(L(t,0)||!E(e,t,a,o)||I(e,t))},he.clipEnds=function(e,t){return t.filter(function(t){return L(e,t.x)})},he.allowAutoMargin=function(e){for(var t=he.list(e,"",!0),a=0,o;a<t.length;a++)o=t[a],o.automargin&&Y.allowAutoMargin(e,O(o)),q.getComponentMethod("rangeslider","isVisible")(o)&&Y.allowAutoMargin(e,j(o))},he.swap=function(e,t){for(var a=B(e,t),o=0;o<a.length;o++)N(e,a[o].x,a[o].y)}},{"../../components/color":569,"../../components/drawing":590,"../../components/titles":657,"../../constants/alignment":664,"../../constants/numerical":669,"../../lib":692,"../../lib/svg_text_utils":716,"../../plots/plots":804,"../../registry":823,"./autorange":739,"./axis_autotype":741,"./axis_ids":743,"./clean_ticks":745,"./layout_attributes":753,"./set_convert":759,d3:148,"fast-isnumeric":214}],741:[function(e,t){"use strict";function a(e){if(!e)return!1;for(var t=0;t<e.length;t++)if(n(e[t]))return!0;return!1}function o(e,t){for(var a=va(1,(e.length-1)/1e3),o=0,r=0,s={},d=0;d<e.length;d+=a){var c=e[R(d)],p=c+"";s[p]||(s[p]=1,l.isDateTime(c,t)&&(o+=1),n(c)&&(r+=1))}return o>2*r}function r(e){for(var t=va(1,(e.length-1)/1e3),a=0,o=0,r={},n=0;n<e.length;n+=t){var d=e[R(n)],c=d+"";r[c]||(r[c]=1,"boolean"==typeof d?o++:l.cleanNumber(d)===s?"string"==typeof d&&o++:a++)}return o>2*a}function i(e){return l.isArrayOrTypedArray(e[0])&&l.isArrayOrTypedArray(e[1])}var n=e("fast-isnumeric"),l=e("../../lib"),s=e("../../constants/numerical").BADNUM;t.exports=function(e,t,n){return n=n||{},!n.noMultiCategory&&i(e)?"multicategory":o(e,t)?"date":r(e)?"category":a(e)?"linear":"-"}},{"../../constants/numerical":669,"../../lib":692,"fast-isnumeric":214}],742:[function(e,t){"use strict";var a=e("../../registry"),o=e("../../lib"),r=e("./layout_attributes"),i=e("./tick_value_defaults"),n=e("./tick_mark_defaults"),l=e("./tick_label_defaults"),s=e("./category_order_defaults"),d=e("./line_grid_defaults"),c=e("./set_convert");t.exports=function(e,t,p,u,g){var h=u.letter,m=u.font||{},y=u.splomStash||{},f=p("visible",!u.cheateronly),x=t.type;if("date"===x){var b=a.getComponentMethod("calendars","handleDefaults");b(e,t,"calendar",u.calendar)}c(t,g);var _=p("autorange",!t.isValidRange(e.range));if(_&&("linear"===x||"-"===x)&&p("rangemode"),p("range"),t.cleanRange(),s(e,t,p,u),"category"===x||u.noHover||p("hoverformat"),!f)return t;var v=p("color"),w=v===r.color.dflt?m.color:v,k=y.label||g._dfltTitle[h];p("title.text",k),o.coerceFont(p,"title.font",{family:m.family,size:R(1.2*m.size),color:w}),i(e,t,p,x),l(e,t,p,x,u),n(e,t,p,u),d(e,t,p,{dfltColor:v,bgColor:u.bgColor,showGrid:u.showGrid,attributes:r}),(t.showline||t.ticks)&&p("mirror"),u.automargin&&p("automargin");var T="multicategory"===t.type;if(!u.noTickson&&("category"===t.type||T)&&(t.ticks||t.showgrid)){var A;T&&(A="boundaries"),p("tickson",A)}if(T){var S=p("showdividers");S&&(p("dividercolor"),p("dividerwidth"))}return t}},{"../../lib":692,"../../registry":823,"./category_order_defaults":744,"./layout_attributes":753,"./line_grid_defaults":755,"./set_convert":759,"./tick_label_defaults":760,"./tick_mark_defaults":761,"./tick_value_defaults":762}],743:[function(e,t,a){"use strict";var o=e("../../registry"),r=e("./constants");a.id2name=function(e){if("string"==typeof e&&e.match(r.AX_ID_PATTERN)){var t=e.substr(1);return"1"===t&&(t=""),e.charAt(0)+"axis"+t}},a.name2id=function(e){if(e.match(r.AX_NAME_PATTERN)){var t=e.substr(5);return"1"===t&&(t=""),e.charAt(0)+t}},a.cleanId=function(e,t){if(e.match(r.AX_ID_PATTERN)&&!(t&&e.charAt(0)!==t)){var a=e.substr(1).replace(/^0+/,"");return"1"===a&&(a=""),e.charAt(0)+a}},a.list=function(e,t,o){var r=e._fullLayout;if(!r)return[];var n=a.listIds(e,t),l=Array(n.length),s;for(s=0;s<n.length;s++){var d=n[s];l[s]=r[d.charAt(0)+"axis"+d.substr(1)]}if(!o){var c=r._subplots.gl3d||[];for(s=0;s<c.length;s++){var p=r[c[s]];t?l.push(p[t+"axis"]):l.push(p.xaxis,p.yaxis,p.zaxis)}}return l},a.listIds=function(e,t){var a=e._fullLayout;if(!a)return[];var o=a._subplots;return t?o[t+"axis"]:o.xaxis.concat(o.yaxis)},a.getFromId=function(e,t,o){var r=e._fullLayout;return"x"===o?t=t.replace(/y[0-9]*/,""):"y"==o&&(t=t.replace(/x[0-9]*/,"")),r[a.id2name(t)]},a.getFromTrace=function(e,t,r){var i=e._fullLayout,n=null;if(o.traceIs(t,"gl3d")){var l=t.scene;"scene"===l.substr(0,5)&&(n=i[l][r+"axis"])}else n=a.getFromId(e,t[r+"axis"]||r);return n},a.idSort=function(e,t){var a=e.charAt(0),o=t.charAt(0);return a===o?+(e.substr(1)||1)-+(t.substr(1)||1):a>o?1:-1}},{"../../registry":823,"./constants":746}],744:[function(e,t){"use strict";function a(e,t){var a=t.dataAttr||e._id.charAt(0),o={},r,n,l;if(t.axData)r=t.axData;else for(r=[],n=0;n<t.data.length;n++){var s=t.data[n];s[a+"axis"]===e._id&&r.push(s)}for(n=0;n<r.length;n++){var d=r[n][a];for(l=0;l<d.length;l++){var c=d[l];null!==c&&c!==void 0&&(o[c]=1)}}return Object.keys(o)}t.exports=function(e,t,o,r){if("category"===t.type){var i=e.categoryarray,n=Array.isArray(i)&&0<i.length,l;n&&(l="array");var s=o("categoryorder",l),d;"array"===s&&(d=o("categoryarray")),n||"array"!==s||(s=t.categoryorder="trace"),"trace"===s?t._initialCategories=[]:"array"===s?t._initialCategories=d.slice():(d=a(t,r).sort(),"category ascending"===s?t._initialCategories=d:"category descending"==s&&(t._initialCategories=d.reverse()))}}},{}],745:[function(e,t,a){"use strict";var o=e("fast-isnumeric"),r=e("../../lib"),i=e("../../constants/numerical").ONEDAY;a.dtick=function(e,t){var a="log"===t,r="date"===t,n=r?i:1;if(!e)return n;if(o(e))return e=+e,0>=e?n:"category"===t?va(1,R(e)):r?va(.1,e):e;if("string"!=typeof e||!(r||a))return n;var l=e.charAt(0),s=e.substr(1);return s=o(s)?+s:0,0>=s||!(r&&"M"===l&&s===R(s)||a&&"L"===l||a&&"D"===l&&(1===s||2===s))?n:e},a.tick0=function(e,t,a,i){return"date"===t?r.cleanDate(e,r.dateTick0(a)):"D1"===i||"D2"===i?void 0:o(e)?+e:0}},{"../../constants/numerical":669,"../../lib":692,"fast-isnumeric":214}],746:[function(e,t){"use strict";var a=e("../../lib/regex").counter;t.exports={idRegex:{x:a("x"),y:a("y")},attrRegex:a("[xy]axis"),xAxisMatch:a("xaxis"),yAxisMatch:a("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["heatmaplayer","contourcarpetlayer","contourlayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":708}],747:[function(e,t){"use strict";function a(e,t,a,o){var r=o[n(t)].type,l=[],s,d,c,p;for(d=0;d<a.length;d++)c=a[d],c===t||(p=o[n(c)],p.type===r&&!p.fixedrange&&l.push(c));for(s=0;s<e.length;s++)if(e[s][t]){var u=e[s],g=[];for(d=0;d<l.length;d++)c=l[d],u[c]||g.push(c);return{linkableAxes:g,thisGroup:u}}return{linkableAxes:l,thisGroup:null}}function o(e,t,a,o,r){var n,l,s,d,c;null===t?(t={},t[a]=1,c=e.length,e.push(t)):c=e.indexOf(t);var p=Object.keys(t);for(n=0;n<e.length;n++)if(s=e[n],n!==c&&s[o]){var u=s[o];for(l=0;l<p.length;l++)d=p[l],s[d]=u*r*t[d];return void e.splice(c,1)}if(1!==r)for(l=0;l<p.length;l++)t[p[l]]*=r;t[o]=1}var r=e("../../lib"),n=e("./axis_ids").id2name;t.exports=function(e,t,i,n,l){var s=l._axisConstraintGroups,d=t._id,c=d.charAt(0);if(!t.fixedrange&&(i("constrain"),r.coerce(e,t,{constraintoward:{valType:"enumerated",values:"x"===c?["left","center","right"]:["bottom","middle","top"],dflt:"x"===c?"center":"middle"}},"constraintoward"),!!e.scaleanchor)){var p=a(s,d,n,l),u=r.coerce(e,t,{scaleanchor:{valType:"enumerated",values:p.linkableAxes}},"scaleanchor");if(u){var g=i("scaleratio");g||(g=t.scaleratio=1),o(s,p.thisGroup,d,u,g)}else-1!==n.indexOf(e.scaleanchor)&&r.warn("ignored "+t._name+".scaleanchor: \""+e.scaleanchor+"\" to avoid either an infinite loop and possibly inconsistent scaleratios, or because the targetaxis has fixed range.")}}},{"../../lib":692,"./axis_ids":743}],748:[function(e,t,a){"use strict";function o(e,t){var a=e._inputDomain,o=d[e.constraintoward],r=a[0]+(a[1]-a[0])*o;e.domain=e._input.domain=[r+(a[0]-r)/t,r+(a[1]-r)/t],e.setScale()}var r=e("./axis_ids").id2name,i=e("./scale_zoom"),n=e("./autorange").makePadFn,l=e("./autorange").concatExtremes,s=e("../../constants/numerical").ALMOST_EQUAL,d=e("../../constants/alignment").FROM_BL;a.enforce=function(e){var t=e._fullLayout,a=t._axisConstraintGroups||[],d,c,p,u,g,h,y;for(d=0;d<a.length;d++){var f=a[d],x=Object.keys(f),b=1/0,_=0,v=1/0,w={},T={},A=!1;for(c=0;c<x.length;c++)p=x[c],T[p]=u=t[r(p)],u._inputDomain?u.domain=u._inputDomain.slice():u._inputDomain=u.domain.slice(),u._inputRange||(u._inputRange=u.range.slice()),u.setScale(),w[p]=g=wa(u._m)/f[p],b=ie(b,g),"domain"!==u.constrain&&u._constraintShrinkable||(v=ie(v,g)),delete u._constraintShrinkable,_=va(_,g),"domain"===u.constrain&&(A=!0);if(!(b>s*_)||A)for(c=0;c<x.length;c++)if(p=x[c],g=w[p],u=T[p],h=u.constrain,g!==v||"domain"===h)if(y=g/v,"range"===h)i(u,y);else{var S=u._inputDomain,C=(u.domain[1]-u.domain[0])/(S[1]-S[0]),L=(u.r2l(u.range[1])-u.r2l(u.range[0]))/(u.r2l(u._inputRange[1])-u.r2l(u._inputRange[0]));if(y/=C,1>y*L){u.domain=u._input.domain=S.slice(),i(u,y);continue}if(1>L&&(u.range=u._input.range=u._inputRange.slice(),y*=L),u.autorange){var E=u.r2l(u.range[0]),z=u.r2l(u.range[1]),I=(E+z)/2,D=I,P=I,O=wa(z-I),R=I-1.0001*(O*y),M=I+1.0001*(O*y),B=n(u);o(u,y);var F=wa(u._m),m=l(e,u),N=m.min,V=m.max,U,H;for(H=0;H<N.length;H++)U=N[H].val-B(N[H])/F,U>R&&U<D&&(D=U);for(H=0;H<V.length;H++)U=V[H].val+B(V[H])/F,U<M&&U>P&&(P=U);var G=(P-D)/(2*O);y/=G,D=u.l2r(D),P=u.l2r(P),u.range=u._input.range=E<z?[D,P]:[P,D]}o(u,y)}}},a.clean=function(e,t){if(t._inputDomain){for(var a=!1,o=t._id,r=e._fullLayout._axisConstraintGroups,i=0;i<r.length;i++)if(r[i][o]){a=!0;break}a&&"domain"===t.constrain||(t._input.domain=t.domain=t._inputDomain,delete t._inputDomain)}}},{"../../constants/alignment":664,"../../constants/numerical":669,"./autorange":739,"./axis_ids":743,"./scale_zoom":757}],749:[function(e,t){"use strict";function a(e,t,a,o){var r=C.ensureSingle(e.draglayer,t,a,function(t){t.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",e.id)});return r.call(R,o),r.node()}function o(e,t,o,r,i,n,l){var s=a(e,"rect",t,o);return k.select(s).call(I.setRect,r,i,n,l),s}function r(e,t){for(var a=0;a<e.length;a++)if(!e[a].fixedrange)return t;return""}function i(e,t){var a=e.range[t],o=wa(a-e.range[1-t]),r;return"date"===e.type?a:"log"===e.type?(r=ae(va(0,-P(o)/z))+3,k.format("."+r+"g")(_a(10,a))):(r=ea(P(wa(a))/z)-ea(P(o)/z)+4,k.format("."+(r+"g"))(a))}function n(e,t,a,o,r){var l,s,d,c;for(l=0;l<e.length;l++)s=e[l],s.fixedrange||(d=s._rl[0],c=s._rl[1]-d,s.range=[s.l2r(d+c*t),s.l2r(d+c*a)],o[s._name+".range[0]"]=s.range[0],o[s._name+".range[1]"]=s.range[1]);if(r&&r.length){var p=(t+(1-a))/2;n(r,p,1-p,o)}}function l(e,t){for(var a=0,o;a<e.length;a++)o=e[a],o.fixedrange||(o.range=[o.l2r(o._rl[0]-t/o._m),o.l2r(o._rl[1]-t/o._m)])}function s(e){return 1-(0<=e?ie(e,.9):1/(1/va(e,-.3)+3.222))}function d(e,t,a){return e?"nsew"===e?a?"":"pan"===t?"move":"crosshair":e.toLowerCase()+"-resize":"pointer"}function c(e,t,a,o,r){return e.append("path").attr("class","zoombox").style({fill:.2<t?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform","translate("+a+", "+o+")").attr("d",r+"Z")}function p(e,t,a){return e.append("path").attr("class","zoombox-corners").style({fill:E.background,stroke:E.defaultLine,"stroke-width":1,opacity:0}).attr("transform","translate("+t+", "+a+")").attr("d","M0,0Z")}function u(e,t,a,o,r,i){e.attr("d",o+"M"+a.l+","+a.t+"v"+a.h+"h"+a.w+"v-"+a.h+"h-"+a.w+"Z"),g(e,t,r,i)}function g(e,t,a,o){a||(e.transition().style("fill",.2<o?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),t.transition().style("opacity",1).duration(200))}function h(e){k.select(e).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function m(e){Z&&e.data&&e._context.showTips&&(C.notifier(C._(e,"Double-click to zoom back out"),"long"),Z=!1)}function y(e){return"lasso"===e||"select"===e}function f(e,t){return"M"+(e.l-.5)+","+(t-X-.5)+"h-3v"+(2*X+1)+"h3ZM"+(e.r+.5)+","+(t-X-.5)+"h3v"+(2*X+1)+"h-3Z"}function x(e,t){return"M"+(t-X-.5)+","+(e.t-.5)+"v-3h"+(2*X+1)+"v3ZM"+(t-X-.5)+","+(e.b+.5)+"v3h"+(2*X+1)+"v-3Z"}function b(e){var t=ea(ie(e.b-e.t,e.r-e.l,X)/2);return"M"+(e.l-3.5)+","+(e.t-.5+t)+"h3v"+-t+"h"+t+"v-3h-"+(t+3)+"ZM"+(e.r+3.5)+","+(e.t-.5+t)+"h-3v"+-t+"h"+-t+"v-3h"+(t+3)+"ZM"+(e.r+3.5)+","+(e.b+.5-t)+"h-3v"+t+"h"+-t+"v3h"+(t+3)+"ZM"+(e.l-3.5)+","+(e.b+.5-t)+"h3v"+t+"h"+t+"v3h-"+(t+3)+"Z"}function _(e,t,a){for(var o=e._fullLayout._axisConstraintGroups,r=!1,n={},l={},s=0,d,c,p,u,g;s<o.length;s++){for(d in g=o[s],t)if(g[d]){for(p in g)("x"===p.charAt(0)?t:a)[p]||(n[p]=1);for(c in a)g[c]&&(r=!0)}for(c in a)if(g[c])for(u in g)("x"===u.charAt(0)?t:a)[u]||(l[u]=1)}r&&(C.extendFlat(n,l),l={});var h={},m=[];for(p in n){var y=V(e,p);m.push(y),h[y._id]=y}var f={},x=[];for(u in l){var b=V(e,u);x.push(b),f[b._id]=b}return{xaHash:h,yaHash:f,xaxes:m,yaxes:x,isSubplotConstrained:r}}function v(e,t){if(!A)void 0===e.onwheel?void 0!==e.onmousewheel&&(e.onmousewheel=t):e.onwheel=t;else{var a=e.onwheel===void 0?"mousewheel":"wheel";e._onwheel&&e.removeEventListener(a,e._onwheel),e._onwheel=t,e.addEventListener(a,t,{passive:!1})}}function w(e){var t=[];for(var a in e)t.push(e[a]);return t}var k=e("d3"),T=e("tinycolor2"),A=e("has-passive-events"),S=e("../../registry"),C=e("../../lib"),L=e("../../lib/svg_text_utils"),E=e("../../components/color"),I=e("../../components/drawing"),D=e("../../components/fx"),O=e("./axes"),R=e("../../lib/setcursor"),M=e("../../components/dragelement"),j=e("../../constants/alignment").FROM_TL,B=e("../../lib/clear_gl_canvases"),F=e("../../plot_api/subroutines").redrawReglTraces,N=e("../plots"),V=e("./axis_ids").getFromId,U=e("./select").prepSelect,H=e("./select").clearSelect,G=e("./select").selectOnClick,Y=e("./scale_zoom"),q=e("./constants"),W=q.MINDRAG,X=q.MINZOOM,Z=!0;t.exports={makeDragBox:function(t,e,a,g,A,E,z,P){function R(){if(ge=e.xaxis,he=e.yaxis,ve=ge._length,we=he._length,be=ge._offset,_e=he._offset,me={},me[ge._id]=ge,ye={},ye[he._id]=he,z&&P)for(var a=e.overlays,o=0,n;o<a.length;o++){n=a[o].xaxis,me[n._id]=n;var l=a[o].yaxis;ye[l._id]=l}fe=w(me),xe=w(ye),Te=r(fe,P),Ae=r(xe,z),Se=!Ae&&!Te,ke=_(t,me,ye),Ce=ke.isSubplotConstrained,Le=P||Ce,Ee=z||Ce;var s=t._fullLayout;ze=s._has("scattergl"),Ie=s._has("splom"),De=s._has("svg")}function Z(){Me.plotinfo.selection=!1,H(ce)}function $(a,o){var r=t._fullLayout.clickmode;if(h(t),2!==a||ue||oe(),pe)-1<r.indexOf("select")&&G(o,t,fe,xe,e.id,Me),-1<r.indexOf("event")&&D.click(t,o,e.id);else if(1===a&&ue){var n=z?he:ge,l="s"===z||"w"===P?0:1,s=n._name+".range["+l+"]",d=i(n,l),c="left",p="middle";if(n.fixedrange)return;z?(p="n"===z?"top":"bottom","right"===n.side&&(c="right")):"e"===P&&(c="right"),t._context.showAxisRangeEntryBoxes&&k.select(Re).call(L.makeEditable,{gd:t,immediate:!0,background:t._fullLayout.paper_bgcolor,text:d+"",fill:n.tickfont?n.tickfont.color:"#444",horizontalAlign:c,verticalAlign:p}).on("edit",function(e){var a=n.d2r(e);void 0!==a&&S.call("_guiRelayout",t,s,a)})}}function J(a,e,o){var r=Re.getBoundingClientRect();Ve=e-r.left,Ue=o-r.top,He={l:Ve,r:Ve,w:0,t:Ue,b:Ue,h:0},Ge=t._hmpixcount?t._hmlumcount/t._hmpixcount:T(t._fullLayout.plot_bgcolor).getLuminance(),Ye="M0,0H"+ve+"V"+we+"H0V0",qe=!1,We="xy",$e=!1,Xe=c(ce,Ge,be,_e,Ye),Ze=p(ce,be,_e)}function K(e,a){function o(){We="",He.r=He.l,He.t=He.b,Ze.attr("d","M0,0Z")}if(t._transitioningWithDuration)return!1;var r=va(0,ie(ve,e+Ve)),i=va(0,ie(we,a+Ue)),n=wa(r-Ve),l=wa(i-Ue);He.l=ie(Ve,r),He.r=va(Ve,r),He.t=ie(Ue,i),He.b=va(Ue,i),Ce?n>X||l>X?(We="xy",n/ve>l/we?(l=n*we/ve,Ue>i?He.t=Ue-l:He.b=Ue+l):(n=l*ve/we,Ve>r?He.l=Ve-n:He.r=Ve+n),Ze.attr("d",b(He))):o():!Ae||l<ie(va(.6*n,W),X)?n<W||!Te?o():(He.t=0,He.b=we,We="x",Ze.attr("d",f(He,Ue))):!Te||n<ie(.6*l,X)?(He.l=0,He.r=ve,We="y",Ze.attr("d",x(He,Ve))):(We="xy",Ze.attr("d",b(He))),He.w=He.r-He.l,He.h=He.b-He.t,We&&($e=!0),t._dragged=$e,u(Xe,Ze,He,Ye,qe,Ge),qe=!0}function Q(){return Pe={},ie(He.h,He.w)<2*W?h(t):void(("xy"==We||"x"==We)&&n(fe,He.l/ve,He.r/ve,Pe,ke.xaxes),("xy"==We||"y"==We)&&n(xe,(we-He.b)/we,(we-He.t)/we,Pe,ke.yaxes),h(t),re(),m(t))}function ee(a){function e(e,t,a){function o(t){return e.l2r(i+(t-i)*a)}if(!e.fixedrange){var r=C.simpleMap(e.range,e.r2l),i=r[0]+(r[1]-r[0])*t;e.range=r.map(o)}}if(t._context.scrollZoom||t._fullLayout._enablescrollzoom){if(Z(),t._transitioningWithDuration)return a.preventDefault(),void a.stopPropagation();var o=t.querySelector(".plotly");if(R(),!(10<o.scrollHeight-o.clientHeight||10<o.scrollWidth-o.clientWidth)){clearTimeout(Be);var r=-a.deltaY;if(isFinite(r)||(r=a.wheelDelta/10),!isFinite(r))return void C.log("Did not find wheel motion attributes: ",a);var n=ka(-ie(va(r,-20),20)/200),l=Ne.draglayer.select(".nsewdrag").node().getBoundingClientRect(),s=(a.clientX-l.left)/l.width,d=(l.bottom-a.clientY)/l.height,c;if(Le){for(P||(s=.5),c=0;c<fe.length;c++)e(fe[c],s,n);je[2]*=n,je[0]+=je[2]*s*(1/n-1)}if(Ee){for(z||(d=.5),c=0;c<xe.length;c++)e(xe[c],d,n);je[3]*=n,je[1]+=je[3]*(1-d)*(1/n-1)}return ne(je),ae(z,P),Be=setTimeout(function(){je=[0,0,ve,we],re()},Fe),void a.preventDefault()}}}function te(e,a){function o(e,t,a){for(var o=1-t,r=0,n,l,d;r<e.length;r++)if(d=e[r],!d.fixedrange){n=d,l=d._rl[o]+(d._rl[t]-d._rl[o])/s(a/d._length);var c=d.l2r(l);!1!==c&&void 0!==c&&(d.range[t]=c)}return n._length*(n._rl[t]-l)/(n._rl[t]-n._rl[o])}if(!t._transitioningWithDuration){if(t._fullLayout._replotting=!0,"ew"===Te||"ns"===Ae)return Te&&l(fe,e),Ae&&l(xe,a),ne([Te?-e:0,Ae?-a:0,ve,we]),void ae(Ae,Te);if(Ce&&Te&&Ae){var r="w"===Te==("n"===Ae)?1:-1,n=(e/ve+r*a/we)/2;e=n*ve,a=r*n*we}"w"===Te?e=o(fe,0,e):"e"===Te?e=o(fe,1,-e):!Te&&(e=0),"n"===Ae?a=o(xe,1,a):"s"===Ae?a=o(xe,0,-a):!Ae&&(a=0);var d="w"===Te?e:0,c="n"===Ae?a:0;if(Ce){var p;if(!Te&&1===Ae.length){for(p=0;p<fe.length;p++)fe[p].range=fe[p]._r.slice(),Y(fe[p],1-a/we);e=a*ve/we,d=e/2}if(!Ae&&1===Te.length){for(p=0;p<xe.length;p++)xe[p].range=xe[p]._r.slice(),Y(xe[p],1-e/ve);a=e*we/ve,c=a/2}}ne([d,c,ve-e,we-a]),ae(Ae,Te)}}function ae(e,a){function o(e){for(l=0;l<e.length;l++)e[l].fixedrange||n.push(e[l]._id)}function r(o,r,i){for(l=0;l<o.length;l++){var s=o[l];if((a&&-1!==n.indexOf(s.xref)||e&&-1!==n.indexOf(s.yref))&&(r(t,l),i))return}}var n=[],l;for(Le&&(o(fe),o(ke.xaxes)),Ee&&(o(xe),o(ke.yaxes)),Pe={},l=0;l<n.length;l++){var s=n[l],d=V(t,s);O.drawOne(t,d,{skipTitle:!0}),Pe[d._name+".range[0]"]=d.range[0],Pe[d._name+".range[1]"]=d.range[1]}r(t._fullLayout.annotations||[],S.getComponentMethod("annotations","drawOne")),r(t._fullLayout.shapes||[],S.getComponentMethod("shapes","drawOne")),r(t._fullLayout.images||[],S.getComponentMethod("images","draw"),!0)}function oe(){if(!t._transitioningWithDuration){var e=t._context.doubleClick,a=(Te?fe:[]).concat(Ae?xe:[]),o={},r,n,l;if("reset+autosize"===e)for(e="autosize",n=0;n<a.length;n++)if(r=a[n],r._rangeInitial&&(r.range[0]!==r._rangeInitial[0]||r.range[1]!==r._rangeInitial[1])||!r._rangeInitial&&!r.autorange){e="reset";break}if("autosize"===e)for(n=0;n<a.length;n++)r=a[n],r.fixedrange||(o[r._name+".autorange"]=!0);else if("reset"===e)for((Te||Ce)&&(a=a.concat(ke.xaxes)),Ae&&!Ce&&(a=a.concat(ke.yaxes)),Ce&&(Te?!Ae&&(a=a.concat(xe)):a=a.concat(fe)),n=0;n<a.length;n++)r=a[n],r.fixedrange||(r._rangeInitial?(l=r._rangeInitial,o[r._name+".range[0]"]=l[0],o[r._name+".range[1]"]=l[1]):o[r._name+".autorange"]=!0);t.emit("plotly_doubleclick",null),S.call("_guiRelayout",t,o)}}function re(){ne([0,0,ve,we]),C.syncOrAsync([N.previousPromises,function(){t._fullLayout._replotting=!1,S.call("_guiRelayout",t,Pe)}],t)}function ne(e){var a=t._fullLayout,o=a._plots,r=a._subplots.cartesian,n,l,s,d;if(Ie&&S.subplotsRegistry.splom.drag(t),ze)for(n=0;n<r.length;n++)if(l=o[r[n]],s=l.xaxis,d=l.yaxis,l._scene){var c=C.simpleMap(s.range,s.r2l),p=C.simpleMap(d.range,d.r2l);l._scene.update({range:[c[0],p[0],c[1],p[1]]})}if((Ie||ze)&&(B(t),F(t)),De){var u=e[2]/ge._length,g=e[3]/he._length;for(n=0;n<r.length;n++){l=o[r[n]],s=l.xaxis,d=l.yaxis;var h=Le&&!s.fixedrange&&me[s._id],m=Ee&&!d.fixedrange&&ye[d._id],y,f,x,b;if(h?(y=u,x=P?e[0]:de(s,y)):(y=le(s,u,g),x=se(s,y)),m?(f=g,b=z?e[1]:de(d,f)):(f=le(d,u,g),b=se(d,f)),y||f){y||(y=1),f||(f=1);var _=s._offset-x/y,v=d._offset-b/f;l.clipRect.call(I.setTranslate,x,b).call(I.setScale,y,f),l.plot.call(I.setTranslate,_,v).call(I.setScale,1/y,1/f),(y!==Je||f!==Ke)&&(I.setPointGroupScale(l.zoomScalePts,y,f),I.setTextPointsScale(l.zoomScaleTxt,y,f)),I.hideOutsideRangePoints(l.clipOnAxisFalseTraces,l),Je=y,Ke=f}}}}function le(e,t,a){return e.fixedrange?0:Le&&ke.xaHash[e._id]?t:Ee&&(Ce?ke.xaHash:ke.yaHash)[e._id]?a:0}function se(e,t){return t?(e.range=e._r.slice(),Y(e,t),de(e,t)):0}function de(e,t){return e._length*(1-t)*j[e.constraintoward||"middle"]}var ce=t._fullLayout._zoomlayer,pe="nsew"===z+P,ue=1===(z+P).length,ge,he,me,ye,fe,xe,be,_e,ve,we,ke,Te,Ae,Se,Ce,Le,Ee,ze,Ie,De,Pe;R();var Oe=d(Ae+Te,t._fullLayout.dragmode,pe),Re=o(e,z+P+"drag",Oe,a,g,A,E);if(Se&&!pe)return Re.onmousedown=null,Re.style.pointerEvents="none",Re;var Me={element:Re,gd:t,plotinfo:e};Me.prepFn=function(a,e,o){var r=Me.dragmode,i=t._fullLayout.dragmode;i!==r&&(Me.dragmode=i),R(),Se||(pe?a.shiftKey?"pan"===i?i="zoom":!y(i)&&(i="pan"):a.ctrlKey&&(i="pan"):i="pan"),Me.minDrag="lasso"===i?1:void 0,y(i)?(Me.xaxes=fe,Me.yaxes=xe,U(a,e,o,Me,i)):(Me.clickFn=$,y(r)&&Z(),!Se&&("zoom"===i?(Me.moveFn=K,Me.doneFn=Q,Me.minDrag=1,J(a,e,o)):"pan"===i&&(Me.moveFn=te,Me.doneFn=re)))},M.init(Me);var je=[0,0,ve,we],Be=null,Fe=q.REDRAWDELAY,Ne=e.mainplot?t._fullLayout._plots[e.mainplot]:e,Ve,Ue,He,Ge,Ye,qe,We,Xe,Ze,$e;1!=z.length*P.length&&v(Re,ee);var Je,Ke;return Re},makeDragger:a,makeRectDragger:o,makeZoombox:c,makeCorners:p,updateZoombox:u,xyCorners:b,transitionZoombox:g,removeZoombox:h,showDoubleClickNotifier:m,attachWheelEventHandler:v}},{"../../components/color":569,"../../components/dragelement":587,"../../components/drawing":590,"../../components/fx":608,"../../constants/alignment":664,"../../lib":692,"../../lib/clear_gl_canvases":677,"../../lib/setcursor":712,"../../lib/svg_text_utils":716,"../../plot_api/subroutines":731,"../../registry":823,"../plots":804,"./axes":740,"./axis_ids":743,"./constants":746,"./scale_zoom":757,"./select":758,d3:148,"has-passive-events":394,tinycolor2:513}],750:[function(e,t,a){"use strict";var o=e("d3"),r=e("../../components/fx"),i=e("../../components/dragelement"),n=e("../../lib/setcursor"),l=e("./dragbox").makeDragBox,s=e("./constants").DRAGGERSIZE;a.initInteractions=function(e){var t=e._fullLayout;if(e._context.staticPlot)return void o.select(e).selectAll(".drag").remove();if(t._has("cartesian")||t._has("splom")){var n=Object.keys(t._plots||{}).sort(function(e,a){if((t._plots[e].mainplot&&!0)===(t._plots[a].mainplot&&!0)){var o=e.split("y"),r=a.split("y");return o[0]===r[0]?+(o[1]||1)-+(r[1]||1):+(o[0]||1)-+(r[0]||1)}return t._plots[e].mainplot?1:-1});n.forEach(function(a){var o=t._plots[a],n=o.xaxis,d=o.yaxis;if(!o.mainplot){var c=l(e,o,n._offset,d._offset,n._length,d._length,"ns","ew");c.onmousemove=function(t){e._fullLayout._rehover=function(){e._fullLayout._hoversubplot===a&&r.hover(e,t,a)},r.hover(e,t,a),e._fullLayout._lasthover=c,e._fullLayout._hoversubplot=a},c.onmouseout=function(t){e._dragging||(e._fullLayout._hoversubplot=null,i.unhover(e,t))},e._context.showAxisDragHandles&&(l(e,o,n._offset-s,d._offset-s,s,s,"n","w"),l(e,o,n._offset+n._length,d._offset-s,s,s,"n","e"),l(e,o,n._offset-s,d._offset+d._length,s,s,"s","w"),l(e,o,n._offset+n._length,d._offset+d._length,s,s,"s","e"))}if(e._context.showAxisDragHandles){if(a===n._mainSubplot){var p=n._mainLinePosition;"top"===n.side&&(p-=s),l(e,o,n._offset+.1*n._length,p,.8*n._length,s,"","ew"),l(e,o,n._offset,p,.1*n._length,s,"","w"),l(e,o,n._offset+.9*n._length,p,.1*n._length,s,"","e")}if(a===d._mainSubplot){var u=d._mainLinePosition;"right"!==d.side&&(u-=s),l(e,o,u,d._offset+.1*d._length,s,.8*d._length,"ns",""),l(e,o,u,d._offset+.9*d._length,s,.1*d._length,"s",""),l(e,o,u,d._offset,s,.1*d._length,"n","")}}});var d=t._hoverlayer.node();d.onmousemove=function(a){a.target=e._fullLayout._lasthover,r.hover(e,a,t._hoversubplot)},d.onclick=function(t){t.target=e._fullLayout._lasthover,r.click(e,t)},d.onmousedown=function(t){e._fullLayout._lasthover.onmousedown(t)},a.updateFx(e)}},a.updateFx=function(e){var t=e._fullLayout,a="pan"===t.dragmode?"move":"crosshair";n(t._draggers,a)}},{"../../components/dragelement":587,"../../components/fx":608,"../../lib/setcursor":712,"./constants":746,"./dragbox":749,d3:148}],751:[function(e,t){"use strict";var a=e("../../registry"),o=e("../../lib");t.exports=function(e){return function(t,r){var n=t[e];if(Array.isArray(n))for(var l=a.subplotsRegistry.cartesian,s=l.idRegex,d=r._subplots,c=d.xaxis,p=d.yaxis,u=d.cartesian,g=r._has("cartesian")||r._has("gl2d"),h=0,m;h<n.length;h++)if(m=n[h],o.isPlainObject(m)){var y=m.xref,f=m.yref,x=s.x.test(y),b=s.y.test(f);if(x||b){g||o.pushUnique(r._basePlotModules,l);var _=!1;x&&-1===c.indexOf(y)&&(c.push(y),_=!0),b&&-1===p.indexOf(f)&&(p.push(f),_=!0),_&&x&&b&&u.push(y+f)}}}}},{"../../lib":692,"../../registry":823}],752:[function(e,t,a){"use strict";function o(e,t,a){return p.ensureSingle(e,t,a,function(e){e.datum(a)})}function r(e,t,a,o,r){for(var n=y.traceLayerClasses,l=e._fullLayout,s=l._modules,p=[],u=[],m=0,f,x,b;m<s.length;m++){f=s[m];var _=f.name,v=d.modules[_].categories;if(v.svg){var w=f.layerName||_+"layer",k=f.plot;x=h(a,k),b=x[0],a=x[1],b.length&&p.push({i:n.indexOf(w),className:w,plotMethod:k,cdModule:b}),v.zoomScale&&u.push("."+w)}}p.sort(function(e,t){return e.i-t.i});var T=t.plot.selectAll("g.mlayer").data(p,function(e){return e.className});if(T.enter().append("g").attr("class",function(e){return e.className}).classed("mlayer",!0),T.exit().remove(),T.order(),T.each(function(a){var i=c.select(this),n=a.className;a.plotMethod(e,t,a.cdModule,i,o,r),"scatterlayer"!==n&&"barlayer"!==n&&g.setClipUrl(i,t.layerClipId,e)}),l._has("scattergl")&&(f=d.getModule("scattergl"),b=h(a,f)[0],f.plot(e,t,b)),!e._context.staticPlot&&(t._hasClipOnAxisFalse&&(t.clipOnAxisFalseTraces=t.plot.selectAll(".scatterlayer, .barlayer").selectAll(".trace")),u.length)){var A=t.plot.selectAll(u.join(",")).selectAll(".trace");t.zoomScalePts=A.selectAll("path.point"),t.zoomScaleTxt=A.selectAll(".textpoint")}}function i(e){var t=e._fullLayout,a=t._subplots.cartesian,o=a.length,r=[],n=[],l,s,c,p,u,g;for(l=0;l<o;l++){c=a[l],p=t._plots[c],u=p.xaxis,g=p.yaxis;var h=u._mainAxis,m=g._mainAxis,y=h._id+m._id,f=t._plots[y];p.overlays=[],y!==c&&f?(p.mainplot=y,p.mainplotinfo=f,n.push(c)):(p.mainplot=void 0,p.mainPlotinfo=void 0,r.push(c))}for(l=0;l<n.length;l++)c=n[l],p=t._plots[c],p.mainplotinfo.overlays.push(p);var x=r.concat(n),b=Array(o);for(l=0;l<o;l++){c=x[l],p=t._plots[c],u=p.xaxis,g=p.yaxis;var _=[c,u.layer,g.layer,u.overlaying||"",g.overlaying||""];for(s=0;s<p.overlays.length;s++)_.push(p.overlays[s].id);b[l]=_}return b}function n(e,t){var a=t.plotgroup,r=t.id,i=y.layerValue2layerClass[t.xaxis.layer],n=y.layerValue2layerClass[t.yaxis.layer],l=e._fullLayout._hasOnlyLargeSploms;if(!!t.mainplot){var s=t.mainplotinfo,d=s.plotgroup,c=r+"-x",p=r+"-y";t.gridlayer=s.gridlayer,t.zerolinelayer=s.zerolinelayer,x(s.overlinesBelow,"path",c),x(s.overlinesBelow,"path",p),x(s.overaxesBelow,"g",c),x(s.overaxesBelow,"g",p),t.plot=x(s.overplot,"g",r),x(s.overlinesAbove,"path",c),x(s.overlinesAbove,"path",p),x(s.overaxesAbove,"g",c),x(s.overaxesAbove,"g",p),t.xlines=d.select(".overlines-"+i).select("."+c),t.ylines=d.select(".overlines-"+n).select("."+p),t.xaxislayer=d.select(".overaxes-"+i).select("."+c),t.yaxislayer=d.select(".overaxes-"+n).select("."+p)}else if(l)t.xlines=x(a,"path","xlines-above"),t.ylines=x(a,"path","ylines-above"),t.xaxislayer=x(a,"g","xaxislayer-above"),t.yaxislayer=x(a,"g","yaxislayer-above");else{var u=x(a,"g","layer-subplot");t.shapelayer=x(u,"g","shapelayer"),t.imagelayer=x(u,"g","imagelayer"),t.gridlayer=x(a,"g","gridlayer"),t.zerolinelayer=x(a,"g","zerolinelayer"),x(a,"path","xlines-below"),x(a,"path","ylines-below"),t.overlinesBelow=x(a,"g","overlines-below"),x(a,"g","xaxislayer-below"),x(a,"g","yaxislayer-below"),t.overaxesBelow=x(a,"g","overaxes-below"),t.plot=x(a,"g","plot"),t.overplot=x(a,"g","overplot"),t.xlines=x(a,"path","xlines-above"),t.ylines=x(a,"path","ylines-above"),t.overlinesAbove=x(a,"g","overlines-above"),x(a,"g","xaxislayer-above"),x(a,"g","yaxislayer-above"),t.overaxesAbove=x(a,"g","overaxes-above"),t.xlines=a.select(".xlines-"+i),t.ylines=a.select(".ylines-"+n),t.xaxislayer=a.select(".xaxislayer-"+i),t.yaxislayer=a.select(".yaxislayer-"+n)}l||(o(t.gridlayer,"g",t.xaxis._id),o(t.gridlayer,"g",t.yaxis._id),t.gridlayer.selectAll("g").map(function(e){return e[0]}).sort(m.idSort)),t.xlines.style("fill","none").classed("crisp",!0),t.ylines.style("fill","none").classed("crisp",!0)}function l(e,t){if(e){var a={};for(var o in e.each(function(e){var o=e[0],r=c.select(this);r.remove(),s(o,t),a[o]=!0}),t._plots)for(var r=t._plots[o],i=r.overlays||[],n=0,l;n<i.length;n++)l=i[n],a[l.id]&&l.plot.selectAll(".trace").remove()}}function s(e,t){t._draggers.selectAll("g."+e).remove(),t._defs.select("#clip"+t._uid+e+"plot").remove()}var c=e("d3"),d=e("../../registry"),p=e("../../lib"),u=e("../plots"),g=e("../../components/drawing"),h=e("../get_data").getModuleCalcData,m=e("./axis_ids"),y=e("./constants"),f=e("../../constants/xmlns_namespaces"),x=p.ensureSingle;a.name="cartesian",a.attr=["xaxis","yaxis"],a.idRoot=["x","y"],a.idRegex=y.idRegex,a.attrRegex=y.attrRegex,a.attributes=e("./attributes"),a.layoutAttributes=e("./layout_attributes"),a.supplyLayoutDefaults=e("./layout_defaults"),a.transitionAxes=e("./transition_axes"),a.finalizeSubplots=function(e,t){var a=t._subplots,o=a.xaxis,r=a.yaxis,n=a.cartesian,l=n.concat(a.gl2d||[]),s={},d={},c,u,g;for(c=0;c<l.length;c++){var h=l[c].split("y");s[h[0]]=1,d["y"+h[1]]=1}for(c=0;c<o.length;c++)u=o[c],s[u]||(g=(e[m.id2name(u)]||{}).anchor,!y.idRegex.y.test(g)&&(g="y"),n.push(u+g),l.push(u+g),!d[g]&&(d[g]=1,p.pushUnique(r,g)));for(c=0;c<r.length;c++)g=r[c],d[g]||(u=(e[m.id2name(g)]||{}).anchor,!y.idRegex.x.test(u)&&(u="x"),n.push(u+g),l.push(u+g),!s[u]&&(s[u]=1,p.pushUnique(o,u)));if(!l.length){for(var f in u="",g="",e)if(y.attrRegex.test(f)){var x=f.charAt(0);"x"===x?(!u||+f.substr(5)<+u.substr(5))&&(u=f):(!g||+f.substr(5)<+g.substr(5))&&(g=f)}u=u?m.name2id(u):"x",g=g?m.name2id(g):"y",o.push(u),r.push(g),n.push(u+g)}},a.plot=function(e,t,a,o){var n=e._fullLayout,l=n._subplots.cartesian,s=e.calcdata,d;if(null!==t){if(!Array.isArray(t))for(t=[],d=0;d<s.length;d++)t.push(d);for(d=0;d<l.length;d++){for(var c=l[d],p=n._plots[c],u=[],g=0,h;g<s.length;g++){var m=s[g],y=m[0].trace;y.xaxis+y.yaxis===c&&((-1!==t.indexOf(y.index)||y.carpet)&&(h&&h[0].trace.xaxis+h[0].trace.yaxis===c&&-1!==["tonextx","tonexty","tonext"].indexOf(y.fill)&&-1===u.indexOf(h)&&u.push(h),u.push(m)),h=m)}r(e,p,u,a,o)}}},a.clean=function(e,t,a,o){var r=o._plots||{},n=t._plots||{},d=o._subplots||{},c,p,u;if(o._hasOnlyLargeSploms&&!t._hasOnlyLargeSploms)for(u in r)c=r[u],c.plotgroup&&c.plotgroup.remove();var g=o._has&&o._has("gl"),h=t._has&&t._has("gl");if(g&&!h)for(u in r)c=r[u],c._scene&&c._scene.destroy();if(d.xaxis&&d.yaxis){var y=m.listIds({_fullLayout:o});for(p=0;p<y.length;p++){var f=y[p];t[m.id2name(f)]||o._infolayer.selectAll(".g-"+f+"title").remove()}}var x=o._has&&o._has("cartesian"),b=t._has&&t._has("cartesian");if(x&&!b)l(o._cartesianlayer.selectAll(".subplot"),o),o._defs.selectAll(".axesclip").remove(),delete o._axisConstraintGroups;else if(d.cartesian)for(p=0;p<d.cartesian.length;p++){var _=d.cartesian[p];if(!n[_]){o._cartesianlayer.selectAll("."+_+",."+_+"-x,."+_+"-y").remove(),s(_,o)}}},a.drawFramework=function(e){var t=e._fullLayout,a=i(e),o=t._cartesianlayer.selectAll(".subplot").data(a,String);o.enter().append("g").attr("class",function(e){return"subplot "+e[0]}),o.order(),o.exit().call(l,t),o.each(function(a){var o=a[0],r=t._plots[o];r.plotgroup=c.select(this),n(e,r),r.draglayer=x(t._draggers,"g",o)})},a.rangePlot=function(e,t,a){n(e,t),r(e,t,a),u.style(e)},a.toSVG=function(e){var t=e._fullLayout._glimages,a=c.select(e).selectAll(".svg-container"),o=a.filter(function(e,t){return t===a.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");o.each(function(){var e=this,a=e.toDataURL("image/png"),o=t.append("svg:image");o.attr({xmlns:f.svg,"xlink:href":a,preserveAspectRatio:"none",x:0,y:0,width:e.width,height:e.height})})},a.updateFx=e("./graph_interact").updateFx},{"../../components/drawing":590,"../../constants/xmlns_namespaces":670,"../../lib":692,"../../registry":823,"../get_data":777,"../plots":804,"./attributes":738,"./axis_ids":743,"./constants":746,"./graph_interact":750,"./layout_attributes":753,"./layout_defaults":754,"./transition_axes":763,d3:148}],753:[function(e,t){"use strict";var a=e("../font_attributes"),o=e("../../components/color/attributes"),r=e("../../components/drawing/attributes").dash,i=e("../../lib/extend").extendFlat,n=e("../../plot_api/plot_template").templatedArray,l=e("./constants");t.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:o.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:a({editType:"ticks"}),editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1}}],editType:"axrange",impliedEdits:{autorange:!1}},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],dflt:"range",editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:o.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"boolean",dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:i({},r,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor"],dflt:"data",editType:"none"},tickfont:a({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks"},tickformatstops:n("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none"},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:o.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:o.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:o.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:o.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:a({editType:"ticks"})}}},{"../../components/color/attributes":568,"../../components/drawing/attributes":589,"../../lib/extend":682,"../../plot_api/plot_template":730,"../font_attributes":767,"./constants":746}],754:[function(e,t){"use strict";function a(e,t,a){Array.isArray(e[t])?e[t].push(a):e[t]=[a]}var o=e("../../lib"),r=e("../../components/color"),n=e("../../plot_api/plot_template"),l=e("../layout_attributes"),s=e("./layout_attributes"),d=e("./type_defaults"),c=e("./axis_defaults"),p=e("./constraint_defaults"),u=e("./position_defaults"),g=e("./axis_ids"),h=g.id2name,m=g.name2id,y=e("../../registry"),f=y.traceIs,x=y.getComponentMethod;t.exports=function(e,t,g){function y(e,t){return o.coerce(Y,q,s,e,t)}function b(e,t){return o.coerce2(Y,q,s,e,t)}function _(e){return"x"===e?R:O}function v(t,a){for(var o="x"===t?M:B,r=[],i=0,n;i<o.length;i++)n=o[i],n===a||(e[n]||{}).overlaying||r.push(m(n));return r}var w={},k={},T={},A={},S={},C,L;for(C=0;C<g.length;C++){var E=g[C];if(f(E,"cartesian")||f(E,"gl2d")){var z;if(E.xaxis)z=h(E.xaxis),a(w,z,E);else if(E.xaxes)for(L=0;L<E.xaxes.length;L++)a(w,h(E.xaxes[L]),E);var I;if(E.yaxis)I=h(E.yaxis),a(w,I,E);else if(E.yaxes)for(L=0;L<E.yaxes.length;L++)a(w,h(E.yaxes[L]),E);if(f(E,"carpet")&&("carpet"!==E.type||E._cheater)||!z||(T[z]=1),"carpet"===E.type&&E._cheater&&z&&(k[z]=1),f(E,"2dMap")&&(A[z]=1,A[I]=1),f(E,"oriented")){var D="h"===E.orientation?I:z;S[D]=1}}}var P=t._subplots,O=P.xaxis,R=P.yaxis,M=o.simpleMap(O,h),B=o.simpleMap(R,h),F=M.concat(B),N=r.background;O.length&&R.length&&(N=o.coerce(e,t,l,"plot_bgcolor"));var V=r.combine(N,t.paper_bgcolor),U={x:_("x"),y:_("y")},H,G,Y,q;for(C=0;C<F.length;C++){H=F[C],G=H.charAt(0),o.isPlainObject(e[H])||(e[H]={}),Y=e[H],q=n.newContainer(t,H,G+"axis");var W=w[H]||[];q._traceIndices=W.map(function(e){return e._expandedIndex}),q._annIndices=[],q._shapeIndices=[],q._subplotsWith=[],q._counterAxes=[],q._name=q._attr=H;var X=q._id=m(H),Z=v(G,H),$={letter:G,font:t.font,outerTicks:A[H],showGrid:!S[H],data:W,bgColor:V,calendar:t.calendar,automargin:!0,cheateronly:"x"===G&&k[H]&&!T[H],splomStash:((t._splomAxes||{})[G]||{})[X]};y("uirevision",t.uirevision),d(Y,q,y,$),c(Y,q,y,$,t);var J=b("spikecolor"),K=b("spikethickness"),Q=b("spikedash"),ee=b("spikemode"),te=b("spikesnap"),ae=y("showspikes",!!J||!!K||!!Q||!!ee||!!te);ae||(delete q.spikecolor,delete q.spikethickness,delete q.spikedash,delete q.spikemode,delete q.spikesnap);var oe={letter:G,counterAxes:U[G],overlayableAxes:Z,grid:t.grid};u(Y,q,y,oe),q._input=Y}var re=x("rangeslider","handleDefaults"),ie=x("rangeselector","handleDefaults");for(C=0;C<M.length;C++)H=M[C],Y=e[H],q=t[H],re(e,t,H),"date"===q.type&&ie(Y,q,t,B,q.calendar),y("fixedrange");for(C=0;C<B.length;C++){H=B[C],Y=e[H],q=t[H];var ne=t[h(q.anchor)],le=x("rangeslider","isVisible")(ne);y("fixedrange",le)}t._axisConstraintGroups=[];var se=U.x.concat(U.y);for(C=0;C<F.length;C++)H=F[C],G=H.charAt(0),Y=e[H],q=t[H],p(Y,q,y,se,t)}},{"../../components/color":569,"../../lib":692,"../../plot_api/plot_template":730,"../../registry":823,"../layout_attributes":795,"./axis_defaults":742,"./axis_ids":743,"./constraint_defaults":747,"./layout_attributes":753,"./position_defaults":756,"./type_defaults":764}],755:[function(e,t){"use strict";var a=e("tinycolor2").mix,o=e("../../components/color/attributes").lightFraction,r=e("../../lib");t.exports=function(e,t,i,n){function l(a,o){return r.coerce2(e,t,n.attributes,a,o)}n=n||{};var s=n.dfltColor,d=l("linecolor",s),c=l("linewidth"),p=i("showline",n.showLine||!!d||!!c);p||(delete t.linecolor,delete t.linewidth);var u=a(s,n.bgColor,n.blend||o).toRgbString(),g=l("gridcolor",u),h=l("gridwidth"),m=i("showgrid",n.showGrid||!!g||!!h);if(m||(delete t.gridcolor,delete t.gridwidth),!n.noZeroLine){var y=l("zerolinecolor",s),f=l("zerolinewidth"),x=i("zeroline",n.showGrid||!!y||!!f);x||(delete t.zerolinecolor,delete t.zerolinewidth)}}},{"../../components/color/attributes":568,"../../lib":692,tinycolor2:513}],756:[function(e,t){"use strict";var a=e("fast-isnumeric"),o=e("../../lib");t.exports=function(e,t,r,i){var n=i.counterAxes||[],l=i.overlayableAxes||[],s=i.letter,d=i.grid,c,p,u,g;d&&(p=d._domains[s][d._axisMap[t._id]],c=d._anchors[t._id],p&&(u=d[s+"side"].split(" ")[0],g=d.domain[s]["right"===u||"top"===u?1:0])),p=p||[0,1],c=c||(a(e.position)?"free":n[0]||"free"),u=u||("x"===s?"bottom":"left"),g=g||0;var h=o.coerce(e,t,{anchor:{valType:"enumerated",values:["free"].concat(n),dflt:c}},"anchor");"free"===h&&r("position",g),o.coerce(e,t,{side:{valType:"enumerated",values:"x"===s?["bottom","top"]:["left","right"],dflt:u}},"side");var m=!1;if(l.length&&(m=o.coerce(e,t,{overlaying:{valType:"enumerated",values:[!1].concat(l),dflt:!1}},"overlaying")),!m){var y=r("domain",p);y[0]>y[1]-.01&&(t.domain=p),o.noneOrAll(e.domain,t.domain,p)}return r("layer"),t}},{"../../lib":692,"fast-isnumeric":214}],757:[function(e,t){"use strict";var a=e("../../constants/alignment").FROM_BL;t.exports=function(e,t,o){o===void 0&&(o=a[e.constraintoward||"center"]);var r=[e.r2l(e.range[0]),e.r2l(e.range[1])],i=r[0]+(r[1]-r[0])*o;e.range=e._input.range=[e.l2r(i+(r[0]-i)*t),e.l2r(i+(r[1]-i)*t)]}},{"../../constants/alignment":664}],758:[function(e,t){"use strict";function a(e){return e._id}function o(e,t,a,o,n,l,b){var v=t._hoverdata,w=t._fullLayout.clickmode,k=-1<w.indexOf("event"),T=[],A,S,C,L,E,z,I,D,P,O;if(g(v)){d(e,t,l),A=p(t,a,o,n);var R=h(v,A),M=0<R.pointNumbers.length;if(M?y(A,R):f(A)&&(I=m(R))){for(b&&b.remove(),O=0;O<A.length;O++)S=A[O],S._module.selectPoints(S,!1);x(t,A),c(l),k&&t.emit("plotly_deselect",null)}else{D=e.shiftKey&&(I===void 0?m(R):I),C=r(R.pointNumber,R.searchInfo,D);var B=l.selectionDefs.concat([C]);for(L=s(B),O=0;O<A.length;O++)if(E=A[O]._module.selectPoints(A[O],L),z=_(E,A[O]),T.length)for(var F=0;F<z.length;F++)T.push(z[F]);else T=z;P={points:T},x(t,A,P),C&&l&&l.selectionDefs.push(C),b&&u(l.mergedPolygons,b),k&&t.emit("plotly_selected",P)}}}function r(e,t,a){return{pointNumber:e,searchInfo:t,subtract:a}}function n(e){return"pointNumber"in e&&"searchInfo"in e}function l(e){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(t,a,o,r){var i=e.searchInfo.cd[0].trace._expandedIndex,n=r.cd[0].trace._expandedIndex;return n===i&&o===e.pointNumber},isRect:!1,degenerate:!1,subtract:e.subtract}}function s(e){function t(e,t,o,r){for(var n=!1,l=0;l<a.length;l++)a[l].contains(e,t,o,r)&&(n=!1===a[l].subtract);return n}for(var a=[],o=n(e[0])?0:e[0][0][0],r=o,s=n(e[0])?0:e[0][0][1],d=s,c=0;c<e.length;c++)if(n(e[c]))a.push(l(e[c]));else{var p=S.tester(e[c]);p.subtract=e[c].subtract,a.push(p),o=ie(o,p.xmin),r=va(r,p.xmax),s=ie(s,p.ymin),d=va(d,p.ymax)}return{xmin:o,xmax:r,ymin:s,ymax:d,pts:[],contains:t,isRect:!1,degenerate:!1}}function d(e,t,a){var o=t._fullLayout,r=o._zoomlayer,i=a.plotinfo,n=o._lastSelectedSubplot&&o._lastSelectedSubplot===i.id,l=e.shiftKey||e.altKey;n&&l&&i.selection&&i.selection.selectionDefs&&!a.selectionDefs?(a.selectionDefs=i.selection.selectionDefs,a.mergedPolygons=i.selection.mergedPolygons):(!l||!i.selection)&&c(a),n||(v(r),o._lastSelectedSubplot=i.id)}function c(e){var t=e.plotinfo;t.selection={},t.selection.selectionDefs=e.selectionDefs=[],t.selection.mergedPolygons=e.mergedPolygons=[]}function p(e,t,o,r){function n(e,t,a,o){return{_module:e,cd:t,xaxis:a,yaxis:o}}var l=[],s=t.map(a),d=o.map(a),c,p,u;for(u=0;u<e.calcdata.length;u++)if(c=e.calcdata[u],p=c[0].trace,!0===p.visible&&p._module&&p._module.selectPoints)if(r&&(p.subplot===r||p.geo===r))l.push(n(p._module,c,t[0],o[0]));else if("splom"===p.type&&p._xaxes[s[0]]&&p._yaxes[d[0]]){var g=n(p._module,c,t[0],o[0]);g.scene=e._fullLayout._splomScenes[p.uid],l.push(g)}else{if(-1===s.indexOf(p.xaxis))continue;if(-1===d.indexOf(p.yaxis))continue;l.push(n(p._module,c,E(e,p.xaxis),E(e,p.yaxis)))}return l}function u(e,t){var a=[],o,r;for(o=0;o<e.length;o++){var n=e[o];a.push(n.join("L")+"L"+n[0])}r=0<e.length?"M"+a.join("M")+"Z":"M0,0Z",t.attr("d",r)}function g(e){return e&&Array.isArray(e)&&!0!==e[0].hoverOnBox}function h(e,t){var a=e[0],o=-1,r=[],n,l;for(l=0;l<t.length;l++)if(n=t[l],a.fullData._expandedIndex===n.cd[0].trace._expandedIndex){if(!0===a.hoverOnBox)break;void 0===a.pointNumber?void 0!==a.binNumber&&(o=a.binNumber,r=a.pointNumbers):o=a.pointNumber;break}return{pointNumber:o,pointNumbers:r,searchInfo:n}}function m(e){var t=e.searchInfo.cd[0].trace,a=e.pointNumber,o=e.pointNumbers,r=0<o.length,i=r?o[0]:a;return!!t.selectedpoints&&-1<t.selectedpoints.indexOf(i)}function y(e,t){var a=[],o,r,n,l;for(l=0;l<e.length;l++)o=e[l],o.cd[0].trace.selectedpoints&&0<o.cd[0].trace.selectedpoints.length&&a.push(o);if(1===a.length&&(n=a[0]===t.searchInfo,n&&(r=t.searchInfo.cd[0].trace,r.selectedpoints.length===t.pointNumbers.length))){for(l=0;l<t.pointNumbers.length;l++)if(0>r.selectedpoints.indexOf(t.pointNumbers[l]))return!1;return!0}return!1}function f(e){var t=0,a,o,r;for(r=0;r<e.length;r++)if(a=e[r],o=a.cd[0].trace,o.selectedpoints){if(1<o.selectedpoints.length)return!1;if(t+=o.selectedpoints.length,1<t)return!1}return 1===t}function x(e,t,a){var o,r,n,l;for(o=0;o<t.length;o++){var s=t[o].cd[0].trace._fullInput,d=e._fullLayout._tracePreGUI[s.uid];d.selectedpoints===void 0&&(d.selectedpoints=s._input.selectedpoints||null)}if(a){var c=a.points||[];for(o=0;o<t.length;o++)l=t[o].cd[0].trace,l._input.selectedpoints=l._fullInput.selectedpoints=[],l._fullInput!==l&&(l.selectedpoints=[]);for(o=0;o<c.length;o++){var p=c[o],u=p.data,g=p.fullData;p.pointIndices?([].push.apply(u.selectedpoints,p.pointIndices),l._fullInput!==l&&[].push.apply(g.selectedpoints,p.pointIndices)):(u.selectedpoints.push(p.pointIndex),l._fullInput!==l&&g.selectedpoints.push(p.pointIndex))}}else for(o=0;o<t.length;o++)l=t[o].cd[0].trace,delete l.selectedpoints,delete l._input.selectedpoints,l._fullInput!==l&&delete l._fullInput.selectedpoints;var h=!1;for(o=0;o<t.length;o++){r=t[o],n=r.cd,l=n[0].trace,k.traceIs(l,"regl")&&(h=!0);var m=r._module,y=m.styleOnSelect||m.style;y&&y(e,n)}h&&(z(e),I(e))}function b(e,t,a){var o;return a?(o=w.difference({regions:e,inverted:!1},{regions:[t],inverted:!1}),o.regions):(o=w.union({regions:e,inverted:!1},{regions:[t],inverted:!1}),o.regions)}function _(e,t){if(Array.isArray(e))for(var a=t.cd,o=t.cd[0].trace,r=0;r<e.length;r++)e[r]=L(e[r],o,a);return e}function v(e){e.selectAll(".select-outline").remove()}var w=e("polybooljs"),k=e("../../registry"),T=e("../../components/color"),A=e("../../components/fx"),S=e("../../lib/polygon"),C=e("../../lib/throttle"),L=e("../../components/fx/helpers").makeEventData,E=e("./axis_ids").getFromId,z=e("../../lib/clear_gl_canvases"),I=e("../../plot_api/subroutines").redrawReglTraces,D=e("./constants"),P=D.MINSELECT,O=S.filter,R=S.tester;t.exports={prepSelect:function(t,e,a,r,n){function l(e){var t="y"===e._id.charAt(0)?1:0;return function(a){return e.p2d(a[t])}}function g(e,t){return e-t}var h=r.gd,m=h._fullLayout,y=m._zoomlayer,f=r.element.getBoundingClientRect(),v=r.plotinfo,w=v.xaxis._offset,k=v.yaxis._offset,S=e-f.left,L=a-f.top,E=S,z=L,I=r.xaxes[0]._length,M=r.yaxes[0]._length,j=r.xaxes.concat(r.yaxes),B=t.altKey,F,N,V,U,H,G,Y;d(t,h,r),"lasso"===n&&(F=O([[S,L]],D.BENDPX));var q=y.selectAll("path.select-outline-"+v.id).data([1,2]);q.enter().append("path").attr("class",function(e){return"select-outline select-outline-"+e+" select-outline-"+v.id}).attr("transform","translate("+w+", "+k+")").attr("d","M"+S+","+L+"Z");var W=y.append("path").attr("class","zoombox-corners").style({fill:T.background,stroke:T.defaultLine,"stroke-width":1}).attr("transform","translate("+w+", "+k+")").attr("d","M0,0Z"),X=m._uid+D.SELECTID,Z=[],$=p(h,r.xaxes,r.yaxes,r.subplot),J;J=v.fillRangeItems?v.fillRangeItems:"select"===n?function(e,t){var a=e.range={};for(H=0;H<j.length;H++){var o=j[H],r=o._id.charAt(0);a[o._id]=[o.p2d(t[r+"min"]),o.p2d(t[r+"max"])].sort(g)}}:function(e,t,a){var o=e.lassoPoints={};for(H=0;H<j.length;H++){var r=j[H];o[r._id]=a.filtered.map(l(r))}},r.moveFn=function(e,t){E=va(0,ie(I,e+S)),z=va(0,ie(M,t+L));var a=wa(E-S),o=wa(z-L);if("select"===n){var i=m.selectdirection;i="any"===m.selectdirection?o<ie(.6*a,P)?"h":a<ie(.6*o,P)?"v":"d":m.selectdirection,"h"===i?(U=[[S,0],[S,M],[E,M],[E,0]],U.xmin=ie(S,E),U.xmax=va(S,E),U.ymin=ie(0,M),U.ymax=va(0,M),W.attr("d","M"+U.xmin+","+(L-P)+"h-4v"+2*P+"h4ZM"+(U.xmax-1)+","+(L-P)+"h4v"+2*P+"h-4Z")):"v"===i?(U=[[0,L],[0,z],[I,z],[I,L]],U.xmin=ie(0,I),U.xmax=va(0,I),U.ymin=ie(L,z),U.ymax=va(L,z),W.attr("d","M"+(S-P)+","+U.ymin+"v-4h"+2*P+"v4ZM"+(S-P)+","+(U.ymax-1)+"v4h"+2*P+"v-4Z")):"d"===i&&(U=[[S,L],[S,z],[E,z],[E,L]],U.xmin=ie(S,E),U.xmax=va(S,E),U.ymin=ie(L,z),U.ymax=va(L,z),W.attr("d","M0,0Z"))}else"lasso"===n&&(F.addPt([E,z]),U=F.filtered);r.selectionDefs&&r.selectionDefs.length?(V=b(r.mergedPolygons,U,B),U.subtract=B,N=s(r.selectionDefs.concat([U]))):(V=[U],N=R(U)),u(V,q),C.throttle(X,D.SELECTDELAY,function(){Z=[];var e=[],t,a;for(H=0;H<$.length;H++)if(G=$[H],a=G._module.selectPoints(G,N),e.push(a),t=_(a,G),Z.length)for(var o=0;o<t.length;o++)Z.push(t[o]);else Z=t;Y={points:Z},x(h,$,Y),J(Y,U,F),r.gd.emit("plotly_selecting",Y)})},r.clickFn=function(e,t){var a=m.clickmode;W.remove(),C.done(X).then(function(){if(C.clear(X),2===e){for(q.remove(),H=0;H<$.length;H++)G=$[H],G._module.selectPoints(G,!1);x(h,$),c(r),h.emit("plotly_deselect",null)}else-1<a.indexOf("select")&&o(t,h,r.xaxes,r.yaxes,r.subplot,r,q),"event"===a&&h.emit("plotly_selected",void 0);A.click(h,t)})},r.doneFn=function(){W.remove(),C.done(X).then(function(){C.clear(X),r.gd.emit("plotly_selected",Y),U&&r.selectionDefs&&(U.subtract=B,r.selectionDefs.push(U),r.mergedPolygons.length=0,[].push.apply(r.mergedPolygons,V))})}},clearSelect:v,selectOnClick:o}},{"../../components/color":569,"../../components/fx":608,"../../components/fx/helpers":604,"../../lib/clear_gl_canvases":677,"../../lib/polygon":704,"../../lib/throttle":717,"../../plot_api/subroutines":731,"../../registry":823,"./axis_ids":743,"./constants":746,polybooljs:456}],759:[function(e,t){"use strict";function a(e){return _a(10,e)}function o(e){return null!==e&&e!==void 0}var r=e("d3"),n=e("fast-isnumeric"),l=e("../../lib"),s=l.cleanNumber,d=l.ms2DateTime,c=l.dateTime2ms,p=l.ensureNumber,u=l.isArrayOrTypedArray,g=e("../../constants/numerical"),h=g.FP_SAFE,m=g.BADNUM,y=g.LOG_CLIP,f=e("./constants"),x=e("./axis_ids");t.exports=function(e,t){function i(t,a){if(0<t)return P(t)/z;if(0>=t&&a&&e.range&&2===e.range.length){var o=e.range[0],r=e.range[1];return .5*(o+r-2*y*wa(o-r))}return m}function g(t,a,o){var r=c(t,o||e.calendar);if(r===m)if(n(t)){t=+t;var i=ea(10*l.mod(t+.05,1)),s=R(t-i/10);r=c(new Date(s))+i/10}else return m;return r}function b(t,a,o){return d(t,a,o||e.calendar)}function _(t){return e._categories[R(t)]}function v(t){if(o(t)){if(void 0===e._categoriesMap&&(e._categoriesMap={}),void 0!==e._categoriesMap[t])return e._categoriesMap[t];e._categories.push(t);var a=e._categories.length-1;return e._categoriesMap[t]=a,a}return m}function w(e,t){for(var a=Array(t),o=0;o<t;o++){var r=(e[0]||[])[o],n=(e[1]||[])[o];a[o]=k([r,n])}return a}function k(t){if(e._categoriesMap)return e._categoriesMap[t]}function T(e){var t=k(e);return void 0===t?n(e)?+e:void 0:t}function A(t){return n(t)?r.round(e._b+e._m*t,2):m}function S(t){return(t-e._b)/e._m}t=t||{};var C=(e._id||"x").charAt(0);e.c2l="log"===e.type?i:p,e.l2c="log"===e.type?a:p,e.l2p=A,e.p2l=S,e.c2p="log"===e.type?function(e,t){return A(i(e,t))}:A,e.p2c="log"===e.type?function(e){return a(S(e))}:S,-1===["linear","-"].indexOf(e.type)?"log"===e.type?(e.d2r=e.d2l=function(e,t){return i(s(e),t)},e.r2d=e.r2c=function(e){return a(s(e))},e.d2c=e.r2l=s,e.c2d=e.l2r=p,e.c2r=i,e.l2d=a,e.d2p=function(t,a){return e.l2p(e.d2r(t,a))},e.p2d=function(e){return a(S(e))},e.r2p=function(t){return e.l2p(s(t))},e.p2r=S,e.cleanPos=p):"date"===e.type?(e.d2r=e.r2d=l.identity,e.d2c=e.r2c=e.d2l=e.r2l=g,e.c2d=e.c2r=e.l2d=e.l2r=b,e.d2p=e.r2p=function(t,a,o){return e.l2p(g(t,0,o))},e.p2d=e.p2r=function(e,t,a){return b(S(e),t,a)},e.cleanPos=function(t){return l.cleanDate(t,m,e.calendar)}):"category"===e.type?(e.d2c=e.d2l=v,e.r2d=e.c2d=e.l2d=_,e.d2r=e.d2l_noadd=T,e.r2c=function(t){var a=T(t);return a===void 0?e.fraction2r(.5):a},e.l2r=e.c2r=p,e.r2l=T,e.d2p=function(t){return e.l2p(e.r2c(t))},e.p2d=function(e){return _(S(e))},e.r2p=e.d2p,e.p2r=S,e.cleanPos=function(e){return"string"==typeof e&&""!==e?e:p(e)}):"multicategory"===e.type&&(e.r2d=e.c2d=e.l2d=_,e.d2r=e.d2l_noadd=T,e.r2c=function(t){var a=T(t);return a===void 0?e.fraction2r(.5):a},e.r2c_just_indices=k,e.l2r=e.c2r=p,e.r2l=T,e.d2p=function(t){return e.l2p(e.r2c(t))},e.p2d=function(e){return _(S(e))},e.r2p=e.d2p,e.p2r=S,e.cleanPos=function(e){return Array.isArray(e)||"string"==typeof e&&""!==e?e:p(e)},e.setupMultiCategory=function(t){var a=e._traceIndices,r=e._multicatSeen=[[0,{}],[0,{}]],n=e._multicatList=[],s,d;for(s=0;s<a.length;s++){var c=t[a[s]];if(C in c){var p=c[C],g=c._length||l.minRowLength(p);if(u(p[0])&&u(p[1]))for(d=0;d<g;d++){var h=p[0][d],m=p[1][d];o(h)&&o(m)&&(n.push([h,m]),!(h in r[0][1])&&(r[0][1][h]=r[0][0]++),!(m in r[1][1])&&(r[1][1][m]=r[1][0]++))}}}for(n.sort(function(e,t){var a=r[0][1],o=a[e[0]]-a[t[0]];if(o)return o;var i=r[1][1];return i[e[1]]-i[t[1]]}),s=0;s<n.length;s++)v(n[s])}):(e.d2r=e.r2d=e.d2c=e.r2c=e.d2l=e.r2l=s,e.c2d=e.c2r=e.l2d=e.l2r=p,e.d2p=e.r2p=function(t){return e.l2p(s(t))},e.p2d=e.p2r=S,e.cleanPos=p),e.fraction2r=function(t){var a=e.r2l(e.range[0]),o=e.r2l(e.range[1]);return e.l2r(a+t*(o-a))},e.r2fraction=function(t){var a=e.r2l(e.range[0]),o=e.r2l(e.range[1]);return(e.r2l(t)-a)/(o-a)},e.cleanRange=function(t,a){a||(a={}),t||(t="range");var o=l.nestedProperty(e,t).get(),r,s;if(s="date"===e.type?l.dfltRange(e.calendar):"y"===C?f.DFLTRANGEY:a.dfltRange||f.DFLTRANGEX,s=s.slice(),!o||2!==o.length)return void l.nestedProperty(e,t).set(s);for("date"===e.type&&(o[0]=l.cleanDate(o[0],m,e.calendar),o[1]=l.cleanDate(o[1],m,e.calendar)),r=0;2>r;r++)if("date"===e.type){if(!l.isDateTime(o[r],e.calendar)){e[t]=s;break}if(e.r2l(o[0])===e.r2l(o[1])){var d=l.constrain(e.r2l(o[0]),l.MIN_MS+1e3,l.MAX_MS-1e3);o[0]=e.l2r(d-1e3),o[1]=e.l2r(d+1e3);break}}else{if(!n(o[r]))if(n(o[1-r]))o[r]=o[1-r]*(r?10:.1);else{e[t]=s;break}if(o[r]<-h?o[r]=-h:o[r]>h&&(o[r]=h),o[0]===o[1]){var c=va(1,wa(1e-6*o[0]));o[0]-=c,o[1]+=c}}},e.setScale=function(a){var o=t._size;if(e.overlaying){var r=x.getFromId({_fullLayout:t},e.overlaying);e.domain=r.domain}var i=a&&e._r?"_r":"range",n=e.calendar;e.cleanRange(i);var l=e.r2l(e[i][0],n),s=e.r2l(e[i][1],n);if("y"===C?(e._offset=o.t+(1-e.domain[1])*o.h,e._length=o.h*(e.domain[1]-e.domain[0]),e._m=e._length/(l-s),e._b=-e._m*s):(e._offset=o.l+e.domain[0]*o.w,e._length=o.w*(e.domain[1]-e.domain[0]),e._m=e._length/(s-l),e._b=-e._m*l),!isFinite(e._m)||!isFinite(e._b))throw t._replotting=!1,new Error("Something went wrong with axis scaling")},e.makeCalcdata=function(t,a){var o=e.type,r="date"===o&&t[a+"calendar"],n,s,d,c;if(a in t){if(n=t[a],c=t._length||l.minRowLength(n),l.isTypedArray(n)&&("linear"===o||"log"===o)){if(c===n.length)return n;if(n.subarray)return n.subarray(0,c)}if("multicategory"===o)return w(n,c);for(s=Array(c),d=0;d<c;d++)s[d]=e.d2c(n[d],0,r)}else{var p=a+"0"in t?e.d2c(t[a+"0"],0,r):0,u=t["d"+a]?+t["d"+a]:1;for(n=t[{x:"y",y:"x"}[a]],c=t._length||n.length,s=Array(c),d=0;d<c;d++)s[d]=p+d*u}return s},e.isValidRange=function(t){return Array.isArray(t)&&2===t.length&&n(e.r2l(t[0]))&&n(e.r2l(t[1]))},e.isPtWithinRange=function(t,a){var o=e.c2l(t[C],null,a),r=e.r2l(e.range[0]),i=e.r2l(e.range[1]);return r<i?r<=o&&o<=i:i<=o&&o<=r},e.clearCalc=function(){e._categories=(e._initialCategories||[]).slice(),e._categoriesMap={};for(var t=0;t<e._categories.length;t++)e._categoriesMap[e._categories[t]]=t};var L=t._d3locale;"date"===e.type&&(e._dateFormat=L?L.timeFormat.utc:r.time.format.utc,e._extraFormat=t._extraFormat),e._separators=t.separators,e._numFormat=L?L.numberFormat:r.format,delete e._minDtick,delete e._forceTick0}},{"../../constants/numerical":669,"../../lib":692,"./axis_ids":743,"./constants":746,d3:148,"fast-isnumeric":214}],760:[function(e,t){"use strict";function a(e){var t=["showexponent","showtickprefix","showticksuffix"].filter(function(t){return e[t]!==void 0});if(t.every(function(o){return e[o]===e[t[0]]})||1===t.length)return e[t[0]]}function o(e,t){function a(a,o){return r.coerce(e,t,i.tickformatstops,a,o)}var o=a("enabled");o&&(a("dtickrange"),a("value"))}var r=e("../../lib"),i=e("./layout_attributes"),n=e("../array_container_defaults");t.exports=function(e,t,l,s,d){var c=a(e),p=l("tickprefix");p&&l("showtickprefix",c);var u=l("ticksuffix",d.tickSuffixDflt);u&&l("showticksuffix",c);var g=l("showticklabels");if(g){var h=d.font||{},m=t.color,y=m&&m!==i.color.dflt?m:h.color;if(r.coerceFont(l,"tickfont",{family:h.family,size:h.size,color:y}),l("tickangle"),"category"!==s){var f=l("tickformat"),x=e.tickformatstops;Array.isArray(x)&&x.length&&n(e,t,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:o}),f||"date"===s||(l("showexponent",c),l("exponentformat"),l("separatethousands"))}}}},{"../../lib":692,"../array_container_defaults":736,"./layout_attributes":753}],761:[function(e,t){"use strict";var a=e("../../lib"),o=e("./layout_attributes");t.exports=function(e,t,r,i){var n=a.coerce2(e,t,o,"ticklen"),l=a.coerce2(e,t,o,"tickwidth"),s=a.coerce2(e,t,o,"tickcolor",t.color),d=r("ticks",i.outerTicks||n||l||s?"outside":"");d||(delete t.ticklen,delete t.tickwidth,delete t.tickcolor)}},{"../../lib":692,"./layout_attributes":753}],762:[function(e,t){"use strict";var a=e("./clean_ticks");t.exports=function(e,t,o,r){var i;if("array"===e.tickmode&&("log"===r||"date"===r))i=t.tickmode="auto";else{var n=Array.isArray(e.tickvals)?"array":e.dtick?"linear":"auto";i=o("tickmode",n)}if("auto"===i)o("nticks");else if("linear"===i){var l=t.dtick=a.dtick(e.dtick,r);t.tick0=a.tick0(e.tick0,r,t.calendar,l)}else if("multicategory"!==r){var s=o("tickvals");void 0===s?t.tickmode="auto":o("ticktext")}}},{"./clean_ticks":745}],763:[function(e,t){"use strict";var a=e("d3"),o=e("../../registry"),r=e("../../components/drawing"),n=e("./axes"),l=e("./constants").attrRegex;t.exports=function(e,t,s,d){function c(t,a){function r(t,a,o){for(s=0;s<t.length;s++){var r=t[s];if((-1!==l.indexOf(r.xref)||-1!==l.indexOf(r.yref))&&a(e,s),o)return}}var l=[t._id,a._id],s;n.drawOne(e,t,{skipTitle:!0}),n.drawOne(e,a,{skipTitle:!0}),r(y.annotations||[],o.getComponentMethod("annotations","drawOne")),r(y.shapes||[],o.getComponentMethod("shapes","drawOne")),r(y.images||[],o.getComponentMethod("images","draw"),!0)}function p(e){var t=e.xaxis,a=e.yaxis;y._defs.select("#"+e.clipId+"> rect").call(r.setTranslate,0,0).call(r.setScale,1,1),e.plot.call(r.setTranslate,t._offset,a._offset).call(r.setScale,1,1);var o=e.plot.selectAll(".scatterlayer .trace");o.selectAll(".point").call(r.setPointGroupScale,1,1),o.selectAll(".textpoint").call(r.setTextPointsScale,1,1),o.call(r.hideOutsideRangePoints,e)}function u(t,a){var o=x[t.xaxis._id],i=x[t.yaxis._id],n=[],l,s,d;if(o){l=e._fullLayout[o.axisName],s=l._r,d=o.to,n[0]=(s[0]*(1-a)+a*d[0]-s[0])/(s[1]-s[0])*t.xaxis._length;var p=s[1]-s[0],u=d[1]-d[0];l.range[0]=s[0]*(1-a)+a*d[0],l.range[1]=s[1]*(1-a)+a*d[1],n[2]=t.xaxis._length*(1-a+a*u/p)}else n[0]=0,n[2]=t.xaxis._length;if(i){l=e._fullLayout[i.axisName],s=l._r,d=i.to,n[1]=(s[1]*(1-a)+a*d[1]-s[1])/(s[0]-s[1])*t.yaxis._length;var g=s[1]-s[0],h=d[1]-d[0];l.range[0]=s[0]*(1-a)+a*d[0],l.range[1]=s[1]*(1-a)+a*d[1],n[3]=t.yaxis._length*(1-a+a*h/g)}else n[1]=0,n[3]=t.yaxis._length;c(t.xaxis,t.yaxis);var m=t.xaxis,y=t.yaxis,f=!!o,b=!!i,_=f?m._length/n[2]:1,v=b?y._length/n[3]:1,w=f?n[0]:0,k=b?n[1]:0,T=f?n[0]/n[2]*m._length:0,A=b?n[1]/n[3]*y._length:0,S=m._offset-T,C=y._offset-A;t.clipRect.call(r.setTranslate,w,k).call(r.setScale,1/_,1/v),t.plot.call(r.setTranslate,S,C).call(r.setScale,_,v),r.setPointGroupScale(t.zoomScalePts,1/_,1/v),r.setTextPointsScale(t.zoomScaleTxt,1/_,1/v)}function g(){for(var t={},a=0;a<b.length;a++){var r=e._fullLayout[x[b[a]].axisName],n=x[b[a]].to;t[r._name+".range[0]"]=n[0],t[r._name+".range[1]"]=n[1],r.range=n.slice()}return v&&v(),o.call("relayout",e,t).then(function(){for(var e=0;e<_.length;e++)p(_[e])})}function h(){for(var t={},a=0,r;a<b.length;a++)r=e._fullLayout[b[a]+"axis"],t[r._name+".range[0]"]=r.range[0],t[r._name+".range[1]"]=r.range[1],r.range=r._r.slice();return o.call("relayout",e,t).then(function(){for(var e=0;e<_.length;e++)p(_[e])})}function m(){T=Date.now();for(var e=ie(1,(T-k)/s.duration),t=w(e),a=0;a<_.length;a++)u(_[a],t);T-k>s.duration?(g(),A=window.cancelAnimationFrame(m)):A=window.requestAnimationFrame(m)}var y=e._fullLayout,f=[],x=function(e){var t={},a,o,r,i,n;for(a in e)if(o=a.split("."),r=o[0].match(l),r){var s=a.charAt(0),d=o[0];if(i=y[d],n={},Array.isArray(e[a])?n.to=e[a].slice(0):Array.isArray(e[a].range)&&(n.to=e[a].range.slice(0)),!n.to)continue;n.axisName=d,n.length=i._length,f.push(s),t[s]=n}return t}(t),b=Object.keys(x),_=function(e,t,a){var o=e._plots,r=[],i,n,l;for(i in o){var s=o[i];if(-1===r.indexOf(s)){var d=s.xaxis._id,c=s.yaxis._id,p=s.xaxis.range,u=s.yaxis.range;s.xaxis._r=s.xaxis.range.slice(),s.yaxis._r=s.yaxis.range.slice(),n=a[d]?a[d].to:p,l=a[c]?a[c].to:u,p[0]===n[0]&&p[1]===n[1]&&u[0]===l[0]&&u[1]===l[1]||-1===t.indexOf(d)&&-1===t.indexOf(c)||r.push(s)}}return r}(y,b,x);if(!_.length)return function(){function t(t,a,o){for(var r=0;r<t.length;r++)if(a(e,r),o)return}t(y.annotations||[],o.getComponentMethod("annotations","drawOne")),t(y.shapes||[],o.getComponentMethod("shapes","drawOne")),t(y.images||[],o.getComponentMethod("images","draw"),!0)}(),!1;var v;d&&(v=d());var w=a.ease(s.easing),k,T,A;return e._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(A),A=null,h()}),k=Date.now(),A=window.requestAnimationFrame(m),Promise.resolve()}},{"../../components/drawing":590,"../../registry":823,"./axes":740,"./constants":746,d3:148}],764:[function(e,t){"use strict";function a(e,t){if("-"===e.type){var a=e._id,d=a.charAt(0);-1!==a.indexOf("scene")&&(a=d);var c=o(t,a,d);if(c){if("histogram"===c.type&&d==={v:"y",h:"x"}[c.orientation||"v"])return void(e.type="linear");var p=d+"calendar",u=c[p],g={noMultiCategory:!l(c,"cartesian")||l(c,"noMultiCategory")},h;if(n(c,d)){var m=r(c),y=[];for(h=0;h<t.length;h++){var f=t[h];!l(f,"box-violin")||(f[d+"axis"]||d)!==a||(void 0===f[m]?void 0===f.name?y.push("text"):y.push(f.name):y.push(f[m][0]),f[p]!==u&&(u=void 0))}e.type=s(y,u,g)}else if("splom"===c.type){var x=c.dimensions,b=c._diag;for(h=0;h<x.length;h++){var _=x[h];if(_.visible&&(b[h][0]===a||b[h][1]===a)){e.type=s(_.values,u,g);break}}}else e.type=s(c[d]||[c[d+"0"]],u,g)}}}function o(e,t,a){for(var o=0,r;o<e.length;o++){if(r=e[o],"splom"===r.type&&0<r._length&&(r["_"+a+"axes"]||{})[t])return r;if((r[a+"axis"]||a)===t){if(n(r,a))return r;if((r[a]||[]).length||r[a+"0"])return r}}}function r(e){return{v:"x",h:"y"}[e.orientation||"v"]}function n(e,t){var a=r(e),o=l(e,"box-violin"),i=l(e._fullInput||{},"candlestick");return o&&!i&&t===a&&e[a]===void 0&&e[a+"0"]===void 0}var l=e("../../registry").traceIs,s=e("./axis_autotype");t.exports=function(e,t,o,r){var i=o("type",(r.splomStash||{}).type);"-"===i&&(a(t,r.data),"-"===t.type?t.type="linear":e.type=t.type)}},{"../../registry":823,"./axis_autotype":741}],765:[function(e,t,a){"use strict";function o(e,t,a){var o=!1,r,i,n;if("data"===t.type)r=e._fullData[null===t.traces?0:t.traces[0]];else if("layout"===t.type)r=e._fullLayout;else return!1;return i=d.nestedProperty(r,t.prop).get(),n=a[t.type]=a[t.type]||{},n.hasOwnProperty(t.prop)&&n[t.prop]!==i&&(o=!0),n[t.prop]=i,{changed:o,value:i}}function r(e,t){return Array.isArray(t[0])&&1===t[0].length&&-1!==["string","number"].indexOf(typeof t[0][0])?[{type:"layout",prop:"_currentFrame",value:t[0][0].toString()}]:[]}function i(e,t){var a=[],o=t[0],r={};if("string"==typeof o)r[o]=t[1];else if(d.isPlainObject(o))r=o;else return a;return l(r,function(e,t,o){a.push({type:"layout",prop:e,value:o})},"",0),a}function n(e,t){var a=[],o,r,i,n;if(r=t[0],i=t[1],o=t[2],n={},"string"==typeof r)n[r]=i;else if(d.isPlainObject(r))n=r,void 0===o&&(o=i);else return a;return void 0===o&&(o=null),l(n,function(t,r,n){var l;if(Array.isArray(n)){var s=ie(n.length,e.data.length);o&&(s=ie(s,o.length)),l=[];for(var d=0;d<s;d++)l[d]=o?o[d]:d}else l=o?o.slice(0):null;if(null===l)Array.isArray(n)&&(n=n[0]);else if(Array.isArray(l)){if(!Array.isArray(n)){var c=n;n=[];for(var p=0;p<l.length;p++)n[p]=c}n.length=ie(l.length,n.length)}a.push({type:"data",prop:t,traces:l,value:n})},"",0),a}function l(e,t,a,o){Object.keys(e).forEach(function(r){var i=e[r];if("_"!==r[0]){var n=a+(0<o?".":"")+r;d.isPlainObject(i)?l(i,t,n,o+1):t(n,r,i)}})}var s=e("../registry"),d=e("../lib");a.manageCommandObserver=function(e,t,r,n){var l={},s=!0;t&&t._commandObserver&&(l=t._commandObserver),l.cache||(l.cache={}),l.lookupTable={};var c=a.hasSimpleAPICommandBindings(e,r,l.lookupTable);if(t&&t._commandObserver){if(!!c)return l;if(t._commandObserver.remove)return t._commandObserver.remove(),t._commandObserver=null,l}if(c){o(e,c,l.cache),l.check=function(){if(s){var t=o(e,c,l.cache);return t.changed&&n&&void 0!==l.lookupTable[t.value]&&(l.disable(),Promise.resolve(n({value:t.value,type:c.type,prop:c.prop,traces:c.traces,index:l.lookupTable[t.value]})).then(l.enable,l.enable)),t.changed}};for(var p=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],u=0;u<p.length;u++)e._internalOn(p[u],l.check);l.remove=function(){for(var t=0;t<p.length;t++)e._removeInternalListener(p[t],l.check)}}else d.log("Unable to automatically bind plot updates to API command"),l.lookupTable={},l.remove=function(){};return l.disable=function(){s=!1},l.enable=function(){s=!0},t&&(t._commandObserver=l),l},a.hasSimpleAPICommandBindings=function(e,t,o){var r=t.length,n,l;for(n=0;n<r;n++){var s=t[n],d=s.method,c=s.args,p;if(Array.isArray(c)||(c=[]),!d)return!1;var u=a.computeAPICommandBindings(e,d,c);if(1!==u.length)return!1;if(!l)l=u[0],Array.isArray(l.traces)&&l.traces.sort();else{if(p=u[0],p.type!==l.type)return!1;if(p.prop!==l.prop)return!1;if(Array.isArray(l.traces)){if(Array.isArray(p.traces)){p.traces.sort();for(var g=0;g<l.traces.length;g++)if(l.traces[g]!==p.traces[g])return!1}else return!1;}else if(p.prop!==l.prop)return!1}p=u[0];var h=p.value;if(Array.isArray(h))if(1===h.length)h=h[0];else return!1;o&&(o[h]=n)}return l},a.executeAPICommand=function(e,t,a){if("skip"===t)return Promise.resolve();var o=s.apiMethodRegistry[t],r=[e];Array.isArray(a)||(a=[]);for(var n=0;n<a.length;n++)r.push(a[n]);return o.apply(null,r).catch(function(e){return d.warn("API call to Plotly."+t+" rejected.",e),Promise.reject(e)})},a.computeAPICommandBindings=function(e,t,a){var o;return Array.isArray(a)||(a=[]),o="restyle"===t?n(e,a):"relayout"===t?i(e,a):"update"===t?n(e,[a[0],a[2]]).concat(i(e,[a[1]])):"animate"===t?r(e,a):[],o}},{"../lib":692,"../registry":823}],766:[function(e,t,a){"use strict";var o=e("../lib/extend").extendFlat;a.attributes=function(e,t){e=e||{},t=t||{};var a={valType:"info_array",editType:e.editType,items:[{valType:"number",min:0,max:1,editType:e.editType},{valType:"number",min:0,max:1,editType:e.editType}],dflt:[0,1]},r=e.name?e.name+" ":"",i=e.trace?"trace ":"subplot ",n=t.description?" "+t.description:"",l={x:o({},a,{}),y:o({},a,{}),editType:e.editType};return e.noGridCell||(l.row={valType:"integer",min:0,dflt:0,editType:e.editType},l.column={valType:"integer",min:0,dflt:0,editType:e.editType}),l},a.defaults=function(e,t,a,o){var r=o&&o.x||[0,1],i=o&&o.y||[0,1],n=t.grid;if(n){var l=a("domain.column");l!==void 0&&(l<n.columns?r=n._domains.x[l]:delete e.domain.column);var s=a("domain.row");s!==void 0&&(s<n.rows?i=n._domains.y[s]:delete e.domain.row)}a("domain.x",r),a("domain.y",i)}},{"../lib/extend":682}],767:[function(e,t){"use strict";t.exports=function(e){var t=e.editType,a=e.colorEditType;void 0===a&&(a=t);var o={family:{valType:"string",noBlank:!0,strict:!0,editType:t},size:{valType:"number",min:1,editType:t},color:{valType:"color",editType:a},editType:t};return e.arrayOk&&(o.family.arrayOk=!0,o.size.arrayOk=!0,o.color.arrayOk=!0),o}},{}],768:[function(e,t){"use strict";t.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],769:[function(e,t,a){"use strict";a.projNames={equirectangular:"equirectangular",mercator:"mercator",orthographic:"orthographic","natural earth":"naturalEarth",kavrayskiy7:"kavrayskiy7",miller:"miller",robinson:"robinson",eckert4:"eckert4","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant","conic equal area":"conicEqualArea","conic conformal":"conicConformal","conic equidistant":"conicEquidistant",gnomonic:"gnomonic",stereographic:"stereographic",mollweide:"mollweide",hammer:"hammer","transverse mercator":"transverseMercator","albers usa":"albersUsa","winkel tripel":"winkel3",aitoff:"aitoff",sinusoidal:"sinusoidal"},a.axesNames=["lonaxis","lataxis"],a.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},a.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},a.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},a.clipPad=1e-3,a.precision=.1,a.landColor="#F0DC82",a.waterColor="#3399FF",a.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},a.sphereSVG={type:"Sphere"},a.fillLayers={ocean:1,land:1,lakes:1},a.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},a.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],a.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],a.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],770:[function(e,t){"use strict";function a(e){this.id=e.id,this.graphDiv=e.graphDiv,this.container=e.container,this.topojsonURL=e.topojsonURL,this.isStatic=e.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}function o(e){for(var t=e.projection,a=t.type,o=l.geo[b.projNames[a]](),n=e._isClipped?b.lonaxisSpan[a]/2:null,s=["center","rotate","parallels","clipExtent"],d=function(e){return e?o:[]},c=0,r;c<s.length;c++)r=s[c],"function"!=typeof o[r]&&(o[r]=d);return o.isLonLatOverEdges=function(e){if(null===o(e))return!0;if(n){var t=o.rotate(),a=l.geo.distance(e,[-t[0],-t[1]]);return a>n*Sa/180}return!1},o.getPath=function(){return l.geo.path().projection(o)},o.getBounds=function(e){return o.getPath().bounds(e)},o.fitExtent=function(e,t){var a=e[1][0]-e[0][0],r=e[1][1]-e[0][1],i=o.clipExtent&&o.clipExtent();o.scale(150).translate([0,0]),i&&o.clipExtent(null);var n=o.getBounds(t),l=ie(a/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),s=+e[0][0]+(a-l*(n[1][0]+n[0][0]))/2,d=+e[0][1]+(r-l*(n[1][1]+n[0][1]))/2;return i&&o.clipExtent(i),o.scale(150*l).translate([s,d])},o.precision(b.precision),n&&o.clipAngle(n-b.clipPad),o}function r(e,t){var a=t[e],o=a.dtick,r=b.scopeDefaults[t.scope],i=r.lonaxisRange,n=r.lataxisRange,s="lonaxis"===e?[o]:[0,o];return l.geo.graticule().extent([[i[0],n[0]],[i[1],n[1]]]).step(s)}function n(e,t){var a=b.clipPad,o=e[0]+a,r=e[1]-a,i=t[0]+a,n=t[1]-a;0<o&&0>r&&(r+=360);var l=(r-o)/4;return{type:"Polygon",coordinates:[[[o,i],[o,n],[o+l,n],[o+2*l,n],[o+3*l,n],[r,n],[r,i],[r-l,i],[r-2*l,i],[r-3*l,i],[o,i]]]}}var l=e("d3"),s=e("../../registry"),d=e("../../lib"),c=e("../../components/color"),p=e("../../components/drawing"),u=e("../../components/fx"),g=e("../plots"),h=e("../cartesian/axes"),m=e("../../components/dragelement"),y=e("../cartesian/select").prepSelect,f=e("../cartesian/select").selectOnClick,x=e("./zoom"),b=e("./constants"),_=e("../../lib/topojson_utils"),v=e("topojson-client").feature;e("./projections")(l);var w=a.prototype;t.exports=function(e){return new a(e)},w.plot=function(e,t,a){var o=this,r=t[this.id],i=_.getTopojsonName(r);null===o.topojson||i!==o.topojsonName?(o.topojsonName=i,PlotlyGeoAssets.topojson[o.topojsonName]===void 0?a.push(o.fetchTopojson().then(function(a){PlotlyGeoAssets.topojson[o.topojsonName]=a,o.topojson=a,o.update(e,t)})):(o.topojson=PlotlyGeoAssets.topojson[o.topojsonName],o.update(e,t))):o.update(e,t)},w.fetchTopojson=function(){var e=_.getTopojsonPath(this.topojsonURL,this.topojsonName);return new Promise(function(t,a){l.json(e,function(o,r){return o?404===o.status?a(new Error(["plotly.js could not find topojson file at",e,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):a(new Error(["unexpected error while fetching topojson file at",e].join(" "))):void t(r)})})},w.update=function(e,t){var a=t[this.id],o=this.updateProjection(t,a);if(!o){this.hasChoropleth=!1;for(var r=0;r<e.length;r++)if("choropleth"===e[r][0].trace.type){this.hasChoropleth=!0;break}this.viewInitial||this.saveViewInitial(a),this.updateBaseLayers(t,a),this.updateDims(t,a),this.updateFx(t,a),g.generalUpdatePerTraceModule(this.graphDiv,this,e,a);var n=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=n.selectAll(".point"),this.dataPoints.text=n.selectAll("text"),this.dataPaths.line=n.selectAll(".js-line");var l=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=l.selectAll("path"),this.render()}},w.updateProjection=function(e,a){var r=e._size,l=a.domain,c=a.projection,p=c.rotation||{},u=a.center||{},g=this.projection=o(a);g.center([u.lon-p.lon,u.lat-p.lat]).rotate([-p.lon,-p.lat,p.roll]).parallels(c.parallels);var h=[[r.l+r.w*l.x[0],r.t+r.h*(1-l.y[1])],[r.l+r.w*l.x[1],r.t+r.h*(1-l.y[0])]],m=a.lonaxis,y=a.lataxis,f=n(m.range,y.range);g.fitExtent(h,f);var x=this.bounds=g.getBounds(f),b=this.fitScale=g.scale(),_=g.translate();if(!isFinite(x[0][0])||!isFinite(x[0][1])||!isFinite(x[1][0])||!isFinite(x[1][1])||isNaN(_[0])||isNaN(_[0])){for(var t=this.graphDiv,v=["projection.rotation","center","lonaxis.range","lataxis.range"],w="Invalid geo settings, relayout'ing to default view.",k={},T=0;T<v.length;T++)k[this.id+"."+v[T]]=null;return this.viewInitial=null,d.warn(w),t._promises.push(s.call("relayout",t,k)),w}var A=this.midPt=[(x[0][0]+x[1][0])/2,(x[0][1]+x[1][1])/2];if(g.scale(c.scale*b).translate([_[0]+(A[0]-_[0]),_[1]+(A[1]-_[1])]).clipExtent(x),a._isAlbersUsa){var S=g([u.lon,u.lat]),C=g.translate();g.translate([C[0]-(S[0]-C[0]),C[1]-(S[1]-C[1])])}},w.updateBaseLayers=function(e,t){function a(e){return"lonaxis"===e||"lataxis"===e}function o(e){return!!b.lineLayers[e]}function i(e){return!!b.fillLayers[e]}var n=this,s=n.topojson,u=n.layers,g=n.basePaths,h=this.hasChoropleth?b.layersForChoropleth:b.layers,m=h.filter(function(e){return o(e)||i(e)?t["show"+e]:!a(e)||t[e].showgrid}),y=n.framework.selectAll(".layer").data(m,String);y.exit().each(function(e){delete u[e],delete g[e],l.select(this).remove()}),y.enter().append("g").attr("class",function(e){return"layer "+e}).each(function(e){var t=u[e]=l.select(this);"bg"===e?n.bgRect=t.append("rect").style("pointer-events","all"):a(e)?g[e]=t.append("path").style("fill","none"):"backplot"===e?t.append("g").classed("choroplethlayer",!0):"frontplot"===e?t.append("g").classed("scatterlayer",!0):o(e)?g[e]=t.append("path").style("fill","none").style("stroke-miterlimit",2):i(e)&&(g[e]=t.append("path").style("stroke","none"))}),y.order(),y.each(function(e){var n=g[e],l=b.layerNameToAdjective[e];"frame"===e?n.datum(b.sphereSVG):o(e)||i(e)?n.datum(v(s,s.objects[e])):a(e)&&n.datum(r(e,t)).call(c.stroke,t[e].gridcolor).call(p.dashLine,"",t[e].gridwidth),o(e)?n.call(c.stroke,t[l+"color"]).call(p.dashLine,"",t[l+"width"]):i(e)&&n.call(c.fill,t[l+"color"])})},w.updateDims=function(e,a){var o=this.bounds,r=(a.framewidth||0)/2,i=o[0][0]-r,n=o[0][1]-r,t=o[1][0]-i+r,l=o[1][1]-n+r;p.setRect(this.clipRect,i,n,t,l),this.bgRect.call(p.setRect,i,n,t,l).call(c.fill,a.bgcolor),this.xaxis._offset=i,this.xaxis._length=t,this.yaxis._offset=n,this.yaxis._length=l},w.updateFx=function(e,t){function a(){var e=r.viewInitial,t={};for(var a in e)t[r.id+"."+a]=e[a];s.call("_guiRelayout",i,t),i.emit("plotly_doubleclick",null)}function o(e){return r.projection.invert([e[0]+r.xaxis._offset,e[1]+r.yaxis._offset])}var r=this,i=r.graphDiv,n=r.bgRect,d=e.dragmode,c=e.clickmode;if(!r.isStatic){var p;"select"===d?p=function(e,t){var a=e.range={};a[r.id]=[o([t.xmin,t.ymin]),o([t.xmax,t.ymax])]}:"lasso"===d&&(p=function(e,t,a){var i=e.lassoPoints={};i[r.id]=a.filtered.map(o)});var g={element:r.bgRect.node(),gd:i,plotinfo:{id:r.id,xaxis:r.xaxis,yaxis:r.yaxis,fillRangeItems:p},xaxes:[r.xaxis],yaxes:[r.yaxis],subplot:r.id,clickFn:function(t){2===t&&e._zoomlayer.selectAll(".select-outline").remove()}};"pan"===d?(n.node().onmousedown=null,n.call(x(r,t)),n.on("dblclick.zoom",a)):("select"===d||"lasso"===d)&&(n.on(".zoom",null),g.prepFn=function(t,e,a){y(t,e,a,g,d)},m.init(g)),n.on("mousemove",function(){var e=r.projection.invert(l.mouse(this));return!e||isNaN(e[0])||isNaN(e[1])?m.unhover(i,l.event):void(r.xaxis.p2c=function(){return e[0]},r.yaxis.p2c=function(){return e[1]},u.hover(i,l.event,r.id))}),n.on("mouseout",function(){i._dragging||m.unhover(i,l.event)}),n.on("click",function(){"select"!==d&&"lasso"!==d&&(-1<c.indexOf("select")&&f(l.event,i,[r.xaxis],[r.yaxis],r.id,g),-1<c.indexOf("event")&&u.click(i,l.event))})}},w.makeFramework=function(){var e=this,t=e.graphDiv,a=t._fullLayout,o="clip"+a._uid+e.id;e.clipDef=a._clips.append("clipPath").attr("id",o),e.clipRect=e.clipDef.append("rect"),e.framework=l.select(e.container).append("g").attr("class","geo "+e.id).call(p.setClipUrl,o,t),e.project=function(t){var a=e.projection(t);return a?[a[0]-e.xaxis._offset,a[1]-e.yaxis._offset]:[null,null]},e.xaxis={_id:"x",c2p:function(t){return e.project(t)[0]}},e.yaxis={_id:"y",c2p:function(t){return e.project(t)[1]}},e.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},h.setConvert(e.mockAxis,a)},w.saveViewInitial=function(e){var t=e.center||{},a=e.projection,o=a.rotation||{};this.viewInitial=e._isScoped?{"center.lon":t.lon,"center.lat":t.lat,"projection.scale":a.scale}:e._isClipped?{"projection.scale":a.scale,"projection.rotation.lon":o.lon,"projection.rotation.lat":o.lat}:{"center.lon":t.lon,"center.lat":t.lat,"projection.scale":a.scale,"projection.rotation.lon":o.lon}},w.render=function(){function e(e){var t=a(e.lonlat);return t?"translate("+t[0]+","+t[1]+")":null}function t(e){return a.isLonLatOverEdges(e.lonlat)?"none":null}var a=this.projection,o=a.getPath(),r;for(r in this.basePaths)this.basePaths[r].attr("d",o);for(r in this.dataPaths)this.dataPaths[r].attr("d",function(e){return o(e.geojson)});for(r in this.dataPoints)this.dataPoints[r].attr("display",t).attr("transform",e)}},{"../../components/color":569,"../../components/dragelement":587,"../../components/drawing":590,"../../components/fx":608,"../../lib":692,"../../lib/topojson_utils":719,"../../registry":823,"../cartesian/axes":740,"../cartesian/select":758,"../plots":804,"./constants":769,"./projections":775,"./zoom":776,d3:148,"topojson-client":516}],771:[function(e,t,a){"use strict";var o=e("./geo"),r=e("../../plots/get_data").getSubplotCalcData,i=e("../../lib").counterRegex,n="geo";a.name=n,a.attr=n,a.idRoot=n,a.idRegex=a.attrRegex=i(n),a.attributes=e("./layout/attributes"),a.layoutAttributes=e("./layout/layout_attributes"),a.supplyLayoutDefaults=e("./layout/defaults"),a.plot=function(e){var t=e._fullLayout,a=e.calcdata,l=t._subplots[n];window.PlotlyGeoAssets===void 0&&(window.PlotlyGeoAssets={topojson:{}});for(var s=0;s<l.length;s++){var d=l[s],c=r(a,n,d),p=t[d],u=p._subplot;u||(u=o({id:d,graphDiv:e,container:t._geolayer.node(),topojsonURL:e._context.topojsonURL,staticPlot:e._context.staticPlot}),t[d]._subplot=u),u.plot(c,t,e._promises)}},a.clean=function(e,t,a,o){for(var r=o._subplots[n]||[],l=0;l<r.length;l++){var s=r[l],d=o[s]._subplot;t[s]||!d||(d.framework.remove(),d.clipDef.remove())}},a.updateFx=function(e){for(var t=e._fullLayout,a=t._subplots[n],o=0;o<a.length;o++){var r=t[a[o]],l=r._subplot;l.updateFx(t,r)}}},{"../../lib":692,"../../plots/get_data":777,"./geo":770,"./layout/attributes":772,"./layout/defaults":773,"./layout/layout_attributes":774}],772:[function(e,t){"use strict";t.exports={geo:{valType:"subplotid",dflt:"geo",editType:"calc"}}},{}],773:[function(e,t){"use strict";function a(e,t,a){var o=a("resolution"),l=a("scope"),s=r.scopeDefaults[l],d=a("projection.type",s.projType),c=t._isAlbersUsa="albers usa"===d,p;c&&(l=t.scope="usa");var u=t._isScoped="world"!==l,g=t._isConic=-1!==d.indexOf("conic");t._isClipped=!!r.lonaxisSpan[d];for(var h=0;h<n.length;h++){var m=n[h],y=[30,10][h],f;if(u)f=s[m+"Range"];else{var x=r[m+"Span"],b=(x[d]||x["*"])/2,_=a("projection.rotation."+m.substr(0,3),s.projRotate[h]);f=[_-b,_+b]}var v=a(m+".range",f);a(m+".tick0",v[0]),a(m+".dtick",y),p=a(m+".showgrid"),p&&(a(m+".gridcolor"),a(m+".gridwidth"))}var w=t.lonaxis.range,k=t.lataxis.range,T=w[0],A=w[1];0<T&&0>A&&(A+=360);var S=(T+A)/2,C;if(!c){var L=u?s.projRotate:[S,0,0];C=a("projection.rotation.lon",L[0]),a("projection.rotation.lat",L[1]),a("projection.rotation.roll",L[2]),p=a("showcoastlines",!u),p&&(a("coastlinecolor"),a("coastlinewidth")),p=a("showocean"),p&&a("oceancolor")}var E,z;if(c?(E=-96.6,z=38.7):(E=u?S:C,z=(k[0]+k[1])/2),a("center.lon",E),a("center.lat",z),g){var I=s.projParallels||[0,60];a("projection.parallels",I)}a("projection.scale"),p=a("showland"),p&&a("landcolor"),p=a("showlakes"),p&&a("lakecolor"),p=a("showrivers"),p&&(a("rivercolor"),a("riverwidth")),p=a("showcountries",u&&"usa"!==l),p&&(a("countrycolor"),a("countrywidth")),("usa"===l||"north america"===l&&50===o)&&(a("showsubunits",!0),a("subunitcolor"),a("subunitwidth")),u||(p=a("showframe",!0),p&&(a("framecolor"),a("framewidth"))),a("bgcolor")}var o=e("../../subplot_defaults"),r=e("../constants"),i=e("./layout_attributes"),n=r.axesNames;t.exports=function(e,t,r){o(e,t,r,{type:"geo",attributes:i,handleDefaults:a,partition:"y"})}},{"../../subplot_defaults":818,"../constants":769,"./layout_attributes":774}],774:[function(e,t){"use strict";var a=e("../../../components/color/attributes"),o=e("../../domain").attributes,r=e("../constants"),i=e("../../../plot_api/edit_types").overrideAll,n={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number"},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:a.lightLine},gridwidth:{valType:"number",min:0,dflt:1}},l=t.exports=i({domain:o({name:"geo"},{}),resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:Object.keys(r.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:Object.keys(r.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:a.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:r.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:r.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:r.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:r.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:a.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:a.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:a.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:a.background},lonaxis:n,lataxis:n},"plot","from-root");l.uirevision={valType:"any",editType:"none"}},{"../../../components/color/attributes":568,"../../../plot_api/edit_types":723,"../../domain":766,"../constants":769}],775:[function(e,t){"use strict";t.exports=function(e){function t(e,t){return{type:"Feature",id:e.id,properties:e.properties,geometry:a(e.geometry,t)}}function a(t,o){if(!t)return null;if("GeometryCollection"===t.type)return{type:"GeometryCollection",geometries:object.geometries.map(function(e){return a(e,o)})};if(!I.hasOwnProperty(t.type))return null;var r=I[t.type];return e.geo.stream(t,o(r)),r.result()}function o(){}function r(e){if(4>(o=e.length))return!1;for(var t=0,a=e[o-1][1]*e[0][0]-e[o-1][0]*e[0][1],o;++t<o;)a+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return 0>=a}function i(e,t){for(var a=t[0],o=t[1],r=!1,l=0,s=e.length,n=s-1;l<s;n=l++){var d=e[l],c=d[0],p=d[1],u=e[n],g=u[0],h=u[1];p>o^h>o&&a<(g-c)*(o-p)/(h-p)+c&&(r=!r)}return r}function n(e){return e?e/M(e):1}function l(e){return 1<e?R:-1>e?-R:_(e)}function s(e){return 1<e?0:-1>e?O:v(e)}function d(e,t){var a=(2+R)*M(t);t/=2;for(var o=0,r=1/0,n;10>o&&wa(r)>D;o++)n=te(t),t-=r=(t+M(t)*(n+2)-a)/(2*n*(1+n));return[2/re(O*(4+O))*e*(1+te(t)),2*re(O/(4+O))*M(t)]}function c(e,t){function a(a,o){var r=N(a/t,o);return r[0]*=e,r}return(2>arguments.length&&(t=e),1===t)?N:t===1/0?p:(a.invert=function(a,o){var r=N.invert(a/e,o);return r[0]*=t,r},a)}function p(e,t){return[e*te(t)/te(t/=2),2*M(t)]}function u(e,t){return[3*e/(2*O)*re(O*O/3-t*t),t]}function h(e,t){return[e,1.25*P(g(O/4+.4*t))]}function m(e){return function(t){var a=e*M(t),o=30,r;do t-=r=(t+M(t)-a)/(1+te(t));while(wa(r)>D&&0<--o);return t/2}}function y(e,t){var a=t*t,o=a*a;return[e*(.8707-.131979*a+o*(-.013791+o*(.003971*a-.001529*o))),t*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))]}function f(e,t){var a=ie(18,36*wa(t)/O),o=ea(a),r=a-o,i=(p=H[o])[0],n=p[1],l=(p=H[++o])[0],s=p[1],d=(p=H[ie(19,++o)])[0],c=p[1],p;return[e*(l+r*(d-i)/2+r*r*(d-2*l+i)/2),(0<t?R:-R)*(s+r*(c-n)/2+r*r*(c-2*s+n)/2)]}function x(e,t){return[e*te(t),t]}function b(e,t){var a=te(t),o=n(s(a*te(e/=2)));return[2*a*M(e)*o,M(t)*o]}function T(e,t){var a=b(e,t);return[(a[0]+e/R)/2,(a[1]+t)/2]}e.geo.project=function(e,t){var o=t.stream;if(!o)throw new Error("not yet supported");return(e&&A.hasOwnProperty(e.type)?A[e.type]:a)(e,o)};var A={Feature:t,FeatureCollection:function(e,a){return{type:"FeatureCollection",features:e.features.map(function(e){return t(e,a)})}}},S=[],C=[],L={point:function(e,t){S.push([e,t])},result:function(){var e=S.length?2>S.length?{type:"Point",coordinates:S[0]}:{type:"MultiPoint",coordinates:S}:null;return S=[],e}},E={lineStart:o,point:function(e,t){S.push([e,t])},lineEnd:function(){S.length&&(C.push(S),S=[])},result:function(){var e=C.length?2>C.length?{type:"LineString",coordinates:C[0]}:{type:"MultiLineString",coordinates:C}:null;return C=[],e}},z={polygonStart:o,lineStart:o,point:function(e,t){S.push([e,t])},lineEnd:function(){var e=S.length;if(e){do S.push(S[0].slice());while(4>++e);C.push(S),S=[]}},polygonEnd:o,result:function(){if(!C.length)return null;var e=[],t=[];return C.forEach(function(a){r(a)?e.push([a]):t.push(a)}),t.forEach(function(t){var a=t[0];e.some(function(e){if(i(e[0],a))return e.push(t),!0})||e.push([t])}),C=[],e.length?1<e.length?{type:"MultiPolygon",coordinates:e}:{type:"Polygon",coordinates:e[0]}:null}},I={Point:L,MultiPoint:L,LineString:E,MultiLineString:E,Polygon:z,MultiPolygon:z,Sphere:z},D=1e-6,O=Sa,R=O/2,j=re(O),B=e.geo.projection,F=e.geo.projectionMutator;e.geo.interrupt=function(a){function o(e,t){for(var o=0>t?-1:1,r=s[+(0>t)],l=0,d=r.length-1;l<d&&e>r[l][2][0];++l);var n=a(e-r[l][1][0],t);return n[0]+=a(r[l][1][0],o*t>o*r[l][0][1]?r[l][0][1]:t)[0],n}function r(){d=s.map(function(e){return e.map(function(e){var o=a(e[0][0],e[0][1])[0],r=a(e[2][0],e[2][1])[0],i=a(e[1][0],e[0][1])[1],n=a(e[1][0],e[1][1])[1],l;return i>n&&(l=i,i=n,n=l),[[o,i],[r,n]]})})}function i(){for(var t=1e-6,a=[],o=0,r=s[0].length;o<r;++o){var l=s[0][o],d=180*l[0][0]/O,c=180*l[0][1]/O,p=180*l[1][1]/O,u=180*l[2][0]/O,g=180*l[2][1]/O;a.push(n([[d+t,c+t],[d+t,p-t],[u-t,p-t],[u-t,g+t]],30))}for(var o=s[1].length-1;0<=o;--o){var l=s[1][o],d=180*l[0][0]/O,c=180*l[0][1]/O,p=180*l[1][1]/O,u=180*l[2][0]/O,g=180*l[2][1]/O;a.push(n([[u-t,g-t],[u-t,p+t],[d+t,p+t],[d+t,c-t]],30))}return{type:"Polygon",coordinates:[e.merge(a)]}}function n(e,t){for(var a=-1,o=e.length,r=e[0],n=[],l,s,d;++a<o;){l=e[a],s=(l[0]-r[0])/t,d=(l[1]-r[1])/t;for(var c=0;c<t;++c)n.push([r[0]+c*s,r[1]+c*d]);r=l}return n.push(l),n}function l(e,t){return wa(e[0]-t[0])<D&&wa(e[1]-t[1])<D}var s=[[[[-O,0],[0,R],[O,0]]],[[[-O,0],[0,-R],[O,0]]]],d;a.invert&&(o.invert=function(e,t){for(var r=d[+(0>t)],c=s[+(0>t)],p=0,u=r.length,n;p<u;++p)if(n=r[p],n[0][0]<=e&&e<n[1][0]&&n[0][1]<=t&&t<n[1][1]){var g=a.invert(e-a(c[p][1][0],0)[0],t);return g[0]+=c[p][1][0],l(o(g[0],g[1]),[e,t])?g:null}});var c=e.geo.projection(o),p=c.stream;return c.stream=function(t){var a=c.rotate(),o=p(t),r=(c.rotate([0,0]),p(t));return c.rotate(a),o.sphere=function(){e.geo.stream(i(),r)},o},c.lobes=function(e){return arguments.length?(s=e.map(function(e){return e.map(function(e){return[[e[0][0]*O/180,e[0][1]*O/180],[e[1][0]*O/180,e[1][1]*O/180],[e[2][0]*O/180,e[2][1]*O/180]]})}),r(),c):s.map(function(e){return e.map(function(e){return[[180*e[0][0]/O,180*e[0][1]/O],[180*e[1][0]/O,180*e[1][1]/O],[180*e[2][0]/O,180*e[2][1]/O]]})})},c},d.invert=function(e,t){var a=.5*t*re((4+O)/O),o=l(a),r=te(o);return[e/(2/re(O*(4+O))*(1+r)),l((o+a*(r+2))/(2+R))]},(e.geo.eckert4=function(){return B(d)}).raw=d;var N=e.geo.azimuthalEqualArea.raw;p.invert=function(e,t){var a=2*l(t/2);return[e*te(a/2)/te(a),a]},(e.geo.hammer=function(){var e=2,t=F(c),a=t(e);return a.coefficient=function(a){return arguments.length?t(e=+a):e},a}).raw=c,u.invert=function(e,t){return[2/3*O*e/re(O*O/3-t*t),t]},(e.geo.kavrayskiy7=function(){return B(u)}).raw=u,h.invert=function(e,t){return[e,2.5*k(ka(.8*t))-.625*O]},(e.geo.miller=function(){return B(h)}).raw=h;var V=m(O),U=function(e,t,a){function o(a,o){return[e*a*te(o=r(o)),t*M(o)]}var r=m(a);return o.invert=function(o,r){var i=l(r/t);return[o/(e*te(i)),l((2*i+M(2*i))/a)]},o}(w/R,Math.SQRT2,O);(e.geo.mollweide=function(){return B(U)}).raw=U,y.invert=function(e,t){var a=t,o=25,r;do{var n=a*a,l=n*n;a-=r=(a*(1.007226+n*(.015085+l*(-.044475+.028874*n-.005916*l)))-t)/(1.007226+n*(3*.015085+l*(7*-.044475+9*.028874*n-11*.005916*l)))}while(wa(r)>D&&0<--o);return[e/(.8707+(n=a*a)*(-.131979+n*(-.013791+n*n*n*(.003971-.001529*n)))),a]},(e.geo.naturalEarth=function(){return B(y)}).raw=y;var H=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];H.forEach(function(e){e[1]*=1.0144}),f.invert=function(e,a){var o=a/R,r=90*o,n=ie(18,wa(r/5)),l=va(0,ea(n));do{var s=H[l][1],d=H[l+1][1],p=H[ie(19,l+2)][1],g=p-s,u=p-2*d+s,h=2*(wa(o)-d)/g,t=u/g,c=h*(1-t*h*(1-2*t*h));if(0<=c||1===l){r=(0<=a?5:-5)*(c+n);var m=50,y;do n=ie(18,wa(r)/5),l=ea(n),c=n-l,s=H[l][1],d=H[l+1][1],p=H[ie(19,l+2)][1],r-=(y=(0<=a?R:-R)*(d+c*(p-s)/2+c*c*(p-2*d+s)/2)-a)*(180/O);while(wa(y)>D*D&&0<--m);break}}while(0<=--l);var f=H[l][0],x=H[l+1][0],b=H[ie(19,l+2)][0];return[e/(x+c*(b-f)/2+c*c*(b-2*x+f)/2),r*(O/180)]},(e.geo.robinson=function(){return B(f)}).raw=f,x.invert=function(e,t){return[e/te(t),t]},(e.geo.sinusoidal=function(){return B(x)}).raw=x,b.invert=function(e,t){if(!(e*e+4*t*t>O*O+D)){var a=e,o=t,r=25;do{var n=M(a),l=M(a/2),d=te(a/2),c=M(o),p=te(o),u=M(2*o),g=c*c,h=p*p,m=l*l,y=1-h*d*d,f=y?s(p*d)*re(A=1/y):A=0,x=2*f*p*l-e,b=f*c-t,_=A*(h*m+f*p*d*g),v=A*(.5*n*u-2*f*c*l),w=.25*A*(u*l-f*c*h*n),k=A*(g*d+f*m*p),T=v*w-k*_,A;if(!T)break;var S=(b*v-x*k)/T,C=(x*w-b*_)/T;a-=S,o-=C}while((wa(S)>D||wa(C)>D)&&0<--r);return[a,o]}},(e.geo.aitoff=function(){return B(b)}).raw=b,T.invert=function(e,t){var a=e,o=t,r=25;do{var n=te(o),l=M(o),d=M(2*o),c=l*l,p=n*n,u=M(a),g=te(a/2),h=M(a/2),m=h*h,y=1-p*g*g,f=y?s(n*g)*re(C=1/y):C=0,x=.5*(2*f*n*h+a/R)-e,b=.5*(f*l+o)-t,_=.5*C*(p*m+f*n*g*c)+.5/R,v=C*(u*d/4-f*l*h),w=.125*C*(d*h-f*l*p*u),k=.5*C*(c*g+f*m*n)+.5,T=v*w-k*_,A=(b*v-x*k)/T,S=(x*w-b*_)/T,C;a-=A,o-=S}while((wa(A)>D||wa(S)>D)&&0<--r);return[a,o]},(e.geo.winkel3=function(){return B(T)}).raw=T}},{}],776:[function(e,t){"use strict";function a(e,t){return T.behavior.zoom().translate(t.translate()).scale(t.scale())}function o(e,t,a){function o(e,t){var a=h.nestedProperty(d,e);a.get()!==t&&(a.set(t),h.nestedProperty(l,e).set(t),c[r+"."+e]=t)}var r=e.id,i=e.graphDiv,n=i.layout,l=n[r],s=i._fullLayout,d=s[r],c={};a(o),o("projection.scale",t.scale()/e.fitScale),b.call("_storeDirectGUIEdit",n,s._preGUI,c),i.emit("plotly_relayout",c)}function r(e,t){function r(a){var o=t.invert(e.midPt);a("center.lon",o[0]),a("center.lat",o[1])}var i=a(e,t);return i.on("zoomstart",function(){T.select(this).style(C)}).on("zoom",function(){t.scale(T.event.scale).translate(T.event.translate),e.render()}).on("zoomend",function(){T.select(this).style(E),o(e,t,r)}),i}function i(e,t){function r(e){return t.invert(e)}function i(e){var a=r(e);if(!a)return!0;var o=t(a);return 2<wa(o[0]-e[0])||2<wa(o[1]-e[1])}function n(){T.select(this).style(C),p=T.mouse(this),u=t.rotate(),g=t.translate(),h=u,m=r(p)}function l(){return y=T.mouse(this),i(p)?(c.scale(t.scale()),void c.translate(t.translate())):void(t.scale(T.event.scale),t.translate([g[0],T.event.translate[1]]),m?r(y)&&(x=r(y),f=[h[0]+(x[0]-m[0]),u[1],u[2]],t.rotate(f),h=f):(p=y,m=r(p)),b=!0,e.render())}function s(){T.select(this).style(E),b&&o(e,t,d)}function d(a){var o=t.rotate(),r=t.invert(e.midPt);a("projection.rotation.lon",-o[0]),a("center.lon",r[0]),a("center.lat",r[1])}var c=a(e,t),p,u,g,h,m,y,f,x,b;return c.on("zoomstart",n).on("zoom",l).on("zoomend",s),c}function n(e,t){function r(e){f++||e({type:"zoomstart"})}function i(e){e({type:"zoom"})}function n(e){--f||e({type:"zoomend"})}function u(e){var a=t.rotate();e("projection.rotation.lon",-a[0]),e("projection.rotation.lat",-a[1])}var g={r:t.rotate(),k:t.scale()},h=a(e,t),m=k(h,"zoomstart","zoom","zoomend"),f=0,x=h.on,b;return h.on("zoomstart",function(){T.select(this).style(C);var e=T.mouse(this),a=t.rotate(),o=a,n=t.translate(),u=s(a);b=l(t,e),x.call(h,"zoom",function(){var r=T.mouse(this);if(t.scale(g.k=T.event.scale),!b)e=r,b=l(t,e);else if(l(t,r)){t.rotate(a).translate(n);var s=l(t,r),h=c(b,s),f=y(d(u,h)),x=g.r=p(f,b,o);isFinite(x[0])&&isFinite(x[1])&&isFinite(x[2])||(x=o),t.rotate(x),o=x}i(m.of(this,arguments))}),r(m.of(this,arguments))}).on("zoomend",function(){T.select(this).style(E),x.call(h,"zoom",null),n(m.of(this,arguments)),o(e,t,u)}).on("zoom.redraw",function(){e.render()}),T.rebind(h,m,"on")}function l(e,t){var a=e.invert(t);return a&&isFinite(a[0])&&isFinite(a[1])&&f(a)}function s(e){var t=.5*e[0]*A,a=.5*e[1]*A,o=.5*e[2]*A,r=M(t),i=te(t),n=M(a),l=te(a),s=M(o),d=te(o);return[i*l*d+r*n*s,r*l*d-i*n*s,i*n*d+r*l*s,i*l*s-r*n*d]}function d(e,t){var a=e[0],o=e[1],r=e[2],i=e[3],n=t[0],l=t[1],s=t[2],d=t[3];return[a*n-o*l-r*s-i*d,a*l+o*n+r*d-i*s,a*s-o*d+r*n+i*l,a*d+o*s-r*l+i*n]}function c(e,t){if(e&&t){var a=w(e,t),o=re(x(a,a)),r=.5*v(va(-1,ie(1,x(e,t)))),i=M(r)/o;return o&&[te(r),a[2]*i,-a[1]*i,a[0]*i]}}function p(e,t,o){var r=m(t,2,e[0]);r=m(r,1,e[1]),r=m(r,0,e[2]-o[2]);var i=t[0],n=t[1],l=t[2],s=r[0],d=r[1],c=r[2],p=L(n,i)*S,g=re(i*i+n*n),a,h;wa(d)>g?(h=(0<d?90:-90)-p,a=0):(h=_(d/g)*S-p,a=re(g*g-d*d));var y=180-h-2*p,f=(L(c,s)-L(l,a))*S,x=(L(c,s)-L(l,-a))*S,v=u(o[0],o[1],h,f),w=u(o[0],o[1],y,x);return v<=w?[h,f,o[2]]:[y,x,o[2]]}function u(e,t,a,o){var r=g(a-e),i=g(o-t);return re(r*r+i*i)}function g(e){return(e%360+540)%360-180}function m(e,t,a){var o=a*A,r=e.slice(),i=0===t?1:0,n=2===t?1:2,l=te(o),s=M(o);return r[i]=e[i]*l-e[n]*s,r[n]=e[n]*l+e[i]*s,r}function y(e){return[L(2*(e[0]*e[1]+e[2]*e[3]),1-2*(e[1]*e[1]+e[2]*e[2]))*S,_(va(-1,ie(1,2*(e[0]*e[2]-e[3]*e[1]))))*S,L(2*(e[0]*e[3]+e[1]*e[2]),1-2*(e[2]*e[2]+e[3]*e[3]))*S]}function f(e){var t=e[0]*A,a=e[1]*A,o=te(a);return[o*te(t),o*M(t),M(a)]}function x(e,t){for(var a=0,o=0,r=e.length;o<r;++o)a+=e[o]*t[o];return a}function w(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function k(e){for(var t=0,a=arguments.length,o=[];++t<a;)o.push(arguments[t]);var r=T.dispatch.apply(null,o);return r.of=function(t,a){return function(o){var i;try{i=o.sourceEvent=T.event,o.target=e,T.event=o,r[o.type].apply(t,a)}finally{T.event=i}}},r}var T=e("d3"),h=e("../../lib"),b=e("../../registry"),A=Sa/180,S=180/Sa,C={cursor:"pointer"},E={cursor:"auto"};t.exports=function(e,t){var a=e.projection,o;return o=t._isScoped?r:t._isClipped?n:i,o(e,a)}},{"../../lib":692,"../../registry":823,d3:148}],777:[function(e,t,a){"use strict";var o=e("../registry"),r=e("./cartesian/constants").SUBPLOT_PATTERN;a.getSubplotCalcData=function(e,t,a){var r=o.subplotsRegistry[t];if(!r)return[];for(var n=r.attr,l=[],s=0;s<e.length;s++){var d=e[s],c=d[0].trace;c[n]===a&&l.push(d)}return l},a.getModuleCalcData=function(e,t){var a=[],r=[],n;if(n="string"==typeof t?o.getModule(t).plot:"function"==typeof t?t:t.plot,!n)return[a,e];for(var l=0;l<e.length;l++){var s=e[l],d=s[0].trace;!0===d.visible&&(d._module.plot===n?a.push(s):r.push(s))}return[a,r]},a.getSubplotData=function(e,t,a){if(!o.subplotsRegistry[t])return[];var n=o.subplotsRegistry[t].attr,l=[],s,d,c;if("gl2d"===t){var p=a.match(r);d="x"+p[1],c="y"+p[2]}for(var u=0;u<e.length;u++)s=e[u],"gl2d"===t&&o.traceIs(s,"gl2d")?s[n[0]]===d&&s[n[1]]===c&&l.push(s):s[n]===a&&l.push(s);return l}},{"../registry":823,"./cartesian/constants":746}],778:[function(e,t){"use strict";function a(e,t){this.element=e,this.plot=t,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}var o=e("mouse-change"),r=e("mouse-wheel"),i=e("mouse-event-offset"),n=e("../cartesian/constants"),l=e("has-passive-events");t.exports=function(e){function t(){e.xaxis.autorange=!1,e.yaxis.autorange=!1}function s(){for(var t=e.graphDiv._fullLayout._axisConstraintGroups,a=e.xaxis._id,o=e.yaxis._id,r=0;r<t.length;r++)if(-1!==t[r][a]){if(-1!==t[r][o])return!0;break}return!1}function d(a,o,r){function i(t,a,o){var r=ie(a,o),i=va(a,o);r===i?(e.selectBox.selectBox=[0,0,1,1],e.glplot.setDirty()):(l[t]=r,l[t+2]=i,u.dataBox=l,e.setRanges(l))}var l=e.calcDataBox(),d=p.viewBox,c=u.lastPos[0],g=u.lastPos[1],h=n.MINDRAG*p.pixelRatio,m=n.MINZOOM*p.pixelRatio,f,b;switch(o*=p.pixelRatio,r*=p.pixelRatio,r=d[3]-d[1]-r,e.fullLayout.dragmode){case"zoom":if(a){var _=o/(d[2]-d[0])*(l[2]-l[0])+l[0],v=r/(d[3]-d[1])*(l[3]-l[1])+l[1];u.boxInited||(u.boxStart[0]=_,u.boxStart[1]=v,u.dragStart[0]=o,u.dragStart[1]=r),u.boxEnd[0]=_,u.boxEnd[1]=v,u.boxInited=!0,u.boxEnabled||u.boxStart[0]===u.boxEnd[0]&&u.boxStart[1]===u.boxEnd[1]||(u.boxEnabled=!0);var w=wa(u.dragStart[0]-o)<m,k=wa(u.dragStart[1]-r)<m;if(s()&&!(w&&k)){f=u.boxEnd[0]-u.boxStart[0],b=u.boxEnd[1]-u.boxStart[1];var T=(l[3]-l[1])/(l[2]-l[0]);wa(f*T)>wa(b)?(u.boxEnd[1]=u.boxStart[1]+wa(f)*T*(0<=b?1:-1),u.boxEnd[1]<l[1]?(u.boxEnd[1]=l[1],u.boxEnd[0]=u.boxStart[0]+(l[1]-u.boxStart[1])/wa(T)):u.boxEnd[1]>l[3]&&(u.boxEnd[1]=l[3],u.boxEnd[0]=u.boxStart[0]+(l[3]-u.boxStart[1])/wa(T))):(u.boxEnd[0]=u.boxStart[0]+wa(b)/T*(0<=f?1:-1),u.boxEnd[0]<l[0]?(u.boxEnd[0]=l[0],u.boxEnd[1]=u.boxStart[1]+(l[0]-u.boxStart[0])*wa(T)):u.boxEnd[0]>l[2]&&(u.boxEnd[0]=l[2],u.boxEnd[1]=u.boxStart[1]+(l[2]-u.boxStart[0])*wa(T)))}else w&&(u.boxEnd[0]=u.boxStart[0]),k&&(u.boxEnd[1]=u.boxStart[1])}else u.boxEnabled?(f=u.boxStart[0]!==u.boxEnd[0],b=u.boxStart[1]!==u.boxEnd[1],f||b?(f&&(i(0,u.boxStart[0],u.boxEnd[0]),e.xaxis.autorange=!1),b&&(i(1,u.boxStart[1],u.boxEnd[1]),e.yaxis.autorange=!1),e.relayoutCallback()):e.glplot.setDirty(),u.boxEnabled=!1,u.boxInited=!1):u.boxInited&&(u.boxInited=!1);break;case"pan":u.boxEnabled=!1,u.boxInited=!1,a?(!u.panning&&(u.dragStart[0]=o,u.dragStart[1]=r),wa(u.dragStart[0]-o)<h&&(o=u.dragStart[0]),wa(u.dragStart[1]-r)<h&&(r=u.dragStart[1]),f=(c-o)*(l[2]-l[0])/(p.viewBox[2]-p.viewBox[0]),b=(g-r)*(l[3]-l[1])/(p.viewBox[3]-p.viewBox[1]),l[0]+=f,l[2]+=f,l[1]+=b,l[3]+=b,e.setRanges(l),u.panning=!0,u.lastInputTime=Date.now(),t(),e.cameraChanged(),e.handleAnnotations()):u.panning&&(u.panning=!1,e.relayoutCallback());}u.lastPos[0]=o,u.lastPos[1]=r}var c=e.mouseContainer,p=e.glplot,u=new a(c,p);return u.mouseListener=o(c,d),c.addEventListener("touchstart",function(e){var t=i(e.changedTouches[0],c);d(0,t[0],t[1]),d(1,t[0],t[1]),e.preventDefault()},!!l&&{passive:!1}),c.addEventListener("touchmove",function(e){e.preventDefault();var t=i(e.changedTouches[0],c);d(1,t[0],t[1]),e.preventDefault()},!!l&&{passive:!1}),c.addEventListener("touchend",function(e){d(0,u.lastPos[0],u.lastPos[1]),e.preventDefault()},!!l&&{passive:!1}),u.wheelListener=r(c,function(a,o){if(!e.scrollZoom)return!1;var r=e.calcDataBox(),i=p.viewBox,n=u.lastPos[0],l=u.lastPos[1],s=ka(5*o/(i[3]-i[1])),d=n/(i[2]-i[0])*(r[2]-r[0])+r[0],c=l/(i[3]-i[1])*(r[3]-r[1])+r[1];return r[0]=(r[0]-d)*s+d,r[2]=(r[2]-d)*s+d,r[1]=(r[1]-c)*s+c,r[3]=(r[3]-c)*s+c,e.setRanges(r),u.lastInputTime=Date.now(),t(),e.cameraChanged(),e.handleAnnotations(),e.relayoutCallback(),!0},!0),u}},{"../cartesian/constants":746,"has-passive-events":394,"mouse-change":418,"mouse-event-offset":419,"mouse-wheel":421}],779:[function(e,t){"use strict";function a(e){this.scene=e,this.gl=e.gl,this.pixelRatio=e.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Sa/2,0,3*Sa/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=!1,this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var o=e("../cartesian/axes"),r=e("../../lib/str2rgbarray"),i=a.prototype,n=["xaxis","yaxis"];i.merge=function(e){this.titleEnable=!1,this.backgroundColor=r(e.plot_bgcolor);var t,a,o,l,s,d,c,p,u,g,h;for(g=0;2>g;++g){t=n[g];var m=t.charAt(0);for(a=e[this.scene[t]._name],o=a.title.text===this.scene.fullLayout._dfltTitle[m]?"":a.title.text,h=0;2>=h;h+=2)this.labelEnable[g+h]=!1,this.labels[g+h]=o,this.labelColor[g+h]=r(a.title.font.color),this.labelFont[g+h]=a.title.font.family,this.labelSize[g+h]=a.title.font.size,this.labelPad[g+h]=this.getLabelPad(t,a),this.tickEnable[g+h]=!1,this.tickColor[g+h]=r((a.tickfont||{}).color),this.tickAngle[g+h]="auto"===a.tickangle?0:Sa*-a.tickangle/180,this.tickPad[g+h]=this.getTickPad(a),this.tickMarkLength[g+h]=0,this.tickMarkWidth[g+h]=a.tickwidth||0,this.tickMarkColor[g+h]=r(a.tickcolor),this.borderLineEnable[g+h]=!1,this.borderLineColor[g+h]=r(a.linecolor),this.borderLineWidth[g+h]=a.linewidth||0;c=this.hasSharedAxis(a),s=this.hasAxisInDfltPos(t,a)&&!c,d=this.hasAxisInAltrPos(t,a)&&!c,l=a.mirror||!1,p=c?-1!==(l+"").indexOf("all"):!!l,u=c?"allticks"===l:-1!==(l+"").indexOf("ticks"),s?this.labelEnable[g]=!0:d&&(this.labelEnable[g+2]=!0),s?this.tickEnable[g]=a.showticklabels:d&&(this.tickEnable[g+2]=a.showticklabels),(s||p)&&(this.borderLineEnable[g]=a.showline),(d||p)&&(this.borderLineEnable[g+2]=a.showline),(s||u)&&(this.tickMarkLength[g]=this.getTickMarkLength(a)),(d||u)&&(this.tickMarkLength[g+2]=this.getTickMarkLength(a)),this.gridLineEnable[g]=a.showgrid,this.gridLineColor[g]=r(a.gridcolor),this.gridLineWidth[g]=a.gridwidth,this.zeroLineEnable[g]=a.zeroline,this.zeroLineColor[g]=r(a.zerolinecolor),this.zeroLineWidth[g]=a.zerolinewidth}},i.hasSharedAxis=function(e){var t=this.scene,a=t.fullLayout._subplots.gl2d,r=o.findSubplotsWithAxis(a,e);return 0!==r.indexOf(t.id)},i.hasAxisInDfltPos=function(e,t){var a=t.side;if("xaxis"===e)return"bottom"===a;return"yaxis"===e?"left"===a:void 0},i.hasAxisInAltrPos=function(e,t){var a=t.side;if("xaxis"===e)return"top"===a;return"yaxis"===e?"right"===a:void 0},i.getLabelPad=function(e,t){var a=1.5,o=t.title.font.size,r=t.showticklabels;if("xaxis"===e)return"top"===t.side?-10+o*(a+(r?1:0)):-10+o*(a+(r?.5:0));return"yaxis"===e?"right"===t.side?10+o*(a+(r?1:.5)):10+o*(a+(r?.5:0)):void 0},i.getTickPad=function(e){return"outside"===e.ticks?10+e.ticklen:15},i.getTickMarkLength=function(e){if(!e.ticks)return 0;var t=e.ticklen;return"inside"===e.ticks?-t:t},t.exports=function(e){return new a(e)}},{"../../lib/str2rgbarray":715,"../cartesian/axes":740}],780:[function(e,t,a){"use strict";var o=e("../../plot_api/edit_types").overrideAll,r=e("./scene2d"),i=e("../layout_attributes"),n=e("../../constants/xmlns_namespaces"),l=e("../cartesian/constants"),s=e("../cartesian"),d=e("../../components/fx/layout_attributes"),c=e("../get_data").getSubplotData;a.name="gl2d",a.attr=["xaxis","yaxis"],a.idRoot=["x","y"],a.idRegex=l.idRegex,a.attrRegex=l.attrRegex,a.attributes=e("../cartesian/attributes"),a.supplyLayoutDefaults=function(e,t,a){t._has("cartesian")||s.supplyLayoutDefaults(e,t,a)},a.layoutAttrOverrides=o(s.layoutAttributes,"plot","from-root"),a.baseLayoutAttrOverrides=o({plot_bgcolor:i.plot_bgcolor,hoverlabel:d.hoverlabel},"plot","nested"),a.plot=function(e){for(var t=e._fullLayout,a=e._fullData,o=t._subplots.gl2d,n=0;n<o.length;n++){var l=o[n],s=t._plots[l],d=c(a,"gl2d",l),p=s._scene2d;p===void 0&&(p=new r({id:l,graphDiv:e,container:e.querySelector(".gl-container"),staticPlot:e._context.staticPlot,plotGlPixelRatio:e._context.plotGlPixelRatio},t),s._scene2d=p),p.plot(d,e.calcdata,t,e.layout)}},a.clean=function(e,t,a,o){for(var r=o._subplots.gl2d||[],n=0;n<r.length;n++){var l=r[n],d=o._plots[l];if(d._scene2d){var p=c(e,"gl2d",l);0===p.length&&(d._scene2d.destroy(),delete o._plots[l])}}s.clean.apply(this,arguments)},a.drawFramework=function(e){e._context.staticPlot||s.drawFramework(e)},a.toSVG=function(e){for(var t=e._fullLayout,a=t._subplots.gl2d,o=0;o<a.length;o++){var r=t._plots[a[o]],l=r._scene2d,s=l.toImage("png"),d=t._glimages.append("svg:image");d.attr({xmlns:n.svg,"xlink:href":s,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),l.destroy()}},a.updateFx=function(e){for(var t=e._fullLayout,a=t._subplots.gl2d,o=0,r;o<a.length;o++)r=t._plots[a[o]]._scene2d,r.updateFx(t.dragmode)}},{"../../components/fx/layout_attributes":609,"../../constants/xmlns_namespaces":670,"../../plot_api/edit_types":723,"../cartesian":752,"../cartesian/attributes":738,"../cartesian/constants":746,"../get_data":777,"../layout_attributes":795,"./scene2d":781}],781:[function(e,t){"use strict";function a(e,t){this.container=e.container,this.graphDiv=e.graphDiv,this.pixelRatio=e.plotGlPixelRatio||window.devicePixelRatio,this.id=e.id,this.staticPlot=!!e.staticPlot,this.scrollZoom=this.graphDiv._context.scrollZoom,this.fullData=null,this.updateRefs(t),this.makeFramework();this.stopped||(this.glplotOptions=p(this),this.glplotOptions.merge(t),this.glplot=i(this.glplotOptions),this.camera=u(this),this.traces={},this.spikes=s(this.glplot),this.selectBox=d(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}function o(e,t){for(var a=0;2>a;++a){var o=e[a],r=t[a];if(o.length!==r.length)return!0;for(var n=0;n<o.length;++n)if(o[n].x!==r[n].x)return!0}return!1}var r=e("../../registry"),n=e("../../plots/cartesian/axes"),l=e("../../components/fx"),i=e("gl-plot2d"),s=e("gl-spikes2d"),d=e("gl-select-box"),c=e("webgl-context"),p=e("./convert"),u=e("./camera"),g=e("../../lib/show_no_webgl_msg"),h=e("../cartesian/constraints"),m=h.enforce,y=h.clean,f=e("../cartesian/autorange").doAutoRange,x=["xaxis","yaxis"],b=e("../cartesian/constants").SUBPLOT_PATTERN,_,v;t.exports=a;var w=a.prototype;w.makeFramework=function(){if(this.staticPlot){if(!v&&(_=document.createElement("canvas"),v=c({canvas:_,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}),!v))throw new Error("Error creating static canvas/context for image server");this.canvas=_,this.gl=v}else{var e=this.container.querySelector(".gl-canvas-focus"),t=c({canvas:e,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!t)return g(this),void(this.stopped=!0);this.canvas=e,this.gl=t}var a=this.canvas;a.style.width="100%",a.style.height="100%",a.style.position="absolute",a.style.top="0px",a.style.left="0px",a.style["pointer-events"]="none",this.updateSize(a),a.className+=" user-select-none";var o=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");o.style.position="absolute",o.style.top=o.style.left="0px",o.style.width=o.style.height="100%",o.style["z-index"]=20,o.style["pointer-events"]="none";var r=this.mouseContainer=document.createElement("div");r.style.position="absolute",r.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var i=this.container;i.appendChild(o),i.appendChild(r);var n=this;r.addEventListener("mouseout",function(){n.isMouseOver=!1,n.unhover()}),r.addEventListener("mouseover",function(){n.isMouseOver=!0})},w.toImage=function(e){e||(e="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(_),this.updateSize(this.canvas);var t=this.glplot.gl,a=t.drawingBufferWidth,o=t.drawingBufferHeight;t.clearColor(1,1,1,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),t.bindFramebuffer(t.FRAMEBUFFER,null);var r=new Uint8Array(4*(a*o));t.readPixels(0,0,a,o,t.RGBA,t.UNSIGNED_BYTE,r);for(var n=0,s=o-1;n<s;++n,--s)for(var d=0;d<a;++d)for(var c=0,p;4>c;++c)p=r[4*(a*n+d)+c],r[4*(a*n+d)+c]=r[4*(a*s+d)+c],r[4*(a*s+d)+c]=p;var u=document.createElement("canvas");u.width=a,u.height=o;var g=u.getContext("2d"),h=g.createImageData(a,o);h.data.set(r),g.putImageData(h,0,0);var m;return m="jpeg"===e?u.toDataURL("image/jpeg"):"webp"===e?u.toDataURL("image/webp"):u.toDataURL("image/png"),this.staticPlot&&this.container.removeChild(_),m},w.updateSize=function(e){e||(e=this.canvas);var t=this.pixelRatio,a=this.fullLayout,o=a.width,r=a.height,i=0|ae(t*o),n=0|ae(t*r);return(e.width!==i||e.height!==n)&&(e.width=i,e.height=n),e},w.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var e=[n.calcTicks(this.xaxis),n.calcTicks(this.yaxis)],t=0;2>t;++t)for(var a=0;a<e[t].length;++a)e[t][a].text+="";return e},w.updateRefs=function(e){this.fullLayout=e;var t=this.id.match(b),a="xaxis"+t[1],o="yaxis"+t[2];this.xaxis=this.fullLayout[a],this.yaxis=this.fullLayout[o]},w.relayoutCallback=function(){var e=this.graphDiv,t=this.xaxis,a=this.yaxis,o=e.layout,i={},n=i[t._name+".range"]=t.range.slice(),l=i[a._name+".range"]=a.range.slice();i[t._name+".autorange"]=t.autorange,i[a._name+".autorange"]=a.autorange,r.call("_storeDirectGUIEdit",e.layout,e._fullLayout._preGUI,i);var s=o[t._name];s.range=n,s.autorange=t.autorange;var d=o[a._name];d.range=l,d.autorange=a.autorange,i.lastInputTime=this.camera.lastInputTime,e.emit("plotly_relayout",i)},w.cameraChanged=function(){var e=this.camera;this.glplot.setDataBox(this.calcDataBox());var t=this.computeTickMarks(),a=this.glplotOptions.ticks;o(t,a)&&(this.glplotOptions.ticks=t,this.glplotOptions.dataBox=e.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},w.handleAnnotations=function(){for(var e=this.graphDiv,t=this.fullLayout.annotations,a=0,o;a<t.length;a++)o=t[a],o.xref===this.xaxis._id&&o.yref===this.yaxis._id&&r.getComponentMethod("annotations","drawOne")(e,a)},w.destroy=function(){if(this.glplot){var e=this.traces;e&&Object.keys(e).map(function(t){e[t].dispose(),delete e[t]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},w.plot=function(e,t,a){var o=this.glplot;this.updateRefs(a),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(e,t),this.updateFx(a.dragmode);var r=a.width,n=a.height;this.updateSize(this.canvas);var l=this.glplotOptions;l.merge(a),l.screenBox=[0,0,r,n];var s={_fullLayout:{_axisConstraintGroups:this.graphDiv._fullLayout._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis}};y(s,this.xaxis),y(s,this.yaxis);var d=a._size,c=this.xaxis.domain,p=this.yaxis.domain;l.viewBox=[d.l+c[0]*d.w,d.b+p[0]*d.h,r-d.r-(1-c[1])*d.w,n-d.t-(1-p[1])*d.h],this.mouseContainer.style.width=d.w*(c[1]-c[0])+"px",this.mouseContainer.style.height=d.h*(p[1]-p[0])+"px",this.mouseContainer.height=d.h*(p[1]-p[0]),this.mouseContainer.style.left=d.l+c[0]*d.w+"px",this.mouseContainer.style.top=d.t+(1-p[1])*d.h+"px";var u,g;for(g=0;2>g;++g)u=this[x[g]],u._length=l.viewBox[g+2]-l.viewBox[g],f(this.graphDiv,u),u.setScale();m(s),l.ticks=this.computeTickMarks(),l.dataBox=this.calcDataBox(),l.merge(a),o.update(l),this.glplot.draw()},w.calcDataBox=function(){var e=this.xaxis,t=this.yaxis,a=e.range,o=t.range,r=e.r2l,i=t.r2l;return[r(a[0]),i(o[0]),r(a[1]),i(o[1])]},w.setRanges=function(e){var t=this.xaxis,a=this.yaxis,o=t.l2r,r=a.l2r;t.range=[o(e[0]),o(e[2])],a.range=[r(e[1]),r(e[3])]},w.updateTraces=function(e,t){var a=Object.keys(this.traces),o,r,n;this.fullData=e;trace_id_loop:for(o=0;o<a.length;o++){var l=a[o],s=this.traces[l];for(r=0;r<e.length;r++)if(n=e[r],n.uid===l&&n.type===s.type)continue trace_id_loop;s.dispose(),delete this.traces[l]}for(o=0;o<e.length;o++){n=e[o];var d=t[o],c=this.traces[n.uid];c?c.update(n,d):(c=n._module.plot(this,n,d),this.traces[n.uid]=c)}this.glplot.objects.sort(function(e,t){return e._trace.index-t._trace.index})},w.updateFx=function(e){"lasso"===e||"select"===e?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor="pan"===e?"move":"zoom"===e?"crosshair":null},w.emitPointAction=function(e,t){for(var a=e.trace.uid,o=e.pointIndex,r=0,n;r<this.fullData.length;r++)this.fullData[r].uid===a&&(n=this.fullData[r]);var s={x:e.traceCoord[0],y:e.traceCoord[1],curveNumber:n.index,pointNumber:o,data:n._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};l.appendArrayPointValue(s,n,o),this.graphDiv.emit(t,{points:[s]})},w.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var e=this.glplot,t=this.camera,a=t.mouseListener,o=1===this.lastButtonState&&0===a.buttons,r=this.fullLayout;this.lastButtonState=a.buttons,this.cameraChanged();var n=a.x*e.pixelRatio,s=this.canvas.height-e.pixelRatio*a.y,d;if(t.boxEnabled&&"zoom"===r.dragmode){this.selectBox.enabled=!0;for(var c=this.selectBox.selectBox=[ie(t.boxStart[0],t.boxEnd[0]),ie(t.boxStart[1],t.boxEnd[1]),va(t.boxStart[0],t.boxEnd[0]),va(t.boxStart[1],t.boxEnd[1])],p=0;2>p;p++)t.boxStart[p]===t.boxEnd[p]&&(c[p]=e.dataBox[p],c[p+2]=e.dataBox[p+2]);e.setDirty()}else if(!t.panning&&this.isMouseOver){this.selectBox.enabled=!1;var u=r._size,g=this.xaxis.domain,h=this.yaxis.domain;d=e.pick(n/e.pixelRatio+u.l+g[0]*u.w,s/e.pixelRatio-(u.t+(1-h[1])*u.h));var m=d&&d.object._trace.handlePick(d);if(m&&o&&this.emitPointAction(m,"plotly_click"),d&&"skip"!==d.object._trace.hoverinfo&&r.hovermode&&m&&(!this.lastPickResult||this.lastPickResult.traceUid!==m.trace.uid||this.lastPickResult.dataCoord[0]!==m.dataCoord[0]||this.lastPickResult.dataCoord[1]!==m.dataCoord[1])){var y=m;this.lastPickResult={traceUid:m.trace?m.trace.uid:null,dataCoord:m.dataCoord.slice()},this.spikes.update({center:d.dataCoord}),y.screenCoord=[((e.viewBox[2]-e.viewBox[0])*(d.dataCoord[0]-e.dataBox[0])/(e.dataBox[2]-e.dataBox[0])+e.viewBox[0])/e.pixelRatio,(this.canvas.height-(e.viewBox[3]-e.viewBox[1])*(d.dataCoord[1]-e.dataBox[1])/(e.dataBox[3]-e.dataBox[1])-e.viewBox[1])/e.pixelRatio],this.emitPointAction(m,"plotly_hover");var f=this.fullData[y.trace.index]||{},x=y.pointIndex,b=l.castHoverinfo(f,r,x);if(b&&"all"!==b){var _=b.split("+");-1===_.indexOf("x")&&(y.traceCoord[0]=void 0),-1===_.indexOf("y")&&(y.traceCoord[1]=void 0),-1===_.indexOf("z")&&(y.traceCoord[2]=void 0),-1===_.indexOf("text")&&(y.textLabel=void 0),-1===_.indexOf("name")&&(y.name=void 0)}l.loneHover({x:y.screenCoord[0],y:y.screenCoord[1],xLabel:this.hoverFormatter("xaxis",y.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",y.traceCoord[1]),zLabel:y.traceCoord[2],text:y.textLabel,name:y.name,color:l.castHoverOption(f,x,"bgcolor")||y.color,borderColor:l.castHoverOption(f,x,"bordercolor"),fontFamily:l.castHoverOption(f,x,"font.family"),fontSize:l.castHoverOption(f,x,"font.size"),fontColor:l.castHoverOption(f,x,"font.color")},{container:this.svgContainer,gd:this.graphDiv})}}d||this.unhover(),e.draw()}},w.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),l.loneUnhover(this.svgContainer))},w.hoverFormatter=function(e,t){if(void 0!==t){var a=this[e];return n.tickText(a,a.c2l(t),"hover").text}}},{"../../components/fx":608,"../../lib/show_no_webgl_msg":713,"../../plots/cartesian/axes":740,"../../registry":823,"../cartesian/autorange":739,"../cartesian/constants":746,"../cartesian/constraints":748,"./camera":778,"./convert":779,"gl-plot2d":275,"gl-select-box":286,"gl-spikes2d":295,"webgl-context":532}],782:[function(e,t){"use strict";function a(e,t){function a(a,r,i,n){var l=m.keyBindingMode;if(!1!==l){var s=!!n.control,d=!!n.alt,p=!!n.shift,g=!!(1&a),h=1/e.clientHeight,y=h*(r-f),x=h*(i-b),v=m.flipX?1:-1,w=m.flipY?1:-1,k=o(),t=Sa*m.rotateSpeed;if((!("rotate"===l)||!g||s||d||p)&&(!g||s||d||!p)||c.rotate(k,v*t*y,-w*t*x,0),("pan"===l&&g&&!s&&!d&&!p||!!(2&a)||g&&s&&!d&&!p)&&c.pan(k,-m.translateSpeed*y*u,m.translateSpeed*x*u,0),"zoom"===l&&g&&!s&&!d&&!p||!!(4&a)||g&&!s&&d&&!p){var T=100*(-m.zoomSpeed*x/window.innerHeight*(k-c.lastT()));c.pan(k,0,0,u*(ka(T)-1))}return f=r,b=i,_=n,!0}}e=e||document.body,t=t||{};var d=[.01,1/0];"distanceLimits"in t&&(d[0]=t.distanceLimits[0],d[1]=t.distanceLimits[1]),"zoomMin"in t&&(d[0]=t.zoomMin),"zoomMax"in t&&(d[1]=t.zoomMax);var c=r({center:t.center||[0,0,0],up:t.up||[0,1,0],eye:t.eye||[0,0,10],mode:t.mode||"orbit",distanceLimits:d}),p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],u=0,g=e.clientWidth,h=e.clientHeight,m={keyBindingMode:"rotate",view:c,element:e,delay:t.delay||16,rotateSpeed:t.rotateSpeed||1,zoomSpeed:t.zoomSpeed||1,translateSpeed:t.translateSpeed||1,flipX:!!t.flipX,flipY:!!t.flipY,modes:c.modes,tick:function(){var a=o(),t=this.delay;c.idle(a-t),c.recalcMatrix(a-2*t),c.flush(a-(100+2*t));for(var r=!0,n=c.computedMatrix,l=0;16>l;++l)r=r&&p[l]===n[l],p[l]=n[l];var s=e.clientWidth===g&&e.clientHeight===h;return(g=e.clientWidth,h=e.clientHeight,r)?!s:(u=ka(c.computedRadius[0]),!0)},lookAt:function(e,t,a){c.lookAt(c.lastT(),e,t,a)},rotate:function(e,t,a){c.rotate(c.lastT(),e,t,a)},pan:function(e,t,a){c.pan(c.lastT(),e,t,a)},translate:function(e,t,a){c.translate(c.lastT(),e,t,a)}};Object.defineProperties(m,{matrix:{get:function(){return c.computedMatrix},set:function(e){return c.setMatrix(c.lastT(),e),c.computedMatrix},enumerable:!0},mode:{get:function(){return c.getMode()},set:function(e){var t=c.computedUp.slice(),a=c.computedEye.slice(),r=c.computedCenter.slice();if(c.setMode(e),"turntable"===e){var i=o();c._active.lookAt(i,a,r,t),c._active.lookAt(i+500,a,r,[0,0,1]),c._active.flush(i)}return c.getMode()},enumerable:!0},center:{get:function(){return c.computedCenter},set:function(e){return c.lookAt(c.lastT(),null,e),c.computedCenter},enumerable:!0},eye:{get:function(){return c.computedEye},set:function(e){return c.lookAt(c.lastT(),e),c.computedEye},enumerable:!0},up:{get:function(){return c.computedUp},set:function(e){return c.lookAt(c.lastT(),null,null,e),c.computedUp},enumerable:!0},distance:{get:function(){return u},set:function(e){return c.setDistance(c.lastT(),e),e},enumerable:!0},distanceLimits:{get:function(){return c.getDistanceLimits(d)},set:function(e){return c.setDistanceLimits(e),e},enumerable:!0}}),e.addEventListener("contextmenu",function(e){return e.preventDefault(),!1});var f=0,b=0,_={shift:!1,control:!1,alt:!1,meta:!1};return m.mouseListener=i(e,a),e.addEventListener("touchstart",function(t){var o=l(t.changedTouches[0],e);a(0,o[0],o[1],_),a(1,o[0],o[1],_),t.preventDefault()},!!s&&{passive:!1}),e.addEventListener("touchmove",function(t){var o=l(t.changedTouches[0],e);a(1,o[0],o[1],_),t.preventDefault()},!!s&&{passive:!1}),e.addEventListener("touchend",function(e){a(0,f,b,_),e.preventDefault()},!!s&&{passive:!1}),m.wheelListener=n(e,function(e,a){if(!1!==m.keyBindingMode){var r=m.flipX?1:-1,i=m.flipY?1:-1,n=o();if(wa(e)>wa(a))c.rotate(n,0,0,-e*r*Sa*m.rotateSpeed/window.innerWidth);else{var t=-m.zoomSpeed*i*a/window.innerHeight*(n-c.lastT())/20;c.pan(n,0,0,u*(ka(t)-1))}}},!0),m}t.exports=a;var o=e("right-now"),r=e("3d-view"),i=e("mouse-change"),n=e("mouse-wheel"),l=e("mouse-event-offset"),s=e("has-passive-events")},{"3d-view":45,"has-passive-events":394,"mouse-change":418,"mouse-event-offset":419,"mouse-wheel":421,"right-now":480}],783:[function(e,t,a){"use strict";var o=e("../../plot_api/edit_types").overrideAll,r=e("../../components/fx/layout_attributes"),n=e("./scene"),l=e("../get_data").getSubplotData,s=e("../../lib"),d=e("../../constants/xmlns_namespaces"),c="gl3d",p="scene";a.name=c,a.attr=p,a.idRoot=p,a.idRegex=a.attrRegex=s.counterRegex("scene"),a.attributes=e("./layout/attributes"),a.layoutAttributes=e("./layout/layout_attributes"),a.baseLayoutAttrOverrides=o({hoverlabel:r.hoverlabel},"plot","nested"),a.supplyLayoutDefaults=e("./layout/defaults"),a.plot=function(e){for(var t=e._fullLayout,a=e._fullData,o=t._subplots[c],r=0;r<o.length;r++){var d=o[r],p=l(a,c,d),u=t[d],g=u._scene;g||(g=new n({id:d,graphDiv:e,container:e.querySelector(".gl-container"),staticPlot:e._context.staticPlot,plotGlPixelRatio:e._context.plotGlPixelRatio},t),u._scene=g),g.cameraInitial||(g.cameraInitial=s.extendDeep({},u.camera)),g.plot(p,t,e.layout)}},a.clean=function(e,t,a,o){for(var r=o._subplots[c]||[],n=0,l;n<r.length;n++)l=r[n],t[l]||!o[l]._scene||(o[l]._scene.destroy(),o._infolayer&&o._infolayer.selectAll(".annotation-"+l).remove())},a.toSVG=function(e){for(var t=e._fullLayout,a=t._subplots[c],o=t._size,r=0;r<a.length;r++){var n=t[a[r]],l=n.domain,s=n._scene,p=s.toImage("png"),u=t._glimages.append("svg:image");u.attr({xmlns:d.svg,"xlink:href":p,x:o.l+o.w*l.x[0],y:o.t+o.h*(1-l.y[1]),width:o.w*(l.x[1]-l.x[0]),height:o.h*(l.y[1]-l.y[0]),preserveAspectRatio:"none"}),s.destroy()}},a.cleanId=function(e){if(e.match(/^scene[0-9]*$/)){var t=e.substr(5);return"1"===t&&(t=""),p+t}},a.updateFx=function(e){for(var t=e._fullLayout,a=t._subplots[c],o=0,r;o<a.length;o++)r=t[a[o]]._scene,r.updateFx(t.dragmode,t.hovermode)}},{"../../components/fx/layout_attributes":609,"../../constants/xmlns_namespaces":670,"../../lib":692,"../../plot_api/edit_types":723,"../get_data":777,"./layout/attributes":784,"./layout/defaults":788,"./layout/layout_attributes":789,"./scene":793}],784:[function(e,t){"use strict";t.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],785:[function(e,t){"use strict";var a=e("../../../components/color"),o=e("../../cartesian/layout_attributes"),r=e("../../../lib/extend").extendFlat,i=e("../../../plot_api/edit_types").overrideAll;t.exports=i({visible:o.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:a.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:o.color,categoryorder:o.categoryorder,categoryarray:o.categoryarray,title:o.title,type:r({},o.type,{values:["-","linear","log","date","category"]}),autorange:o.autorange,rangemode:o.rangemode,range:o.range,tickmode:o.tickmode,nticks:o.nticks,tick0:o.tick0,dtick:o.dtick,tickvals:o.tickvals,ticktext:o.ticktext,ticks:o.ticks,mirror:o.mirror,ticklen:o.ticklen,tickwidth:o.tickwidth,tickcolor:o.tickcolor,showticklabels:o.showticklabels,tickfont:o.tickfont,tickangle:o.tickangle,tickprefix:o.tickprefix,showtickprefix:o.showtickprefix,ticksuffix:o.ticksuffix,showticksuffix:o.showticksuffix,showexponent:o.showexponent,exponentformat:o.exponentformat,separatethousands:o.separatethousands,tickformat:o.tickformat,tickformatstops:o.tickformatstops,hoverformat:o.hoverformat,showline:o.showline,linecolor:o.linecolor,linewidth:o.linewidth,showgrid:o.showgrid,gridcolor:r({},o.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:o.gridwidth,zeroline:o.zeroline,zerolinecolor:o.zerolinecolor,zerolinewidth:o.zerolinewidth,_deprecated:{title:o._deprecated.title,titlefont:o._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":569,"../../../lib/extend":682,"../../../plot_api/edit_types":723,"../../cartesian/layout_attributes":753}],786:[function(e,t){"use strict";var a=e("tinycolor2").mix,o=e("../../../lib"),r=e("../../../plot_api/plot_template"),i=e("./axis_attributes"),n=e("../../cartesian/type_defaults"),l=e("../../cartesian/axis_defaults"),s=["xaxis","yaxis","zaxis"];t.exports=function(e,t,d){function c(e,t){return o.coerce(u,g,i,e,t)}for(var p=0,u,g,h;p<s.length;p++)h=s[p],u=e[h]||{},g=r.newContainer(t,h),g._id=h[0]+d.scene,g._name=h,n(u,g,c,d),l(u,g,c,{font:d.font,letter:h[0],data:d.data,showGrid:!0,noTickson:!0,bgColor:d.bgColor,calendar:d.calendar},d.fullLayout),c("gridcolor",a(g.color,d.bgColor,13600/187).toRgbString()),c("title.text",h[0]),g.setScale=o.noop,c("showspikes")&&(c("spikesides"),c("spikethickness"),c("spikecolor",g.color)),c("showaxeslabels"),c("showbackground")&&c("backgroundcolor")}},{"../../../lib":692,"../../../plot_api/plot_template":730,"../../cartesian/axis_defaults":742,"../../cartesian/type_defaults":764,"./axis_attributes":785,tinycolor2:513}],787:[function(e,t){"use strict";function a(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}var o=e("../../../lib/str2rgbarray"),r=["xaxis","yaxis","zaxis"],i=a.prototype;i.merge=function(e){for(var t=this,a=0,n;3>a;++a){if(n=e[r[a]],!n.visible){t.tickEnable[a]=!1,t.labelEnable[a]=!1,t.lineEnable[a]=!1,t.lineTickEnable[a]=!1,t.gridEnable[a]=!1,t.zeroEnable[a]=!1,t.backgroundEnable[a]=!1;continue}t.labels[a]=n.title.text,"font"in n.title&&(n.title.font.color&&(t.labelColor[a]=o(n.title.font.color)),n.title.font.family&&(t.labelFont[a]=n.title.font.family),n.title.font.size&&(t.labelSize[a]=n.title.font.size)),"showline"in n&&(t.lineEnable[a]=n.showline),"linecolor"in n&&(t.lineColor[a]=o(n.linecolor)),"linewidth"in n&&(t.lineWidth[a]=n.linewidth),"showgrid"in n&&(t.gridEnable[a]=n.showgrid),"gridcolor"in n&&(t.gridColor[a]=o(n.gridcolor)),"gridwidth"in n&&(t.gridWidth[a]=n.gridwidth),"log"===n.type?t.zeroEnable[a]=!1:"zeroline"in n&&(t.zeroEnable[a]=n.zeroline),"zerolinecolor"in n&&(t.zeroLineColor[a]=o(n.zerolinecolor)),"zerolinewidth"in n&&(t.zeroLineWidth[a]=n.zerolinewidth),t.lineTickEnable[a]="ticks"in n&&n.ticks,"ticklen"in n&&(t.lineTickLength[a]=t._defaultLineTickLength[a]=n.ticklen),"tickcolor"in n&&(t.lineTickColor[a]=o(n.tickcolor)),"tickwidth"in n&&(t.lineTickWidth[a]=n.tickwidth),"tickangle"in n&&(t.tickAngle[a]="auto"===n.tickangle?-3600:Sa*-n.tickangle/180),"showticklabels"in n&&(t.tickEnable[a]=n.showticklabels),"tickfont"in n&&(n.tickfont.color&&(t.tickColor[a]=o(n.tickfont.color)),n.tickfont.family&&(t.tickFont[a]=n.tickfont.family),n.tickfont.size&&(t.tickSize[a]=n.tickfont.size)),"mirror"in n?-1===["ticks","all","allticks"].indexOf(n.mirror)?!0===n.mirror?(t.lineTickMirror[a]=!1,t.lineMirror[a]=!0):(t.lineTickMirror[a]=!1,t.lineMirror[a]=!1):(t.lineTickMirror[a]=!0,t.lineMirror[a]=!0):t.lineMirror[a]=!1,"showbackground"in n&&!1!==n.showbackground?(t.backgroundEnable[a]=!0,t.backgroundColor[a]=o(n.backgroundcolor)):t.backgroundEnable[a]=!1}},t.exports=function(e){var t=new a;return t.merge(e),t}},{"../../../lib/str2rgbarray":715}],788:[function(e,t){"use strict";function a(e,t,a,o){for(var n=a("bgcolor"),s=r.combine(n,o.paper_bgcolor),c=["up","center","eye"],p=0;p<c.length;p++)a("camera."+c[p]+".x"),a("camera."+c[p]+".y"),a("camera."+c[p]+".z");var u=!!a("aspectratio.x")&&!!a("aspectratio.y")&&!!a("aspectratio.z"),g=u?"manual":"auto",h=a("aspectmode",g);u||(e.aspectratio=t.aspectratio={x:1,y:1,z:1},"manual"===h&&(t.aspectmode="auto"),e.aspectmode=t.aspectmode);var m=d(o.fullData,"gl3d",o.id);l(e,t,{font:o.font,scene:o.id,data:m,bgColor:s,calendar:o.calendar,fullLayout:o.fullLayout}),i.getComponentMethod("annotations3d","handleDefaults")(e,t,o);var f=o.getDfltFromLayout("dragmode");if(!1!==f&&!f)if(f="orbit",e.camera&&e.camera.up){var b=e.camera.up.x,x=e.camera.up.y,y=e.camera.up.z;b&&x&&y?.999<y/re(b*b+x*x+y*y)&&(f="turntable"):f="turntable"}else f="turntable";a("dragmode",f),a("hovermode",o.getDfltFromLayout("hovermode"))}var o=e("../../../lib"),r=e("../../../components/color"),i=e("../../../registry"),n=e("../../subplot_defaults"),l=e("./axis_defaults"),s=e("./layout_attributes"),d=e("../../get_data").getSubplotData;t.exports=function(e,t,r){var i=1<t._basePlotModules.length;n(e,t,r,{type:"gl3d",attributes:s,handleDefaults:a,fullLayout:t,font:t.font,fullData:r,getDfltFromLayout:function(t){if(!i){var a=o.validate(e[t],s[t]);if(a)return e[t]}},paper_bgcolor:t.paper_bgcolor,calendar:t.calendar})}},{"../../../components/color":569,"../../../lib":692,"../../../registry":823,"../../get_data":777,"../../subplot_defaults":818,"./axis_defaults":786,"./layout_attributes":789}],789:[function(e,t){"use strict";function a(e,t,a){return{x:{valType:"number",dflt:e,editType:"camera"},y:{valType:"number",dflt:t,editType:"camera"},z:{valType:"number",dflt:a,editType:"camera"},editType:"camera"}}var o=e("./axis_attributes"),r=e("../../domain").attributes,i=e("../../../lib/extend").extendFlat,n=e("../../../lib").counterRegex;t.exports={_arrayAttrRegexps:[n("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:i(a(0,0,1),{}),center:i(a(0,0,0),{}),eye:i(a(1.25,1.25,1.25),{}),editType:"camera"},domain:r({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:o,yaxis:o,zaxis:o,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":692,"../../../lib/extend":682,"../../domain":766,"./axis_attributes":785}],790:[function(e,t){"use strict";function a(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}var o=e("../../../lib/str2rgbarray"),r=["xaxis","yaxis","zaxis"],i=a.prototype;i.merge=function(e){for(var t=0,a;3>t;++t){if(a=e[r[t]],!a.visible){this.enabled[t]=!1,this.drawSides[t]=!1;continue}this.enabled[t]=a.showspikes,this.colors[t]=o(a.spikecolor),this.drawSides[t]=a.spikesides,this.lineWidth[t]=a.spikethickness}},t.exports=function(e){var t=new a;return t.merge(e),t}},{"../../../lib/str2rgbarray":715}],791:[function(e,t){"use strict";function a(e){for(var t=[,,,],a=0;3>a;++a){for(var o=e[a],r=Array(o.length),n=0;n<o.length;++n)r[n]=o[n].x;t[a]=r}return t}t.exports=function(e){for(var t=e.axesOptions,s=e.glplot.axesPixels,d=e.fullSceneLayout,c=[[],[],[]],p=0,u;3>p;++p)if(u=d[n[p]],u._length=(s[p].hi-s[p].lo)*s[p].pixelsPerDataUnit/e.dataScale[p],wa(u._length)===1/0||isNaN(u._length))c[p]=[];else{u._input_range=u.range.slice(),u.range[0]=s[p].lo/e.dataScale[p],u.range[1]=s[p].hi/e.dataScale[p],u._m=1/(e.dataScale[p]*s[p].pixelsPerDataUnit),u.range[0]===u.range[1]&&(u.range[0]-=1,u.range[1]+=1);var g=u.tickmode;if("auto"===u.tickmode){u.tickmode="linear";var h=u.nticks||r.constrain(u._length/40,4,9);o.autoTicks(u,wa(u.range[1]-u.range[0])/h)}for(var m=o.calcTicks(u),y=0;y<m.length;++y)m[y].x*=e.dataScale[p],"date"===u.type&&(m[y].text=m[y].text.replace(/\<br\>/g," "));c[p]=m,u.tickmode=g}t.ticks=c;for(var p=0;3>p;++p){l[p]=.5*(e.glplot.bounds[0][p]+e.glplot.bounds[1][p]);for(var y=0;2>y;++y)t.bounds[y][p]=e.glplot.bounds[y][p]}e.contourLevels=a(c)};var o=e("../../cartesian/axes"),r=e("../../../lib"),n=["xaxis","yaxis","zaxis"],l=[0,0,0]},{"../../../lib":692,"../../cartesian/axes":740}],792:[function(e,t){"use strict";function a(e,t){var a=[0,0,0,0],o,r;for(o=0;4>o;++o)for(r=0;4>r;++r)a[r]+=e[4*o+r]*t[o];return a}t.exports=function(e,t){var o=a(e.projection,a(e.view,a(e.model,[t[0],t[1],t[2],1])));return o}},{}],793:[function(e,t){"use strict";function a(e){function t(t,a){var o=e.fullSceneLayout[t];return h.tickText(o,o.d2l(a),"hover").text}var a=e.svgContainer,o=e.container.getBoundingClientRect(),r=o.width,n=o.height,l;a.setAttributeNS(null,"viewBox","0 0 "+r+" "+n),a.setAttributeNS(null,"width",r),a.setAttributeNS(null,"height",n),w(e),e.glplot.axes.update(e.axesOptions);for(var s=Object.keys(e.traces),d=null,c=e.glplot.selection,p=0;p<s.length;++p)l=e.traces[s[p]],"skip"!==l.data.hoverinfo&&l.handlePick(c)&&(d=l),l.setContourLevels&&l.setContourLevels();var u;if(null!==d){var g=b(e.glplot.cameraParams,c.dataCoordinate);l=d.data;var y=c.index,f=m.castHoverinfo(l,e.fullLayout,y),x=f.split("+"),_="all"===f,v=t("xaxis",c.traceCoordinate[0]),k=t("yaxis",c.traceCoordinate[1]),T=t("zaxis",c.traceCoordinate[2]);_||(-1===x.indexOf("x")&&(v=void 0),-1===x.indexOf("y")&&(k=void 0),-1===x.indexOf("z")&&(T=void 0),-1===x.indexOf("text")&&(c.textLabel=void 0),-1===x.indexOf("name")&&(d.name=void 0));var A;if("cone"===l.type||"streamtube"===l.type){var S=[];(_||-1!==x.indexOf("u"))&&S.push("u: "+t("xaxis",c.traceCoordinate[3])),(_||-1!==x.indexOf("v"))&&S.push("v: "+t("yaxis",c.traceCoordinate[4])),(_||-1!==x.indexOf("w"))&&S.push("w: "+t("zaxis",c.traceCoordinate[5])),(_||-1!==x.indexOf("norm"))&&S.push("norm: "+c.traceCoordinate[6].toPrecision(3)),"streamtube"===l.type&&(_||-1!==x.indexOf("divergence"))&&S.push("divergence: "+c.traceCoordinate[7].toPrecision(3)),c.textLabel&&S.push(c.textLabel),A=S.join("<br>")}else A=c.textLabel;e.fullSceneLayout.hovermode&&m.loneHover({x:(.5+.5*g[0]/g[3])*r,y:(.5-.5*g[1]/g[3])*n,xLabel:v,yLabel:k,zLabel:T,text:A,name:d.name,color:m.castHoverOption(l,y,"bgcolor")||d.color,borderColor:m.castHoverOption(l,y,"bordercolor"),fontFamily:m.castHoverOption(l,y,"font.family"),fontSize:m.castHoverOption(l,y,"font.size"),fontColor:m.castHoverOption(l,y,"font.color")},{container:a,gd:e.graphDiv});var C={x:c.traceCoordinate[0],y:c.traceCoordinate[1],z:c.traceCoordinate[2],data:l._input,fullData:l,curveNumber:l.index,pointNumber:y};l._module.eventData&&(C=l._module.eventData(C,c,l,{},y)),m.appendArrayPointValue(C,l,y);var L={points:[C]};c.buttons&&5>c.distance?e.graphDiv.emit("plotly_click",L):e.graphDiv.emit("plotly_hover",L),u=L}else m.loneUnhover(a),e.graphDiv.emit("plotly_unhover",u);e.drawAnnotations(e)}function o(t,o,r){var e=t.graphDiv,i={canvas:o,gl:r,container:t.container,axes:t.axesOptions,spikes:t.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1};if(t.staticMode){if(!A&&(T=document.createElement("canvas"),A=c({canvas:T,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}),!A))throw new Error("error creating static canvas/context for image server");i.pixelRatio=t.pixelRatio,i.gl=A,i.canvas=T}try{t.glplot=d(i)}catch(a){return f(t)}var n=function(t){if(!1!==t.fullSceneLayout.dragmode){var a={};a[t.id+".camera"]=s(t.camera),t.saveCamera(e.layout),t.graphDiv.emit("plotly_relayout",a)}};if(t.glplot.canvas.addEventListener("mouseup",n.bind(null,t)),t.glplot.canvas.addEventListener("wheel",n.bind(null,t),!!p&&{passive:!1}),t.staticMode||t.glplot.canvas.addEventListener("webglcontextlost",function(a){e&&e.emit&&e.emit("plotly_webglcontextlost",{event:a,layer:t.id})},!1),!t.camera){var l=t.fullSceneLayout.camera;t.camera=x(t.container,{center:[l.center.x,l.center.y,l.center.z],eye:[l.eye.x,l.eye.y,l.eye.z],up:[l.up.x,l.up.y,l.up.z],zoomMin:.1,zoomMax:100,mode:"orbit"})}return t.glplot.camera=t.camera,t.glplot.oncontextloss=function(){t.recoverContext()},t.glplot.onrender=a.bind(null,t),t.traces={},!0}function r(e,t){var a=document.createElement("div"),r=e.container;this.graphDiv=e.graphDiv;var i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.style.position="absolute",i.style.top=i.style.left="0px",i.style.width=i.style.height="100%",i.style["z-index"]=20,i.style["pointer-events"]="none",a.appendChild(i),this.svgContainer=i,a.id=e.id,a.style.position="absolute",a.style.top=a.style.left="0px",a.style.width=a.style.height="100%",r.appendChild(a),this.fullLayout=t,this.id=e.id||"scene",this.fullSceneLayout=t[this.id],this.plotArgs=[[],{},{}],this.axesOptions=_(t[this.id]),this.spikeOptions=v(t[this.id]),this.container=a,this.staticMode=!!e.staticPlot,this.pixelRatio=e.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=u.getComponentMethod("annotations3d","convert"),this.drawAnnotations=u.getComponentMethod("annotations3d","draw");!o(this)}function n(e,t,a){for(var o=e.fullSceneLayout,r=0;3>r;r++){var n=S[r],l=n.charAt(0),s=o[n],c=t[l],p=t[l+"calendar"],u=t["_"+l+"length"];if(!g.isArrayOrTypedArray(c))a[0][r]=ie(a[0][r],0),a[1][r]=va(a[1][r],u-1);else for(var h=0,m;h<(u||c.length);h++)if(g.isArrayOrTypedArray(c[h]))for(var y=0;y<c[h].length;++y)m=s.d2l(c[h][y],0,p),!isNaN(m)&&isFinite(m)&&(a[0][r]=ie(a[0][r],m),a[1][r]=va(a[1][r],m));else m=s.d2l(c[h],0,p),!isNaN(m)&&isFinite(m)&&(a[0][r]=ie(a[0][r],m),a[1][r]=va(a[1][r],m))}}function l(e){return[[e.eye.x,e.eye.y,e.eye.z],[e.center.x,e.center.y,e.center.z],[e.up.x,e.up.y,e.up.z]]}function s(e){return{up:{x:e.up[0],y:e.up[1],z:e.up[2]},center:{x:e.center[0],y:e.center[1],z:e.center[2]},eye:{x:e.eye[0],y:e.eye[1],z:e.eye[2]}}}var d=e("gl-plot3d"),c=e("webgl-context"),p=e("has-passive-events"),u=e("../../registry"),g=e("../../lib"),h=e("../../plots/cartesian/axes"),m=e("../../components/fx"),y=e("../../lib/str2rgbarray"),f=e("../../lib/show_no_webgl_msg"),x=e("./camera"),b=e("./project"),_=e("./layout/convert"),v=e("./layout/spikes"),w=e("./layout/tick_marks"),k=r.prototype,T,A;k.recoverContext=function(){function e(){return a.isContextLost()?void requestAnimationFrame(e):o(t,r,a)?void t.plot.apply(t,t.plotArgs):void g.error("Catastrophic and unrecoverable WebGL error. Context lost.")}var t=this,a=this.glplot.gl,r=this.glplot.canvas;this.glplot.dispose(),requestAnimationFrame(e)};var S=["xaxis","yaxis","zaxis"];k.plot=function(e,t,a){if(this.plotArgs=[e,t,a],!this.glplot.contextLost){var o=t[this.id],r=a[this.id],l,s,c,p,u,g;this.glplot.clearColor=o.bgcolor?y(o.bgcolor):[0,0,0,0],this.glplot.snapToData=!0,this.fullLayout=t,this.fullSceneLayout=o,this.glplotLayout=o,this.axesOptions.merge(o),this.spikeOptions.merge(o),this.setCamera(o.camera),this.updateFx(o.dragmode,o.hovermode),this.glplot.update({}),this.setConvert(u),e?!Array.isArray(e)&&(e=[e]):e=[];var h=[[1/0,1/0,1/0],[-Infinity,-Infinity,-Infinity]];for(c=0;c<e.length;++c)l=e[c],!0===l.visible&&n(this,l,h);var m=[1,1,1];for(p=0;3>p;++p)m[p]=h[1][p]===h[0][p]?1:1/(h[1][p]-h[0][p]);for(this.dataScale=m,this.convertAnnotations(this),c=0;c<e.length;++c)(l=e[c],!0===l.visible)&&(s=this.traces[l.uid],s?s.data.type===l.type?s.update(l):(s.dispose(),s=l._module.plot(this,l),this.traces[l.uid]=s):(s=l._module.plot(this,l),this.traces[l.uid]=s),s.name=l.name);var f=Object.keys(this.traces);trace_id_loop:for(c=0;c<f.length;++c){for(p=0;p<e.length;++p)if(e[p].uid===f[c]&&!0===e[p].visible)continue trace_id_loop;s=this.traces[f[c]],s.dispose(),delete this.traces[f[c]]}this.glplot.objects.sort(function(e,t){return e._trace.data.index-t._trace.data.index});var x=[[0,0,0],[0,0,0]],b=[],_={};for(c=0;3>c;++c){if(u=o[S[c]],g=u.type,g in _?(_[g].acc*=m[c],_[g].count+=1):_[g]={acc:m[c],count:1},u.autorange){x[0][c]=1/0,x[1][c]=-Infinity;var v=this.glplot.objects,w=this.fullSceneLayout.annotations||[],k=u._name.charAt(0);for(p=0;p<v.length;p++){var T=v[p],A=T.bounds,C=T._trace.data._pad||0;x[0][c]="ErrorBars"===T.constructor.name&&u._lowerLogErrorBound?ie(x[0][c],u._lowerLogErrorBound):ie(x[0][c],A[0][c]/m[c]-C),x[1][c]=va(x[1][c],A[1][c]/m[c]+C)}for(p=0;p<w.length;p++){var L=w[p];if(L.visible){var E=u.r2l(L[k]);x[0][c]=ie(x[0][c],E),x[1][c]=va(x[1][c],E)}}if("rangemode"in u&&"tozero"===u.rangemode&&(x[0][c]=ie(x[0][c],0),x[1][c]=va(x[1][c],0)),x[0][c]>x[1][c])x[0][c]=-1,x[1][c]=1;else{var z=x[1][c]-x[0][c];x[0][c]-=z/32,x[1][c]+=z/32}if("reversed"===u.autorange){var d=x[0][c];x[0][c]=x[1][c],x[1][c]=d}}else{var I=u.range;x[0][c]=u.r2l(I[0]),x[1][c]=u.r2l(I[1])}x[0][c]===x[1][c]&&(x[0][c]-=1,x[1][c]+=1),b[c]=x[1][c]-x[0][c],this.glplot.bounds[0][c]=x[0][c]*m[c],this.glplot.bounds[1][c]=x[1][c]*m[c]}var D=[1,1,1];for(c=0;3>c;++c){u=o[S[c]],g=u.type;var P=_[g];D[c]=_a(P.acc,1/P.count)/m[c]}var O;if("auto"===o.aspectmode)O=4>=va.apply(null,D)/ie.apply(null,D)?D:[1,1,1];else if("cube"===o.aspectmode)O=[1,1,1];else if("data"===o.aspectmode)O=D;else if("manual"===o.aspectmode){var R=o.aspectratio;O=[R.x,R.y,R.z]}else throw new Error("scene.js aspectRatio was not one of the enumerated types");o.aspectratio.x=r.aspectratio.x=O[0],o.aspectratio.y=r.aspectratio.y=O[1],o.aspectratio.z=r.aspectratio.z=O[2],this.glplot.aspect=O;var M=o.domain||null,B=t._size||null;if(M&&B){var F=this.container.style;F.position="absolute",F.left=B.l+M.x[0]*B.w+"px",F.top=B.t+(1-M.y[1])*B.h+"px",F.width=B.w*(M.x[1]-M.x[0])+"px",F.height=B.h*(M.y[1]-M.y[0])+"px"}this.glplot.redraw()}},k.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=this.glplot.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},k.getCamera=function(){return this.glplot.camera.view.recalcMatrix(this.camera.view.lastT()),s(this.glplot.camera)},k.setCamera=function(e){this.glplot.camera.lookAt.apply(this,l(e))},k.saveCamera=function(e){function t(e,t,a,o){var r=["up","center","eye"],i=["x","y","z"];return t[r[a]]&&e[r[a]][i[o]]===t[r[a]][i[o]]}var a=this.getCamera(),o=g.nestedProperty(e,this.id+".camera"),r=o.get(),n=!1;if(r===void 0)n=!0;else for(var l=0;3>l;l++)for(var s=0;3>s;s++)if(!t(a,r,l,s)){n=!0;break}if(n){o.set(a);var d=this.fullLayout,c=g.nestedProperty(d,this.id+".camera");c.set(a),u.call("_storeDirectGUIEdit",e,d._preGUI,a)}return n},k.updateFx=function(e,t){var a=this.camera;if(a)if("orbit"===e)a.mode="orbit",a.keyBindingMode="rotate";else if("turntable"===e){a.up=[0,0,1],a.mode="turntable",a.keyBindingMode="rotate";var o=this.graphDiv,r=o._fullLayout,i=this.fullSceneLayout.camera,n=i.up.x,l=i.up.y,s=i.up.z;if(.999<s/re(n*n+l*l+s*s))return;var d=this.id+".camera.up",c={x:0,y:0,z:1},p={};p[d]=c;var h=o.layout;u.call("_storeDirectGUIEdit",h,r._preGUI,p),i.up=c,g.nestedProperty(h,d).set(c)}else a.keyBindingMode=e;this.fullSceneLayout.hovermode=t},k.toImage=function(e){e||(e="png"),this.staticMode&&this.container.appendChild(T),this.glplot.redraw();var t=this.glplot.gl,a=t.drawingBufferWidth,o=t.drawingBufferHeight;t.bindFramebuffer(t.FRAMEBUFFER,null);var r=new Uint8Array(4*(a*o));t.readPixels(0,0,a,o,t.RGBA,t.UNSIGNED_BYTE,r);for(var n=0,s=o-1;n<s;++n,--s)for(var d=0;d<a;++d)for(var c=0,p;4>c;++c)p=r[4*(a*n+d)+c],r[4*(a*n+d)+c]=r[4*(a*s+d)+c],r[4*(a*s+d)+c]=p;var u=document.createElement("canvas");u.width=a,u.height=o;var g=u.getContext("2d"),h=g.createImageData(a,o);h.data.set(r),g.putImageData(h,0,0);var m;return m="jpeg"===e?u.toDataURL("image/jpeg"):"webp"===e?u.toDataURL("image/webp"):u.toDataURL("image/png"),this.staticMode&&this.container.removeChild(T),m},k.setConvert=function(){for(var e=0,t;3>e;e++)t=this.fullSceneLayout[S[e]],h.setConvert(t,this.fullLayout),t.setScale=g.noop},t.exports=r},{"../../components/fx":608,"../../lib":692,"../../lib/show_no_webgl_msg":713,"../../lib/str2rgbarray":715,"../../plots/cartesian/axes":740,"../../registry":823,"./camera":782,"./layout/convert":787,"./layout/spikes":790,"./layout/tick_marks":791,"./project":792,"gl-plot3d":277,"has-passive-events":394,"webgl-context":532}],794:[function(e,t){"use strict";t.exports=function(e,t,a,o){o=o||e.length;for(var r=Array(o),n=0;n<o;n++)r[n]=[e[n],t[n],a[n]];return r}},{}],795:[function(e,t){"use strict";var a=e("./font_attributes"),o=e("../components/color/attributes"),r=e("../components/colorscale/layout_attributes"),i=e("./pad_attributes"),n=e("../lib/extend").extendFlat,l=a({editType:"calc"});l.family.dflt="\"Open Sans\", verdana, arial, sans-serif",l.size.dflt=12,l.color.dflt=o.defaultLine,t.exports={font:l,title:{text:{valType:"string",editType:"layoutstyle"},font:a({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:n(i({editType:"layoutstyle"}),{}),editType:"layoutstyle"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},paper_bgcolor:{valType:"color",dflt:o.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:o.background,editType:"layoutstyle"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:o.defaults,editType:"calc"},colorscale:r,datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},modebar:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"modebar"},_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:a({editType:"layoutstyle"})}}},{"../components/color/attributes":568,"../components/colorscale/layout_attributes":582,"../lib/extend":682,"./font_attributes":767,"./pad_attributes":803}],796:[function(e,t){"use strict";t.exports={requiredVersion:"0.45.0",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",controlContainerClassName:"mapboxgl-control-container",wrongVersionErrorMsg:"Your custom plotly.js bundle is not using the correct mapbox-gl version\nPlease install mapbox-gl@0.45.0.",noAccessTokenErrorMsg:"Missing Mapbox access token.\nMapbox trace type require a Mapbox access token to be registered.\nFor example:\n  Plotly.plot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });\nMore info here: https://www.mapbox.com/help/define-access-token/",mapOnErrorMsg:"Mapbox error.",styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none"}}},{}],797:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t){var o=e.split(" "),r=o[0],i=o[1],n=a.isArrayOrTypedArray(t)?a.mean(t):t,l=.5+n/100,s=1.5+n/100,d=["",""],c=[0,0];"top"===r?(d[0]="top",c[1]=-s):"bottom"===r?(d[0]="bottom",c[1]=s):void 0,"left"===i?(d[1]="right",c[0]=-l):"right"===i?(d[1]="left",c[0]=l):void 0;var p;return p=d[0]&&d[1]?d.join("-"):d[0]?d[0]:d[1]?d[1]:"center",{anchor:p,offset:c}}},{"../../lib":692}],798:[function(e,t,a){"use strict";function o(e,t){var a=e._fullLayout,o=e._context;if(""===o.mapboxAccessToken)return"";for(var r=0,n;r<t.length;r++)if(n=a[t[r]],n.accesstoken)return n.accesstoken;throw new Error(c.noAccessTokenErrorMsg)}var r=e("mapbox-gl"),n=e("../../lib"),l=e("../../plots/get_data").getSubplotCalcData,s=e("../../constants/xmlns_namespaces"),d=e("./mapbox"),c=e("./constants"),p="mapbox";for(var u in c.styleRules)n.addStyleRule(".mapboxgl-"+u,c.styleRules[u]);a.name=p,a.attr="subplot",a.idRoot=p,a.idRegex=a.attrRegex=n.counterRegex(p),a.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},a.layoutAttributes=e("./layout_attributes"),a.supplyLayoutDefaults=e("./layout_defaults"),a.plot=function(e){var t=e._fullLayout,a=e.calcdata,s=t._subplots[p];if(r.version!==c.requiredVersion)throw new Error(c.wrongVersionErrorMsg);var u=o(e,s);r.accessToken=u;for(var g=0;g<s.length;g++){var h=s[g],m=l(a,p,h),y=t[h],f=y._subplot;f||(f=d({gd:e,container:t._glcontainer.node(),id:h,fullLayout:t,staticPlot:e._context.staticPlot}),t[h]._subplot=f),f.viewInitial||(f.viewInitial={center:n.extendFlat({},y.center),zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),f.plot(m,t,e._promises)}},a.clean=function(e,t,a,o){for(var r=o._subplots[p]||[],n=0,l;n<r.length;n++)l=r[n],t[l]||!o[l]._subplot||o[l]._subplot.destroy()},a.toSVG=function(e){for(var t=e._fullLayout,a=t._subplots[p],o=t._size,r=0;r<a.length;r++){var n=t[a[r]],l=n.domain,d=n._subplot,c=d.toImage("png"),u=t._glimages.append("svg:image");u.attr({xmlns:s.svg,"xlink:href":c,x:o.l+o.w*l.x[0],y:o.t+o.h*(1-l.y[1]),width:o.w*(l.x[1]-l.x[0]),height:o.h*(l.y[1]-l.y[0]),preserveAspectRatio:"none"}),d.destroy()}},a.updateFx=function(e){for(var t=e._fullLayout,a=t._subplots[p],o=0,r;o<a.length;o++)r=t[a[o]]._subplot,r.updateFx(t)}},{"../../constants/xmlns_namespaces":670,"../../lib":692,"../../plots/get_data":777,"./constants":796,"./layout_attributes":800,"./layout_defaults":801,"./mapbox":802,"mapbox-gl":409}],799:[function(e,t){"use strict";function a(e,t){this.mapbox=e,this.map=e.map,this.uid=e.uid+"-layer"+t,this.idSource=this.uid+"-source",this.idLayer=this.uid+"-layer",this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}function o(e){var t=e.source;return e.visible&&(n.isPlainObject(t)||"string"==typeof t&&0<t.length)}function r(e){var t={},a={};switch(e.type){case"circle":n.extendFlat(a,{"circle-radius":e.circle.radius,"circle-color":e.color,"circle-opacity":e.opacity});break;case"line":n.extendFlat(a,{"line-width":e.line.width,"line-color":e.color,"line-opacity":e.opacity});break;case"fill":n.extendFlat(a,{"fill-color":e.color,"fill-outline-color":e.fill.outlinecolor,"fill-opacity":e.opacity});break;case"symbol":var o=e.symbol,r=l(o.textposition,o.iconsize);n.extendFlat(t,{"icon-image":o.icon+"-15","icon-size":o.iconsize/10,"text-field":o.text,"text-size":o.textfont.size,"text-anchor":r.anchor,"text-offset":r.offset}),n.extendFlat(a,{"icon-color":e.color,"text-color":o.textfont.color,"text-opacity":e.opacity});}return{layout:t,paint:a}}function i(e){var t=e.sourcetype,a=e.source,o={type:t},r;return"geojson"===t?r="data":"vector"===t&&(r="string"==typeof a?"url":"tiles"),o[r]=a,o}var n=e("../../lib"),l=e("./convert_text_opts"),s=a.prototype;s.update=function(e){this.visible?this.needsNewSource(e)?(this.removeLayer(),this.updateSource(e),this.updateLayer(e)):this.needsNewLayer(e)?this.updateLayer(e):this.updateStyle(e):(this.updateSource(e),this.updateLayer(e)),this.visible=o(e)},s.needsNewSource=function(e){return this.sourceType!==e.sourcetype||this.source!==e.source||this.layerType!==e.type},s.needsNewLayer=function(e){return this.layerType!==e.type||this.below!==e.below},s.updateSource=function(e){var t=this.map;if(t.getSource(this.idSource)&&t.removeSource(this.idSource),this.sourceType=e.sourcetype,this.source=e.source,!!o(e)){var a=i(e);t.addSource(this.idSource,a)}},s.updateLayer=function(e){var t=this.map,a=r(e);this.removeLayer(),this.layerType=e.type,o(e)&&t.addLayer({id:this.idLayer,source:this.idSource,"source-layer":e.sourcelayer||"",type:e.type,layout:a.layout,paint:a.paint},e.below)},s.updateStyle=function(e){if(o(e)){var t=r(e);this.mapbox.setOptions(this.idLayer,"setLayoutProperty",t.layout),this.mapbox.setOptions(this.idLayer,"setPaintProperty",t.paint)}},s.removeLayer=function(){var e=this.map;e.getLayer(this.idLayer)&&e.removeLayer(this.idLayer)},s.dispose=function(){var e=this.map;e.removeLayer(this.idLayer),e.removeSource(this.idSource)},t.exports=function(e,t,o){var r=new a(e,t);return r.update(o),r}},{"../../lib":692,"./convert_text_opts":797}],800:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../components/color").defaultLine,r=e("../domain").attributes,i=e("../font_attributes"),n=e("../../traces/scatter/attributes").textposition,l=e("../../plot_api/edit_types").overrideAll,s=e("../../plot_api/plot_template").templatedArray,d=i({});d.family.dflt="Open Sans Regular, Arial Unicode MS Regular";var c=t.exports=l({_arrayAttrRegexps:[a.counterRegex("mapbox",".layers",!0)],domain:r({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],dflt:"basic"},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:s("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},type:{valType:"enumerated",values:["circle","line","fill","symbol"],dflt:"circle"},below:{valType:"string",dflt:""},color:{valType:"color",dflt:o},opacity:{valType:"number",min:0,max:1,dflt:1},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2}},fill:{outlinecolor:{valType:"color",dflt:o}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},textfont:d,textposition:a.extendFlat({},n,{arrayOk:!1})}})},"plot","from-root");c.uirevision={valType:"any",editType:"none"}},{"../../components/color":569,"../../lib":692,"../../plot_api/edit_types":723,"../../plot_api/plot_template":730,"../../traces/scatter/attributes":1040,"../domain":766,"../font_attributes":767}],801:[function(e,t){"use strict";function a(e,t,a,r){a("accesstoken",r.accessToken),a("style"),a("center.lon"),a("center.lat"),a("zoom"),a("bearing"),a("pitch"),n(e,t,{name:"layers",handleItemDefaults:o}),t._input=e}function o(e,t){function a(a,o){return r.coerce(e,t,l.layers,a,o)}var o=a("visible");if(o){var i=a("sourcetype");a("source"),"vector"===i&&a("sourcelayer");var n=a("type");a("below"),a("color"),a("opacity"),"circle"===n&&a("circle.radius"),"line"===n&&a("line.width"),"fill"===n&&a("fill.outlinecolor"),"symbol"===n&&(a("symbol.icon"),a("symbol.iconsize"),a("symbol.text"),r.coerceFont(a,"symbol.textfont"),a("symbol.textposition"))}}var r=e("../../lib"),i=e("../subplot_defaults"),n=e("../array_container_defaults"),l=e("./layout_attributes");t.exports=function(e,t,o){i(e,t,o,{type:"mapbox",attributes:l,handleDefaults:a,partition:"y",accessToken:t._mapboxAccessToken})}},{"../../lib":692,"../array_container_defaults":736,"../subplot_defaults":818,"./layout_attributes":800}],802:[function(e,t){"use strict";function a(e){this.id=e.id,this.gd=e.gd,this.container=e.container,this.isStatic=e.staticPlot;var t=e.fullLayout;this.uid=t._uid+"-"+this.id,this.opts=t[this.id],this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(t),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[]}function o(e){var t=h.style.values,a=h.style.dflt,o={};return s.isPlainObject(e)?(o.id=e.id,o.style=e):"string"==typeof e?(o.id=e,o.style=-1===t.indexOf(e)?e:r(e)):(o.id=a,o.style=r(a)),o.transition={duration:0,delay:0},o}function r(e){return g.styleUrlPrefix+e+"-"+g.styleUrlSuffix}function i(e){return[e.lon,e.lat]}var n=e("mapbox-gl"),l=e("../../components/fx"),s=e("../../lib"),d=e("../../registry"),c=e("../../components/dragelement"),p=e("../cartesian/select").prepSelect,u=e("../cartesian/select").selectOnClick,g=e("./constants"),h=e("./layout_attributes"),m=e("./layers"),y=a.prototype;t.exports=function(e){return new a(e)},y.plot=function(e,t,a){var o=this,r=o.opts=t[this.id];o.map&&r.accesstoken!==o.accessToken&&(o.map.remove(),o.map=null,o.styleObj=null,o.traceHash=[],o.layerList={});var i;i=o.map?new Promise(function(a,r){o.updateMap(e,t,a,r)}):new Promise(function(a,r){o.createMap(e,t,a,r)}),a.push(i)},y.createMap=function(e,t,a,r){function s(){l.loneUnhover(t._toppaper)}function c(e){var t=p.id,a={};for(var o in e)a[t+"."+o]=e[o];d.call("_storeDirectGUIEdit",h.layout,h._fullLayout._preGUI,a),h.emit("plotly_relayout",a)}var p=this,h=p.gd,m=p.opts,y=p.styleObj=o(m.style);p.accessToken=m.accesstoken;var f=p.map=new n.Map({container:p.div,style:y.style,center:i(m.center),zoom:m.zoom,bearing:m.bearing,pitch:m.pitch,interactive:!p.isStatic,preserveDrawingBuffer:p.isStatic,doubleClickZoom:!1,boxZoom:!1}),x=g.controlContainerClassName,b=p.div.getElementsByClassName(x)[0];if(p.div.removeChild(b),f._canvas.style.left="0px",f._canvas.style.top="0px",p.rejectOnError(r),f.once("load",function(){p.updateData(e),p.updateLayout(t),p.resolveOnRender(a)}),!p.isStatic){var _=!1;f.on("moveend",function(e){if(p.map){if(e.originalEvent||_){var t=p.getView();m._input.center=m.center=t.center,m._input.zoom=m.zoom=t.zoom,m._input.bearing=m.bearing=t.bearing,m._input.pitch=m.pitch=t.pitch,c(t)}_=!1}}),f.on("wheel",function(){_=!0}),f.on("mousemove",function(e){var t=p.div.getBoundingClientRect();e.clientX=e.point.x+t.left,e.clientY=e.point.y+t.top,e.target.getBoundingClientRect=function(){return t},p.xaxis.p2c=function(){return e.lngLat.lng},p.yaxis.p2c=function(){return e.lngLat.lat},l.hover(h,e,p.id)}),f.on("dragstart",s),f.on("zoomstart",s),f.on("dblclick",function(){h.emit("plotly_doubleclick",null);var e=p.viewInitial;f.setCenter(i(e.center)),f.setZoom(e.zoom),f.setBearing(e.bearing),f.setPitch(e.pitch);var t=p.getView();m._input.center=m.center=t.center,m._input.zoom=m.zoom=t.zoom,m._input.bearing=m.bearing=t.bearing,m._input.pitch=m.pitch=t.pitch,c(t)}),p.clearSelect=function(){h._fullLayout._zoomlayer.selectAll(".select-outline").remove()},p.onClickInPanFn=function(e){return function(t){var a=h._fullLayout.clickmode;-1<a.indexOf("select")&&u(t.originalEvent,h,[p.xaxis],[p.yaxis],p.id,e),-1<a.indexOf("event")&&l.click(h,t.originalEvent)}}}},y.updateMap=function(e,t,a,r){var i=this,n=i.map;i.rejectOnError(r);var l=o(i.opts.style);i.styleObj.id===l.id?(i.updateData(e),i.updateLayout(t),i.resolveOnRender(a)):(i.styleObj=l,n.setStyle(l.style),n.once("styledata",function(){i.traceHash={},i.updateData(e),i.updateLayout(t),i.resolveOnRender(a)}))},y.updateData=function(e){var t=this.traceHash,a,o,r,n;for(r=0;r<e.length;r++){var l=e[r];o=l[0].trace,a=t[o.uid],a?a.update(l):o._module&&(t[o.uid]=o._module.plot(this,l))}var s=Object.keys(t);id_loop:for(r=0;r<s.length;r++){var d=s[r];for(n=0;n<e.length;n++)if(o=e[n][0].trace,d===o.uid)continue id_loop;a=t[d],a.dispose(),delete t[d]}},y.updateLayout=function(e){var t=this.map,a=this.opts;t.setCenter(i(a.center)),t.setZoom(a.zoom),t.setBearing(a.bearing),t.setPitch(a.pitch),this.updateLayers(),this.updateFramework(e),this.updateFx(e),this.map.resize()},y.resolveOnRender=function(e){var t=this.map;t.on("render",function a(){t.loaded()&&(t.off("render",a),setTimeout(e,0))})},y.rejectOnError=function(e){function t(){e(new Error(g.mapOnErrorMsg))}var a=this.map;a.once("error",t),a.once("style.error",t),a.once("source.error",t),a.once("tile.error",t),a.once("layer.error",t)},y.createFramework=function(e){var t=this,a=t.div=document.createElement("div");a.id=t.uid,a.style.position="absolute",t.container.appendChild(a),t.xaxis={_id:"x",c2p:function(e){return t.project(e).x}},t.yaxis={_id:"y",c2p:function(e){return t.project(e).y}},t.updateFramework(e)},y.updateFx=function(e){function t(e){var t=a.map.unproject(e);return[t.lng,t.lat]}var a=this,o=a.map,r=a.gd;if(!a.isStatic){var i=e.dragmode,n;n="select"===i?function(e,o){var r=e.range={};r[a.id]=[t([o.xmin,o.ymin]),t([o.xmax,o.ymax])]}:function(e,o,r){var i=e.lassoPoints={};i[a.id]=r.filtered.map(t)};var l=a.dragOptions;a.dragOptions=s.extendDeep(l||{},{element:a.div,gd:r,plotinfo:{id:a.id,xaxis:a.xaxis,yaxis:a.yaxis,fillRangeItems:n},xaxes:[a.xaxis],yaxes:[a.yaxis],subplot:a.id}),o.off("click",a.onClickInPanHandler),"select"===i||"lasso"===i?(o.dragPan.disable(),o.on("zoomstart",a.clearSelect),a.dragOptions.prepFn=function(t,e,o){p(t,e,o,a.dragOptions,i)},c.init(a.dragOptions)):(o.dragPan.enable(),o.off("zoomstart",a.clearSelect),a.div.onmousedown=null,a.onClickInPanHandler=a.onClickInPanFn(a.dragOptions),o.on("click",a.onClickInPanHandler))}},y.updateFramework=function(e){var t=e[this.id].domain,a=e._size,o=this.div.style;o.width=a.w*(t.x[1]-t.x[0])+"px",o.height=a.h*(t.y[1]-t.y[0])+"px",o.left=a.l+t.x[0]*a.w+"px",o.top=a.t+(1-t.y[1])*a.h+"px",this.xaxis._offset=a.l+t.x[0]*a.w,this.xaxis._length=a.w*(t.x[1]-t.x[0]),this.yaxis._offset=a.t+(1-t.y[1])*a.h,this.yaxis._length=a.h*(t.y[1]-t.y[0])},y.updateLayers=function(){var e=this.opts,t=e.layers,a=this.layerList,o;if(t.length!==a.length){for(o=0;o<a.length;o++)a[o].dispose();for(a=this.layerList=[],o=0;o<t.length;o++)a.push(m(this,o,t[o]))}else for(o=0;o<t.length;o++)a[o].update(t[o])},y.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},y.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},y.setOptions=function(e,t,a){for(var o in a)this.map[t](e,o,a[o])},y.project=function(e){return this.map.project(new n.LngLat(e[0],e[1]))},y.getView=function(){var e=this.map,t=e.getCenter(),a={lon:t.lng,lat:t.lat};return{center:a,zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch()}}},{"../../components/dragelement":587,"../../components/fx":608,"../../lib":692,"../../registry":823,"../cartesian/select":758,"./constants":796,"./layers":799,"./layout_attributes":800,"mapbox-gl":409}],803:[function(e,t){"use strict";t.exports=function(e){var t=e.editType;return{t:{valType:"number",dflt:0,editType:t},r:{valType:"number",dflt:0,editType:t},b:{valType:"number",dflt:0,editType:t},l:{valType:"number",dflt:0,editType:t},editType:t}}},{}],804:[function(e,t){"use strict";function a(e,t){t.text("");var a=t.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(e._context.linkText+" "+O(187));if(e._context.sendData)a.on("click",function(){_.sendDataToCloud(e)});else{var o=window.location.pathname.split("/"),r=window.location.search;a.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+o[2].split(".")[0]+"/"+o[1]+r})}}function o(e,t){function a(e,t){p[t]=e,u[e]=1}function o(e,t){if(e&&"string"==typeof e&&!u[e])return a(e,t),!0}var r=t.length,n=[],l,s;for(l=0;l<e.length;l++){var d=e[l]._fullInput;d!==s&&n.push(d),s=d}var c=n.length,p=Array(r),u={};for(l=0;l<r;l++)o(t[l].uid,l)||l<c&&o(n[l].uid,l)||a(x.randstr(u),l);return p}function r(){var e={},t,a;if(!I){I=[];var o=m.subplotsRegistry;for(var r in o){var n=o[r],l=n.attr;if(l&&(I.push(r),Array.isArray(l)))for(a=0;a<l.length;a++)x.pushUnique(I,l[a])}}for(t=0;t<I.length;t++)e[I[t]]=[];return e}function n(e,t){function a(e){for(var a=!0,o=0,l;o<t.length;o++)l=t[o],n[l]||(e[l]?n[l]=e[l]:a=!1);a&&(r=!0)}var o=e._context.locale;for(var r=!1,n={},l=0,s;2>l;l++){s=e._context.locales;for(var d=0,c;2>d&&(c=(s[o]||{}).format,!(c&&(a(c),r)));d++)s=m.localeRegistry;var p=o.split("-")[0];if(r||p===o)break;o=p}return r||a(m.localeRegistry.en.format),n}function l(e,t){return e.decimal=t.charAt(0),e.thousands=t.charAt(1),h.locale(e)}function s(e,t){var a={_fullLayout:t},o="x"===e._id.charAt(0),r=e._mainAxis._anchorAxis,i="",n="",l="";if(r&&(l=r._mainAxis._id,i=o?e._id+l:l+e._id),!i||!t._plots[i]){i="";for(var s=e._counterAxes,d=0;d<s.length;d++){var c=s[d],p=o?e._id+c:c+e._id;n||(n=p);var u=w.getFromId(a,c);if(l&&u.overlaying===l){i=p;break}}}return i||n}function d(e){var t=e.transforms;if(Array.isArray(t)&&t.length)for(var a=0;a<t.length;a++){var o=t[a],r=o._module||C[o.type];if(r&&r.makesData)return!0}return!1}function c(e,t,a,o){for(var r=e.transforms,n=[e],l=0;l<r.length;l++){var s=r[l],d=C[s.type];d&&d.transform&&(n=d.transform(n,{transform:s,fullTrace:e,fullData:t,layout:a,fullLayout:o,transformIndex:l}))}return n}function p(e){var t=e.margin;if(!e._size){var a=e._size={l:R(t.l),r:R(t.r),t:R(t.t),b:R(t.b),p:R(t.pad)};a.w=R(e.width)-a.l-a.r,a.h=R(e.height)-a.t-a.b}e._pushmargin||(e._pushmargin={}),e._pushmarginIds||(e._pushmarginIds={})}function u(e,t){for(var a=0,o;a<e.length;a++)o=e[a],o.clearCalc(),"multicategory"===o.type&&o.setupMultiCategory(t)}function g(e){var t=e._fullLayout,a=t._visibleModules,o={},r,n,l;for(n=0;n<a.length;n++){var s=a[n],d=s.crossTraceCalc;if(d){var c=s.basePlotModule.name;o[c]?x.pushUnique(o[c],d):o[c]=[d]}}for(l in o){var p=o[l],u=t._subplots[l];if(Array.isArray(u))for(r=0;r<u.length;r++){var g=u[r],h="cartesian"===l?t._plots[g]:t[g];for(n=0;n<p.length;n++)p[n](e,h,g)}else for(n=0;n<p.length;n++)p[n](e)}}var h=e("d3"),i=e("fast-isnumeric"),m=e("../registry"),y=e("../plot_api/plot_schema"),f=e("../plot_api/plot_template"),x=e("../lib"),b=e("../components/color"),v=e("../constants/numerical").BADNUM,w=e("../plots/cartesian/axis_ids"),k=e("./animation_attributes"),T=e("./frame_attributes"),A=x.relinkPrivateKeys,S=x._,_=t.exports={};x.extendFlat(_,m),_.attributes=e("./attributes"),_.attributes.type.values=_.allTypes,_.fontAttrs=e("./font_attributes"),_.layoutAttributes=e("./layout_attributes"),_.fontWeight="normal";var C=_.transformsRegistry,L=e("./command");_.executeAPICommand=L.executeAPICommand,_.computeAPICommandBindings=L.computeAPICommandBindings,_.manageCommandObserver=L.manageCommandObserver,_.hasSimpleAPICommandBindings=L.hasSimpleAPICommandBindings,_.redrawText=function(e){return e=x.getGraphDiv(e),e.data&&e.data[0]&&e.data[0].r?void 0:new Promise(function(t){setTimeout(function(){m.getComponentMethod("annotations","draw")(e),m.getComponentMethod("legend","draw")(e),(e.calcdata||[]).forEach(function(e){e[0]&&e[0].t&&e[0].t.cb&&e[0].t.cb()}),t(_.previousPromises(e))},300)})},_.resize=function(e){return e=x.getGraphDiv(e),new Promise(function(t,a){function o(e){var t=window.getComputedStyle(e).display;return!t||"none"===t}(!e||o(e))&&a(new Error("Resize must be passed a displayed plot div element.")),e._redrawTimer&&clearTimeout(e._redrawTimer),e._redrawTimer=setTimeout(function(){if(!e.layout||e.layout.width&&e.layout.height||o(e))return void t(e);delete e.layout.width,delete e.layout.height;var a=e.changed;e.autoplay=!0,m.call("relayout",e,{autosize:!0}).then(function(){e.changed=a,t(e)})},100)})},_.previousPromises=function(e){if((e._promises||[]).length)return Promise.all(e._promises).then(function(){e._promises=[]})},_.addLinks=function(e){if(e._context.showLink||e._context.showSources){var t=e._fullLayout,o=x.ensureSingle(t._paper,"text","js-plot-link-container",function(e){e.style({"font-family":"\"Open Sans\", Arial, sans-serif","font-size":"12px",fill:b.defaultLine,"pointer-events":"all"}).each(function(){var e=h.select(this);e.append("tspan").classed("js-link-to-tool",!0),e.append("tspan").classed("js-link-spacer",!0),e.append("tspan").classed("js-sourcelinks",!0)})}),r=o.node(),i={y:t._paper.attr("height")-9};document.body.contains(r)&&r.getComputedTextLength()>=t.width-20?(i["text-anchor"]="start",i.x=5):(i["text-anchor"]="end",i.x=t._paper.attr("width")-7),o.attr(i);var n=o.select(".js-link-to-tool"),l=o.select(".js-link-spacer"),s=o.select(".js-sourcelinks");e._context.showSources&&e._context.showSources(e),e._context.showLink&&a(e,n),l.text(n.text()&&s.text()?" - ":"")}},_.sendDataToCloud=function(e){e.emit("plotly_beforeexport");var t=(window.PLOTLYENV||{}).BASE_URL||e._context.plotlyServerURL,a=h.select(e).append("div").attr("id","hiddenform").style("display","none"),o=a.append("form").attr({action:t+"/external",method:"post",target:"_blank"}),r=o.append("input").attr({type:"text",name:"data"});return r.node().value=_.graphJson(e,!1,"keepdata"),o.node().submit(),a.remove(),e.emit("plotly_afterexport"),!1};var E=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],z=["year","month","dayMonth","dayMonthYear"];_.supplyDefaults=function(e,t){var a=t&&t.skipUpdateCalc,s=e._fullLayout||{};if(s._skipDefaults)return void delete s._skipDefaults;var d=e._fullLayout={},c=e.layout||{},u=e._fullData||[],g=e._fullData=[],h=e.data||[],y=e.calcdata||[],f=e._context||{},b;e._transitionData||_.createTransitionData(e),d._dfltTitle={plot:S(e,"Click to enter Plot title"),x:S(e,"Click to enter X axis title"),y:S(e,"Click to enter Y axis title"),colorbar:S(e,"Click to enter Colorscale title"),annotation:S(e,"new text")},d._traceWord=S(e,"trace");var v=n(e,E);if(d._mapboxAccessToken=f.mapboxAccessToken,s._initialAutoSizeIsDone){var w=s.width,T=s.height;_.supplyLayoutGlobalDefaults(c,d,v),c.width||(d.width=w),c.height||(d.height=T),_.sanitizeMargins(d)}else{_.supplyLayoutGlobalDefaults(c,d,v);var C=!c.width||!c.height,L=d.autosize,I=f.autosizable;C&&(L||I)?_.plotAutoSize(e,c,d):C&&_.sanitizeMargins(d),!L&&C&&(c.width=d.width,c.height=d.height)}d._d3locale=l(v,d.separators),d._extraFormat=n(e,z),d._initialAutoSizeIsDone=!0,d._dataLength=h.length,d._modules=[],d._visibleModules=[],d._basePlotModules=[];var D=d._subplots=r(),P=d._splomAxes={x:{},y:{}},O=d._splomSubplots={};d._splomGridDflt={},d._scatterStackOpts={},d._firstScatter={},d._requestRangeslider={},d._traceUids=o(u,h),d._globalTransforms=(e._context||{}).globalTransforms,_.supplyDataDefaults(h,g,c,d);var R=Object.keys(P.x),M=Object.keys(P.y);if(1<R.length&&1<M.length){for(m.getComponentMethod("grid","sizeDefaults")(c,d),b=0;b<R.length;b++)x.pushUnique(D.xaxis,R[b]);for(b=0;b<M.length;b++)x.pushUnique(D.yaxis,M[b]);for(var j in O)x.pushUnique(D.cartesian,j)}if(d._has=_._hasPlotType.bind(d),u.length===g.length)for(b=0;b<g.length;b++)A(g[b],u[b]);_.supplyLayoutModuleDefaults(c,d,g,e._transitionData);var k=d._visibleModules,B=[];for(b=0;b<k.length;b++){var F=k[b].crossTraceDefaults;F&&x.pushUnique(B,F)}for(b=0;b<B.length;b++)B[b](g,d);m.getComponentMethod("colorscale","crossTraceDefaults")(g,d),d._hasOnlyLargeSploms=1===d._basePlotModules.length&&"splom"===d._basePlotModules[0].name&&15<R.length&&15<M.length&&0===d.shapes.length&&0===d.images.length,d._hasCartesian=d._has("cartesian"),d._hasGeo=d._has("geo"),d._hasGL3D=d._has("gl3d"),d._hasGL2D=d._has("gl2d"),d._hasTernary=d._has("ternary"),d._hasPie=d._has("pie"),_.linkSubplots(g,d,u,s),_.cleanPlot(g,d,u,s),A(d,s),d._preGUI||(d._preGUI={}),d._tracePreGUI||(d._tracePreGUI={});var N=d._tracePreGUI,V={},U;for(U in N)V[U]="old";for(b=0;b<g.length;b++)U=g[b]._fullInput.uid,V[U]||(N[U]={}),V[U]="new";for(U in V)"old"===V[U]&&delete N[U];p(d),m.getComponentMethod("rangeslider","makeData")(d),a||y.length!==g.length||_.supplyDefaultsUpdateCalc(y,g)},_.supplyDefaultsUpdateCalc=function(e,t){for(var a=0;a<t.length;a++){var o=t[a],r=e[a][0];if(r&&r.trace){var n=r.trace;if(n._hasCalcTransform){var l=n._arrayAttrs,s,d,c;for(s=0;s<l.length;s++)d=l[s],c=x.nestedProperty(n,d).get().slice(),x.nestedProperty(o,d).set(c)}r.trace=o}}};var I;_.createTransitionData=function(e){e._transitionData||(e._transitionData={}),e._transitionData._frames||(e._transitionData._frames=[]),e._transitionData._frameHash||(e._transitionData._frameHash={}),e._transitionData._counter||(e._transitionData._counter=0),e._transitionData._interruptCallbacks||(e._transitionData._interruptCallbacks=[])},_._hasPlotType=function(e){var t=this._basePlotModules||[],a;for(a=0;a<t.length;a++)if(t[a].name===e)return!0;var o=this._modules||[];for(a=0;a<o.length;a++){var r=o[a].name;if(r===e)return!0;var n=m.modules[r];if(n&&n.categories[e])return!0}return!1},_.cleanPlot=function(e,t,a,o){var r=o._basePlotModules||[],n,l;for(n=0;n<r.length;n++){var s=r[n];s.clean&&s.clean(e,t,a,o)}var d=o._has&&o._has("gl"),c=t._has&&t._has("gl");d&&!c&&o._glcontainer!==void 0&&(o._glcontainer.selectAll(".gl-canvas").remove(),o._glcontainer.selectAll(".no-webgl").remove(),o._glcanvas=null);var p=!!o._infolayer;oldLoop:for(n=0;n<a.length;n++){var u=a[n],g=u.uid;for(l=0;l<e.length;l++){var h=e[l];if(g===h.uid)continue oldLoop}p&&o._infolayer.select(".cb"+g).remove()}o._zoomlayer&&o._zoomlayer.selectAll(".select-outline").remove()},_.linkSubplots=function(e,t,a,o){var r=o._plots||{},n=t._plots={},l=t._subplots,d={_fullData:e,_fullLayout:t},c=l.cartesian.concat(l.gl2d||[]),p,u;for(p=0;p<c.length;p++){var g=c[p],h=r[g],m=w.getFromId(d,g,"x"),y=w.getFromId(d,g,"y"),f;for(h?f=n[g]=h:(f=n[g]={},f.id=g),m._counterAxes.push(y._id),y._counterAxes.push(m._id),m._subplotsWith.push(g),y._subplotsWith.push(g),f.xaxis=m,f.yaxis=y,f._hasClipOnAxisFalse=!1,u=0;u<e.length;u++){var b=e[u];if(b.xaxis===f.xaxis._id&&b.yaxis===f.yaxis._id&&!1===b.cliponaxis){f._hasClipOnAxisFalse=!0;break}}}var _=w.list(d,null,!0),v;for(p=0;p<_.length;p++){v=_[p];var k=null;v.overlaying&&(k=w.getFromId(d,v.overlaying),k&&k.overlaying&&(v.overlaying=!1,k=null)),v._mainAxis=k||v,k&&(v.domain=k.domain.slice()),v._anchorAxis="free"===v.anchor?null:w.getFromId(d,v.anchor)}for(p=0;p<_.length;p++)v=_[p],v._counterAxes.sort(w.idSort),v._subplotsWith.sort(x.subplotSort),v._mainSubplot=s(v,t)},_.clearExpandedTraceDefaultColors=function(e){function t(e,t,r,i){o[i]=t,o.length=i+1,"color"===e.valType&&e.dflt===void 0&&a.push(o.join("."))}var a,o,r;for(o=[],a=e._module._colorAttrs,a||(e._module._colorAttrs=a=[],y.crawl(e._module.attributes,t)),r=0;r<a.length;r++){var n=x.nestedProperty(e,"_input."+a[r]);n.get()||x.nestedProperty(e,a[r]).set(null)}},_.supplyDataDefaults=function(e,t,a,o){function r(e){t.push(e);var a=e._module;a&&(x.pushUnique(n,a),!0===e.visible&&x.pushUnique(l,a),x.pushUnique(s,e._module.basePlotModule),d++,!1!==e._input.visible&&p++)}var n=o._modules,l=o._visibleModules,s=o._basePlotModules,d=0,p=0,u,g,h;o._transformModules=[];var y={},b=[],v=(a.template||{}).data||{},w=f.traceTemplater(v);for(u=0;u<e.length;u++){if(h=e[u],g=w.newTrace(h),g.uid=o._traceUids[u],_.supplyTraceDefaults(h,g,p,o,u),g.index=u,g._input=h,g._expandedIndex=d,g.transforms&&g.transforms.length)for(var k=!1!==h.visible&&!1===g.visible,T=c(g,t,a,o),S=0;S<T.length;S++){var C=T[S],L={_template:g._template,type:g.type,uid:g.uid+S};k&&!1===C.visible&&delete C.visible,_.supplyTraceDefaults(C,L,d,o,u),A(L,C),L.index=u,L._input=h,L._fullInput=g,L._expandedIndex=d,L._expandedInput=C,r(L)}else g._fullInput=g,g._expandedInput=g,r(g);m.traceIs(g,"carpetAxis")&&(y[g.carpet]=g),m.traceIs(g,"carpetDependent")&&b.push(u)}for(u=0;u<b.length;u++)if(g=t[b[u]],g.visible){var E=y[g.carpet];if(g._carpet=E,!E||!E.visible){g.visible=!1;continue}g.xaxis=E.xaxis,g.yaxis=E.yaxis}},_.supplyAnimationDefaults=function(e){function t(t,o){return x.coerce(e||{},a,k,t,o)}e=e||{};var a={},o;if(t("mode"),t("direction"),t("fromcurrent"),Array.isArray(e.frame))for(a.frame=[],o=0;o<e.frame.length;o++)a.frame[o]=_.supplyAnimationFrameDefaults(e.frame[o]||{});else a.frame=_.supplyAnimationFrameDefaults(e.frame||{});if(Array.isArray(e.transition))for(a.transition=[],o=0;o<e.transition.length;o++)a.transition[o]=_.supplyAnimationTransitionDefaults(e.transition[o]||{});else a.transition=_.supplyAnimationTransitionDefaults(e.transition||{});return a},_.supplyAnimationFrameDefaults=function(e){function t(t,o){return x.coerce(e||{},a,k.frame,t,o)}var a={};return t("duration"),t("redraw"),a},_.supplyAnimationTransitionDefaults=function(e){function t(t,o){return x.coerce(e||{},a,k.transition,t,o)}var a={};return t("duration"),t("easing"),a},_.supplyFrameDefaults=function(e){function t(t,o){return x.coerce(e,a,T,t,o)}var a={};return t("group"),t("name"),t("traces"),t("baseframe"),t("data"),t("layout"),a},_.supplyTraceDefaults=function(e,t,a,o,r){function n(a,o){return x.coerce(e,t,_.attributes,a,o)}function l(e,t,a){u&&e in u.attributes&&void 0===u.attributes[e]||(a&&"function"==typeof a?a():n(e,t))}var s=o.colorway||b.defaults,d=s[a%s.length],c=n("visible"),p;n("type"),n("name",o._traceWord+" "+r),n("uirevision",o.uirevision);var u=_.getModule(t);if(t._module=u,u){var g=u.basePlotModule,h=g.attr,y=g.attributes;if(h&&y){var f=o._subplots,v="";if("gl2d"!==g.name||c){if(Array.isArray(h))for(p=0;p<h.length;p++){var w=h[p],k=x.coerce(e,t,y,w);f[w]&&x.pushUnique(f[w],k),v+=k}else v=x.coerce(e,t,y,h);f[g.name]&&x.pushUnique(f[g.name],v)}}}return c&&(n("customdata"),n("ids"),m.traceIs(t,"showLegend")?(t._dfltShowLegend=!0,n("showlegend"),n("legendgroup")):t._dfltShowLegend=!1,l("hoverlabel","",function(){m.getComponentMethod("fx","supplyDefaults")(e,t,d,o)}),u&&(u.supplyDefaults(e,t,d,o),!t.hovertemplate&&x.coerceHoverinfo(e,t,o)),!m.traceIs(t,"noOpacity")&&n("opacity"),m.traceIs(t,"notLegendIsolatable")&&(t.visible=!!t.visible),u&&u.selectPoints&&n("selectedpoints"),_.supplyTransformDefaults(e,t,o)),t},_.hasMakesDataTransform=d,_.supplyTransformDefaults=function(e,t,a){if(t._length||d(e)){var o=a._globalTransforms||[],r=a._transformModules||[];if(Array.isArray(e.transforms)||0!==o.length)for(var n=e.transforms||[],l=o.concat(n),s=t.transforms=[],c=0;c<l.length;c++){var p=l[c],u=p.type,g=C[u],h=!(p._module&&p._module===g),m=g&&"function"==typeof g.transform,y;g||x.warn("Unrecognized transform type "+u+"."),g&&g.supplyDefaults&&(h||m)?(y=g.supplyDefaults(p,t,a,e),y.type=u,y._module=g,x.pushUnique(r,g)):y=x.extendFlat({},p),s.push(y)}}},_.supplyLayoutGlobalDefaults=function(e,t,a){function o(a,o){return x.coerce(e,t,_.layoutAttributes,a,o)}var r=e.template;x.isPlainObject(r)&&(t.template=r,t._template=r.layout,t._dataTemplate=r.data);var i=x.coerceFont(o,"font");o("title.text",t._dfltTitle.plot),x.coerceFont(o,"title.font",{family:i.family,size:R(1.4*i.size),color:i.color}),o("title.xref"),o("title.yref"),o("title.x"),o("title.y"),o("title.xanchor"),o("title.yanchor"),o("title.pad.t"),o("title.pad.r"),o("title.pad.b"),o("title.pad.l"),o("autosize",!(e.width&&e.height)),o("width"),o("height"),o("margin.l"),o("margin.r"),o("margin.t"),o("margin.b"),o("margin.pad"),o("margin.autoexpand"),e.width&&e.height&&_.sanitizeMargins(t),m.getComponentMethod("grid","sizeDefaults")(e,t),o("paper_bgcolor"),o("separators",a.decimal+a.thousands),o("hidesources"),o("colorway"),o("datarevision");var n=o("uirevision");o("editrevision",n),o("selectionrevision",n),o("modebar.orientation"),o("modebar.bgcolor",b.addOpacity(t.paper_bgcolor,.5));var l=b.contrast(b.rgb(t.modebar.bgcolor));o("modebar.color",b.addOpacity(l,.3)),o("modebar.activecolor",b.addOpacity(l,.7)),o("modebar.uirevision",n),m.getComponentMethod("calendars","handleDefaults")(e,t,"calendar"),m.getComponentMethod("fx","supplyLayoutGlobalDefaults")(e,t,o)},_.plotAutoSize=function(e,t,a){var o=e._context||{},r=o.frameMargins,n=x.isPlotDiv(e),l,s;if(n&&e.emit("plotly_autosize"),o.fillFrame)l=window.innerWidth,s=window.innerHeight,document.body.style.overflow="hidden";else{var d=n?window.getComputedStyle(e):{};if(l=parseFloat(d.width)||parseFloat(d.maxWidth)||a.width,s=parseFloat(d.height)||parseFloat(d.maxHeight)||a.height,i(r)&&0<r){var c=1-2*r;l=R(c*l),s=R(c*s)}}var p=_.layoutAttributes.width.min,u=_.layoutAttributes.height.min;l<p&&(l=p),s<u&&(s=u);var g=!t.width&&1<wa(a.width-l),h=!t.height&&1<wa(a.height-s);(h||g)&&(g&&(a.width=l),h&&(a.height=s)),e._initialAutoSize||(e._initialAutoSize={width:l,height:s}),_.sanitizeMargins(a)},_.supplyLayoutModuleDefaults=function(e,t,a,o){var r=m.componentsRegistry,n=t._basePlotModules,l=m.subplotsRegistry.cartesian,s,d,c;for(s in r)c=r[s],c.includeBasePlot&&c.includeBasePlot(e,t);for(var p in n.length||n.push(l),t._has("cartesian")&&(m.getComponentMethod("grid","contentDefaults")(e,t),l.finalizeSubplots(e,t)),t._subplots)t._subplots[p].sort(x.subplotSort);for(d=0;d<n.length;d++)c=n[d],c.supplyLayoutDefaults&&c.supplyLayoutDefaults(e,t,a);var u=t._modules;for(d=0;d<u.length;d++)c=u[d],c.supplyLayoutDefaults&&c.supplyLayoutDefaults(e,t,a);var g=t._transformModules;for(d=0;d<g.length;d++)c=g[d],c.supplyLayoutDefaults&&c.supplyLayoutDefaults(e,t,a,o);for(s in r)c=r[s],c.supplyLayoutDefaults&&c.supplyLayoutDefaults(e,t,a)},_.purge=function(e){var t=e._fullLayout||{};t._glcontainer!==void 0&&(t._glcontainer.selectAll(".gl-canvas").remove(),t._glcontainer.remove(),t._glcanvas=null),t._geocontainer!==void 0&&t._geocontainer.remove(),t._modeBar&&t._modeBar.destroy(),e._transitionData&&(e._transitionData._interruptCallbacks&&(e._transitionData._interruptCallbacks.length=0),e._transitionData._animationRaf&&window.cancelAnimationFrame(e._transitionData._animationRaf)),x.clearThrottle(),x.clearResponsive(e),delete e.data,delete e.layout,delete e._fullData,delete e._fullLayout,delete e.calcdata,delete e.framework,delete e.empty,delete e.fid,delete e.undoqueue,delete e.undonum,delete e.autoplay,delete e.changed,delete e._promises,delete e._redrawTimer,delete e._hmlumcount,delete e._hmpixcount,delete e._transitionData,delete e._transitioning,delete e._initialAutoSize,delete e._transitioningWithDuration,delete e._dragging,delete e._dragged,delete e._hoverdata,delete e._snapshotInProgress,delete e._editing,delete e._replotPending,delete e._mouseDownTime,delete e._legendMouseDownTime,e.removeAllListeners&&e.removeAllListeners()},_.style=function(e){var t=e._fullLayout._visibleModules,a=[],o;for(o=0;o<t.length;o++){var r=t[o];r.style&&x.pushUnique(a,r.style)}for(o=0;o<a.length;o++)a[o](e)},_.sanitizeMargins=function(e){if(e&&e.margin){var t=e.width,a=e.height,o=e.margin,r=t-(o.l+o.r),i=a-(o.t+o.b),n;0>r&&(n=(t-1)/(o.l+o.r),o.l=ea(n*o.l),o.r=ea(n*o.r)),0>i&&(n=(a-1)/(o.t+o.b),o.t=ea(n*o.t),o.b=ea(n*o.b))}},_.clearAutoMarginIds=function(e){e._fullLayout._pushmarginIds={}},_.allowAutoMargin=function(e,t){e._fullLayout._pushmarginIds[t]=1},_.autoMargin=function(e,t,a){var o=e._fullLayout,r=o._pushmargin,i=o._pushmarginIds;if(!1!==o.margin.autoexpand){if(!a)delete r[t],delete i[t];else{var n=a.pad;if(n===void 0){var l=o.margin;n=ie(12,l.l,l.r,l.t,l.b)}a.l+a.r>.5*o.width&&(a.l=a.r=0),a.b+a.t>.5*o.height&&(a.b=a.t=0);var s=a.xl===void 0?a.x:a.xl,d=a.xr===void 0?a.x:a.xr,c=a.yt===void 0?a.y:a.yt,p=a.yb===void 0?a.y:a.yb;r[t]={l:{val:s,size:a.l+n},r:{val:d,size:a.r+n},b:{val:p,size:a.b+n},t:{val:c,size:a.t+n}},i[t]=1}o._replotting||_.doAutoMargin(e)}},_.doAutoMargin=function(e){var t=e._fullLayout;t._size||(t._size={}),p(t);var a=t._size,o=JSON.stringify(a),r=t.margin,n=r.l,l=r.r,s=r.t,d=r.b,c=t._pushmargin,u=t._pushmarginIds;if(!1!==t.margin.autoexpand){for(var g in c)u[g]||delete c[g];for(var h in c.base={l:{val:0,size:n},r:{val:1,size:l},t:{val:1,size:s},b:{val:0,size:d}},c){var y=c[h].l||{},f=c[h].b||{},x=y.val,b=y.size,_=f.val,v=f.size;for(var w in c){if(i(b)&&c[w].r){var k=c[w].r.val,T=c[w].r.size;if(k>x){var A=(b*k+(T-t.width)*x)/(k-x),S=(T*(1-x)+(b-t.width)*(1-k))/(k-x);0<=A&&0<=S&&A+S>n+l&&(n=A,l=S)}}if(i(v)&&c[w].t){var C=c[w].t.val,L=c[w].t.size;if(C>_){var E=(v*C+(L-t.height)*_)/(C-_),z=(L*(1-_)+(v-t.height)*(1-C))/(C-_);0<=E&&0<=z&&E+z>d+s&&(d=E,s=z)}}}}}return(a.l=R(n),a.r=R(l),a.t=R(s),a.b=R(d),a.p=R(r.pad),a.w=R(t.width)-a.l-a.r,a.h=R(t.height)-a.t-a.b,!t._replotting&&"{}"!==o&&o!==JSON.stringify(t._size))?("_redrawFromAutoMarginCount"in t?t._redrawFromAutoMarginCount++:t._redrawFromAutoMarginCount=1,m.call("plot",e)):void 0},_.graphJson=function(e,t,a,o,r){function i(e){if("function"==typeof e)return null;if(x.isPlainObject(e)){var t={},o,r;for(o in e)if("function"!=typeof e[o]&&-1===["_","["].indexOf(o.charAt(0))){if("keepdata"===a){if("src"===o.substr(o.length-3))continue;}else if("keepstream"===a){if(r=e[o+"src"],"string"==typeof r&&0<r.indexOf(":")&&!x.isPlainObject(e.stream))continue;}else if("keepall"!==a&&(r=e[o+"src"],"string"==typeof r&&0<r.indexOf(":")))continue;t[o]=i(e[o])}return t}return Array.isArray(e)?e.map(i):x.isTypedArray(e)?x.simpleMap(e,x.identity):x.isJSDate(e)?x.ms2DateTimeLocal(+e):e}(r&&t&&!e._fullData||r&&!t&&!e._fullLayout)&&_.supplyDefaults(e);var n=r?e._fullData:e.data,l=r?e._fullLayout:e.layout,s=(e._transitionData||{})._frames,d={data:(n||[]).map(function(e){var a=i(e);return t&&delete a.fit,a})};return t||(d.layout=i(l)),e.framework&&e.framework.isPolar&&(d=e.framework.getConfig()),s&&(d.frames=i(s)),"object"===o?d:JSON.stringify(d)},_.modifyFrames=function(e,t){var a=e._transitionData._frames,o=e._transitionData._frameHash,r,n,l;for(r=0;r<t.length;r++)switch(n=t[r],n.type){case"replace":l=n.value;var s=(a[n.index]||{}).name,d=l.name;a[n.index]=o[d]=l,d!==s&&(delete o[s],o[d]=l);break;case"insert":l=n.value,o[l.name]=l,a.splice(n.index,0,l);break;case"delete":l=a[n.index],delete o[l.name],a.splice(n.index,1);}return Promise.resolve()},_.computeFrame=function(e,t){var a=e._transitionData._frameHash,o,r,n,l;if(!t)throw new Error("computeFrame must be given a string frame name");var s=a[t.toString()];if(!s)return!1;for(var d=[s],c=[s.name];s.baseframe&&(s=a[s.baseframe.toString()])&&!(-1!==c.indexOf(s.name));)d.push(s),c.push(s.name);for(var p={};s=d.pop();)if(s.layout&&(p.layout=_.extendLayout(p.layout,s.layout)),s.data){if(p.data||(p.data=[]),r=s.traces,!r)for(r=[],o=0;o<s.data.length;o++)r[o]=o;for(p.traces||(p.traces=[]),o=0;o<s.data.length;o++)(n=r[o],void 0!==n&&null!==n)&&(l=p.traces.indexOf(n),-1===l&&(l=p.data.length,p.traces[l]=n),p.data[l]=_.extendTrace(p.data[l],s.data[o]))}return p},_.recomputeFrameHash=function(e){for(var t=e._transitionData._frameHash={},a=e._transitionData._frames,o=0,r;o<a.length;o++)r=a[o],r&&r.name&&(t[r.name]=r)},_.extendObjectWithContainers=function(e,t,a){var o=x.extendDeepNoArrays({},t||{}),r=x.expandObjectPaths(o),n={},l,s,d,c,p,u,g,h;if(a&&a.length)for(d=0;d<a.length;d++)l=x.nestedProperty(r,a[d]),s=l.get(),void 0===s?x.nestedProperty(n,a[d]).set(null):(l.set(null),x.nestedProperty(n,a[d]).set(s));if(e=x.extendDeepNoArrays(e||{},r),a&&a.length)for(d=0;d<a.length;d++)if(p=x.nestedProperty(n,a[d]),g=p.get(),g){for(u=x.nestedProperty(e,a[d]),h=u.get(),Array.isArray(h)||(h=[],u.set(h)),c=0;c<g.length;c++){var m=g[c];h[c]=null===m?null:_.extendObjectWithContainers(h[c],m)}u.set(h)}return e},_.dataArrayContainers=["transforms","dimensions"],_.layoutArrayContainers=m.layoutArrayContainers,_.extendTrace=function(e,t){return _.extendObjectWithContainers(e,t,_.dataArrayContainers)},_.extendLayout=function(e,t){return _.extendObjectWithContainers(e,t,_.layoutArrayContainers)},_.transition=function(e,t,a,o,r,n){function l(){var o;for(o=0;o<u.length;o++){var r=u[o],n=e._fullData[r],l=n._module;l&&(l.animatable&&g.push(r),e.data[u[o]]=_.extendTrace(e.data[u[o]],t[o]))}var s=x.expandObjectPaths(x.extendDeepNoArrays({},a)),d=/^[xy]axis[0-9]*$/;for(var c in s)d.test(c)&&delete s[c].range;return _.extendLayout(e.layout,s),delete e.calcdata,_.supplyDefaults(e),_.doCalcdata(e),Promise.resolve()}function s(e){var t=Promise.resolve();if(!e)return t;for(;e.length;)t=t.then(e.shift());return t}function d(e){if(e)for(;e.length;)e.shift()}function c(t){if(e._transitionData)return d(e._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(r.redraw)return m.call("redraw",e)}).then(function(){e._transitioning=!1,e._transitioningWithDuration=!1,e.emit("plotly_transitioned",[])}).then(t)}var p=Array.isArray(t)?t.length:0,u=o.slice(0,p),g=[],h=!1,y,f;for(y=0;y<u.length;y++){f=u[y];var b=e._fullData[f],v=b._module}var w=[_.previousPromises,function(){if(e._transitionData)return e._transitioning=!1,s(e._transitionData._interruptCallbacks)},l,_.rehover,function(){return e.emit("plotly_transitioning",[]),new Promise(function(t){function o(){return i++,function(){l++,h||l!==i||c(t)}}e._transitioning=!0,0<n.duration&&(e._transitioningWithDuration=!0),e._transitionData._interruptCallbacks.push(function(){h=!0}),r.redraw&&e._transitionData._interruptCallbacks.push(function(){return m.call("redraw",e)}),e._transitionData._interruptCallbacks.push(function(){e.emit("plotly_transitioninterrupted",[])});var i=0,l=0,s=e._fullLayout._basePlotModules,d=!1,p,u;if(a)for(u=0;u<s.length;u++)if(s[u].transitionAxes){var y=x.expandObjectPaths(a);d=s[u].transitionAxes(e,y,n,o)||d}for(d?(p=x.extendFlat({},n),p.duration=0,g=null):p=n,u=0;u<s.length;u++)s[u].plot(e,g,p,o);setTimeout(o())})}],k=x.syncOrAsync(w,e);return k&&k.then||(k=Promise.resolve()),k.then(function(){return e})},_.doCalcdata=function(e,t){function a(t,a){if(d=r[t],c=d._module,!!c.isContainer===a){var o=[];if(!0===d.visible){delete d._indexToPoints;var i=d.transforms||[];for(h=i.length-1;0<=h;h--)if(i[h].enabled){d._indexToPoints=i[h]._indexToPoints;break}c&&c.calc&&(o=c.calc(e,d))}Array.isArray(o)&&o[0]||(o=[{x:v,y:v}]),o[0].t||(o[0].t={}),o[0].trace=d,l[t]=o}}var o=w.list(e),r=e._fullData,n=e._fullLayout,l=Array(r.length),s=(e.calcdata||[]).slice(0),d,c,p,h;for(e.calcdata=l,n._numBoxes=0,n._numViolins=0,n._violinScaleGroupStats={},e._hmpixcount=0,e._hmlumcount=0,n._piecolormap={},p=0;p<r.length;p++)if(Array.isArray(t)&&-1===t.indexOf(p)){l[p]=s[p];continue}for(p=0;p<r.length;p++)d=r[p],d._arrayAttrs=y.findArrayAttributes(d),d._extremes={};var f=n._subplots.polar||[];for(p=0;p<f.length;p++)o.push(n[f[p]].radialaxis,n[f[p]].angularaxis);u(o,r);var x=!1;for(p=0;p<r.length;p++)if(d=r[p],!0===d.visible&&d.transforms){if(c=d._module,c&&c.calc){var b=c.calc(e,d);b[0]&&b[0].t&&b[0].t._scene&&delete b[0].t._scene.dirty}for(h=0;h<d.transforms.length;h++){var _=d.transforms[h];c=C[_.type],c&&c.calcTransform&&(d._hasCalcTransform=!0,x=!0,c.calcTransform(e,d,_))}}for(x&&u(o,r),p=0;p<r.length;p++)a(p,!0);for(p=0;p<r.length;p++)a(p,!1);g(e),m.getComponentMethod("fx","calc")(e),m.getComponentMethod("errorbars","calc")(e)},_.rehover=function(e){e._fullLayout._rehover&&e._fullLayout._rehover()},_.generalUpdatePerTraceModule=function(e,t,a,o){var r=t.traceHash,n={},l;for(l=0;l<a.length;l++){var s=a[l],d=s[0].trace;d.visible&&(n[d.type]=n[d.type]||[],n[d.type].push(s))}for(var c in r)if(!n[c]){var p=r[c][0],u=p[0].trace;u.visible=!1,n[c]=[p]}for(var g in n){var h=n[g],m=h[0][0].trace._module;m.plot(e,t,x.filterVisible(h),o)}t.traceHash=n}},{"../components/color":569,"../constants/numerical":669,"../lib":692,"../plot_api/plot_schema":729,"../plot_api/plot_template":730,"../plots/cartesian/axis_ids":743,"../registry":823,"./animation_attributes":735,"./attributes":737,"./command":765,"./font_attributes":767,"./frame_attributes":768,"./layout_attributes":795,d3:148,"fast-isnumeric":214}],805:[function(e,t){"use strict";t.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],806:[function(e,t){"use strict";function a(e,t,o,a){var r=a[0],i=a[1],n=l(M(t)-M(e)),s=l(te(t)-te(e)),d=g(o),c=l(1/d),p=n/s,u=i-p*r,h,m;return c?n&&s?(h=u/(d-p),m=d*h):s?(h=i*c,m=i):(h=r,m=r*d):n&&s?(h=0,m=u):s?(h=0,m=i):h=m=NaN,[h,m]}function o(e,t){var a=t.length,o=Array(a+1),r;for(r=0;r<a;r++){var n=t[r];o[r]=[e*te(n),e*M(n)]}return o[r]=o[0].slice(),o}function i(e,t,o,r){function n(t){return[e*te(t),e*M(t)]}function l(e,t,o){return a(e,t,o,n(e))}function s(e){return d.mod(e,g)}function c(e){return u(e,[t,o])}var g=r.length,h=[],y=p(r,function(e){return c(e)?m(e,t):1/0}),f=l(r[y],r[s(y-1)],t),x,b;for(h.push(f),x=y,b=0;b<g;x++,b++){var _=r[s(x)];if(!c(_))break;h.push(n(_))}var v=p(r,function(e){return c(e)?m(e,o):1/0}),w=l(r[v],r[s(v+1)],o);return h.push(w),h.push([0,0]),h.push(h[0].slice()),h}function n(e,t,a,r){return d.isFullCircle([t,a])?o(e,r):i(e,t,a,r)}function l(e){return 1e-10<wa(e)?e:0}function s(e,t,a){t=t||0,a=a||0;for(var o=e.length,r=Array(o),n=0,l;n<o;n++)l=e[n],r[n]=[t+l[0],a-l[1]];return r}var d=e("../../lib"),c=e("../../lib/polygon").tester,p=d.findIndexOfMin,u=d.isAngleInsideSector,h=d.angleDelta,m=d.angleDist;t.exports={isPtInsidePolygon:function(e,t,a,o,r){if(!u(t,o))return!1;var i,l;a[0]<a[1]?(i=a[0],l=a[1]):(i=a[1],l=a[0]);var s=c(n(i,o[0],o[1],r)),d=c(n(l,o[0],o[1],r)),p=[e*te(t),e*M(t)];return d.contains(p)&&!s.contains(p)},findPolygonOffset:function(e,t,a,o){for(var r=1/0,l=1/0,s=n(e,t,a,o),d=0,c;d<s.length;d++)c=s[d],r=ie(r,c[0]),l=ie(l,-c[1]);return[r,l]},findEnclosingVertexAngles:function(e,t){var a=p(t,function(t){var a=h(t,e);return 0<a?a:1/0}),o=d.mod(a+1,t.length);return[t[a],t[o]]},findIntersectionXY:a,findXYatLength:function(e,o,r,i){var n=-o*r,t=o*o+1,a=2*(o*n-r),l=re(a*a-4*t*(n*n+r*r-e*e)),s=(-a+l)/(2*t),d=(-a-l)/(2*t);return[[s,o*s+n+i],[d,o*d+n+i]]},clampTiny:l,pathPolygon:function(e,t,a,o,r,i){var l=n(e,t,a,o);return"M"+s(l,r,i).join("L")},pathPolygonAnnulus:function(e,t,a,o,r,i,l){var d,c;e<t?(d=e,c=t):(d=t,c=e);var p=s(n(d,a,o,r),i,l),u=s(n(c,a,o,r),i,l);return"M"+u.reverse().join("L")+"M"+p.join("L")}}},{"../../lib":692,"../../lib/polygon":704}],807:[function(e,t){"use strict";var a=e("../get_data").getSubplotCalcData,o=e("../../lib").counterRegex,r=e("./polar"),i=e("./constants"),n=i.attr,l=i.name,s=o(l),d={};d[n]={valType:"subplotid",dflt:l,editType:"calc"},t.exports={attr:n,name:l,idRoot:l,idRegex:s,attrRegex:s,attributes:d,layoutAttributes:e("./layout_attributes"),supplyLayoutDefaults:e("./layout_defaults"),plot:function(e){for(var t=e._fullLayout,o=e.calcdata,n=t._subplots[l],s=0;s<n.length;s++){var d=n[s],c=a(o,l,d),p=t[d]._subplot;p||(p=r(e,d),t[d]._subplot=p),p.plot(c,t,e._promises)}},clean:function(e,t,a,o){for(var r=o._subplots[l]||[],n=o._has&&o._has("gl"),s=t._has&&t._has("gl"),d=0;d<r.length;d++){var c=r[d],p=o[c]._subplot;if(!t[c]&&!!p)for(var u in p.framework.remove(),p.layers["radial-axis-title"].remove(),p.clipPaths)p.clipPaths[u].remove();n&&!s&&p._scene&&(p._scene.destroy(),p._scene=null)}},toSVG:e("../cartesian").toSVG}},{"../../lib":692,"../cartesian":752,"../get_data":777,"./constants":805,"./layout_attributes":808,"./layout_defaults":809,"./polar":816}],808:[function(e,t){"use strict";var a=e("../../components/color/attributes"),o=e("../cartesian/layout_attributes"),r=e("../domain").attributes,i=e("../../lib").extendFlat,n=e("../../plot_api/edit_types").overrideAll,l=n({color:o.color,showline:i({},o.showline,{dflt:!0}),linecolor:o.linecolor,linewidth:o.linewidth,showgrid:i({},o.showgrid,{dflt:!0}),gridcolor:o.gridcolor,gridwidth:o.gridwidth},"plot","from-root"),s=n({tickmode:o.tickmode,nticks:o.nticks,tick0:o.tick0,dtick:o.dtick,tickvals:o.tickvals,ticktext:o.ticktext,ticks:o.ticks,ticklen:o.ticklen,tickwidth:o.tickwidth,tickcolor:o.tickcolor,showticklabels:o.showticklabels,showtickprefix:o.showtickprefix,tickprefix:o.tickprefix,showticksuffix:o.showticksuffix,ticksuffix:o.ticksuffix,showexponent:o.showexponent,exponentformat:o.exponentformat,separatethousands:o.separatethousands,tickfont:o.tickfont,tickangle:o.tickangle,tickformat:o.tickformat,tickformatstops:o.tickformatstops,layer:o.layer},"plot","from-root"),d={visible:i({},o.visible,{dflt:!0}),type:i({},o.type,{values:["-","linear","log","date","category"]}),autorange:i({},o.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:i({},o.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:o.categoryorder,categoryarray:o.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:n(o.title,"plot","from-root"),hoverformat:o.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:o._deprecated.title,titlefont:o._deprecated.titlefont}};d.title.text.dflt="",i(d,l,s);var c={visible:i({},o.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},categoryorder:o.categoryorder,categoryarray:o.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:o.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};i(c,l,s),t.exports={domain:r({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:a.background},radialaxis:d,angularaxis:c,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":568,"../../lib":692,"../../plot_api/edit_types":723,"../cartesian/layout_attributes":753,"../domain":766}],809:[function(e,t){"use strict";function a(e,t,a,s){function m(e,t){return a(A+"."+e,t)}var _=a("bgcolor");s.bgColor=n.combine(_,s.paper_bgcolor);var v=a("sector");a("hole");for(var w=d(s.fullData,x.name,s.id),k=s.layoutOut,T=0,A;T<b.length;T++){A=b[T],r.isPlainObject(e[A])||(e[A]={});var S=e[A],C=l.newContainer(t,A);C._id=C._name=A,C._attr=s.id+"."+A,C._traceIndices=w.map(function(e){return e._expandedIndex});var L=x.axisName2dataArray[A],E=o(S,C,m,w,L);g(S,C,m,{axData:w,dataAttr:L});var z=m("visible");f(C,t,k),m("uirevision",t.uirevision);var I,D;switch(z&&(I=m("color"),D=I===S.color?I:s.font.color),C._m=1,A){case"radialaxis":var P=m("autorange",!C.isValidRange(S.range));S.autorange=P,P&&("linear"===E||"-"===E)&&m("rangemode"),"reversed"===P&&(C._m=-1),m("range"),C.cleanRange("range",{dfltRange:[0,1]}),z&&(m("side"),m("angle",v[0]),m("title.text"),r.coerceFont(m,"title.font",{family:s.font.family,size:R(1.2*s.font.size),color:D}));break;case"angularaxis":if("date"===E){r.log("Polar plots do not support date angular axes yet.");for(var O=0;O<w.length;O++)w[O].visible=!1;E=S.type=C.type="linear"}"linear"===E?m("thetaunit"):m("period");var M=m("direction");m("rotation",{counterclockwise:0,clockwise:90}[M]);}if(z){c(S,C,m,C.type),u(S,C,m,C.type,{tickSuffixDflt:"degrees"===C.thetaunit?"\xB0":void 0}),p(S,C,m,{outerTicks:!0});var B=m("showticklabels");B&&(r.coerceFont(m,"tickfont",{family:s.font.family,size:s.font.size,color:D}),m("tickangle"),m("tickformat")),h(S,C,m,{dfltColor:I,bgColor:s.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:y[A]}),m("layer")}"category"!==E&&m("hoverformat"),C._input=S}"category"===t.angularaxis.type&&a("gridshape")}function o(e,t,a,o,r){var n=a("type");if("-"===n){for(var l=0,s;l<o.length;l++)if(o[l].visible){s=o[l];break}s&&s[r]&&(t.type=m(s[r],"gregorian")),"-"===t.type?t.type="linear":e.type=t.type}return t.type}var r=e("../../lib"),n=e("../../components/color"),l=e("../../plot_api/plot_template"),s=e("../subplot_defaults"),d=e("../get_data").getSubplotData,c=e("../cartesian/tick_value_defaults"),p=e("../cartesian/tick_mark_defaults"),u=e("../cartesian/tick_label_defaults"),g=e("../cartesian/category_order_defaults"),h=e("../cartesian/line_grid_defaults"),m=e("../cartesian/axis_autotype"),y=e("./layout_attributes"),f=e("./set_convert"),x=e("./constants"),b=x.axisNames;t.exports=function(e,t,o){s(e,t,o,{type:x.name,attributes:y,handleDefaults:a,font:t.font,paper_bgcolor:t.paper_bgcolor,fullData:o,layoutOut:t})}},{"../../components/color":569,"../../lib":692,"../../plot_api/plot_template":730,"../cartesian/axis_autotype":741,"../cartesian/category_order_defaults":744,"../cartesian/line_grid_defaults":755,"../cartesian/tick_label_defaults":760,"../cartesian/tick_mark_defaults":761,"../cartesian/tick_value_defaults":762,"../get_data":777,"../subplot_defaults":818,"./constants":805,"./layout_attributes":808,"./set_convert":817}],810:[function(e,t){"use strict";var a=e("../../../traces/scatter/attributes"),o=a.marker,r=e("../../../lib/extend").extendFlat;t.exports={r:r({},a.r,{}),t:r({},a.t,{}),marker:{color:r({},o.color,{}),size:r({},o.size,{}),symbol:r({},o.symbol,{}),opacity:r({},o.opacity,{}),editType:"calc"}}},{"../../../lib/extend":682,"../../../traces/scatter/attributes":1040}],811:[function(e,t){"use strict";function a(e,t){return r({},t,{showline:{valType:"boolean"},showticklabels:{valType:"boolean"},tickorientation:{valType:"enumerated",values:["horizontal","vertical"]},ticklen:{valType:"number",min:0},tickcolor:{valType:"color"},ticksuffix:{valType:"string"},endpadding:{valType:"number",description:n},visible:{valType:"boolean"}})}var o=e("../../cartesian/layout_attributes"),r=e("../../../lib/extend").extendFlat,i=e("../../../plot_api/edit_types").overrideAll,n="Legacy polar charts are deprecated! Please switch to *polar* subplots.",l=r({},o.domain,{});t.exports=i({radialaxis:a("radial",{range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},domain:l,orientation:{valType:"number"}}),angularaxis:a("angular",{range:{valType:"info_array",items:[{valType:"number",dflt:0},{valType:"number",dflt:360}]},domain:l}),layout:{direction:{valType:"enumerated",values:["clockwise","counterclockwise"]},orientation:{valType:"angle"}}},"plot","nested")},{"../../../lib/extend":682,"../../../plot_api/edit_types":723,"../../cartesian/layout_attributes":753}],812:[function(e,t){"use strict";var a=t.exports=e("./micropolar");a.manager=e("./micropolar_manager")},{"./micropolar":813,"./micropolar_manager":814}],813:[function(e,t){var o=e("d3"),a=e("../../../lib"),n=a.extendDeepAll,l=e("../../../constants/alignment").MID_SHIFT,s=t.exports={version:"0.2.2"};s.Axis=function(){function e(e){p=e||p;var a=t.data,h=t.layout;return("string"==typeof p||p.nodeName)&&(p=o.select(p)),p.datum(a).each(function(e){function t(e){return g(e)%360+h.orientation}var a=e.slice();r={data:s.util.cloneJson(a),layout:s.util.cloneJson(h)};var p=0;a.forEach(function(e,t){e.color||(e.color=h.defaultColorRange[p],p=(p+1)%h.defaultColorRange.length),e.strokeColor||(e.strokeColor="LinePlot"===e.geometry?e.color:o.rgb(e.color).darker().toString()),r.data[t].color=e.color,r.data[t].strokeColor=e.strokeColor,r.data[t].strokeDash=e.strokeDash,r.data[t].strokeSize=e.strokeSize});var m=a.filter(function(e){var t=e.visible;return"undefined"==typeof t||!0===t}),y=!1,f=m.map(function(e){return y=y||"undefined"!=typeof e.groupId,e});if(y){var x=o.nest().key(function(e){return"undefined"==typeof e.groupId?"unstacked":e.groupId}).entries(f),b=[],_=x.map(function(e){if("unstacked"===e.key)return e.values;var t=e.values[0].r.map(function(){return 0});return e.values.forEach(function(e){e.yStack=[t],b.push(t),t=s.util.sumArrays(e.r,t)}),e.values});m=o.merge(_)}m.forEach(function(e){e.t=Array.isArray(e.t[0])?e.t:[e.t],e.r=Array.isArray(e.r[0])?e.r:[e.r]});var v=ie(h.width-h.margin.left-h.margin.right,h.height-h.margin.top-h.margin.bottom)/2;v=va(10,v);var w=[h.margin.left+v,h.margin.top+v],k;if(y){var T=o.max(s.util.sumArrays(s.util.arrayLast(m).r[0],s.util.arrayLast(b)));k=[0,T]}else k=o.extent(s.util.flattenArray(m.map(function(e){return e.r})));h.radialAxis.domain!=s.DATAEXTENT&&(k[0]=0),u=o.scale.linear().domain(h.radialAxis.domain!=s.DATAEXTENT&&h.radialAxis.domain?h.radialAxis.domain:k).range([0,v]),r.layout.radialAxis.domain=u.domain();var A=s.util.flattenArray(m.map(function(e){return e.t})),S="string"==typeof A[0],C;S&&(A=s.util.deduplicate(A),C=A.slice(),A=o.range(A.length),m=m.map(function(e){var t=e;return e.t=[A],y&&(t.yStack=e.yStack),t}));var L=m.filter(function(e){return"LinePlot"===e.geometry||"DotPlot"===e.geometry}).length===m.length,E=null===h.needsEndSpacing?S||!L:h.needsEndSpacing,z=h.angularAxis.domain&&h.angularAxis.domain!=s.DATAEXTENT&&!S&&0<=h.angularAxis.domain[0],I=z?h.angularAxis.domain:o.extent(A),D=wa(A[1]-A[0]);L&&!S&&(D=0);var P=I.slice();E&&S&&(P[1]+=D);var O=h.angularAxis.ticksCount||4;8<O&&(O=O/(O/8)+O%8),h.angularAxis.ticksStep&&(O=(P[1]-P[0])/O);var M=h.angularAxis.ticksStep||(P[1]-P[0])/(O*(h.minorTicks+1));C&&(M=va(R(M),1)),P[2]||(P[2]=M);var j=o.range.apply(this,P);if(j=j.map(function(e){return parseFloat(e.toPrecision(12))}),g=o.scale.linear().domain(P.slice(0,2)).range("clockwise"===h.direction?[0,360]:[360,0]),r.layout.angularAxis.domain=g.domain(),r.layout.angularAxis.endPadding=E?D:0,c=o.select(this).select("svg.chart-root"),"undefined"==typeof c||c.empty()){var B=new DOMParser().parseFromString("<svg xmlns='http://www.w3.org/2000/svg' class='chart-root'>' + '<g class='outer-group'>' + '<g class='chart-group'>' + '<circle class='background-circle'></circle>' + '<g class='geometry-group'></g>' + '<g class='radial axis-group'>' + '<circle class='outside-circle'></circle>' + '</g>' + '<g class='angular axis-group'></g>' + '<g class='guides-group'><line></line><circle r='0'></circle></g>' + '</g>' + '<g class='legend-group'></g>' + '<g class='tooltips-group'></g>' + '<g class='title-group'><text></text></g>' + '</g>' + '</svg>","application/xml"),F=this.appendChild(this.ownerDocument.importNode(B.documentElement,!0));c=o.select(F)}c.select(".guides-group").style({"pointer-events":"none"}),c.select(".angular.axis-group").style({"pointer-events":"none"}),c.select(".radial.axis-group").style({"pointer-events":"none"});var N=c.select(".chart-group"),V={fill:"none",stroke:h.tickColor},U={"font-size":h.font.size,"font-family":h.font.family,fill:h.font.color,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map(function(e){return" "+e+" 0 "+h.font.outlineColor}).join(",")},H;if(h.showLegend){H=c.select(".legend-group").attr({transform:"translate("+[v,h.margin.top]+")"}).style({display:"block"});var G=m.map(function(e){var t=s.util.cloneJson(e);return t.symbol="DotPlot"===e.geometry?e.dotType||"circle":"LinePlot"==e.geometry?"line":"square",t.visibleInLegend="undefined"==typeof e.visibleInLegend||e.visibleInLegend,t.color="LinePlot"===e.geometry?e.strokeColor:e.color,t});s.Legend().config({data:m.map(function(e,t){return e.name||"Element"+t}),legendConfig:n({},s.Legend.defaultConfig().legendConfig,{container:H,elements:G,reverseOrder:h.legend.reverseOrder})})();var Y=H.node().getBBox();v=ie(h.width-Y.width-h.margin.left-h.margin.right,h.height-h.margin.top-h.margin.bottom)/2,v=va(10,v),w=[h.margin.left+v,h.margin.top+v],u.range([0,v]),r.layout.radialAxis.domain=u.domain(),H.attr("transform","translate("+[w[0]+v,w[1]-v]+")")}else H=c.select(".legend-group").style({display:"none"});c.attr({width:h.width,height:h.height}).style({opacity:h.opacity}),N.attr("transform","translate("+w+")").style({cursor:"crosshair"});var q=[(h.width-(h.margin.left+h.margin.right+2*v+(Y?Y.width:0)))/2,(h.height-(h.margin.top+h.margin.bottom+2*v))/2];if(q[0]=va(0,q[0]),q[1]=va(0,q[1]),c.select(".outer-group").attr("transform","translate("+q+")"),h.title&&h.title.text){var W=c.select("g.title-group text").style(U).text(h.title.text),X=W.node().getBBox();W.attr({x:w[0]-X.width/2,y:w[1]-v-20})}var Z=c.select(".radial.axis-group");if(h.radialAxis.gridLinesVisible){var $=Z.selectAll("circle.grid-circle").data(u.ticks(5));$.enter().append("circle").attr({class:"grid-circle"}).style(V),$.attr("r",u),$.exit().remove()}Z.select("circle.outside-circle").attr({r:v}).style(V);var J=c.select("circle.background-circle").attr({r:v}).style({fill:h.backgroundColor,stroke:h.stroke});if(h.radialAxis.visible){var K=o.svg.axis().scale(u).ticks(5).tickSize(5);Z.call(K).attr({transform:"rotate("+h.radialAxis.orientation+")"}),Z.selectAll(".domain").style(V),Z.selectAll("g>text").text(function(){return this.textContent+h.radialAxis.ticksSuffix}).style(U).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(){return"horizontal"===h.radialAxis.tickOrientation?"rotate("+-h.radialAxis.orientation+") translate("+[0,U["font-size"]]+")":"translate("+[0,U["font-size"]]+")"}}),Z.selectAll("g>line").style({stroke:"black"})}var Q=c.select(".angular.axis-group").selectAll("g.angular-tick").data(j),ee=Q.enter().append("g").classed("angular-tick",!0);Q.attr({transform:function(e,a){return"rotate("+t(e,a)+")"}}).style({display:h.angularAxis.visible?"block":"none"}),Q.exit().remove(),ee.append("line").classed("grid-line",!0).classed("major",function(e,t){return 0==t%(h.minorTicks+1)}).classed("minor",function(e,t){return 0!=t%(h.minorTicks+1)}).style(V),ee.selectAll(".minor").style({stroke:h.minorTickColor}),Q.select("line.grid-line").attr({x1:h.tickLength?v-h.tickLength:0,x2:v}).style({display:h.angularAxis.gridLinesVisible?"block":"none"}),ee.append("text").classed("axis-text",!0).style(U);var te=Q.select("text.axis-text").attr({x:v+h.labelOffset,dy:l+"em",transform:function(e,a){var o=t(e,a),r=v+h.labelOffset,i=h.angularAxis.tickOrientation;return"horizontal"==i?"rotate("+-o+" "+r+" 0)":"radial"==i?270>o&&90<o?"rotate(180 "+r+" 0)":null:"rotate("+(180>=o&&0<o?-90:90)+" "+r+" 0)"}}).style({"text-anchor":"middle",display:h.angularAxis.labelsVisible?"block":"none"}).text(function(e,t){return 0==t%(h.minorTicks+1)?C?C[e]+h.angularAxis.ticksSuffix:e+h.angularAxis.ticksSuffix:""}).style(U);h.angularAxis.rewriteTicks&&te.text(function(e,t){return 0==t%(h.minorTicks+1)?h.angularAxis.rewriteTicks(this.textContent,t):""});var ae=o.max(N.selectAll(".angular-tick text")[0].map(function(e){return e.getCTM().e+e.getBBox().width}));H.attr({transform:"translate("+[v+ae,h.margin.top]+")"});var oe=0<c.select("g.geometry-group").selectAll("g").size(),re=c.select("g.geometry-group").selectAll("g.geometry").data(m);if(re.enter().append("g").attr({class:function(e,t){return"geometry geometry"+t}}),re.exit().remove(),m[0]||oe){var ne=[];m.forEach(function(e,t){var a={};a.radialScale=u,a.angularScale=g,a.container=re.filter(function(e,a){return a==t}),a.geometry=e.geometry,a.orientation=h.orientation,a.direction=h.direction,a.index=t,ne.push({data:e,geometryConfig:a})});var le=o.nest().key(function(e){return"undefined"!=typeof e.data.groupId||"unstacked"}).entries(ne),se=[];le.forEach(function(e){"unstacked"===e.key?se=se.concat(e.values.map(function(e){return[e]})):se.push(e.values)}),se.forEach(function(e){var t=Array.isArray(e)?e[0].geometryConfig.geometry:e.geometryConfig.geometry;var a=e.map(function(e){return n(s[t].defaultConfig(),e)});s[t]().config(a)()})}var de=c.select(".guides-group"),ce=c.select(".tooltips-group"),pe=s.tooltipPanel().config({container:ce,fontSize:8})(),ue=s.tooltipPanel().config({container:ce,fontSize:8})(),ge=s.tooltipPanel().config({container:ce,hasTick:!0})(),he,me;if(!S){var ye=de.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});N.on("mousemove.angular-guide",function(){var e=s.util.getMousePos(J).angle;ye.attr({x2:-v,transform:"rotate("+e+")"}).style({opacity:.5});var t=(e+180+360-h.orientation)%360;he=g.invert(t);var a=s.util.convertToCartesian(v+12,e+180);pe.text(s.util.round(he)).move([a[0]+w[0],a[1]+w[1]])}).on("mouseout.angular-guide",function(){de.select("line").style({opacity:0})})}var fe=de.select("circle").style({stroke:"grey",fill:"none"});N.on("mousemove.radial-guide",function(){var e=s.util.getMousePos(J).radius;fe.attr({r:e}).style({opacity:.5}),me=u.invert(s.util.getMousePos(J).radius);var t=s.util.convertToCartesian(e,h.radialAxis.orientation);ue.text(s.util.round(me)).move([t[0]+w[0],t[1]+w[1]])}).on("mouseout.radial-guide",function(){fe.style({opacity:0}),ge.hide(),pe.hide(),ue.hide()}),c.selectAll(".geometry-group .mark").on("mouseover.tooltip",function(e){var t=o.select(this),a=this.style.fill,r="black",i=this.style.opacity||1;if(t.attr({"data-opacity":i}),a&&"none"!==a){t.attr({"data-fill":a}),r=o.hsl(a).darker().toString(),t.style({fill:r,opacity:1});var n={t:s.util.round(e[0]),r:s.util.round(e[1])};S&&(n.t=C[e[0]]);var l="t: "+n.t+", r: "+n.r,d=this.getBoundingClientRect(),p=c.node().getBoundingClientRect(),u=[d.left+d.width/2-q[0]-p.left,d.top+d.height/2-q[1]-p.top];ge.config({color:r}).text(l),ge.move(u)}else a=this.style.stroke||"black",t.attr({"data-stroke":a}),r=o.hsl(a).darker().toString(),t.style({stroke:r,opacity:1})}).on("mousemove.tooltip",function(){return 0==o.event.which&&void(o.select(this).attr("data-fill")&&ge.show())}).on("mouseout.tooltip",function(){ge.hide();var e=o.select(this),t=e.attr("data-fill");t?e.style({fill:t,opacity:e.attr("data-opacity")}):e.style({stroke:e.attr("data-stroke"),opacity:e.attr("data-opacity")})})}),d}var t={data:[],layout:{}},a={},r={},i=o.dispatch("hover"),d={},c,p,u,g;return d.render=function(t){return e(t),this},d.config=function(e){if(!arguments.length)return t;var a=s.util.cloneJson(e);return a.data.forEach(function(e,a){t.data[a]||(t.data[a]={}),n(t.data[a],s.Axis.defaultConfig().data[0]),n(t.data[a],e)}),n(t.layout,s.Axis.defaultConfig().layout),n(t.layout,a.layout),this},d.getLiveConfig=function(){return r},d.getinputConfig=function(){return a},d.radialScale=function(){return u},d.angularScale=function(){return g},d.svg=function(){return c},o.rebind(d,i,"on"),d},s.Axis.defaultConfig=function(){var e={data:[{t:[1,2,3,4],r:[10,11,12,13],name:"Line1",geometry:"LinePlot",color:null,strokeDash:"solid",strokeColor:null,strokeSize:"1",visibleInLegend:!0,opacity:1}],layout:{defaultColorRange:o.scale.category10().range(),title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},font:{size:12,color:"gray",outlineColor:"white",family:"Tahoma, sans-serif"},direction:"clockwise",orientation:0,labelOffset:10,radialAxis:{domain:null,orientation:-45,ticksSuffix:"",visible:!0,gridLinesVisible:!0,tickOrientation:"horizontal",rewriteTicks:null},angularAxis:{domain:[0,360],ticksSuffix:"",visible:!0,gridLinesVisible:!0,labelsVisible:!0,tickOrientation:"horizontal",rewriteTicks:null,ticksCount:null,ticksStep:null},minorTicks:0,tickLength:null,tickColor:"silver",minorTickColor:"#eee",backgroundColor:"none",needsEndSpacing:null,showLegend:!0,legend:{reverseOrder:!1},opacity:1}};return e},s.util={},s.DATAEXTENT="dataExtent",s.AREA="AreaChart",s.LINE="LinePlot",s.DOT="DotPlot",s.BAR="BarChart",s.util._override=function(e,t){for(var a in e)a in t&&(t[a]=e[a])},s.util._extend=function(e,t){for(var a in e)t[a]=e[a]},s.util._rndSnd=function(){return 2*Math.random()-1+(2*Math.random()-1)+(2*Math.random()-1)},s.util.dataFromEquation2=function(e,t){var a=t||6,r=o.range(0,360+a,a).map(function(t){var a=e(t*Sa/180);return[t,a]});return r},s.util.dataFromEquation=function(e,a,i){var n=a||6,l=[],t=[];o.range(0,360+n,n).forEach(function(a){var o=e(a*Sa/180);l.push(a),t.push(o)});var r={t:l,r:t};return i&&(r.name=i),r},s.util.ensureArray=function(e,t){if("undefined"==typeof e)return null;var a=[].concat(e);return o.range(t).map(function(e,t){return a[t]||a[0]})},s.util.fillArrays=function(e,t,a){return t.forEach(function(t){e[t]=s.util.ensureArray(e[t],a)}),e},s.util.cloneJson=function(e){return JSON.parse(JSON.stringify(e))},s.util.validateKeys=function(e,t){"string"==typeof t&&(t=t.split("."));var a=t.shift();return e[a]&&(!t.length||objHasKeys(e[a],t))},s.util.sumArrays=function(e,t){return o.zip(e,t).map(function(e){return o.sum(e)})},s.util.arrayLast=function(e){return e[e.length-1]},s.util.arrayEqual=function(e,t){for(var a=va(e.length,t.length,1);0<=a--&&e[a]===t[a];);return-2===a},s.util.flattenArray=function(e){for(var t=[];!s.util.arrayEqual(t,e);)t=e,e=[].concat.apply([],e);return e},s.util.deduplicate=function(e){return e.filter(function(e,t,o){return o.indexOf(e)==t})},s.util.convertToCartesian=function(e,t){var a=t*Sa/180,o=e*te(a),r=e*M(a);return[o,r]},s.util.round=function(e,t){var a=_a(10,t||2);return R(e*a)/a},s.util.getMousePos=function(e){var t=o.mouse(e.node()),a=t[0],r=t[1],i={};return i.x=a,i.y=r,i.pos=t,i.angle=180*(L(r,a)+Sa)/Sa,i.radius=re(a*a+r*r),i},s.util.duplicatesCount=function(e){for(var t={},a={},o=0,r=e.length,n;o<r;o++)n=e[o],n in t?(t[n]++,a[n]=t[n]):t[n]=1;return a},s.util.duplicates=function(e){return Object.keys(s.util.duplicatesCount(e))},s.util.translator=function(e,t,a,o){if(o){var r=a.slice();a=t,t=r}var i=t.reduce(function(e,t){if("undefined"!=typeof e)return e[t]},e);"undefined"==typeof i||(t.reduce(function(e,a,o){if("undefined"!=typeof e)return o===t.length-1&&delete e[a],e[a]},e),a.reduce(function(e,t,o){return"undefined"==typeof e[t]&&(e[t]={}),o===a.length-1&&(e[t]=i),e[t]},e))},s.PolyChart=function(){function e(){var e=t[0].geometryConfig,a=e.container;"string"==typeof a&&(a=o.select(a)),a.datum(t).each(function(t){function a(a){var o=e.radialScale(a[1]),r=(e.angularScale(a[0])+e.orientation)*Sa/180;return{r:o,t:r}}function i(e){var t=e.r*te(e.t),a=e.r*M(e.t);return{x:t,y:a}}var n=!!t[0].data.yStack,l=t.map(function(e){return n?o.zip(e.data.t[0],e.data.r[0],e.data.yStack[0]):o.zip(e.data.t[0],e.data.r[0])}),s=e.angularScale,c=e.radialScale.domain()[0],p={};p.bar=function(a,r,i){var n=t[i].data,l=e.radialScale(a[1])-e.radialScale(0),d=e.radialScale(a[2]||0),c=n.barWidth;o.select(this).attr({class:"mark bar",d:"M"+[[l+d,-c/2],[l+d,c/2],[d,c/2],[d,-c/2]].join("L")+"Z",transform:function(t){return"rotate("+(e.orientation+s(t[0]))+")"}})},p.dot=function(e,r,n){var l=e[2]?[e[0],e[1]+e[2]]:e,s=o.svg.symbol().size(t[n].data.dotSize).type(t[n].data.dotType)(e,r);o.select(this).attr({class:"mark dot",d:s,transform:function(){var e=i(a(l));return"translate("+[e.x,e.y]+")"}})};var u=o.svg.line.radial().interpolate(t[0].data.lineInterpolation).radius(function(t){return e.radialScale(t[1])}).angle(function(t){return e.angularScale(t[0])*Sa/180});p.line=function(a,r,i){var n=a[2]?l[i].map(function(e){return[e[0],e[1]+e[2]]}):l[i];if(o.select(this).each(p.dot).style({opacity:function(){return+t[i].data.dotVisible},fill:y.stroke(a,r,i)}).attr({class:"mark dot"}),!(0<r)){var s=o.select(this.parentNode).selectAll("path.line").data([0]);s.enter().insert("path"),s.attr({class:"line",d:u(n),transform:function(){return"rotate("+(e.orientation+90)+")"},"pointer-events":"none"}).style({fill:function(){return y.fill(a,r,i)},"fill-opacity":0,stroke:function(){return y.stroke(a,r,i)},"stroke-width":function(){return y["stroke-width"](a,r,i)},"stroke-dasharray":function(){return y["stroke-dasharray"](a,r,i)},opacity:function(){return y.opacity(a,r,i)},display:function(){return y.display(a,r,i)}})}};var g=e.angularScale.range(),h=wa(g[1]-g[0])/l[0].length*Sa/180,m=o.svg.arc().startAngle(function(){return-h/2}).endAngle(function(){return h/2}).innerRadius(function(t){return e.radialScale(c+(t[2]||0))}).outerRadius(function(t){return e.radialScale(c+(t[2]||0))+e.radialScale(t[1])});p.arc=function(){o.select(this).attr({class:"mark arc",d:m,transform:function(t){return"rotate("+(e.orientation+s(t[0])+90)+")"}})};var y={fill:function(e,a,o){return t[o].data.color},stroke:function(e,a,o){return t[o].data.strokeColor},"stroke-width":function(e,a,o){return t[o].data.strokeSize+"px"},"stroke-dasharray":function(e,a,o){return r[t[o].data.strokeDash]},opacity:function(e,a,o){return t[o].data.opacity},display:function(e,a,o){return"undefined"==typeof t[o].data.visible||t[o].data.visible?"block":"none"}},f=o.select(this).selectAll("g.layer").data(l);f.enter().append("g").attr({class:"layer"});var x=f.selectAll("path.mark").data(function(e){return e});x.enter().append("path").attr({class:"mark"}),x.style(y).each(p[e.geometryType]),x.exit().remove(),f.exit().remove()})}var t=[s.PolyChart.defaultConfig()],a=o.dispatch("hover"),r={solid:"none",dash:[5,2],dot:[2,5]},i;return e.config=function(e){return arguments.length?(e.forEach(function(e,a){t[a]||(t[a]={}),n(t[a],s.PolyChart.defaultConfig()),n(t[a],e)}),this):t},e.getColorScale=function(){return i},o.rebind(e,a,"on"),e},s.PolyChart.defaultConfig=function(){var e={data:{name:"geom1",t:[[1,2,3,4]],r:[[1,2,3,4]],dotType:"circle",dotSize:64,dotVisible:!1,barWidth:20,color:"#ffa500",strokeSize:1,strokeColor:"silver",strokeDash:"solid",opacity:1,index:0,visible:!0,visibleInLegend:!0},geometryConfig:{geometry:"LinePlot",geometryType:"arc",direction:"clockwise",orientation:0,container:"body",radialScale:null,angularScale:null,colorScale:o.scale.category20()}};return e},s.BarChart=function(){return s.PolyChart()},s.BarChart.defaultConfig=function(){return{geometryConfig:{geometryType:"bar"}}},s.AreaChart=function(){return s.PolyChart()},s.AreaChart.defaultConfig=function(){return{geometryConfig:{geometryType:"arc"}}},s.DotPlot=function(){return s.PolyChart()},s.DotPlot.defaultConfig=function(){return{geometryConfig:{geometryType:"dot",dotType:"circle"}}},s.LinePlot=function(){return s.PolyChart()},s.LinePlot.defaultConfig=function(){return{geometryConfig:{geometryType:"line"}}},s.Legend=function(){function e(){var a=t.legendConfig,r=t.data.map(function(e,t){return[].concat(e).map(function(e,o){var r=n({},a.elements[t]);return r.name=e,r.color=[].concat(a.elements[t].color)[o],r})}),l=o.merge(r);l=l.filter(function(e,t){return a.elements[t]&&(a.elements[t].visibleInLegend||"undefined"==typeof a.elements[t].visibleInLegend)}),a.reverseOrder&&(l=l.reverse());var s=a.container;("string"==typeof s||s.nodeName)&&(s=o.select(s));var c=l.map(function(e){return e.color}),p=a.fontSize,u=null==a.isContinuous?"number"==typeof l[0]:a.isContinuous,g=u?a.height:p*l.length,h=s.classed("legend-group",!0),m=h.selectAll("svg").data([0]),y=m.enter().append("svg").attr({width:300,height:g+p,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});y.append("g").classed("legend-axis",!0),y.append("g").classed("legend-marks",!0);var f=o.range(l.length),x=o.scale[u?"linear":"ordinal"]().domain(f).range(c),b=o.scale[u?"linear":"ordinal"]().domain(f)[u?"range":"rangePoints"]([0,g]),_=function(e,t){var a=3*t;return"line"===e?"M"+[[-t/2,-t/12],[t/2,-t/12],[t/2,t/12],[-t/2,t/12]]+"Z":-1==o.svg.symbolTypes.indexOf(e)?o.svg.symbol().type("square").size(a)():o.svg.symbol().type(e).size(a)()};if(u){var v=m.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(c);v.enter().append("stop"),v.attr({offset:function(e,t){return 100*(t/(c.length-1))+"%"}}).style({"stop-color":function(e){return e}}),m.append("rect").classed("legend-mark",!0).attr({height:a.height,width:a.colorBandWidth,fill:"url(#grad1)"})}else{var w=m.select(".legend-marks").selectAll("path.legend-mark").data(l);w.enter().append("path").classed("legend-mark",!0),w.attr({transform:function(e,t){return"translate("+[p/2,b(t)+p/2]+")"},d:function(e){var t=e.symbol;return _(t,p)},fill:function(e,t){return x(t)}}),w.exit().remove()}var k=o.svg.axis().scale(b).orient("right"),T=m.select("g.legend-axis").attr({transform:"translate("+[u?a.colorBandWidth:p,p/2]+")"}).call(k);return T.selectAll(".domain").style({fill:"none",stroke:"none"}),T.selectAll("line").style({fill:"none",stroke:u?a.textColor:"none"}),T.selectAll("text").style({fill:a.textColor,"font-size":a.fontSize}).text(function(e,t){return l[t].name}),e}var t=s.Legend.defaultConfig(),a=o.dispatch("hover");return e.config=function(e){return arguments.length?(n(t,e),this):t},o.rebind(e,a,"on"),e},s.Legend.defaultConfig=function(){return{data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:!1}}},s.tooltipPanel=function(){var e={container:null,hasTick:!1,fontSize:12,color:"white",padding:5},t="tooltip-"+s.tooltipPanel.uid++,a=10,r=function(){i=e.container.selectAll("g."+t).data([0]);var o=i.enter().append("g").classed(t,!0).style({"pointer-events":"none",display:"none"});return c=o.append("path").style({fill:"white","fill-opacity":.9}).attr({d:"M0 0"}),d=o.append("text").attr({dx:e.padding+a,dy:.3*+e.fontSize}),r},i,d,c;return r.text=function(t){var n=o.hsl(e.color).l,l=.5<=n?"#aaa":"white",s=.5<=n?"black":"white";d.style({fill:s,"font-size":e.fontSize+"px"}).text(t||"");var p=e.padding,u=d.node().getBBox(),g={fill:e.color,stroke:l,"stroke-width":"2px"},h=u.width+2*p+a,m=u.height+2*p;return c.attr({d:"M"+[[a,-m/2],[a,-m/4],[e.hasTick?0:a,0],[a,m/4],[a,m/2],[h,m/2],[h,-m/2]].join("L")+"Z"}).style(g),i.attr({transform:"translate("+[a,-m/2+2*p]+")"}),i.style({display:"block"}),r},r.move=function(e){if(i)return i.attr({transform:"translate("+[e[0],e[1]]+")"}).style({display:"block"}),r},r.hide=function(){if(i)return i.style({display:"none"}),r},r.show=function(){if(i)return i.style({display:"block"}),r},r.config=function(t){return n(e,t),r},r},s.tooltipPanel.uid=1,s.adapter={},s.adapter.plotly=function(){return{convert:function(e,t){var a={};if(e.data&&(a.data=e.data.map(function(e){var a=n({},e);return[[a,["marker","color"],["color"]],[a,["marker","opacity"],["opacity"]],[a,["marker","line","color"],["strokeColor"]],[a,["marker","line","dash"],["strokeDash"]],[a,["marker","line","width"],["strokeSize"]],[a,["marker","symbol"],["dotType"]],[a,["marker","size"],["dotSize"]],[a,["marker","barWidth"],["barWidth"]],[a,["line","interpolation"],["lineInterpolation"]],[a,["showlegend"],["visibleInLegend"]]].forEach(function(e){s.util.translator.apply(null,e.concat(t))}),t||delete a.marker,t&&delete a.groupId,t?("LinePlot"===a.geometry?(a.type="scatter",!0===a.dotVisible?(delete a.dotVisible,a.mode="lines+markers"):a.mode="lines"):"DotPlot"===a.geometry?(a.type="scatter",a.mode="markers"):"AreaChart"===a.geometry?a.type="area":"BarChart"===a.geometry&&(a.type="bar"),delete a.geometry):("scatter"===a.type?"lines"===a.mode?a.geometry="LinePlot":"markers"===a.mode?a.geometry="DotPlot":"lines+markers"===a.mode&&(a.geometry="LinePlot",a.dotVisible=!0):"area"===a.type?a.geometry="AreaChart":"bar"===a.type&&(a.geometry="BarChart"),delete a.mode,delete a.type),a}),!t&&e.layout&&"stack"===e.layout.barmode)){var l=s.util.duplicates(a.data.map(function(e){return e.geometry}));a.data.forEach(function(e,t){var o=l.indexOf(e.geometry);-1!=o&&(a.data[t].groupId=o)})}if(e.layout){var d=n({},e.layout),r=[[d,["plot_bgcolor"],["backgroundColor"]],[d,["showlegend"],["showLegend"]],[d,["radialaxis"],["radialAxis"]],[d,["angularaxis"],["angularAxis"]],[d.angularaxis,["showline"],["gridLinesVisible"]],[d.angularaxis,["showticklabels"],["labelsVisible"]],[d.angularaxis,["nticks"],["ticksCount"]],[d.angularaxis,["tickorientation"],["tickOrientation"]],[d.angularaxis,["ticksuffix"],["ticksSuffix"]],[d.angularaxis,["range"],["domain"]],[d.angularaxis,["endpadding"],["endPadding"]],[d.radialaxis,["showline"],["gridLinesVisible"]],[d.radialaxis,["tickorientation"],["tickOrientation"]],[d.radialaxis,["ticksuffix"],["ticksSuffix"]],[d.radialaxis,["range"],["domain"]],[d.angularAxis,["showline"],["gridLinesVisible"]],[d.angularAxis,["showticklabels"],["labelsVisible"]],[d.angularAxis,["nticks"],["ticksCount"]],[d.angularAxis,["tickorientation"],["tickOrientation"]],[d.angularAxis,["ticksuffix"],["ticksSuffix"]],[d.angularAxis,["range"],["domain"]],[d.angularAxis,["endpadding"],["endPadding"]],[d.radialAxis,["showline"],["gridLinesVisible"]],[d.radialAxis,["tickorientation"],["tickOrientation"]],[d.radialAxis,["ticksuffix"],["ticksSuffix"]],[d.radialAxis,["range"],["domain"]],[d.font,["outlinecolor"],["outlineColor"]],[d.legend,["traceorder"],["reverseOrder"]],[d,["labeloffset"],["labelOffset"]],[d,["defaultcolorrange"],["defaultColorRange"]]];if(r.forEach(function(e){s.util.translator.apply(null,e.concat(t))}),t?("undefined"!=typeof d.tickLength&&(d.angularaxis.ticklen=d.tickLength,delete d.tickLength),d.tickColor&&(d.angularaxis.tickcolor=d.tickColor,delete d.tickColor)):(d.angularAxis&&"undefined"!=typeof d.angularAxis.ticklen&&(d.tickLength=d.angularAxis.ticklen),d.angularAxis&&"undefined"!=typeof d.angularAxis.tickcolor&&(d.tickColor=d.angularAxis.tickcolor)),d.legend&&"boolean"!=typeof d.legend.reverseOrder&&(d.legend.reverseOrder="normal"!=d.legend.reverseOrder),d.legend&&"boolean"==typeof d.legend.traceorder&&(d.legend.traceorder=d.legend.traceorder?"reversed":"normal",delete d.legend.reverseOrder),d.margin&&"undefined"!=typeof d.margin.t){var i=["t","r","b","l","pad"],c=["top","right","bottom","left","pad"],p={};o.entries(d.margin).forEach(function(e){p[c[i.indexOf(e.key)]]=e.value}),d.margin=p}t&&(delete d.needsEndSpacing,delete d.minorTickColor,delete d.minorTicks,delete d.angularaxis.ticksCount,delete d.angularaxis.ticksCount,delete d.angularaxis.ticksStep,delete d.angularaxis.rewriteTicks,delete d.angularaxis.nticks,delete d.radialaxis.ticksCount,delete d.radialaxis.ticksCount,delete d.radialaxis.ticksStep,delete d.radialaxis.rewriteTicks,delete d.radialaxis.nticks),a.layout=d}return a}}}},{"../../../constants/alignment":664,"../../../lib":692,d3:148}],814:[function(e,t){"use strict";var a=e("d3"),o=e("../../../lib"),r=e("../../../components/color"),i=e("./micropolar"),n=e("./undo_manager"),l=o.extendDeepAll,s=t.exports={};s.framework=function(e){function t(t,o){return o&&(u=o),a.select(a.select(u).node().parentNode).selectAll(".svg-container>*:not(.chart-root)").remove(),r=r?l(r,t):t,c||(c=i.Axis()),p=i.adapter.plotly().convert(r),c.config(p).render(u),e.data=r.data,e.layout=r.layout,s.fillLayout(e),r}var o=new n,r,d,c,p,u;return t.isPolar=!0,t.svg=function(){return c.svg()},t.getConfig=function(){return r},t.getLiveConfig=function(){return i.adapter.plotly().convert(c.getLiveConfig(),!0)},t.getLiveScales=function(){return{t:c.angularScale(),r:c.radialScale()}},t.setUndoPoint=function(){var e=this,t=i.util.cloneJson(r);(function(t,a){o.add({undo:function(){a&&e(a)},redo:function(){e(t)}})})(t,d),d=i.util.cloneJson(t)},t.undo=function(){o.undo()},t.redo=function(){o.redo()},t},s.fillLayout=function(e){var t=a.select(e).selectAll(".plot-container"),o=t.selectAll(".svg-container"),i=e.framework&&e.framework.svg&&e.framework.svg(),n={width:800,height:600,paper_bgcolor:r.background,_container:t,_paperdiv:o,_paper:i};e._fullLayout=l(n,e.layout)}},{"../../../components/color":569,"../../../lib":692,"./micropolar":813,"./undo_manager":815,d3:148}],815:[function(e,t){"use strict";t.exports=function(){function e(e,t){return e?(o=!0,e[t](),o=!1,this):this}var t=[],a=-1,o=!1,r;return{add:function(e){return o?this:(t.splice(a+1,t.length-a),t.push(e),a=t.length-1,this)},setCallback:function(e){r=e},undo:function(){var o=t[a];return o?(e(o,"undo"),a-=1,r&&r(o.undo),this):this},redo:function(){var o=t[a+1];return o?(e(o,"redo"),a+=1,r&&r(o.redo),this):this},clear:function(){t=[],a=-1},hasUndo:function(){return-1!=a},hasRedo:function(){return a<t.length-1},getCommands:function(){return t},getPreviousCommand:function(){return t[a-1]},getIndex:function(){return a}}}},{}],816:[function(e,t){"use strict";function a(e,t){this.id=t,this.gd=e,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var a=e._fullLayout,o="clip"+a._uid+t;this.clipIds.forTraces=o+"-for-traces",this.clipPaths.forTraces=a._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=a._polarlayer.append("g").attr("class",t),this.radialTickLayout=null,this.angularTickLayout=null}function o(e){var t=e.ticks+(e.ticklen+"")+(e.showticklabels+"");return"side"in e&&(t+=e.side),t}function r(e){var t=e[0],a=e[1],o=_(t,360),r=o+(a-t),i=te(N(o)),n=M(N(o)),l=te(N(r)),s=M(N(r)),d,c,p,u;return u=90>=o&&90<=r||90<o&&450<=r?1:0>=n&&0>=s?0:va(n,s),d=180>=o&&180<=r||180<o&&540<=r?-1:0<=i&&0<=l?0:ie(i,l),c=270>=o&&270<=r||270<o&&630<=r?-1:0<=n&&0<=s?0:ie(n,s),p=360<=r?1:0>=i&&0>=l?0:va(i,l),[d,c,p,u]}function i(e,t){var a=y.findIndexOfMin(t,function(t){return y.angleDist(e,t)});return t[a]}function n(e,t,a){return t?(e.attr("display",null),e.attr(a)):e&&e.attr("display","none"),e}function l(e,t){return"translate("+e+","+t+")"}function s(e){return"rotate("+e+")"}function d(e){return 1e-10>wa(e)?0:0<e?1:-1}function c(e){return d(te(e))}function p(e){return d(M(e))}var u=e("d3"),g=e("tinycolor2"),h=e("../../registry"),y=e("../../lib"),f=e("../../components/color"),x=e("../../components/drawing"),b=e("../plots"),v=e("../../plots/cartesian/axes"),w=e("../cartesian/set_convert"),k=e("./set_convert"),T=e("../cartesian/autorange").doAutoRange,A=e("../cartesian/dragbox"),S=e("../../components/dragelement"),C=e("../../components/fx"),m=e("../../components/titles"),E=e("../cartesian/select").prepSelect,z=e("../cartesian/select").selectOnClick,I=e("../cartesian/select").clearSelect,D=e("../../lib/setcursor"),P=e("../../lib/clear_gl_canvases"),O=e("../../plot_api/subroutines").redrawReglTraces,R=e("../../constants/alignment").MID_SHIFT,j=e("./constants"),B=e("./helpers"),F=y._,_=y.mod,N=y.deg2rad,V=y.rad2deg,U=a.prototype;t.exports=function(e,t){return new a(e,t)},U.plot=function(e,t){var a=this,o=t[a.id];a._hasClipOnAxisFalse=!1;for(var r=0,n;r<e.length;r++)if(n=e[r][0].trace,!1===n.cliponaxis){a._hasClipOnAxisFalse=!0;break}a.updateLayers(t,o),a.updateLayout(t,o),b.generalUpdatePerTraceModule(a.gd,a,e,o),a.updateFx(t,o)},U.updateLayers=function(e,t){var a=this,o=a.layers,r=t.radialaxis,i=t.angularaxis,n=j.layerNames,l=n.indexOf("frontplot"),s=n.slice(0,l),d="below traces"===i.layer,c="below traces"===r.layer;d&&s.push("angular-line"),c&&s.push("radial-line"),d&&s.push("angular-axis"),c&&s.push("radial-axis"),s.push("frontplot"),d||s.push("angular-line"),c||s.push("radial-line"),d||s.push("angular-axis"),c||s.push("radial-axis");var p=a.framework.selectAll(".polarsublayer").data(s,String);p.enter().append("g").attr("class",function(e){return"polarsublayer "+e}).each(function(e){var t=o[e]=u.select(this);"frontplot"===e?(t.append("g").classed("barlayer",!0),t.append("g").classed("scatterlayer",!0)):"backplot"===e?t.append("g").classed("maplayer",!0):"plotbg"===e?o.bg=t.append("path"):"radial-grid"===e?t.style("fill","none"):"angular-grid"===e?t.style("fill","none"):"radial-line"===e?t.append("line").style("fill","none"):"angular-line"===e?t.append("path").style("fill","none"):void 0}),p.order()},U.updateLayout=function(e,t){var a=this,o=a.layers,i=e._size,n=t.radialaxis,s=t.angularaxis,d=t.domain.x,c=t.domain.y;a.xOffset=i.l+i.w*d[0],a.yOffset=i.t+i.h*(1-c[1]);var p=a.xLength=i.w*(d[1]-d[0]),u=a.yLength=i.h*(c[1]-c[0]),g=t.sector;a.sectorInRad=g.map(N);var h=a.sectorBBox=r(g),m=h[2]-h[0],y=h[3]-h[1],b=wa(y/m),_,v,w,k,T;u/p>b?(_=p,v=p*b,T=(u-v)/i.h/2,w=[d[0],d[1]],k=[c[0]+T,c[1]-T]):(_=u/b,v=u,T=(p-_)/i.w/2,w=[d[0]+T,d[1]-T],k=[c[0],c[1]]),a.xLength2=_,a.yLength2=v,a.xDomain2=w,a.yDomain2=k;var A=a.xOffset2=i.l+i.w*w[0],S=a.yOffset2=i.t+i.h*(1-k[1]),C=a.radius=_/m,L=a.innerRadius=t.hole*C,E=a.cx=A-C*h[0],z=a.cy=S+C*h[3],I=a.cxx=E-A,D=a.cyy=z-S;a.radialAxis=a.mockAxis(e,t,n,{_id:"x",side:{counterclockwise:"top",clockwise:"bottom"}[n.side],domain:[L/i.w,C/i.w]}),a.angularAxis=a.mockAxis(e,t,s,{side:"right",domain:[0,Sa],autorange:!1}),a.doAutoRange(e,t),a.updateAngularAxis(e,t),a.updateRadialAxis(e,t),a.updateRadialAxisTitle(e,t),a.xaxis=a.mockCartesianAxis(e,t,{_id:"x",domain:w}),a.yaxis=a.mockCartesianAxis(e,t,{_id:"y",domain:k});var P=a.pathSubplot();a.clipPaths.forTraces.select("path").attr("d",P).attr("transform",l(I,D)),o.frontplot.attr("transform",l(A,S)).call(x.setClipUrl,a._hasClipOnAxisFalse?null:a.clipIds.forTraces,a.gd),o.bg.attr("d",P).attr("transform",l(E,z)).call(f.fill,t.bgcolor)},U.mockAxis=function(e,t,a,o){var r=y.extendFlat({anchor:"free",position:0},a,o);return k(r,t,e),r},U.mockCartesianAxis=function(e,t,a){var o=this,r=a._id,i=y.extendFlat({type:"linear"},a);w(i,e);var n={x:[0,2],y:[1,3]};return i.setRange=function(){var e=o.sectorBBox,a=n[r],l=o.radialAxis._rl,s=(l[1]-l[0])/(1-t.hole);i.range=[e[a[0]]*s,e[a[1]]*s]},i.isPtWithinRange="x"===r?function(e){return o.isPtInside(e)}:function(){return!0},i.setRange(),i.setScale(),i},U.doAutoRange=function(e,t){var a=this.gd,o=this.radialAxis,r=t.radialaxis;o.setScale(),T(a,o);var i=o.range;r.range=i.slice(),r._input.range=i.slice(),o._rl=[o.r2l(i[0],null,"gregorian"),o.r2l(i[1],null,"gregorian")]},U.updateRadialAxis=function(e,t){var a=this,r=a.gd,d=a.layers,c=a.radius,p=a.innerRadius,u=a.cx,g=a.cy,h=t.radialaxis,m=_(t.sector[0],360),x=a.radialAxis,b=p<c;a.fillViewInitialKey("radialaxis.angle",h.angle),a.fillViewInitialKey("radialaxis.range",x.range.slice()),x.setGeometry(),"auto"===x.tickangle&&90<m&&270>=m&&(x.tickangle=180);var w=function(e){return"translate("+(x.l2p(e.x)+p)+",0)"},k=function(e){return a.pathArc(x.r2p(e.x)+p)},T=o(h);if(a.radialTickLayout!==T&&(d["radial-axis"].selectAll(".xtick").remove(),a.radialTickLayout=T),b){x.setScale();var A=v.calcTicks(x),S=v.clipEnds(x,A),C=v.makeLabelFns(x,0),L=v.getTickSigns(x)[2];v.drawTicks(r,x,{vals:A,layer:d["radial-axis"],path:v.makeTickPath(x,0,L),transFn:w,crisp:!1}),v.drawGrid(r,x,{vals:S,layer:d["radial-grid"],path:k,transFn:y.noop,crisp:!1}),v.drawLabels(r,x,{vals:A,layer:d["radial-axis"],transFn:w,labelXFn:C.labelXFn,labelYFn:C.labelYFn,labelAnchorFn:C.labelAnchorFn})}var E=a.radialAxisAngle=a.vangles?V(i(N(h.angle),a.vangles)):h.angle,z=l(u,g),I=z+s(-E);n(d["radial-axis"],b&&(h.showticklabels||h.ticks),{transform:I}),n(d["radial-grid"],b&&h.showgrid,{transform:z}),n(d["radial-line"].select("line"),b&&h.showline,{x1:p,y1:0,x2:c,y2:0,transform:I}).attr("stroke-width",h.linewidth).call(f.stroke,h.linecolor)},U.updateRadialAxisTitle=function(e,t,a){var o=this,r=o.gd,i=o.radius,n=o.cx,l=o.cy,s=t.radialaxis,d=o.id+"title",c=a===void 0?o.radialAxisAngle:a,p=N(c),u=te(p),g=M(p),y=0;if(s.title){var f=x.bBox(o.layers["radial-axis"].node()).height,h=s.title.font.size;y="counterclockwise"===s.side?-f-.4*h:f+.8*h}o.layers["radial-axis-title"]=m.draw(r,d,{propContainer:s,propName:o.id+".radialaxis.title",placeholder:F(r,"Click to enter radial axis title"),attributes:{x:n+i/2*u+y*g,y:l-i/2*g+y*u,"text-anchor":"middle"},transform:{rotate:-c}})},U.updateAngularAxis=function(e,t){var a=this,r=a.gd,i=a.layers,u=a.radius,g=a.innerRadius,h=a.cx,m=a.cy,d=t.angularaxis,x=a.angularAxis;a.fillViewInitialKey("angularaxis.rotation",d.rotation),x.setGeometry(),x.setScale();var b=function(e){return x.t2g(e.x)};"linear"===x.type&&"radians"===x.thetaunit&&(x.tick0=V(x.tick0),x.dtick=V(x.dtick));var _=function(e){return l(h+u*te(e),m-u*M(e))},w=function(e){return _(b(e))},k=function(e){var t=b(e);return _(t)+s(-V(t))},T=function(e){var t=b(e),a=te(t),o=M(t);return"M"+[h+g*a,m-g*o]+"L"+[h+u*a,m-u*o]},A=v.makeLabelFns(x,0),S=A.labelStandoff,C=A.labelShift,L="outside"===d.ticks?.5:.7,E=(x.linewidth||1)/2,z=function(e){var t=b(e),a=0===p(t)?0:te(t)*(S+E+L*e.fontSize),o=c(t)*(e.dx+S+E);return a+o},I=function(e){var t=b(e),a=e.dy+e.fontSize*R-C,o=-M(t)*(S+E+L*e.fontSize);return a+o},D=function(e,t){var a=b(t);return 0===p(a)?0<c(a)?"start":"end":"middle"},P=o(d);a.angularTickLayout!==P&&(i["angular-axis"].selectAll("."+x._id+"tick").remove(),a.angularTickLayout=P);var O=v.calcTicks(x),j;if("linear"===t.gridshape?(j=O.map(b),0>y.angleDelta(j[0],j[1])&&(j=j.slice().reverse())):j=null,a.vangles=j,"category"===x.type&&(O=O.filter(function(e){return y.isAngleInsideSector(b(e),a.sectorInRad)})),x.visible){var B="inside"===x.ticks?-1:1;v.drawTicks(r,x,{vals:O,layer:i["angular-axis"],path:"M"+B*E+",0h"+B*x.ticklen,transFn:k,crisp:!1}),v.drawGrid(r,x,{vals:O,layer:i["angular-grid"],path:T,transFn:y.noop,crisp:!1}),v.drawLabels(r,x,{vals:O,layer:i["angular-axis"],repositionOnUpdate:!0,transFn:w,labelXFn:z,labelYFn:I,labelAnchorFn:D})}n(i["angular-line"].select("path"),d.showline,{d:a.pathSubplot(),transform:l(h,m)}).attr("stroke-width",d.linewidth).call(f.stroke,d.linecolor)},U.updateFx=function(e,t){this.gd._context.staticPlot||(this.updateAngularDrag(e),this.updateRadialDrag(e,t,0),this.updateRadialDrag(e,t,1),this.updateMainDrag(e))},U.updateMainDrag=function(e){function t(e,t){return re(e*e+t*t)}function a(e,a){return t(e-F,a-N)}function o(e,t){return L(N-t,e-F)}function i(e,t){return[e*te(t),e*M(-t)]}function n(e,t){if(0===e)return _.pathSector(2*W);var a=X/e,o=t-a,r=t+a,n=va(0,ie(e,D)),l=n-W,s=n+W;return"M"+i(l,o)+"A"+[l,l]+" 0,0,0 "+i(l,r)+"L"+i(s,r)+"A"+[s,s]+" 0,0,1 "+i(s,o)+"Z"}function s(e,t,a){if(0===e)return _.pathSector(2*W);var o=i(e,t),r=i(e,a),n=G((o[0]+r[0])/2),l=G((o[1]+r[1])/2),s,d;if(n&&l){var c=l/n,p=-1/c,u=Y(W,c,n,l);s=Y(X,p,u[0][0],u[0][1]),d=Y(X,p,u[1][0],u[1][1])}else{var g,h;l?(g=X,h=W):(g=W,h=X),s=[[n-g,l-h],[n+g,l-h]],d=[[n-g,l+h],[n+g,l+h]]}return"M"+s.join("L")+"L"+d.reverse().join("L")+"Z"}function d(){Q=null,ee=null,ae=_.pathSubplot(),oe=!1;var e=v._fullLayout[_.id];ne=g(e.bgcolor).getLuminance(),le=A.makeZoombox(w,ne,O,R,ae),le.attr("fill-rule","evenodd"),se=A.makeCorners(w,O,R),I(w)}function c(e,t){return t=va(ie(t,D),P),e<T?e=0:D-e<T?e=D:t<T?t=0:D-t<T&&(t=D),wa(t-e)>k?(e<t?(Q=e,ee=t):(Q=t,ee=e),!0):(Q=null,ee=null,!1)}function p(e,t){e=e||ae,t=t||"M0,0Z",le.attr("d",e),se.attr("d",t),A.transitionZoombox(le,se,oe,ne),oe=!0}function m(e,t){var r=J+e,i=K+t,l=a(J,K),s=ie(a(r,i),D),d=o(J,K),u,g;c(l,s)&&(u=ae+_.pathSector(ee),Q&&(u+=_.pathSector(Q)),g=n(Q,d)+n(ee,d)),p(u,g)}function y(e,a,o,r){var i=B.findIntersectionXY(o,r,o,[e-F,N-a]);return t(i[0],i[1])}function f(e,t){var a=J+e,r=K+t,i=o(J,K),n=o(a,r),l=q(i,U),d=q(n,U),u=y(J,K,l[0],l[1]),g=ie(y(a,r,d[0],d[1]),D),h,m;c(u,g)&&(h=ae+_.pathSector(ee),Q&&(h+=_.pathSector(Q)),m=[s(Q,l[0],l[1]),s(ee,l[0],l[1])].join(" ")),p(h,m)}function x(){if(A.removeZoombox(v),null!==Q&&null!==ee){A.showDoubleClickNotifier(v);var e=H._rl,t=(e[1]-e[0])/(1-P/D)/D,a=[e[0]+(Q-P)*t,e[0]+(ee-P)*t];h.call("_guiRelayout",v,_.id+".radialaxis.range",a)}}function b(e,t){var a=v._fullLayout.clickmode;if(A.removeZoombox(v),2===e){var o={};for(var r in _.viewInitial)o[_.id+"."+r]=_.viewInitial[r];v.emit("plotly_doubleclick",null),h.call("_guiRelayout",v,o)}-1<a.indexOf("select")&&1===e&&z(t,v,[_.xaxis],[_.yaxis],_.id,$),-1<a.indexOf("event")&&C.click(v,t,_.id)}var _=this,v=_.gd,r=_.layers,w=e._zoomlayer,k=j.MINZOOM,T=j.OFFEDGE,D=_.radius,P=_.innerRadius,O=_.cx,R=_.cy,F=_.cxx,N=_.cyy,V=_.sectorInRad,U=_.vangles,H=_.radialAxis,G=B.clampTiny,Y=B.findXYatLength,q=B.findEnclosingVertexAngles,W=j.cornerHalfWidth,X=j.cornerLen/2,Z=A.makeDragger(r,"path","maindrag","crosshair");u.select(Z).attr("d",_.pathSubplot()).attr("transform",l(O,R));var $={element:Z,gd:v,subplot:_.id,plotinfo:{id:_.id,xaxis:_.xaxis,yaxis:_.yaxis},xaxes:[_.xaxis],yaxes:[_.yaxis]},J,K,Q,ee,ae,oe,ne,le,se;$.prepFn=function(e,t,a){var o=v._fullLayout.dragmode,r=Z.getBoundingClientRect();if(J=t-r.left,K=a-r.top,U){var i=B.findPolygonOffset(D,V[0],V[1],U);J+=F+i[0],K+=N+i[1]}"zoom"===o?($.moveFn=U?f:m,$.clickFn=b,$.doneFn=x,d(e,t,a)):"select"===o||"lasso"===o?E(e,t,a,$,o):void 0},Z.onmousemove=function(e){C.hover(v,e,_.id),v._fullLayout._lasthover=Z,v._fullLayout._hoversubplot=_.id},Z.onmouseout=function(e){v._dragging||S.unhover(v,e)},S.init($)},U.updateRadialDrag=function(e,t,a){function o(e,t){if(Y)Y(e,t);else{var a=[e,-t],o=[te(C),M(C)],r=wa(y.dot(a,o)/re(y.dot(a,a)));isNaN(r)||(Y=.5>r?d:c)}}function r(){null===q?null!==W&&h.call("_guiRelayout",g,p.id+".radialaxis.range["+a+"]",W):h.call("_guiRelayout",g,p.id+".radialaxis.angle",q)}function d(e,t){if(0!==a){var o=m+e,r=F+t;q=L(v-r,o-_),p.vangles&&(q=i(q,p.vangles)),q=V(q);var n=l(_,v)+s(-q);f["radial-axis"].attr("transform",n),f["radial-line"].select("line").attr("transform",n);var d=p.gd._fullLayout,c=d[p.id];p.updateRadialAxisTitle(d,c,q)}}function c(e,t){var o=y.dot([e,-t],[te(C),M(C)]);if(W=R-B*o,0<B!=(a?W>z:W<D))return void(W=null);var r=g._fullLayout,i=r[p.id];w.range[a]=W,w._rl[a]=W,p.updateRadialAxis(r,i),p.xaxis.setRange(),p.xaxis.setScale(),p.yaxis.setRange(),p.yaxis.setScale();var n=!1;for(var l in p.traceHash){var s=p.traceHash[l],d=y.filterVisible(s),c=s[0][0].trace._module;c.plot(g,p,d,i),h.traceIs(l,"gl")&&d.length&&(n=!0)}n&&(P(g),O(g))}var p=this,g=p.gd,f=p.layers,x=p.radius,b=p.innerRadius,_=p.cx,v=p.cy,w=p.radialAxis,k=j.radialDragBoxSize,T=k/2;if(w.visible){var C=N(p.radialAxisAngle),E=w._rl,z=E[0],D=E[1],R=E[a],B=.75*(E[1]-E[0])/(1-t.hole)/x,m,F,U;a?(m=_+(x+T)*te(C),F=v-(x+T)*M(C),U="radialdrag"):(m=_+(b-T)*te(C),F=v-(b-T)*M(C),U="radialdrag-inner");var H=A.makeRectDragger(f,U,"crosshair",-T,-T,k,k),G={element:H,gd:g};n(u.select(H),w.visible&&b<x,{transform:l(m,F)});var Y,q,W;G.prepFn=function(){Y=null,q=null,W=null,G.moveFn=o,G.doneFn=r,I(e._zoomlayer)},G.clampFn=function(e,t){return re(e*e+t*t)<j.MINDRAG&&(e=0,t=0),[e,t]},S.init(G)}},U.updateAngularDrag=function(e){function t(e,t){return L(f+b-t,e-m-b)}function a(e,a){var o=r.gd._fullLayout,d=o[r.id],b=C+e,_=E+a,v=t(b,_),A=V(v-B);if(R=z+A,n.frontplot.attr("transform",l(r.xOffset2,r.yOffset2)+s([-A,m,f])),r.vangles){M=r.radialAxisAngle+A;var S=l(p,g)+s(-A),L=l(p,g)+s(-M);n.bg.attr("transform",S),n["radial-grid"].attr("transform",S),n["radial-axis"].attr("transform",L),n["radial-line"].select("line").attr("transform",L),r.updateRadialAxisTitle(o,d,M)}else r.clipPaths.forTraces.select("path").attr("transform",l(m,f)+s(A));k.each(function(){var e=u.select(this),t=x.getTranslate(e);e.attr("transform",l(t.x,t.y)+s([A]))}),T.each(function(){var e=u.select(this),t=e.select("text"),a=x.getTranslate(e);e.attr("transform",s([A,t.attr("x"),t.attr("y")])+l(a.x,a.y))}),c.rotation=y.modHalf(R,360),r.updateAngularAxis(o,d),r._hasClipOnAxisFalse&&!y.isFullCircle(r.sectorInRad)&&w.call(x.hideOutsideRangePoints,r);var I=!1;for(var D in r.traceHash)if(h.traceIs(D,"gl")){var j=r.traceHash[D],F=y.filterVisible(j),N=j[0][0].trace._module;N.plot(i,r,F,d),F.length&&(I=!0)}I&&(P(i),O(i))}function o(){T.select("text").attr("transform",null);var e={};e[r.id+".angularaxis.rotation"]=R,r.vangles&&(e[r.id+".radialaxis.angle"]=M),h.call("_guiRelayout",i,e)}var r=this,i=r.gd,n=r.layers,d=r.radius,c=r.angularAxis,p=r.cx,g=r.cy,m=r.cxx,f=r.cyy,b=j.angularDragBoxSize,_=A.makeDragger(n,"path","angulardrag","move"),v={element:_,gd:i};u.select(_).attr("d",r.pathAnnulus(d,d+b)).attr("transform",l(p,g)).call(D,"move");var w=n.frontplot.select(".scatterlayer").selectAll(".trace"),k=w.selectAll(".point"),T=w.selectAll(".textpoint"),C,E,z,R,M,B;v.prepFn=function(i,n,l){var s=e[r.id];z=s.angularaxis.rotation;var d=_.getBoundingClientRect();C=n-d.left,E=l-d.top,B=t(C,E),v.moveFn=a,v.doneFn=o,I(e._zoomlayer)},r.vangles&&!y.isFullCircle(r.sectorInRad)&&(v.prepFn=y.noop,D(u.select(_),null)),S.init(v)},U.isPtInside=function(e){var t=this.sectorInRad,a=this.vangles,o=this.angularAxis.c2g(e.theta),i=this.radialAxis,n=i.c2l(e.r),r=i._rl,l=a?B.isPtInsidePolygon:y.isPtInsideSector;return l(n,o,r,t,a)},U.pathArc=function(e){var t=this.sectorInRad,a=this.vangles,o=a?B.pathPolygon:y.pathArc;return o(e,t[0],t[1],a)},U.pathSector=function(e){var t=this.sectorInRad,a=this.vangles,o=a?B.pathPolygon:y.pathSector;return o(e,t[0],t[1],a)},U.pathAnnulus=function(e,t){var a=this.sectorInRad,o=this.vangles,r=o?B.pathPolygonAnnulus:y.pathAnnulus;return r(e,t,a[0],a[1],o)},U.pathSubplot=function(){var e=this.innerRadius,t=this.radius;return e?this.pathAnnulus(e,t):this.pathSector(t)},U.fillViewInitialKey=function(e,t){e in this.viewInitial||(this.viewInitial[e]=t)}},{"../../components/color":569,"../../components/dragelement":587,"../../components/drawing":590,"../../components/fx":608,"../../components/titles":657,"../../constants/alignment":664,"../../lib":692,"../../lib/clear_gl_canvases":677,"../../lib/setcursor":712,"../../plot_api/subroutines":731,"../../plots/cartesian/axes":740,"../../registry":823,"../cartesian/autorange":739,"../cartesian/dragbox":749,"../cartesian/select":758,"../cartesian/set_convert":759,"../plots":804,"./constants":805,"./helpers":806,"./set_convert":817,d3:148,tinycolor2:513}],817:[function(e,t){"use strict";function a(e,t){var a=t._subplot;e.setGeometry=function(){var t=e._rl[0],o=e._rl[1],r=a.innerRadius,i=(a.radius-r)/(o-t),n=r/i,l=t>o?function(e){return 0>=e}:function(e){return 0<=e};e.c2g=function(a){var o=e.c2l(a)-t;return(l(o)?o:0)+n},e.g2c=function(a){return e.l2c(a+t-n)},e.g2p=function(e){return e*i},e.c2p=function(t){return e.g2p(e.c2g(t))}}}function o(e,t){return"degrees"===t?s(e):e}function r(e,t){return"degrees"===t?d(e):e}function i(e,t){var a=e.type;if("linear"===a){var i=e.d2c,l=e.c2d;e.d2c=function(e,t){return o(i(e),t)},e.c2d=function(e,t){return l(r(e,t))}}e.makeCalcdata=function(t,o){var r=t[o],l=t._length,s=function(a){return e.d2c(a,t.thetaunit)},d,c;if(r){if(n.isTypedArray(r)&&"linear"===a){if(l===r.length)return r;if(r.subarray)return r.subarray(0,l)}for(d=Array(l),c=0;c<l;c++)d[c]=s(r[c])}else{var p=o+"0",u="d"+o,g=p in t?s(t[p]):0,h=t[u]?s(t[u]):(e.period||2*Sa)/l;for(d=Array(l),c=0;c<l;c++)d[c]=g+c*h}return d},e.setGeometry=function(){var o=t.sector,r=o.map(s),i={clockwise:-1,counterclockwise:1}[e.direction],l=s(e.rotation),c=function(e){return i*e+l},p=function(e){return(e-l)/i},u,g,h,m;switch(a){case"linear":g=u=n.identity,m=s,h=d,e.range=n.isFullCircle(r)?[o[0],o[0]+360]:r.map(p).map(d);break;case"category":var y=e._categories.length,f=e.period?va(e.period,y):y;g=m=function(e){return 2*e*Sa/f},u=h=function(e){return e*f/Sa/2},e.range=[0,f];}e.c2g=function(e){return c(g(e))},e.g2c=function(e){return u(p(e))},e.t2g=function(e){return c(m(e))},e.g2t=function(e){return h(p(e))}}}var n=e("../../lib"),l=e("../cartesian/set_convert"),s=n.deg2rad,d=n.rad2deg;t.exports=function(e,t,o){switch(l(e,o),e._id){case"x":case"radialaxis":a(e,t);break;case"angularaxis":i(e,t);}}},{"../../lib":692,"../cartesian/set_convert":759}],818:[function(e,t){"use strict";var a=e("../lib"),o=e("../plot_api/plot_template"),r=e("./domain").defaults;t.exports=function(e,t,n,l){function s(e,t){return a.coerce(f,x,c,e,t)}for(var d=l.type,c=l.attributes,p=l.handleDefaults,u=l.partition||"x",g=t._subplots[d],h=g.length,m=h&&g[0].replace(/\d+$/,""),y=0,f,x,b;y<h;y++){b=g[y],f=e[b]?e[b]:e[b]={},x=o.newContainer(t,b,m),s("uirevision",t.uirevision);var _={};_[u]=[y/h,(y+1)/h],r(x,t,s,_),l.id=b,p(f,x,s,l)}}},{"../lib":692,"../plot_api/plot_template":730,"./domain":766}],819:[function(e,t,a){"use strict";var o=e("./ternary"),r=e("../../plots/get_data").getSubplotCalcData,i=e("../../lib").counterRegex,n="ternary";a.name=n;var l=a.attr="subplot";a.idRoot=n,a.idRegex=a.attrRegex=i(n);var s=a.attributes={};s[l]={valType:"subplotid",dflt:"ternary",editType:"calc"},a.layoutAttributes=e("./layout_attributes"),a.supplyLayoutDefaults=e("./layout_defaults"),a.plot=function(e){for(var t=e._fullLayout,a=e.calcdata,l=t._subplots[n],s=0;s<l.length;s++){var d=l[s],c=r(a,n,d),p=t[d]._subplot;p||(p=new o({id:d,graphDiv:e,container:t._ternarylayer.node()},t),t[d]._subplot=p),p.plot(c,t,e._promises)}},a.clean=function(e,t,a,o){for(var r=o._subplots[n]||[],l=0;l<r.length;l++){var s=r[l],d=o[s]._subplot;t[s]||!d||(d.plotContainer.remove(),d.clipDef.remove(),d.clipDefRelative.remove(),d.layers["a-title"].remove(),d.layers["b-title"].remove(),d.layers["c-title"].remove())}}},{"../../lib":692,"../../plots/get_data":777,"./layout_attributes":820,"./layout_defaults":821,"./ternary":822}],820:[function(e,t){"use strict";var a=e("../../components/color/attributes"),o=e("../domain").attributes,r=e("../cartesian/layout_attributes"),i=e("../../plot_api/edit_types").overrideAll,n=e("../../lib/extend").extendFlat,l={title:r.title,color:r.color,tickmode:r.tickmode,nticks:n({},r.nticks,{dflt:6,min:1}),tick0:r.tick0,dtick:r.dtick,tickvals:r.tickvals,ticktext:r.ticktext,ticks:r.ticks,ticklen:r.ticklen,tickwidth:r.tickwidth,tickcolor:r.tickcolor,showticklabels:r.showticklabels,showtickprefix:r.showtickprefix,tickprefix:r.tickprefix,showticksuffix:r.showticksuffix,ticksuffix:r.ticksuffix,showexponent:r.showexponent,exponentformat:r.exponentformat,separatethousands:r.separatethousands,tickfont:r.tickfont,tickangle:r.tickangle,tickformat:r.tickformat,tickformatstops:r.tickformatstops,hoverformat:r.hoverformat,showline:n({},r.showline,{dflt:!0}),linecolor:r.linecolor,linewidth:r.linewidth,showgrid:n({},r.showgrid,{dflt:!0}),gridcolor:r.gridcolor,gridwidth:r.gridwidth,layer:r.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:r._deprecated.title,titlefont:r._deprecated.titlefont}},s=t.exports=i({domain:o({name:"ternary"}),bgcolor:{valType:"color",dflt:a.background},sum:{valType:"number",dflt:1,min:0},aaxis:l,baxis:l,caxis:l},"plot","from-root");s.uirevision={valType:"any",editType:"none"},s.aaxis.uirevision=s.baxis.uirevision=s.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":568,"../../lib/extend":682,"../../plot_api/edit_types":723,"../cartesian/layout_attributes":753,"../domain":766}],821:[function(e,t){"use strict";function a(e,t,a,n){var l=a("bgcolor"),s=a("sum");n.bgColor=r.combine(l,n.paper_bgcolor);for(var d=0,c,p,u;d<g.length;d++)c=g[d],p=e[c]||{},u=i.newContainer(t,c),u._name=c,o(p,u,n,t);var h=t.aaxis,m=t.baxis,y=t.caxis;h.min+m.min+y.min>=s&&(h.min=0,m.min=0,y.min=0,e.aaxis&&delete e.aaxis.min,e.baxis&&delete e.baxis.min,e.caxis&&delete e.caxis.min)}function o(e,t,a,o){function r(a,o){return n.coerce(e,t,i,a,o)}var i=u[t._name];r("uirevision",o.uirevision),t.type="linear";var l=r("color"),g=l===i.color.dflt?a.font.color:l,h=t._name,m=h.charAt(0).toUpperCase(),y="Component "+m,f=r("title.text",y);t._hovertitle=f===y?f:m,n.coerceFont(r,"title.font",{family:a.font.family,size:R(1.2*a.font.size),color:g}),r("min"),c(e,t,r,"linear"),s(e,t,r,"linear",{}),d(e,t,r,{outerTicks:!0});var x=r("showticklabels");x&&(n.coerceFont(r,"tickfont",{family:a.font.family,size:a.font.size,color:g}),r("tickangle"),r("tickformat")),p(e,t,r,{dfltColor:l,bgColor:a.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:i}),r("hoverformat"),r("layer")}var r=e("../../components/color"),i=e("../../plot_api/plot_template"),n=e("../../lib"),l=e("../subplot_defaults"),s=e("../cartesian/tick_label_defaults"),d=e("../cartesian/tick_mark_defaults"),c=e("../cartesian/tick_value_defaults"),p=e("../cartesian/line_grid_defaults"),u=e("./layout_attributes"),g=["aaxis","baxis","caxis"];t.exports=function(e,t,o){l(e,t,o,{type:"ternary",attributes:u,handleDefaults:a,font:t.font,paper_bgcolor:t.paper_bgcolor})}},{"../../components/color":569,"../../lib":692,"../../plot_api/plot_template":730,"../cartesian/line_grid_defaults":755,"../cartesian/tick_label_defaults":760,"../cartesian/tick_mark_defaults":761,"../cartesian/tick_value_defaults":762,"../subplot_defaults":818,"./layout_attributes":820}],822:[function(e,t){"use strict";function a(e,t){this.id=e.id,this.graphDiv=e.graphDiv,this.init(t),this.makeFramework(t),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}function o(e){return e.ticks+(e.ticklen+"")+(e.showticklabels+"")}function r(e){i.select(e).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}var i=e("d3"),n=e("tinycolor2"),l=e("../../registry"),s=e("../../lib"),d=s._,c=e("../../components/color"),p=e("../../components/drawing"),u=e("../cartesian/set_convert"),g=e("../../lib/extend").extendFlat,h=e("../plots"),m=e("../cartesian/axes"),y=e("../../components/dragelement"),f=e("../../components/fx"),x=e("../../components/titles"),b=e("../cartesian/select").prepSelect,_=e("../cartesian/select").selectOnClick,v=e("../cartesian/select").clearSelect,w=e("../cartesian/constants");t.exports=a;var k=a.prototype;k.init=function(e){this.container=e._ternarylayer,this.defs=e._defs,this.layoutId=e._uid,this.traceHash={},this.layers={}},k.plot=function(e,t){var a=this,o=t[a.id],r=t._size;a._hasClipOnAxisFalse=!1;for(var n=0,l;n<e.length;n++)if(l=e[n][0].trace,!1===l.cliponaxis){a._hasClipOnAxisFalse=!0;break}a.updateLayers(o),a.adjustLayout(o,r),h.generalUpdatePerTraceModule(a.graphDiv,a,e,o),a.layers.plotbg.select("path").call(c.fill,o.bgcolor)},k.makeFramework=function(e){var t=this,a=t.graphDiv,o=e[t.id],r=t.clipId="clip"+t.layoutId+t.id,i=t.clipIdRelative="clip-relative"+t.layoutId+t.id;t.clipDef=s.ensureSingleById(e._clips,"clipPath",r,function(e){e.append("path").attr("d","M0,0Z")}),t.clipDefRelative=s.ensureSingleById(e._clips,"clipPath",i,function(e){e.append("path").attr("d","M0,0Z")}),t.plotContainer=s.ensureSingle(t.container,"g",t.id),t.updateLayers(o),p.setClipUrl(t.layers.backplot,r,a),p.setClipUrl(t.layers.grids,r,a)},k.updateLayers=function(e){var t=this,a=t.layers,o=["draglayer","plotbg","backplot","grids"];"below traces"===e.aaxis.layer&&o.push("aaxis","aline"),"below traces"===e.baxis.layer&&o.push("baxis","bline"),"below traces"===e.caxis.layer&&o.push("caxis","cline"),o.push("frontplot"),"above traces"===e.aaxis.layer&&o.push("aaxis","aline"),"above traces"===e.baxis.layer&&o.push("baxis","bline"),"above traces"===e.caxis.layer&&o.push("caxis","cline");var r=t.plotContainer.selectAll("g.toplevel").data(o,String),n=["agrid","bgrid","cgrid"];r.enter().append("g").attr("class",function(e){return"toplevel "+e}).each(function(e){var t=i.select(this);a[e]=t,"frontplot"===e?t.append("g").classed("scatterlayer",!0):"backplot"===e?t.append("g").classed("maplayer",!0):"plotbg"===e?t.append("path").attr("d","M0,0Z"):"aline"===e||"bline"===e||"cline"===e?t.append("path"):"grids"===e&&n.forEach(function(e){a[e]=t.append("g").classed("grid "+e,!0)})}),r.order()};var T=re(4/3);k.adjustLayout=function(e,t){var a=this,o=e.domain,r=(o.x[0]+o.x[1])/2,i=(o.y[0]+o.y[1])/2,n=o.x[1]-o.x[0],l=o.y[1]-o.y[0],s=n*t.w,d=l*t.h,m=e.sum,y=e.aaxis.min,f=e.baxis.min,x=e.caxis.min,b,_,v,k,A,S;s>T*d?(k=d,v=k*T):(v=s,k=v/T),A=n*v/s,S=l*k/d,b=t.l+t.w*r-v/2,_=t.t+t.h*(1-i)-k/2,a.x0=b,a.y0=_,a.w=v,a.h=k,a.sum=m,a.xaxis={type:"linear",range:[y+2*x-m,m-y-2*f],domain:[r-A/2,r+A/2],_id:"x"},u(a.xaxis,a.graphDiv._fullLayout),a.xaxis.setScale(),a.xaxis.isPtWithinRange=function(e){return e.a>=a.aaxis.range[0]&&e.a<=a.aaxis.range[1]&&e.b>=a.baxis.range[1]&&e.b<=a.baxis.range[0]&&e.c>=a.caxis.range[1]&&e.c<=a.caxis.range[0]},a.yaxis={type:"linear",range:[y,m-f-x],domain:[i-S/2,i+S/2],_id:"y"},u(a.yaxis,a.graphDiv._fullLayout),a.yaxis.setScale(),a.yaxis.isPtWithinRange=function(){return!0};var C=a.yaxis.domain[0],L=a.aaxis=g({},e.aaxis,{range:[y,m-f-x],side:"left",tickangle:(+e.aaxis.tickangle||0)-30,domain:[C,C+S*T],anchor:"free",position:0,_id:"y",_length:v});u(L,a.graphDiv._fullLayout),L.setScale();var E=a.baxis=g({},e.baxis,{range:[m-y-x,f],side:"bottom",domain:a.xaxis.domain,anchor:"free",position:0,_id:"x",_length:v});u(E,a.graphDiv._fullLayout),E.setScale();var z=a.caxis=g({},e.caxis,{range:[m-y-f,x],side:"right",tickangle:(+e.caxis.tickangle||0)+30,domain:[C,C+S*T],anchor:"free",position:0,_id:"y",_length:v});u(z,a.graphDiv._fullLayout),z.setScale();var I="M"+b+","+(_+k)+"h"+v+"l-"+v/2+",-"+k+"Z";a.clipDef.select("path").attr("d",I),a.layers.plotbg.select("path").attr("d",I);var D="M0,"+k+"h"+v+"l-"+v/2+",-"+k+"Z";a.clipDefRelative.select("path").attr("d",D);var P="translate("+b+","+_+")";a.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",P),a.clipDefRelative.select("path").attr("transform",null);var O="translate("+(b-E._offset)+","+(_+k)+")";a.layers.baxis.attr("transform",O),a.layers.bgrid.attr("transform",O);var R="translate("+(b+v/2)+","+_+")rotate(30)translate(0,"+-L._offset+")";a.layers.aaxis.attr("transform",R),a.layers.agrid.attr("transform",R);var M="translate("+(b+v/2)+","+_+")rotate(-30)translate(0,"+-z._offset+")";a.layers.caxis.attr("transform",M),a.layers.cgrid.attr("transform",M),a.drawAxes(!0),a.layers.aline.select("path").attr("d",L.showline?"M"+b+","+(_+k)+"l"+v/2+",-"+k:"M0,0").call(c.stroke,L.linecolor||"#000").style("stroke-width",(L.linewidth||0)+"px"),a.layers.bline.select("path").attr("d",E.showline?"M"+b+","+(_+k)+"h"+v:"M0,0").call(c.stroke,E.linecolor||"#000").style("stroke-width",(E.linewidth||0)+"px"),a.layers.cline.select("path").attr("d",z.showline?"M"+(b+v/2)+","+_+"l"+v/2+","+k:"M0,0").call(c.stroke,z.linecolor||"#000").style("stroke-width",(z.linewidth||0)+"px"),a.graphDiv._context.staticPlot||a.initInteractions(),p.setClipUrl(a.layers.frontplot,a._hasClipOnAxisFalse?null:a.clipId,a.graphDiv)},k.drawAxes=function(e){var t=this,a=t.graphDiv,o=t.id.substr(7)+"title",r=t.layers,i=t.aaxis,n=t.baxis,l=t.caxis;if(t.drawAx(i),t.drawAx(n),t.drawAx(l),e){var s=va(i.showticklabels?i.tickfont.size/2:0,(l.showticklabels?.75*l.tickfont.size:0)+("outside"===l.ticks?.87*l.ticklen:0)),c=(n.showticklabels?n.tickfont.size:0)+("outside"===n.ticks?n.ticklen:0)+3;r["a-title"]=x.draw(a,"a"+o,{propContainer:i,propName:t.id+".aaxis.title",placeholder:d(a,"Click to enter Component A title"),attributes:{x:t.x0+t.w/2,y:t.y0-i.title.font.size/3-s,"text-anchor":"middle"}}),r["b-title"]=x.draw(a,"b"+o,{propContainer:n,propName:t.id+".baxis.title",placeholder:d(a,"Click to enter Component B title"),attributes:{x:t.x0-c,y:t.y0+t.h+.83*n.title.font.size+c,"text-anchor":"middle"}}),r["c-title"]=x.draw(a,"c"+o,{propContainer:l,propName:t.id+".caxis.title",placeholder:d(a,"Click to enter Component C title"),attributes:{x:t.x0+t.w+c,y:t.y0+t.h+.83*l.title.font.size+c,"text-anchor":"middle"}})}},k.drawAx=function(e){var t=this,a=t.graphDiv,r=e._name,i=r.charAt(0),n=e._id,l=t.layers[r],d=30,c=i+"tickLayout",p=o(e);t[c]!==p&&(l.selectAll("."+n+"tick").remove(),t[c]=p),e.setScale();var u=m.calcTicks(e),g=m.clipEnds(e,u),y=m.makeTransFn(e),f=m.getTickSigns(e)[2],x=s.deg2rad(d),b=f*(e.linewidth||1)/2,_=f*e.ticklen,v=t.w,w=t.h,h="b"===i?"M0,"+b+"l"+M(x)*_+","+te(x)*_:"M"+b+",0l"+te(x)*_+","+-M(x)*_,k={a:"M0,0l"+w+",-"+v/2,b:"M0,0l-"+v/2+",-"+w,c:"M0,0l-"+w+","+v/2}[i];m.drawTicks(a,e,{vals:"inside"===e.ticks?g:u,layer:l,path:h,transFn:y,crisp:!1}),m.drawGrid(a,e,{vals:g,layer:t.layers[i+"grid"],path:k,transFn:y,crisp:!1});var T=m.makeLabelFns(e,0,d);m.drawLabels(a,e,{vals:u,layer:l,transFn:y,labelXFn:T.labelXFn,labelYFn:T.labelYFn,labelAnchorFn:T.labelAnchorFn})};var A=w.MINZOOM/2+.87,S=!0;k.initInteractions=function(){function e(e){var t={};return t[C.id+".aaxis.min"]=e.a,t[C.id+".baxis.min"]=e.b,t[C.id+".caxis.min"]=e.c,t}function t(t,a){var o=E._fullLayout.clickmode;r(E),2===t&&(E.emit("plotly_doubleclick",null),l.call("_guiRelayout",E,e({a:0,b:0,c:0}))),-1<o.indexOf("select")&&1===t&&_(a,E,[C.xaxis],[C.yaxis],C.id,I),-1<o.indexOf("event")&&f.click(E,a,C.id)}function a(t,e,a){var o=L.getBoundingClientRect();D=e-o.left,P=a-o.top,O={a:C.aaxis.range[0],b:C.baxis.range[1],c:C.caxis.range[1]},M=O,R=C.aaxis.range[1]-O.a,j=n(C.graphDiv._fullLayout[C.id].bgcolor).getLuminance(),B="M0,"+C.h+"L"+C.w/2+", 0L"+C.w+","+C.h+"Z",F=!1,N=z.append("path").attr("class","zoombox").attr("transform","translate("+C.x0+", "+C.y0+")").style({fill:.2<j?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",B),V=z.append("path").attr("class","zoombox-corners").attr("transform","translate("+C.x0+", "+C.y0+")").style({fill:c.background,stroke:c.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),v(z)}function o(e,t){return 1-t/C.h}function i(e,t){return 1-(e+(C.h-t)/re(3))/C.w}function u(e,t){return(e-(C.h-t)/re(3))/C.w}function g(e,t){var a=D+e,r=P+t,n=va(0,ie(1,o(D,P),o(a,r))),l=va(0,ie(1,i(D,P),i(a,r))),s=va(0,ie(1,u(D,P),u(a,r))),d=(n/2+s)*C.w,c=(1-n/2-l)*C.w,p=(d+c)/2,g=c-d,h=(1-n)*C.h,m=h-g/T;g<w.MINZOOM?(M=O,N.attr("d",B),V.attr("d","M0,0Z")):(M={a:O.a+n*R,b:O.b+l*R,c:O.c+s*R},N.attr("d",B+"M"+d+","+h+"H"+c+"L"+p+","+m+"L"+d+","+h+"Z"),V.attr("d","M"+D+","+P+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2Z"+"M"+d+","+h+("m-0.87,.5h"+A+"v3h-"+(A+5.2)+"l"+(A/2+2.6)+",-"+(.87*A+4.5)+"l2.6,1.5l-"+A/2+","+.87*A+"Z")+"M"+c+","+h+("m0.87,.5h-"+A+"v3h"+(A+5.2)+"l-"+(A/2+2.6)+",-"+(.87*A+4.5)+"l-2.6,1.5l"+A/2+","+.87*A+"Z")+"M"+p+","+m+("m0,1l"+A/2+","+.87*A+"l2.6,-1.5l-"+(A/2+2.6)+",-"+(.87*A+4.5)+"l-"+(A/2+2.6)+","+(.87*A+4.5)+"l2.6,1.5l"+A/2+",-"+.87*A+"Z"))),F||(N.transition().style("fill",.2<j?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),V.transition().style("opacity",1).duration(200),F=!0)}function h(){r(E);M===O||(l.call("_guiRelayout",E,e(M)),S&&E.data&&E._context.showTips&&(s.notifier(d(E,"Double-click to zoom back out"),"long"),S=!1))}function m(){O={a:C.aaxis.range[0],b:C.baxis.range[1],c:C.caxis.range[1]},M=O}function x(e,t){var a=e/C.xaxis._m,o=t/C.yaxis._m;M={a:O.a-o,b:O.b+(a+o)/2,c:O.c-(a-o)/2};var r=[M.a,M.b,M.c].sort(),i={a:r.indexOf(M.a),b:r.indexOf(M.b),c:r.indexOf(M.c)};0>r[0]&&(0>r[1]+r[0]/2?(r[2]+=r[0]+r[1],r[0]=r[1]=0):(r[2]+=r[0]/2,r[1]+=r[0]/2,r[0]=0),M={a:r[i.a],b:r[i.b],c:r[i.c]},t=(O.a-M.a)*C.yaxis._m,e=(O.c-M.c-O.b+M.b)*C.xaxis._m);var n="translate("+(C.x0+e)+","+(C.y0+t)+")";C.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",n);var l="translate("+-e+","+-t+")";C.clipDefRelative.select("path").attr("transform",l),C.aaxis.range=[M.a,C.sum-M.b-M.c],C.baxis.range=[C.sum-M.a-M.c,M.b],C.caxis.range=[C.sum-M.a-M.b,M.c],C.drawAxes(!1),C._hasClipOnAxisFalse&&C.plotContainer.select(".scatterlayer").selectAll(".trace").call(p.hideOutsideRangePoints,C)}function k(){l.call("_guiRelayout",E,e(M))}var C=this,L=C.layers.plotbg.select("path").node(),E=C.graphDiv,z=E._fullLayout._zoomlayer,I={element:L,gd:E,plotinfo:{id:C.id,xaxis:C.xaxis,yaxis:C.yaxis},subplot:C.id,prepFn:function(o,e,r){I.xaxes=[C.xaxis],I.yaxes=[C.yaxis];var i=E._fullLayout.dragmode;I.minDrag="lasso"===i?1:void 0,"zoom"===i?(I.moveFn=g,I.clickFn=t,I.doneFn=h,a(o,e,r)):"pan"===i?(I.moveFn=x,I.clickFn=t,I.doneFn=k,m(),v(z)):("select"===i||"lasso"===i)&&b(o,e,r,I,i)}},D,P,O,R,M,j,B,F,N,V;L.onmousemove=function(e){f.hover(E,e,C.id),E._fullLayout._lasthover=L,E._fullLayout._hoversubplot=C.id},L.onmouseout=function(e){E._dragging||y.unhover(E,e)},y.init(I)}},{"../../components/color":569,"../../components/dragelement":587,"../../components/drawing":590,"../../components/fx":608,"../../components/titles":657,"../../lib":692,"../../lib/extend":682,"../../registry":823,"../cartesian/axes":740,"../cartesian/constants":746,"../cartesian/select":758,"../cartesian/set_convert":759,"../plots":804,d3:148,tinycolor2:513}],823:[function(e,t,a){"use strict";function o(e){var t=e.name,o=e.categories,n=e.meta;if(a.modules[t])return void g.log("Type "+t+" already registered");a.subplotsRegistry[e.basePlotModule.name]||r(e.basePlotModule);for(var l={},s=0;s<o.length;s++)l[o[s]]=!0,a.allCategories[o[s]]=!0;for(var c in a.modules[t]={_module:e,categories:l},n&&Object.keys(n).length&&(a.modules[t].meta=n),a.allTypes.push(t),a.componentsRegistry)d(c,t);e.layoutAttributes&&_(a.traceLayoutAttributes,e.layoutAttributes)}function r(e){var t=e.name;if(a.subplotsRegistry[t])return void g.log("Plot type "+t+" already registered.");for(var o in s(e),a.subplotsRegistry[t]=e,a.componentsRegistry)p(o,e.name)}function i(e){if("string"!=typeof e.name)throw new Error("Component module *name* must be a string.");var t=e.name;for(var o in a.componentsRegistry[t]=e,e.layoutAttributes&&(e.layoutAttributes._isLinkedToArray&&m(a.layoutArrayContainers,t),s(e)),a.modules)d(t,o);for(var r in a.subplotsRegistry)p(t,r);for(var i in a.transformsRegistry)c(t,i);e.schema&&e.schema.layout&&v(b,e.schema.layout)}function n(e){if("string"!=typeof e.name)throw new Error("Transform module *name* must be a string.");var t="Transform module "+e.name,o="function"==typeof e.transform,r="function"==typeof e.calcTransform;if(!o&&!r)throw new Error(t+" is missing a *transform* or *calcTransform* method.");for(var i in o&&r&&g.log([t+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),y(e.attributes)||g.log(t+" registered without an *attributes* object."),"function"!=typeof e.supplyDefaults&&g.log(t+" registered without a *supplyDefaults* method."),a.transformsRegistry[e.name]=e,a.componentsRegistry)c(i,e.name)}function l(e){var t=e.name,o=t.split("-")[0],r=e.dictionary,i=e.format,n=r&&Object.keys(r).length,l=i&&Object.keys(i).length,s=a.localeRegistry,d=s[t];if(d||(s[t]=d={}),o!==t){var c=s[o];c||(s[o]=c={}),n&&c.dictionary===d.dictionary&&(c.dictionary=r),l&&c.format===d.format&&(c.format=i)}n&&(d.dictionary=r),l&&(d.format=i)}function s(e){if(e.layoutAttributes){var t=e.layoutAttributes._arrayAttrRegexps;if(t)for(var o=0;o<t.length;o++)m(a.layoutArrayRegexes,t[o])}}function d(e,t){var o=a.componentsRegistry[e].schema;if(o&&o.traces){var r=o.traces[t];r&&v(a.modules[t]._module.attributes,r)}}function c(e,t){var o=a.componentsRegistry[e].schema;if(o&&o.transforms){var r=o.transforms[t];r&&v(a.transformsRegistry[t].attributes,r)}}function p(e,t){var o=a.componentsRegistry[e].schema;if(o&&o.subplots){var r=a.subplotsRegistry[t],i=r.layoutAttributes,n="subplot"===r.attr?r.name:r.attr;Array.isArray(n)&&(n=n[0]);var l=o.subplots[n];i&&l&&v(i,l)}}function u(e){return"object"==typeof e&&(e=e.type),e}var g=e("./lib/loggers"),h=e("./lib/noop"),m=e("./lib/push_unique"),y=e("./lib/is_plain_object"),f=e("./lib/extend"),x=e("./plots/attributes"),b=e("./plots/layout_attributes"),_=f.extendFlat,v=f.extendDeepAll;a.modules={},a.allCategories={},a.allTypes=[],a.subplotsRegistry={},a.transformsRegistry={},a.componentsRegistry={},a.layoutArrayContainers=[],a.layoutArrayRegexes=[],a.traceLayoutAttributes={},a.localeRegistry={},a.apiMethodRegistry={},a.register=function(e){if(!e)throw new Error("No argument passed to Plotly.register.");else e&&!Array.isArray(e)&&(e=[e]);for(var t=0,r;t<e.length;t++){if(r=e[t],!r)throw new Error("Invalid module was attempted to be registered!");switch(r.moduleType){case"trace":o(r);break;case"transform":n(r);break;case"component":i(r);break;case"locale":l(r);break;case"apiMethod":var s=r.name;a.apiMethodRegistry[s]=r.fn;break;default:throw new Error("Invalid module was attempted to be registered!");}}},a.getModule=function(e){var t=a.modules[u(e)];return!!t&&t._module},a.traceIs=function(e,t){if(e=u(e),"various"===e)return!1;var o=a.modules[e];return o||(e&&"area"!==e&&g.log("Unrecognized trace type "+e+"."),o=a.modules[x.type.dflt]),!!o.categories[t]},a.getTransformIndices=function(e,t){for(var a=[],o=e.transforms||[],r=0;r<o.length;r++)o[r].type===t&&a.push(r);return a},a.hasTransform=function(e,t){for(var a=e.transforms||[],o=0;o<a.length;o++)if(a[o].type===t)return!0;return!1},a.getComponentMethod=function(e,t){var o=a.componentsRegistry[e];return o?o[t]||h:h},a.call=function(){var e=arguments[0],t=[].slice.call(arguments,1);return a.apiMethodRegistry[e].apply(null,t)}},{"./lib/extend":682,"./lib/is_plain_object":693,"./lib/loggers":696,"./lib/noop":701,"./lib/push_unique":706,"./plots/attributes":737,"./plots/layout_attributes":795}],824:[function(e,t){"use strict";function a(e){var t;return t="themes__thumb"===e?{autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]}:"thumbnail"===e?{title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]}:{},t}function o(e){return-1<["xaxis","yaxis","zaxis"].indexOf(e.slice(0,5))}var r=e("../lib"),n=r.extendFlat,l=r.extendDeep;t.exports=function(e,t){e.framework&&e.framework.isPolar&&(e=e.framework.getConfig());var r=e.data,s=e.layout,d=l([],r),c=l({},s,a(t.tileClass)),p=e._context||{},u;if(t.width&&(c.width=t.width),t.height&&(c.height=t.height),"thumbnail"===t.tileClass||"themes__thumb"===t.tileClass){c.annotations=[];var g=Object.keys(c);for(u=0;u<g.length;u++)o(g[u])&&(c[g[u]].title={text:""});for(u=0;u<d.length;u++){var h=d[u];h.showscale=!1,h.marker&&(h.marker.showscale=!1),"pie"===h.type&&(h.textposition="none")}}if(Array.isArray(t.annotations))for(u=0;u<t.annotations.length;u++)c.annotations.push(t.annotations[u]);var m=Object.keys(c).filter(function(e){return e.match(/^scene\d*$/)});if(m.length){var y={};for("thumbnail"===t.tileClass&&(y={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),u=0;u<m.length;u++){var f=c[m[u]];f.xaxis||(f.xaxis={}),f.yaxis||(f.yaxis={}),f.zaxis||(f.zaxis={}),n(f.xaxis,y),n(f.yaxis,y),n(f.zaxis,y),f._scene=null}}var x=document.createElement("div");t.tileClass&&(x.className=t.tileClass);var b={gd:x,td:x,layout:c,data:d,config:{staticPlot:void 0===t.staticPlot||t.staticPlot,plotGlPixelRatio:void 0===t.plotGlPixelRatio?2:t.plotGlPixelRatio,displaylogo:t.displaylogo||!1,showLink:t.showLink||!1,showTips:t.showTips||!1,mapboxAccessToken:p.mapboxAccessToken}};return"transparent"!==t.setBackground&&(b.config.setBackground=t.setBackground||"opaque"),b.gd.defaultLayout=a(t.tileClass),b}},{"../lib":692}],825:[function(e,t){"use strict";var a=e("../plot_api/to_image"),o=e("../lib"),r=e("./filesaver");t.exports=function(e,t){var i;return o.isPlainObject(e)||(i=o.getGraphDiv(e)),t=t||{},t.format=t.format||"png",new Promise(function(n,l){i&&i._snapshotInProgress&&l(new Error("Snapshotting already in progress.")),o.isIE()&&"svg"!==t.format&&l(new Error("Sorry IE does not support downloading from canvas. Try {format:'svg'} instead.")),i&&(i._snapshotInProgress=!0);var s=a(e,t),d=t.filename||e.fn||"newplot";d+="."+t.format,s.then(function(e){return i&&(i._snapshotInProgress=!1),r(e,d)}).then(function(e){n(e)}).catch(function(e){i&&(i._snapshotInProgress=!1),l(e)})})}},{"../lib":692,"../plot_api/to_image":733,"./filesaver":826}],826:[function(e,t){"use strict";t.exports=function(e,t){var a=document.createElement("a"),o=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),r=/CyBrowser/.test(navigator.userAgent),i=new Promise(function(i,n){if("undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent)&&n(new Error("IE < 10 unsupported")),o&&(document.location.href="data:application/octet-stream"+e.slice(e.search(/[,;]/)),i(t)),t||(t="download"),r&&(cybrowser.downloadFile(e,t),i(t)),!0&&(a.href=e,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),i(t)),"undefined"!=typeof navigator&&navigator.msSaveBlob){var l=e.split(/^data:image\/svg\+xml,/)[1],s=decodeURIComponent(l);navigator.msSaveBlob(new Blob([s]),t),i(t)}n(new Error("download error"))});return i}},{}],827:[function(e,t,a){"use strict";a.getDelay=function(e){return e._has?e._has("gl3d")||e._has("gl2d")||e._has("mapbox")?500:0:0},a.getRedrawFunc=function(e){var t=e._fullLayout||{},a=t._has&&t._has("polar"),o=!a&&e.data&&e.data[0]&&e.data[0].r;return o?void 0:function(){(e.calcdata||[]).forEach(function(e){e[0]&&e[0].t&&e[0].t.cb&&e[0].t.cb()})}}},{}],828:[function(e,t){"use strict";var a=e("./helpers"),o={getDelay:a.getDelay,getRedrawFunc:a.getRedrawFunc,clone:e("./cloneplot"),toSVG:e("./tosvg"),svgToImg:e("./svgtoimg"),toImage:e("./toimage"),downloadImage:e("./download")};t.exports=o},{"./cloneplot":824,"./download":825,"./helpers":827,"./svgtoimg":829,"./toimage":830,"./tosvg":831}],829:[function(e,t){"use strict";var a=e("../lib"),o=e("events").EventEmitter;t.exports=function(e){var t=e.emitter||new o,r=new Promise(function(o,i){var n=window.Image,l=e.svg,s=e.format||"png";if(a.isIE()&&"svg"!==s){var d=new Error("Sorry IE does not support downloading from canvas. Try {format:'svg'} instead.");return i(d),e.promise?r:t.emit("error",d)}var c=e.canvas,p=e.scale||1,u=e.width||300,g=e.height||150,h=p*u,m=p*g,y=c.getContext("2d"),f=new n,x="data:image/svg+xml,"+encodeURIComponent(l);c.width=h,c.height=m,f.onload=function(){var a;switch("svg"!==s&&y.drawImage(f,0,0,h,m),s){case"jpeg":a=c.toDataURL("image/jpeg");break;case"png":a=c.toDataURL("image/png");break;case"webp":a=c.toDataURL("image/webp");break;case"svg":a=x;break;default:var r="Image format is not jpeg, png, svg or webp.";if(i(new Error(r)),!e.promise)return t.emit("error",r);}o(a),e.promise||t.emit("success",a)},f.onerror=function(a){if(i(a),!e.promise)return t.emit("error",a)},f.src=x});return e.promise?r:t}},{"../lib":692,events:92}],830:[function(e,t){"use strict";var a=e("events").EventEmitter,o=e("../registry"),r=e("../lib"),i=e("./helpers"),n=e("./cloneplot"),l=e("./tosvg"),s=e("./svgtoimg");t.exports=function(e,t){var d=new a,c=n(e,{format:"png"}),p=c.gd;p.style.position="absolute",p.style.left="-5000px",document.body.appendChild(p);var u=i.getRedrawFunc(p);return o.call("plot",p,c.data,c.layout,c.config).then(u).then(function(){var e=i.getDelay(p._fullLayout);setTimeout(function(){var e=l(p),a=document.createElement("canvas");a.id=r.randstr(),d=s({format:t.format,width:p._fullLayout.width,height:p._fullLayout.height,canvas:a,emitter:d,svg:e}),d.clean=function(){p&&document.body.removeChild(p)}},e)}).catch(function(e){d.emit("error",e)}),d}},{"../lib":692,"../registry":823,"./cloneplot":824,"./helpers":827,"./svgtoimg":829,"./tosvg":831,events:92}],831:[function(e,t){"use strict";function a(e){var t=r.select("body").append("div").style({display:"none"}).html(""),a=e.replace(/(&[^;]*;)/gi,function(e){return"&lt;"===e?"&#60;":"&rt;"===e?"&#62;":-1!==e.indexOf("<")||-1!==e.indexOf(">")?"":t.html(e).text()});return t.remove(),a}function o(e){return e.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}var r=e("d3"),n=e("../lib"),l=e("../components/drawing"),d=e("../components/color"),c=e("../constants/xmlns_namespaces"),p=/"/g,u="TOBESTRIPPED",g=new RegExp("(\""+u+")|("+u+"\")","g");t.exports=function(e,t,h){var m=e._fullLayout,y=m._paper,f=m._toppaper,x=m.width,b=m.height,_;y.insert("rect",":first-child").call(l.setRect,0,0,x,b).call(d.fill,m.paper_bgcolor);var v=m._basePlotModules||[];for(_=0;_<v.length;_++){var w=v[_];w.toSVG&&w.toSVG(e)}if(f){var k=f.node().childNodes,T=Array.prototype.slice.call(k);for(_=0;_<T.length;_++){var A=T[_];A.childNodes.length&&y.node().appendChild(A)}}m._draggers&&m._draggers.remove(),y.node().style.background="",y.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var e=r.select(this);if("hidden"===this.style.visibility||"none"===this.style.display)return void e.remove();e.style({visibility:null,display:null});var t=this.style.fontFamily;t&&-1!==t.indexOf("\"")&&e.style("font-family",t.replace(p,u))}),y.selectAll(".point, .scatterpts, .legendfill>path, .legendlines>path, .cbfill").each(function(){var e=r.select(this),t=this.style.fill;t&&-1!==t.indexOf("url(")&&e.style("fill",t.replace(p,u));var a=this.style.stroke;a&&-1!==a.indexOf("url(")&&e.style("stroke",a.replace(p,u))}),("pdf"===t||"eps"===t)&&y.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),y.node().setAttributeNS(c.xmlns,"xmlns",c.svg),y.node().setAttributeNS(c.xmlns,"xmlns:xlink",c.xlink),"svg"===t&&h&&(y.attr("width",h*x),y.attr("height",h*b),y.attr("viewBox","0 0 "+x+" "+b));var S=new window.XMLSerializer().serializeToString(y.node());return S=a(S),S=o(S),S=S.replace(g,"'"),n.isIE()&&(S=S.replace(/"/gi,"'"),S=S.replace(/(\('#)([^']*)('\))/gi,"(\"#$2\")"),S=S.replace(/(\\')/gi,"\"")),S}},{"../components/color":569,"../components/drawing":590,"../constants/xmlns_namespaces":670,"../lib":692,d3:148}],832:[function(e,t){"use strict";var a=e("../../lib").mergeArray;t.exports=function(e,t){for(var o=0;o<e.length;o++)e[o].i=o;a(t.text,e,"tx"),a(t.hovertext,e,"htx");var r=t.marker;if(r){a(r.opacity,e,"mo"),a(r.color,e,"mc");var n=r.line;n&&(a(n.color,e,"mlc"),a(n.width,e,"mlw"))}}},{"../../lib":692}],833:[function(e,t){"use strict";var a=e("../scatter/attributes"),o=e("../../components/fx/hovertemplate_attributes"),r=e("../../components/colorscale/attributes"),i=e("../../components/colorbar/attributes"),n=e("../../plots/font_attributes"),l=e("./constants.js"),s=e("../../lib/extend").extendFlat,d=n({editType:"calc",arrayOk:!0,colorEditType:"style"}),c=a.marker,p=c.line,u=s({},p.width,{dflt:0}),g=s({width:u,editType:"calc"},r("marker.line")),h=s({line:g,editType:"calc"},r("marker"),{colorbar:i,opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"}});t.exports={x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,text:a.text,hovertext:a.hovertext,hovertemplate:o({},{keys:l.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"none",arrayOk:!0,editType:"calc"},textfont:s({},d,{}),insidetextfont:s({},d,{}),outsidetextfont:s({},d,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:s({},a.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:h,selected:{marker:{opacity:a.selected.marker.opacity,color:a.selected.marker.color,editType:"style"},textfont:a.selected.textfont,editType:"style"},unselected:{marker:{opacity:a.unselected.marker.opacity,color:a.unselected.marker.color,editType:"style"},textfont:a.unselected.textfont,editType:"style"},r:a.r,t:a.t,_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../components/fx/hovertemplate_attributes":607,"../../lib/extend":682,"../../plots/font_attributes":767,"../scatter/attributes":1040,"./constants.js":835}],834:[function(e,t){"use strict";var a=e("../../plots/cartesian/axes"),o=e("../../components/colorscale/helpers").hasColorscale,r=e("../../components/colorscale/calc"),n=e("./arrays_to_calcdata"),l=e("../scatter/calc_selection");t.exports=function(e,t){var s=a.getFromId(e,t.xaxis||"x"),d=a.getFromId(e,t.yaxis||"y"),c,p;"h"===t.orientation?(c=s.makeCalcdata(t,"x"),p=d.makeCalcdata(t,"y")):(c=d.makeCalcdata(t,"y"),p=s.makeCalcdata(t,"x"));for(var u=ie(p.length,c.length),g=Array(u),h=0;h<u;h++)g[h]={p:p[h],s:c[h]},t.ids&&(g[h].id=t.ids[h]+"");return o(t,"marker")&&r(e,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"}),o(t,"marker.line")&&r(e,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"}),n(g,t),l(g,t),g}},{"../../components/colorscale/calc":577,"../../components/colorscale/helpers":580,"../../plots/cartesian/axes":740,"../scatter/calc_selection":1042,"./arrays_to_calcdata":832}],835:[function(e,t){"use strict";t.exports={eventDataKeys:[]}},{}],836:[function(e,t){"use strict";function a(e,t,a,s){if(s.length){var d=e._fullLayout.barmode,c,p,u,g,h;if(o(e,t,a,s),"overlay"===d)r(e,t,a,s);else if("group"===d){for(c=[],p=[],u=0;u<s.length;u++)g=s[u],h=g[0].trace,void 0===h.offset?p.push(g):c.push(g);p.length&&n(e,t,a,p),c.length&&r(e,t,a,c)}else{for(c=[],p=[],u=0;u<s.length;u++)g=s[u],h=g[0].trace,void 0===h.base?p.push(g):c.push(g);p.length&&l(e,t,a,p),c.length&&r(e,t,a,c)}_(s,t)}}function o(e,t,a,o){var r,n;for(r=0;r<o.length;r++){var l=o[r],s=l[0].trace,d=s.base,c="h"===s.orientation?s.xcalendar:s.ycalendar,p="category"===a.type||"multicategory"===a.type?function(){return null}:a.d2c,u;if(w(d)){for(n=0;n<ie(d.length,l.length);n++)u=p(d[n],0,c),v(u)?(l[n].b=+u,l[n].hasB=1):l[n].b=0;for(;n<l.length;n++)l[n].b=0}else{u=p(d,0,c);var g=v(u);for(u=g?u:0,n=0;n<l.length;n++)l[n].b=u,g&&(l[n].hasB=1)}}}function r(e,t,a,o){for(var r=e._fullLayout.barnorm,n=0;n<o.length;n++){var l=o[n],d=new S([l],!1,!r);s(e,t,d),r?(y(e,a,d),f(e,a,d)):h(e,a,d)}}function n(e,t,a,o){var r=e._fullLayout,i=r.barnorm,n=new S(o,!1,!i);d(e,t,n),i?(y(e,a,n),f(e,a,n)):h(e,a,n)}function l(e,t,a,o){var r=e._fullLayout,n=r.barmode,l="relative"===n,d=e._fullLayout.barnorm,c=new S(o,l,!(d||"stack"===n||l));s(e,t,c),m(e,a,c);for(var p=0,u;p<o.length;p++){u=o[p];for(var g=0,h;g<u.length;g++)if(h=u[g],h.s!==k){var y=h.b+h.s===c.get(h.p,h.s);y&&(h._outmost=!0)}}d&&f(e,a,c)}function s(e,a,o){var r=e._fullLayout,n=r.bargap,l=r.bargroupgap||0,s=o.minDiff,d=o.traces,g=s*(1-n),h=g*(1-l),m,y,f,x;for(m=0;m<d.length;m++)y=d[m],f=y[0],x=f.t,x.barwidth=h,x.poffset=-h/2,x.bargroupwidth=g,x.bardelta=s;o.binWidth=d[0][0].t.barwidth/100,c(o),p(e,a,o),u(e,a,o)}function d(e,a,o){var r=e._fullLayout,n=r.bargap,l=r.bargroupgap||0,s=o.positions,d=o.distinctPositions,g=o.minDiff,h=o.traces,m=s.length!==d.length,y=h.length,f=g*(1-n),x=m?f/y:f,b=x*(1-l),_,v,w,k;for(_=0;_<y;_++){v=h[_],w=v[0];var T=m?((2*_+1-y)*x-b)/2:-b/2;k=w.t,k.barwidth=b,k.poffset=T,k.bargroupwidth=f,k.bardelta=g}o.binWidth=h[0][0].t.barwidth/100,c(o),p(e,a,o),u(e,a,o,m)}function c(e){var a=e.traces,o,r,n,l,s,d;for(o=0;o<a.length;o++){r=a[o],n=r[0],l=n.trace,d=n.t;var c=l._offset||l.offset,p=d.poffset,u;if(w(c)){for(u=Array.prototype.slice.call(c,0,r.length),s=0;s<u.length;s++)v(u[s])||(u[s]=p);for(s=u.length;s<r.length;s++)u.push(p);d.poffset=u}else void 0!==c&&(d.poffset=c);var g=l._width||l.width,h=d.barwidth;if(w(g)){var m=Array.prototype.slice.call(g,0,r.length);for(s=0;s<m.length;s++)v(m[s])||(m[s]=h);for(s=m.length;s<r.length;s++)m.push(h);if(d.barwidth=m,void 0===c){for(u=[],s=0;s<r.length;s++)u.push(p+(h-m[s])/2);d.poffset=u}}else void 0!==g&&(d.barwidth=g,void 0===c&&(d.poffset=p+(h-g)/2))}}function p(e,a,o){for(var r=o.traces,n=x(a),l=0;l<r.length;l++)for(var s=r[l],d=s[0].t,t=d.poffset,c=Array.isArray(t),p=d.barwidth,u=Array.isArray(p),g=0;g<s.length;g++){var h=s[g],m=h.w=u?p[g]:p;h[n]=h.p+(c?t[g]:t)+m/2}}function u(e,a,o,r){var n=o.traces,s=o.distinctPositions,d=s[0],c=o.minDiff,u=c/2;A.minDtick(a,c,d,r);for(var g=ie.apply(Math,s)-u,h=va.apply(Math,s)+u,m=0;m<n.length;m++){var y=n[m],f=y[0],x=f.trace;if(void 0!==x.width||void 0!==x.offset)for(var _=f.t,t=_.poffset,v=_.barwidth,w=Array.isArray(t),k=Array.isArray(v),T=0;T<y.length;T++){var S=y[T],C=w?t[T]:t,L=k?v[T]:v,E=S.p,p=E+C;g=ie(g,p),h=va(h,p+L)}}var l=A.findExtremes(a,[g,h],{padded:!1});b(n,a,l)}function g(e,t){e[0]=v(e[0])?ie(e[0],t):t,e[1]=v(e[1])?va(e[1],t):t}function h(e,t,a){for(var o=a.traces,r=x(t),n=[null,null],l=0,s;l<o.length;l++){s=o[l];for(var d=0;d<s.length;d++){var c=s[d],p=c.b,u=p+c.s;c[r]=u,v(t.c2l(u))&&g(n,u),c.hasB&&v(t.c2l(p))&&g(n,p)}}var h=A.findExtremes(t,n,{tozero:!0,padded:!0});b(o,t,h)}function m(e,t,a){var o=e._fullLayout,r=o.barnorm,n=x(t),l=a.traces,s=[null,null],d,c,p,u;for(d=0;d<l.length;d++)for(c=l[d],p=0;p<c.length;p++)if(u=c[p],u.s!==k){var h=a.put(u.p,u.b+u.s),m=h+u.b+u.s;u.b=h,u[n]=m,r||(v(t.c2l(m))&&g(s,m),u.hasB&&v(t.c2l(h))&&g(s,h))}if(!r){var y=A.findExtremes(t,s,{tozero:!0,padded:!0});b(l,t,y)}}function y(e,t,a){for(var o=a.traces,r=0,n;r<o.length;r++){n=o[r];for(var l=0,s;l<n.length;l++)s=n[l],s.s!==k&&a.put(s.p,s.b+s.s)}}function f(e,t,a){function o(e){v(t.c2l(e))&&(e<d-s||e>c+s||!v(d))&&(u=!0,g(p,e))}for(var r=a.traces,n=x(t),l="fraction"===e._fullLayout.barnorm?1:100,s=l/1e9,d=t.l2c(t.c2l(0)),c="stack"===e._fullLayout.barmode?l:d,p=[d,c],u=!1,h=0,m;h<r.length;h++){m=r[h];for(var y=0,f;y<m.length;y++)if(f=m[y],f.s!==k){var _=wa(l/a.get(f.p,f.s));f.b*=_,f.s*=_;var w=f.b,T=w+f.s;f[n]=T,o(T),f.hasB&&o(w)}}var S=A.findExtremes(t,p,{tozero:!0,padded:u});b(r,t,S)}function x(e){return e._id.charAt(0)}function b(e,t,a){for(var o=0;o<e.length;o++)e[o][0].trace._extremes[t._id]=a}function _(e,t){var a=t._id.charAt(0),o={},r=1/0,n=-Infinity,l,s,d;for(l=0;l<e.length;l++)for(d=e[l],s=0;s<d.length;s++){var c=d[s].p;v(c)&&(r=ie(r,c),n=va(n,c))}var u=1e4/(n-r),g=o.round=function(e){return R(u*(e-r))+""},h,m;for(l=0;l<e.length;l++)for(d=e[l],d[0].t.extents=o,h=d[0].t.poffset,m=Array.isArray(h),s=0;s<d.length;s++){var y=d[s],p=y[a]-y.w/2;if(v(p)){var f=y[a]+y.w/2,x=g(y.p);o[x]=o[x]?[ie(p,o[x][0]),va(f,o[x][1])]:[p,f]}y.p0=y.p+(m?h[s]:h),y.p1=y.p0+y.w,y.s0=y.b,y.s1=y.s0+y.s}}var v=e("fast-isnumeric"),w=e("../../lib").isArrayOrTypedArray,k=e("../../constants/numerical").BADNUM,T=e("../../registry"),A=e("../../plots/cartesian/axes"),S=e("./sieve.js");t.exports={crossTraceCalc:function(e,t){var o=t.xaxis,r=t.yaxis,n=e._fullData,l=e.calcdata,s=[],d=[],c;for(c=0;c<n.length;c++){var p=n[c];!0===p.visible&&T.traceIs(p,"bar")&&p.xaxis===o._id&&p.yaxis===r._id&&("h"===p.orientation?s.push(l[c]):d.push(l[c]))}a(e,o,r,d),a(e,r,o,s)},setGroupPositions:a}},{"../../constants/numerical":669,"../../lib":692,"../../plots/cartesian/axes":740,"../../registry":823,"./sieve.js":845,"fast-isnumeric":214}],837:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../components/color"),r=e("../../registry"),i=e("../scatter/xy_defaults"),n=e("../bar/style_defaults"),l=e("./attributes");t.exports=function(e,t,s,d){function c(o,r){return a.coerce(e,t,l,o,r)}var p=a.coerceFont,u=i(e,t,d,c);if(!u)return void(t.visible=!1);c("orientation",t.x&&!t.y?"h":"v"),c("base"),c("offset"),c("width"),c("text"),c("hovertext"),c("hovertemplate");var g=c("textposition"),h=Array.isArray(g)||"auto"===g,m=h||"outside"===g;if(h||"inside"===g||m){var y=p(c,"textfont",d.font),f=a.extendFlat({},y),x=e.textfont&&e.textfont.color;!x&&delete f.color,p(c,"insidetextfont",f),m&&p(c,"outsidetextfont",y),c("constraintext"),c("selected.textfont.color"),c("unselected.textfont.color"),c("cliponaxis")}n(e,t,c,s,d);var b=r.getComponentMethod("errorbars","supplyDefaults");b(e,t,o.defaultLine,{axis:"y"}),b(e,t,o.defaultLine,{axis:"x",inherit:"y"}),a.coerceSelectionMarkerOpacity(t,c)}},{"../../components/color":569,"../../lib":692,"../../registry":823,"../bar/style_defaults":847,"../scatter/xy_defaults":1066,"./attributes":833}],838:[function(e,t,a){"use strict";var o=e("fast-isnumeric"),r=e("tinycolor2");a.coerceString=function(e,t,a){if("string"==typeof t){if(t||!e.noBlank)return t;}else if("number"==typeof t&&!e.strict)return t+"";return a===void 0?e.dflt:a},a.coerceNumber=function(e,t,a){if(o(t)){t=+t;var r=e.min,i=e.max,n=r!==void 0&&t<r||i!==void 0&&t>i;if(!n)return t}return a===void 0?e.dflt:a},a.coerceColor=function(e,t,a){return r(t).isValid()?t:a===void 0?e.dflt:a},a.coerceEnumerated=function(e,t,a){return e.coerceNumber&&(t=+t),-1===e.values.indexOf(t)?void 0===a?e.dflt:a:t},a.getValue=function(e,t){var a;return Array.isArray(e)?t<e.length&&(a=e[t]):a=e,a}},{"fast-isnumeric":214,tinycolor2:513}],839:[function(e,t){"use strict";function a(e,t){var a=t.mcc||e.marker.color,o=t.mlcc||e.marker.line.color,r=t.mlw||e.marker.line.width;if(i.opacity(a))return a;return i.opacity(o)&&r?o:void 0}var o=e("../../components/fx"),r=e("../../registry"),i=e("../../components/color"),n=e("../scatter/fill_hover_text");t.exports={hoverPoints:function(e,i,l,s){function d(e){return e[A]-e.w/2}function c(e){return e[A]+e.w/2}function p(e,t){return o.inbox(e-k,t-k,b+ie(1,wa(t-e)/E)-1)}function u(e){return p(v(e),w(e))}function g(e){return p(d(e),c(e))}function h(e){return o.inbox(e.b-T,e[S]-T,b+(e[S]-T)/(e[S]-e.b)-1)}function m(e){return(C(e)+L(e))/2}var y=e.cd,f=y[0].trace,x=y[0].t,t="closest"===s,b=e.maxHoverDistance,_=e.maxSpikeDistance,v=t?d:function(e){return ie(d(e),e.p-x.bardelta/2)},w=t?c:function(e){return va(c(e),e.p+x.bardelta/2)},k,T,A,S,C,L,E;"h"===f.orientation?(k=l,T=i,A="y",S="x",C=h,L=u):(k=i,T=l,A="x",S="y",L=h,C=u);var z=e[A+"a"],I=e[S+"a"];E=wa(z.r2c(z.range[1])-z.r2c(z.range[0]));var D=o.getDistanceFunction(s,C,L,m);if(o.getClosest(y,D,e),!1!==e.index){t||(v=function(e){return ie(d(e),e.p-x.bargroupwidth/2)},w=function(e){return va(c(e),e.p+x.bargroupwidth/2)});var P=e.index,O=y[P],R=f.base?O.b+O.s:O.s;e[S+"0"]=e[S+"1"]=I.c2p(O[S],!0),e[S+"LabelVal"]=R;var M=x.extents[x.extents.round(O.p)];return e[A+"0"]=z.c2p(t?v(O):M[0],!0),e[A+"1"]=z.c2p(t?w(O):M[1],!0),e[A+"LabelVal"]=O.p,e.spikeDistance=(h(O)+g(O))/2+_-b,e[A+"Spike"]=z.c2p(O.p,!0),e.color=a(f,O),n(O,f,e),r.getComponentMethod("errorbars","hoverInfo")(O,f,e),e.hovertemplate=f.hovertemplate,[e]}},getTraceColor:a}},{"../../components/color":569,"../../components/fx":608,"../../registry":823,"../scatter/fill_hover_text":1048}],840:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.layoutAttributes=e("./layout_attributes"),a.supplyDefaults=e("./defaults"),a.supplyLayoutDefaults=e("./layout_defaults"),a.calc=e("./calc"),a.crossTraceCalc=e("./cross_trace_calc").crossTraceCalc,a.colorbar=e("../scatter/marker_colorbar"),a.arraysToCalcdata=e("./arrays_to_calcdata"),a.plot=e("./plot"),a.style=e("./style").style,a.styleOnSelect=e("./style").styleOnSelect,a.hoverPoints=e("./hover").hoverPoints,a.selectPoints=e("./select"),a.moduleType="trace",a.name="bar",a.basePlotModule=e("../../plots/cartesian"),a.categories=["cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],a.meta={},t.exports=a},{"../../plots/cartesian":752,"../scatter/marker_colorbar":1058,"./arrays_to_calcdata":832,"./attributes":833,"./calc":834,"./cross_trace_calc":836,"./defaults":837,"./hover":839,"./layout_attributes":841,"./layout_defaults":842,"./plot":843,"./select":844,"./style":846}],841:[function(e,t){"use strict";t.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],842:[function(e,t){"use strict";var a=e("../../registry"),o=e("../../plots/cartesian/axes"),r=e("../../lib"),i=e("./layout_attributes");t.exports=function(e,t,n){function l(a,o){return r.coerce(e,t,i,a,o)}for(var s=!1,d=!1,c=!1,p={},u=0,g;u<n.length;u++){if(g=n[u],a.traceIs(g,"bar")&&g.visible)s=!0;else continue;if("overlay"!==e.barmode&&"stack"!==e.barmode){var h=g.xaxis+g.yaxis;p[h]&&(c=!0),p[h]=!0}if(g.visible&&"histogram"===g.type){var m=o.getFromId({_fullLayout:t},g["v"===g.orientation?"xaxis":"yaxis"]);"category"!==m.type&&(d=!0)}}if(s){var y=l("barmode");"overlay"!==y&&l("barnorm"),l("bargap",d&&!c?0:.2),l("bargroupgap")}}},{"../../lib":692,"../../plots/cartesian/axes":740,"../../registry":823,"./layout_attributes":841}],843:[function(e,t){"use strict";function a(e,t,a,s,i,d,u,h){function m(t,a,o){var r=c.ensureSingle(t,"text").text(a).attr({class:"bartext bartext-"+_,transform:"","text-anchor":"middle","data-notex":1}).call(g.font,o).call(p.convertToTspans,e);return r}var y=a[0].trace,f=y.orientation,x=n(y,s),_;if(_=l(y,s),!x||"none"===_)return void t.select("text").remove();var v=e._fullLayout.font,w=b.getBarColor(a[s],y),k=b.getInsideTextFont(y,s,v,w),T=b.getOutsideTextFont(y,s,v),A=e._fullLayout.barmode,S=a[s],C=!("stack"===A||"relative"===A)||S._outmost,L=wa(d-i)-6,E=wa(h-u)-6,z,I,D,P;if("outside"!==_||C||S.hasB||(_="inside"),"auto"===_)if(C){_="inside",z=m(t,x,k),I=g.bBox(z.node()),D=I.width,P=I.height;var O=0<D&&0<P,R=D<=L&&P<=E,M=D<=E&&P<=L,j="h"===f?L>=D*(E/P):E>=P*(L/D);O&&(R||M||j)?_="inside":(_="outside",z.remove(),z=null)}else _="inside";if(!z&&(z=m(t,x,"outside"===_?T:k),I=g.bBox(z.node()),D=I.width,P=I.height,0>=D||0>=P))return void z.remove();var B,F;"outside"===_?(F="both"===y.constraintext||"outside"===y.constraintext,B=r(i,d,u,h,I,f,F)):(F="both"===y.constraintext||"inside"===y.constraintext,B=o(i,d,u,h,I,f,F)),z.attr("transform",B)}function o(e,t,a,o,r,n,l){var s=r.width,d=r.height,c=(r.left+r.right)/2,p=(r.top+r.bottom)/2,u=wa(t-e),g=wa(o-a),h,m,y,f,x;6<u&&6<g?(x=3,u-=2*x,g-=2*x):x=0;var b,_;return s<=u&&d<=g?(b=!1,_=1):s<=g&&d<=u?(b=!0,_=1):s<d==u<g?(b=!1,_=l?ie(u/s,g/d):1):(b=!0,_=l?ie(g/s,u/d):1),b&&(b=90),b?(h=_*d,m=_*s):(h=_*s,m=_*d),"h"===n?t<e?(y=t+x+h/2,f=(a+o)/2):(y=t-x-h/2,f=(a+o)/2):o>a?(y=(e+t)/2,f=o-x-m/2):(y=(e+t)/2,f=o+x+m/2),i(c,p,y,f,_,b)}function r(e,t,a,o,r,n,l){var s="h"===n?wa(o-a):wa(t-e),d;6<s&&(d=3);var c=1;l&&(c="h"===n?ie(1,s/r.height):ie(1,s/r.width));var p=(r.left+r.right)/2,u=(r.top+r.bottom)/2,g,h,m,y;return g=c*r.width,h=c*r.height,"h"===n?t<e?(m=t-d-g/2,y=(a+o)/2):(m=t+d+g/2,y=(a+o)/2):o>a?(m=(e+t)/2,y=o+d+h/2):(m=(e+t)/2,y=o-d-h/2),i(p,u,m,y,c,!1)}function i(e,t,a,o,r,i){var n,l,s;1>r?n="scale("+r+") ":(r=1,n=""),l=i?"rotate("+i+" "+e+" "+t+") ":"";var d=a-r*e,c=o-r*t;return s="translate("+d+" "+c+")",s+n+l}function n(e,t){var a=x.getValue(e.text,t);return x.coerceString(y,a)}function l(e,t){var a=x.getValue(e.textposition,t);return x.coerceEnumerated(f,a)}var s=e("d3"),d=e("fast-isnumeric"),c=e("../../lib"),p=e("../../lib/svg_text_utils"),u=e("../../components/color"),g=e("../../components/drawing"),h=e("../../registry"),m=e("./attributes"),y=m.text,f=m.textposition,x=e("./helpers"),b=e("./style");t.exports=function(e,t,o,r){var n=t.xaxis,l=t.yaxis,i=e._fullLayout,p=c.makeTraceGroups(r,o,"trace bars").each(function(o){var r=s.select(this),p=o[0],h=p.trace;t.isRangePlot||(p.node3=r);var m=c.ensureSingle(r,"g","points"),y=m.selectAll("g.point").data(c.identity);y.enter().append("g").classed("point",!0),y.exit().remove(),y.each(function(r,p){function m(e){return 0===i.bargap&&0===i.bargroupgap?s.round(R(e)-k,2):e}function y(e,t){return 2<=wa(e-t)?m(e):e>t?ae(e):ea(e)}var f=s.select(this),x,b,_,v;if("h"===h.orientation?(_=l.c2p(r.p0,!0),v=l.c2p(r.p1,!0),x=n.c2p(r.s0,!0),b=n.c2p(r.s1,!0),r.ct=[b,(_+v)/2]):(x=n.c2p(r.p0,!0),b=n.c2p(r.p1,!0),_=l.c2p(r.s0,!0),v=l.c2p(r.s1,!0),r.ct=[(x+b)/2,v]),!d(x)||!d(b)||!d(_)||!d(v)||x===b||_===v)return void f.remove();var w=(r.mlw+1||h.marker.line.width+1||(r.trace?r.trace.marker.line.width:0)+1)-1,k=s.round(w/2%1,2);if(!e._context.staticPlot){var T=u.opacity(r.mc||h.marker.color),A=1>T||.01<w?m:y;x=A(x,b),b=A(b,x),_=A(_,v),v=A(v,_)}c.ensureSingle(f,"path").style("vector-effect","non-scaling-stroke").attr("d","M"+x+","+_+"V"+v+"H"+b+"V"+_+"Z").call(g.setClipUrl,t.layerClipId,e),a(e,f,o,p,x,b,_,v),t.layerClipId&&g.hideOutsideRangePoint(r,f.select("text"),n,l,h.xcalendar,h.ycalendar)});var f=!1===p.trace.cliponaxis;g.setClipUrl(r,f?null:t.layerClipId,e)});h.getComponentMethod("errorbars","plot")(e,p,t)}},{"../../components/color":569,"../../components/drawing":590,"../../lib":692,"../../lib/svg_text_utils":716,"../../registry":823,"./attributes":833,"./helpers":838,"./style":846,d3:148,"fast-isnumeric":214}],844:[function(e,t){"use strict";t.exports=function(e,t){var a=e.cd,o=e.xaxis,r=e.yaxis,n=[],l;if(!1===t)for(l=0;l<a.length;l++)a[l].selected=0;else for(l=0;l<a.length;l++){var s=a[l];t.contains(s.ct,!1,l,e)?(n.push({pointNumber:l,x:o.c2d(s.x),y:r.c2d(s.y)}),s.selected=1):s.selected=0}return n}},{}],845:[function(e,t){"use strict";function a(e,t,a){this.traces=e,this.separateNegativeValues=t,this.dontMergeOverlappingData=a;for(var n=1/0,l=[],s=0,d;s<e.length;s++){d=e[s];for(var c=0,p;c<d.length;c++)p=d[c],p.p!==r&&l.push(p.p);d[0]&&d[0].width1&&(n=ie(d[0].width1,n))}this.positions=l;var u=o.distinctVals(l);this.distinctPositions=u.vals,this.minDiff=1===u.vals.length&&n!==1/0?n:ie(u.minDiff,n),this.binWidth=this.minDiff,this.bins={}}t.exports=a;var o=e("../../lib"),r=e("../../constants/numerical").BADNUM;a.prototype.put=function(e,t){var a=this.getLabel(e,t),o=this.bins[a]||0;return this.bins[a]=o+t,o},a.prototype.get=function(e,t){var a=this.getLabel(e,t);return this.bins[a]||0},a.prototype.getLabel=function(e,t){var a=0>t&&this.separateNegativeValues?"v":"^",o=this.dontMergeOverlappingData?e:R(e/this.binWidth);return a+o}},{"../../constants/numerical":669,"../../lib":692}],846:[function(e,t){"use strict";function a(e,t,a){var o=e.selectAll("path"),r=e.selectAll("text");g.pointStyle(o,t,a),r.each(function(e){var o=p.select(this),r=i(o,e,t,a);g.font(o,r)})}function o(e,t,a){g.selectedPointStyle(e.selectAll("path"),t),r(e.selectAll("text"),t,a)}function r(e,t,a){e.each(function(e){var o=p.select(this),r;if(e.selected){r=h.extendFlat({},i(o,e,t,a));var n=t.selected.textfont&&t.selected.textfont.color;n&&(r.color=n),g.font(o,r)}else g.selectedTextStyle(o,t)})}function i(e,t,a,o){var r=o._fullLayout.font,i=a.textfont;if(e.classed("bartext-inside")){var n=c(t,a);i=l(a,t.i,r,n)}else e.classed("bartext-outside")&&(i=s(a,t.i,r));return i}function n(e,t,a){return d(f,e.textfont,t,a)}function l(e,t,a,o){var r=n(e,t,a),i=void 0===e._input.textfont||void 0===e._input.textfont.color||Array.isArray(e.textfont.color)&&void 0===e.textfont.color[t];return i&&(r={color:u.contrast(o),family:r.family,size:r.size}),d(x,e.insidetextfont,t,r)}function s(e,t,a){var o=n(e,t,a);return d(b,e.outsidetextfont,t,o)}function d(e,t,a,o){t=t||{};var r=_.getValue(t.family,a),i=_.getValue(t.size,a),n=_.getValue(t.color,a);return{family:_.coerceString(e.family,r,o.family),size:_.coerceNumber(e.size,i,o.size),color:_.coerceColor(e.color,n,o.color)}}function c(e,t){return e.mc||t.marker.color}var p=e("d3"),u=e("../../components/color"),g=e("../../components/drawing"),h=e("../../lib"),m=e("../../registry"),y=e("./attributes"),f=y.textfont,x=y.insidetextfont,b=y.outsidetextfont,_=e("./helpers");t.exports={style:function(e,t){var o=t?t[0].node3:p.select(e).selectAll("g.trace.bars"),r=o.size(),i=e._fullLayout;o.style("opacity",function(e){return e[0].trace.opacity}).each(function(e){("stack"===i.barmode&&1<r||0===i.bargap&&0===i.bargroupgap&&!e[0].trace.marker.line.width)&&p.select(this).attr("shape-rendering","crispEdges")}),o.selectAll("g.points").each(function(t){var o=p.select(this),r=t[0].trace;a(o,r,e)}),m.getComponentMethod("errorbars","style")(o)},styleOnSelect:function(e,t){var r=t[0].node3,i=t[0].trace;i.selectedpoints?o(r,i,e):a(r,i,e)},getInsideTextFont:l,getOutsideTextFont:s,getBarColor:c}},{"../../components/color":569,"../../components/drawing":590,"../../lib":692,"../../registry":823,"./attributes":833,"./helpers":838,d3:148}],847:[function(e,t){"use strict";var a=e("../../components/color"),o=e("../../components/colorscale/helpers").hasColorscale,r=e("../../components/colorscale/defaults");t.exports=function(e,t,i,n,l){i("marker.color",n),o(e,"marker")&&r(e,t,l,i,{prefix:"marker.",cLetter:"c"}),i("marker.line.color",a.defaultLine),o(e,"marker.line")&&r(e,t,l,i,{prefix:"marker.line.",cLetter:"c"}),i("marker.line.width"),i("marker.opacity"),i("selected.marker.color"),i("unselected.marker.color")}},{"../../components/color":569,"../../components/colorscale/defaults":579,"../../components/colorscale/helpers":580}],848:[function(e,t){"use strict";var a=e("../../lib/extend").extendFlat,o=e("../scatterpolar/attributes"),r=e("../bar/attributes");t.exports={r:o.r,theta:o.theta,r0:o.r0,dr:o.dr,theta0:o.theta0,dtheta:o.dtheta,thetaunit:o.thetaunit,base:a({},r.base,{}),offset:a({},r.offset,{}),width:a({},r.width,{}),text:a({},r.text,{}),marker:r.marker,hoverinfo:o.hoverinfo,selected:r.selected,unselected:r.unselected}},{"../../lib/extend":682,"../bar/attributes":833,"../scatterpolar/attributes":1102}],849:[function(e,t){"use strict";var a=e("../../components/colorscale/helpers").hasColorscale,o=e("../../components/colorscale/calc"),r=e("../bar/arrays_to_calcdata"),n=e("../bar/cross_trace_calc").setGroupPositions,l=e("../scatter/calc_selection"),s=e("../../registry").traceIs,d=e("../../lib").extendFlat;t.exports={calc:function(e,t){function n(e){var a=t[e];void 0!==a&&(t["_"+e]=Array.isArray(a)?p.makeCalcdata(t,e):p.d2c(a,t.thetaunit))}for(var s=e._fullLayout,d=t.subplot,c=s[d].radialaxis,p=s[d].angularaxis,u=c.makeCalcdata(t,"r"),g=p.makeCalcdata(t,"theta"),h=t._length,m=Array(h),y=0;y<h;y++)m[y]={p:g[y],s:u[y]};return"linear"===p.type&&(n("width"),n("offset")),a(t,"marker")&&o(e,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"}),a(t,"marker.line")&&o(e,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"}),r(m,t),l(m,t),m},crossTraceCalc:function(e,t,a){for(var o=e.calcdata,r=[],l=0;l<o.length;l++){var c=o[l],p=c[0].trace;!0===p.visible&&s(p,"bar")&&p.subplot===a&&r.push(c)}var u=d({},t.radialaxis,{_id:"x"}),g=t.angularaxis;n({_fullLayout:t},g,u,r)}}},{"../../components/colorscale/calc":577,"../../components/colorscale/helpers":580,"../../lib":692,"../../registry":823,"../bar/arrays_to_calcdata":832,"../bar/cross_trace_calc":836,"../scatter/calc_selection":1042}],850:[function(e,t){"use strict";var a=e("../../lib"),o=e("../scatterpolar/defaults").handleRThetaDefaults,r=e("../bar/style_defaults"),i=e("./attributes");t.exports=function(e,t,n,l){function s(o,r){return a.coerce(e,t,i,o,r)}var d=o(e,t,l,s);return d?void(s("thetaunit"),s("base"),s("offset"),s("width"),s("text"),r(e,t,s,n,l),a.coerceSelectionMarkerOpacity(t,s)):void(t.visible=!1)}},{"../../lib":692,"../bar/style_defaults":847,"../scatterpolar/defaults":1104,"./attributes":848}],851:[function(e,t){"use strict";var a=e("../../components/fx"),o=e("../../lib"),r=e("../bar/hover").getTraceColor,i=e("../scatter/fill_hover_text"),n=e("../scatterpolar/hover").makeHoverPointText,l=e("../../plots/polar/helpers").isPtInsidePolygon;t.exports=function(e,t,s){var d=e.cd,c=d[0].trace,p=e.subplot,u=p.radialAxis,g=p.angularAxis,h=p.vangles,m=h?l:o.isPtInsideSector,y=e.maxHoverDistance,f=g._period||2*Sa,x=wa(u.g2p(re(t*t+s*s))),b=L(s,t);u.range[0]>u.range[1]&&(b+=Sa);var _=function(e){return m(x,b,[e.rp0,e.rp1],[e.thetag0,e.thetag1],h)?y+ie(1,wa(e.thetag1-e.thetag0)/f)-1+(e.rp1-x)/(e.rp1-e.rp0)-1:1/0};if(a.getClosest(d,_,e),!1!==e.index){var v=e.index,w=d[v];e.x0=e.x1=w.ct[0],e.y0=e.y1=w.ct[1];var k=o.extendFlat({},w,{r:w.s,theta:w.p});return i(w,c,e),n(k,c,p,e),e.color=r(c,w),e.xLabelVal=e.yLabelVal=void 0,0>w.s&&(e.idealAlign="left"),[e]}}},{"../../components/fx":608,"../../lib":692,"../../plots/polar/helpers":806,"../bar/hover":839,"../scatter/fill_hover_text":1048,"../scatterpolar/hover":1105}],852:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"barpolar",basePlotModule:e("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc").calc,crossTraceCalc:e("./calc").crossTraceCalc,plot:e("./plot"),colorbar:e("../scatter/marker_colorbar"),style:e("../bar/style").style,hoverPoints:e("./hover"),selectPoints:e("../bar/select"),meta:{}}},{"../../plots/polar":807,"../bar/select":844,"../bar/style":846,"../scatter/marker_colorbar":1058,"./attributes":848,"./calc":849,"./defaults":850,"./hover":851,"./layout_attributes":853,"./layout_defaults":854,"./plot":855}],853:[function(e,t){"use strict";t.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],854:[function(e,t){"use strict";var a=e("../../lib"),o=e("./layout_attributes");t.exports=function(e,t,r){function n(r,i){return a.coerce(e[d]||{},t[d],o,r,i)}for(var l={},s=0,d,c;s<r.length;s++)c=r[s],"barpolar"===c.type&&!0===c.visible&&(d=c.subplot,!l[d]&&(n("barmode"),n("bargap"),l[d]=1))}},{"../../lib":692,"./layout_attributes":853}],855:[function(e,t){"use strict";function a(e){var t=e.cxx,a=e.cyy;return e.vangles?function(o,r,n,s){var d,c;0<i.angleDelta(n,s)?(d=n,c=s):(d=s,c=n);var p=l.findEnclosingVertexAngles(d,e.vangles)[0],u=l.findEnclosingVertexAngles(c,e.vangles)[1],g=[p,(d+c)/2,u];return l.pathPolygonAnnulus(o,r,d,c,g,t,a)}:function(e,o,r,n){return i.pathAnnulus(e,o,r,n,t,a)}}var o=e("d3"),r=e("fast-isnumeric"),i=e("../../lib"),n=e("../../components/drawing"),l=e("../../plots/polar/helpers");t.exports=function(e,t,l){var s=t.xaxis,d=t.yaxis,c=t.radialAxis,p=t.angularAxis,u=a(t),g=t.layers.frontplot.select("g.barlayer");i.makeTraceGroups(g,l,"trace bars").each(function(a){var l=a[0].node3=o.select(this),g=i.ensureSingle(l,"g","points"),h=g.selectAll("g.point").data(i.identity);h.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),h.exit().remove(),h.each(function(e){var t=o.select(this),a=e.rp0=c.c2p(e.s0),n=e.rp1=c.c2p(e.s1),l=e.thetag0=p.c2g(e.p0),g=e.thetag1=p.c2g(e.p1),h;if(!r(a)||!r(n)||!r(l)||!r(g)||a===n||l===g)h="M0,0Z";else{var m=c.c2g(e.s1),y=(l+g)/2;e.ct=[s.c2p(m*te(y)),d.c2p(m*M(y))],h=u(a,n,l,g)}i.ensureSingle(t,"path").attr("d",h)}),n.setClipUrl(l,t._hasClipOnAxisFalse?t.clipIds.forTraces:null,e)})}},{"../../components/drawing":590,"../../lib":692,"../../plots/polar/helpers":806,d3:148,"fast-isnumeric":214}],856:[function(e,t){"use strict";var a=e("../scatter/attributes"),o=e("../../components/color/attributes"),r=e("../../lib/extend").extendFlat,i=a.marker,n=i.line;t.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},name:{valType:"string",editType:"calc+clearAxisTypes"},text:r({},a.text,{}),whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],dflt:"outliers",editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],dflt:!1,editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:r({},i.symbol,{arrayOk:!1,editType:"plot"}),opacity:r({},i.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:r({},i.size,{arrayOk:!1,editType:"calc"}),color:r({},i.color,{arrayOk:!1,editType:"style"}),line:{color:r({},n.color,{arrayOk:!1,dflt:o.defaultLine,editType:"style"}),width:r({},n.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:a.fillcolor,selected:{marker:a.selected.marker,editType:"style"},unselected:{marker:a.unselected.marker,editType:"style"},hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":568,"../../lib/extend":682,"../scatter/attributes":1040}],857:[function(e,t){"use strict";function a(e,t,a,o,r){if(t in e)return a.makeCalcdata(e,t);var i=t+"0"in e?e[t+"0"]:"name"in e&&("category"===a.type||p(e.name)&&-1!==["linear","log"].indexOf(a.type)||u.isDateTime(e.name)&&"date"===a.type)?e.name:r;var n="multicategory"===a.type?a.r2c_just_indices(i):a.d2c(i,0,e[t+"calendar"]);return o.map(function(){return n})}function o(e,t){for(var a=e.length,o=Array(a+1),r=0;r<a;r++)o[r]=e[r]-t;return o[a]=e[a-1]+t,o}function r(e){for(var t=Array(e),a=0;a<e;a++)t[a]=[];return t}function l(e,t,a){var o={text:"tx"};for(var r in o)Array.isArray(t[r])&&(e[o[r]]=t[r][a])}function s(e,t){if(u.isArrayOrTypedArray(t.selectedpoints))for(var a=0;a<e.length;a++){for(var o=e[a].pts||[],r={},n=0;n<o.length;n++)r[o[n].i]=n;u.tagSelected(o,t,r)}}function d(e,t){return e.v-t.v}function c(e){return e.v}var p=e("fast-isnumeric"),u=e("../../lib"),g=u._,h=e("../../plots/cartesian/axes");t.exports=function(e,t){var m=e._fullLayout,y=h.getFromId(e,t.xaxis||"x"),f=h.getFromId(e,t.yaxis||"y"),x=[],b="violin"===t.type?"_numViolins":"_numBoxes",_,w,k,T,A;"h"===t.orientation?(w=y,k="x",T=f,A="y"):(w=f,k="y",T=y,A="x");var S=w.makeCalcdata(t,k),C=a(t,A,T,S,m[b]),L=u.distinctVals(C),E=L.vals,z=L.minDiff/2,I=o(E,z),D=E.length,P=r(D);for(_=0;_<t._length;_++){var O=S[_];if(p(O)){var v=u.findBin(C[_],I);if(0<=v&&v<D){var n={v:O,i:_};l(n,t,_),P[v].push(n)}}}for(_=0;_<D;_++)if(0<P[_].length){var R=P[_].sort(d),M=R.map(c),j=M.length,B={pos:E[_],pts:R};B.min=M[0],B.max=M[j-1],B.mean=u.mean(M,j),B.sd=u.stdev(M,j,B.mean),B.q1=u.interp(M,.25),B.med=u.interp(M,.5),B.q3=u.interp(M,.75),B.lf=ie(B.q1,M[ie(u.findBin(2.5*B.q1-1.5*B.q3,M,!0)+1,j-1)]),B.uf=va(B.q3,M[va(u.findBin(2.5*B.q3-1.5*B.q1,M),0)]),B.lo=4*B.q1-3*B.q3,B.uo=4*B.q3-3*B.q1;var F=B.q3-B.q1,N=1.57*F/re(j);B.ln=B.med-N,B.un=B.med+N,x.push(B)}s(x,t);var V=h.findExtremes(w,S,{padded:!0});return t._extremes[w._id]=V,0<x.length?(x[0].t={num:m[b],dPos:z,posLetter:A,valLetter:k,labels:{med:g(e,"median:"),min:g(e,"min:"),q1:g(e,"q1:"),q3:g(e,"q3:"),max:g(e,"max:"),mean:"sd"===t.boxmean?g(e,"mean \xB1 \u03C3:"):g(e,"mean:"),lf:g(e,"lower fence:"),uf:g(e,"upper fence:")}},m[b]++,x):[{t:{empty:!0}}]}},{"../../lib":692,"../../plots/cartesian/axes":740,"fast-isnumeric":214}],858:[function(e,t){"use strict";function a(e,t,a,n,l){var s=t.calcdata,d=t._fullLayout,c=[],p="violin"===e?"_numViolins":"_numBoxes",u,g,h;for(u=0;u<a.length;u++)for(h=s[a[u]],g=0;g<h.length;g++)c.push(h[g].pos);if(c.length){var m=r.distinctVals(c),y=m.minDiff/2;c.length===m.vals.length&&(d[p]=1),o.minDtick(n,m.minDiff,m.vals[0],!0);var f=d[e+"gap"],x=d[e+"groupgap"],b=(1-f)*(1-x)*y/d[p],_=o.findExtremes(n,m.vals,{vpadminus:y+l[0]*b,vpadplus:y+l[1]*b});for(u=0;u<a.length;u++)h=s[a[u]],h[0].t.dPos=y,h[0].trace._extremes[n._id]=_}}var o=e("../../plots/cartesian/axes"),r=e("../../lib"),n=["v","h"];t.exports={crossTraceCalc:function(e,o){for(var r=e.calcdata,l=o.xaxis,s=o.yaxis,d=0;d<n.length;d++){for(var c=n[d],p="h"===c?s:l,u=[],g=0,h=0,m=0;m<r.length;m++){var y=r[m],f=y[0].t,t=y[0].trace;!0!==t.visible||"box"!==t.type&&"candlestick"!==t.type||f.empty||(t.orientation||"v")!==c||t.xaxis!==l._id||t.yaxis!==s._id||(u.push(m),t.boxpoints&&(g=va(g,t.jitter-t.pointpos-1),h=va(h,t.jitter+t.pointpos-1)))}a("box",e,u,p,[g,h])}},setPositionOffset:a}},{"../../lib":692,"../../plots/cartesian/axes":740}],859:[function(e,t){"use strict";function a(e,t,a,o){var n=a("y"),l=a("x"),s=l&&l.length,d,c;if(n&&n.length)d="v",s?c=ie(r.minRowLength(l),r.minRowLength(n)):(a("x0"),c=r.minRowLength(n));else if(s)d="h",a("y0"),c=r.minRowLength(l);else return void(t.visible=!1);t._length=c;var p=i.getComponentMethod("calendars","handleTraceDefaults");p(e,t,["x","y"],o),a("orientation",d)}function o(e,t,a,o){var i=o.prefix,n=r.coerce2(e,t,l,"marker.outliercolor"),s=a("marker.line.outliercolor"),d=a(i+"points",n||s?"suspectedoutliers":void 0);d?(a("jitter","all"===d?.3:0),a("pointpos","all"===d?-1.5:0),a("marker.symbol"),a("marker.opacity"),a("marker.size"),a("marker.color",t.line.color),a("marker.line.color"),a("marker.line.width"),"suspectedoutliers"===d&&(a("marker.line.outliercolor",t.marker.color),a("marker.line.outlierwidth")),a("selected.marker.color"),a("unselected.marker.color"),a("selected.marker.size"),a("unselected.marker.size"),a("text")):delete t.marker,a("hoveron"),r.coerceSelectionMarkerOpacity(t,a)}var r=e("../../lib"),i=e("../../registry"),n=e("../../components/color"),l=e("./attributes");t.exports={supplyDefaults:function(e,t,i,s){function d(a,o){return r.coerce(e,t,l,a,o)}if(a(e,t,d,s),!1!==t.visible){d("line.color",(e.marker||{}).color||i),d("line.width"),d("fillcolor",n.addOpacity(t.line.color,.5)),d("whiskerwidth"),d("boxmean");var c=d("notched",void 0!==e.notchwidth);c&&d("notchwidth"),o(e,t,d,{prefix:"box"})}},handleSampleDefaults:a,handlePointsDefaults:o}},{"../../components/color":569,"../../lib":692,"../../registry":823,"./attributes":856}],860:[function(e,t){"use strict";t.exports=function(e,t){return t.hoverOnBox&&(e.hoverOnBox=t.hoverOnBox),"xVal"in t&&(e.x=t.xVal),"yVal"in t&&(e.y=t.yVal),t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),e}},{}],861:[function(e,t){"use strict";function a(e,a,o,d){function c(e){return(S(e)+C(e))/2}var p=e.cd,u=e.xa,g=e.ya,h=p[0].trace,m=p[0].t,t="violin"===h.type,y=[],f=m.bdPos,x=m.wHover,b=function(e){return e.pos+m.bPos-A},_,v,w,k,T,A,S,C,L,E,z;t&&"both"!==h.side?("positive"===h.side&&(L=function(e){var t=b(e);return l.inbox(t,t+x,E)}),"negative"===h.side&&(L=function(e){var t=b(e);return l.inbox(t-x,t,E)})):L=function(e){var t=b(e);return l.inbox(t-x,t+x,E)};var I;I=t?function(e){return l.inbox(e.span[0]-T,e.span[1]-T,E)}:function(e){return l.inbox(e.min-T,e.max-T,E)},"h"===h.orientation?(T=a,A=o,S=I,C=L,_="y",w=g,v="x",k=u):(T=o,A=a,S=L,C=I,_="x",w=u,v="y",k=g);var D=ie(1,f/wa(w.r2c(w.range[1])-w.r2c(w.range[0])));E=e.maxHoverDistance-D,z=e.maxSpikeDistance-D;var P=l.getDistanceFunction(d,S,C,c);if(l.getClosest(p,P,e),!1===e.index)return[];var O=p[e.index],R=h.line.color,M=(h.marker||{}).color;e.color=s.opacity(R)&&h.line.width?R:s.opacity(M)&&h.boxpoints?M:h.fillcolor,e[_+"0"]=w.c2p(O.pos+m.bPos-f,!0),e[_+"1"]=w.c2p(O.pos+m.bPos+f,!0),e[_+"LabelVal"]=O.pos;var j=_+"Spike";e.spikeDistance=c(O)*z/E,e[j]=w.c2p(O.pos,!0);var B={},F=["med","min","q1","q3","max"];(h.boxmean||(h.meanline||{}).visible)&&F.push("mean"),(h.boxpoints||h.points)&&F.push("lf","uf");for(var N=0,V;N<F.length;N++)if(V=F[N],V in O&&!(O[V]in B)){B[O[V]]=!0;var U=O[V],H=k.c2p(U,!0),G=n.extendFlat({},e);G[v+"0"]=G[v+"1"]=H,G[v+"LabelVal"]=U,G[v+"Label"]=(m.labels?m.labels[V]+" ":"")+r.hoverLabelText(k,U),G.hoverOnBox=!0,"mean"===V&&"sd"in O&&"sd"===h.boxmean&&(G[v+"err"]=O.sd),e.name="",e.spikeDistance=void 0,e[j]=void 0,y.push(G)}return y}function o(e,t,a){for(var o=e.cd,r=e.xa,s=e.ya,c=o[0].trace,p=r.c2p(t),u=s.c2p(a),g=function(e){var t=va(3,e.mrc||0);return va(wa(r.c2p(e.x)-p)-t,1-3/t)},h=function(e){var t=va(3,e.mrc||0);return va(wa(s.c2p(e.y)-u)-t,1-3/t)},m=l.quadrature(g,h),y=!1,f=0,x,b,_;f<o.length;f++){b=o[f];for(var v=0;v<(b.pts||[]).length;v++){_=b.pts[v];var w=m(_);w<=e.distance&&(e.distance=w,y=[f,v])}}if(!y)return!1;b=o[y[0]],_=b.pts[y[1]];var k=r.c2p(_.x,!0),T=s.c2p(_.y,!0),A=_.mrc||1;x=n.extendFlat({},e,{index:_.i,color:(c.marker||{}).color,name:c.name,x0:k-A,x1:k+A,xLabelVal:_.x,y0:T-A,y1:T+A,yLabelVal:_.y,spikeDistance:e.distance});var S="h"===c.orientation?"y":"x",C="h"===c.orientation?s:r;return x[S+"Spike"]=C.c2p(b.pos,!0),d(_,c,x),x}var r=e("../../plots/cartesian/axes"),n=e("../../lib"),l=e("../../components/fx"),s=e("../../components/color"),d=e("../scatter/fill_hover_text");t.exports={hoverPoints:function(e,t,r,i){var n=e.cd,l=n[0].trace,s=l.hoveron,d=[],c;return-1!==s.indexOf("boxes")&&(d=d.concat(a(e,t,r,i))),-1!==s.indexOf("points")&&(c=o(e,t,r)),"closest"===i?c?[c]:d:c?(d.push(c),d):d},hoverOnBoxes:a,hoverOnPoints:o}},{"../../components/color":569,"../../components/fx":608,"../../lib":692,"../../plots/cartesian/axes":740,"../scatter/fill_hover_text":1048}],862:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.layoutAttributes=e("./layout_attributes"),a.supplyDefaults=e("./defaults").supplyDefaults,a.supplyLayoutDefaults=e("./layout_defaults").supplyLayoutDefaults,a.calc=e("./calc"),a.crossTraceCalc=e("./cross_trace_calc").crossTraceCalc,a.plot=e("./plot").plot,a.style=e("./style").style,a.styleOnSelect=e("./style").styleOnSelect,a.hoverPoints=e("./hover").hoverPoints,a.eventData=e("./event_data"),a.selectPoints=e("./select"),a.moduleType="trace",a.name="box",a.basePlotModule=e("../../plots/cartesian"),a.categories=["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],a.meta={},t.exports=a},{"../../plots/cartesian":752,"./attributes":856,"./calc":857,"./cross_trace_calc":858,"./defaults":859,"./event_data":860,"./hover":861,"./layout_attributes":863,"./layout_defaults":864,"./plot":865,"./select":866,"./style":867}],863:[function(e,t){"use strict";t.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],864:[function(e,t){"use strict";function a(e,t,a,r,n){for(var l=0,s;l<a.length;l++)if(o.traceIs(a[l],n+"Layout")){s=!0;break}s&&(r(n+"mode"),r(n+"gap"),r(n+"groupgap"))}var o=e("../../registry"),r=e("../../lib"),i=e("./layout_attributes");t.exports={supplyLayoutDefaults:function(e,t,o){a(e,t,o,function(a,o){return r.coerce(e,t,i,a,o)},"box")},_supply:a}},{"../../lib":692,"../../registry":823,"./layout_attributes":863}],865:[function(e,t){"use strict";function a(e,a,o,r){var t=a.pos,l=a.val,s=r.bPos,c=r.wdPos||0,p=r.bPosPxOffset||0,u=o.whiskerwidth||0,g=o.notched||!1,h=g?1-2*o.notchwidth:1,y,f;Array.isArray(r.bdPos)?(y=r.bdPos[0],f=r.bdPos[1]):(y=r.bdPos,f=r.bdPos);var x=e.selectAll("path.box").data("violin"!==o.type||o.box.visible?n.identity:[]);x.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),x.exit().remove(),x.each(function(e){var a=e.pos,r=t.c2p(a+s,!0)+p,d=t.c2p(a+s-y,!0)+p,x=t.c2p(a+s+f,!0)+p,b=t.c2p(a+s-c,!0)+p,_=t.c2p(a+s+c,!0)+p,v=t.c2p(a+s-y*h,!0)+p,w=t.c2p(a+s+f*h,!0)+p,k=l.c2p(e.q1,!0),T=l.c2p(e.q3,!0),A=n.constrain(l.c2p(e.med,!0),ie(k,T)+1,va(k,T)-1),m=e.lf===void 0||!1===o.boxpoints,S=l.c2p(m?e.min:e.lf,!0),C=l.c2p(m?e.max:e.uf,!0),L=l.c2p(e.ln,!0),E=l.c2p(e.un,!0);"h"===o.orientation?i.select(this).attr("d","M"+A+","+v+"V"+w+"M"+k+","+d+"V"+x+(g?"H"+L+"L"+A+","+w+"L"+E+","+x:"")+"H"+T+"V"+d+(g?"H"+E+"L"+A+","+v+"L"+L+","+d:"")+"ZM"+k+","+r+"H"+S+"M"+T+","+r+"H"+C+(0===u?"":"M"+S+","+b+"V"+_+"M"+C+","+b+"V"+_)):i.select(this).attr("d","M"+v+","+A+"H"+w+"M"+d+","+k+"H"+x+(g?"V"+L+"L"+w+","+A+"L"+x+","+E:"")+"V"+T+"H"+d+(g?"V"+E+"L"+v+","+A+"L"+d+","+L:"")+"ZM"+r+","+k+"V"+S+"M"+r+","+T+"V"+C+(0===u?"":"M"+b+","+S+"H"+_+"M"+b+","+C+"H"+_))})}function o(e,a,o,r){var t=a.x,i=a.y,c=r.bdPos,p=r.bPos,u=o.boxpoints||o.points;n.seedPseudoRandom();var g=e.selectAll("g.points").data(u?function(e){return e.forEach(function(e){e.t=r,e.trace=o}),e}:[]);g.enter().append("g").attr("class","points"),g.exit().remove();var h=g.selectAll("path").data(function(e){var t="all"===u?e.pts:e.pts.filter(function(t){return t.v<e.lf||t.v>e.uf}),a=va((e.max-e.min)/10,e.q3-e.q1),r=[],l=0,d,g;if(o.jitter){if(0===a)for(l=1,r=Array(t.length),d=0;d<t.length;d++)r[d]=1;else for(d=0;d<t.length;d++){var h=va(0,d-5),m=t[h].v,y=ie(t.length-1,d+5),f=t[y].v;"all"!==u&&(t[d].v<e.lf?f=ie(f,e.lf):m=va(m,e.uf));var x=re(a*s*(y-h)/(f-m+1e-9*a))||0;x=n.constrain(wa(x),0,1),r.push(x),l=va(x,l)}g=2*o.jitter/(l||1)}for(d=0;d<t.length;d++){var b=t[d],_=b.v,v=o.jitter?g*r[d]*(n.pseudoRandom()-.5):0,w=e.pos+p+c*(o.pointpos+v);"h"===o.orientation?(b.y=w,b.x=_):(b.x=w,b.y=_),"suspectedoutliers"===u&&_<e.uo&&_>e.lo&&(b.so=!0)}return t});h.enter().append("path").classed("point",!0),h.exit().remove(),h.call(l.translatePoints,t,i)}function r(e,a,o,r){var t=a.pos,l=a.val,s=r.bPos,c=r.bPosPxOffset||0,p=o.boxmean||(o.meanline||{}).visible,u,g;Array.isArray(r.bdPos)?(u=r.bdPos[0],g=r.bdPos[1]):(u=r.bdPos,g=r.bdPos);var h=e.selectAll("path.mean").data("box"===o.type&&o.boxmean||"violin"===o.type&&o.box.visible&&o.meanline.visible?n.identity:[]);h.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),h.exit().remove(),h.each(function(e){var a=t.c2p(e.pos+s,!0)+c,r=t.c2p(e.pos+s-u,!0)+c,n=t.c2p(e.pos+s+g,!0)+c,d=l.c2p(e.mean,!0),h=l.c2p(e.mean-e.sd,!0),m=l.c2p(e.mean+e.sd,!0);"h"===o.orientation?i.select(this).attr("d","M"+d+","+r+"V"+n+("sd"===p?"m0,0L"+h+","+a+"L"+d+","+r+"L"+m+","+a+"Z":"")):i.select(this).attr("d","M"+r+","+d+"H"+n+("sd"===p?"m0,0L"+a+","+h+"L"+r+","+d+"L"+a+","+m+"Z":""))})}var i=e("d3"),n=e("../../lib"),l=e("../../components/drawing"),s=.01;t.exports={plot:function(e,l,s,d){var c=e._fullLayout,p=l.xaxis,u=l.yaxis,g=c._numBoxes,h=1-c.boxgap,m="group"===c.boxmode&&1<g;n.makeTraceGroups(d,s,"trace boxes").each(function(e){var n=i.select(this),s=e[0],d=s.t,t=s.trace;l.isRangePlot||(s.node3=n);var y=d.dPos*h*(1-c.boxgroupgap)/(m?g:1),f=m?2*d.dPos*(-.5+(d.num+.5)/g)*h:0,x=y*t.whiskerwidth;if(!0!==t.visible||d.empty)return void n.remove();var b,_;"h"===t.orientation?(b=u,_=p):(b=p,_=u),d.bPos=f,d.bdPos=y,d.wdPos=x,d.wHover=d.dPos*(m?h/g:1),a(n,{pos:b,val:_},t,d),o(n,{x:p,y:u},t,d),r(n,{pos:b,val:_},t,d)})},plotBoxAndWhiskers:a,plotPoints:o,plotBoxMean:r}},{"../../components/drawing":590,"../../lib":692,d3:148}],866:[function(e,t){"use strict";t.exports=function(e,t){var a=e.cd,o=e.xaxis,r=e.yaxis,n=[],l,s;if(!1===t)for(l=0;l<a.length;l++)for(s=0;s<(a[l].pts||[]).length;s++)a[l].pts[s].selected=0;else for(l=0;l<a.length;l++)for(s=0;s<(a[l].pts||[]).length;s++){var d=a[l].pts[s],c=o.c2p(d.x),p=r.c2p(d.y);t.contains([c,p],null,d.i,e)?(n.push({pointNumber:d.i,x:o.c2d(d.x),y:r.c2d(d.y)}),d.selected=1):d.selected=0}return n}},{}],867:[function(e,t){"use strict";var a=e("d3"),o=e("../../components/color"),r=e("../../components/drawing");t.exports={style:function(e,t){var i=t?t[0].node3:a.select(e).selectAll("g.trace.boxes");i.style("opacity",function(e){return e[0].trace.opacity}),i.each(function(t){function i(e,t,a,r){e.style("stroke-width",t+"px").call(o.stroke,a).call(o.fill,r)}var n=a.select(this),l=t[0].trace,s=l.line.width,d=n.selectAll("path.box");if("candlestick"===l.type)d.each(function(e){var t=a.select(this),o=l[e.dir];i(t,o.line.width,o.line.color,o.fillcolor),t.style("opacity",l.selectedpoints&&!e.selected?.3:1)});else{i(d,s,l.line.color,l.fillcolor),n.selectAll("path.mean").style({"stroke-width":s,"stroke-dasharray":2*s+"px,"+s+"px"}).call(o.stroke,l.line.color);var c=n.selectAll("path.point");r.pointStyle(c,l,e)}})},styleOnSelect:function(e,t){var a=t[0].node3,o=t[0].trace,i=a.selectAll("path.point");o.selectedpoints?r.selectedPointStyle(i,o):r.pointStyle(i,o,e)}}},{"../../components/color":569,"../../components/drawing":590,d3:148}],868:[function(e,t){"use strict";function a(e){return{line:{color:o({},i.line.color,{dflt:e}),width:i.line.width,editType:"style"},fillcolor:i.fillcolor,editType:"style"}}var o=e("../../lib").extendFlat,r=e("../ohlc/attributes"),i=e("../box/attributes");t.exports={x:r.x,open:r.open,high:r.high,low:r.low,close:r.close,line:{width:o({},i.line.width,{}),editType:"style"},increasing:a(r.increasing.line.color.dflt),decreasing:a(r.decreasing.line.color.dflt),text:r.text,whiskerwidth:o({},i.whiskerwidth,{dflt:0}),hoverlabel:r.hoverlabel}},{"../../lib":692,"../box/attributes":856,"../ohlc/attributes":988}],869:[function(e,t){"use strict";function a(e,t,a,o){return{min:a,q1:ie(e,o),med:o,q3:va(e,o),max:t}}var o=e("../../lib"),r=e("../../plots/cartesian/axes"),i=e("../ohlc/calc").calcCommon;t.exports=function(e,t){var n=e._fullLayout,l=r.getFromId(e,t.xaxis),s=r.getFromId(e,t.yaxis),d=l.makeCalcdata(t,"x"),c=i(e,t,d,s,a);return c.length?(o.extendFlat(c[0].t,{num:n._numBoxes,dPos:o.distinctVals(d).minDiff/2,posLetter:"x",valLetter:"y"}),n._numBoxes++,c):[{t:{empty:!0}}]}},{"../../lib":692,"../../plots/cartesian/axes":740,"../ohlc/calc":989}],870:[function(e,t){"use strict";function a(e,t,a,o){var i=a(o+".line.color");a(o+".line.width",t.line.width),a(o+".fillcolor",r.addOpacity(i,.5))}var o=e("../../lib"),r=e("../../components/color"),i=e("../ohlc/ohlc_defaults"),n=e("./attributes");t.exports=function(e,t,r,l){function s(a,r){return o.coerce(e,t,n,a,r)}var d=i(e,t,s,l);return d?void(s("line.width"),a(e,t,s,"increasing"),a(e,t,s,"decreasing"),s("text"),s("whiskerwidth"),l._requestRangeslider[t.xaxis]=!0):void(t.visible=!1)}},{"../../components/color":569,"../../lib":692,"../ohlc/ohlc_defaults":993,"./attributes":868}],871:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"candlestick",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:e("./attributes"),layoutAttributes:e("../box/layout_attributes"),supplyLayoutDefaults:e("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:e("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:e("./defaults"),calc:e("./calc"),plot:e("../box/plot").plot,layerName:"boxlayer",style:e("../box/style").style,hoverPoints:e("../ohlc/hover").hoverPoints,selectPoints:e("../ohlc/select")}},{"../../plots/cartesian":752,"../box/cross_trace_calc":858,"../box/layout_attributes":863,"../box/layout_defaults":864,"../box/plot":865,"../box/style":867,"../ohlc/hover":991,"../ohlc/select":995,"./attributes":868,"./calc":869,"./defaults":870}],872:[function(e,t){"use strict";function o(e,t,a,o){["aaxis","baxis"].forEach(function(n){var l=n.charAt(0),s=e[n]||{},d=i.newContainer(t,n),c={tickfont:"x",id:l+"axis",letter:l,font:t.font,name:n,data:e[l],calendar:t.calendar,dfltColor:o,bgColor:a.paper_bgcolor,fullLayout:a};r(s,d,c),d._categories=d._categories||[],e[n]||"-"===s.type||(e[n]={type:s.type})})}var r=e("./axis_defaults"),i=e("../../plot_api/plot_template");t.exports=function(e,t,r,i,n){var l=i("a");l||(i("da"),i("a0"));var a=i("b");a||(i("db"),i("b0")),o(e,t,r,n)}},{"../../plot_api/plot_template":730,"./axis_defaults":877}],873:[function(e,t){"use strict";function o(e,t){if(!r(e)||10<=t)return null;for(var a=1/0,l=-Infinity,s=e.length,n=0,d;n<s;n++)if(d=e[n],r(d)){var c=o(d,t+1);c&&(a=ie(c[0],a),l=va(c[1],l))}else a=ie(d,a),l=va(d,l);return[a,l]}var r=e("../../lib").isArrayOrTypedArray;t.exports=function(e){return o(e,0)}},{"../../lib":692}],874:[function(e,t){"use strict";var a=e("../../plots/font_attributes"),o=e("./axis_attributes"),r=e("../../components/color/attributes"),i=a({editType:"calc"});i.family.dflt="\"Open Sans\", verdana, arial, sans-serif",i.size.dflt=12,i.color.dflt=r.defaultLine,t.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:o,baxis:o,font:i,color:{valType:"color",dflt:r.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":568,"../../plots/font_attributes":767,"./axis_attributes":876}],875:[function(e,t){"use strict";var o=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,r,a){var i=o(r)?"a":"b",l="a"===i?e.aaxis:e.baxis,s=l.smoothing,d="a"===i?e.a2i:e.b2j,c="a"===i?r:a,p="a"===i?a:r,u="a"===i?t.a.length:t.b.length,n="a"===i?t.b.length:t.a.length,g=ea("a"===i?e.b2j(p):e.a2i(p)),h="a"===i?function(t){return e.evalxy([],t,g)}:function(t){return e.evalxy([],g,t)},m,y,f,x,b,_,v,w,k,T,A,S,C;s&&(f=va(0,ie(n-2,g)),x=g-f,y="a"===i?function(t,a){return e.dxydi([],t,f,a,x)}:function(t,a){return e.dxydj([],f,t,x,a)});var L=d(c[0]),E=d(c[1]),z=L<E?1:-1,I=1e-8*(E-L),D=0<z?ea:ae,P=0<z?ae:ea,O=0<z?ie:va,R=0<z?va:ie,M=D(L+I),j=P(E-I);v=h(L);var B=[[v]];for(m=M;m*z<j*z;m+=z)b=[],A=R(L,m),S=O(E,m+z),C=S-A,_=va(0,ie(u-2,ea(.5*(A+S)))),w=h(S),s&&(k=y(_,A-_),T=y(_,S-_),b.push([v[0]+k[0]/3*C,v[1]+k[1]/3*C]),b.push([w[0]-T[0]/3*C,w[1]-T[1]/3*C])),b.push(w),B.push(b),v=w;return B}},{"../../lib":692}],876:[function(e,t){"use strict";var a=e("../../plots/font_attributes"),o=e("../../components/color/attributes"),r=e("../../plots/cartesian/layout_attributes"),i=e("../../plot_api/edit_types").overrideAll;t.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:a({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:a({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc"},tickformatstops:i(r.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:o.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:o.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:a({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":568,"../../plot_api/edit_types":723,"../../plots/cartesian/layout_attributes":753,"../../plots/font_attributes":767}],877:[function(e,t){"use strict";function a(e,t){if("-"===e.type){var a=e._id,o=a.charAt(0),r=e[o+"calendar"];e.type=p(t,r)}}var o=e("./attributes"),r=e("../../components/color").addOpacity,i=e("../../registry"),n=e("../../lib"),l=e("../../plots/cartesian/tick_value_defaults"),s=e("../../plots/cartesian/tick_label_defaults"),d=e("../../plots/cartesian/category_order_defaults"),c=e("../../plots/cartesian/set_convert"),p=e("../../plots/cartesian/axis_autotype");t.exports=function(e,t,p){function u(a,o){return n.coerce(e,t,y,a,o)}function g(a,o){return n.coerce2(e,t,y,a,o)}var h=p.letter,m=p.font||{},y=o[h+"axis"];p.name&&(t._name=p.name,t._id=p.name);var f=u("type");if("-"===f&&(p.data&&a(t,p.data),"-"===t.type?t.type="linear":f=e.type=t.type),u("smoothing"),u("cheatertype"),u("showticklabels"),u("labelprefix",h+" = "),u("labelsuffix"),u("showtickprefix"),u("showticksuffix"),u("separatethousands"),u("tickformat"),u("exponentformat"),u("showexponent"),u("categoryorder"),u("tickmode"),u("tickvals"),u("ticktext"),u("tick0"),u("dtick"),"array"===t.tickmode&&(u("arraytick0"),u("arraydtick")),u("labelpadding"),t._hovertitle=h,"date"===f){var x=i.getComponentMethod("calendars","handleDefaults");x(e,t,"calendar",p.calendar)}c(t,p.fullLayout),t.c2p=n.identity;var b=u("color",p.dfltColor),_=b===e.color?b:m.color,v=u("title.text");v&&(n.coerceFont(u,"title.font",{family:m.family,size:R(1.2*m.size),color:_}),u("title.offset")),u("tickangle");var w=u("autorange",!t.isValidRange(e.range));w&&u("rangemode"),u("range"),t.cleanRange(),u("fixedrange"),l(e,t,u,f),s(e,t,u,f,p),d(e,t,u,{data:p.data,dataAttr:h});var k=g("gridcolor",r(b,.3)),T=g("gridwidth"),A=u("showgrid");A||(delete t.gridcolor,delete t.gridwidth);var S=g("startlinecolor",b),C=g("startlinewidth",T),L=u("startline",t.showgrid||!!S||!!C);L||(delete t.startlinecolor,delete t.startlinewidth);var E=g("endlinecolor",b),z=g("endlinewidth",T),I=u("endline",t.showgrid||!!E||!!z);return I||(delete t.endlinecolor,delete t.endlinewidth),A?(u("minorgridcount"),u("minorgridwidth",T),u("minorgridcolor",r(k,.06)),!t.minorgridcount&&(delete t.minorgridwidth,delete t.minorgridcolor)):(delete t.gridcolor,delete t.gridWidth),"none"===t.showticklabels&&(delete t.tickfont,delete t.tickangle,delete t.showexponent,delete t.exponentformat,delete t.tickformat,delete t.showticksuffix,delete t.showtickprefix),t.showticksuffix||delete t.ticksuffix,t.showtickprefix||delete t.tickprefix,u("tickmode"),t}},{"../../components/color":569,"../../lib":692,"../../plots/cartesian/axis_autotype":741,"../../plots/cartesian/category_order_defaults":744,"../../plots/cartesian/set_convert":759,"../../plots/cartesian/tick_label_defaults":760,"../../plots/cartesian/tick_value_defaults":762,"../../registry":823,"./attributes":874}],878:[function(e,t){"use strict";var o=e("../../plots/cartesian/axes"),r=e("../../lib").isArray1D,i=e("./cheater_basis"),n=e("./array_minmax"),l=e("./calc_gridlines"),s=e("./calc_labels"),d=e("./calc_clippath"),c=e("../heatmap/clean_2d_array"),p=e("./smooth_fill_2d_array"),u=e("../heatmap/convert_column_xyz"),g=e("./set_convert");t.exports=function(e,h){var m=o.getFromId(e,h.xaxis),f=o.getFromId(e,h.yaxis),_=h.aaxis,v=h.baxis,w=h.x,k=h.y,T=[];w&&r(w)&&T.push("x"),k&&r(k)&&T.push("y"),T.length&&u(h,_,v,"a","b",T);var A=h._a=h._a||h.a,a=h._b=h._b||h.b;w=h._x||h.x,k=h._y||h.y;var b={};if(h._cheater){var t="index"===_.cheatertype?A.length:A,S="index"===v.cheatertype?a.length:a;w=i(t,S,h.cheaterslope)}h._x=w=c(w),h._y=k=c(k),p(w,A,a),p(k,A,a),g(h),h.setScale();var C=n(w),L=n(k),E=.5*(C[1]-C[0]),z=.5*(C[1]+C[0]),I=.5*(L[1]-L[0]),D=.5*(L[1]+L[0]),P=1.3;return C=[z-E*P,z+E*P],L=[D-I*P,D+I*P],h._extremes[m._id]=o.findExtremes(m,C,{padded:!0}),h._extremes[f._id]=o.findExtremes(f,L,{padded:!0}),l(h,"a","b"),l(h,"b","a"),s(h,_),s(h,v),b.clipsegments=d(h._xctrl,h._yctrl,_,v),b.x=w,b.y=k,b.a=A,b.b=a,[b]}},{"../../lib":692,"../../plots/cartesian/axes":740,"../heatmap/clean_2d_array":944,"../heatmap/convert_column_xyz":946,"./array_minmax":873,"./calc_clippath":879,"./calc_gridlines":880,"./calc_labels":881,"./cheater_basis":883,"./set_convert":896,"./smooth_fill_2d_array":897}],879:[function(e,t){"use strict";t.exports=function(e,t,a,o){var r=[],n=!!a.smoothing,l=!!o.smoothing,s=e[0].length-1,d=e.length-1,c,p,u;for(c=0,p=[],u=[];c<=s;c++)p[c]=e[0][c],u[c]=t[0][c];for(r.push({x:p,y:u,bicubic:n}),c=0,p=[],u=[];c<=d;c++)p[c]=e[c][s],u[c]=t[c][s];for(r.push({x:p,y:u,bicubic:l}),c=s,p=[],u=[];0<=c;c--)p[s-c]=e[d][c],u[s-c]=t[d][c];for(r.push({x:p,y:u,bicubic:n}),c=d,p=[],u=[];0<=c;c--)p[d-c]=e[c][0],u[d-c]=t[c][0];return r.push({x:p,y:u,bicubic:l}),r}},{}],880:[function(e,t){"use strict";var a=e("../../plots/cartesian/axes"),o=e("../../lib/extend").extendFlat;t.exports=function(e,t,r){function l(a){var o=[],n=[],l={},s,d,c,u,g,h,m,f,x,b,_,v;if("b"===t)for(d=e.b2j(a),c=ea(va(0,ie(B-2,d))),u=d-c,l.length=B,l.crossLength=M,l.xy=function(t){return e.evalxy([],t,d)},l.dxy=function(t,a){return e.dxydi([],t,c,a,u)},s=0;s<M;s++)h=ie(M-2,s),m=s-h,f=e.evalxy([],s,d),y.smoothing&&0<s&&(x=e.dxydi([],s-1,c,0,u),o.push(g[0]+x[0]/3),n.push(g[1]+x[1]/3),b=e.dxydi([],s-1,c,1,u),o.push(f[0]-b[0]/3),n.push(f[1]-b[1]/3)),o.push(f[0]),n.push(f[1]),g=f;else for(s=e.a2i(a),h=ea(va(0,ie(M-2,s))),m=s-h,l.length=M,l.crossLength=B,l.xy=function(t){return e.evalxy([],s,t)},l.dxy=function(t,a){return e.dxydj([],h,t,m,a)},d=0;d<B;d++)c=ie(B-2,d),u=d-c,f=e.evalxy([],s,d),y.smoothing&&0<d&&(_=e.dxydj([],h,d-1,m,0),o.push(g[0]+_[0]/3),n.push(g[1]+_[1]/3),v=e.dxydj([],h,d-1,m,1),o.push(f[0]-v[0]/3),n.push(f[1]-v[1]/3)),o.push(f[0]),n.push(f[1]),g=f;return l.axisLetter=t,l.axis=p,l.crossAxis=y,l.value=a,l.constvar=r,l.index=A,l.x=o,l.y=n,l.smoothing=y.smoothing,l}function s(a){var o=[],i=[],n={},l,s,d,u,g;if(n.length=c.length,n.crossLength=m.length,"b"===t)for(d=va(0,ie(B-2,a)),g=ie(1,va(0,a-d)),n.xy=function(t){return e.evalxy([],t,a)},n.dxy=function(t,a){return e.dxydi([],t,d,a,g)},l=0;l<O;l++)o[l]=D[a*F][l],i[l]=P[a*F][l];else for(s=va(0,ie(M-2,a)),u=ie(1,va(0,a-s)),n.xy=function(t){return e.evalxy([],a,t)},n.dxy=function(t,a){return e.dxydj([],s,t,u,a)},l=0;l<R;l++)o[l]=D[l][a*F],i[l]=P[l][a*F];return n.axisLetter=t,n.axis=p,n.crossAxis=y,n.value=c[a],n.constvar=r,n.index=a,n.x=o,n.y=i,n.smoothing=y.smoothing,n}var c=e["_"+t],p=e[t+"axis"],u=p._gridlines=[],g=p._minorgridlines=[],h=p._boundarylines=[],m=e["_"+r],y=e[r+"axis"],f,x,b,_,w,k,T,A,S,C,L,E,z,I;"array"===p.tickmode&&(p.tickvals=c.slice());var D=e._xctrl,P=e._yctrl,O=D[0].length,R=D.length,M=e._a.length,B=e._b.length;a.prepTicks(p),"array"===p.tickmode&&delete p.tickvals;var F=p.smoothing?3:1;if("array"===p.tickmode){for(_=5e-15,w=[ea((c.length-1-p.arraytick0)/p.arraydtick*(1+_)),ae(-p.arraytick0/p.arraydtick/(1+_))].sort(function(e,t){return e-t}),k=w[0]-1,T=w[1]+1,A=k;A<T;A++)x=p.arraytick0+p.arraydtick*A,0>x||x>c.length-1||u.push(o(s(x),{color:p.gridcolor,width:p.gridwidth}));for(A=k;A<T;A++)if(b=p.arraytick0+p.arraydtick*A,L=ie(b+p.arraydtick,c.length-1),!(0>b||b>c.length-1)&&!(0>L||L>c.length-1))for(E=c[b],z=c[L],f=0;f<p.minorgridcount;f++)I=L-b,0>=I||(C=E+(z-E)*(f+1)/(p.minorgridcount+1)*(p.arraydtick/I),!(C<c[0]||C>c[c.length-1])&&g.push(o(l(C),{color:p.minorgridcolor,width:p.minorgridwidth})));p.startline&&h.push(o(s(0),{color:p.startlinecolor,width:p.startlinewidth})),p.endline&&h.push(o(s(c.length-1),{color:p.endlinecolor,width:p.endlinewidth}))}else{for(_=5e-15,w=[ea((c[c.length-1]-p.tick0)/p.dtick*(1+_)),ae((c[0]-p.tick0)/p.dtick/(1+_))].sort(function(e,t){return e-t}),k=w[0],T=w[1],A=k;A<=T;A++)S=p.tick0+p.dtick*A,u.push(o(l(S),{color:p.gridcolor,width:p.gridwidth}));for(A=k-1;A<T+1;A++)for(S=p.tick0+p.dtick*A,f=0;f<p.minorgridcount;f++)C=S+p.dtick*(f+1)/(p.minorgridcount+1),C<c[0]||C>c[c.length-1]||g.push(o(l(C),{color:p.minorgridcolor,width:p.minorgridwidth}));p.startline&&h.push(o(l(c[0]),{color:p.startlinecolor,width:p.startlinewidth})),p.endline&&h.push(o(l(c[c.length-1]),{color:p.endlinecolor,width:p.endlinewidth}))}}},{"../../lib/extend":682,"../../plots/cartesian/axes":740}],881:[function(e,t){"use strict";var a=e("../../plots/cartesian/axes"),o=e("../../lib/extend").extendFlat;t.exports=function(e,t){var r=t._labels=[],n=t._gridlines,l,s,d,c,p;for(l=0;l<n.length;l++)p=n[l],-1!==["start","both"].indexOf(t.showticklabels)&&(s=a.tickText(t,p.value),o(s,{prefix:d,suffix:c,endAnchor:!0,xy:p.xy(0),dxy:p.dxy(0,0),axis:p.axis,length:p.crossAxis.length,font:p.axis.tickfont,isFirst:0===l,isLast:l===n.length-1}),r.push(s)),-1!==["end","both"].indexOf(t.showticklabels)&&(s=a.tickText(t,p.value),o(s,{endAnchor:!1,xy:p.xy(p.crossLength-1),dxy:p.dxy(p.crossLength-2,1),axis:p.axis,length:p.crossAxis.length,font:p.axis.tickfont,isFirst:0===l,isLast:l===n.length-1}),r.push(s))}},{"../../lib/extend":682,"../../plots/cartesian/axes":740}],882:[function(e,t){"use strict";var a=.5;t.exports=function(e,t,o,r){var i=e[0]-t[0],n=e[1]-t[1],l=o[0]-t[0],s=o[1]-t[1],d=_a(i*i+n*n,a/2),c=_a(l*l+s*s,a/2),p=(c*c*i-d*d*l)*r,u=(c*c*n-d*d*s)*r,g=3*(c*(d+c)),h=3*(d*(d+c));return[[t[0]+(g&&p/g),t[1]+(g&&u/g)],[t[0]-(h&&p/h),t[1]-(h&&u/h)]]}},{}],883:[function(e,t){"use strict";var o=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,a){var r=[],n=o(e)?e.length:e,l=o(t)?t.length:t,s=o(e)?e:null,d=o(t)?t:null,c,p,u,g,h,m;s&&(u=(s.length-1)/(s[s.length-1]-s[0])/(n-1)),d&&(g=(d.length-1)/(d[d.length-1]-d[0])/(l-1));var y=1/0,f=-Infinity,x;for(p=0;p<l;p++)for(r[p]=[],m=d?(d[p]-d[0])*g:p/(l-1),c=0;c<n;c++)h=s?(s[c]-s[0])*u:c/(n-1),x=h-m*a,y=ie(x,y),f=va(x,f),r[p][c]=x;var b=1/(f-y),_=-y*b;for(p=0;p<l;p++)for(c=0;c<n;c++)r[p][c]=b*r[p][c]+_;return r}},{"../../lib":692}],884:[function(e,t){"use strict";function a(e,t,a){var o=-.5*a[0]+1.5*t[0],r=-.5*a[1]+1.5*t[1];return[(2*o+e[0])/3,(2*r+e[1])/3]}var o=e("./catmull_rom"),r=e("../../lib").ensureArray;t.exports=function(e,t,n,l,s,d){var c=n[0].length,p=n.length,u=s?3*c-2:c,g=d?3*p-2:p,h,m,y,f,x,b,_,v,w,k;for(e=r(e,g),t=r(t,g),y=0;y<g;y++)e[y]=r(e[y],u),t[y]=r(t[y],u);for(m=0,f=0;m<p;m++,f+=d?3:1)for(x=e[f],b=t[f],_=n[m],v=l[m],(h=0,y=0);h<c;h++,y+=s?3:1)x[y]=_[h],b[y]=v[h];if(s)for(m=0,f=0;m<p;m++,f+=d?3:1){for(h=1,y=3;h<c-1;h++,y+=3)w=o([n[m][h-1],l[m][h-1]],[n[m][h],l[m][h]],[n[m][h+1],l[m][h+1]],s),e[f][y-1]=w[0][0],t[f][y-1]=w[0][1],e[f][y+1]=w[1][0],t[f][y+1]=w[1][1];k=a([e[f][0],t[f][0]],[e[f][2],t[f][2]],[e[f][3],t[f][3]]),e[f][1]=k[0],t[f][1]=k[1],k=a([e[f][u-1],t[f][u-1]],[e[f][u-3],t[f][u-3]],[e[f][u-4],t[f][u-4]]),e[f][u-2]=k[0],t[f][u-2]=k[1]}if(d)for(y=0;y<u;y++){for(f=3;f<g-3;f+=3)w=o([e[f-3][y],t[f-3][y]],[e[f][y],t[f][y]],[e[f+3][y],t[f+3][y]],d),e[f-1][y]=w[0][0],t[f-1][y]=w[0][1],e[f+1][y]=w[1][0],t[f+1][y]=w[1][1];k=a([e[0][y],t[0][y]],[e[2][y],t[2][y]],[e[3][y],t[3][y]]),e[1][y]=k[0],t[1][y]=k[1],k=a([e[g-1][y],t[g-1][y]],[e[g-3][y],t[g-3][y]],[e[g-4][y],t[g-4][y]]),e[g-2][y]=k[0],t[g-2][y]=k[1]}if(s&&d)for(f=1;f<g;f+=0==(f+1)%3?2:1){for(y=3;y<u-3;y+=3)w=o([e[f][y-3],t[f][y-3]],[e[f][y],t[f][y]],[e[f][y+3],t[f][y+3]],s),e[f][y-1]=.5*(e[f][y-1]+w[0][0]),t[f][y-1]=.5*(t[f][y-1]+w[0][1]),e[f][y+1]=.5*(e[f][y+1]+w[1][0]),t[f][y+1]=.5*(t[f][y+1]+w[1][1]);k=a([e[f][0],t[f][0]],[e[f][2],t[f][2]],[e[f][3],t[f][3]]),e[f][1]=.5*(e[f][1]+k[0]),t[f][1]=.5*(t[f][1]+k[1]),k=a([e[f][u-1],t[f][u-1]],[e[f][u-3],t[f][u-3]],[e[f][u-4],t[f][u-4]]),e[f][u-2]=.5*(e[f][u-2]+k[0]),t[f][u-2]=.5*(t[f][u-2]+k[1])}return[e,t]}},{"../../lib":692,"./catmull_rom":882}],885:[function(e,t){"use strict";t.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],886:[function(e,t){"use strict";t.exports=function(e,t,a){return t&&a?function(t,o,r,i,n){t||(t=[]);var l,s,p,u,g,h;o*=3,r*=3;var m=i*i,y=1-i,f=y*y,x=2*(y*i),_=-3*f,a=3*(f-x),b=3*(x-m),c=3*m,d=n*n,v=1-n,w=v*v;for(h=0;h<e.length;h++)g=e[h],l=_*g[r][o]+a*g[r][o+1]+b*g[r][o+2]+c*g[r][o+3],s=_*g[r+1][o]+a*g[r+1][o+1]+b*g[r+1][o+2]+c*g[r+1][o+3],p=_*g[r+2][o]+a*g[r+2][o+1]+b*g[r+2][o+2]+c*g[r+2][o+3],u=_*g[r+3][o]+a*g[r+3][o+1]+b*g[r+3][o+2]+c*g[r+3][o+3],t[h]=w*v*l+3*(w*n*s+v*d*p)+d*n*u;return t}:t?function(t,o,r,i,n){t||(t=[]);var l,s,p,u;o*=3;var g=i*i,h=1-i,m=h*h,y=2*(h*i),f=-3*m,a=3*(m-y),x=3*(y-g),c=3*g;for(p=0;p<e.length;p++)u=e[p],l=f*u[r][o]+a*u[r][o+1]+x*u[r][o+2]+c*u[r][o+3],s=f*u[r+1][o]+a*u[r+1][o+1]+x*u[r+1][o+2]+c*u[r+1][o+3],t[p]=(1-n)*l+n*s;return t}:a?function(t,a,o,r,i){t||(t=[]);var n,l,s,d,c,p;o*=3;var u=i*i,g=1-i,h=g*g;for(c=0;c<e.length;c++)p=e[c],n=p[o][a+1]-p[o][a],l=p[o+1][a+1]-p[o+1][a],s=p[o+2][a+1]-p[o+2][a],d=p[o+3][a+1]-p[o+3][a],t[c]=h*g*n+3*(h*i*l+g*u*s)+u*i*d;return t}:function(t,a,o,r,i){t||(t=[]);var n,l,s,d;for(s=0;s<e.length;s++)d=e[s],n=d[o][a+1]-d[o][a],l=d[o+1][a+1]-d[o+1][a],t[s]=(1-i)*n+i*l;return t}}},{}],887:[function(e,t){"use strict";t.exports=function(e,t,a){return t&&a?function(t,o,r,i,n){t||(t=[]);var l,s,p,u,g,h;o*=3,r*=3;var m=i*i,y=1-i,f=y*y,x=n*n,_=1-n,v=_*_,w=2*(_*n),T=-3*v,a=3*(v-w),b=3*(w-x),c=3*x;for(h=0;h<e.length;h++)g=e[h],l=T*g[r][o]+a*g[r+1][o]+b*g[r+2][o]+c*g[r+3][o],s=T*g[r][o+1]+a*g[r+1][o+1]+b*g[r+2][o+1]+c*g[r+3][o+1],p=T*g[r][o+2]+a*g[r+1][o+2]+b*g[r+2][o+2]+c*g[r+3][o+2],u=T*g[r][o+3]+a*g[r+1][o+3]+b*g[r+2][o+3]+c*g[r+3][o+3],t[h]=f*y*l+3*(f*i*s+y*m*p)+m*i*u;return t}:t?function(t,a,o,r,i){t||(t=[]);var n,l,s,d,c,p;a*=3;var u=i*i,g=1-i,h=g*g;for(c=0;c<e.length;c++)p=e[c],n=p[o+1][a]-p[o][a],l=p[o+1][a+1]-p[o][a+1],s=p[o+1][a+2]-p[o][a+2],d=p[o+1][a+3]-p[o][a+3],t[c]=h*g*n+3*(h*i*l+g*u*s)+u*i*d;return t}:a?function(t,o,r,i,n){t||(t=[]);var l,s,p,u;r*=3;var g=n*n,h=1-n,m=h*h,y=2*(h*n),f=-3*m,a=3*(m-y),x=3*(y-g),c=3*g;for(p=0;p<e.length;p++)u=e[p],l=f*u[r][o]+a*u[r+1][o]+x*u[r+2][o]+c*u[r+3][o],s=f*u[r][o+1]+a*u[r+1][o+1]+x*u[r+2][o+1]+c*u[r+3][o+1],t[p]=(1-i)*l+i*s;return t}:function(t,a,o,r){t||(t=[]);var i,n,l,s;for(l=0;l<e.length;l++)s=e[l],i=s[o+1][a]-s[o][a],n=s[o+1][a+1]-s[o][a+1],t[l]=(1-r)*i+r*n;return t}}},{}],888:[function(e,t){"use strict";t.exports=function(e,t,a,o,r){var n=t-2,l=a-2;return o&&r?function(t,a,o){t||(t=[]);var r=va(0,ie(ea(a),n)),i=va(0,ie(ea(o),l)),s=va(0,ie(1,a-r)),d=va(0,ie(1,o-i)),c,p,u,g,h,m;r*=3,i*=3;var y=s*s,f=y*s,x=1-s,b=x*x,_=b*x,v=d*d,w=1-d,T=w*w;for(m=0;m<e.length;m++)h=e[m],c=_*h[i][r]+3*(b*s*h[i][r+1]+x*y*h[i][r+2])+f*h[i][r+3],p=_*h[i+1][r]+3*(b*s*h[i+1][r+1]+x*y*h[i+1][r+2])+f*h[i+1][r+3],u=_*h[i+2][r]+3*(b*s*h[i+2][r+1]+x*y*h[i+2][r+2])+f*h[i+2][r+3],g=_*h[i+3][r]+3*(b*s*h[i+3][r+1]+x*y*h[i+3][r+2])+f*h[i+3][r+3],t[m]=T*w*c+3*(T*d*p+w*v*u)+v*d*g;return t}:o?function(t,a,o){t||(t=[]);var r=va(0,ie(ea(a),n)),i=va(0,ie(ea(o),l)),s=va(0,ie(1,a-r)),d=va(0,ie(1,o-i)),c,p,u,g,h,m;r*=3;var y=s*s,f=1-s,x=f*f,b=1-d;for(h=0;h<e.length;h++)m=e[h],c=b*m[i][r]+d*m[i+1][r],p=b*m[i][r+1]+d*m[i+1][r+1],u=b*m[i][r+2]+d*m[i+1][r+1],g=b*m[i][r+3]+d*m[i+1][r+1],t[h]=x*f*c+3*(x*s*p+f*y*u)+y*s*g;return t}:r?function(t,a,o){t||(t=[]);var r=va(0,ie(ea(a),n)),i=va(0,ie(ea(o),l)),s=va(0,ie(1,a-r)),d=va(0,ie(1,o-i)),c,p,u,g,h,m;i*=3;var y=d*d,f=1-d,x=f*f,b=1-s;for(h=0;h<e.length;h++)m=e[h],c=b*m[i][r]+s*m[i][r+1],p=b*m[i+1][r]+s*m[i+1][r+1],u=b*m[i+2][r]+s*m[i+2][r+1],g=b*m[i+3][r]+s*m[i+3][r+1],t[h]=x*f*c+3*(x*d*p+f*y*u)+y*d*g;return t}:function(t,a,o){t||(t=[]);var r=va(0,ie(ea(a),n)),i=va(0,ie(ea(o),l)),s=va(0,ie(1,a-r)),d=va(0,ie(1,o-i)),c=1-s,p,u,g,h;for(g=0;g<e.length;g++)h=e[g],p=c*h[i][r]+s*h[i][r+1],u=c*h[i+1][r]+s*h[i+1][r+1],t[g]=(1-d)*p+d*u;return t}}},{}],889:[function(e,t){"use strict";var a=e("../../lib"),o=e("./xy_defaults"),r=e("./ab_defaults"),i=e("./attributes"),n=e("../../components/color/attributes");t.exports=function(e,t,l,s){function d(o,r){return a.coerce(e,t,i,o,r)}t._clipPathId="clip"+t.uid+"carpet";var c=d("color",n.defaultLine);if(a.coerceFont(d,"font"),d("carpet"),r(e,t,s,d,c),!t.a||!t.b)return void(t.visible=!1);3>t.a.length&&(t.aaxis.smoothing=0),3>t.b.length&&(t.baxis.smoothing=0);var p=o(e,t,d);p||(t.visible=!1),t._cheater&&d("cheaterslope")}},{"../../components/color/attributes":568,"../../lib":692,"./ab_defaults":872,"./attributes":874,"./xy_defaults":898}],890:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.plot=e("./plot"),a.calc=e("./calc"),a.animatable=!0,a.isContainer=!0,a.moduleType="trace",a.name="carpet",a.basePlotModule=e("../../plots/cartesian"),a.categories=["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory"],a.meta={},t.exports=a},{"../../plots/cartesian":752,"./attributes":874,"./calc":878,"./defaults":889,"./plot":895}],891:[function(e,t){"use strict";t.exports=function(e,t){for(var a=e._fullData.length,o=0,r,n;o<a;o++)if(n=e._fullData[o],n.index!==t.index&&"carpet"===n.type&&(r||(r=n),n.carpet===t.carpet))return n;return r}},{}],892:[function(e,t){"use strict";t.exports=function(e,t,a){if(0===e.length)return"";var o=[],r=a?3:1,n;for(n=0;n<e.length;n+=r)o.push(e[n]+","+t[n]),a&&n<e.length-r&&(o.push("C"),o.push([e[n+1]+","+t[n+1],e[n+2]+","+t[n+2]+" "].join(" ")));return o.join(a?"":"L")}},{}],893:[function(e,t){"use strict";var a=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,o){var r;for(a(e)?e.length>t.length&&(e=e.slice(0,t.length)):e=[],r=0;r<t.length;r++)e[r]=o(t[r]);return e}},{"../../lib":692}],894:[function(e,t){"use strict";t.exports=function(e,t,a,o,r,i){var n=r[0]*e.dpdx(t),l=r[1]*e.dpdy(a),s=1,d=1;if(i){var c=re(r[0]*r[0]+r[1]*r[1]),p=re(i[0]*i[0]+i[1]*i[1]),u=(r[0]*i[0]+r[1]*i[1])/c/p;d=va(0,u)}var g=180*L(l,n)/Sa;return-90>g?(g+=180,s=-s):90<g&&(g-=180,s=-s),{angle:g,flip:s,p:e.c2p(o,t,a),offsetMultplier:d}}},{}],895:[function(e,t){"use strict";function a(e,a,t,o,r){var n=t.select("#"+e._clipPathId),l,s,d,u;n.size()||(n=t.append("clipPath").classed("carpetclip",!0));var g=h.ensureSingle(n,"path","carpetboundary"),m=a.clipsegments,y=[];for(u=0;u<m.length;u++)l=m[u],s=c([],l.x,o.c2p),d=c([],l.y,r.c2p),y.push(p(s,d,l.bicubic));var f="M"+y.join("L")+"Z";n.attr("id",e._clipPathId),g.attr("d",f)}function o(e,t,a,o,r,i){var n="const-"+r+"-lines",s=a.selectAll("."+n).data(i);s.enter().append("path").classed(n,!0).style("vector-effect","non-scaling-stroke"),s.each(function(a){var o=a,r=o.x,i=o.y,n=c([],r,e.c2p),s=c([],i,t.c2p),d="M"+p(n,s,o.smoothing),u=l.select(this);u.attr("d",d).style("stroke-width",o.width).style("stroke",o.color).style("fill","none")}),s.exit().remove()}function r(e,a,o,r,i,t,n,d){var c=t.selectAll("text."+d).data(n);c.enter().append("text").classed(d,!0);var p=0,h={};return c.each(function(t,n){var i;if("auto"===t.axis.tickangle)i=u(r,a,o,t.xy,t.dxy);else{var d=(t.axis.tickangle+180)*Sa/180;i=u(r,a,o,t.xy,[te(d),M(d)])}n||(h={angle:i.angle,flip:i.flip});var c=(t.endAnchor?-1:1)*i.flip,m=l.select(this).attr({"text-anchor":0<c?"start":"end","data-notex":1}).call(s.font,t.font).text(t.text).call(g.convertToTspans,e),y=s.bBox(this);m.attr("transform","translate("+i.p[0]+","+i.p[1]+") rotate("+i.angle+")translate("+t.axis.labelpadding*c+","+.3*y.height+")"),p=va(p,y.width+t.axis.labelpadding)}),c.exit().remove(),h.maxExtent=p,h}function i(e,o,r,i,t,l,s,d){var c,p,g,m;c=.5*(r.a[0]+r.a[r.a.length-1]),p=r.b[0],g=r.ab2xy(c,p,!0),m=r.dxyda_rough(c,p),s.angle===void 0&&h.extendFlat(s,u(r,t,l,g,r.dxydb_rough(c,p))),n(e,o,r,i,g,m,r.aaxis,t,l,s,"a-title"),c=r.a[0],p=.5*(r.b[0]+r.b[r.b.length-1]),g=r.ab2xy(c,p,!0),m=r.dxydb_rough(c,p),d.angle===void 0&&h.extendFlat(d,u(r,t,l,g,r.dxyda_rough(c,p))),n(e,o,r,i,g,m,r.baxis,t,l,d,"b-title")}function n(e,a,o,r,t,i,n,d,c,p,h){var m=[];n.title.text&&m.push(n.title.text);var x=a.selectAll("text."+h).data(m),b=p.maxExtent;x.enter().append("text").classed(h,!0),x.each(function(){var a=u(o,d,c,t,i);-1===["start","both"].indexOf(n.showticklabels)&&(b=0);var r=n.title.font.size;b+=r+n.title.offset;var h=p.angle+(0>p.flip?180:0),m=(h-a.angle+450)%360,x=l.select(this);x.text(n.title.text).call(g.convertToTspans,e),90<m&&270>m&&(b=(-g.lineCount(x)+f)*y*r-b),x.attr("transform","translate("+a.p[0]+","+a.p[1]+") rotate("+a.angle+") translate(0,"+b+")").classed("user-select-none",!0).attr("text-anchor","middle").call(s.font,n.title.font)}),x.exit().remove()}var l=e("d3"),s=e("../../components/drawing"),c=e("./map_1d_array"),p=e("./makepath"),u=e("./orient_text"),g=e("../../lib/svg_text_utils"),h=e("../../lib"),m=e("../../constants/alignment");t.exports=function(e,t,n,s){var d=t.xaxis,c=t.yaxis,p=e._fullLayout,u=p._clips;h.makeTraceGroups(s,n,"trace").each(function(t){var n=l.select(this),s=t[0],p=s.trace,g=p.aaxis,m=p.baxis,y=h.ensureSingle(n,"g","minorlayer"),f=h.ensureSingle(n,"g","majorlayer"),x=h.ensureSingle(n,"g","boundarylayer"),b=h.ensureSingle(n,"g","labellayer");n.style("opacity",p.opacity),o(d,c,f,g,"a",g._gridlines,!0),o(d,c,f,m,"b",m._gridlines,!0),o(d,c,y,g,"a",g._minorgridlines,!0),o(d,c,y,m,"b",m._minorgridlines,!0),o(d,c,x,g,"a-boundary",g._boundarylines),o(d,c,x,m,"b-boundary",m._boundarylines);var _=r(e,d,c,p,s,b,g._labels,"a-label"),v=r(e,d,c,p,s,b,m._labels,"b-label");i(e,b,p,s,d,c,_,v),a(p,s,u,d,c)})};var y=m.LINE_SPACING,f=(1-m.MID_SHIFT)/y+1},{"../../components/drawing":590,"../../constants/alignment":664,"../../lib":692,"../../lib/svg_text_utils":716,"./makepath":892,"./map_1d_array":893,"./orient_text":894,d3:148}],896:[function(e,t){"use strict";var o=e("./constants"),r=e("../../lib/search").findBin,i=e("./compute_control_points"),n=e("./create_spline_evaluator"),l=e("./create_i_derivative_evaluator"),s=e("./create_j_derivative_evaluator");t.exports=function(e){var t=e._a,a=e._b,d=t.length,c=a.length,p=e.aaxis,u=e.baxis,g=t[0],h=t[d-1],m=a[0],y=a[c-1],f=t[t.length-1]-t[0],x=a[a.length-1]-a[0],b=f*o.RELATIVE_CULL_TOLERANCE,_=x*o.RELATIVE_CULL_TOLERANCE;g-=b,h+=b,m-=_,y+=_,e.isVisible=function(e,t){return e>g&&e<h&&t>m&&t<y},e.isOccluded=function(e,t){return e<g||e>h||t<m||t>y},e.setScale=function(){var t=e._x,a=e._y,o=i(e._xctrl,e._yctrl,t,a,p.smoothing,u.smoothing);e._xctrl=o[0],e._yctrl=o[1],e.evalxy=n([e._xctrl,e._yctrl],d,c,p.smoothing,u.smoothing),e.dxydi=l([e._xctrl,e._yctrl],p.smoothing,u.smoothing),e.dxydj=s([e._xctrl,e._yctrl],p.smoothing,u.smoothing)},e.i2a=function(e){var a=va(0,ea(e[0]),d-2),o=e[0]-a;return(1-o)*t[a]+o*t[a+1]},e.j2b=function(e){var t=va(0,ea(e[1]),d-2),o=e[1]-t;return(1-o)*a[t]+o*a[t+1]},e.ij2ab=function(t){return[e.i2a(t[0]),e.j2b(t[1])]},e.a2i=function(e){var a=va(0,ie(r(e,t),d-2)),o=t[a],i=t[a+1];return va(0,ie(d-1,a+(e-o)/(i-o)))},e.b2j=function(e){var t=va(0,ie(r(e,a),c-2)),o=a[t],i=a[t+1];return va(0,ie(c-1,t+(e-o)/(i-o)))},e.ab2ij=function(t){return[e.a2i(t[0]),e.b2j(t[1])]},e.i2c=function(t,a){return e.evalxy([],t,a)},e.ab2xy=function(o,r,n){if(!n&&(o<t[0]||o>t[d-1]|r<a[0]||r>a[c-1]))return[!1,!1];var l=e.a2i(o),i=e.b2j(r),s=e.evalxy([],l,i);if(n){var p=0,u=0,g=[],h,m,y,f;o<t[0]?(h=0,m=0,p=(o-t[0])/(t[1]-t[0])):o>t[d-1]?(h=d-2,m=1,p=(o-t[d-1])/(t[d-1]-t[d-2])):(h=va(0,ie(d-2,ea(l))),m=l-h),r<a[0]?(y=0,f=0,u=(r-a[0])/(a[1]-a[0])):r>a[c-1]?(y=c-2,f=1,u=(r-a[c-1])/(a[c-1]-a[c-2])):(y=va(0,ie(c-2,ea(i))),f=i-y),p&&(e.dxydi(g,h,y,m,f),s[0]+=g[0]*p,s[1]+=g[1]*p),u&&(e.dxydj(g,h,y,m,f),s[0]+=g[0]*u,s[1]+=g[1]*u)}return s},e.c2p=function(e,t,a){return[t.c2p(e[0]),a.c2p(e[1])]},e.p2x=function(e,t,a){return[t.p2c(e[0]),a.p2c(e[1])]},e.dadi=function(e){var a=va(0,ie(t.length-2,e));return t[a+1]-t[a]},e.dbdj=function(e){var t=va(0,ie(a.length-2,e));return a[t+1]-a[t]},e.dxyda=function(t,a,o,r){var i=e.dxydi(null,t,a,o,r),n=e.dadi(t,o);return[i[0]/n,i[1]/n]},e.dxydb=function(t,a,o,r){var i=e.dxydj(null,t,a,o,r),n=e.dbdj(a,r);return[i[0]/n,i[1]/n]},e.dxyda_rough=function(t,a,o){var r=f*(o||.1),i=e.ab2xy(t+r,a,!0),n=e.ab2xy(t-r,a,!0);return[.5*(i[0]-n[0])/r,.5*(i[1]-n[1])/r]},e.dxydb_rough=function(t,a,o){var r=x*(o||.1),i=e.ab2xy(t,a+r,!0),n=e.ab2xy(t,a-r,!0);return[.5*(i[0]-n[0])/r,.5*(i[1]-n[1])/r]},e.dpdx=function(e){return e._m},e.dpdy=function(e){return e._m}}},{"../../lib/search":711,"./compute_control_points":884,"./constants":885,"./create_i_derivative_evaluator":886,"./create_j_derivative_evaluator":887,"./create_spline_evaluator":888}],897:[function(e,t){"use strict";var o=e("../../lib");t.exports=function(e,t,a){function r(t,a){var o=0,r=0,i;return 0<t&&void 0!==(i=e[a][t-1])&&(r++,o+=i),t<p-1&&void 0!==(i=e[a][t+1])&&(r++,o+=i),0<a&&void 0!==(i=e[a-1][t])&&(r++,o+=i),a<u-1&&void 0!==(i=e[a+1][t])&&(r++,o+=i),o/va(1,r)}var l=[],s=[],p=e[0].length,u=e.length,g=0,h,m,y;for(h=0;h<p;h++)for(m=0;m<u;m++)void 0===e[m][h]&&(l.push(h),s.push(m),e[m][h]=r(h,m)),g=va(g,wa(e[m][h]));if(!l.length)return e;var f=0,x=0,b=l.length,n,_,v,w,T,A,S,C,L,E,z;do{for(f=0,y=0;y<b;y++){h=l[y],m=s[y];var I=0,D=0,P,O,R,M,B,F;0===h?(B=ie(p-1,2),R=t[B],M=t[1],P=e[m][B],O=e[m][1],D+=O+(O-P)*(t[0]-M)/(M-R),I++):h===p-1&&(B=va(0,p-3),R=t[B],M=t[p-2],P=e[m][B],O=e[m][p-2],D+=O+(O-P)*(t[p-1]-M)/(M-R),I++),(0===h||h===p-1)&&0<m&&m<u-1&&(n=a[m+1]-a[m],_=a[m]-a[m-1],D+=(_*e[m+1][h]+n*e[m-1][h])/(_+n),I++),0===m?(F=ie(u-1,2),R=a[F],M=a[1],P=e[F][h],O=e[1][h],D+=O+(O-P)*(a[0]-M)/(M-R),I++):m===u-1&&(F=va(0,u-3),R=a[F],M=a[u-2],P=e[F][h],O=e[u-2][h],D+=O+(O-P)*(a[u-1]-M)/(M-R),I++),(0===m||m===u-1)&&0<h&&h<p-1&&(n=t[h+1]-t[h],_=t[h]-t[h-1],D+=(_*e[m][h+1]+n*e[m][h-1])/(_+n),I++),I?D/=I:(v=t[h+1]-t[h],w=t[h]-t[h-1],T=a[m+1]-a[m],A=a[m]-a[m-1],S=v*w*(v+w),C=T*A*(T+A),D=(S*(A*e[m+1][h]+T*e[m-1][h])+C*(w*e[m][h+1]+v*e[m][h-1]))/(C*(w+v)+S*(A+T))),L=D-e[m][h],E=L/g,f+=E*E,z=I?0:.85,e[m][h]+=L*(1+z)}f=re(f)}while(x++<100&&f>1e-5);return o.log("Smoother converged to",f,"after",x,"iterations"),e}},{"../../lib":692}],898:[function(e,t){"use strict";var a=e("../../lib").isArray1D;t.exports=function(e,t,o){var r=o("x"),i=r&&r.length,n=o("y"),l=n&&n.length;if(!i&&!l)return!1;if(t._cheater=!r,(!i||a(r))&&(!l||a(n))){var s=i?r.length:1/0;l&&(s=ie(s,n.length)),t.a&&t.a.length&&(s=ie(s,t.a.length)),t.b&&t.b.length&&(s=ie(s,t.b.length)),t._length=s}else t._length=null;return!0}},{"../../lib":692}],899:[function(e,t){"use strict";var a=e("../scattergeo/attributes"),o=e("../../components/colorscale/attributes"),r=e("../../components/colorbar/attributes"),i=e("../../plots/attributes"),n=e("../../lib/extend").extendFlat,l=a.marker.line;t.exports=n({locations:{valType:"data_array",editType:"calc"},locationmode:a.locationmode,z:{valType:"data_array",editType:"calc"},text:n({},a.text,{}),marker:{line:{color:l.color,width:n({},l.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:a.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:a.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:n({},i.hoverinfo,{editType:"calc",flags:["location","z","text","name"]})},o("",{cLetter:"z",editTypeOverride:"calc"}),{colorbar:r})},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../lib/extend":682,"../../plots/attributes":737,"../scattergeo/attributes":1080}],900:[function(e,t){"use strict";var a=e("fast-isnumeric"),o=e("../../constants/numerical").BADNUM,r=e("../../components/colorscale/calc"),n=e("../scatter/arrays_to_calcdata"),l=e("../scatter/calc_selection");t.exports=function(e,t){for(var s=t._length,d=Array(s),c=0;c<s;c++){var p=d[c]={},u=t.locations[c],g=t.z[c];p.loc="string"==typeof u?u:null,p.z=a(g)?g:o}return n(d,t),r(e,t,{vals:t.z,containerStr:"",cLetter:"z"}),l(d,t),d}},{"../../components/colorscale/calc":577,"../../constants/numerical":669,"../scatter/arrays_to_calcdata":1039,"../scatter/calc_selection":1042,"fast-isnumeric":214}],901:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../components/colorscale/defaults"),r=e("./attributes");t.exports=function(e,t,i,n){function l(o,i){return a.coerce(e,t,r,o,i)}var s=l("locations"),d=l("z");return s&&s.length&&a.isArrayOrTypedArray(d)&&d.length?void(t._length=ie(s.length,d.length),l("locationmode"),l("text"),l("marker.line.color"),l("marker.line.width"),l("marker.opacity"),o(e,t,n,l,{prefix:"",cLetter:"z"}),a.coerceSelectionMarkerOpacity(t,l)):void(t.visible=!1)}},{"../../components/colorscale/defaults":579,"../../lib":692,"./attributes":899}],902:[function(e,t){"use strict";t.exports=function(e,t){return e.location=t.location,e.z=t.z,e}},{}],903:[function(e,t){"use strict";function a(e,t,a,n){var l=a.hi||t.hoverinfo,s="all"===l?r.hoverinfo.flags:l.split("+"),d=-1!==s.indexOf("name"),c=-1!==s.indexOf("location"),p=-1!==s.indexOf("z"),u=-1!==s.indexOf("text"),g=[];!d&&c?e.nameOverride=a.loc:(d&&(e.nameOverride=t.name),c&&g.push(a.loc)),p&&g.push(function(e){return o.tickText(n,n.c2l(e),"hover").text}(a.z)),u&&i(a,t,g),e.extraText=g.join("<br>")}var o=e("../../plots/cartesian/axes"),r=e("./attributes"),i=e("../scatter/fill_hover_text");t.exports=function(e,t,o){var r=e.cd,n=r[0].trace,l=e.subplot,s,d,c,p;for(d=0;d<r.length;d++)if(s=r[d],p=!1,s._polygons){for(c=0;c<s._polygons.length;c++)s._polygons[c].contains([t,o])&&(p=!p),s._polygons[c].contains([t+360,o])&&(p=!p);if(p)break}if(p&&s)return e.x0=e.x1=e.xa.c2p(s.ct),e.y0=e.y1=e.ya.c2p(s.ct),e.index=s.index,e.location=s.loc,e.z=s.z,a(e,n,s,l.mockAxis),[e]}},{"../../plots/cartesian/axes":740,"../scatter/fill_hover_text":1048,"./attributes":899}],904:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.colorbar=e("../heatmap/colorbar"),a.calc=e("./calc"),a.plot=e("./plot"),a.style=e("./style").style,a.styleOnSelect=e("./style").styleOnSelect,a.hoverPoints=e("./hover"),a.eventData=e("./event_data"),a.selectPoints=e("./select"),a.moduleType="trace",a.name="choropleth",a.basePlotModule=e("../../plots/geo"),a.categories=["geo","noOpacity"],a.meta={},t.exports=a},{"../../plots/geo":771,"../heatmap/colorbar":945,"./attributes":899,"./calc":900,"./defaults":901,"./event_data":902,"./hover":903,"./plot":905,"./select":906,"./style":907}],905:[function(e,t){"use strict";function a(e,t){for(var a=e[0].trace,r=e.length,n=s(a,t),l=0;l<r;l++){var c=e[l],p=d(a.locationmode,c.loc,n);if(!p){c.geojson=null;continue}c.geojson=p,c.ct=p.properties.ct,c.index=l,c._polygons=o(p)}}function o(e){function t(e){for(var t=0;t<e.length-1;t++)if(0<e[t][0]&&0>e[t+1][0])return t;return null}var a=e.geometry,o=a.coordinates,r=e.id,i=[],n,s,d,c;switch(n="RUS"===r||"FJI"===r?function(e){var a;if(null===t(e))a=e;else for(a=Array(e.length),c=0;c<e.length;c++)a[c]=[0>e[c][0]?e[c][0]+360:e[c][0],e[c][1]];i.push(l.tester(a))}:"ATA"===r?function(e){var a=t(e);if(null===a)return i.push(l.tester(e));var o=Array(e.length+1),r=0;for(c=0;c<e.length;c++)c>a?o[r++]=[e[c][0]+360,e[c][1]]:c===a?(o[r++]=e[c],o[r++]=[e[c][0],-90]):o[r++]=e[c];var n=l.tester(o);n.pts.pop(),i.push(n)}:function(e){i.push(l.tester(e))},a.type){case"MultiPolygon":for(s=0;s<o.length;s++)for(d=0;d<o[s].length;d++)n(o[s][d]);break;case"Polygon":for(s=0;s<o.length;s++)n(o[s]);}return i}var r=e("d3"),n=e("../../lib"),l=e("../../lib/polygon"),s=e("../../lib/topojson_utils").getTopojsonFeatures,d=e("../../lib/geo_location_utils").locationToFeature,c=e("./style").style;t.exports=function(e,t,o){for(var l=0;l<o.length;l++)a(o[l],t.topojson);var s=t.layers.backplot.select(".choroplethlayer");n.makeTraceGroups(s,o,"trace choropleth").each(function(t){var a=t[0].node3=r.select(this),o=a.selectAll("path.choroplethlocation").data(n.identity);o.enter().append("path").classed("choroplethlocation",!0),o.exit().remove(),c(e,t)})}},{"../../lib":692,"../../lib/geo_location_utils":685,"../../lib/polygon":704,"../../lib/topojson_utils":719,"./style":907,d3:148}],906:[function(e,t){"use strict";t.exports=function(e,t){var a=e.cd,o=e.xaxis,r=e.yaxis,n=[],l,s,d,c,p;if(!1===t)for(l=0;l<a.length;l++)a[l].selected=0;else for(l=0;l<a.length;l++)s=a[l],d=s.ct,d&&(c=o.c2p(d),p=r.c2p(d),t.contains([c,p],null,l,e)?(n.push({pointNumber:l,lon:d[0],lat:d[1]}),s.selected=1):s.selected=0);return n}},{}],907:[function(e,t){"use strict";function a(e,t){var a=t[0].trace,l=t[0].node3,s=l.selectAll(".choroplethlocation"),c=a.marker||{},p=c.line||{},u=n.makeColorScaleFunc(n.extractScale(a,{cLetter:"z"}));s.each(function(e){o.select(this).attr("fill",u(e.z)).call(r.stroke,e.mlc||p.color).call(i.dashLine,"",e.mlw||p.width||0).style("opacity",c.opacity)}),i.selectedPointStyle(s,a,e)}var o=e("d3"),r=e("../../components/color"),i=e("../../components/drawing"),n=e("../../components/colorscale");t.exports={style:function(e,t){t&&a(e,t)},styleOnSelect:function(e,t){var o=t[0].node3,r=t[0].trace;r.selectedpoints?i.selectedPointStyle(o.selectAll(".choroplethlocation"),r,e):a(e,t)}}},{"../../components/color":569,"../../components/colorscale":581,"../../components/drawing":590,d3:148}],908:[function(e,t){"use strict";var a=e("../../components/colorscale/attributes"),o=e("../../components/colorbar/attributes"),r=e("../mesh3d/attributes"),i=e("../../plots/attributes"),n=e("../../lib/extend").extendFlat,l={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"}};n(l,a("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:o});["opacity","lightposition","lighting"].forEach(function(e){l[e]=r[e]}),l.hoverinfo=n({},i.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),l.transforms=void 0,t.exports=l},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../lib/extend":682,"../../plots/attributes":737,"../mesh3d/attributes":983}],909:[function(e,t){"use strict";var a=e("../../components/colorscale/calc");t.exports=function(e,t){for(var o=t.u,r=t.v,n=t.w,l=ie(t.x.length,t.y.length,t.z.length,o.length,r.length,n.length),s=-Infinity,d=1/0,c=0;c<l;c++){var p=o[c],u=r[c],g=n[c],h=re(p*p+u*u+g*g);s=va(s,h),d=ie(d,h)}t._len=l,t._normMax=s,a(e,t,{vals:[d,s],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":577}],910:[function(e,t){"use strict";function a(e,t){this.scene=e,this.uid=t,this.mesh=null,this.data=null}function o(e,t){function a(e,t){var a=o[t],r=i[c[t]];return n(e,function(e){return a.d2l(e)*r})}var o=e.fullSceneLayout,i=e.dataScale,d={};d.vectors=s(a(t.u,"xaxis"),a(t.v,"yaxis"),a(t.w,"zaxis"),t._len),d.positions=s(a(t.x,"xaxis"),a(t.y,"yaxis"),a(t.z,"zaxis"),t._len),d.colormap=l(t.colorscale),d.vertexIntensityBounds=[t.cmin/t._normMax,t.cmax/t._normMax],d.coneOffset=p[t.anchor],d.coneSize="scaled"===t.sizemode?t.sizeref||.5:t.sizeref&&t._normMax?t.sizeref/t._normMax:.5;var g=r(d),h=t.lightposition;return g.lightPosition=[h.x,h.y,h.z],g.ambient=t.lighting.ambient,g.diffuse=t.lighting.diffuse,g.specular=t.lighting.specular,g.roughness=t.lighting.roughness,g.fresnel=t.lighting.fresnel,g.opacity=t.opacity,t._pad=u[t.anchor]*g.vectorScale*g.coneScale*t._normMax,g}var r=e("gl-cone3d"),i=e("gl-cone3d").createConeMesh,n=e("../../lib").simpleMap,l=e("../../lib/gl_format_color").parseColorScale,s=e("../../plots/gl3d/zip3"),d=a.prototype;d.handlePick=function(e){if(e.object===this.mesh){var t=e.index=e.data.index,a=this.data.x[t],o=this.data.y[t],r=this.data.z[t],i=this.data.u[t],n=this.data.v[t],l=this.data.w[t];e.traceCoordinate=[a,o,r,i,n,l,re(i*i+n*n+l*l)];var s=this.data.text;return Array.isArray(s)&&void 0!==s[t]?e.textLabel=s[t]:s&&(e.textLabel=s),!0}};var c={xaxis:0,yaxis:1,zaxis:2},p={tip:1,tail:0,cm:.25,center:.5},u={tip:1,tail:1,cm:.75,center:.5};d.update=function(e){this.data=e;var t=o(this.scene,e);this.mesh.update(t)},d.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},t.exports=function(e,t){var r=e.glplot.gl,n=o(e,t),l=i(r,n),s=new a(e,t.uid);return s.mesh=l,s.data=t,l._trace=s,e.glplot.add(l),s}},{"../../lib":692,"../../lib/gl_format_color":689,"../../plots/gl3d/zip3":794,"gl-cone3d":231}],911:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../components/colorscale/defaults"),r=e("./attributes");t.exports=function(e,t,i,n){function l(o,i){return a.coerce(e,t,r,o,i)}var s=l("u"),d=l("v"),c=l("w"),p=l("x"),u=l("y"),g=l("z");return s&&s.length&&d&&d.length&&c&&c.length&&p&&p.length&&u&&u.length&&g&&g.length?void(l("sizeref"),l("sizemode"),l("anchor"),l("lighting.ambient"),l("lighting.diffuse"),l("lighting.specular"),l("lighting.roughness"),l("lighting.fresnel"),l("lightposition.x"),l("lightposition.y"),l("lightposition.z"),o(e,t,n,l,{prefix:"",cLetter:"c"}),l("text"),t._length=null):void(t.visible=!1)}},{"../../components/colorscale/defaults":579,"../../lib":692,"./attributes":908}],912:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"cone",basePlotModule:e("../../plots/gl3d"),categories:["gl3d"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:e("./calc"),plot:e("./convert"),meta:{}}},{"../../plots/gl3d":783,"./attributes":908,"./calc":909,"./convert":910,"./defaults":911}],913:[function(e,t){"use strict";var a=e("../heatmap/attributes"),o=e("../scatter/attributes"),r=e("../../components/colorscale/attributes"),i=e("../../components/colorbar/attributes"),n=e("../../components/drawing/attributes").dash,l=e("../../plots/font_attributes"),s=e("../../lib/extend").extendFlat,d=e("../../constants/filter_ops"),c=d.COMPARISON_OPS2,p=d.INTERVAL_OPS,u=o.line;t.exports=s({z:a.z,x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,text:a.text,transpose:a.transpose,xtype:a.xtype,ytype:a.ytype,zhoverformat:a.zhoverformat,connectgaps:a.connectgaps,fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:l({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot"},operation:{valType:"enumerated",values:[].concat(c).concat(p),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:s({},u.color,{editType:"style+colorbars"}),width:s({},u.width,{editType:"style+colorbars"}),dash:n,smoothing:s({},u.smoothing,{}),editType:"plot"}},r("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}),{colorbar:i})},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../components/drawing/attributes":589,"../../constants/filter_ops":665,"../../lib/extend":682,"../../plots/font_attributes":767,"../heatmap/attributes":942,"../scatter/attributes":1040}],914:[function(e,t){"use strict";var a=e("../heatmap/calc"),o=e("./set_contours");t.exports=function(e,t){var r=a(e,t);return o(t),r}},{"../heatmap/calc":943,"./set_contours":932}],915:[function(e,t){"use strict";t.exports=function(e,t,a,o){var r=e[0],n=r.x.length,l=r.y.length,s=r.z,d=o.contours,c=-Infinity,p=1/0,u,g,h;for(u=0;u<l;u++)p=ie(p,s[u][0]),p=ie(p,s[u][n-1]),c=va(c,s[u][0]),c=va(c,s[u][n-1]);for(u=1;u<n-1;u++)p=ie(p,s[0][u]),p=ie(p,s[l-1][u]),c=va(c,s[0][u]),c=va(c,s[l-1][u]);r.prefixBoundary=!1;">"===t?d.value>c&&(r.prefixBoundary=!0):"<"===t?d.value<p&&(r.prefixBoundary=!0):"[]"===t?(g=ie.apply(null,d.value),h=va.apply(null,d.value),(h<p||g>c)&&(r.prefixBoundary=!0)):"]["===t?(g=ie.apply(null,d.value),h=va.apply(null,d.value),g<p&&h>c&&(r.prefixBoundary=!0)):void 0}},{}],916:[function(e,t){"use strict";var a=e("../../components/colorbar/draw"),o=e("./make_color_map"),r=e("./end_plus");t.exports=function(e,t){var i=t[0].trace,n="cb"+i.uid;if(e._fullLayout._infolayer.selectAll("."+n).remove(),!!i.showscale){var l=t[0].t.cb=a(e,n),s=i.contours,d=i.line,c=s.size||1,p=s.coloring,u=o(i,{isColorbar:!0});l.fillgradient("heatmap"===p?i.colorscale:"").zrange("heatmap"===p?[i.zmin,i.zmax]:"").fillcolor("fill"===p?u:"").line({color:"lines"===p?u:d.color,width:!1===s.showlines?0:d.width,dash:d.dash}).levels({start:s.start,end:r(s),size:c}).options(i.colorbar)()}}},{"../../components/colorbar/draw":574,"./end_plus":924,"./make_color_map":929}],917:[function(e,t){"use strict";t.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],918:[function(e,t){"use strict";function a(e,t){var a;-1===c.indexOf(t.operation)?(e("contours.value",[0,1]),Array.isArray(t.value)?2<t.value.length?t.value=t.value.slice(2):0===t.length?t.value=[0,1]:2>t.length?(a=parseFloat(t.value[0]),t.value=[a,a+1]):t.value=[parseFloat(t.value[0]),parseFloat(t.value[1])]:o(t.value)&&(a=parseFloat(t.value),t.value=[a,a+1])):(e("contours.value",0),!o(t.value)&&(Array.isArray(t.value)?t.value=parseFloat(t.value[0]):t.value=0))}var o=e("fast-isnumeric"),r=e("./label_defaults"),i=e("../../components/color"),n=i.addOpacity,l=i.opacity,s=e("../../constants/filter_ops"),d=s.CONSTRAINT_REDUCTION,c=s.COMPARISON_OPS2;t.exports=function(e,t,o,i,s,c){var p=t.contours,u=o("contours.operation"),g,h,m;if(p._operation=d[u],a(o,p),"="===u?g=p.showlines=!0:(g=o("contours.showlines"),m=o("fillcolor",n((e.line||{}).color||s,.5))),g){var y=m&&l(m)?n(t.fillcolor,1):s;h=o("line.color",y),o("line.width",2),o("line.dash")}o("line.smoothing"),r(o,i,h,c)}},{"../../components/color":569,"../../constants/filter_ops":665,"./label_defaults":928,"fast-isnumeric":214}],919:[function(e,t){"use strict";function a(e,t){function a(e){return n(e)?+e:null}var o=Array.isArray(t),r;return-1===i.COMPARISON_OPS2.indexOf(e)?-1===i.INTERVAL_OPS.indexOf(e)?-1!==i.SET_OPS.indexOf(e)&&(r=o?t.map(a):[a(t)]):r=o?[a(t[0]),a(t[1])]:[a(t),a(t)]:r=o?a(t[0]):a(t),r}function o(e){return function(t){t=a(e,t);var o=ie(t[0],t[1]),r=va(t[0],t[1]);return{start:o,end:r,size:r-o}}}function r(e){return function(t){return t=a(e,t),{start:t,end:1/0,size:1/0}}}var i=e("../../constants/filter_ops"),n=e("fast-isnumeric");t.exports={"[]":o("[]"),"][":o("]["),">":r(">"),"<":r("<"),"=":r("=")}},{"../../constants/filter_ops":665,"fast-isnumeric":214}],920:[function(e,t){"use strict";t.exports=function(e,t,a,o){var r=o("contours.start"),i=o("contours.end"),n=a("contours.size"),l;l=!1===r||!1===i?t.autocontour=!0:a("autocontour",!1),(l||!n)&&a("ncontours")}},{}],921:[function(e,t){"use strict";function a(e){return o.extendFlat({},e,{edgepaths:o.extendDeep([],e.edgepaths),paths:o.extendDeep([],e.paths)})}var o=e("../../lib");t.exports=function(e,t){var r=function(e){return e.reverse()},n=function(e){return e},l,s,d;switch(t){case"=":case"<":return e;case">":for(1!==e.length&&o.warn("Contour data invalid for the specified inequality operation."),s=e[0],l=0;l<s.edgepaths.length;l++)s.edgepaths[l]=r(s.edgepaths[l]);for(l=0;l<s.paths.length;l++)s.paths[l]=r(s.paths[l]);return e;case"][":var c=r;r=n,n=c;case"[]":for(2!==e.length&&o.warn("Contour data invalid for the specified inequality range operation."),s=a(e[0]),d=a(e[1]),l=0;l<s.edgepaths.length;l++)s.edgepaths[l]=r(s.edgepaths[l]);for(l=0;l<s.paths.length;l++)s.paths[l]=r(s.paths[l]);for(;d.edgepaths.length;)s.edgepaths.push(n(d.edgepaths.shift()));for(;d.paths.length;)s.paths.push(n(d.paths.shift()));return[s];}}},{"../../lib":692}],922:[function(e,t){"use strict";var a=e("../../lib"),o=e("../heatmap/xyz_defaults"),r=e("./constraint_defaults"),i=e("./contours_defaults"),n=e("./style_defaults"),l=e("./attributes");t.exports=function(e,t,s,d){function c(o,r){return a.coerce(e,t,l,o,r)}var p=o(e,t,c,d);if(!p)return void(t.visible=!1);c("text");var u="constraint"===c("contours.type");c("connectgaps",a.isArray1D(t.z)),u?r(e,t,c,d,s):(i(e,t,c,function(o){return a.coerce2(e,t,l,o)}),n(e,t,c,d))}},{"../../lib":692,"../heatmap/xyz_defaults":956,"./attributes":913,"./constraint_defaults":918,"./contours_defaults":920,"./style_defaults":934}],923:[function(e,t){"use strict";var a=e("../../lib"),o=e("./constraint_mapping"),r=e("./end_plus");t.exports=function(e,t,i){for(var n="constraint"===e.type?o[e._operation](e.value):e,l=n.size,s=[],d=r(n),c=i.trace._carpetTrace,p=c?{xaxis:c.aaxis,yaxis:c.baxis,x:i.a,y:i.b}:{xaxis:t.xaxis,yaxis:t.yaxis,x:i.x,y:i.y},u=n.start;u<d;u+=l)if(s.push(a.extendFlat({level:u,crossings:{},starts:[],edgepaths:[],paths:[],z:i.z,smoothing:i.trace.line.smoothing},p)),1e3<s.length){a.warn("Too many contours, clipping at 1000",e);break}return s}},{"../../lib":692,"./constraint_mapping":919,"./end_plus":924}],924:[function(e,t){"use strict";t.exports=function(e){return e.end+e.size/1e6}},{}],925:[function(e,t){"use strict";function a(e,t,a,o){return wa(e[0]-t[0])<a&&wa(e[1]-t[1])<o}function o(e,t){var a=e[2]-t[2],o=e[3]-t[3];return re(a*a+o*o)}function r(e,t,r,p,u){function g(e){return b[e%b.length]}var h=t.join(","),y=h,f=e.crossings[y],x=l(f,r,t),b=[s(e,t,[-x[0],-x[1]])],_=x.join(","),v=e.z.length,m=e.z[0].length,n;for(n=0;1e4>n;n++){if(20<f?(f=c.CHOOSESADDLE[f][0>(x[0]||x[1])?0:1],e.crossings[y]=c.SADDLEREMAINDER[f]):delete e.crossings[y],x=c.NEWDELTA[f],!x){d.log("Found bad marching index:",f,t,e.level);break}b.push(s(e,t,x)),t[0]+=x[0],t[1]+=x[1],a(b[b.length-1],b[b.length-2],p,u)&&b.pop(),y=t.join(",");var w=x[0]&&(0>t[0]||t[0]>m-2)||x[1]&&(0>t[1]||t[1]>v-2),k=y===h&&x.join(",")===_;if(k||r&&w)break;f=e.crossings[y]}1e4===n&&d.log("Infinite loop in contour?");var T=a(b[0],b[b.length-1],p,u),A=0,S=.2*e.smoothing,C=[],L=0,E,z,I,D,P,O,R,M,B,F,N;for(n=1;n<b.length;n++)R=o(b[n],b[n-1]),A+=R,C.push(R);var V=A/C.length*S;for(n=b.length-2;n>=L;n--)if(E=C[n],E<V){for(I=0,z=n-1;z>=L&&E+C[z]<V;z--)E+=C[z];if(T&&n===b.length-2)for(I=0;I<z&&E+C[I]<V;I++)E+=C[I];P=n-z+I+1,O=ea((n+z+I+2)/2),D=T||n!==b.length-2?T||-1!==z?P%2?g(O):[(g(O)[0]+g(O+1)[0])/2,(g(O)[1]+g(O+1)[1])/2]:b[0]:b[b.length-1],b.splice(z+1,n-z+1,D),n=z+1,I&&(L=I),T&&(n===b.length-2?b[I]=b[b.length-1]:0===n&&(b[b.length-1]=b[0]))}for(b.splice(0,L),n=0;n<b.length;n++)b[n].length=2;if(!(2>b.length))if(T)b.pop(),e.paths.push(b);else{r||d.log("Unclosed interior contour?",e.level,h,b.join("L"));var U=!1;for(M=0;M<e.edgepaths.length;M++)if(F=e.edgepaths[M],!U&&a(F[0],b[b.length-1],p,u)){b.pop(),U=!0;var H=!1;for(B=0;B<e.edgepaths.length;B++)if(N=e.edgepaths[B],a(N[N.length-1],b[0],p,u)){H=!0,b.shift(),e.edgepaths.splice(M,1),B===M?e.paths.push(b.concat(N)):(B>M&&B--,e.edgepaths[B]=N.concat(b,F));break}H||(e.edgepaths[M]=b.concat(F))}for(M=0;M<e.edgepaths.length&&!U;M++)F=e.edgepaths[M],a(F[F.length-1],b[0],p,u)&&(b.shift(),e.edgepaths[M]=F.concat(b),U=!0);U||e.edgepaths.push(b)}}function l(e,t,a){var o=0,r=0;return 20<e&&t?208===e||1114===e?o=0===a[0]?1:-1:r=0===a[1]?1:-1:-1===c.BOTTOMSTART.indexOf(e)?-1===c.LEFTSTART.indexOf(e)?-1===c.TOPSTART.indexOf(e)?o=-1:r=-1:o=1:r=1,[o,r]}function s(e,t,a){var o=t[0]+va(a[0],0),r=t[1]+va(a[1],0),i=e.z[r][o],n=e.xaxis,l=e.yaxis;if(a[1]){var s=(e.level-i)/(e.z[r][o+1]-i);return[n.c2p((1-s)*e.x[o]+s*e.x[o+1],!0),l.c2p(e.y[r],!0),o+s,r]}var d=(e.level-i)/(e.z[r+1][o]-i);return[n.c2p(e.x[o],!0),l.c2p((1-d)*e.y[r]+d*e.y[r+1],!0),o,r+d]}var d=e("../../lib"),c=e("./constants");t.exports=function(e,t,a){var o,n,l,s,c;for(t=t||.01,a=a||.01,l=0;l<e.length;l++){for(s=e[l],c=0;c<s.starts.length;c++)n=s.starts[c],r(s,n,"edge",t,a);for(o=0;Object.keys(s.crossings).length&&1e4>o;)o++,n=Object.keys(s.crossings)[0].split(",").map(Number),r(s,n,void 0,t,a);1e4===o&&d.log("Infinite loop in contour?")}}},{"../../lib":692,"./constants":917}],926:[function(e,t){"use strict";var a=e("../../components/color"),o=e("../heatmap/hover");t.exports=function(e,t,r,i,n){var l=o(e,t,r,i,n,!0);return l&&l.forEach(function(e){var t=e.trace;"constraint"===t.contours.type&&(t.fillcolor&&a.opacity(t.fillcolor)?e.color=a.addOpacity(t.fillcolor,1):t.contours.showlines&&a.opacity(t.line.color)&&(e.color=a.addOpacity(t.line.color,1)))}),l}},{"../../components/color":569,"../heatmap/hover":949}],927:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.calc=e("./calc"),a.plot=e("./plot").plot,a.style=e("./style"),a.colorbar=e("./colorbar"),a.hoverPoints=e("./hover"),a.moduleType="trace",a.name="contour",a.basePlotModule=e("../../plots/cartesian"),a.categories=["cartesian","svg","2dMap","contour","showLegend"],a.meta={},t.exports=a},{"../../plots/cartesian":752,"./attributes":913,"./calc":914,"./colorbar":916,"./defaults":922,"./hover":926,"./plot":931,"./style":933}],928:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t,o,r){r||(r={});var i=e("contours.showlabels");if(i){var n=t.font;a.coerceFont(e,"contours.labelfont",{family:n.family,size:n.size,color:o}),e("contours.labelformat")}!1!==r.hasHover&&e("zhoverformat")}},{"../../lib":692}],929:[function(e,t){"use strict";var a=e("d3"),o=e("../../components/colorscale"),r=e("./end_plus");t.exports=function(e){var t=e.contours,n=t.start,l=r(t),s=t.size||1,d=ea((l-n)/s)+1,c="lines"===t.coloring?0:1;isFinite(s)||(s=1,d=1);var p=e.reversescale?o.flipScale(e.colorscale):e.colorscale,u=p.length,g=Array(u),h=Array(u),m,y;if("heatmap"===t.coloring){for(e.zauto&&!1===e.autocontour&&(e.zmin=n-s/2,e.zmax=e.zmin+d*s),y=0;y<u;y++)m=p[y],g[y]=m[0]*(e.zmax-e.zmin)+e.zmin,h[y]=m[1];var f=a.extent([e.zmin,e.zmax,t.start,t.start+s*(d-1)]),x=f[e.zmin<e.zmax?0:1],b=f[e.zmin<e.zmax?1:0];x!==e.zmin&&(g.splice(0,0,x),h.splice(0,0,Range[0])),b!==e.zmax&&(g.push(b),h.push(h[h.length-1]))}else for(y=0;y<u;y++)m=p[y],g[y]=(m[0]*(d+c-1)-c/2)*s+n,h[y]=m[1];return o.makeColorScaleFunc({domain:g,range:h},{noNumericCheck:!0})}},{"../../components/colorscale":581,"./end_plus":924,d3:148}],930:[function(e,t){"use strict";function a(e,t){var a=(t[0][0]>e?0:1)+(t[0][1]>e?0:2)+(t[1][1]>e?0:4)+(t[1][0]>e?0:8);if(5==a||10==a){var o=(t[0][0]+t[0][1]+t[1][0]+t[1][1])/4;return e>o?5==a?713:1114:5==a?104:208}return 15==a?0:a}var o=e("./constants");t.exports=function(e){var t=e[0].z,r=t.length,l=t[0].length,n,s,d,c,p,u,g,h,m;for(s=0;s<r-1;s++)for(c=[],0===s&&(c=c.concat(o.BOTTOMSTART)),s===r-2&&(c=c.concat(o.TOPSTART)),n=0;n<l-1;n++)for(d=c.slice(),0===n&&(d=d.concat(o.LEFTSTART)),n===l-2&&(d=d.concat(o.RIGHTSTART)),p=n+","+s,u=[[t[s][n],t[s][n+1]],[t[s+1][n],t[s+1][n+1]]],m=0;m<e.length;m++)h=e[m],g=a(h.level,u),g&&(h.crossings[p]=g,-1!==d.indexOf(g)&&(h.starts.push([n,s]),(2===r||2===l)&&-1!==d.indexOf(g,d.indexOf(g)+1)&&h.starts.push([n,s])))}},{"./constants":917}],931:[function(e,t,a){"use strict";function o(e,t,a){var o=g.ensureSingle(e,"g","contourbg"),r=o.selectAll("path").data("fill"===a.coloring?[0]:[]);r.enter().append("path"),r.exit().remove(),r.attr("d","M"+t.join("L")+"Z").style("stroke","none")}function r(e,t,a,o){var r=g.ensureSingle(e,"g","contourfill"),i=r.selectAll("path").data("fill"===o.coloring||"constraint"===o.type&&"="!==o._operation?t:[]);i.enter().append("path"),i.exit().remove(),i.each(function(e){var t=l(e,a);t?u.select(this).attr("d",t).style("stroke","none"):u.select(this).remove()})}function n(e,t){var a=e.prefixBoundary;if(a===void 0){var o=ie(e.z[0][0],e.z[0][1]);a=!e.edgepaths.length&&o>e.level}return a?"M"+t.join("L")+"Z":""}function l(e,t){function a(e){return .01>wa(e[1]-t[0][1])}function o(e){return .01>wa(e[1]-t[2][1])}function r(e){return .01>wa(e[0]-t[0][0])}function l(e){return .01>wa(e[0]-t[2][0])}for(var s=n(e,t),d=0,c=e.edgepaths.map(function(e,t){return t}),p=!0,u,m,y,f,x,b;c.length;){for(b=h.smoothopen(e.edgepaths[d],e.smoothing),s+=p?b:b.replace(/^M/,"L"),c.splice(c.indexOf(d),1),u=e.edgepaths[d][e.edgepaths[d].length-1],f=-1,y=0;4>y;y++){if(!u){g.log("Missing end?",d,e);break}for(a(u)&&!l(u)?m=t[1]:r(u)?m=t[0]:o(u)?m=t[3]:l(u)&&(m=t[2]),x=0;x<e.edgepaths.length;x++){var _=e.edgepaths[x][0];.01>wa(u[0]-m[0])?.01>wa(u[0]-_[0])&&0<=(_[1]-u[1])*(m[1]-_[1])&&(m=_,f=x):.01>wa(u[1]-m[1])?.01>wa(u[1]-_[1])&&0<=(_[0]-u[0])*(m[0]-_[0])&&(m=_,f=x):g.log("endpt to newendpt is not vert. or horz.",u,m,_)}if(u=m,0<=f)break;s+="L"+m}if(f===e.edgepaths.length){g.log("unclosed perimeter path");break}d=f,p=-1===c.indexOf(d),p&&(d=c[0],s+="Z")}for(d=0;d<e.paths.length;d++)s+=h.smoothclosed(e.paths[d],e.smoothing);return s}function s(e,t,o,r,i,n){var l=g.ensureSingle(e,"g","contourlines"),s=!1!==i.showlines,d=i.showlabels,c=s&&d,p=a.createLines(l,s||d,t),m=a.createLineClip(l,c,o,r.trace.uid),y=e.selectAll("g.contourlabels").data(d?[0]:[]);if(y.exit().remove(),y.enter().append("g").classed("contourlabels",!0),d){var f=[],x=[];g.clearLocationCache();var b=a.labelFormatter(i,r.t.cb,o._fullLayout),_=h.tester.append("text").attr("data-notex",1).call(h.font,i.labelfont),v=t[0].xaxis,w=t[0].yaxis,k=v._length,T=w._length,S=v.range,C=w.range,L=va(n[0][0],0),E=ie(n[2][0],k),z=va(n[0][1],0),I=ie(n[2][1],T),D={};S[0]<S[1]?(D.left=L,D.right=E):(D.left=E,D.right=L),C[0]<C[1]?(D.top=z,D.bottom=I):(D.top=I,D.bottom=z),D.middle=(D.top+D.bottom)/2,D.center=(D.left+D.right)/2,f.push([[D.left,D.top],[D.right,D.top],[D.right,D.bottom],[D.left,D.bottom]]);var P=re(k*k+T*T),O=A.LABELDISTANCE*P/va(1,t.length/A.LABELINCREASE);p.each(function(e){var t=a.calcTextOpts(e.level,b,_,o);u.select(this).selectAll("path").each(function(){var e=this,o=g.getVisibleSegment(e,D,t.height/2);if(o&&!(o.len<(t.width+t.height)*A.LABELMIN))for(var r=ie(ae(o.len/O),A.LABELMAX),n=0,l;n<r&&(l=a.findBestTextLocation(e,o,t,x,D),!!l);n++)a.addLabelData(l,t,x,f)})}),_.remove(),a.drawLabels(y,x,o,m,c?f:null)}d&&!s&&p.remove()}function d(e,t,a,o){var r=t.width/2,n=t.height/2,l=e.x,s=e.y,d=e.theta,c=te(d)*r,p=M(d)*r,u=(l>o.center?o.right-l:l-o.left)/(c+wa(M(d)*n)),h=(s>o.middle?o.bottom-s:s-o.top)/(wa(p)+te(d)*n);if(1>u||1>h)return 1/0;var m=S.EDGECOST*(1/(u-1)+1/(h-1));m+=S.ANGLECOST*d*d;for(var y=0;y<a.length;y++){var f=a[y],x=te(f.theta)*f.width/2,b=M(f.theta)*f.width/2,_=2*g.segmentDistance(l-c,s-p,l+c,s+p,f.x-x,f.y-b,f.x+x,f.y+b)/(t.height+f.height),v=f.level===t.level,w=v?S.SAMELEVELDISTANCE:1;if(_<=w)return 1/0;var k=S.NEIGHBORCOST*(v?S.SAMELEVELFACTOR:1);m+=k/(_-w)}return m}function c(e,t,a,o,r){var i=a._fullLayout._clips,n="clip"+o.trace.uid,s=i.selectAll("#"+n).data(o.trace.connectgaps?[]:[0]);if(s.enter().append("clipPath").classed("contourclip",!0).attr("id",n),s.exit().remove(),!1===o.trace.connectgaps){var d={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:t.xaxis,yaxis:t.yaxis,x:o.x,y:o.y,z:p(o),smoothing:0};_([d]),v([d]);var c=l(d,r),u=g.ensureSingle(s,"path","");u.attr("d",c)}else n=null;h.setClipUrl(e,n,a)}function p(e){var t=e.trace._emptypoints,a=[],o=e.z.length,r=e.z[0].length,n=[],l,s;for(l=0;l<r;l++)n.push(1);for(l=0;l<o;l++)a.push(n.slice());for(l=0;l<t.length;l++)s=t[l],a[s[0]][s[1]]=0;return e.zmask=a,a}var u=e("d3"),g=e("../../lib"),h=e("../../components/drawing"),m=e("../../lib/svg_text_utils"),y=e("../../plots/cartesian/axes"),f=e("../../plots/cartesian/set_convert"),b=e("../heatmap/plot"),_=e("./make_crossings"),v=e("./find_all_paths"),w=e("./empty_pathinfo"),k=e("./convert_to_constraints"),T=e("./close_boundaries"),A=e("./constants"),S=A.LABELOPTIMIZER;a.plot=function(e,t,a,i){var n=t.xaxis,l=t.yaxis;g.makeTraceGroups(i,a,"contour").each(function(a){var i=u.select(this),d=a[0],p=d.trace,h=d.x,m=d.y,y=p.contours,f=w(y,t,d),x=g.ensureSingle(i,"g","heatmapcoloring"),A=[];"heatmap"===y.coloring&&(p.zauto&&!1===p.autocontour&&(p._input.zmin=p.zmin=y.start-y.size/2,p._input.zmax=p.zmax=p.zmin+f.length*y.size),A=[a]),b(e,t,A,x),_(f),v(f);var S=n.c2p(h[0],!0),C=n.c2p(h[h.length-1],!0),L=l.c2p(m[0],!0),E=l.c2p(m[m.length-1],!0),z=[[S,E],[C,E],[C,L],[S,L]],I=f;"constraint"===y.type&&(I=k(f,y._operation),T(I,y._operation,z,p)),o(i,z,y),r(i,I,z,y),s(i,f,e,d,y,z),c(i,t,e,d,z)})},a.createLines=function(e,t,a){var o=a[0].smoothing,r=e.selectAll("g.contourlevel").data(t?a:[]);if(r.exit().remove(),r.enter().append("g").classed("contourlevel",!0),t){var i=r.selectAll("path.openline").data(function(e){return e.pedgepaths||e.edgepaths});i.exit().remove(),i.enter().append("path").classed("openline",!0),i.attr("d",function(e){return h.smoothopen(e,o)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var n=r.selectAll("path.closedline").data(function(e){return e.ppaths||e.paths});n.exit().remove(),n.enter().append("path").classed("closedline",!0),n.attr("d",function(e){return h.smoothclosed(e,o)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return r},a.createLineClip=function(e,t,a,o){var r=a._fullLayout._clips,i=t?"clipline"+o:null,n=r.selectAll("#"+i).data(t?[0]:[]);return n.exit().remove(),n.enter().append("clipPath").classed("contourlineclip",!0).attr("id",i),h.setClipUrl(e,i,a),n},a.labelFormatter=function(e,t,a){if(e.labelformat)return a._d3locale.numberFormat(e.labelformat);var o;if(t)o=t.axis;else{if(o={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"},"constraint"===e.type){var r=e.value;o.range=Array.isArray(r)?[r[0],r[r.length-1]]:[r,r]}else o.range=[e.start,e.end],o.nticks=(e.end-e.start)/e.size;o.range[0]===o.range[1]&&(o.range[1]+=o.range[0]||1),o.nticks||(o.nticks=1e3),f(o,a),y.prepTicks(o),o._tmin=null,o._tmax=null}return function(e){return y.tickText(o,e).text}},a.calcTextOpts=function(e,t,a,o){var r=t(e);a.text(r).call(m.convertToTspans,o);var i=h.bBox(a.node(),!0);return{text:r,width:i.width,height:i.height,level:e,dy:(i.top+i.bottom)/2}},a.findBestTextLocation=function(e,t,a,o,r){var i=a.width,n,l,s,c,u;t.isClosed?(l=t.len/S.INITIALSEARCHPOINTS,n=t.min+l/2,s=t.max):(l=(t.len-i)/(S.INITIALSEARCHPOINTS+1),n=t.min+l+i/2,s=t.max-(l+i)/2);for(var h=1/0,m=0;m<S.ITERATIONS;m++){for(var y=n;y<s;y+=l){var f=g.getTextLocation(e,t.total,y,i),x=d(f,a,o,r);x<h&&(h=x,u=f,c=y)}if(h>2*S.MAXCOST)break;m&&(l/=2),n=c-l/2,s=n+1.5*l}if(h<=S.MAXCOST)return u},a.addLabelData=function(e,t,a,o){var r=t.width/2,i=t.height/2,n=e.x,l=e.y,s=e.theta,d=M(s),c=te(s),p=r*c,u=i*d,g=r*d,h=-i*c;a.push({text:t.text,x:n,y:l,dy:t.dy,theta:s,level:t.level,width:t.width,height:t.height}),o.push([[n-p-u,l-g-h],[n+p-u,l+g-h],[n+p+u,l+g+h],[n-p+u,l-g+h]])},a.drawLabels=function(e,t,a,o,r){var n=e.selectAll("text").data(t,function(e){return e.text+","+e.x+","+e.y+","+e.theta});if(n.exit().remove(),n.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(e){var t=e.x+M(e.theta)*e.dy,o=e.y-te(e.theta)*e.dy;u.select(this).text(e.text).attr({x:t,y:o,transform:"rotate("+180*e.theta/Sa+" "+t+" "+o+")"}).call(m.convertToTspans,a)}),r){for(var l="",s=0;s<r.length;s++)l+="M"+r[s].join("L")+"Z";var d=g.ensureSingle(o,"path","");d.attr("d",l)}}},{"../../components/drawing":590,"../../lib":692,"../../lib/svg_text_utils":716,"../../plots/cartesian/axes":740,"../../plots/cartesian/set_convert":759,"../heatmap/plot":953,"./close_boundaries":915,"./constants":917,"./convert_to_constraints":921,"./empty_pathinfo":923,"./find_all_paths":925,"./make_crossings":930,d3:148}],932:[function(e,t){"use strict";function a(e,t,a){var r={type:"linear",range:[e,t]};return o.autoTicks(r,(t-e)/(a||15)),r}var o=e("../../plots/cartesian/axes"),r=e("../../lib");t.exports=function(e){var t=e.contours;if(e.autocontour){var i=e.zmin,n=e.zmax;(i===void 0||n===void 0)&&(i=r.aggNums(Math.min,null,e._z),n=r.aggNums(Math.max,null,e._z));var l=a(i,n,e.ncontours);t.size=l.dtick,t.start=o.tickFirst(l),l.range.reverse(),t.end=o.tickFirst(l),t.start===i&&(t.start+=t.size),t.end===n&&(t.end-=t.size),t.start>t.end&&(t.start=t.end=(t.start+t.end)/2),e._input.contours||(e._input.contours={}),r.extendFlat(e._input.contours,{start:t.start,end:t.end,size:t.size}),e._input.autocontour=!0}else if("constraint"!==t.type){var s=t.start,d=t.end,c=e._input.contours;if(s>d&&(t.start=c.start=d,d=t.end=c.end=s,s=t.start),!(0<t.size)){var p;p=s===d?1:a(s,d,e.ncontours).dtick,c.size=t.size=p}}}},{"../../lib":692,"../../plots/cartesian/axes":740}],933:[function(e,t){"use strict";var a=e("d3"),o=e("../../components/drawing"),r=e("../heatmap/style"),i=e("./make_color_map");t.exports=function(e){var t=a.select(e).selectAll("g.contour");t.style("opacity",function(e){return e[0].trace.opacity}),t.each(function(e){var t=a.select(this),r=e[0].trace,n=r.contours,l=r.line,s=n.size||1,d=n.start,c="constraint"===n.type,p=!c&&"lines"===n.coloring,u=!c&&"fill"===n.coloring,g=p||u?i(r):null;t.selectAll("g.contourlevel").each(function(e){a.select(this).selectAll("path").call(o.lineGroupStyle,l.width,p?g(e.level):l.color,l.dash)});var h=n.labelfont;if(t.selectAll("g.contourlabels text").each(function(e){o.font(a.select(this),{family:h.family,size:h.size,color:h.color||(p?g(e.level):l.color)})}),c)t.selectAll("g.contourfill path").style("fill",r.fillcolor);else if(u){var m;t.selectAll("g.contourfill path").style("fill",function(e){return void 0===m&&(m=e.level),g(e.level+.5*s)}),void 0===m&&(m=d),t.selectAll("g.contourbg path").style("fill",g(m-.5*s))}}),r(e)}},{"../../components/drawing":590,"../heatmap/style":954,"./make_color_map":929,d3:148}],934:[function(e,t){"use strict";var a=e("../../components/colorscale/defaults"),o=e("./label_defaults");t.exports=function(e,t,r,i,n){var l=r("contours.coloring"),s="",d;"fill"===l&&(d=r("contours.showlines")),!1!==d&&("lines"!==l&&(s=r("line.color","#000")),r("line.width",.5),r("line.dash")),"none"!==l&&(!0!==e.showlegend&&(t.showlegend=!1),t._dfltShowLegend=!1,a(e,t,i,r,{prefix:"",cLetter:"z"})),r("line.smoothing"),o(r,i,s,n)}},{"../../components/colorscale/defaults":579,"./label_defaults":928}],935:[function(e,t){"use strict";var a=e("../heatmap/attributes"),o=e("../contour/attributes"),r=o.contours,i=e("../scatter/attributes"),n=e("../../components/colorscale/attributes"),l=e("../../components/colorbar/attributes"),s=e("../../lib/extend").extendFlat,d=i.line;t.exports=s({carpet:{valType:"string",editType:"calc"},z:a.z,a:a.x,a0:a.x0,da:a.dx,b:a.y,b0:a.y0,db:a.dy,text:a.text,transpose:a.transpose,atype:a.xtype,btype:a.ytype,fillcolor:o.fillcolor,autocontour:o.autocontour,ncontours:o.ncontours,contours:{type:r.type,start:r.start,end:r.end,size:r.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:r.showlines,showlabels:r.showlabels,labelfont:r.labelfont,labelformat:r.labelformat,operation:r.operation,value:r.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:s({},d.color,{}),width:d.width,dash:d.dash,smoothing:s({},d.smoothing,{}),editType:"plot"},transforms:void 0},n("",{cLetter:"z",autoColorDflt:!1}),{colorbar:l})},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../lib/extend":682,"../contour/attributes":913,"../heatmap/attributes":942,"../scatter/attributes":1040}],936:[function(e,t){"use strict";function a(e,t){var c=t._carpetTrace,p=c.aaxis,u=c.baxis,g,h,m,y,f,x,_;p._minDtick=0,u._minDtick=0,r.isArray1D(t.z)&&i(t,p,u,"a","b",["z"]),g=t._a=t._a||t.a,y=t._b=t._b||t.b,g=g?p.makeCalcdata(t,"_a"):[],y=y?u.makeCalcdata(t,"_b"):[],h=t.a0||0,m=t.da||1,f=t.b0||0,x=t.db||1,_=t._z=n(t._z||t.z,t.transpose),t._emptypoints=s(_),l(_,t._emptypoints);var v=r.maxRowLength(_),w="scaled"===t.xtype?"":g,k=d(t,w,h,m,v,p),T="scaled"===t.ytype?"":y,A=d(t,T,f,x,_.length,u),S={a:k,b:A,z:_};return"levels"===t.contours.type&&"none"!==t.contours.coloring&&o(e,t,{vals:_,containerStr:"",cLetter:"z"}),[S]}var o=e("../../components/colorscale/calc"),r=e("../../lib"),i=e("../heatmap/convert_column_xyz"),n=e("../heatmap/clean_2d_array"),l=e("../heatmap/interp2d"),s=e("../heatmap/find_empties"),d=e("../heatmap/make_bound_array"),c=e("./defaults"),p=e("../carpet/lookup_carpetid"),u=e("../contour/set_contours");t.exports=function(e,t){var o=t._carpetTrace=p(e,t);if(o&&o.visible&&"legendonly"!==o.visible){if(!t.a||!t.b){var r=e.data[o.index],i=e.data[t.index];i.a||(i.a=r.a),i.b||(i.b=r.b),c(i,t,t._defaultColor,e._fullLayout)}var n=a(e,t);return u(t),n}}},{"../../components/colorscale/calc":577,"../../lib":692,"../carpet/lookup_carpetid":891,"../contour/set_contours":932,"../heatmap/clean_2d_array":944,"../heatmap/convert_column_xyz":946,"../heatmap/find_empties":948,"../heatmap/interp2d":951,"../heatmap/make_bound_array":952,"./defaults":937}],937:[function(e,t){"use strict";var a=e("../../lib"),o=e("../heatmap/xyz_defaults"),r=e("./attributes"),i=e("../contour/constraint_defaults"),n=e("../contour/contours_defaults"),l=e("../contour/style_defaults");t.exports=function(e,t,s,d){function c(o,i){return a.coerce(e,t,r,o,i)}function p(o){return a.coerce2(e,t,r,o)}if(c("carpet"),e.a&&e.b){var u=o(e,t,c,d,"a","b");if(!u)return void(t.visible=!1);c("text");var g="constraint"===c("contours.type");g?i(e,t,c,d,s,{hasHover:!1}):(n(e,t,c,p),l(e,t,c,d,{hasHover:!1}))}else t._defaultColor=s,t._length=null}},{"../../lib":692,"../contour/constraint_defaults":918,"../contour/contours_defaults":920,"../contour/style_defaults":934,"../heatmap/xyz_defaults":956,"./attributes":935}],938:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.colorbar=e("../contour/colorbar"),a.calc=e("./calc"),a.plot=e("./plot"),a.style=e("../contour/style"),a.moduleType="trace",a.name="contourcarpet",a.basePlotModule=e("../../plots/cartesian"),a.categories=["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent"],a.meta={},t.exports=a},{"../../plots/cartesian":752,"../contour/colorbar":916,"../contour/style":933,"./attributes":935,"./calc":936,"./defaults":937,"./plot":941}],939:[function(e,t){"use strict";var a=e("../../components/drawing"),o=e("../carpet/axis_aligned_line"),r=e("../../lib");t.exports=function(e,t,n,l,s,d,c,p){function u(e){return wa(e[1]-n[0][1])<v}function g(e){return wa(e[1]-n[2][1])<v}function h(e){return wa(e[0]-n[0][0])<_}function m(e){return wa(e[0]-n[2][0])<_}function y(e,t){var a="",r,n,l,y;for(u(e)&&!m(e)||g(e)&&!h(e)?(y=s.aaxis,l=o(s,d,[e[0],t[0]],.5*(e[1]+t[1]))):(y=s.baxis,l=o(s,d,.5*(e[0]+t[0]),[e[1],t[1]])),r=1;r<l.length;r++)for(a+=y.smoothing?"C":"L",n=0;n<l[r].length;n++){var f=l[r][n];a+=[c.c2p(f[0]),p.c2p(f[1])]+" "}return a}var f="",x=t.edgepaths.map(function(e,t){return t}),b=!0,_=1e-4*wa(n[0][0]-n[2][0]),v=1e-4*wa(n[0][1]-n[2][1]),w,k,T,A,S,C,L;for(w=0,k=null;x.length;){var E=t.edgepaths[w][0];for(k&&(f+=y(k,E)),L=a.smoothopen(t.edgepaths[w].map(l),t.smoothing),f+=b?L:L.replace(/^M/,"L"),x.splice(x.indexOf(w),1),k=t.edgepaths[w][t.edgepaths[w].length-1],S=-1,A=0;4>A;A++){if(!k){r.log("Missing end?",w,t);break}for(u(k)&&!m(k)?T=n[1]:h(k)?T=n[0]:g(k)?T=n[3]:m(k)&&(T=n[2]),C=0;C<t.edgepaths.length;C++){var z=t.edgepaths[C][0];wa(k[0]-T[0])<_?wa(k[0]-z[0])<_&&0<=(z[1]-k[1])*(T[1]-z[1])&&(T=z,S=C):wa(k[1]-T[1])<v?wa(k[1]-z[1])<v&&0<=(z[0]-k[0])*(T[0]-z[0])&&(T=z,S=C):r.log("endpt to newendpt is not vert. or horz.",k,T,z)}if(0<=S)break;f+=y(k,T),k=T}if(S===t.edgepaths.length){r.log("unclosed perimeter path");break}w=S,b=-1===x.indexOf(w),b&&(w=x[0],f+=y(k,T)+"Z",k=null)}for(w=0;w<t.paths.length;w++)f+=a.smoothclosed(t.paths[w].map(l),t.smoothing);return f}},{"../../components/drawing":590,"../../lib":692,"../carpet/axis_aligned_line":875}],940:[function(e,t){"use strict";t.exports=function(e,t){var a,o,r,n,l,s,d,c,p;for(a=0;a<e.length;a++){for(n=e[a],l=n.pedgepaths=[],s=n.ppaths=[],o=0;o<n.edgepaths.length;o++){for(p=n.edgepaths[o],d=[],r=0;r<p.length;r++)d[r]=t(p[r]);l.push(d)}for(o=0;o<n.paths.length;o++){for(p=n.paths[o],c=[],r=0;r<p.length;r++)c[r]=t(p[r]);s.push(c)}}}},{}],941:[function(e,t){"use strict";function o(e,t,a,o,i,n,l){var s=g.ensureSingle(e,"g","contourlines"),d=!1!==i.showlines,p=i.showlabels,h=d&&p,m=y.createLines(s,d||p,t),x=y.createLineClip(s,h,a,o.trace.uid),b=e.selectAll("g.contourlabels").data(p?[0]:[]);if(b.exit().remove(),b.enter().append("g").classed("contourlabels",!0),p){var _=n.xaxis,v=n.yaxis,w=_._length,k=v._length,T=[[[0,0],[w,0],[w,k],[0,k]]],A=[];g.clearLocationCache();var S=y.labelFormatter(i,o.t.cb,a._fullLayout),C=u.tester.append("text").attr("data-notex",1).call(u.font,i.labelfont),L={left:0,right:w,center:w/2,top:0,bottom:k,middle:k/2},E=re(w*w+k*k),z=f.LABELDISTANCE*E/va(1,t.length/f.LABELINCREASE);m.each(function(e){var t=y.calcTextOpts(e.level,S,C,a);c.select(this).selectAll("path").each(function(a){var o=this,n=g.getVisibleSegment(o,L,t.height/2);if(n&&(r(o,a,e,n,l,t.height),!(n.len<(t.width+t.height)*f.LABELMIN)))for(var s=ie(ae(n.len/z),f.LABELMAX),d=0,c;d<s&&(c=y.findBestTextLocation(o,n,t,A,L),!!c);d++)y.addLabelData(c,t,A,T)})}),C.remove(),y.drawLabels(b,A,a,x,h?T:null)}p&&!d&&m.remove()}function r(e,t,a,o,r,s){function d(e,t){var a=0,o=.1,i;return(wa(e[0]-u)<o||wa(e[0]-g)<o)&&(i=n(r.dxydb_rough(e[0],e[1],o)),a=va(a,s*l(t,i)/2)),(wa(e[1]-h)<o||wa(e[1]-m)<o)&&(i=n(r.dxyda_rough(e[0],e[1],o)),a=va(a,s*l(t,i)/2)),a}for(var c=0,p;c<a.pedgepaths.length;c++)t===a.pedgepaths[c]&&(p=a.edgepaths[c]);if(p){var u=r.a[0],g=r.a[r.a.length-1],h=r.b[0],m=r.b[r.b.length-1],y=i(e,0,1),f=i(e,o.total,o.total-1),x=d(p[0],y),b=o.total-d(p[p.length-1],f);o.min<x&&(o.min=x),o.max>b&&(o.max=b),o.len=o.max-o.min}}function i(e,t,a){var o=e.getPointAtLength(t),r=e.getPointAtLength(a),i=r.x-o.x,n=r.y-o.y,l=re(i*i+n*n);return[i/l,n/l]}function n(e){var t=re(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]}function l(e,t){var a=wa(e[0]*t[0]+e[1]*t[1]),o=re(1-a*a);return o/a}function s(e,t,o,r,n,l){var s=g.ensureSingle(e,"g","contourbg"),d=s.selectAll("path").data("fill"!==l||n?[]:[0]),c,u,h,m;d.enter().append("path"),d.exit().remove();var y=[];for(m=0;m<t.length;m++)c=t[m],u=a([],c.x,o.c2p),h=a([],c.y,r.c2p),y.push(p(u,h,c.bicubic));d.attr("d","M"+y.join("L")+"Z").style("stroke","none")}function d(e,t,a,o,r,i,n,l,s,d,p){var u=g.ensureSingle(t,"g","contourfill"),h=u.selectAll("path").data("fill"===d?r:[]);h.enter().append("path"),h.exit().remove(),h.each(function(t){var r=b(e,t,i,n,l,s,a,o);t.prefixBoundary&&(r=p+r),r?c.select(this).attr("d",r).style("stroke","none"):c.select(this).remove()})}var c=e("d3"),a=e("../carpet/map_1d_array"),p=e("../carpet/makepath"),u=e("../../components/drawing"),g=e("../../lib"),h=e("../contour/make_crossings"),m=e("../contour/find_all_paths"),y=e("../contour/plot"),f=e("../contour/constants"),x=e("../contour/convert_to_constraints"),b=e("./join_all_paths"),_=e("../contour/empty_pathinfo"),v=e("./map_pathinfo"),w=e("../carpet/lookup_carpetid"),k=e("../contour/close_boundaries");t.exports=function(e,t,r,i){var n=t.xaxis,l=t.yaxis;g.makeTraceGroups(i,r,"contour").each(function(r){function g(e){var t=A.ab2xy(e[0],e[1],!0);return[n.c2p(t[0]),l.c2p(t[1])]}var y=c.select(this),f=r[0],T=f.trace,A=T._carpetTrace=w(e,T),S=e.calcdata[A.index][0];if(A.visible&&"legendonly"!==A.visible){var C=f.a,L=f.b,b=T.contours,E=_(b,t,f),z="constraint"===b.type,I=b._operation,D=z?"="===I?"lines":"fill":b.coloring,P=[[C[0],L[L.length-1]],[C[C.length-1],L[L.length-1]],[C[C.length-1],L[0]],[C[0],L[0]]];h(E);var O=1e-8*(C[C.length-1]-C[0]),R=1e-8*(L[L.length-1]-L[0]);m(E,O,R);var M=E;"constraint"===b.type&&(M=x(E,I),k(M,I,P,T)),v(E,g);var j=[],B,F,N,V;for(V=S.clipsegments.length-1;0<=V;V--)B=S.clipsegments[V],F=a([],B.x,n.c2p),N=a([],B.y,l.c2p),F.reverse(),N.reverse(),j.push(p(F,N,B.bicubic));var U="M"+j.join("L")+"Z";s(y,S.clipsegments,n,l,z,D),d(T,y,n,l,M,P,g,A,S,D,U),o(y,E,e,f,b,t,A),u.setClipUrl(y,A._clipPathId,e)}})}},{"../../components/drawing":590,"../../lib":692,"../carpet/lookup_carpetid":891,"../carpet/makepath":892,"../carpet/map_1d_array":893,"../contour/close_boundaries":915,"../contour/constants":917,"../contour/convert_to_constraints":921,"../contour/empty_pathinfo":923,"../contour/find_all_paths":925,"../contour/make_crossings":930,"../contour/plot":931,"./join_all_paths":939,"./map_pathinfo":940,d3:148}],942:[function(e,t){"use strict";var a=e("../scatter/attributes"),o=e("../../components/colorscale/attributes"),r=e("../../components/colorbar/attributes"),i=e("../../lib/extend").extendFlat;t.exports=i({z:{valType:"data_array",editType:"calc"},x:i({},a.x,{impliedEdits:{xtype:"array"}}),x0:i({},a.x0,{impliedEdits:{xtype:"scaled"}}),dx:i({},a.dx,{impliedEdits:{xtype:"scaled"}}),y:i({},a.y,{impliedEdits:{ytype:"array"}}),y0:i({},a.y0,{impliedEdits:{ytype:"scaled"}}),dy:i({},a.dy,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},zhoverformat:{valType:"string",dflt:"",editType:"none"},transforms:void 0},o("",{cLetter:"z",autoColorDflt:!1}),{colorbar:r})},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../lib/extend":682,"../scatter/attributes":1040}],943:[function(e,t){"use strict";var a=e("../../registry"),o=e("../../lib"),r=e("../../plots/cartesian/axes"),n=e("../histogram2d/calc"),l=e("../../components/colorscale/calc"),s=e("./convert_column_xyz"),d=e("./clean_2d_array"),c=e("./interp2d"),p=e("./find_empties"),u=e("./make_bound_array");t.exports=function(e,t){function g(e){v=t._input.zsmooth=t.zsmooth=!1,o.warn("cannot use zsmooth: \"fast\": "+e)}var h=r.getFromId(e,t.xaxis||"x"),m=r.getFromId(e,t.yaxis||"y"),f=a.traceIs(t,"contour"),b=a.traceIs(t,"histogram"),_=a.traceIs(t,"gl2d"),v=f?"best":t.zsmooth,w,k,T,A,S,C,L,E,I;if(h._minDtick=0,m._minDtick=0,b)I=n(e,t),w=I.x,k=I.x0,T=I.dx,A=I.y,S=I.y0,C=I.dy,L=I.z;else{var D=t.z;o.isArray1D(D)?(s(t,h,m,"x","y",["z"]),w=t._x,A=t._y,D=t._z):(w=t.x?h.makeCalcdata(t,"x"):[],A=t.y?m.makeCalcdata(t,"y"):[]),k=t.x0||0,T=t.dx||1,S=t.y0||0,C=t.dy||1,L=d(D,t.transpose),(f||t.connectgaps)&&(t._emptypoints=p(L),c(L,t._emptypoints))}if("fast"===v)if("log"===h.type||"log"===m.type)g("log axis found");else if(!b){if(w.length){var P=(w[w.length-1]-w[0])/(w.length-1),O=wa(P/100);for(E=0;E<w.length-1;E++)if(wa(w[E+1]-w[E]-P)>O){g("x scale is not linear");break}}if(A.length&&"fast"===v){var R=(A[A.length-1]-A[0])/(A.length-1),M=wa(R/100);for(E=0;E<A.length-1;E++)if(wa(A[E+1]-A[E]-R)>M){g("y scale is not linear");break}}}var j=o.maxRowLength(L),B="scaled"===t.xtype?"":w,F=u(t,B,k,T,j,h),N="scaled"===t.ytype?"":A,V=u(t,N,S,C,L.length,m);_||(t._extremes[h._id]=r.findExtremes(h,F),t._extremes[m._id]=r.findExtremes(m,V));var U={x:F,y:V,z:L,text:t._text||t.text};if(B&&B.length===F.length-1&&(U.xCenter=B),N&&N.length===V.length-1&&(U.yCenter=N),b&&(U.xRanges=I.xRanges,U.yRanges=I.yRanges,U.pts=I.pts),f&&"constraint"===t.contours.type||l(e,t,{vals:L,containerStr:"",cLetter:"z"}),f&&t.contours&&"heatmap"===t.contours.coloring){var H={type:"contour"===t.type?"heatmap":"histogram2d",xcalendar:t.xcalendar,ycalendar:t.ycalendar};U.xfill=u(H,B,k,T,j,h),U.yfill=u(H,N,S,C,L.length,m)}return[U]}},{"../../components/colorscale/calc":577,"../../lib":692,"../../plots/cartesian/axes":740,"../../registry":823,"../histogram2d/calc":974,"./clean_2d_array":944,"./convert_column_xyz":946,"./find_empties":948,"./interp2d":951,"./make_bound_array":952}],944:[function(e,t){"use strict";var a=e("fast-isnumeric");t.exports=function(e,t){function o(e){return a(e)?+e:void 0}var r,n,l,s,d,c;if(t){for(r=0,d=0;d<e.length;d++)r=va(r,e[d].length);if(0===r)return!1;l=function(e){return e.length},s=function(e,t,a){return e[a][t]}}else r=e.length,l=function(e,t){return e[t].length},s=function(e,t,a){return e[t][a]};var p=Array(r);for(d=0;d<r;d++)for(n=l(e,d),p[d]=Array(n),c=0;c<n;c++)p[d][c]=o(s(e,d,c));return p}},{"fast-isnumeric":214}],945:[function(e,t){"use strict";t.exports={min:"zmin",max:"zmax"}},{}],946:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../constants/numerical").BADNUM;t.exports=function(e,t,r,n,l,s){var d=e._length,c=t.makeCalcdata(e,n),p=r.makeCalcdata(e,l),u=e.text,g=u!==void 0&&a.isArray1D(u),h=a.distinctVals(c),m=h.vals,y=a.distinctVals(p),f=y.vals,x=[],b,_,v;for(b=0;b<s.length;b++)x[b]=a.init2dArray(f.length,m.length);for(g&&(v=a.init2dArray(f.length,m.length)),b=0;b<d;b++)if(c[b]!==o&&p[b]!==o){var w=a.findBin(c[b]+h.minDiff/2,m),k=a.findBin(p[b]+y.minDiff/2,f);for(_=0;_<s.length;_++){var T=s[_],A=e[T],S=x[_];S[k][w]=A[b]}g&&(v[k][w]=u[b])}for(e["_"+n]=m,e["_"+l]=f,_=0;_<s.length;_++)e["_"+s[_]]=x[_];g&&(e._text=v)}},{"../../constants/numerical":669,"../../lib":692}],947:[function(e,t){"use strict";var a=e("../../lib"),o=e("./xyz_defaults"),r=e("./style_defaults"),i=e("../../components/colorscale/defaults"),n=e("./attributes");t.exports=function(e,t,l,s){function d(o,r){return a.coerce(e,t,n,o,r)}var c=o(e,t,d,s);return c?void(d("text"),r(e,t,d,s),d("connectgaps",a.isArray1D(t.z)&&!1!==t.zsmooth),i(e,t,s,d,{prefix:"",cLetter:"z"})):void(t.visible=!1)}},{"../../components/colorscale/defaults":579,"../../lib":692,"./attributes":942,"./style_defaults":955,"./xyz_defaults":956}],948:[function(e,t){"use strict";var a=e("../../lib").maxRowLength;t.exports=function(e){var t=[],o={},r=[],n=e[0],l=[],s=[0,0,0],d=a(e),c,u,g,h,m,y,f,x;for(u=0;u<e.length;u++)for(c=l,l=n,n=e[u+1]||[],g=0;g<d;g++)void 0===l[g]&&(y=(void 0===l[g-1]?0:1)+(void 0===l[g+1]?0:1)+(void 0===c[g]?0:1)+(void 0===n[g]?0:1),y?(0===u&&y++,0===g&&y++,u===e.length-1&&y++,g===l.length-1&&y++,4>y&&(o[[u,g]]=[u,g,y]),t.push([u,g,y])):r.push([u,g]));for(;r.length;){for(f={},x=!1,m=r.length-1;0<=m;m--)h=r[m],u=h[0],g=h[1],y=((o[[u-1,g]]||s)[2]+(o[[u+1,g]]||s)[2]+(o[[u,g-1]]||s)[2]+(o[[u,g+1]]||s)[2])/20,y&&(f[h]=[u,g,y],r.splice(m,1),x=!0);if(!x)throw"findEmpties iterated with no new neighbors";for(h in f)o[h]=f[h],t.push(f[h])}return t.sort(function(e,t){return t[2]-e[2]})}},{"../../lib":692}],949:[function(e,t){"use strict";var a=e("../../components/fx"),o=e("../../lib"),r=e("../../plots/cartesian/axes");t.exports=function(t,i,n,l,s,d){var c=t.cd[0],p=c.trace,u=t.xa,e=t.ya,g=c.x,h=c.y,m=c.z,y=c.xCenter,f=c.yCenter,x=c.zmask,b=[p.zmin,p.zmax],_=p.zhoverformat,v=g,w=h,k,T,A,S;if(!1!==t.index){try{A=R(t.index[1]),S=R(t.index[0])}catch(a){return void o.error("Error hovering on heatmap, pointNumber must be [row,col], found:",t.index)}if(0>A||A>=m[0].length||0>S||S>m.length)return}else{if(0<a.inbox(i-g[0],i-g[g.length-1],0)||0<a.inbox(n-h[0],n-h[h.length-1],0))return;if(d){var C;for(v=[2*g[0]-g[1]],C=1;C<g.length;C++)v.push((g[C]+g[C-1])/2);for(v.push([2*g[g.length-1]-g[g.length-2]]),w=[2*h[0]-h[1]],C=1;C<h.length;C++)w.push((h[C]+h[C-1])/2);w.push([2*h[h.length-1]-h[h.length-2]])}A=va(0,ie(v.length-2,o.findBin(i,v))),S=va(0,ie(w.length-2,o.findBin(n,w)))}var L=u.c2p(g[A]),E=u.c2p(g[A+1]),z=e.c2p(h[S]),I=e.c2p(h[S+1]);d?(E=L,k=g[A],I=z,T=h[S]):(k=y?y[A]:(g[A]+g[A+1])/2,T=f?f[S]:(h[S]+h[S+1])/2,p.zsmooth&&(L=E=u.c2p(k),z=I=e.c2p(T)));var D=m[S][A];x&&!x[S][A]&&(D=void 0);var P;Array.isArray(c.text)&&Array.isArray(c.text[S])&&(P=c.text[S][A]);var O={type:"linear",range:b,hoverformat:_,_separators:u._separators,_numFormat:u._numFormat},M=r.tickText(O,D,"hover"),j;return j=M.text,[o.extendFlat(t,{index:[S,A],distance:t.maxHoverDistance,spikeDistance:t.maxSpikeDistance,x0:L,x1:E,y0:z,y1:I,xLabelVal:k,yLabelVal:T,zLabelVal:D,zLabel:j,text:P})]}},{"../../components/fx":608,"../../lib":692,"../../plots/cartesian/axes":740}],950:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.calc=e("./calc"),a.plot=e("./plot"),a.colorbar=e("./colorbar"),a.style=e("./style"),a.hoverPoints=e("./hover"),a.moduleType="trace",a.name="heatmap",a.basePlotModule=e("../../plots/cartesian"),a.categories=["cartesian","svg","2dMap"],a.meta={},t.exports=a},{"../../plots/cartesian":752,"./attributes":942,"./calc":943,"./colorbar":945,"./defaults":947,"./hover":949,"./plot":953,"./style":954}],951:[function(e,t){"use strict";function a(e){return .5-.25*ie(1,.5*e)}function o(e,t,a){var o=0,r,n,s,d,c,u,g,h,m,y,f,x,b;for(d=0;d<t.length;d++){for(r=t[d],n=r[0],s=r[1],f=e[n][s],y=0,m=0,c=0;4>c;c++)u=l[c],g=e[n+u[0]],g&&(h=g[s+u[1]],void 0!==h&&(0===y?x=b=h:(x=ie(x,h),b=va(b,h)),m++,y+=h));if(0===m)throw"iterateInterp2d order is wrong: no defined neighbors";e[n][s]=y/m,f===void 0?4>m&&(o=1):(e[n][s]=(1+a)*e[n][s]-a*f,b>x&&(o=va(o,wa(e[n][s]-f)/(b-x))))}return o}var r=e("../../lib"),n=.01,l=[[-1,0],[1,0],[0,-1],[0,1]];t.exports=function(e,t){var l=1,s;for(o(e,t),s=0;s<t.length&&!(4>t[s][2]);s++);for(t=t.slice(s),s=0;100>s&&l>n;s++)l=o(e,t,a(l));return l>n&&r.log("interp2d didn't converge quickly",l),e}},{"../../lib":692}],952:[function(e,t){"use strict";var a=e("../../registry"),o=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,r,n,l,s){var d=[],c=a.traceIs(e,"contour"),p=a.traceIs(e,"histogram"),u=a.traceIs(e,"gl2d"),g=o(t)&&1<t.length,h,m,y;if(g&&!p&&"category"!==s.type){var f=t.length;if(f<=l){if(c||u)d=t.slice(0,l);else if(1===l)d=[t[0]-.5,t[0]+.5];else{for(d=[1.5*t[0]-.5*t[1]],y=1;y<f;y++)d.push(.5*(t[y-1]+t[y]));d.push(1.5*t[f-1]-.5*t[f-2])}if(f<l){var x=d[d.length-1],b=x-d[d.length-2];for(y=f;y<l;y++)x+=b,d.push(x)}}else return c?t.slice(0,l):t.slice(0,l+1)}else{m=n||1;var _=e[s._id.charAt(0)+"calendar"];for(h=p||"category"===s.type||"multicategory"===s.type?s.r2c(r,0,_)||0:o(t)&&1===t.length?t[0]:void 0===r?0:s.d2c(r,0,_),y=c||u?0:-.5;y<l;y++)d.push(h+m*y)}return d}},{"../../lib":692,"../../registry":823}],953:[function(e,t){"use strict";function a(e,t){var a=t.length-2,o=p.constrain(p.findBin(e,t),0,a),r=t[o],i=t[o+1],n=p.constrain(o+(e-r)/(i-r)-.5,0,a),l=R(n),s=wa(n-l);return n&&n!==a&&s?{bin0:l,frac:s,bin1:R(l+s/(n-l))}:{bin0:l,bin1:l,frac:0}}function o(e,t){var a=t.length-1,o=p.constrain(p.findBin(e,t),0,a),r=t[o],i=t[o+1],n=(e-r)/(i-r)||0;return 0>=n?{bin0:o,bin1:o,frac:0}:.5>n?{bin0:o,bin1:o+1,frac:n}:{bin0:o+1,bin1:o,frac:1-n}}function r(e,t,a){e[t]=a[0],e[t+1]=a[1],e[t+2]=a[2],e[t+3]=R(255*a[3])}var l=e("d3"),s=e("tinycolor2"),d=e("../../registry"),p=e("../../lib"),u=e("../../components/colorscale"),g=e("../../constants/xmlns_namespaces");t.exports=function(e,t,i,n){var c=t.xaxis,h=t.yaxis;p.makeTraceGroups(n,i,"hm").each(function(t){function f(e,t){if(void 0!==e){var a=Z(e);return a[0]=R(a[0]),a[1]=R(a[1]),a[2]=R(a[2]),ae+=t,oe+=a[0]*t,re+=a[1]*t,ne+=a[2]*t,a}return[0,0,0,0]}function b(e,t,a,o){var r=e[a.bin0];if(void 0===r)return f(void 0,1);var i=e[a.bin1],n=t[a.bin0],l=t[a.bin1],s;return s=void 0===i?void 0===l?0:void 0===n?2*(l-r):2*(2*l-n-r)/3:void 0===l?void 0===n?0:2*(2*r-i-n)/3:void 0===n?2*(2*l-i-r)/3:l+r-i-n,f(r+a.frac*(i-r||0)+o.frac*((n-r||0)+a.frac*s))}var _=l.select(this),w=t[0],k=w.trace,T=w.z,A=w.x,S=w.y,C=w.xCenter,L=w.yCenter,E=d.traceIs(k,"contour"),z=E?"best":k.zsmooth,I=T.length,m=p.maxRowLength(T),n=!1,D=!1,P,O,M,B,F,N;for(N=0;void 0===P&&N<A.length-1;)P=c.c2p(A[N]),N++;for(N=A.length-1;void 0===O&&0<N;)O=c.c2p(A[N]),N--;for(O<P&&(M=O,O=P,P=M,n=!0),N=0;void 0===B&&N<S.length-1;)B=h.c2p(S[N]),N++;for(N=S.length-1;void 0===F&&0<N;)F=h.c2p(S[N]),N--;if(F<B&&(M=B,B=F,F=M,D=!0),E&&(C=A,L=S,A=w.xfill,S=w.yfill),"fast"!==z){var V="best"===z?0:.5;P=va(-V*c._length,P),O=ie((1+V)*c._length,O),B=va(-V*h._length,B),F=ie((1+V)*h._length,F)}var U=R(O-P),H=R(F-B);if(0>=U||0>=H){var G=_.selectAll("image").data([]);return void G.exit().remove()}var Y,q;"fast"===z?(Y=m,q=I):(Y=U,q=H);var W=document.createElement("canvas");W.width=Y,W.height=q;var X=W.getContext("2d"),Z=u.makeColorScaleFunc(u.extractScale(k,{cLetter:"z"}),{noNumericCheck:!0,returnArray:!0}),$,J;"fast"===z?($=n?function(e){return m-1-e}:p.identity,J=D?function(e){return I-1-e}:p.identity):($=function(e){return p.constrain(R(c.c2p(A[e])-P),0,U)},J=function(e){return p.constrain(R(h.c2p(S[e])-B),0,H)});var K=J(0),Q=[K,K],ee=n?0:1,te=D?0:1,ae=0,oe=0,re=0,ne=0,le,se,de,ce,pe,ue;if(z){var ge=0,he;try{he=new Uint8Array(4*(U*H))}catch(t){he=Array(4*(U*H))}if("best"===z){var me=C||A,ye=L||S,fe=Array(me.length),xe=Array(ye.length),be=Array(U),_e=C?o:a,ve=L?o:a,we,ke,Te;for(N=0;N<me.length;N++)fe[N]=R(c.c2p(me[N])-P);for(N=0;N<ye.length;N++)xe[N]=R(h.c2p(ye[N])-B);for(N=0;N<U;N++)be[N]=_e(N,fe);for(se=0;se<H;se++)for(we=ve(se,xe),ke=T[we.bin0],Te=T[we.bin1],N=0;N<U;N++,ge+=4)ue=b(ke,Te,be[N],we),r(he,ge,ue)}else for(se=0;se<I;se++)for(pe=T[se],Q=J(se),N=0;N<U;N++)ue=f(pe[N],1),ge=4*(Q*U+$(N)),r(he,ge,ue);var Ae=X.createImageData(U,H);try{Ae.data.set(he)}catch(t){var Se=Ae.data,Ce=Se.length;for(se=0;se<Ce;se++)Se[se]=he[se]}X.putImageData(Ae,0,0)}else{var Le=k.xgap,Ee=k.ygap,ze=ea(Le/2),Ie=ea(Ee/2);for(se=0;se<I;se++)if(pe=T[se],Q.reverse(),Q[te]=J(se+1),Q[0]!==Q[1]&&void 0!==Q[0]&&void 0!==Q[1])for(de=$(0),le=[de,de],N=0;N<m;N++)(le.reverse(),le[ee]=$(N+1),le[0]!==le[1]&&void 0!==le[0]&&void 0!==le[1])&&(ce=pe[N],ue=f(ce,(le[1]-le[0])*(Q[1]-Q[0])),X.fillStyle="rgba("+ue.join(",")+")",X.fillRect(le[0]+ze,Q[0]+Ie,le[1]-le[0]-Le,Q[1]-Q[0]-Ee))}oe=R(oe/ae),re=R(re/ae),ne=R(ne/ae);var De=s("rgb("+oe+","+re+","+ne+")");e._hmpixcount=(e._hmpixcount||0)+ae,e._hmlumcount=(e._hmlumcount||0)+ae*De.getLuminance();var Pe=_.selectAll("image").data(t);Pe.enter().append("svg:image").attr({xmlns:g.svg,preserveAspectRatio:"none"}),Pe.attr({height:H,width:U,x:P,y:B,"xlink:href":W.toDataURL("image/png")})})}},{"../../components/colorscale":581,"../../constants/xmlns_namespaces":670,"../../lib":692,"../../registry":823,d3:148,tinycolor2:513}],954:[function(e,t){"use strict";var a=e("d3");t.exports=function(e){a.select(e).selectAll(".hm image").style("opacity",function(e){return e.trace.opacity})}},{d3:148}],955:[function(e,t){"use strict";t.exports=function(e,t,a){var o=a("zsmooth");!1===o&&(a("xgap"),a("ygap")),a("zhoverformat")}},{}],956:[function(e,t){"use strict";function a(e,t){var a=t(e),o=a?t(e+"type","array"):"scaled";return"scaled"===o&&(t(e+"0"),t("d"+e)),a}function o(e){for(var t=!0,a=!1,o=!1,l=0,s;l<e.length;l++){if(s=e[l],!n.isArrayOrTypedArray(s)){t=!1;break}0<s.length&&(a=!0);for(var d=0;d<s.length;d++)if(r(s[d])){o=!0;break}}return t&&a&&o}var r=e("fast-isnumeric"),n=e("../../lib"),l=e("../../registry");t.exports=function(e,t,r,i,s,d){var c=r("z");s=s||"x",d=d||"y";var p,u;if(void 0===c||!c.length)return 0;if(n.isArray1D(e.z)){p=r(s),u=r(d);var g=n.minRowLength(p),h=n.minRowLength(u);if(0===g||0===h)return 0;t._length=ie(g,h,c.length)}else{if(p=a(s,r),u=a(d,r),!o(c))return 0;r("transpose"),t._length=null}var m=l.getComponentMethod("calendars","handleTraceDefaults");return m(e,t,[s,d],i),!0}},{"../../lib":692,"../../registry":823,"fast-isnumeric":214}],957:[function(e,t){"use strict";for(var a=e("../heatmap/attributes"),o=e("../../components/colorscale/attributes"),r=e("../../components/colorbar/attributes"),n=e("../../lib/extend").extendFlat,l=e("../../plot_api/edit_types").overrideAll,s=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],d={},c=0,p;c<s.length;c++)p=s[c],d[p]=a[p];n(d,o("",{cLetter:"z",autoColorDflt:!1}),{colorbar:r}),t.exports=l(d,"calc","nested")},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../lib/extend":682,"../../plot_api/edit_types":723,"../heatmap/attributes":942}],958:[function(e,t){"use strict";function a(e,t){this.scene=e,this.uid=t,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=r(e.glplot,this.options),this.heatmap._trace=this}function o(e){for(var t=e.colorscale,a=e.zmin,o=e.zmax,r=t.length,l=Array(r),s=Array(4*r),d=0;d<r;d++){var c=t[d],p=n(c[1]);l[d]=a+c[0]*(o-a);for(var u=0;4>u;u++)s[4*d+u]=p[u]}return{colorLevels:l,colorValues:s}}var r=e("gl-heatmap2d"),i=e("../../plots/cartesian/axes"),n=e("../../lib/str2rgbarray"),l=a.prototype;l.handlePick=function(e){var t=this.options,a=t.shape,o=e.pointId,r=o%a[0],i=ea(o/a[0]);return{trace:this,dataCoord:e.dataCoord,traceCoord:[t.x[r],t.y[i],t.z[o]],textLabel:this.textLabels[o],name:this.name,pointIndex:[i,r],hoverinfo:this.hoverinfo}},l.update=function(e,t){var a=t[0];this.index=e.index,this.name=e.name,this.hoverinfo=e.hoverinfo;var r=a.z;this.options.z=[].concat.apply([],r);var n=r[0].length,l=r.length;this.options.shape=[n,l],this.options.x=a.x,this.options.y=a.y;var s=o(e);this.options.colorLevels=s.colorLevels,this.options.colorValues=s.colorValues,this.textLabels=[].concat.apply([],e.text),this.heatmap.update(this.options);var d=this.scene.xaxis,c=this.scene.yaxis;e._extremes[d._id]=i.findExtremes(d,a.x),e._extremes[c._id]=i.findExtremes(c,a.y)},l.dispose=function(){this.heatmap.dispose()},t.exports=function(e,t,o){var r=new a(e,t.uid);return r.update(t,o),r}},{"../../lib/str2rgbarray":715,"../../plots/cartesian/axes":740,"gl-heatmap2d":241}],959:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("../heatmap/defaults"),a.colorbar=e("../heatmap/colorbar"),a.calc=e("../heatmap/calc"),a.plot=e("./convert"),a.moduleType="trace",a.name="heatmapgl",a.basePlotModule=e("../../plots/gl2d"),a.categories=["gl","gl2d","2dMap"],a.meta={},t.exports=a},{"../../plots/gl2d":780,"../heatmap/calc":943,"../heatmap/colorbar":945,"../heatmap/defaults":947,"./attributes":957,"./convert":958}],960:[function(e,t){"use strict";var a=e("../bar/attributes"),o=e("../../components/fx/hovertemplate_attributes"),r=e("./bin_attributes"),i=e("./constants");t.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},text:a.text,orientation:a.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:r("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:r("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},hovertemplate:o({},{keys:i.eventDataKeys}),marker:a.marker,selected:a.selected,unselected:a.unselected,_deprecated:{bardir:a._deprecated.bardir}}},{"../../components/fx/hovertemplate_attributes":607,"../bar/attributes":833,"./bin_attributes":962,"./constants":966}],961:[function(e,t){"use strict";t.exports=function(e,t){for(var a=e.length,o=0,r=0;r<a;r++)t[r]?(e[r]/=t[r],o+=e[r]):e[r]=null;return o}},{}],962:[function(e,t){"use strict";t.exports=function(){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],963:[function(e,t){"use strict";var a=e("fast-isnumeric");t.exports={count:function(e,t,a){return a[e]++,1},sum:function(e,t,o,r){var i=r[t];return a(i)?(i=+i,o[e]+=i,i):0},avg:function(e,t,o,r,i){var n=r[t];return a(n)&&(n=+n,o[e]+=n,i[e]++),0},min:function(e,t,o,r){var i=r[t];if(a(i)){if(i=+i,!a(o[e]))return o[e]=i,i;if(o[e]>i){var n=i-o[e];return o[e]=i,n}}return 0},max:function(e,t,o,r){var i=r[t];if(a(i)){if(i=+i,!a(o[e]))return o[e]=i,i;if(o[e]<i){var n=i-o[e];return o[e]=i,n}}return 0}}},{"fast-isnumeric":214}],964:[function(e,t){"use strict";function a(e,t,a,n){if(0>=e*t)return 1/0;for(var l=wa(t-e),s="date"===a.type,d=o(l,s),c=0,p;10>c&&(p=o(80*d,s),d!==p)&&r(p,e,t,s,a,n);c++)d=p;return d}function o(e,t){return t&&e>u?e>d?e>1.1*l?l:e>1.1*s?s:d:e>c?c:e>p?p:u:_a(10,ea(P(e)/z))}function r(e,t,a,o,r,n){if(o&&e>d){var s=i(t,r,n),c=i(a,r,n),p=e===l?0:1;return s[p]!==c[p]}return .1<ea(a/e)-ea(t/e)}function i(e,t,a){var o=t.c2d(e,l,a).split("-");return""===o[0]&&(o.unshift(),o[0]="-"+o[0]),o}var n=e("../../constants/numerical"),l=n.ONEAVGYEAR,s=n.ONEAVGMONTH,d=n.ONEDAY,c=n.ONEHOUR,p=n.ONEMIN,u=n.ONESEC,g=e("../../plots/cartesian/axes").tickIncrement;t.exports=function(e,t,o,r,i){var n=-1.1*t,s=-.1*t,c=e-s,p=o[0],u=o[1],h=ie(a(p+s,p+c,r,i),a(u+s,u+c,r,i)),m=ie(a(p+n,p+s,r,i),a(u+n,u+s,r,i)),y,f;if(h>m&&m<wa(u-p)/4e3?(y=h,f=!1):(y=ie(h,m),f=!0),"date"===r.type&&y>d){var x=y===l?1:6,b=y===l?"M12":"M1";return function(t,a){var o=r.c2d(t,l,i),n=o.indexOf("-",x);0<n&&(o=o.substr(0,n));var s=r.d2c(o,0,i);if(s<t){var d=g(s,b,!1,i);(s+d)/2<t+e&&(s=d)}return a&&f?g(s,b,!0,i):s}}return function(t,a){var o=y*R(t/y);return o+y/10<t&&o+.9*y<t+e&&(o+=y),a&&f&&(o-=y),o}}},{"../../constants/numerical":669,"../../plots/cartesian/axes":740}],965:[function(e,t){"use strict";function a(e,t,a,r,n){function l(e,t,a){t[e+"Found"]?(t[e]=h(t[e]),null===t[e]&&(t[e]=a[e])):(v[e]=t[e]=a[e],d.nestedProperty(f[0],p+"."+e).set(a[e]))}var p=r+"bins",u=e._fullLayout,g="overlay"===u.barmode,h="date"===a.type?function(e){return e||0===e?d.cleanDate(e,null,a.calendar):null}:function(e){return s(e)?+e:null},m=u._histogramBinOpts[t._groupName],y,f,x,b,_,v,w;if(t._autoBinFinished)delete t._autoBinFinished;else{f=m.traces;var k=m.sizeFound,T=[];v=f[0]._autoBin={};var A=!0;for(y=0;y<f.length;y++)x=f[y],x.visible&&(_=x._pos0=a.makeCalcdata(x,r),T=d.concat(T,_),delete x._autoBinFinished,!0===t.visible&&(A?A=!1:(delete x._autoBin,x._autoBinFinished=1)));b=f[0][r+"calendar"];var S=c.autoBin(T,a,m.nbins,!1,b,k&&m.size);if(g&&0===S._dataSpan&&"category"!==a.type&&"multicategory"!==a.type){if(n)return[S,_,!0];S=o(e,t,a,r,p)}w=x.cumulative,w.enabled&&"include"!==w.currentbin&&("decreasing"===w.direction?S.start=a.c2r(c.tickIncrement(a.r2c(S.start,0,b),S.size,!0,b)):S.end=a.c2r(c.tickIncrement(a.r2c(S.end,0,b),S.size,!1,b))),m.size=S.size,k||(v.size=S.size,d.nestedProperty(f[0],p+".size").set(S.size)),l("start",m,S),l("end",m,S)}_=t._pos0,delete t._pos0;var C=t._input[p]||{},L=d.extendFlat({},m),E=m.start,z=a.r2l(C.start),I=void 0!==z;if((m.startFound||I)&&z!==a.r2l(E)){var D=I?z:d.aggNums(Math.min,null,_),P={type:"category"===a.type||"multicategory"===a.type?"linear":a.type,r2l:a.r2l,dtick:m.size,tick0:E,calendar:b,range:[D,c.tickIncrement(D,m.size,!1,b)].map(a.l2r)},O=c.tickFirst(P);O>a.r2l(D)&&(O=c.tickIncrement(O,m.size,!0,b)),L.start=a.l2r(O),I||d.nestedProperty(t,p+".start").set(L.start)}var R=m.end,M=a.r2l(C.end),j=void 0!==M;if((m.endFound||j)&&M!==a.r2l(R)){var B=j?M:d.aggNums(Math.max,null,_);L.end=a.l2r(B),j||d.nestedProperty(t,p+".start").set(L.end)}var F="autobin"+r;return!1===t._input[F]&&(t._input[p]=d.extendFlat({},t[p]||{}),delete t._input[F],delete t[F]),[L,_]}function o(e,t,o,n,l){var s=r(e,t),c=!1,p=1/0,u=[t],g,h;for(g=0;g<s.length;g++)if(h=s[g],h===t)c=!0;else if(!c)p=ie(p,h[l].size);else{var m=a(e,h,o,n,!0),y=m[0],f=m[2];h._autoBinFinished=1,h._pos0=m[1],f?u.push(h):p=ie(p,y.size)}var x=Array(u.length);for(g=0;g<u.length;g++)for(var b=u[g]._pos0,_=0;_<b.length;_++)if(void 0!==b[_]){x[g]=b[_];break}for(isFinite(p)||(p=d.distinctVals(x).minDiff),g=0;g<u.length;g++){h=u[g];var v=h[n+"calendar"];h._input[l]=h[l]={start:o.c2r(x[g]-p/2,0,v),end:o.c2r(x[g]+p/2,0,v),size:p}}return t[l]}function r(e,t){for(var a=t.xaxis,o=t.yaxis,r=t.orientation,n=[],l=e._fullData,s=0,d;s<l.length;s++)d=l[s],"histogram"===d.type&&!0===d.visible&&d.orientation===r&&d.xaxis===a&&d.yaxis===o&&n.push(d);return n}function l(e,t,a){function o(t){s=e[t],e[t]/=2}function r(t){l=e[t],e[t]=s+l/2,s+=l}var n,l,s;if("half"===a){if("increasing"===t)for(o(0),n=1;n<e.length;n++)r(n);else for(o(e.length-1),n=e.length-2;0<=n;n--)r(n);}else if("increasing"===t){for(n=1;n<e.length;n++)e[n]+=e[n-1];"exclude"===a&&(e.unshift(0),e.pop())}else{for(n=e.length-2;0<=n;n--)e[n]+=e[n+1];"exclude"===a&&(e.push(0),e.shift())}}var s=e("fast-isnumeric"),d=e("../../lib"),c=e("../../plots/cartesian/axes"),p=e("../bar/arrays_to_calcdata"),u=e("./bin_functions"),g=e("./norm_functions"),h=e("./average"),m=e("./bin_label_vals");t.exports=function(e,t){if(!0===t.visible){var o=[],r=[],y=c.getFromId(e,"h"===t.orientation?t.yaxis||"y":t.xaxis||"x"),f="h"===t.orientation?"y":"x",x={x:"y",y:"x"}[f],b=t[f+"calendar"],_=t.cumulative,v=a(e,t,y,f),w=v[0],k=v[1],T="string"==typeof w.size,A=[],S=T?A:w,C=[],L=[],E=[],z=0,I=t.histnorm,D=t.histfunc,P=-1!==I.indexOf("density"),O,R,M,j;_.enabled&&P&&(I=I.replace(/ ?density$/,""),P=!1);var B="max"===D||"min"===D?null:0,F=u.count,N=g[I],V=!1,U=function(e){return y.r2c(e,0,b)},H;for(d.isArrayOrTypedArray(t[x])&&"count"!==D&&(H=t[x],V="avg"===D,F=u[D]),O=U(w.start),M=U(w.end)+(O-c.tickIncrement(O,w.size,!1,b))/1e6;O<M&&1e6>o.length&&(R=c.tickIncrement(O,w.size,!1,b),o.push((O+R)/2),r.push(B),E.push([]),A.push(O),P&&C.push(1/(R-O)),V&&L.push(0),!(R<=O));)O=R;A.push(O),T||"date"!==y.type||(S={start:U(S.start),end:U(S.end),size:S.size});var G=r.length,Y=!0,q=1/0,W=1/0,X={};for(O=0;O<k.length;O++){var Z=k[O];j=d.findBin(Z,S),0<=j&&j<G&&(z+=F(j,O,r,H,L),Y&&E[j].length&&Z!==k[E[j][0]]&&(Y=!1),E[j].push(O),X[O]=j,q=ie(q,Z-A[j]),W=ie(W,A[j+1]-Z))}var $;Y||($=m(q,W,A,y,b)),V&&(z=h(r,L)),N&&N(r,z,C),_.enabled&&l(r,_.direction,_.currentbin);var J=ie(o.length,r.length),K=[],Q=0,ee=J-1;for(O=0;O<J;O++)if(r[O]){Q=O;break}for(O=J-1;O>=Q;O--)if(r[O]){ee=O;break}for(O=Q;O<=ee;O++)if(s(o[O])&&s(r[O])){var te={p:o[O],s:r[O],b:0};_.enabled||(te.pts=E[O],Y?te.ph0=te.ph1=E[O].length?k[E[O][0]]:o[O]:(te.ph0=$(A[O]),te.ph1=$(A[O+1],!0))),K.push(te)}return 1===K.length&&(K[0].width1=c.tickIncrement(K[0].p,w.size,!1,b)-K[0].p),p(K,t),d.isArrayOrTypedArray(t.selectedpoints)&&d.tagSelected(K,t,X),K}}},{"../../lib":692,"../../plots/cartesian/axes":740,"../bar/arrays_to_calcdata":832,"./average":961,"./bin_functions":963,"./bin_label_vals":964,"./norm_functions":972,"fast-isnumeric":214}],966:[function(e,t){"use strict";t.exports={eventDataKeys:["binNumber"]}},{}],967:[function(e,t){"use strict";var a=e("../../lib"),o=a.nestedProperty,r=e("./attributes"),n={x:[{aStr:"xbins.start",name:"start"},{aStr:"xbins.end",name:"end"},{aStr:"xbins.size",name:"size"},{aStr:"nbinsx",name:"nbins"}],y:[{aStr:"ybins.start",name:"start"},{aStr:"ybins.end",name:"end"},{aStr:"ybins.size",name:"size"},{aStr:"nbinsy",name:"nbins"}]};t.exports=function(e,t){function l(e){return a.coerce(u._input,u,r,e)}var s=t._histogramBinOpts={},d="overlay"===t.barmode,c,p,u,g,h,m,y;for(c=0;c<e.length;c++)u=e[c],"histogram"===u.type&&(delete u._autoBinFinished,h="v"===u.orientation?"x":"y",m=d?u.uid:u.xaxis+u.yaxis+h,u._groupName=m,y=s[m],y?y.traces.push(u):y=s[m]={traces:[u],direction:h});for(m in s){y=s[m],h=y.direction;var f=n[h];for(p=0;p<f.length;p++){var x=f[p],b=x.name;if(!("nbins"===b&&y.sizeFound)){var _=x.aStr;for(c=0;c<y.traces.length;c++){if(u=y.traces[c],g=u._input,void 0!==o(g,_).get()){y[b]=l(_),y[b+"Found"]=!0;break}var v=u._autoBin;v&&v[b]&&o(u,_).set(v[b])}if("start"===b||"end"===b)for(;c<y.traces.length;c++)u=y.traces[c],l(_,(u._autoBin||{})[b]);"nbins"!==b||y.sizeFound||y.nbinsFound||(u=y.traces[0],y[b]=l(_))}}}}},{"../../lib":692,"./attributes":960}],968:[function(e,t){"use strict";var a=e("../../registry"),o=e("../../lib"),r=e("../../components/color"),i=e("../bar/style_defaults"),n=e("./attributes");t.exports=function(e,t,l,s){function d(a,r){return o.coerce(e,t,n,a,r)}var c=d("x"),p=d("y"),u=d("cumulative.enabled");u&&(d("cumulative.direction"),d("cumulative.currentbin")),d("text");var g=d("orientation",p&&!c?"h":"v"),h="v"===g?"x":"y",m="v"===g?"y":"x",y=c&&p?ie(o.minRowLength(c)&&o.minRowLength(p)):o.minRowLength(t[h]||[]);if(!y)return void(t.visible=!1);t._length=y;var f=a.getComponentMethod("calendars","handleTraceDefaults");f(e,t,["x","y"],s);var x=t[m];x&&d("histfunc"),d("histnorm"),d("autobin"+h),d("hovertemplate"),i(e,t,d,l,s);var b=a.getComponentMethod("errorbars","supplyDefaults");b(e,t,r.defaultLine,{axis:"y"}),b(e,t,r.defaultLine,{axis:"x",inherit:"y"}),o.coerceSelectionMarkerOpacity(t,d)}},{"../../components/color":569,"../../lib":692,"../../registry":823,"../bar/style_defaults":847,"./attributes":960}],969:[function(e,t){"use strict";t.exports=function(e,t,a,o,r){if(e.x="xVal"in t?t.xVal:t.x,e.y="yVal"in t?t.yVal:t.y,t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),!(a.cumulative||{}).enabled){var n=Array.isArray(r)?o[0].pts[r[0]][r[1]]:o[r].pts;e.pointNumbers=n,e.binNumber=e.pointNumber,delete e.pointNumber,delete e.pointIndex;var l;if(a._indexToPoints){l=[];for(var s=0;s<n.length;s++)l=l.concat(a._indexToPoints[n[s]])}else l=n;e.pointIndices=l}return e}},{}],970:[function(e,t){"use strict";var a=e("../bar/hover").hoverPoints,o=e("../../plots/cartesian/axes").hoverLabelText;t.exports=function(e,t,r,i){var n=a(e,t,r,i);if(n){e=n[0];var l=e.cd[e.index],s=e.cd[0].trace;if(!s.cumulative.enabled){var d="h"===s.orientation?"y":"x";e[d+"Label"]=o(e[d+"a"],l.ph0,l.ph1)}return s.hovermplate&&(e.hovertemplate=s.hovertemplate),n}}},{"../../plots/cartesian/axes":740,"../bar/hover":839}],971:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.layoutAttributes=e("../bar/layout_attributes"),a.supplyDefaults=e("./defaults"),a.crossTraceDefaults=e("./cross_trace_defaults"),a.supplyLayoutDefaults=e("../bar/layout_defaults"),a.calc=e("./calc"),a.crossTraceCalc=e("../bar/cross_trace_calc").crossTraceCalc,a.plot=e("../bar/plot"),a.layerName="barlayer",a.style=e("../bar/style").style,a.styleOnSelect=e("../bar/style").styleOnSelect,a.colorbar=e("../scatter/marker_colorbar"),a.hoverPoints=e("./hover"),a.selectPoints=e("../bar/select"),a.eventData=e("./event_data"),a.moduleType="trace",a.name="histogram",a.basePlotModule=e("../../plots/cartesian"),a.categories=["cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],a.meta={},t.exports=a},{"../../plots/cartesian":752,"../bar/cross_trace_calc":836,"../bar/layout_attributes":841,"../bar/layout_defaults":842,"../bar/plot":843,"../bar/select":844,"../bar/style":846,"../scatter/marker_colorbar":1058,"./attributes":960,"./calc":965,"./cross_trace_defaults":967,"./defaults":968,"./event_data":969,"./hover":970}],972:[function(e,t){"use strict";t.exports={percent:function(e,t){for(var a=e.length,o=0;o<a;o++)e[o]*=100/t},probability:function(e,t){for(var a=e.length,o=0;o<a;o++)e[o]/=t},density:function(e,t,a,o){var r=e.length;o=o||1;for(var i=0;i<r;i++)e[i]*=a[i]*o},"probability density":function(e,t,a,o){var r=e.length;o&&(t/=o);for(var i=0;i<r;i++)e[i]*=a[i]/t}}},{}],973:[function(e,t){"use strict";var a=e("../histogram/attributes"),o=e("../histogram/bin_attributes"),r=e("../heatmap/attributes"),i=e("../../components/colorscale/attributes"),n=e("../../components/colorbar/attributes"),l=e("../../lib/extend").extendFlat;t.exports=l({x:a.x,y:a.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:a.histnorm,histfunc:a.histfunc,nbinsx:a.nbinsx,xbins:o("x"),nbinsy:a.nbinsy,ybins:o("y"),autobinx:a.autobinx,autobiny:a.autobiny,xgap:r.xgap,ygap:r.ygap,zsmooth:r.zsmooth,zhoverformat:r.zhoverformat},i("",{cLetter:"z",autoColorDflt:!1}),{colorbar:n})},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../lib/extend":682,"../heatmap/attributes":942,"../histogram/attributes":960,"../histogram/bin_attributes":962}],974:[function(e,t){"use strict";function a(e,t,a,o,r,i,n){var l=t+"bins",c=e[l];c||(c=e[l]={});var p=e._input[l]||{},u=e._autoBin={};p.size||delete c.size,p.start===void 0&&delete c.start,p.end===void 0&&delete c.end;var g=!c.size,h=c.start===void 0,m=c.end===void 0;if(g||h||m){var y=d.autoBin(a,o,e["nbins"+t],"2d",n,c.size);"histogram2dcontour"===e.type&&(h&&(y.start=i(d.tickIncrement(r(y.start),y.size,!0,n))),m&&(y.end=i(d.tickIncrement(r(y.end),y.size,!1,n)))),g&&(c.size=u.size=y.size),h&&(c.start=u.start=y.start),m&&(c.end=u.end=y.end)}var f="autobin"+t;!1===e._input[f]&&(e._input[l]=s.extendFlat({},c),delete e._input[f],delete e[f])}function o(e,t,a,o){var r=Array(e),n;if(o)for(n=0;n<e;n++)r[n]=1/(t[n+1]-t[n]);else{for(n=0;n<e;n++)r[n]=1/a}return r}function r(e,t){return{start:e(t.start),end:e(t.end),size:t.size}}function l(e,t,a,o,r,n){var l=e.length-1,s=Array(l),d;if(t)for(d=0;d<l;d++)s[d]=[t[d],t[d]];else{var c=g(a,o,e,r,n);for(d=0;d<l;d++)s[d]=[c(e[d]),c(e[d+1],!0)]}return s}var s=e("../../lib"),d=e("../../plots/cartesian/axes"),c=e("../histogram/bin_functions"),p=e("../histogram/norm_functions"),u=e("../histogram/average"),g=e("../histogram/bin_label_vals");t.exports=function(e,t){var g=d.getFromId(e,t.xaxis||"x"),h=t.x?g.makeCalcdata(t,"x"):[],f=d.getFromId(e,t.yaxis||"y"),x=t.y?f.makeCalcdata(t,"y"):[],y=t.xcalendar,b=t.ycalendar,_=function(e){return g.r2c(e,0,y)},v=function(e){return f.r2c(e,0,b)},w=function(e){return g.c2r(e,0,y)},k=function(e){return f.c2r(e,0,b)},T=t._length,A,S,C,L;h.length>T&&h.splice(T,h.length-T),x.length>T&&x.splice(T,x.length-T),a(t,"x",h,g,_,w,y),a(t,"y",x,f,v,k,b);var E=[],z=[],I=[],D="string"==typeof t.xbins.size,P="string"==typeof t.ybins.size,O=[],R=[],M=D?O:t.xbins,B=P?R:t.ybins,F=0,N=[],V=[],U=t.histnorm,H=t.histfunc,G=-1!==U.indexOf("density"),Y="max"===H||"min"===H?null:0,q=c.count,W=p[U],X=!1,Z=[],$=[],J="z"in t?t.z:"marker"in t&&Array.isArray(t.marker.color)?t.marker.color:"";J&&"count"!==H&&(X="avg"===H,q=c[H]);var K=t.xbins,Q=_(K.start),ee=_(K.end)+(Q-d.tickIncrement(Q,K.size,!1,y))/1e6;for(A=Q;A<ee;A=d.tickIncrement(A,K.size,!1,y))z.push(Y),O.push(A),X&&I.push(0);O.push(A);var te=z.length,ae=_(t.xbins.start),oe=(A-ae)/te,re=w(ae+oe/2);for(K=t.ybins,Q=v(K.start),ee=v(K.end)+(Q-d.tickIncrement(Q,K.size,!1,b))/1e6,A=Q;A<ee;A=d.tickIncrement(A,K.size,!1,b)){E.push(z.slice()),R.push(A);var ne=Array(te);for(S=0;S<te;S++)ne[S]=[];V.push(ne),X&&N.push(I.slice())}R.push(A);var le=E.length,se=v(t.ybins.start),de=(A-se)/le,ce=k(se+de/2);G&&(Z=o(z.length,M,oe,D),$=o(E.length,B,de,P)),D||"date"!==g.type||(M=r(_,M)),P||"date"!==f.type||(B=r(v,B));var pe=!0,ue=!0,ge=Array(te),he=Array(le),me=1/0,ye=1/0,fe=1/0,xe=1/0;for(A=0;A<T;A++){var be=h[A],_e=x[A];C=s.findBin(be,M),L=s.findBin(_e,B),0<=C&&C<te&&0<=L&&L<le&&(F+=q(C,A,E[L],J,N[L]),V[L][C].push(A),pe&&(ge[C]===void 0?ge[C]=be:ge[C]!==be&&(pe=!1)),ue&&(he[C]===void 0?he[C]=_e:he[C]!==_e&&(ue=!1)),me=ie(me,be-O[C]),ye=ie(ye,O[C+1]-be),fe=ie(fe,_e-R[L]),xe=ie(xe,R[L+1]-_e))}if(X)for(L=0;L<le;L++)F+=u(E[L],N[L]);if(W)for(L=0;L<le;L++)W(E[L],F,Z,$[L]);return{x:h,xRanges:l(O,pe&&ge,me,ye,g,y),x0:re,dx:oe,y:x,yRanges:l(R,ue&&he,fe,xe,f,b),y0:ce,dy:de,z:E,pts:V}}},{"../../lib":692,"../../plots/cartesian/axes":740,"../histogram/average":961,"../histogram/bin_functions":963,"../histogram/bin_label_vals":964,"../histogram/norm_functions":972}],975:[function(e,t){"use strict";function a(e,t,a,l){var s=a[i.id2name(e[t+"axis"])],d=s.type,c=t+"bins",p=e[c],u=e[t+"calendar"];p||(p=e[c]={});var g="date"===d?function(e,t){return e||0===e?n.cleanDate(e,r,u):t}:function(e,t){return o(e)?+e:t};p.start=g(p.start,l.start),p.end=g(p.end,l.end);var h=l.size,m=p.size;if(o(m))p.size=0<m?+m:h;else if("string"!=typeof m)p.size=h;else{var y=m.charAt(0),f=m.substr(1);f=o(f)?+f:0,(0>=f||"date"!==d||"M"!==y||f!==R(f))&&(p.size=h)}}var o=e("fast-isnumeric"),r=e("../../constants/numerical").BADNUM,i=e("../../plots/cartesian/axis_ids"),n=e("../../lib"),l=e("./attributes"),s=["x","y"];t.exports=function(e,t){function o(e){return n.coerce(c._input,c,l,e)}var r,d,c,p;for(r=0;r<e.length;r++){c=e[r];var u=c.type;if("histogram2d"===u||"histogram2dcontour"===u)for(d=0;d<s.length;d++){p=s[d];var g=p+"bins",h=(c._autoBin||{})[p]||{};o(g+".start",h.start),o(g+".end",h.end),o(g+".size",h.size),a(c,p,t,h),(c[g]||{}).size||o("nbins"+p)}}}},{"../../constants/numerical":669,"../../lib":692,"../../plots/cartesian/axis_ids":743,"./attributes":973,"fast-isnumeric":214}],976:[function(e,t){"use strict";var a=e("../../lib"),o=e("./sample_defaults"),r=e("../heatmap/style_defaults"),i=e("../../components/colorscale/defaults"),n=e("./attributes");t.exports=function(e,t,l,s){function d(o,r){return a.coerce(e,t,n,o,r)}o(e,t,d,s);!1===t.visible||(r(e,t,d,s),i(e,t,s,d,{prefix:"",cLetter:"z"}))}},{"../../components/colorscale/defaults":579,"../../lib":692,"../heatmap/style_defaults":955,"./attributes":973,"./sample_defaults":979}],977:[function(e,t){"use strict";var a=e("../heatmap/hover"),o=e("../../plots/cartesian/axes").hoverLabelText;t.exports=function(e,t,r,i,n,l){var s=a(e,t,r,i,n,l);if(s){e=s[0];var d=e.index,c=d[0],p=d[1],u=e.cd[0],g=u.xRanges[p],h=u.yRanges[c];return e.xLabel=o(e.xa,g[0],g[1]),e.yLabel=o(e.ya,h[0],h[1]),s}}},{"../../plots/cartesian/axes":740,"../heatmap/hover":949}],978:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.crossTraceDefaults=e("./cross_trace_defaults"),a.calc=e("../heatmap/calc"),a.plot=e("../heatmap/plot"),a.layerName="heatmaplayer",a.colorbar=e("../heatmap/colorbar"),a.style=e("../heatmap/style"),a.hoverPoints=e("./hover"),a.eventData=e("../histogram/event_data"),a.moduleType="trace",a.name="histogram2d",a.basePlotModule=e("../../plots/cartesian"),a.categories=["cartesian","svg","2dMap","histogram"],a.meta={},t.exports=a},{"../../plots/cartesian":752,"../heatmap/calc":943,"../heatmap/colorbar":945,"../heatmap/plot":953,"../heatmap/style":954,"../histogram/event_data":969,"./attributes":973,"./cross_trace_defaults":975,"./defaults":976,"./hover":977}],979:[function(e,t){"use strict";var a=e("../../registry"),o=e("../../lib");t.exports=function(e,t,r,i){var n=r("x"),l=r("y"),s=o.minRowLength(n),d=o.minRowLength(l);if(!s||!d)return void(t.visible=!1);t._length=ie(s,d);var c=a.getComponentMethod("calendars","handleTraceDefaults");c(e,t,["x","y"],i);var p=r("z")||r("marker.color");p&&r("histfunc"),r("histnorm"),r("autobinx"),r("autobiny")}},{"../../lib":692,"../../registry":823}],980:[function(e,t){"use strict";var a=e("../histogram2d/attributes"),o=e("../contour/attributes"),r=e("../../components/colorscale/attributes"),i=e("../../components/colorbar/attributes"),n=e("../../lib/extend").extendFlat;t.exports=n({x:a.x,y:a.y,z:a.z,marker:a.marker,histnorm:a.histnorm,histfunc:a.histfunc,nbinsx:a.nbinsx,xbins:a.xbins,nbinsy:a.nbinsy,ybins:a.ybins,autobinx:a.autobinx,autobiny:a.autobiny,autocontour:o.autocontour,ncontours:o.ncontours,contours:o.contours,line:o.line,zhoverformat:a.zhoverformat},r("",{cLetter:"z",editTypeOverride:"calc"}),{colorbar:i})},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../lib/extend":682,"../contour/attributes":913,"../histogram2d/attributes":973}],981:[function(e,t){"use strict";var a=e("../../lib"),o=e("../histogram2d/sample_defaults"),r=e("../contour/contours_defaults"),i=e("../contour/style_defaults"),n=e("./attributes");t.exports=function(e,t,l,s){function d(o,r){return a.coerce(e,t,n,o,r)}o(e,t,d,s);!1===t.visible||(r(e,t,d,function(o){return a.coerce2(e,t,n,o)}),i(e,t,d,s))}},{"../../lib":692,"../contour/contours_defaults":920,"../contour/style_defaults":934,"../histogram2d/sample_defaults":979,"./attributes":980}],982:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.crossTraceDefaults=e("../histogram2d/cross_trace_defaults"),a.calc=e("../contour/calc"),a.plot=e("../contour/plot").plot,a.layerName="contourlayer",a.style=e("../contour/style"),a.colorbar=e("../contour/colorbar"),a.hoverPoints=e("../contour/hover"),a.moduleType="trace",a.name="histogram2dcontour",a.basePlotModule=e("../../plots/cartesian"),a.categories=["cartesian","svg","2dMap","contour","histogram","showLegend"],a.meta={},t.exports=a},{"../../plots/cartesian":752,"../contour/calc":914,"../contour/colorbar":916,"../contour/hover":926,"../contour/plot":931,"../contour/style":933,"../histogram2d/cross_trace_defaults":975,"./attributes":980,"./defaults":981}],983:[function(e,t){"use strict";var a=e("../../components/colorscale/attributes"),o=e("../../components/colorbar/attributes"),r=e("../surface/attributes"),i=e("../../plots/attributes"),n=e("../../lib/extend").extendFlat;t.exports=n({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},a("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:o,opacity:r.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:n({},r.contours.x.show,{}),color:r.contours.x.color,width:r.contours.x.width,editType:"calc"},lightposition:{x:n({},r.lightposition.x,{dflt:1e5}),y:n({},r.lightposition.y,{dflt:1e5}),z:n({},r.lightposition.z,{dflt:0}),editType:"calc"},lighting:n({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},r.lighting),hoverinfo:n({},i.hoverinfo,{editType:"calc"})})},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../lib/extend":682,"../../plots/attributes":737,"../surface/attributes":1127}],984:[function(e,t){"use strict";var a=e("../../components/colorscale/calc");t.exports=function(e,t){t.intensity&&a(e,t,{vals:t.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":577}],985:[function(e,t){"use strict";function a(e,t,a){this.scene=e,this.uid=a,this.mesh=t,this.name="",this.color="#fff",this.data=null,this.showContour=!1}function o(e){return e.map(c)}var r=e("gl-mesh3d"),i=e("delaunay-triangulate"),n=e("alpha-shape"),l=e("convex-hull"),s=e("../../lib/gl_format_color").parseColorScale,c=e("../../lib/str2rgbarray"),p=e("../../plots/gl3d/zip3"),u=a.prototype;u.handlePick=function(e){if(e.object===this.mesh){var t=e.index=e.data.index;e.traceCoordinate=[this.data.x[t],this.data.y[t],this.data.z[t]];var a=this.data.text;return Array.isArray(a)&&void 0!==a[t]?e.textLabel=a[t]:a&&(e.textLabel=a),!0}},u.update=function(e){function t(e,t,a,o){return t.map(function(t){return e.d2l(t,0,o)*a})}var a=this.scene,r=a.fullSceneLayout;this.data=e;var u=p(t(r.xaxis,e.x,a.dataScale[0],e.xcalendar),t(r.yaxis,e.y,a.dataScale[1],e.ycalendar),t(r.zaxis,e.z,a.dataScale[2],e.zcalendar)),g;if(e.i&&e.j&&e.k)g=p(e.i,e.j,e.k);else if(0===e.alphahull)g=l(u);else if(0<e.alphahull)g=n(e.alphahull,u);else{var h=["x","y","z"].indexOf(e.delaunayaxis);g=i(u.map(function(e){return[e[(h+1)%3],e[(h+2)%3]]}))}var d={positions:u,cells:g,lightPosition:[e.lightposition.x,e.lightposition.y,e.lightposition.z],ambient:e.lighting.ambient,diffuse:e.lighting.diffuse,specular:e.lighting.specular,roughness:e.lighting.roughness,fresnel:e.lighting.fresnel,vertexNormalsEpsilon:e.lighting.vertexnormalsepsilon,faceNormalsEpsilon:e.lighting.facenormalsepsilon,opacity:e.opacity,contourEnable:e.contour.show,contourColor:c(e.contour.color).slice(0,3),contourWidth:e.contour.width,useFacetNormals:e.flatshading};e.intensity?(this.color="#fff",d.vertexIntensity=e.intensity,d.vertexIntensityBounds=[e.cmin,e.cmax],d.colormap=s(e.colorscale)):e.vertexcolor?(this.color=e.vertexcolor[0],d.vertexColors=o(e.vertexcolor)):e.facecolor?(this.color=e.facecolor[0],d.cellColors=o(e.facecolor)):(this.color=e.color,d.meshColor=c(e.color)),this.mesh.update(d)},u.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},t.exports=function(e,t){var o=e.glplot.gl,i=r({gl:o}),n=new a(e,i,t.uid);return i._trace=n,n.update(t),e.glplot.add(i),n}},{"../../lib/gl_format_color":689,"../../lib/str2rgbarray":715,"../../plots/gl3d/zip3":794,"alpha-shape":52,"convex-hull":118,"delaunay-triangulate":150,"gl-mesh3d":268}],986:[function(e,t){"use strict";var a=e("../../registry"),o=e("../../lib"),r=e("../../components/colorscale/defaults"),i=e("./attributes");t.exports=function(e,t,n,l){function s(a,r){return o.coerce(e,t,i,a,r)}function d(e){var t=e.map(function(e){var t=s(e);return t&&o.isArrayOrTypedArray(t)?t:null});return t.every(function(e){return e&&e.length===t[0].length})&&t}var c=d(["x","y","z"]),p=d(["i","j","k"]);if(!c)return void(t.visible=!1);p&&p.forEach(function(e){for(var t=0;t<e.length;++t)e[t]|=0});var u=a.getComponentMethod("calendars","handleTraceDefaults");u(e,t,["x","y","z"],l),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","contour.show","contour.color","contour.width","colorscale","reversescale","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(e){s(e)}),"intensity"in e?(s("intensity"),r(e,t,l,s,{prefix:"",cLetter:"c"})):(t.showscale=!1,"facecolor"in e?s("facecolor"):"vertexcolor"in e?s("vertexcolor"):s("color",n)),s("text"),t._length=null}},{"../../components/colorscale/defaults":579,"../../lib":692,"../../registry":823,"./attributes":983}],987:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.calc=e("./calc"),a.colorbar={min:"cmin",max:"cmax"},a.plot=e("./convert"),a.moduleType="trace",a.name="mesh3d",a.basePlotModule=e("../../plots/gl3d"),a.categories=["gl3d"],a.meta={},t.exports=a},{"../../plots/gl3d":783,"./attributes":983,"./calc":984,"./convert":985,"./defaults":986}],988:[function(e,t){"use strict";function a(e){return{line:{color:o({},l.color,{dflt:e}),width:l.width,dash:i,editType:"style"},editType:"style"}}var o=e("../../lib").extendFlat,r=e("../scatter/attributes"),i=e("../../components/drawing/attributes").dash,n=e("../../components/fx/attributes"),l=r.line;t.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:o({},l.width,{}),dash:o({},i,{}),editType:"style"},increasing:a("#3D9970"),decreasing:a("#FF4136"),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:o({},n.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":589,"../../components/fx/attributes":599,"../../lib":692,"../scatter/attributes":1040}],989:[function(e,t){"use strict";function a(e,t,a,o){return{o:e,h:t,l:a,c:o}}function o(e,t,a,r,u){for(var g=r.makeCalcdata(t,"open"),o=r.makeCalcdata(t,"high"),h=r.makeCalcdata(t,"low"),l=r.makeCalcdata(t,"close"),c=Array.isArray(t.text),m=!0,y=null,f=[],x=0;x<a.length;x++){var b=a[x],_=g[x],v=o[x],w=h[x],k=l[x];if(b!==p&&_!==p&&v!==p&&w!==p&&k!==p){k===_?null!==y&&k!==y&&(m=k>y):m=k>_,y=k;var T=u(_,v,w,k);T.pos=b,T.yc=(_+k)/2,T.i=x,T.dir=m?"increasing":"decreasing",c&&(T.tx=t.text[x]),f.push(T)}}return t._extremes[r._id]=d.findExtremes(r,n.concat(h,o),{padded:!0}),f.length&&(f[0].t={labels:{open:s(e,"open:")+" ",high:s(e,"high:")+" ",low:s(e,"low:")+" ",close:s(e,"close:")+" "}}),f}function r(e,t,a){var o=a._minDiff;if(!o){var r=e._fullData,l=[];o=1/0;var s;for(s=0;s<r.length;s++){var d=r[s];if("ohlc"===d.type&&!0===d.visible&&d.xaxis===t._id){l.push(d);var c=t.makeCalcdata(d,"x");d._xcalc=c;var p=n.distinctVals(c).minDiff;p&&isFinite(p)&&(o=ie(o,p))}}for(o===1/0&&(o=1),s=0;s<l.length;s++)l[s]._minDiff=o}return o*a.tickwidth}var n=e("../../lib"),s=n._,d=e("../../plots/cartesian/axes"),p=e("../../constants/numerical").BADNUM;t.exports={calc:function(e,t){var i=d.getFromId(e,t.xaxis),l=d.getFromId(e,t.yaxis),s=r(e,i,t),c=t._minDiff;t._minDiff=null;var p=t._xcalc;t._xcalc=null;var u=o(e,t,p,l,a);return t._extremes[i._id]=d.findExtremes(i,p,{vpad:c/2}),u.length?(n.extendFlat(u[0].t,{wHover:c/2,tickLen:s}),u):[{t:{empty:!0}}]},calcCommon:o}},{"../../constants/numerical":669,"../../lib":692,"../../plots/cartesian/axes":740}],990:[function(e,t){"use strict";function a(e,t,a,o){a(o+".line.color"),a(o+".line.width",t.line.width),a(o+".line.dash",t.line.dash)}var o=e("../../lib"),r=e("./ohlc_defaults"),i=e("./attributes");t.exports=function(e,t,n,l){function s(a,r){return o.coerce(e,t,i,a,r)}var d=r(e,t,s,l);return d?void(s("line.width"),s("line.dash"),a(e,t,s,"increasing"),a(e,t,s,"decreasing"),s("text"),s("tickwidth"),l._requestRangeslider[t.xaxis]=!0):void(t.visible=!1)}},{"../../lib":692,"./attributes":988,"./ohlc_defaults":993}],991:[function(e,t){"use strict";function a(e,a,o,r){function n(e){var t=f(e);return s.inbox(t-b,t+b,v)}function l(e){return s.inbox(e[h]-o,e[m]-o,v)}function d(e){return(n(e)+l(e))/2}var c=e.cd,p=e.xa,u=c[0].trace,g=c[0].t,t=u.type,h="ohlc"===t?"l":"min",m="ohlc"===t?"h":"max",y=g.bPos||0,f=function(e){return e.pos+y-a},x=g.bdPos||g.tickLen,b=g.wHover,_=ie(1,x/wa(p.r2c(p.range[1])-p.r2c(p.range[0]))),v,w;v=e.maxHoverDistance-_,w=e.maxSpikeDistance-_;var k=s.getDistanceFunction(r,n,l,d);if(s.getClosest(c,k,e),!1===e.index)return null;var T=c[e.index],A=T.dir,S=u[A],C=S.line.color;return e.color=i.opacity(C)&&S.line.width?C:S.fillcolor,e.x0=p.c2p(T.pos+y-x,!0),e.x1=p.c2p(T.pos+y+x,!0),e.xLabelVal=T.pos,e.spikeDistance=d(T)*w/v,e.xSpike=p.c2p(T.pos,!0),e}function o(e,o,r,s){var d=e.cd,c=e.ya,p=d[0].trace,u=d[0].t,t=[],g=a(e,o,r,s);if(!g)return[];var h=g.index,m=d[h],y=m.hi||p.hoverinfo,f=y.split("+"),x="all"===y||-1!==f.indexOf("y");if(!x)return[];for(var b=["high","open","close","low"],_={},v=0;v<b.length;v++){var w=b[v],k=p[w][g.index],T=c.c2p(k,!0),A;k in _?(A=_[k],A.yLabel+="<br>"+u.labels[w]+n.hoverLabelText(c,k)):(A=l.extendFlat({},g),A.y0=A.y1=T,A.yLabelVal=k,A.yLabel=u.labels[w]+n.hoverLabelText(c,k),A.name="",t.push(A),_[k]=A)}return t}function r(e,o,r,l){function s(e){return h.labels[e]+n.hoverLabelText(u,g[e][f])}var p=e.cd,u=e.ya,g=p[0].trace,h=p[0].t,t=a(e,o,r,l);if(!t)return[];var m=t.index,y=p[m],f=t.index=y.i,i=y.dir,x=y.hi||g.hoverinfo,b=x.split("+"),_="all"===x,v=_||-1!==b.indexOf("y"),w=_||-1!==b.indexOf("text"),k=v?[s("open"),s("high"),s("low"),s("close")+"  "+c[i]]:[];return w&&d(y,g,k),t.extraText=k.join("<br>"),t.y0=t.y1=u.c2p(y.yc,!0),[t]}var n=e("../../plots/cartesian/axes"),l=e("../../lib"),s=e("../../components/fx"),i=e("../../components/color"),d=e("../scatter/fill_hover_text"),c={increasing:"\u25B2",decreasing:"\u25BC"};t.exports={hoverPoints:function(e,t,a,i){var n=e.cd,l=n[0].trace;return l.hoverlabel.split?o(e,t,a,i):r(e,t,a,i)},hoverSplit:o,hoverOnPoints:r}},{"../../components/color":569,"../../components/fx":608,"../../lib":692,"../../plots/cartesian/axes":740,"../scatter/fill_hover_text":1048}],992:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"ohlc",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:e("./attributes"),supplyDefaults:e("./defaults"),calc:e("./calc").calc,plot:e("./plot"),style:e("./style"),hoverPoints:e("./hover").hoverPoints,selectPoints:e("./select")}},{"../../plots/cartesian":752,"./attributes":988,"./calc":989,"./defaults":990,"./hover":991,"./plot":994,"./select":995,"./style":996}],993:[function(e,t){"use strict";var a=e("../../registry"),o=e("../../lib");t.exports=function(e,t,r,i){var n=r("x"),l=r("open"),s=r("high"),d=r("low"),c=r("close");r("hoverlabel.split");var p=a.getComponentMethod("calendars","handleTraceDefaults");if(p(e,t,["x"],i),!!(l&&s&&d&&c)){var u=ie(l.length,s.length,d.length,c.length);return n&&(u=ie(u,o.minRowLength(n))),t._length=u,u}}},{"../../lib":692,"../../registry":823}],994:[function(e,t){"use strict";var a=e("d3"),o=e("../../lib");t.exports=function(e,r,i,n){var l=r.xaxis,t=r.yaxis;o.makeTraceGroups(n,i,"trace ohlc").each(function(e){var i=a.select(this),n=e[0],s=n.t,d=n.trace;if(r.isRangePlot||(n.node3=i),!0!==d.visible||s.empty)return void i.remove();var c=s.tickLen,p=i.selectAll("path").data(o.identity);p.enter().append("path"),p.exit().remove(),p.attr("d",function(e){var a=l.c2p(e.pos,!0),o=l.c2p(e.pos-c,!0),r=l.c2p(e.pos+c,!0),i=t.c2p(e.o,!0),n=t.c2p(e.h,!0),s=t.c2p(e.l,!0),d=t.c2p(e.c,!0);return"M"+o+","+i+"H"+a+"M"+a+","+n+"V"+s+"M"+r+","+d+"H"+a})})}},{"../../lib":692,d3:148}],995:[function(e,t){"use strict";t.exports=function(e,t){var a=e.cd,o=e.xaxis,r=e.yaxis,n=[],l=a[0].t.bPos||0,s;if(!1===t)for(s=0;s<a.length;s++)a[s].selected=0;else for(s=0;s<a.length;s++){var d=a[s];t.contains([o.c2p(d.pos+l),r.c2p(d.yc)],null,d.i,e)?(n.push({pointNumber:d.i,x:o.c2d(d.pos),y:r.c2d(d.yc)}),d.selected=1):d.selected=0}return n}},{}],996:[function(e,t){"use strict";var a=e("d3"),o=e("../../components/drawing"),r=e("../../components/color");t.exports=function(e,t){var i=t?t[0].node3:a.select(e).selectAll("g.ohlclayer").selectAll("g.trace");i.style("opacity",function(e){return e[0].trace.opacity}),i.each(function(e){var t=e[0].trace;a.select(this).selectAll("path").each(function(e){var i=t[e.dir].line;a.select(this).style("fill","none").call(r.stroke,i.color).call(o.dashLine,i.dash,i.width).style("opacity",t.selectedpoints&&!e.selected?.3:1)})})}},{"../../components/color":569,"../../components/drawing":590,d3:148}],997:[function(e,t){"use strict";var a=e("../../lib/extend").extendFlat,o=e("../../plots/attributes"),r=e("../../plots/font_attributes"),i=e("../../components/colorscale/attributes"),n=e("../../plots/domain").attributes,l=e("../scatter/attributes"),s=l.line,d=e("../../components/colorbar/attributes"),c=a({editType:"calc"},i("line",{editType:"calc"}),{showscale:s.showscale,colorbar:d,shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"}});t.exports={domain:n({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:a({},o.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:r({editType:"calc"}),tickfont:r({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:c,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../lib/extend":682,"../../plots/attributes":737,"../../plots/domain":766,"../../plots/font_attributes":767,"../scatter/attributes":1040}],998:[function(e,t,a){"use strict";var o=e("../../plots/get_data").getModuleCalcData,r=e("./plot"),i="parcats";a.name=i,a.plot=function(e,t,a,n){var l=o(e.calcdata,i);if(l.length){var s=l[0];r(e,s,a,n)}},a.clean=function(e,t,a,o){var r=o._has&&o._has("parcats"),i=t._has&&t._has("parcats");r&&!i&&o._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":777,"./plot":1003}],999:[function(e,t){"use strict";function a(e,t,a){var o=e.map(function(e){return e.categories.length}).reduce(function(e,t){return va(e,t)});return{dimensions:e,paths:t,trace:void 0,maxCats:o,count:a}}function o(e,t,a,o,r){return{dimensionInd:e,containerInd:t,displayInd:a,dimensionLabel:o,count:r,categories:[],dragX:null}}function r(e,t,a,o){return{dimensionInd:e,categoryInd:t,categoryValue:a,displayInd:t,categoryLabel:o,valueInds:[],count:0,dragY:null}}function i(e,t,a){e.valueInds.push(t),e.count+=a}function n(e,t,a){return{categoryInds:e,color:t,rawColor:a,valueInds:[],count:0}}function l(e,t,a){e.valueInds.push(t),e.count+=a}function s(e,t){t=void 0===t||null===t?[]:t.map(function(t){return t});var a={},o={},r=[];t.forEach(function(e,t){a[e]=0,o[e]=t});for(var n=0;n<e.length;n++){var l=e[n],s;a[l]===void 0?(a[l]=1,s=t.push(l)-1,o[l]=s):(a[l]++,s=o[l]),r.push(s)}var d=t.map(function(e){return a[e]});return{uniqueValues:t,uniqueCounts:d,inds:r}}function c(e){var t=e.map(function(e){return e.displayindex}),a;if(u(t))for(a=0;a<e.length;a++)e[a]._displayindex=e[a].displayindex;else for(a=0;a<e.length;a++)e[a]._displayindex=a}function p(e,t){e._categoryarray=t.uniqueValues,e._ticktext=null===e.ticktext||void 0===e.ticktext?[]:e.ticktext.slice();for(var a=e._ticktext.length;a<t.uniqueValues.length;a++)e._ticktext.push(t.uniqueValues[a])}function u(e){for(var t=Array(e.length),a=0;a<e.length;a++){if(0>e[a]||e[a]>=e.length)return!1;if(void 0!==t[e[a]])return!1;t[e[a]]=!0}return!0}var g=e("../../lib/gup").wrap,h=e("../../components/colorscale/helpers").hasColorscale,m=e("../../components/colorscale/calc"),y=e("../../lib/filter_unique.js"),f=e("../../components/drawing"),x=e("../../lib");t.exports=function(e,t){function u(e){var t;return t=x.isArrayOrTypedArray(T.color)?T.color[e%T.color.length]:T.color,{color:A(t),rawColor:t}}var b=x.filterVisible(t.dimensions);if(0===b.length)return[];var _=b.map(function(e){var t;return"trace"===e.categoryorder?t=null:"array"===e.categoryorder?t=e.categoryarray:(t=y(e.values).sort(),"category descending"===e.categoryorder&&(t=t.reverse())),s(e.values,t)}),v,w,k;v=x.isArrayOrTypedArray(t.counts)?t.counts:[t.counts],c(b),b.forEach(function(e,t){p(e,_[t])});var T=t.line,A;T?(h(t,"line")&&m(e,t,{vals:t.line.color,containerStr:"line",cLetter:"c"}),A=f.tryColorscale(T)):A=x.identity;var S=b[0].values.length,C={},L=_.map(function(e){return e.inds});k=0;var E,z;for(E=0;E<S;E++){var I=[];for(z=0;z<L.length;z++)I.push(L[z][E]);w=v[E%v.length],k+=w;var D=u(E),P="-"+D.rawColor;C[P]===void 0&&(C[P]=n(I,D.color,D.rawColor)),l(C[P],E,w)}var O=b.map(function(e,t){return o(t,e._index,e._displayindex,e.label,k)});for(E=0;E<S;E++)for(w=v[E%v.length],z=0;z<O.length;z++){var R=O[z].containerInd,M=_[z].inds[E],j=O[z].categories;if(void 0===j[M]){var B=t.dimensions[R]._categoryarray[M],F=t.dimensions[R]._ticktext[M];j[M]=r(z,M,B,F)}i(j[M],E,w)}return g(a(O,C,k))}},{"../../components/colorscale/calc":577,"../../components/colorscale/helpers":580,"../../components/drawing":590,"../../lib":692,"../../lib/filter_unique.js":683,"../../lib/gup":690}],1e3:[function(e,t){"use strict";function a(e,t,a,o,l){l("line.shape");var s=l("line.color",o.colorway[0]);if(i(e,"line")&&r.isArrayOrTypedArray(s)){if(s.length)return l("line.colorscale"),n(e,t,o,l,{prefix:"line.",cLetter:"c"}),s.length;t.line.color=a}return 1/0}function o(e,t){function a(a,o){return r.coerce(e,t,d.dimensions,a,o)}var o=a("values"),i=a("visible");if(o&&o.length||(i=t.visible=!1),i){a("label"),a("displayindex",t._index);var n=e.categoryarray,l=Array.isArray(n)&&0<n.length,s;l&&(s="array");var c=a("categoryorder",s);"array"===c?(a("categoryarray"),a("ticktext")):(delete e.categoryarray,delete e.ticktext),l||"array"!==c||(t.categoryorder="trace")}}var r=e("../../lib"),i=e("../../components/colorscale/helpers").hasColorscale,n=e("../../components/colorscale/defaults"),l=e("../../plots/domain").defaults,s=e("../../plots/array_container_defaults"),d=e("./attributes"),c=e("../parcoords/merge_length");t.exports=function(e,t,i,n){function p(a,o){return r.coerce(e,t,d,a,o)}var u=s(e,t,{name:"dimensions",handleItemDefaults:o}),g=a(e,t,i,n,p);l(t,n,p),Array.isArray(u)&&u.length||(t.visible=!1),c(t,u,"values",g),p("hoveron"),p("arrangement"),p("bundlecolors"),p("sortpaths"),p("counts");var h={family:n.font.family,size:R(n.font.size),color:n.font.color};r.coerceFont(p,"labelfont",h);var m={family:n.font.family,size:R(n.font.size/1.2),color:n.font.color};r.coerceFont(p,"tickfont",m)}},{"../../components/colorscale/defaults":579,"../../components/colorscale/helpers":580,"../../lib":692,"../../plots/array_container_defaults":736,"../../plots/domain":766,"../parcoords/merge_length":1012,"./attributes":997}],1001:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.calc=e("./calc"),a.plot=e("./plot"),a.colorbar={container:"line",min:"cmin",max:"cmax"},a.moduleType="trace",a.name="parcats",a.basePlotModule=e("./base_plot"),a.categories=["noOpacity"],a.meta={},t.exports=a},{"./attributes":997,"./base_plot":998,"./calc":999,"./defaults":1e3,"./plot":1003}],1002:[function(e,t){"use strict";function a(e,t,a,s){var p=e.map(D.bind(0,t,a)),u=s.selectAll("g.parcatslayer").data([null]);u.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var h=u.selectAll("g.trace.parcats").data(p,o),y=h.enter().append("g").attr("class","trace parcats");h.attr("transform",function(e){return"translate("+e.x+", "+e.y+")"}),y.append("g").attr("class","paths");var f=h.select("g.paths"),x=f.selectAll("path.path").data(function(e){return e.paths},o);x.attr("fill",function(e){return e.model.color});var b=x.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(e){return e.model.color}).attr("fill-opacity",0);c(b),x.attr("d",function(e){return e.svgD}),b.empty()||x.sort(i),x.exit().remove(),x.on("mouseover",n).on("mouseout",l).on("click",d),y.append("g").attr("class","dimensions");var _=h.select("g.dimensions"),v=_.selectAll("g.dimension").data(function(e){return e.dimensions},o);v.enter().append("g").attr("class","dimension"),v.attr("transform",function(e){return"translate("+e.x+", 0)"}),v.exit().remove();var w=v.selectAll("g.category").data(function(e){return e.categories},o),k=w.enter().append("g").attr("class","category");w.attr("transform",function(e){return"translate(0, "+e.y+")"}),k.append("rect").attr("class","catrect").attr("pointer-events","none"),w.select("rect.catrect").attr("fill","none").attr("width",function(e){return e.width}).attr("height",function(e){return e.height}),g(k);var E=w.selectAll("rect.bandrect").data(function(e){return e.bands},o);E.each(function(){N.raiseToTop(this)}),E.attr("fill",function(e){return e.color});var z=E.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(e){return e.color}).attr("fill-opacity",0);E.attr("fill",function(e){return e.color}).attr("width",function(e){return e.width}).attr("height",function(e){return e.height}).attr("y",function(e){return e.y}).attr("cursor",function(e){return"fixed"===e.parcatsViewModel.arrangement?"default":"perpendicular"===e.parcatsViewModel.arrangement?"ns-resize":"move"}),m(z),E.exit().remove(),k.append("text").attr("class","catlabel").attr("pointer-events","none");var I=t._fullLayout.paper_bgcolor;w.select("text.catlabel").attr("text-anchor",function(e){return r(e)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",I+" -1px  1px 2px, "+I+" 1px  1px 2px, "+I+"  1px -1px 2px, "+I+" -1px -1px 2px").style("fill","rgb(0, 0, 0)").attr("x",function(e){return r(e)?e.width+5:-5}).attr("y",function(e){return e.height/2}).text(function(e){return e.model.categoryLabel}).each(function(e){V.font(j.select(this),e.parcatsViewModel.categorylabelfont),H.convertToTspans(j.select(this),t)}),k.append("text").attr("class","dimlabel"),w.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(e){return"fixed"===e.parcatsViewModel.arrangement?"default":"ew-resize"}).attr("x",function(e){return e.width/2}).attr("y",-5).text(function(e,t){return 0===t?e.parcatsViewModel.model.dimensions[e.model.dimensionInd].dimensionLabel:null}).each(function(e){V.font(j.select(this),e.parcatsViewModel.labelfont)}),w.selectAll("rect.bandrect").on("mouseover",T).on("mouseout",A),w.exit().remove(),v.call(j.behavior.drag().origin(function(e){return{x:e.x,y:0}}).on("dragstart",S).on("drag",C).on("dragend",L)),h.each(function(e){e.traceSelection=j.select(this),e.pathSelection=j.select(this).selectAll("g.paths").selectAll("path.path"),e.dimensionSelection=j.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),h.exit().remove()}function o(e){return e.key}function r(e){var t=e.parcatsViewModel.dimensions.length,a=e.parcatsViewModel.dimensions[t-1].model.dimensionInd;return e.model.dimensionInd===a}function i(e,t){return e.model.rawColor>t.model.rawColor?1:e.model.rawColor<t.model.rawColor?-1:0}function n(e){if(!e.parcatsViewModel.dragDimension&&-1===e.parcatsViewModel.hoverinfoItems.indexOf("skip")){N.raiseToTop(this),p(j.select(this));var t=s(e);if(e.parcatsViewModel.graphDiv.emit("plotly_hover",{points:t,event:j.event}),-1===e.parcatsViewModel.hoverinfoItems.indexOf("none")){var a=j.mouse(this)[0],o=e.parcatsViewModel.graphDiv,r=o._fullLayout,i=r._paperdiv.node().getBoundingClientRect(),n=e.parcatsViewModel.graphDiv.getBoundingClientRect(),l,d,c;for(c=0;c<e.leftXs.length-1;c++)if(e.leftXs[c]+e.dimWidths[c]-2<=a&&a<=e.leftXs[c+1]+2){var u=e.parcatsViewModel.dimensions[c],g=e.parcatsViewModel.dimensions[c+1];l=(u.x+u.width+g.x)/2,d=(e.topYs[c]+e.topYs[c+1]+e.height)/2;break}var h=e.parcatsViewModel.x+l,m=e.parcatsViewModel.y+d,y=U.mostReadable(e.model.color,["black","white"]),f=[];-1!==e.parcatsViewModel.hoverinfoItems.indexOf("count")&&f.push(["Count:",e.model.count].join(" ")),-1!==e.parcatsViewModel.hoverinfoItems.indexOf("probability")&&f.push(["P:",(e.model.count/e.parcatsViewModel.model.count).toFixed(3)].join(" "));var x=f.join("<br>"),b=j.mouse(o)[0];F.loneHover({x:h-i.left+n.left,y:m-i.top+n.top,text:x,color:e.model.color,borderColor:"black",fontFamily:"Monaco, \"Courier New\", monospace",fontSize:10,fontColor:y,idealAlign:b<h?"right":"left"},{container:r._hoverlayer.node(),outerContainer:r._paper.node(),gd:o})}}}function l(e){if(!e.parcatsViewModel.dragDimension&&(c(j.select(this)),F.loneUnhover(e.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),e.parcatsViewModel.pathSelection.sort(i),-1===e.parcatsViewModel.hoverinfoItems.indexOf("skip"))){var t=s(e);e.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:t,event:j.event})}}function s(e){for(var t=[],a=E(e.parcatsViewModel),o=0,r;o<e.model.valueInds.length;o++)r=e.model.valueInds[o],t.push({curveNumber:a,pointNumber:r});return t}function d(e){if(-1===e.parcatsViewModel.hoverinfoItems.indexOf("skip")){var t=s(e);e.parcatsViewModel.graphDiv.emit("plotly_click",{points:t,event:j.event})}}function c(e){e.attr("fill",function(e){return e.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function p(e){e.attr("fill-opacity",.8).attr("stroke",function(e){return U.mostReadable(e.model.color,["black","white"])}).attr("stroke-width",.3)}function u(e){e.select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}function g(e){e.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function h(e){e.attr("stroke","black").attr("stroke-width",1.5)}function m(e){e.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function y(e){var t=e.parcatsViewModel.pathSelection,a=e.categoryViewModel.model.dimensionInd,o=e.categoryViewModel.model.categoryInd;return t.filter(function(t){return t.model.categoryInds[a]===o&&t.model.color===e.color})}function f(e){var t=j.select(e.parentNode).selectAll("rect.bandrect");t.each(function(e){var t=y(e);p(t),t.each(function(){N.raiseToTop(this)})}),u(j.select(e.parentNode))}function x(e){var t=j.select(e).datum(),a=y(t);p(a),a.each(function(){N.raiseToTop(this)}),j.select(e.parentNode).selectAll("rect.bandrect").filter(function(e){return e.color===t.color}).each(function(){N.raiseToTop(this),h(j.select(this))})}function b(e,t,a){var o=j.select(e).datum(),r=o.parcatsViewModel.graphDiv,i=j.select(e.parentNode).selectAll("rect.bandrect"),n=[];i.each(function(e){var t=y(e);t.each(function(e){Array.prototype.push.apply(n,s(e))})}),r.emit(t,{points:n,event:a})}function _(e,t,a){var o=j.select(e).datum(),r=o.parcatsViewModel.graphDiv,i=y(o),n=[];i.each(function(e){Array.prototype.push.apply(n,s(e))}),r.emit(t,{points:n,event:a})}function v(e,t){var a=j.select(t.parentNode).select("rect.catrect"),o=a.node().getBoundingClientRect(),r=a.datum(),i=r.parcatsViewModel,n=i.model.dimensions[r.model.dimensionInd],l=o.top+o.height/2,s,d;1<i.dimensions.length&&n.displayInd===i.dimensions.length-1?(s=o.left,d="left"):(s=o.left+o.width,d="right");var c=[];-1!==r.parcatsViewModel.hoverinfoItems.indexOf("count")&&c.push(["Count:",r.model.count].join(" ")),-1!==r.parcatsViewModel.hoverinfoItems.indexOf("probability")&&c.push(["P("+r.model.categoryLabel+"):",(r.model.count/r.parcatsViewModel.model.count).toFixed(3)].join(" "));var p=c.join("<br>");return{x:s-e.left,y:l-e.top,text:p,color:"lightgray",borderColor:"black",fontFamily:"Monaco, \"Courier New\", monospace",fontSize:12,fontColor:"black",idealAlign:d}}function w(e,t){var a=[];return j.select(t.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){var t=this;a.push(v(e,t))}),a}function k(e,t){var a=t.getBoundingClientRect(),o=j.select(t).datum(),r=o.categoryViewModel,i=r.parcatsViewModel,n=i.model.dimensions[r.model.dimensionInd],l=a.y+a.height/2,s,d;1<i.dimensions.length&&n.displayInd===i.dimensions.length-1?(s=a.left,d="left"):(s=a.left+a.width,d="right");var c=r.model.categoryLabel,p=o.parcatsViewModel.model.count,u=0;o.categoryViewModel.bands.forEach(function(e){e.color===o.color&&(u+=e.count)});var g=r.model.count,h=0;i.pathSelection.each(function(e){e.model.color===o.color&&(h+=e.model.count)});var m=[];if(-1!==r.parcatsViewModel.hoverinfoItems.indexOf("count")&&m.push(["Count:",u].join(" ")),-1!==r.parcatsViewModel.hoverinfoItems.indexOf("probability")){var y=(u/p).toFixed(3);m.push("P(color \u2229 "+c+"): "+y);var f=(u/h).toFixed(3);m.push("P("+c+" | color): "+f);var x=(u/g).toFixed(3);m.push("P(color | "+c+"): "+x)}var b=m.join("<br>"),_=U.mostReadable(o.color,["black","white"]);return{x:s-e.left,y:l-e.top,text:b,color:o.color,borderColor:"black",fontFamily:"Monaco, \"Courier New\", monospace",fontColor:_,fontSize:10,idealAlign:d}}function T(e){if(!e.parcatsViewModel.dragDimension&&-1===e.parcatsViewModel.hoverinfoItems.indexOf("skip")){var t=j.mouse(this)[1];if(-1>t)return;var a=e.parcatsViewModel.graphDiv,o=a._fullLayout,r=o._paperdiv.node().getBoundingClientRect(),i=e.parcatsViewModel.hoveron,n=this;if("color"===i?(x(n),_(n,"plotly_hover",j.event)):(f(n),b(n,"plotly_hover",j.event)),-1===e.parcatsViewModel.hoverinfoItems.indexOf("none")){var l;"category"===i?l=v(r,n):"color"===i?l=k(r,n):"dimension"===i&&(l=w(r,n)),l&&F.multiHovers(l,{container:o._hoverlayer.node(),outerContainer:o._paper.node(),gd:a})}}}function A(e){var t=e.parcatsViewModel;if(!t.dragDimension&&(c(t.pathSelection),g(t.dimensionSelection.selectAll("g.category")),m(t.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),F.loneUnhover(t.graphDiv._fullLayout._hoverlayer.node()),t.pathSelection.sort(i),-1===t.hoverinfoItems.indexOf("skip"))){var a=e.parcatsViewModel.hoveron,o=this;"color"===a?_(o,"plotly_unhover",j.event):b(o,"plotly_unhover",j.event)}}function S(e){"fixed"===e.parcatsViewModel.arrangement||(e.dragDimensionDisplayInd=e.model.displayInd,e.initialDragDimensionDisplayInds=e.parcatsViewModel.model.dimensions.map(function(e){return e.displayInd}),e.dragHasMoved=!1,e.dragCategoryDisplayInd=null,j.select(this).selectAll("g.category").select("rect.catrect").each(function(t){var a=j.mouse(this)[0],o=j.mouse(this)[1];-2<=a&&a<=t.width+2&&-2<=o&&o<=t.height+2&&(e.dragCategoryDisplayInd=t.model.displayInd,e.initialDragCategoryDisplayInds=e.model.categories.map(function(e){return e.displayInd}),t.model.dragY=t.y,N.raiseToTop(this.parentNode),j.select(this.parentNode).selectAll("rect.bandrect").each(function(t){t.y<o&&o<=t.y+t.height&&(e.potentialClickBand=this)}))}),e.parcatsViewModel.dragDimension=e,F.loneUnhover(e.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function C(e){if("fixed"!==e.parcatsViewModel.arrangement&&(e.dragHasMoved=!0,null!==e.dragDimensionDisplayInd)){var t=e.dragDimensionDisplayInd,a=e.parcatsViewModel.dimensions[t];if(null!==e.dragCategoryDisplayInd){var o=a.categories[e.dragCategoryDisplayInd];o.model.dragY+=j.event.dy;var r=o.model.dragY,i=o.model.displayInd,n=a.categories,l=n[i-1],s=n[i+1];void 0!==l&&r<l.y+l.height/2&&(o.model.displayInd=l.model.displayInd,l.model.displayInd=i),void 0!==s&&r+o.height>s.y+s.height/2&&(o.model.displayInd=s.model.displayInd,s.model.displayInd=i),e.dragCategoryDisplayInd=o.model.displayInd}if(null===e.dragCategoryDisplayInd||"freeform"===e.parcatsViewModel.arrangement){a.model.dragX=j.event.x;var d=e.parcatsViewModel.dimensions[t-1],c=e.parcatsViewModel.dimensions[t+1];void 0!==d&&a.model.dragX<d.x+d.width&&(a.model.displayInd=d.model.displayInd,d.model.displayInd=t),void 0!==c&&a.model.dragX+a.width>c.x&&(a.model.displayInd=c.model.displayInd,c.model.displayInd=e.dragDimensionDisplayInd),e.dragDimensionDisplayInd=a.model.displayInd}R(e.parcatsViewModel),O(e.parcatsViewModel),I(e.parcatsViewModel),z(e.parcatsViewModel)}}function L(e){if("fixed"!==e.parcatsViewModel.arrangement&&null!==e.dragDimensionDisplayInd){j.select(this).selectAll("text").attr("font-weight","normal");var t={},a=E(e.parcatsViewModel),o=e.parcatsViewModel.model.dimensions.map(function(e){return e.displayInd}),r=e.initialDragDimensionDisplayInds.some(function(e,t){return e!==o[t]});r&&o.forEach(function(a,o){var r=e.parcatsViewModel.model.dimensions[o].containerInd;t["dimensions["+r+"].displayindex"]=a});var i=!1;if(null!==e.dragCategoryDisplayInd){var n=e.model.categories.map(function(e){return e.displayInd});if(i=e.initialDragCategoryDisplayInds.some(function(e,t){return e!==n[t]}),i){var l=e.model.categories.slice().sort(function(e,t){return e.displayInd-t.displayInd}),s=l.map(function(e){return e.categoryValue}),d=l.map(function(e){return e.categoryLabel});t["dimensions["+e.model.containerInd+"].categoryarray"]=[s],t["dimensions["+e.model.containerInd+"].ticktext"]=[d],t["dimensions["+e.model.containerInd+"].categoryorder"]="array"}}if(-1===e.parcatsViewModel.hoverinfoItems.indexOf("skip")&&!e.dragHasMoved&&e.potentialClickBand&&("color"===e.parcatsViewModel.hoveron?_(e.potentialClickBand,"plotly_click",j.event.sourceEvent):b(e.potentialClickBand,"plotly_click",j.event.sourceEvent)),e.model.dragX=null,null!==e.dragCategoryDisplayInd){var c=e.parcatsViewModel.dimensions[e.dragDimensionDisplayInd].categories[e.dragCategoryDisplayInd];c.model.dragY=null,e.dragCategoryDisplayInd=null}e.dragDimensionDisplayInd=null,e.parcatsViewModel.dragDimension=null,e.dragHasMoved=null,e.potentialClickBand=null,R(e.parcatsViewModel),O(e.parcatsViewModel);var p=j.transition().duration(300).ease("cubic-in-out");p.each(function(){I(e.parcatsViewModel,!0),z(e.parcatsViewModel,!0)}).each("end",function(){(r||i)&&B.restyle(e.parcatsViewModel.graphDiv,t,[a])})}}function E(e){for(var t=e.graphDiv._fullData,a=0,o;a<t.length;a++)if(e.key===t[a].uid){o=a;break}return o}function z(e,t){function a(e){return t?e.transition():e}t===void 0&&(t=!1),e.pathSelection.data(function(e){return e.paths},o),a(e.pathSelection).attr("d",function(e){return e.svgD})}function I(e,t){function a(e){return t?e.transition():e}t===void 0&&(t=!1),e.dimensionSelection.data(function(e){return e.dimensions},o);var i=e.dimensionSelection.selectAll("g.category").data(function(e){return e.categories},o);a(e.dimensionSelection).attr("transform",function(e){return"translate("+e.x+", 0)"}),a(i).attr("transform",function(e){return"translate(0, "+e.y+")"});var n=i.select(".dimlabel");n.text(function(e,t){return 0===t?e.parcatsViewModel.model.dimensions[e.model.dimensionInd].dimensionLabel:null});var l=i.select(".catlabel");l.attr("text-anchor",function(e){return r(e)?"start":"end"}).attr("x",function(e){return r(e)?e.width+5:-5}).each(function(e){var t,a;r(e)?(t=e.width+5,a="start"):(t=-5,a="end"),j.select(this).selectAll("tspan").attr("x",t).attr("text-anchor",a)});var s=i.selectAll("rect.bandrect").data(function(e){return e.bands},o),d=s.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(e){return e.color}).attr("fill-opacity",0);s.attr("fill",function(e){return e.color}).attr("width",function(e){return e.width}).attr("height",function(e){return e.height}).attr("y",function(e){return e.y}),m(d),s.each(function(){N.raiseToTop(this)}),s.exit().remove()}function D(e,t,a){var o=a[0],r=t.margin||{l:80,r:80,t:100,b:80},i=o.trace,n=i.domain,l=t.width,s=t.height,d=ea(l*(n.x[1]-n.x[0])),c=ea(s*(n.y[1]-n.y[0])),p=n.x[0]*l+r.l,u=t.height-n.y[1]*t.height+r.t,g=i.line.shape,h;h="all"===i.hoverinfo?["count","probability"]:i.hoverinfo.split("+");var m={key:i.uid,model:o,x:p,y:u,width:d,height:c,hoveron:i.hoveron,hoverinfoItems:h,arrangement:i.arrangement,bundlecolors:i.bundlecolors,sortpaths:i.sortpaths,labelfont:i.labelfont,categorylabelfont:i.tickfont,pathShape:g,dragDimension:null,margin:r,paths:[],dimensions:[],graphDiv:e,traceSelection:null,pathSelection:null,dimensionSelection:null};return o.dimensions&&(R(m),O(m)),m}function P(e,t,a,o,r){var i=[],n=[],l,s;for(s=0;s<a.length-1;s++)l=j.interpolateNumber(a[s]+e[s],e[s+1]),i.push(l(r)),n.push(l(1-r));var c="M "+e[0]+","+t[0];for(c+="l"+a[0]+",0 ",s=1;s<a.length;s++)c+="C"+i[s-1]+","+t[s-1]+" "+n[s-1]+","+t[s]+" "+e[s]+","+t[s],c+="l"+a[s]+",0 ";for(c+="l0,"+o+" ",c+="l -"+a[a.length-1]+",0 ",s=a.length-2;0<=s;s--)c+="C"+n[s]+","+(t[s+1]+o)+" "+i[s]+","+(t[s]+o)+" "+(e[s]+a[s])+","+(t[s]+o),c+="l-"+a[s]+",0 ";return c+="Z",c}function O(e){function t(e){var t=e.categoryInds.map(function(e,t){return i[t][e]}),a=l.map(function(e){return t[e]});return a}var a=e.dimensions,o=e.model,r=a.map(function(e){return e.categories.map(function(e){return e.y})}),i=e.model.dimensions.map(function(e){return e.categories.map(function(e){return e.displayInd})}),n=e.model.dimensions.map(function(e){return e.displayInd}),l=e.dimensions.map(function(e){return e.model.dimensionInd}),s=a.map(function(e){return e.x}),c=a.map(function(e){return e.width}),u=[];for(var g in o.paths)o.paths.hasOwnProperty(g)&&u.push(o.paths[g]);u.sort(function(a,o){var r=t(a),i=t(o);return"backward"===e.sortpaths&&(r.reverse(),i.reverse()),r.push(a.valueInds[0]),i.push(o.valueInds[0]),e.bundlecolors&&(r.unshift(a.rawColor),i.unshift(o.rawColor)),r<i?-1:r>i?1:0});for(var p=Array(u.length),h=a[0].model.count,m=a[0].categories.map(function(e){return e.height}).reduce(function(e,t){return e+t}),y=0;y<u.length;y++){var f=u[y],x;x=0<h?m*(f.count/h):0;for(var b=Array(r.length),_=0;_<f.categoryInds.length;_++){var v=f.categoryInds[_],w=i[_][v],k=n[_];b[k]=r[k][w],r[k][w]+=x;var T=e.dimensions[k].categories[w],A=T.bands.length,S=T.bands[A-1];if(S===void 0||f.rawColor!==S.rawColor){var C=S===void 0?0:S.y+S.height;T.bands.push({key:C,color:f.color,rawColor:f.rawColor,height:x,width:T.width,count:f.count,y:C,categoryViewModel:T,parcatsViewModel:e})}else{var L=T.bands[A-1];L.height+=x,L.count+=f.count}}var E;E="hspline"===e.pathShape?P(s,b,c,x,.5):P(s,b,c,x,0),p[y]={key:f.valueInds[0],model:f,height:x,leftXs:s,topYs:b,dimWidths:c,svgD:E,parcatsViewModel:e}}e.paths=p}function R(e){var t=e.model.dimensions.map(function(e){return{displayInd:e.displayInd,dimensionInd:e.dimensionInd}});t.sort(function(e,t){return e.displayInd-t.displayInd});var a=[];for(var o in t){var r=t[o].dimensionInd,i=e.model.dimensions[r];a.push(M(e,i))}e.dimensions=a}function M(e,t){var a=e.model.dimensions.length,o=t.displayInd,r,i,n;r=1<a?(e.width-80-16)/(a-1):0,i=40,n=i+r*o;var l=[],s=e.model.maxCats,d=t.categories.length,c=t.count,p=e.height-8*(s-1),u=(s-d)*8/2,g=t.categories.map(function(e){return{displayInd:e.displayInd,categoryInd:e.categoryInd}}),h,m,y,f,x;for(g.sort(function(e,t){return e.displayInd-t.displayInd}),x=0;x<d;x++)f=g[x].categoryInd,m=t.categories[f],h=0<c?m.count/c*p:0,y={key:m.valueInds[0],model:m,width:16,height:h,y:null===m.dragY?u:m.dragY,bands:[],parcatsViewModel:e},u=u+h+8,l.push(y);return{key:t.dimensionInd,x:null===t.dragX?n:t.dragX,y:0,width:16,model:t,categories:l,parcatsViewModel:e,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}var j=e("d3"),B=e("../../plot_api/plot_api"),F=e("../../components/fx"),N=e("../../lib"),V=e("../../components/drawing"),U=e("tinycolor2"),H=e("../../lib/svg_text_utils");t.exports=function(e,t,o,r){a(o,e,r,t)}},{"../../components/drawing":590,"../../components/fx":608,"../../lib":692,"../../lib/svg_text_utils":716,"../../plot_api/plot_api":727,d3:148,tinycolor2:513}],1003:[function(e,t){"use strict";var a=e("./parcats");t.exports=function(e,t,o,r){var i=e._fullLayout,n=i._paper,l=i._size;a(e,n,t,{width:l.w,height:l.h,margin:{t:l.t,r:l.r,b:l.b,l:l.l}},o,r)}},{"./parcats":1002}],1004:[function(e,t){"use strict";var a=e("../../components/colorscale/attributes"),o=e("../../components/colorbar/attributes"),r=e("../../plots/cartesian/layout_attributes"),i=e("../../plots/font_attributes"),n=e("../../plots/domain").attributes,l=e("../../lib/extend").extendFlat,s=e("../../plot_api/plot_template").templatedArray;t.exports={domain:n({name:"parcoords",trace:!0,editType:"calc"}),hoverlabel:void 0,labelfont:i({editType:"calc"}),tickfont:i({editType:"calc"}),rangefont:i({editType:"calc"}),dimensions:s("dimension",{label:{valType:"string",editType:"calc"},tickvals:l({},r.tickvals,{editType:"calc"}),ticktext:l({},r.ticktext,{editType:"calc"}),tickformat:{valType:"string",dflt:"3s",editType:"calc"},visible:{valType:"boolean",dflt:!0,editType:"calc"},range:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},multiselect:{valType:"boolean",dflt:!0,editType:"calc"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:l(a("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"}),{colorbar:o,editType:"calc"})}},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../lib/extend":682,"../../plot_api/plot_template":730,"../../plots/cartesian/layout_attributes":753,"../../plots/domain":766,"../../plots/font_attributes":767}],1005:[function(e,t){"use strict";function o(e,t){return e*(1-E)+t*E}function r(e,t){return e*(1-z)+t*z}function i(e,t,a){if(l(t,a))return t;for(var n=e[0],s=n,d=1,c;d<e.length;d++){if(c=e[d],t<r(n,c))return o(n,s);if(t<c||d==e.length-1)return o(c,n);s=n,n=c}}function n(e,t,a){if(l(t,a))return t;for(var n=e[e.length-1],s=n,d=e.length-2,c;0<=d;d--){if(c=e[d],t>r(n,c))return o(n,s);if(t>c||d==e.length-1)return o(c,n);s=n,n=c}}function l(e,t){for(var a=0;a<t.length;a++)if(e>=t[a][0]&&e<=t[a][1])return!0;return!1}function s(e){e.attr("x",-C.bar.captureWidth/2).attr("width",C.bar.captureWidth)}function d(e){e.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function p(e){if(!e.brush.filterSpecified)return"0,"+e.height;for(var t=u(e.brush.filter.getConsolidated(),e.height),a=[0],o=t.length?t[0][0]:null,r=0,n,l,s;r<t.length;r++)n=t[r],l=n[1]-n[0],a.push(o),a.push(l),s=r+1,s<t.length&&(o=t[s][0]-n[1]);return a.push(e.height),a}function u(e,t){return e.map(function(e){return e.map(function(e){return e*t}).sort(L)})}function g(e,t){var a=C.bar.handleHeight;return t>e[1]+a||t<e[0]-a?void 0:t>=.9*e[1]+.1*e[0]?"n":t<=.9*e[0]+.1*e[1]?"s":"ns"}function h(){c.select(document.body).style("cursor",null)}function m(e){e.attr("stroke-dasharray",p)}function f(e,t){var a=c.select(e).selectAll(".highlight, .highlight-shadow"),o=t?a.transition().duration(C.bar.snapDuration).each("end",t):a;m(o)}function x(e,t){var o=e.brush,r=o.filterSpecified,n=NaN,l={},s;if(r){var d=e.height,c=o.filter.getConsolidated(),h=u(c,d),m=NaN,y=NaN,f=NaN;for(s=0;s<=h.length;s++){var x=h[s];if(x&&x[0]<=t&&t<=x[1]){m=s;break}else if(y=s?s-1:NaN,x&&x[0]>t){f=s;break}}if(n=m,isNaN(n)&&(isNaN(y)||isNaN(f)?n=isNaN(y)?f:y:n=t-h[y][1]<h[f][0]-t?y:f),!isNaN(n)){var p=h[n],b=g(p,t);b&&(l.interval=c[n],l.intervalPix=p,l.region=b)}}if(e.ordinal&&!l.region){var _=e.unitTickvals,a=e.unitToPaddedPx.invert(t);for(s=0;s<_.length;s++){var v=[.25*_[va(s-1,0)]+.75*_[s],.25*_[ie(s+1,_.length-1)]+.75*_[s]];if(a>=v[0]&&a<=v[1]){l.clickableOrdinalRange=v;break}}}return l}function b(e){e.on("mousemove",function(e){if(c.event.preventDefault(),!e.parent.inBrushDrag){var t=e.height-c.mouse(this)[1]-2*C.verticalPadding,a=x(e,t),o="crosshair";a.clickableOrdinalRange?o="pointer":a.region&&(o=a.region+"-resize"),c.select(document.body).style("cursor",o)}}).on("mouseleave",function(e){e.parent.inBrushDrag||h()}).call(c.behavior.drag().on("dragstart",function(e){c.event.sourceEvent.stopPropagation();var t=e.height-c.mouse(this)[1]-2*C.verticalPadding,a=e.unitToPaddedPx.invert(t),o=e.brush,r=x(e,t),i=r.interval,n=o.svgBrush;if(n.wasDragged=!1,n.grabbingBar="ns"===r.region,n.grabbingBar){var l=i.map(e.unitToPaddedPx);n.grabPoint=t-l[0]-C.verticalPadding,n.barLength=l[1]-l[0]}n.clickableOrdinalRange=r.clickableOrdinalRange,n.stayingIntervals=e.multiselect&&o.filterSpecified?o.filter.getConsolidated():[],i&&(n.stayingIntervals=n.stayingIntervals.filter(function(e){return e[0]!==i[0]&&e[1]!==i[1]})),n.startExtent=r.region?i["s"===r.region?1:0]:a,e.parent.inBrushDrag=!0,n.brushStartCallback()}).on("drag",function(e){c.event.sourceEvent.stopPropagation();var t=e.height-c.mouse(this)[1]-2*C.verticalPadding,a=e.brush.svgBrush;a.wasDragged=!0,a.newExtent=a.grabbingBar?[t-a.grabPoint,t+a.barLength-a.grabPoint].map(e.unitToPaddedPx.invert):[a.startExtent,e.unitToPaddedPx.invert(t)].sort(L);var o=va(0,-a.newExtent[0]),r=va(0,a.newExtent[1]-1);a.newExtent[0]+=o,a.newExtent[1]-=r,a.grabbingBar&&(a.newExtent[1]+=o,a.newExtent[0]-=r),e.brush.filterSpecified=!0,a.extent=a.stayingIntervals.concat([a.newExtent]),a.brushCallback(e),f(this.parentNode)}).on("dragend",function(t){var o=c.event;o.sourceEvent.stopPropagation();var e=t.brush,r=e.filter,l=e.svgBrush,s=l.grabbingBar;if(l.grabbingBar=!1,l.grabLocation=void 0,t.parent.inBrushDrag=!1,h(),!l.wasDragged)return l.wasDragged=void 0,l.clickableOrdinalRange?e.filterSpecified&&t.multiselect?l.extent.push(l.clickableOrdinalRange):(l.extent=[l.clickableOrdinalRange],e.filterSpecified=!0):s?(l.extent=l.stayingIntervals,0===l.extent.length&&k(e)):k(e),l.brushCallback(t),f(this.parentNode),void l.brushEndCallback(e.filterSpecified?r.getConsolidated():[]);var d=function(){r.set(r.getConsolidated())};if(t.ordinal){var p=t.unitTickvals;p[p.length-1]<p[0]&&p.reverse(),l.newExtent=[i(p,l.newExtent[0],l.stayingIntervals),n(p,l.newExtent[1],l.stayingIntervals)];var a=l.newExtent[1]>l.newExtent[0];l.extent=l.stayingIntervals.concat(a?[l.newExtent]:[]),l.extent.length||k(e),l.brushCallback(t),a?f(this.parentNode,d):(d(),f(this.parentNode))}else d();l.brushEndCallback(e.filterSpecified?r.getConsolidated():[])}))}function _(e,t){return e[0]-t[0]}function v(e){var t=e.selectAll(".background").data(y);t.enter().append("rect").classed("background",!0).call(s).call(d).style("pointer-events","auto").attr("transform","translate(0 "+C.verticalPadding+")"),t.call(b).attr("height",function(e){return e.height-C.verticalPadding});var a=e.selectAll(".highlight-shadow").data(y);a.enter().append("line").classed("highlight-shadow",!0).attr("x",-C.bar.width/2).attr("stroke-width",C.bar.width+C.bar.strokeWidth).attr("stroke",C.bar.strokeColor).attr("opacity",C.bar.strokeOpacity).attr("stroke-linecap","butt"),a.attr("y1",function(e){return e.height}).call(m);var o=e.selectAll(".highlight").data(y);o.enter().append("line").classed("highlight",!0).attr("x",-C.bar.width/2).attr("stroke-width",C.bar.width-C.bar.strokeWidth).attr("stroke",C.bar.fillColor).attr("opacity",C.bar.fillOpacity).attr("stroke-linecap","butt"),o.attr("y1",function(e){return e.height}).call(m)}function w(e){return e.svgBrush.extent.map(function(t){return t.slice()})}function k(e){e.filterSpecified=!1,e.svgBrush.extent=[[0,1]]}function T(e){return function(t){var a=t.brush,o=w(a),r=o.slice();a.filter.set(r),e()}}function A(e){for(var t=e.slice(),a=[],o=t.shift(),r;o;){for(r=o.slice();(o=t.shift())&&o[0]<=r[1];)r[1]=va(r[1],o[1]);a.push(r)}return a}function S(){var e=[],t,o;return{set:function(r){e=r.map(function(e){return e.slice().sort(L)}).sort(_),t=A(e),o=e.reduce(function(e,t){return[ie(e[0],t[0]),va(e[1],t[1])]},[1/0,-Infinity])},get:function(){return e.slice()},getConsolidated:function(){return t},getBounds:function(){return o}}}var C=e("./constants"),c=e("d3"),a=e("../../lib/gup").keyFun,y=e("../../lib/gup").repeat,L=e("../../lib").sorterAsc,E=C.bar.snapRatio,z=C.bar.snapClose;t.exports={makeBrush:function(e,t,a,o,r,i){var n=S();return n.set(a),{filter:n,filterSpecified:t,svgBrush:{extent:[],brushStartCallback:o,brushCallback:T(r),brushEndCallback:i}}},ensureAxisBrush:function(e){var t=e.selectAll("."+C.cn.axisBrush).data(y,a);t.enter().append("g").classed(C.cn.axisBrush,!0),v(t)},cleanRanges:function(e,t){if(Array.isArray(e[0])?(e=e.map(function(e){return e.sort(L)}),e=t.multiselect?A(e.sort(_)):[e[0]]):e=[e.sort(L)],t.tickvals){var a=t.tickvals.slice().sort(L);if(e=e.map(function(e){var t=[i(a,e[0],[]),n(a,e[1],[])];if(t[1]>t[0])return t}).filter(function(e){return e}),!e.length)return}return 1<e.length?e:e[0]}}},{"../../lib":692,"../../lib/gup":690,"./constants":1008,d3:148}],1006:[function(e,t,a){"use strict";var o=e("d3"),r=e("../../plots/get_data").getModuleCalcData,i=e("./plot"),n=e("../../constants/xmlns_namespaces"),l="parcoords";a.name=l,a.plot=function(e){var t=r(e.calcdata,l)[0];t.length&&i(e,t)},a.clean=function(e,t,a,o){var r=o._has&&o._has(l),i=t._has&&t._has(l);r&&!i&&(o._paperdiv.selectAll(".parcoords").remove(),o._glimages.selectAll("*").remove())},a.toSVG=function(e){var t=e._fullLayout._glimages,a=o.select(e).selectAll(".svg-container"),r=a.filter(function(e,t){return t===a.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");r.each(function(){var e=this,a=e.toDataURL("image/png"),o=t.append("svg:image");o.attr({xmlns:n.svg,"xlink:href":a,preserveAspectRatio:"none",x:0,y:0,width:e.width,height:e.height})}),window.setTimeout(function(){o.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":670,"../../plots/get_data":777,"./plot":1014,d3:148}],1007:[function(e,t){"use strict";function a(e){for(var t=Array(e),a=0;a<e;a++)t[a]=.5;return t}var o=e("../../components/colorscale/helpers").hasColorscale,r=e("../../components/colorscale/calc"),i=e("../../lib"),n=e("../../lib/gup").wrap;t.exports=function(e,t){var l=!!t.line.colorscale&&i.isArrayOrTypedArray(t.line.color),s=l?t.line.color:a(t._length),d=l?t.line.colorscale:[[0,t.line.color],[1,t.line.color]];return o(t,"line")&&r(e,t,{vals:s,containerStr:"line",cLetter:"c"}),n({lineColor:s,cscale:d})}},{"../../components/colorscale/calc":577,"../../components/colorscale/helpers":580,"../../lib":692,"../../lib/gup":690}],1008:[function(e,t){"use strict";t.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeColor:"white",strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],1009:[function(e,t){"use strict";function a(e,t,a,o,l){var s=l("line.color",a);if(i(e,"line")&&r.isArrayOrTypedArray(s)){if(s.length)return l("line.colorscale"),n(e,t,o,l,{prefix:"line.",cLetter:"c"}),s.length;t.line.color=a}return 1/0}function o(e,t){function a(a,o){return r.coerce(e,t,d.dimensions,a,o)}var o=a("values"),i=a("visible");if(o&&o.length||(i=t.visible=!1),i){a("label"),a("tickvals"),a("ticktext"),a("tickformat"),a("range"),a("multiselect");var n=a("constraintrange");n&&(t.constraintrange=c.cleanRanges(n,t))}}var r=e("../../lib"),i=e("../../components/colorscale/helpers").hasColorscale,n=e("../../components/colorscale/defaults"),l=e("../../plots/domain").defaults,s=e("../../plots/array_container_defaults"),d=e("./attributes"),c=e("./axisbrush"),p=e("./constants").maxDimensionCount,u=e("./merge_length");t.exports=function(e,t,i,n){function c(a,o){return r.coerce(e,t,d,a,o)}var g=e.dimensions;Array.isArray(g)&&g.length>p&&(r.log("parcoords traces support up to "+p+" dimensions at the moment"),g.splice(p));var h=s(e,t,{name:"dimensions",handleItemDefaults:o}),m=a(e,t,i,n,c);l(t,n,c),Array.isArray(h)&&h.length||(t.visible=!1),u(t,h,"values",m);var y={family:n.font.family,size:R(n.font.size/1.2),color:n.font.color};r.coerceFont(c,"labelfont",y),r.coerceFont(c,"tickfont",y),r.coerceFont(c,"rangefont",y)}},{"../../components/colorscale/defaults":579,"../../components/colorscale/helpers":580,"../../lib":692,"../../plots/array_container_defaults":736,"../../plots/domain":766,"./attributes":1004,"./axisbrush":1005,"./constants":1008,"./merge_length":1012}],1010:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.calc=e("./calc"),a.plot=e("./plot"),a.colorbar={container:"line",min:"cmin",max:"cmax"},a.moduleType="trace",a.name="parcoords",a.basePlotModule=e("./base_plot"),a.categories=["gl","regl","noOpacity"],a.meta={},t.exports=a},{"./attributes":1004,"./base_plot":1006,"./calc":1007,"./defaults":1009,"./plot":1014}],1011:[function(e,t){"use strict";function a(e){e.read({x:0,y:0,width:1,height:1,data:A})}function o(e,t,a,o,r){var i=e._gl;i.enable(i.SCISSOR_TEST),i.scissor(t,a,o,r),e.clear({color:[0,0,0,0],depth:1})}function r(e,t,r,i,n,l){function s(a){var c;c=ie(i,n-a*i),l.offset=2*a*i,l.count=2*c,0===a&&(window.cancelAnimationFrame(r.currentRafs[d]),delete r.currentRafs[d],o(e,l.scissorX,l.scissorY,l.scissorWidth,l.viewBoxSize[1]));r.clearOnly||(t(l),a*i+c<n&&(r.currentRafs[d]=window.requestAnimationFrame(function(){s(a+1)})),r.drawCompleted=!1)}var d=l.key;r.drawCompleted||(a(e),r.drawCompleted=!0),s(0)}function n(e){return va(_,ie(1-_,e))}function l(e,t,a){for(var o=[],r=0,i;256>r;r++)i=e(r/255),o.push((t?T:i).concat(a));return o}function s(e,t){return(e>>>8*t)%256/255}function d(e,t,a){for(var o=t.length,r=[],l=0;l<e;l++)for(var d=0;d<64;d++)r.push(d<o?t[d].paddedUnitValues[l]:d==63?n(a[l]):d>=60?s(l,62-d):.5);return r}function c(e,t,a){var o=[],r,n,l;for(n=0;n<e;n++)for(l=0;l<2;l++)for(r=0;r<4;r++)o.push(t[64*n+4*a+r]),63===4*a+r&&0==l%2&&(o[o.length-1]*=-1);return o}function p(e,t,a){for(var o=0;16>o;o++)e["p"+o.toString(16)](c(t,a,o))}function u(e){for(var t={},a=0;16>a;a++)t["p"+a.toString(16)]=e.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return t}var g=e("glslify"),h=g(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 p0, p1, p2, p3,\n               p4, p5, p6, p7,\n               p8, p9, pa, pb,\n               pc, pd, pe;\n\nattribute vec4 pf;\n\nuniform mat4 dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution,\n             viewBoxPosition,\n             viewBoxSize;\n\nuniform sampler2D palette;\nuniform sampler2D mask;\nuniform float maskHeight;\n\nuniform vec2 colorClamp;\n\nvarying vec4 fragColor;\n\nvec4 unit_1 = vec4(1, 1, 1, 1);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * unit_1, unit_1);\n}\n\nfloat axisY(\n        float x,\n        mat4 d[4],\n        mat4 dim1A, mat4 dim2A, mat4 dim1B, mat4 dim2B, mat4 dim1C, mat4 dim2C, mat4 dim1D, mat4 dim2D\n    ) {\n\n    float y1 = val(d[0], dim1A) + val(d[1], dim1B) + val(d[2], dim1C) + val(d[3], dim1D);\n    float y2 = val(d[0], dim2A) + val(d[1], dim2B) + val(d[2], dim2C) + val(d[3], dim2D);\n    return y1 * (1.0 - x) + y2 * x;\n}\n\nconst int bitsPerByte = 8;\n\nint mod2(int a) {\n    return a - 2 * (a / 2);\n}\n\nint mod8(int a) {\n    return a - 8 * (a / 8);\n}\n\nvec4 zero = vec4(0, 0, 0, 0);\nvec4 unit_0 = vec4(1, 1, 1, 1);\nvec2 xyProjection = vec2(1, 1);\n\nmat4 mclamp(mat4 m, mat4 lo, mat4 hi) {\n    return mat4(clamp(m[0], lo[0], hi[0]),\n                clamp(m[1], lo[1], hi[1]),\n                clamp(m[2], lo[2], hi[2]),\n                clamp(m[3], lo[3], hi[3]));\n}\n\nbool mshow(mat4 p, mat4 lo, mat4 hi) {\n    return mclamp(p, lo, hi) == p;\n}\n\nbool withinBoundingBox(\n        mat4 d[4],\n        mat4 loA, mat4 hiA, mat4 loB, mat4 hiB, mat4 loC, mat4 hiC, mat4 loD, mat4 hiD\n    ) {\n\n    return mshow(d[0], loA, hiA) &&\n           mshow(d[1], loB, hiB) &&\n           mshow(d[2], loC, hiC) &&\n           mshow(d[3], loD, hiD);\n}\n\nbool withinRasterMask(mat4 d[4], sampler2D mask, float height) {\n    bool result = true;\n    int bitInByteStepper;\n    float valY, valueY, scaleX;\n    int hit, bitmask, valX;\n    for(int i = 0; i < 4; i++) {\n        for(int j = 0; j < 4; j++) {\n            for(int k = 0; k < 4; k++) {\n                bitInByteStepper = mod8(j * 4 + k);\n                valX = i * 2 + j / 2;\n                valY = d[i][j][k];\n                valueY = valY * (height - 1.0) + 0.5;\n                scaleX = (float(valX) + 0.5) / 8.0;\n                hit = int(texture2D(mask, vec2(scaleX, (valueY + 0.5) / height))[3] * 255.0) / int(pow(2.0, float(bitInByteStepper)));\n                result = result && mod2(hit) == 1;\n            }\n        }\n    }\n    return result;\n}\n\nvec4 position(\n        float depth,\n        vec2 resolution, vec2 viewBoxPosition, vec2 viewBoxSize,\n        mat4 dims[4],\n        float signum,\n        mat4 dim1A, mat4 dim2A, mat4 dim1B, mat4 dim2B, mat4 dim1C, mat4 dim2C, mat4 dim1D, mat4 dim2D,\n        mat4 loA, mat4 hiA, mat4 loB, mat4 hiB, mat4 loC, mat4 hiC, mat4 loD, mat4 hiD,\n        sampler2D mask, float maskHeight\n    ) {\n\n    float x = 0.5 * signum + 0.5;\n    float y = axisY(x, dims, dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D);\n\n    float show = float(\n                            withinBoundingBox(dims, loA, hiA, loB, hiB, loC, hiC, loD, hiD)\n                         && withinRasterMask(dims, mask, maskHeight)\n                      );\n\n    vec2 viewBoxXY = viewBoxPosition + viewBoxSize * vec2(x, y);\n    float depthOrHide = depth + 2.0 * (1.0 - show);\n\n    return vec4(\n        xyProjection * (2.0 * viewBoxXY / resolution - 1.0),\n        depthOrHide,\n        1.0\n    );\n}\n\nvoid main() {\n\n    float prominence = abs(pf[3]);\n\n    mat4 p[4];\n    p[0] = mat4(p0, p1, p2, p3);\n    p[1] = mat4(p4, p5, p6, p7);\n    p[2] = mat4(p8, p9, pa, pb);\n    p[3] = mat4(pc, pd, pe, abs(pf));\n\n    gl_Position = position(\n        1.0 - prominence,\n        resolution, viewBoxPosition, viewBoxSize,\n        p,\n        sign(pf[3]),\n        dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D,\n        loA, hiA, loB, hiB, loC, hiC, loD, hiD,\n        mask, maskHeight\n    );\n\n    float clampedColorIndex = clamp((prominence - colorClamp[0]) / (colorClamp[1] - colorClamp[0]), 0.0, 1.0);\n    fragColor = texture2D(palette, vec2((clampedColorIndex * 255.0 + 0.5) / 256.0, 0.5));\n}\n"]),m=g(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 p0, p1, p2, p3,\n               p4, p5, p6, p7,\n               p8, p9, pa, pb,\n               pc, pd, pe;\n\nattribute vec4 pf;\n\nuniform mat4 dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D;\n\nuniform vec2 resolution,\n             viewBoxPosition,\n             viewBoxSize;\n\nuniform sampler2D palette;\n\nuniform vec2 colorClamp;\n\nvarying vec4 fragColor;\n\nvec2 xyProjection = vec2(1, 1);\n\nvec4 unit = vec4(1, 1, 1, 1);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * unit, unit);\n}\n\nfloat axisY(\n        float x,\n        mat4 d[4],\n        mat4 dim1A, mat4 dim2A, mat4 dim1B, mat4 dim2B, mat4 dim1C, mat4 dim2C, mat4 dim1D, mat4 dim2D\n    ) {\n\n    float y1 = val(d[0], dim1A) + val(d[1], dim1B) + val(d[2], dim1C) + val(d[3], dim1D);\n    float y2 = val(d[0], dim2A) + val(d[1], dim2B) + val(d[2], dim2C) + val(d[3], dim2D);\n    return y1 * (1.0 - x) + y2 * x;\n}\n\nvec4 position(\n        float depth,\n        vec2 resolution, vec2 viewBoxPosition, vec2 viewBoxSize,\n        mat4 dims[4],\n        float signum,\n        mat4 dim1A, mat4 dim2A, mat4 dim1B, mat4 dim2B, mat4 dim1C, mat4 dim2C, mat4 dim1D, mat4 dim2D\n    ) {\n\n    float x = 0.5 * signum + 0.5;\n    float y = axisY(x, dims, dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D);\n\n    vec2 viewBoxXY = viewBoxPosition + viewBoxSize * vec2(x, y);\n\n    return vec4(\n        xyProjection * (2.0 * viewBoxXY / resolution - 1.0),\n        depth,\n        1.0\n    );\n}\n\nvoid main() {\n\n    float prominence = abs(pf[3]);\n\n    mat4 p[4];\n    p[0] = mat4(p0, p1, p2, p3);\n    p[1] = mat4(p4, p5, p6, p7);\n    p[2] = mat4(p8, p9, pa, pb);\n    p[3] = mat4(pc, pd, pe, abs(pf));\n\n    gl_Position = position(\n        1.0 - prominence,\n        resolution, viewBoxPosition, viewBoxSize,\n        p,\n        sign(pf[3]),\n        dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D\n    );\n\n    float clampedColorIndex = clamp((prominence - colorClamp[0]) / (colorClamp[1] - colorClamp[0]), 0.0, 1.0);\n    fragColor = texture2D(palette, vec2((clampedColorIndex * 255.0 + 0.5) / 256.0, 0.5));\n}\n"]),y=g(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 p0, p1, p2, p3,\n               p4, p5, p6, p7,\n               p8, p9, pa, pb,\n               pc, pd, pe;\n\nattribute vec4 pf;\n\nuniform mat4 dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution,\n             viewBoxPosition,\n             viewBoxSize;\n\nuniform sampler2D mask;\nuniform float maskHeight;\n\nuniform vec2 colorClamp;\n\nvarying vec4 fragColor;\n\nvec4 unit_1 = vec4(1, 1, 1, 1);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * unit_1, unit_1);\n}\n\nfloat axisY(\n        float x,\n        mat4 d[4],\n        mat4 dim1A, mat4 dim2A, mat4 dim1B, mat4 dim2B, mat4 dim1C, mat4 dim2C, mat4 dim1D, mat4 dim2D\n    ) {\n\n    float y1 = val(d[0], dim1A) + val(d[1], dim1B) + val(d[2], dim1C) + val(d[3], dim1D);\n    float y2 = val(d[0], dim2A) + val(d[1], dim2B) + val(d[2], dim2C) + val(d[3], dim2D);\n    return y1 * (1.0 - x) + y2 * x;\n}\n\nconst int bitsPerByte = 8;\n\nint mod2(int a) {\n    return a - 2 * (a / 2);\n}\n\nint mod8(int a) {\n    return a - 8 * (a / 8);\n}\n\nvec4 zero = vec4(0, 0, 0, 0);\nvec4 unit_0 = vec4(1, 1, 1, 1);\nvec2 xyProjection = vec2(1, 1);\n\nmat4 mclamp(mat4 m, mat4 lo, mat4 hi) {\n    return mat4(clamp(m[0], lo[0], hi[0]),\n                clamp(m[1], lo[1], hi[1]),\n                clamp(m[2], lo[2], hi[2]),\n                clamp(m[3], lo[3], hi[3]));\n}\n\nbool mshow(mat4 p, mat4 lo, mat4 hi) {\n    return mclamp(p, lo, hi) == p;\n}\n\nbool withinBoundingBox(\n        mat4 d[4],\n        mat4 loA, mat4 hiA, mat4 loB, mat4 hiB, mat4 loC, mat4 hiC, mat4 loD, mat4 hiD\n    ) {\n\n    return mshow(d[0], loA, hiA) &&\n           mshow(d[1], loB, hiB) &&\n           mshow(d[2], loC, hiC) &&\n           mshow(d[3], loD, hiD);\n}\n\nbool withinRasterMask(mat4 d[4], sampler2D mask, float height) {\n    bool result = true;\n    int bitInByteStepper;\n    float valY, valueY, scaleX;\n    int hit, bitmask, valX;\n    for(int i = 0; i < 4; i++) {\n        for(int j = 0; j < 4; j++) {\n            for(int k = 0; k < 4; k++) {\n                bitInByteStepper = mod8(j * 4 + k);\n                valX = i * 2 + j / 2;\n                valY = d[i][j][k];\n                valueY = valY * (height - 1.0) + 0.5;\n                scaleX = (float(valX) + 0.5) / 8.0;\n                hit = int(texture2D(mask, vec2(scaleX, (valueY + 0.5) / height))[3] * 255.0) / int(pow(2.0, float(bitInByteStepper)));\n                result = result && mod2(hit) == 1;\n            }\n        }\n    }\n    return result;\n}\n\nvec4 position(\n        float depth,\n        vec2 resolution, vec2 viewBoxPosition, vec2 viewBoxSize,\n        mat4 dims[4],\n        float signum,\n        mat4 dim1A, mat4 dim2A, mat4 dim1B, mat4 dim2B, mat4 dim1C, mat4 dim2C, mat4 dim1D, mat4 dim2D,\n        mat4 loA, mat4 hiA, mat4 loB, mat4 hiB, mat4 loC, mat4 hiC, mat4 loD, mat4 hiD,\n        sampler2D mask, float maskHeight\n    ) {\n\n    float x = 0.5 * signum + 0.5;\n    float y = axisY(x, dims, dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D);\n\n    float show = float(\n                            withinBoundingBox(dims, loA, hiA, loB, hiB, loC, hiC, loD, hiD)\n                         && withinRasterMask(dims, mask, maskHeight)\n                      );\n\n    vec2 viewBoxXY = viewBoxPosition + viewBoxSize * vec2(x, y);\n    float depthOrHide = depth + 2.0 * (1.0 - show);\n\n    return vec4(\n        xyProjection * (2.0 * viewBoxXY / resolution - 1.0),\n        depthOrHide,\n        1.0\n    );\n}\n\nvoid main() {\n\n    float prominence = abs(pf[3]);\n\n    mat4 p[4];\n    p[0] = mat4(p0, p1, p2, p3);\n    p[1] = mat4(p4, p5, p6, p7);\n    p[2] = mat4(p8, p9, pa, pb);\n    p[3] = mat4(pc, pd, pe, abs(pf));\n\n    gl_Position = position(\n        1.0 - prominence,\n        resolution, viewBoxPosition, viewBoxSize,\n        p,\n        sign(pf[3]),\n        dim1A, dim2A, dim1B, dim2B, dim1C, dim2C, dim1D, dim2D,\n        loA, hiA, loB, hiB, loC, hiC, loD, hiD,\n        mask, maskHeight\n    );\n\n    fragColor = vec4(pf.rgb, 1.0);\n}\n"]),f=g(["precision lowp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n    gl_FragColor = fragColor;\n}\n"]),b=e("../../lib"),_=1e-6,v=2048,w=8,k=64/w,T=[119,119,119],A=new Uint8Array(4),S=new Uint8Array(4),C={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};t.exports=function(e,t){function a(e){D=e.model,P=e.viewModel,i=P.dimensions.slice(),O=i[0]?i[0].values.length:0;var t=D.lines,a=T?t.color.map(function(e,a){return a/t.color.length}):t.color,o=va(1/255,_a(1/a.length,1/3)),r=d(O,i,a);p(E,O,r),z=A.texture(b.extendFlat({data:l(D.unitToColor,_,R(255*(_?o:1)))},C))}function n(e,t,a,o,r,i,n,l,s,c,p){var u=[e,t],g=[0,1].map(function(){return[0,1,2,3].map(function(){return new Float32Array(16)})}),h,m,y,f;for(h=0;2>h;h++)for(f=u[h],m=0;4>m;m++)for(y=0;16>y;y++)g[h][m][y]=y+16*m===f?1:0;var x=D.lines.canvasOverdrag,_=D.domain,v=D.canvasWidth,w=D.canvasHeight,k=b.extendFlat({key:n,resolution:[v,w],viewBoxPosition:[a+x,o],viewBoxSize:[r,i],i:e,ii:t,dim1A:g[0][0],dim1B:g[0][1],dim1C:g[0][2],dim1D:g[0][3],dim2A:g[1][0],dim2B:g[1][1],dim2C:g[1][2],dim2D:g[1][3],colorClamp:B,scissorX:(l===s?0:a+x)+(D.pad.l-x)+D.layoutWidth*_.x[0],scissorWidth:(l===c?v-a+x:r+.5)+(l===s?a+x:0),scissorY:o+D.pad.b+D.layoutHeight*_.y[0],scissorHeight:i,viewportX:D.pad.l-x+D.layoutWidth*_.x[0],viewportY:D.pad.b+D.layoutHeight*_.y[0],viewportWidth:v,viewportHeight:w},p);return k}function s(){function e(e,t){var a=v-1;return[va(0,ea(t[0]*a)),ie(a,ae(t[1]*a))]}var t=[0,1].map(function(){return[0,1,2,3].map(function(){return new Float32Array(16)})}),a,o,r;for(a=0;2>a;a++)for(o=0;4>o;o++)for(r=0;16>r;r++){var n=r+16*o,l;l=n<i.length?i[n].brush.filter.getBounds()[a]:a,t[a][o][r]=l+(2*a-1)*1e-7}for(var s=Array.apply(null,Array(v*k)).map(function(){return 255}),c=0;c<i.length;c++){var p=c%w,u=(c-p)/w,g=_a(2,p),h=i[c],m=h.brush.filter.get();if(!(2>m.length))for(var y=e(h,m[0])[1],f=1,x;f<m.length;f++){x=e(h,m[f]);for(var b=y+1;b<x[0];b++)s[b*k+u]&=~g;y=va(y,x[1])}}var _={shape:[k,v],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:s};return M?M(_):M=A.texture(_),{maskTexture:M,maskHeight:v,loA:t[0][0],loB:t[0][1],loC:t[0][2],loD:t[0][3],hiA:t[1][0],hiB:t[1][1],hiC:t[1][2],hiD:t[1][3]}}function c(e,t,a){var l=e.length,d=1/0,c=-Infinity,p,u,g;for(p=0;p<l;p++)e[p].dim2.canvasX>c&&(c=e[p].dim2.canvasX,g=p),e[p].dim1.canvasX<d&&(d=e[p].dim1.canvasX,u=p);0===l&&o(A,0,0,D.canvasWidth,D.canvasHeight);var h=_?{}:s();for(p=0;p<l;p++){var m=e[p],f=m.dim1,b=f.crossfilterDimensionIndex,i=m.canvasX,x=m.canvasY,y=m.dim2,v=y.crossfilterDimensionIndex,w=m.panelSizeX,k=m.panelSizeY,T=i+w;if(t||!F[b]||F[b][0]!==i||F[b][1]!==T){F[b]=[i,T];var S=n(b,v,i,x,w,k,f.crossfilterDimensionIndex,p,u,g,h);L.clearOnly=a,r(A,j,L,t?D.lines.blockLineCount:O,O,S)}}}function g(){for(var t in e.style["pointer-events"]="none",z.destroy(),M&&M.destroy(),E)E[t].destroy()}var _=t.context,T=t.pick,A=t.regl,L={currentRafs:{},drawCompleted:!0,clearOnly:!1},E=u(A),z=A.texture(C),D,P,i,O,M;a(t);var j=A({profile:!1,blend:{enable:_,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!_,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:A.prop("scissorX"),y:A.prop("scissorY"),width:A.prop("scissorWidth"),height:A.prop("scissorHeight")}},viewport:{x:A.prop("viewportX"),y:A.prop("viewportY"),width:A.prop("viewportWidth"),height:A.prop("viewportHeight")},dither:!1,vert:T?y:_?m:h,frag:f,primitive:"lines",lineWidth:1,attributes:E,uniforms:{resolution:A.prop("resolution"),viewBoxPosition:A.prop("viewBoxPosition"),viewBoxSize:A.prop("viewBoxSize"),dim1A:A.prop("dim1A"),dim2A:A.prop("dim2A"),dim1B:A.prop("dim1B"),dim2B:A.prop("dim2B"),dim1C:A.prop("dim1C"),dim2C:A.prop("dim2C"),dim1D:A.prop("dim1D"),dim2D:A.prop("dim2D"),loA:A.prop("loA"),hiA:A.prop("hiA"),loB:A.prop("loB"),hiB:A.prop("hiB"),loC:A.prop("loC"),hiC:A.prop("hiC"),loD:A.prop("loD"),hiD:A.prop("hiD"),palette:z,mask:A.prop("maskTexture"),maskHeight:A.prop("maskHeight"),colorClamp:A.prop("colorClamp")},offset:A.prop("offset"),count:A.prop("count")}),B=[0,1],F=[];return{setColorDomain:function(e){B[0]=e[0],B[1]=e[1]},render:c,readPixel:function(e,t){return A.read({x:e,y:t,width:1,height:1,data:S}),S},readPixels:function(e,t,a,o){var r=new Uint8Array(4*a*o);return A.read({x:e,y:t,width:a,height:o,data:r}),r},destroy:g,update:a}}},{"../../lib":692,glslify:392}],1012:[function(e,t){"use strict";t.exports=function(e,t,a,o){o||(o=1/0);var r,n;for(r=0;r<t.length;r++)n=t[r],n.visible&&(o=ie(o,n[a].length));for(o===1/0&&(o=0),e._length=o,r=0;r<t.length;r++)n=t[r],n.visible&&(n._length=o);return o}},{}],1013:[function(e,t){"use strict";function a(e){return!("visible"in e)||e.visible}function o(e){var t=e.range?e.range[0]:x.aggNums(Math.min,null,e.values,e._length),a=e.range?e.range[1]:x.aggNums(Math.max,null,e.values,e._length);return(isNaN(t)||!isFinite(t))&&(t=0),(isNaN(a)||!isFinite(a))&&(a=0),t===a&&(0===t?(t-=1,a+=1):(t*=.9,a*=1.1)),[t,a]}function r(e,t){return t?function(a,o){var r=t[o];return null===r||void 0===r?e(a):r}:e}function n(e,t,a,i,n){var l=o(a);return i?f.scale.ordinal().domain(i.map(r(f.format(a.tickformat),n))).range(i.map(function(a){var o=(a-l[0])/(l[1]-l[0]);return e-t+o*(2*t-e)})):f.scale.linear().domain(l).range([e-t,t])}function l(e,t){return f.scale.linear().range([t,e-t])}function s(e,t){return f.scale.linear().domain(o(e)).range([t,1-t])}function d(e){if(e.tickvals){var t=o(e);return f.scale.ordinal().domain(e.tickvals).range(e.tickvals.map(function(e){return(e-t[0])/(t[1]-t[0])}))}}function p(e){var t=e.map(function(e){return e[0]}),a=e.map(function(e){return f.rgb(e[1])}),o=function(e){return function(t){return t[e]}},r=["r","g","b"].map(function(e){return f.scale.linear().clamp(!0).domain(t).range(a.map(o(e)))});return function(e){return r.map(function(t){return t(e)})}}function u(e){return e.dimensions.some(function(e){return e.brush.filterSpecified})}function g(e,t,r){var i=T(t),n=i.trace,l=i.lineColor,s=n.line,d=s.reversescale?_.flipScale(i.cscale):i.cscale,c=n.domain,u=n.dimensions,g=e.width,h=n.labelfont,m=n.tickfont,y=n.rangefont,b=x.extendDeepNoArrays({},s,{color:l.map(f.scale.linear().domain(o({values:l,range:[s.cmin,s.cmax],_length:n._length}))),blockLineCount:A.blockLineCount,canvasOverdrag:A.overdrag*A.canvasPixelRatio}),v=ea(g*(c.x[1]-c.x[0])),w=ea(e.height*(c.y[1]-c.y[0])),k=e.margin||{l:80,r:80,t:100,b:80},S=v,C=w;return{key:r,colCount:u.filter(a).length,dimensions:u,tickDistance:A.tickDistance,unitToColor:p(d),lines:b,labelFont:h,tickFont:m,rangeFont:y,layoutWidth:g,layoutHeight:e.height,domain:c,translateX:c.x[0]*g,translateY:e.height-c.y[1]*e.height,pad:k,canvasWidth:S*A.canvasPixelRatio+2*b.canvasOverdrag,canvasHeight:C*A.canvasPixelRatio,width:S,height:C,canvasPixelRatio:A.canvasPixelRatio}}function h(e,t,o){var r=o.width,p=o.height,g=o.dimensions,h=o.canvasPixelRatio,m=function(e){return r*e/va(1,o.colCount-1)},y=A.verticalPadding/p,b=l(p,A.verticalPadding),_={key:o.key,xScale:m,model:o,inBrushDrag:!1},v={};return _.dimensions=g.filter(a).map(function(a,r){function i(e,t){return{val:e,text:I[t]}}function l(e,t){return e.val-t.val}var g=s(a,y),w=v[a.label];v[a.label]=(w||0)+1;var T=a.label+(w?"__"+w:""),S=a.constraintrange,C=S&&S.length;C&&!Array.isArray(S[0])&&(S=[S]);var L=C?S.map(function(e){return e.map(g)}):[[0,1]],E=a.values;E.length>a._length&&(E=E.slice(0,a._length));var z=a.tickvals,I;if(Array.isArray(z)&&z.length){I=a.ticktext,Array.isArray(I)&&I.length?I.length>z.length?I=I.slice(0,z.length):z.length>I.length&&(z=z.slice(0,I.length)):I=z.map(f.format(a.tickformat));for(var D=1;D<z.length;D++)if(z[D]<z[D-1]){for(var P=z.map(i).sort(l),O=0;O<z.length;O++)z[O]=P[O].val,I[O]=P[O].text;break}}else z=void 0;return{key:T,label:a.label,tickFormat:a.tickformat,tickvals:z,ticktext:I,ordinal:!!z,multiselect:a.multiselect,xIndex:r,crossfilterDimensionIndex:r,visibleIndex:a._index,height:p,values:E,paddedUnitValues:E.map(g),unitTickvals:z&&z.map(g),xScale:m,x:m(r),canvasX:m(r)*h,unitToPaddedPx:b,domainScale:n(p,A.verticalPadding,a,z,I),ordinalScale:d(a),parent:_,model:o,brush:c.makeBrush(e,C,L,function(){e.linePickActive(!1)},function(){var t=_;t.focusLayer&&t.focusLayer.render(t.panels,!0);var a=u(t);!e.contextShown()&&a?(t.contextLayer&&t.contextLayer.render(t.panels,!0),e.contextShown(!0)):e.contextShown()&&!a&&(t.contextLayer&&t.contextLayer.render(t.panels,!0,!0),e.contextShown(!1))},function(o){var r=_;if(r.focusLayer.render(r.panels,!0),r.pickLayer&&r.pickLayer.render(r.panels,!0),e.linePickActive(!0),t&&t.filterChanged){var i=g.invert,n=o.map(function(e){return e.map(i).sort(x.sorterAsc)}).sort(function(e,t){return e[0]-t[0]});t.filterChanged(r.key,a._index,n)}})}}),_}function m(e){e.classed(A.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default").style("user-select","none")}function y(){var e=!0,t=!1;return{linePickActive:function(t){return arguments.length?e=!!t:e},contextShown:function(e){return arguments.length?t=!!e:t}}}var f=e("d3"),x=e("../../lib"),b=e("../../components/drawing"),_=e("../../components/colorscale"),v=e("../../lib/gup"),w=v.keyFun,k=v.repeat,T=v.unwrap,A=e("./constants"),c=e("./axisbrush"),S=e("./lines");t.exports=function(e,t,a,o,r,i){function n(e,t){for(var a=t.panels||(t.panels=[]),o=e.data(),r=o.length-1,i=0;i<r;i++){var n=a[i]||(a[i]={}),l=o[i],s=o[i+1];n.dim1=l,n.dim2=s,n.canvasX=l.canvasX,n.panelSizeX=s.canvasX-l.canvasX,n.panelSizeY=t.model.canvasHeight,n.y=0,n.canvasY=0}}function l(e,t){if(e.ordinal)return"";var a=e.domainScale.domain();return f.format(e.tickFormat)(a[t?a.length-1:0])}var s=y(),p=o.filter(function(e){return T(e).trace.visible}).map(g.bind(0,r)).map(h.bind(0,s,i));a.each(function(e,t){return x.extendFlat(e,p[t])});var d=a.selectAll(".gl-canvas").each(function(e){e.viewModel=p[0],e.model=e.viewModel?e.viewModel.model:null}),_=null,v=d.filter(function(e){return e.pick});v.style("pointer-events","auto").on("mousemove",function(e){if(s.linePickActive()&&e.lineLayer&&i&&i.hover){var t=f.event,a=this.width,o=this.height,r=f.mouse(this),n=r[0],l=r[1];if(0>n||0>l||n>=a||l>=o)return;var d=e.lineLayer.readPixel(n,o-1-l),c=0!==d[3],p=c?d[2]+256*(d[1]+256*d[0]):null,u={x:n,y:l,clientX:t.clientX,clientY:t.clientY,dataIndex:e.model.key,curveNumber:p};p!==_&&(c?i.hover(u):i.unhover&&i.unhover(u),_=p)}}),d.style("opacity",function(e){return e.pick?.01:1}),t.style("background","rgba(255, 255, 255, 0)");var C=t.selectAll("."+A.cn.parcoords).data(p,w);C.exit().remove(),C.enter().append("g").classed(A.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),C.attr("transform",function(e){return"translate("+e.model.translateX+","+e.model.translateY+")"});var L=C.selectAll("."+A.cn.parcoordsControlView).data(k,w);L.enter().append("g").classed(A.cn.parcoordsControlView,!0),L.attr("transform",function(e){return"translate("+e.model.pad.l+","+e.model.pad.t+")"});var E=L.selectAll("."+A.cn.yAxis).data(function(e){return e.dimensions},w);E.enter().append("g").classed(A.cn.yAxis,!0),L.each(function(e){n(E,e)}),d.each(function(e){if(e.viewModel){!e.lineLayer||i?e.lineLayer=S(this,e):e.lineLayer.update(e),(e.key||0===e.key)&&(e.viewModel[e.key]=e.lineLayer);var t=!e.context||i;e.lineLayer.render(e.viewModel.panels,t)}}),E.attr("transform",function(e){return"translate("+e.xScale(e.xIndex)+", 0)"}),E.call(f.behavior.drag().origin(function(e){return e}).on("drag",function(e){var t=e.parent;s.linePickActive(!1),e.x=va(-A.overdrag,ie(e.model.width+A.overdrag,f.event.x)),e.canvasX=e.x*e.model.canvasPixelRatio,E.sort(function(e,t){return e.x-t.x}).each(function(t,a){t.xIndex=a,t.x=e===t?t.x:t.xScale(t.xIndex),t.canvasX=t.x*t.model.canvasPixelRatio}),n(E,t),E.filter(function(t){return 0!==wa(e.xIndex-t.xIndex)}).attr("transform",function(e){return"translate("+e.xScale(e.xIndex)+", 0)"}),f.select(this).attr("transform","translate("+e.x+", 0)"),E.each(function(a,o,r){r===e.parent.key&&(t.dimensions[o]=a)}),t.contextLayer&&t.contextLayer.render(t.panels,!1,!u(t)),t.focusLayer.render&&t.focusLayer.render(t.panels)}).on("dragend",function(e){var t=e.parent;e.x=e.xScale(e.xIndex),e.canvasX=e.x*e.model.canvasPixelRatio,n(E,t),f.select(this).attr("transform",function(e){return"translate("+e.x+", 0)"}),t.contextLayer&&t.contextLayer.render(t.panels,!1,!u(t)),t.focusLayer&&t.focusLayer.render(t.panels),t.pickLayer&&t.pickLayer.render(t.panels,!0),s.linePickActive(!0),i&&i.axesMoved&&i.axesMoved(t.key,t.dimensions.map(function(e){return e.crossfilterDimensionIndex}))})),E.exit().remove();var z=E.selectAll("."+A.cn.axisOverlays).data(k,w);z.enter().append("g").classed(A.cn.axisOverlays,!0),z.selectAll("."+A.cn.axis).remove();var I=z.selectAll("."+A.cn.axis).data(k,w);I.enter().append("g").classed(A.cn.axis,!0),I.each(function(e){var t=e.model.height/e.model.tickDistance,a=e.domainScale,o=a.domain();f.select(this).call(f.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(t,e.tickFormat).tickValues(e.ordinal?o:null).tickFormat(e.ordinal?function(e){return e}:null).scale(a)),b.font(I.selectAll("text"),e.model.tickFont)}),I.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),I.selectAll("text").style("text-shadow","1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff").style("cursor","default").style("user-select","none");var D=z.selectAll("."+A.cn.axisHeading).data(k,w);D.enter().append("g").classed(A.cn.axisHeading,!0);var P=D.selectAll("."+A.cn.axisTitle).data(k,w);P.enter().append("text").classed(A.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("user-select","none").style("pointer-events","auto"),P.attr("transform","translate(0,"+-A.axisTitleOffset+")").text(function(e){return e.label}).each(function(e){b.font(f.select(this),e.model.labelFont)});var O=z.selectAll("."+A.cn.axisExtent).data(k,w);O.enter().append("g").classed(A.cn.axisExtent,!0);var R=O.selectAll("."+A.cn.axisExtentTop).data(k,w);R.enter().append("g").classed(A.cn.axisExtentTop,!0),R.attr("transform","translate(0,"+-A.axisExtentOffset+")");var M=R.selectAll("."+A.cn.axisExtentTopText).data(k,w);M.enter().append("text").classed(A.cn.axisExtentTopText,!0).call(m),M.text(function(e){return l(e,!0)}).each(function(e){b.font(f.select(this),e.model.rangeFont)});var j=O.selectAll("."+A.cn.axisExtentBottom).data(k,w);j.enter().append("g").classed(A.cn.axisExtentBottom,!0),j.attr("transform",function(e){return"translate(0,"+(e.model.height+A.axisExtentOffset)+")"});var B=j.selectAll("."+A.cn.axisExtentBottomText).data(k,w);B.enter().append("text").classed(A.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(m),B.text(function(e){return l(e)}).each(function(e){b.font(f.select(this),e.model.rangeFont)}),c.ensureAxisBrush(z)}},{"../../components/colorscale":581,"../../components/drawing":590,"../../lib":692,"../../lib/gup":690,"./axisbrush":1005,"./constants":1008,"./lines":1011,d3:148}],1014:[function(e,t){"use strict";var a=e("./parcoords"),o=e("../../lib/prepare_regl");t.exports=function(e,t){var r=e._fullLayout,i=r._toppaper,n=r._paperdiv,l=r._glcontainer,s=o(e);if(s){var c={},p={},u={},g={},h=r._size;t.forEach(function(t,a){var o=t[0].trace;u[a]=o.index;var r=g[a]=o._fullInput.index;c[a]=e.data[r].dimensions,p[a]=e.data[r].dimensions.slice()});var m=function(t,a,o){var i=p[t][a],n=o.map(function(e){return e.slice()}),l="dimensions["+a+"].constraintrange",s=r._tracePreGUI[e._fullData[u[t]]._fullInput.uid];if(void 0===s[l]){var d=i.constraintrange;s[l]=d||null}var c=e._fullData[u[t]].dimensions[a];n.length?(1===n.length&&(n=n[0]),i.constraintrange=n,c.constraintrange=n.slice(),n=[n]):(delete i.constraintrange,delete c.constraintrange,n=null);var h={};h[l]=n,e.emit("plotly_restyle",[h,[g[t]]])},y=function(t){e.emit("plotly_hover",t)},f=function(t){e.emit("plotly_unhover",t)},x=function(t,a){function o(e){return!("visible"in e)||e.visible}function r(e,t,a){var o=t.indexOf(a),r=e.indexOf(o);return-1===r&&(r+=t.length),r}var i=function(e){return function(t,o){var i=r(a,e,t),n=r(a,e,o);return i-n}}(p[t].filter(o));c[t].sort(i),p[t].filter(function(e){return!o(e)}).sort(function(e){return p[t].indexOf(e)}).forEach(function(e){c[t].splice(c[t].indexOf(e),1),c[t].splice(p[t].indexOf(e),0,e)}),e.emit("plotly_restyle",[{dimensions:[c[t]]},[g[t]]])};a(n,i,l,t,{width:h.w,height:h.h,margin:{t:h.t,r:h.r,b:h.b,l:h.l}},{filterChanged:m,hover:y,unhover:f,axesMoved:x})}}},{"../../lib/prepare_regl":705,"./parcoords":1013}],1015:[function(e,t){"use strict";var a=e("../../components/color/attributes"),o=e("../../plots/font_attributes"),r=e("../../plots/attributes"),i=e("../../components/fx/hovertemplate_attributes"),n=e("../../plots/domain").attributes,l=e("../../lib/extend").extendFlat,s=o({editType:"calc",arrayOk:!0,colorEditType:"plot"});t.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:a.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:l({},r.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:i({},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},textfont:l({},s,{}),insidetextfont:l({},s,{}),outsidetextfont:l({},s,{}),title:{text:{valType:"string",dflt:"",editType:"calc"},font:l({},s,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"},editType:"calc"},domain:n({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:l({},s,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":568,"../../components/fx/hovertemplate_attributes":607,"../../lib/extend":682,"../../plots/attributes":737,"../../plots/domain":766,"../../plots/font_attributes":767}],1016:[function(e,t,a){"use strict";var o=e("../../registry"),r=e("../../plots/get_data").getModuleCalcData;a.name="pie",a.plot=function(e){var t=o.getModule("pie"),a=r(e.calcdata,t)[0];a.length&&t.plot(e,a)},a.clean=function(e,t,a,o){var r=o._has&&o._has("pie"),i=t._has&&t._has("pie");r&&!i&&o._pielayer.selectAll("g.trace").remove()}},{"../../plots/get_data":777,"../../registry":823}],1017:[function(e,t,a){"use strict";function o(e){var t=JSON.stringify(e),a=c[t],o;if(!a){for(a=e.slice(),o=0;o<e.length;o++)a.push(l(e[o]).lighten(20).toHexString());for(o=0;o<e.length;o++)a.push(l(e[o]).darken(20).toHexString());c[t]=a}return a}var r=e("fast-isnumeric"),n=e("../../lib").isArrayOrTypedArray,l=e("tinycolor2"),s=e("../../components/color"),d=e("./helpers");a.calc=function(e,t){function a(e,t){return!!e&&(e=l(e),!!e.isValid())&&(e=s.addOpacity(e,e.getAlpha()),m[t]||(m[t]=e),e)}var o=t.values,c=n(o)&&o.length,p=t.labels,u=t.marker.colors||[],g=[],h=e._fullLayout,m=h._piecolormap,y={},f=0,x=h.hiddenlabels||[],b,_,w,k,T;if(t.dlabel)for(p=Array(o.length),b=0;b<o.length;b++)p[b]=t.label0+b*t.dlabel+"";var A=(c?o:p).length;for(b=0;b<A;b++){if(c){if(_=o[b],!r(_))continue;if(_=+_,0>_)continue}else _=1;w=p[b],(void 0===w||""===w)&&(w=b),w+="";var S=y[w];void 0===S?(y[w]=g.length,k=-1!==x.indexOf(w),!k&&(f+=_),g.push({v:_,label:w,color:a(u[b],w),i:b,pts:[b],hidden:k})):(T=g[S],T.v+=_,T.pts.push(b),!T.hidden&&(f+=_),!1===T.color&&u[b]&&(T.color=a(u[b],w)))}if(t.sort&&g.sort(function(e,t){return t.v-e.v}),g[0]&&(g[0].vTotal=f),t.textinfo&&"none"!==t.textinfo){var C=-1!==t.textinfo.indexOf("label"),L=-1!==t.textinfo.indexOf("text"),E=-1!==t.textinfo.indexOf("value"),z=-1!==t.textinfo.indexOf("percent"),I=h.separators,D;for(b=0;b<g.length;b++){if(T=g[b],D=C?[T.label]:[],L){var P=d.getFirstFilled(t.text,T.pts);P&&D.push(P)}E&&D.push(d.formatPieValue(T.v,I)),z&&D.push(d.formatPiePercent(T.v/f,I)),T.text=D.join("<br>")}}return g},a.crossTraceCalc=function(e){var t=e._fullLayout,a=e.calcdata,r=t.piecolorway,n=t._piecolormap;t.extendpiecolors&&(r=o(r));var l=0,s,d,c,p;for(s=0;s<a.length;s++)if(c=a[s],"pie"===c[0].trace.type)for(d=0;d<c.length;d++)p=c[d],!1===p.color&&(n[p.label]?p.color=n[p.label]:(n[p.label]=p.color=r[l%r.length],l++))};var c={}},{"../../components/color":569,"../../lib":692,"./helpers":1020,"fast-isnumeric":214,tinycolor2:513}],1018:[function(e,t){"use strict";var a=e("../../lib"),o=e("./attributes"),r=e("../../plots/domain").defaults;t.exports=function(e,t,i,n){function l(r,i){return a.coerce(e,t,o,r,i)}var s=a.coerceFont,d=l("values"),c=a.isArrayOrTypedArray(d),p=l("labels"),u;if(Array.isArray(p)?(u=p.length,c&&(u=ie(u,d.length))):c&&(u=d.length,l("label0"),l("dlabel")),!u)return void(t.visible=!1);t._length=u;var g=l("marker.line.width");g&&l("marker.line.color"),l("marker.colors"),l("scalegroup");var h=l("text"),m=l("textinfo",Array.isArray(h)?"text+percent":"percent");if(l("hovertext"),l("hovertemplate"),m&&"none"!==m){var y=l("textposition"),f=Array.isArray(y)||"auto"===y,x=f||"inside"===y,b=f||"outside"===y;if(x||b){var _=s(l,"textfont",n.font);if(x){var v=a.extendFlat({},_),w=e.textfont&&e.textfont.color;!w&&delete v.color,s(l,"insidetextfont",v)}b&&s(l,"outsidetextfont",_)}}r(t,n,l);var k=l("hole"),T=l("title.text");if(T){var A=l("title.position",k?"middle center":"top center");k||"middle center"!==A||(t.title.position="top center"),s(l,"title.font",n.font)}l("sort"),l("direction"),l("rotation"),l("pull")}},{"../../lib":692,"../../plots/domain":766,"./attributes":1015}],1019:[function(e,t){"use strict";var a=e("../../components/fx/helpers").appendArrayMultiPointValues;t.exports=function(e,t){var o={curveNumber:t.index,pointNumbers:e.pts,data:t._input,fullData:t,label:e.label,color:e.color,value:e.v,percent:e.percent,text:e.text,v:e.v};return 1===e.pts.length&&(o.pointNumber=o.i=e.pts[0]),a(o,t,e.pts),o}},{"../../components/fx/helpers":604}],1020:[function(e,t,a){"use strict";var o=e("../../lib");a.formatPiePercent=function(e,t){var a=(100*e).toPrecision(3);return-1!==a.lastIndexOf(".")&&(a=a.replace(/[.]?0+$/,"")),o.numSeparate(a,t)+"%"},a.formatPieValue=function(e,t){var a=e.toPrecision(10);return-1!==a.lastIndexOf(".")&&(a=a.replace(/[.]?0+$/,"")),o.numSeparate(a,t)},a.getFirstFilled=function(e,t){if(Array.isArray(e))for(var a=0,o;a<t.length;a++)if(o=e[t[a]],o||0===o)return o},a.castOption=function(e,t){if(Array.isArray(e))return a.getFirstFilled(e,t);return e?e:void 0}},{"../../lib":692}],1021:[function(e,t){"use strict";var a={attributes:e("./attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),layoutAttributes:e("./layout_attributes")},o=e("./calc");a.calc=o.calc,a.crossTraceCalc=o.crossTraceCalc,a.plot=e("./plot"),a.style=e("./style"),a.styleOne=e("./style_one"),a.moduleType="trace",a.name="pie",a.basePlotModule=e("./base_plot"),a.categories=["pie","showLegend"],a.meta={},t.exports=a},{"./attributes":1015,"./base_plot":1016,"./calc":1017,"./defaults":1018,"./layout_attributes":1022,"./layout_defaults":1023,"./plot":1024,"./style":1025,"./style_one":1026}],1022:[function(e,t){"use strict";t.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1023:[function(e,t){"use strict";var a=e("../../lib"),o=e("./layout_attributes");t.exports=function(e,t){function r(r,i){return a.coerce(e,t,o,r,i)}r("hiddenlabels"),r("piecolorway",t.colorway),r("extendpiecolors")}},{"../../lib":692,"./layout_attributes":1022}],1024:[function(e,t){"use strict";function a(e,t,a){var o=w.castOption(e.outsidetextfont.color,t.pts)||w.castOption(e.textfont.color,t.pts)||a.color,r=w.castOption(e.outsidetextfont.family,t.pts)||w.castOption(e.textfont.family,t.pts)||a.family,i=w.castOption(e.outsidetextfont.size,t.pts)||w.castOption(e.textfont.size,t.pts)||a.size;return{color:o,family:r,size:i}}function o(e,t,a){var o=w.castOption(e.insidetextfont.color,t.pts);!o&&e._input.textfont&&(o=w.castOption(e._input.textfont.color,t.pts));var r=w.castOption(e.insidetextfont.family,t.pts)||w.castOption(e.textfont.family,t.pts)||a.family,i=w.castOption(e.insidetextfont.size,t.pts)||w.castOption(e.textfont.size,t.pts)||a.size;return{color:o||x.contrast(t.color),family:r,size:i}}function r(e,t){for(var a=0,o,r;a<e.length;a++)if(o=e[a][0],r=o.trace,r.title.text){var n=b.tester.append("text").attr("data-notex",1).text(r.title.text).call(b.font,r.title.font).call(v.convertToTspans,t),l=b.bBox(n.node(),!0);o.titleBox={width:l.width,height:l.height},n.remove()}}function i(e,t,a){var o=re(e.width*e.width+e.height*e.height),r=e.width/e.height,i=Sa*ie(t.v/a.vTotal,.5),l=1-a.trace.hole,s=n(t,a),d={scale:2*(s*a.r)/o,rCenter:1-s,rotate:0};if(1<=d.scale)return d;var c=r+1/(2*g(i)),p=a.r*ie(1/(re(c*c+.5)+c),l/(re(r*r+l/2)+r)),u={scale:2*p/e.height,rCenter:te(p/a.r)-p*r/a.r,rotate:(180/Sa*t.midangle+720)%180-90},h=1/r,m=h+1/(2*g(i)),y=a.r*ie(1/(re(m*m+.5)+m),l/(re(h*h+l/2)+h)),f={scale:2*y/e.width,rCenter:te(y/a.r)-y/r/a.r,rotate:(180/Sa*t.midangle+810)%180-90},x=f.scale>u.scale?f:u;return 1>d.scale&&x.scale>d.scale?x:d}function n(e,t){if(e.v===t.vTotal&&!t.trace.hole)return 1;var a=Sa*ie(e.v/t.vTotal,.5);return ie(1/(1+1/M(a)),(1-t.trace.hole)/2)}function l(e,t){var a=t.pxmid[0],o=t.pxmid[1],r=e.width/2,i=e.height/2;return 0>a&&(r*=-1),0>o&&(i*=-1),{scale:1,rCenter:1,rotate:0,x:r+wa(i)*(0<r?1:-1)/2,y:i/(1+a*a/(o*o)),outside:!0}}function s(e){var t=re(e.titleBox.width*e.titleBox.width+e.titleBox.height*e.titleBox.height);return{x:e.cx,y:e.cy,scale:2*(e.trace.hole*e.r)/t,tx:0,ty:-e.titleBox.height/2+e.trace.title.font.size}}function d(e,t){var a=1,o=1,r=e.trace,i={x:e.cx,y:e.cy},n={tx:0,ty:0},l,s;return n.ty+=r.title.font.size,s=p(r),-1===r.title.position.indexOf("top")?-1!==r.title.position.indexOf("bottom")&&(i.y+=(1+s)*e.r):(i.y-=(1+s)*e.r,n.ty-=e.titleBox.height),-1===r.title.position.indexOf("left")?-1===r.title.position.indexOf("center")?-1!==r.title.position.indexOf("right")&&(l=t.w*(r.domain.x[1]-r.domain.x[0])/2+e.r,i.x+=(1+s)*e.r,n.tx-=e.titleBox.width/2):l=t.w*(r.domain.x[1]-r.domain.x[0]):(l=t.w*(r.domain.x[1]-r.domain.x[0])/2+e.r,i.x-=(1+s)*e.r,n.tx+=e.titleBox.width/2),a=l/e.titleBox.width,o=c(e,t)/e.titleBox.height,{x:i.x,y:i.y,scale:ie(a,o),tx:n.tx,ty:n.ty}}function c(e,t){var a=e.trace,o=t.h*(a.domain.y[1]-a.domain.y[0]);return ie(e.titleBox.height,o/2)}function p(e){var t=e.pull,a;if(Array.isArray(t))for(t=0,a=0;a<e.pull.length;a++)e.pull[a]>t&&(t=e.pull[a]);return t}function u(e,t){function a(e,t){return e.pxmid[1]-t.pxmid[1]}function o(e,t){return t.pxmid[1]-e.pxmid[1]}function r(e,a){a||(a={});var o=a.labelExtraY+(l?a.yLabelMax:a.yLabelMin),r=l?e.yLabelMin:e.yLabelMax,n=l?e.yLabelMax:e.yLabelMin,s=e.cyFinal+c(e.px0[1],e.px1[1]),g=o-r,h,y,f,x,b,_;if(0<g*u&&(e.labelExtraY=g),!!Array.isArray(t.pull))for(y=0;y<m.length;y++)(f=m[y],!(f===e||(w.castOption(t.pull,e.pts)||0)>=(w.castOption(t.pull,f.pts)||0)))&&(0<(e.pxmid[1]-f.pxmid[1])*u?(x=f.cyFinal+c(f.px0[1],f.px1[1]),g=x-r-e.labelExtraY,0<g*u&&(e.labelExtraY+=g)):0<(n+e.labelExtraY-s)*u&&(h=3*p*wa(y-m.indexOf(e)),b=f.cxFinal+d(f.px0[0],f.px1[0]),_=b+h-(e.cxFinal+e.pxmid[0])-e.labelExtraX,0<_*p&&(e.labelExtraX+=_)))}var n,l,s,d,c,p,u,g,h,m,y,f,x;for(l=0;2>l;l++)for(s=l?a:o,c=l?va:ie,u=l?1:-1,n=0;2>n;n++){for(d=n?va:ie,p=n?1:-1,g=e[l][n],g.sort(s),h=e[1-l][n],m=h.concat(g),f=[],y=0;y<g.length;y++)void 0!==g[y].yLabelMid&&f.push(g[y]);for(x=!1,y=0;l&&y<h.length;y++)if(void 0!==h[y].yLabelMid){x=h[y];break}for(y=0;y<f.length;y++){var b=y&&f[y-1];x&&!y&&(b=x),r(f[y],b)}}}function h(e,t){var a=[],o,r,n,l,s,d,u,g,h;for(n=0;n<e.length;n++)s=e[n][0],d=s.trace,o=t.w*(d.domain.x[1]-d.domain.x[0]),r=t.h*(d.domain.y[1]-d.domain.y[0]),d.title.text&&"middle center"!==d.title.position&&(r-=c(s,t)),u=p(d),s.r=ie(o,r)/(2+2*u),s.cx=t.l+t.w*(d.domain.x[1]+d.domain.x[0])/2,s.cy=t.t+t.h*(1-d.domain.y[0])-r/2,d.title.text&&-1!==d.title.position.indexOf("bottom")&&(s.cy-=c(s,t)),d.scalegroup&&-1===a.indexOf(d.scalegroup)&&a.push(d.scalegroup);for(l=0;l<a.length;l++){for(h=1/0,g=a[l],n=0;n<e.length;n++)s=e[n][0],s.trace.scalegroup===g&&(h=ie(h,s.r*s.r/s.vTotal));for(n=0;n<e.length;n++)s=e[n][0],s.trace.scalegroup===g&&(s.r=re(h*s.vTotal))}}function m(e){function t(e){return[a.r*M(e),-a.r*te(e)]}var a=e[0],o=a.trace,r=o.rotation*Sa/180,n=2*Sa/a.vTotal,l="px0",s="px1",d,c,p;if("counterclockwise"===o.direction){for(d=0;d<e.length&&!!e[d].hidden;d++);if(d===e.length)return;r+=n*e[d].v,n*=-1,l="px1",s="px0"}for(p=t(r),d=0;d<e.length;d++)c=e[d],c.hidden||(c[l]=p,r+=n*c.v/2,c.pxmid=t(r),c.midangle=r,r+=n*c.v/2,p=t(r),c[s]=p,c.largeArc=c.v>a.vTotal/2?1:0)}var y=e("d3"),f=e("../../components/fx"),x=e("../../components/color"),b=e("../../components/drawing"),_=e("../../lib"),v=e("../../lib/svg_text_utils"),w=e("./helpers"),k=e("./event_data");t.exports=function(e,t){var c=e._fullLayout;r(t,e),h(t,c._size);var p=_.makeTraceGroups(c._pielayer,t,"trace").each(function(t){var r=y.select(this),p=t[0],g=p.trace;m(t),r.attr("stroke-linejoin","round"),r.each(function(){var r=y.select(this).selectAll("g.slice").data(t);r.enter().append("g").classed("slice",!0),r.exit().remove();var h=[[[],[]],[[],[]]],m=!1;r.each(function(t){function r(){var a=e._fullLayout,o=e._fullData[g.index];if(!(e._dragging||!1===a.hovermode)){var r=o.hoverinfo;if(Array.isArray(r)&&(r=f.castHoverinfo({hoverinfo:[w.castOption(r,t.pts)],_module:g._module},a,0)),"all"===r&&(r="label+text+value+percent+name"),o.hovertemplate||"none"!==r&&"skip"!==r&&r){var i=n(t,p),l=u+t.pxmid[0]*(1-i),s=x+t.pxmid[1]*(1-i),d=c.separators,h=[];if(r&&-1!==r.indexOf("label")&&h.push(t.label),t.text=w.castOption(o.hovertext||o.text,t.pts),r&&-1!==r.indexOf("text")){var m=t.text;m&&h.push(m)}t.value=t.v,t.valueLabel=w.formatPieValue(t.v,d),r&&-1!==r.indexOf("value")&&h.push(t.valueLabel),t.percent=t.v/p.vTotal,t.percentLabel=w.formatPiePercent(t.percent,d),r&&-1!==r.indexOf("percent")&&h.push(t.percentLabel);var b=g.hoverlabel,_=b.font;f.loneHover({x0:l-i*p.r,x1:l+i*p.r,y:s,text:h.join("<br>"),name:o.hovertemplate||-1!==r.indexOf("name")?o.name:void 0,idealAlign:0>t.pxmid[0]?"left":"right",color:w.castOption(b.bgcolor,t.pts)||t.color,borderColor:w.castOption(b.bordercolor,t.pts),fontFamily:w.castOption(_.family,t.pts),fontSize:w.castOption(_.size,t.pts),fontColor:w.castOption(_.color,t.pts),trace:o,hovertemplate:w.castOption(o.hovertemplate,t.pts),hovertemplateLabels:t,eventData:[k(t,o)]},{container:a._hoverlayer.node(),outerContainer:a._paper.node(),gd:e}),S=!0}e.emit("plotly_hover",{points:[k(t,o)],event:y.event}),C=!0}}function s(a){var o=e._fullLayout,r=e._fullData[g.index];C&&(a.originalEvent=y.event,e.emit("plotly_unhover",{points:[k(t,r)],event:y.event}),C=!1),S&&(f.loneUnhover(o._hoverlayer.node()),S=!1)}function d(e,a,o,r){return"a"+r*p.r+","+r*p.r+" 0 "+t.largeArc+(o?" 1 ":" 0 ")+r*(a[0]-e[0])+","+r*(a[1]-e[1])}if(t.hidden)return void y.select(this).selectAll("path,g").remove();t.pointNumber=t.i,t.curveNumber=g.index,h[0>t.pxmid[1]?0:1][0>t.pxmid[0]?0:1].push(t);var u=p.cx,x=p.cy,T=y.select(this),A=T.selectAll("path.surface").data([t]),S=!1,C=!1;if(A.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),T.select("path.textline").remove(),T.on("mouseover",r).on("mouseout",s).on("click",function(){var a=e._fullLayout,o=e._fullData[g.index];e._dragging||!1===a.hovermode||(e._hoverdata=[k(t,o)],f.click(e,y.event))}),g.pull){var L=+w.castOption(g.pull,t.pts)||0;0<L&&(u+=L*t.pxmid[0],x+=L*t.pxmid[1])}t.cxFinal=u,t.cyFinal=x;var E=g.hole;if(t.v===p.vTotal){var z="M"+(u+t.px0[0])+","+(x+t.px0[1])+d(t.px0,t.pxmid,!0,1)+d(t.pxmid,t.px0,!0,1)+"Z";E?A.attr("d","M"+(u+E*t.px0[0])+","+(x+E*t.px0[1])+d(t.px0,t.pxmid,!1,E)+d(t.pxmid,t.px0,!1,E)+"Z"+z):A.attr("d",z)}else{var I=d(t.px0,t.px1,!0,1);if(E){var D=1-E;A.attr("d","M"+(u+E*t.px1[0])+","+(x+E*t.px1[1])+d(t.px1,t.px0,!1,E)+"l"+D*t.px0[0]+","+D*t.px0[1]+I+"Z")}else A.attr("d","M"+u+","+x+"l"+t.px0[0]+","+t.px0[1]+I+"Z")}var P=w.castOption(g.textposition,t.pts),O=T.selectAll("g.slicetext").data(t.text&&"none"!==P?[0]:[]);O.enter().append("g").classed("slicetext",!0),O.exit().remove(),O.each(function(){var r=_.ensureSingle(y.select(this),"text","",function(e){e.attr("data-notex",1)});r.text(t.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(b.font,"outside"===P?a(g,t,e._fullLayout.font):o(g,t,e._fullLayout.font)).call(v.convertToTspans,e);var n=b.bBox(r.node()),s;"outside"===P?s=l(n,t):(s=i(n,t,p),"auto"===P&&1>s.scale&&(r.call(b.font,g.outsidetextfont),(g.outsidetextfont.family!==g.insidetextfont.family||g.outsidetextfont.size!==g.insidetextfont.size)&&(n=b.bBox(r.node())),s=l(n,t)));var d=u+t.pxmid[0]*s.rCenter+(s.x||0),c=x+t.pxmid[1]*s.rCenter+(s.y||0);s.outside&&(t.yLabelMin=c-n.height/2,t.yLabelMid=c,t.yLabelMax=c+n.height/2,t.labelExtraX=0,t.labelExtraY=0,m=!0),r.attr("transform","translate("+d+","+c+")"+(1>s.scale?"scale("+s.scale+")":"")+(s.rotate?"rotate("+s.rotate+")":"")+"translate("+-(n.left+n.right)/2+","+-(n.top+n.bottom)/2+")")})});var T=y.select(this).selectAll("g.titletext").data(g.title.text?[0]:[]);T.enter().append("g").classed("titletext",!0),T.exit().remove(),T.each(function(){var t=_.ensureSingle(y.select(this),"text","",function(e){e.attr("data-notex",1)});t.text(g.title.text).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(b.font,g.title.font).call(v.convertToTspans,e);var a;a="middle center"===g.title.position?s(p):d(p,c._size),t.attr("transform","translate("+a.x+","+a.y+")"+(1>a.scale?"scale("+a.scale+")":"")+"translate("+a.tx+","+a.ty+")")}),m&&u(h,g),r.each(function(e){if(e.labelExtraX||e.labelExtraY){var t=y.select(this),a=t.select("g.slicetext text");a.attr("transform","translate("+e.labelExtraX+","+e.labelExtraY+")"+a.attr("transform"));var o=e.cxFinal+e.pxmid[0],r=e.cyFinal+e.pxmid[1],i="M"+o+","+r,n=(e.yLabelMax-e.yLabelMin)*(0>e.pxmid[0]?-1:1)/4;if(e.labelExtraX){var l=e.labelExtraX*e.pxmid[1]/e.pxmid[0],s=e.yLabelMid+e.labelExtraY-(e.cyFinal+e.pxmid[1]);i+=wa(l)>wa(s)?"l"+s*e.pxmid[0]/e.pxmid[1]+","+s+"H"+(o+e.labelExtraX+n):"l"+e.labelExtraX+","+l+"v"+(s-l)+"h"+n}else i+="V"+(e.yLabelMid+e.labelExtraY)+"h"+n;t.append("path").classed("textline",!0).call(x.stroke,g.outsidetextfont.color).attr({"stroke-width":ie(2,g.outsidetextfont.size/8),d:i,fill:"none"})}})})});setTimeout(function(){p.selectAll("tspan").each(function(){var e=y.select(this);e.attr("dy")&&e.attr("dy",e.attr("dy"))})},0)}},{"../../components/color":569,"../../components/drawing":590,"../../components/fx":608,"../../lib":692,"../../lib/svg_text_utils":716,"./event_data":1019,"./helpers":1020,d3:148}],1025:[function(e,t){"use strict";var a=e("d3"),o=e("./style_one");t.exports=function(e){e._fullLayout._pielayer.selectAll(".trace").each(function(e){var t=e[0],r=t.trace,i=a.select(this);i.style({opacity:r.opacity}),i.selectAll("path.surface").each(function(e){a.select(this).call(o,e,r)})})}},{"./style_one":1026,d3:148}],1026:[function(e,t){"use strict";var a=e("../../components/color"),o=e("./helpers").castOption;t.exports=function(e,t,r){var i=r.marker.line,n=o(i.color,t.pts)||a.defaultLine,l=o(i.width,t.pts)||0;e.style({"stroke-width":l}).call(a.fill,t.color).call(a.stroke,n)}},{"../../components/color":569,"./helpers":1020}],1027:[function(e,t){"use strict";var a=e("../scatter/attributes");t.exports={x:a.x,y:a.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:a.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":1040}],1028:[function(e,t){"use strict";function a(e,t){this.scene=e,this.uid=t,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=o(e.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var o=e("gl-pointcloud2d"),r=e("../../lib/str2rgbarray"),n=e("../../plots/cartesian/autorange").findExtremes,l=e("../scatter/get_trace_color"),s=a.prototype;s.handlePick=function(e){var t=this.idToIndex[e.pointId];return{trace:this,dataCoord:e.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*t],this.pickXYData[2*t+1]]:[this.pickXData[t],this.pickYData[t]],textLabel:Array.isArray(this.textLabels)?this.textLabels[t]:this.textLabels,color:this.color,name:this.name,pointIndex:t,hoverinfo:this.hoverinfo}},s.update=function(e){this.index=e.index,this.textLabels=e.text,this.name=e.name,this.hoverinfo=e.hoverinfo,this.bounds=[1/0,1/0,-Infinity,-Infinity],this.updateFast(e),this.color=l(e,{})},s.updateFast=function(e){var t=this.xData=this.pickXData=e.x,a=this.yData=this.pickYData=e.y,o=this.pickXYData=e.xy,l=e.xbounds&&e.ybounds,s=e.indices,d=this.bounds,c,p,u,g,h,m;if(o){if(u=o,c=o.length>>>1,l)d[0]=e.xbounds[0],d[2]=e.xbounds[1],d[1]=e.ybounds[0],d[3]=e.ybounds[1];else for(m=0;m<c;m++)g=u[2*m],h=u[2*m+1],g<d[0]&&(d[0]=g),g>d[2]&&(d[2]=g),h<d[1]&&(d[1]=h),h>d[3]&&(d[3]=h);if(s)p=s;else for(p=new Int32Array(c),m=0;m<c;m++)p[m]=m}else for(c=t.length,u=new Float32Array(2*c),p=new Int32Array(c),m=0;m<c;m++)g=t[m],h=a[m],p[m]=m,u[2*m]=g,u[2*m+1]=h,g<d[0]&&(d[0]=g),g>d[2]&&(d[2]=g),h<d[1]&&(d[1]=h),h>d[3]&&(d[3]=h);this.idToIndex=p,this.pointcloudOptions.idToIndex=p,this.pointcloudOptions.positions=u;var y=r(e.marker.color),f=r(e.marker.border.color),x=e.opacity*e.marker.opacity;y[3]*=x,this.pointcloudOptions.color=y;var b=e.marker.blend;if(null===b){b=t.length<100||a.length<100}this.pointcloudOptions.blend=b,f[3]*=x,this.pointcloudOptions.borderColor=f;var _=e.marker.sizemin,v=va(e.marker.sizemax,e.marker.sizemin);this.pointcloudOptions.sizeMin=_,this.pointcloudOptions.sizeMax=v,this.pointcloudOptions.areaRatio=e.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var w=this.scene.xaxis,k=this.scene.yaxis,T=v/2||.5;e._extremes[w._id]=n(w,[d[0],d[2]],{ppad:T}),e._extremes[k._id]=n(k,[d[1],d[3]],{ppad:T})},s.dispose=function(){this.pointcloud.dispose()},t.exports=function(e,t){var o=new a(e,t.uid);return o.update(t),o}},{"../../lib/str2rgbarray":715,"../../plots/cartesian/autorange":739,"../scatter/get_trace_color":1050,"gl-pointcloud2d":279}],1029:[function(e,t){"use strict";var a=e("../../lib"),o=e("./attributes");t.exports=function(e,t,r){function i(r,i){return a.coerce(e,t,o,r,i)}i("x"),i("y"),i("xbounds"),i("ybounds"),e.xy&&e.xy instanceof Float32Array&&(t.xy=e.xy),e.indices&&e.indices instanceof Int32Array&&(t.indices=e.indices),i("text"),i("marker.color",r),i("marker.opacity"),i("marker.blend"),i("marker.sizemin"),i("marker.sizemax"),i("marker.border.color",r),i("marker.border.arearatio"),t._length=null}},{"../../lib":692,"./attributes":1027}],1030:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.calc=e("../scatter3d/calc"),a.plot=e("./convert"),a.moduleType="trace",a.name="pointcloud",a.basePlotModule=e("../../plots/gl2d"),a.categories=["gl","gl2d","showLegend"],a.meta={},t.exports=a},{"../../plots/gl2d":780,"../scatter3d/calc":1068,"./attributes":1027,"./convert":1028,"./defaults":1029}],1031:[function(e,t){"use strict";var a=e("../../plots/font_attributes"),o=e("../../plots/attributes"),r=e("../../components/color/attributes"),i=e("../../components/fx/attributes"),n=e("../../plots/domain").attributes,l=e("../../components/fx/hovertemplate_attributes"),s=e("../../lib/extend").extendFlat,d=e("../../plot_api/edit_types").overrideAll,c=t.exports=d({hoverinfo:s({},o.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:i.hoverlabel,domain:n({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s"},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:a({}),node:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},line:{color:{valType:"color",dflt:r.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:i.hoverlabel,hovertemplate:l({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},line:{color:{valType:"color",dflt:r.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:i.hoverlabel,hovertemplate:l({},{keys:["value","label"]})}},"calc","nested");c.transforms=void 0},{"../../components/color/attributes":568,"../../components/fx/attributes":599,"../../components/fx/hovertemplate_attributes":607,"../../lib/extend":682,"../../plot_api/edit_types":723,"../../plots/attributes":737,"../../plots/domain":766,"../../plots/font_attributes":767}],1032:[function(e,t,a){"use strict";var o=e("../../plot_api/edit_types").overrideAll,r=e("../../plots/get_data").getModuleCalcData,i=e("./plot"),n=e("../../components/fx/layout_attributes"),l="sankey";a.name=l,a.baseLayoutAttrOverrides=o({hoverlabel:n.hoverlabel},"plot","nested"),a.plot=function(e){var t=r(e.calcdata,l)[0];i(e,t)},a.clean=function(e,t,a,o){var r=o._has&&o._has(l),i=t._has&&t._has(l);r&&!i&&o._paperdiv.selectAll(".sankey").remove()}},{"../../components/fx/layout_attributes":609,"../../plot_api/edit_types":723,"../../plots/get_data":777,"./plot":1037}],1033:[function(e,t){"use strict";function a(e,t,a){for(var n=e.length,l=r.init2dArray(n,0),s=0;s<ie(t.length,a.length);s++)if(r.isIndex(t[s],n)&&r.isIndex(a[s],n)){if(t[s]===a[s])return!0;l[t[s]].push(a[s])}var d=o(l);return d.components.some(function(e){return 1<e.length})}var o=e("strongly-connected-components"),r=e("../../lib"),i=e("../../lib/gup").wrap;t.exports=function(e,t){return a(t.node.label,t.link.source,t.link.target)&&(r.error("Circularity is present in the Sankey data. Removing all nodes and links."),t.link.label=[],t.link.source=[],t.link.target=[],t.link.value=[],t.link.color=[],t.node.label=[],t.node.color=[]),i({link:t.link,node:t.node})}},{"../../lib":692,"../../lib/gup":690,"strongly-connected-components":506}],1034:[function(e,t){"use strict";t.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"cubic-in-out",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeCapture:"node-capture",nodeCentered:"node-entered",nodeLabelGuide:"node-label-guide",nodeLabel:"node-label",nodeLabelTextPath:"node-label-text-path"}}},{}],1035:[function(e,t){"use strict";var a=e("../../lib"),o=e("./attributes"),r=e("../../components/color"),i=e("tinycolor2"),n=e("../../plots/domain").defaults,l=e("../../components/fx/hoverlabel_defaults"),s=e("../../plot_api/plot_template");t.exports=function(e,t,d,c){function p(r,i){return a.coerce(e,t,o,r,i)}function u(e,t){return a.coerce(m,y,o.node,e,t)}function g(e,t){return a.coerce(b,_,o.link,e,t)}var h=a.extendDeep(c.hoverlabel,e.hoverlabel),m=e.node,y=s.newContainer(t,"node");u("label"),u("pad"),u("thickness"),u("line.color"),u("line.width"),u("hoverinfo",e.hoverinfo),l(m,y,u,h),u("hovertemplate");var f=c.colorway,x=function(e){return f[e%f.length]};u("color",y.label.map(function(e,t){return r.addOpacity(x(t),.8)}));var b=e.link,_=s.newContainer(t,"link");g("label"),g("source"),g("target"),g("value"),g("line.color"),g("line.width"),g("hoverinfo",e.hoverinfo),l(b,_,g,h),g("hovertemplate");var v=.333>i(c.paper_bgcolor).getLuminance()?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";g("color",a.repeat(v,_.value.length)),n(t,c,p),p("orientation"),p("valueformat"),p("valuesuffix"),p("arrangement"),a.coerceFont(p,"textfont",a.extendFlat({},c.font)),t._length=null}},{"../../components/color":569,"../../components/fx/hoverlabel_defaults":606,"../../lib":692,"../../plot_api/plot_template":730,"../../plots/domain":766,"./attributes":1031,tinycolor2:513}],1036:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.calc=e("./calc"),a.plot=e("./plot"),a.moduleType="trace",a.name="sankey",a.basePlotModule=e("./base_plot"),a.categories=["noOpacity"],a.meta={},t.exports=a},{"./attributes":1031,"./base_plot":1032,"./calc":1033,"./defaults":1035,"./plot":1037}],1037:[function(e,t){"use strict";function a(e){return""!==e}function o(e,t){return e.filter(function(e){return e.key===t.traceId})}function r(e,t){h.select(e).select("path").style("fill-opacity",t),h.select(e).select("rect").style("fill-opacity",t)}function i(e){h.select(e).select("text.name").style("fill","black")}function n(e){return function(t){return-1!==e.node.sourceLinks.indexOf(t.link)||-1!==e.node.targetLinks.indexOf(t.link)}}function l(e){return function(t){return-1!==t.node.sourceLinks.indexOf(e.link)||-1!==t.node.targetLinks.indexOf(e.link)}}function s(e,t,a){t&&a&&o(a,t).selectAll("."+x.sankeyLink).filter(n(t)).call(p.bind(0,t,a,!1))}function c(e,t,a){t&&a&&o(a,t).selectAll("."+x.sankeyLink).filter(n(t)).call(u.bind(0,t,a,!1))}function p(e,t,a,r){var i=r.datum().link.label;r.style("fill-opacity",.4),i&&o(t,e).selectAll("."+x.sankeyLink).filter(function(e){return e.link.label===i}).style("fill-opacity",.4),a&&o(t,e).selectAll("."+x.sankeyNode).filter(l(e)).call(s)}function u(e,t,a,r){var i=r.datum().link.label;r.style("fill-opacity",function(e){return e.tinyColorAlpha}),i&&o(t,e).selectAll("."+x.sankeyLink).filter(function(e){return e.link.label===i}).style("fill-opacity",function(e){return e.tinyColorAlpha}),a&&o(t,e).selectAll(x.sankeyNode).filter(l(e)).call(c)}function g(e,t){var a=e.hoverlabel||{},o=f.nestedProperty(a,t).get();return!Array.isArray(o)&&o}var h=e("d3"),d=e("./render"),m=e("../../components/fx"),y=e("../../components/color"),f=e("../../lib"),x=e("./constants").cn,b=f._;t.exports=function(e,t){var o=e._fullLayout,n=o._paper,l=o._size,f=b(e,"source:")+" ",_=b(e,"target:")+" ",v=b(e,"incoming flow count:")+" ",w=b(e,"outgoing flow count:")+" ";d(n,t,{width:l.w,height:l.h,margin:{t:l.t,r:l.r,b:l.b,l:l.l}},{linkEvents:{hover:function(t,a,o){!1===e._fullLayout.hovermode||(h.select(t).call(p.bind(0,a,o,!0)),"skip"!==a.link.trace.link.hoverinfo&&(a.link.fullData=a.link.trace,e.emit("plotly_hover",{event:h.event,points:[a.link]})))},follow:function(t,n){if(!1!==e._fullLayout.hovermode){var l=n.link.trace.link;if("none"!==l.hoverinfo&&"skip"!==l.hoverinfo){var s=e._fullLayout._paperdiv.node().getBoundingClientRect(),d=t.getBoundingClientRect(),c=d.left+d.width/2,p=d.top+d.height/2,u={valueLabel:h.format(n.valueFormat)(n.link.value)+n.valueSuffix};n.link.fullData=n.link.trace;var x=m.loneHover({x:c-s.left,y:p-s.top,name:u.valueLabel,text:[n.link.label||"",f+n.link.source.label,_+n.link.target.label].filter(a).join("<br>"),color:g(l,"bgcolor")||y.addOpacity(n.tinyColorHue,1),borderColor:g(l,"bordercolor"),fontFamily:g(l,"font.family"),fontSize:g(l,"font.size"),fontColor:g(l,"font.color"),idealAlign:h.event.x<c?"right":"left",hovertemplate:l.hovertemplate,hovertemplateLabels:u,eventData:[n.link]},{container:o._hoverlayer.node(),outerContainer:o._paper.node(),gd:e});r(x,.65),i(x)}}},unhover:function(t,a,r){!1===e._fullLayout.hovermode||(h.select(t).call(u.bind(0,a,r,!0)),"skip"!==a.link.trace.link.hoverinfo&&(a.link.fullData=a.link.trace,e.emit("plotly_unhover",{event:h.event,points:[a.link]})),m.loneUnhover(o._hoverlayer.node()))},select:function(t,a){var o=a.link;o.originalEvent=h.event,e._hoverdata=[o],m.click(e,{target:!0})}},nodeEvents:{hover:function(t,a,o){!1===e._fullLayout.hovermode||(h.select(t).call(s,a,o),"skip"!==a.node.trace.node.hoverinfo&&(a.node.fullData=a.node.trace,e.emit("plotly_hover",{event:h.event,points:[a.node]})))},follow:function(t,n){if(!1!==e._fullLayout.hovermode){var l=n.node.trace.node;if("none"!==l.hoverinfo&&"skip"!==l.hoverinfo){var s=h.select(t).select("."+x.nodeRect),d=e._fullLayout._paperdiv.node().getBoundingClientRect(),c=s.node().getBoundingClientRect(),p=c.left-2-d.left,u=c.right+2-d.left,y=c.top+c.height/4-d.top,f={valueLabel:h.format(n.valueFormat)(n.node.value)+n.valueSuffix};n.node.fullData=n.node.trace;var b=m.loneHover({x0:p,x1:u,y:y,name:h.format(n.valueFormat)(n.node.value)+n.valueSuffix,text:[n.node.label,v+n.node.targetLinks.length,w+n.node.sourceLinks.length].filter(a).join("<br>"),color:g(l,"bgcolor")||n.tinyColorHue,borderColor:g(l,"bordercolor"),fontFamily:g(l,"font.family"),fontSize:g(l,"font.size"),fontColor:g(l,"font.color"),idealAlign:"left",hovertemplate:l.hovertemplate,hovertemplateLabels:f,eventData:[n.node]},{container:o._hoverlayer.node(),outerContainer:o._paper.node(),gd:e});r(b,.85),i(b)}}},unhover:function(t,a,r){!1===e._fullLayout.hovermode||(h.select(t).call(c,a,r),"skip"!==a.node.trace.node.hoverinfo&&(a.node.fullData=a.node.trace,e.emit("plotly_unhover",{event:h.event,points:[a.node]})),m.loneUnhover(o._hoverlayer.node()))},select:function(t,a,o){var r=a.node;r.originalEvent=h.event,e._hoverdata=[r],h.select(t).call(c,a,o),m.click(e,{target:!0})}}})}},{"../../components/color":569,"../../components/fx":608,"../../lib":692,"./constants":1034,"./render":1038,d3:148}],1038:[function(e,t){"use strict";function a(e){var t=[],a;for(a=0;a<e.length;a++)e[a].originalX=e[a].x,e[a].originalY=e[a].y,-1===t.indexOf(e[a].x)&&t.push(e[a].x);for(t.sort(function(e,t){return e-t}),a=0;a<e.length;a++)e[a].originalLayerIndex=t.indexOf(e[a].originalX),e[a].originalLayer=e[a].originalLayerIndex/(t.length-1)}function o(e){e.lastDraggedX=e.x,e.lastDraggedY=e.y}function r(e){return function(t){return t.node.originalX===e.node.originalX}}function s(e){for(var t=0;t<e.length;t++)e[t].y+=e[t].dy/2}function p(e){for(var t=0;t<e.length;t++)e[t].y-=e[t].dy/2}function u(e,t,a){var o=G(t).trace,r=o.domain,d=o.node,c=o.link,p=o.arrangement,u="h"===o.orientation,g=o.node.pad,h=o.node.thickness,m=o.node.line.color,y=o.node.line.width,f=o.link.line.color,x=o.link.line.width,b=o.valueformat,_=o.valuesuffix,v=o.textfont,w=e.width*(r.x[1]-r.x[0]),k=e.height*(r.y[1]-r.y[0]),T=[],A=F(c.color),S={},C=d.label.length,L;for(L=0;L<c.value.length;L++){var E=c.value[L],z=c.source[L],I=c.target[L];0<E&&N(z,C)&&N(I,C)&&(z=+z,I=+I,S[z]=S[I]=!0,T.push({pointNumber:L,label:c.label[L],color:A?c.color[L]:c.color,source:z,target:I,value:+E}))}var D=F(d.color),P=[],R=!1,j={};for(L=0;L<C;L++)if(S[L]){var V=d.label[L];j[L]=P.length,P.push({pointNumber:L,label:V,color:D?d.color[L]:d.color})}else R=!0;if(R)for(L=0;L<T.length;L++)T[L].source=j[T[L].source],T[L].target=j[T[L].target];var l=M().size(u?[w,k]:[k,w]).nodeWidth(h).nodePadding(g).nodes(P).links(T).layout(O.sankeyIterations);l.nodePadding()<g&&B.warn("node.pad was reduced to ",l.nodePadding()," to fit within the figure.");for(var U=l.nodes(),H=0,Y;H<U.length;H++)Y=U[H],Y.width=w,Y.height=k;return s(P),{key:a,trace:o,guid:ea(1e12*(1+Math.random())),horizontal:u,width:w,height:k,nodePad:g,nodeLineColor:m,nodeLineWidth:y,linkLineColor:f,linkLineWidth:x,valueFormat:b,valueSuffix:_,textFont:v,translateX:r.x[0]*e.width+e.margin.l,translateY:e.height-r.y[1]*e.height+e.margin.t,dragParallel:u?k:w,dragPerpendicular:u?w:k,nodes:P,links:T,arrangement:p,sankey:l,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function g(e,t,a){var o=c(a.color),r=a.source.label+"|"+a.target.label,i=e[r];e[r]=(i||0)+1;var n=r+"__"+e[r];return a.trace=t.trace,a.curveNumber=t.trace.index,{key:n,traceId:t.key,link:a,tinyColorHue:x.tinyRGB(o),tinyColorAlpha:o.getAlpha(),linkLineColor:t.linkLineColor,linkLineWidth:t.linkLineWidth,valueFormat:t.valueFormat,valueSuffix:t.valueSuffix,sankey:t.sankey,interactionState:t.interactionState}}function h(e,t,a){var o=c(a.color),r=O.nodePadAcross,i=t.nodePad/2,n=a.dx,l=va(.5,a.dy),s=a.label,d=e[s];e[s]=(d||0)+1;var p=s+"__"+e[s];return a.trace=t.trace,a.curveNumber=t.trace.index,{key:p,traceId:t.key,node:a,nodePad:t.nodePad,nodeLineColor:t.nodeLineColor,nodeLineWidth:t.nodeLineWidth,textFont:t.textFont,size:t.horizontal?t.height:t.width,visibleWidth:ae(n),visibleHeight:l,zoneX:-r,zoneY:-i,zoneWidth:n+2*r,zoneHeight:l+2*i,labelY:t.horizontal?a.dy/2+1:a.dx/2+1,left:1===a.originalLayer,sizeAcross:t.width,forceLayouts:t.forceLayouts,horizontal:t.horizontal,darkBackground:128>=o.getBrightness(),tinyColorHue:x.tinyRGB(o),tinyColorAlpha:o.getAlpha(),valueFormat:t.valueFormat,valueSuffix:t.valueSuffix,sankey:t.sankey,arrangement:t.arrangement,uniqueNodeLabelPathId:[t.guid,t.key,p].join(" "),interactionState:t.interactionState}}function m(e){e.attr("transform",function(e){return"translate("+e.node.x.toFixed(3)+", "+(e.node.y-e.node.dy/2).toFixed(3)+")"})}function y(e){var t=e.sankey.nodes();p(t);var a=e.sankey.link()(e.link);return s(t),a}function f(e){e.call(m)}function b(e,t){e.call(f),t.attr("d",y)}function _(e){e.attr("width",function(e){return e.visibleWidth}).attr("height",function(e){return e.visibleHeight})}function v(e){return 1<e.link.dy||0<e.linkLineWidth}function w(e){var t="translate("+e.translateX+","+e.translateY+")";return t+(e.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function k(e){return"translate("+(e.horizontal?0:e.labelY)+" "+(e.horizontal?e.labelY:0)+")"}function T(e){return i.svg.line()([[e.horizontal?e.left?-e.sizeAcross:e.visibleWidth+O.nodeTextOffsetHorizontal:O.nodeTextOffsetHorizontal,0],[e.horizontal?e.left?-O.nodeTextOffsetHorizontal:e.sizeAcross:e.visibleHeight-O.nodeTextOffsetHorizontal,0]])}function A(e){return e.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)"}function S(e){return e.horizontal?"scale(1 1)":"scale(-1 1)"}function C(e){return e.darkBackground&&!e.horizontal?"rgb(255,255,255)":"rgb(0,0,0)"}function L(e){return e.horizontal&&e.left?"100%":"0%"}function E(e,t,a){e.on(".basic",null).on("mouseover.basic",function(e){e.interactionState.dragInProgress||(a.hover(this,e,t),e.interactionState.hovered=[this,e])}).on("mousemove.basic",function(e){e.interactionState.dragInProgress||(a.follow(this,e),e.interactionState.hovered=[this,e])}).on("mouseout.basic",function(e){e.interactionState.dragInProgress||(a.unhover(this,e,t),e.interactionState.hovered=!1)}).on("click.basic",function(e){e.interactionState.hovered&&(a.unhover(this,e,t),e.interactionState.hovered=!1),e.interactionState.dragInProgress||a.select(this,e,t)})}function z(e,t,a){var n=i.behavior.drag().origin(function(e){return e.node}).on("dragstart",function(r){if("fixed"!==r.arrangement&&(B.raiseToTop(this),r.interactionState.dragInProgress=r.node,o(r.node),r.interactionState.hovered&&(a.nodeEvents.unhover.apply(0,r.interactionState.hovered),r.interactionState.hovered=!1),"snap"===r.arrangement)){var i=r.traceId+"|"+ea(r.node.originalX);r.forceLayouts[i]?r.forceLayouts[i].alpha(1):I(e,i,r),D(e,t,r,i)}}).on("drag",function(a){if("fixed"!==a.arrangement){var n=i.event.x,l=i.event.y;"snap"===a.arrangement?(a.node.x=n,a.node.y=l):("freeform"===a.arrangement&&(a.node.x=n),a.node.y=va(a.node.dy/2,ie(a.size-a.node.dy/2,l))),o(a.node),"snap"!==a.arrangement&&(a.sankey.relayout(),b(e.filter(r(a)),t))}}).on("dragend",function(e){e.interactionState.dragInProgress=!1});e.on(".drag",null).call(n)}function I(e,t,a){var o=a.sankey.nodes().filter(function(e){return e.originalX===a.node.originalX});a.forceLayouts[t]=j.forceSimulation(o).alphaDecay(0).force("collide",j.forceCollide().radius(function(e){return e.dy/2+a.nodePad/2}).strength(1).iterations(O.forceIterations)).force("constrain",P(e,t,o,a)).stop()}function D(e,t,a,o){window.requestAnimationFrame(function n(){for(var l=0;l<O.forceTicksPerFrame;l++)a.forceLayouts[o].tick();a.sankey.relayout(),b(e.filter(r(a)),t),0<a.forceLayouts[o].alpha()&&window.requestAnimationFrame(n)})}function P(e,t,a,o){return function(){for(var e=0,r=0,l;r<a.length;r++)l=a[r],l===o.interactionState.dragInProgress?(l.x=l.lastDraggedX,l.y=l.lastDraggedY):(l.vx=(l.originalX-l.x)/O.forceTicksPerFrame,l.y=ie(o.size-l.dy/2,va(l.dy/2,l.y))),e=va(e,wa(l.vx),wa(l.vy));!o.interactionState.dragInProgress&&.1>e&&0<o.forceLayouts[t].alpha()&&o.forceLayouts[t].alpha(0)}}var O=e("./constants"),i=e("d3"),c=e("tinycolor2"),x=e("../../components/color"),R=e("../../components/drawing"),M=e("@plotly/d3-sankey").sankey,j=e("d3-force"),B=e("../../lib"),F=B.isArrayOrTypedArray,N=B.isIndex,V=e("../../lib/gup"),U=V.keyFun,H=V.repeat,G=V.unwrap;t.exports=function(e,t,o,r){var i=e.selectAll("."+O.cn.sankey).data(t.filter(function(e){return G(e).trace.visible}).map(u.bind(null,o)),U);i.exit().remove(),i.enter().append("g").classed(O.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",w),i.transition().ease(O.ease).duration(O.duration).attr("transform",w);var n=i.selectAll("."+O.cn.sankeyLinks).data(H,U);n.enter().append("g").classed(O.cn.sankeyLinks,!0).style("fill","none");var l=n.selectAll("."+O.cn.sankeyLink).data(function(e){return e.sankey.links().filter(function(e){return e.value}).map(g.bind(null,{},e))},U);l.enter().append("path").classed(O.cn.sankeyLink,!0).attr("d",y).call(E,i,r.linkEvents),l.style("stroke",function(e){return v(e)?x.tinyRGB(c(e.linkLineColor)):e.tinyColorHue}).style("stroke-opacity",function(e){return v(e)?x.opacity(e.linkLineColor):e.tinyColorAlpha}).style("stroke-width",function(e){return v(e)?e.linkLineWidth:1}).style("fill",function(e){return e.tinyColorHue}).style("fill-opacity",function(e){return e.tinyColorAlpha}),l.transition().ease(O.ease).duration(O.duration).attr("d",y),l.exit().transition().ease(O.ease).duration(O.duration).style("opacity",0).remove();var s=i.selectAll("."+O.cn.sankeyNodeSet).data(H,U);s.enter().append("g").classed(O.cn.sankeyNodeSet,!0),s.style("cursor",function(e){switch(e.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move";}});var d=s.selectAll("."+O.cn.sankeyNode).data(function(e){var t=e.sankey.nodes();return a(t),t.filter(function(e){return e.value}).map(h.bind(null,{},e))},U);d.enter().append("g").classed(O.cn.sankeyNode,!0).call(m).call(E,i,r.nodeEvents),d.call(z,l,r),d.transition().ease(O.ease).duration(O.duration).call(m),d.exit().transition().ease(O.ease).duration(O.duration).style("opacity",0).remove();var p=d.selectAll("."+O.cn.nodeRect).data(H);p.enter().append("rect").classed(O.cn.nodeRect,!0).call(_),p.style("stroke-width",function(e){return e.nodeLineWidth}).style("stroke",function(e){return x.tinyRGB(c(e.nodeLineColor))}).style("stroke-opacity",function(e){return x.opacity(e.nodeLineColor)}).style("fill",function(e){return e.tinyColorHue}).style("fill-opacity",function(e){return e.tinyColorAlpha}),p.transition().ease(O.ease).duration(O.duration).call(_);var f=d.selectAll("."+O.cn.nodeCapture).data(H);f.enter().append("rect").classed(O.cn.nodeCapture,!0).style("fill-opacity",0),f.attr("x",function(e){return e.zoneX}).attr("y",function(e){return e.zoneY}).attr("width",function(e){return e.zoneWidth}).attr("height",function(e){return e.zoneHeight});var b=d.selectAll("."+O.cn.nodeCentered).data(H);b.enter().append("g").classed(O.cn.nodeCentered,!0).attr("transform",k),b.transition().ease(O.ease).duration(O.duration).attr("transform",k);var I=b.selectAll("."+O.cn.nodeLabelGuide).data(H);I.enter().append("path").classed(O.cn.nodeLabelGuide,!0).attr("id",function(e){return e.uniqueNodeLabelPathId}).attr("d",T).attr("transform",A),I.transition().ease(O.ease).duration(O.duration).attr("d",T).attr("transform",A);var D=b.selectAll("."+O.cn.nodeLabel).data(H);D.enter().append("text").classed(O.cn.nodeLabel,!0).attr("transform",S).style("user-select","none").style("cursor","default").style("fill","black"),D.style("text-shadow",function(e){return e.horizontal?"-1px 1px 1px #fff, 1px 1px 1px #fff, 1px -1px 1px #fff, -1px -1px 1px #fff":"none"}).each(function(e){R.font(D,e.textFont)}),D.transition().ease(O.ease).duration(O.duration).attr("transform",S);var P=D.selectAll("."+O.cn.nodeLabelTextPath).data(H);P.enter().append("textPath").classed(O.cn.nodeLabelTextPath,!0).attr("alignment-baseline","middle").attr("xlink:href",function(e){return"#"+e.uniqueNodeLabelPathId}).attr("startOffset",L).style("fill",C),P.text(function(e){return e.horizontal||5<e.node.dy?e.node.label:""}).attr("text-anchor",function(e){return e.horizontal&&e.left?"end":"start"}),P.transition().ease(O.ease).duration(O.duration).attr("startOffset",L).style("fill",C)}},{"../../components/color":569,"../../components/drawing":590,"../../lib":692,"../../lib/gup":690,"./constants":1034,"@plotly/d3-sankey":46,d3:148,"d3-force":144,tinycolor2:513}],1039:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t){for(var o=0;o<e.length;o++)e[o].i=o;a.mergeArray(t.text,e,"tx"),a.mergeArray(t.hovertext,e,"htx"),a.mergeArray(t.customdata,e,"data"),a.mergeArray(t.textposition,e,"tp"),t.textfont&&(a.mergeArray(t.textfont.size,e,"ts"),a.mergeArray(t.textfont.color,e,"tc"),a.mergeArray(t.textfont.family,e,"tf"));var r=t.marker;if(r){a.mergeArray(r.size,e,"ms"),a.mergeArray(r.opacity,e,"mo"),a.mergeArray(r.symbol,e,"mx"),a.mergeArray(r.color,e,"mc");var n=r.line;r.line&&(a.mergeArray(n.color,e,"mlc"),a.mergeArray(n.width,e,"mlw"));var l=r.gradient;l&&"none"!==l.type&&(a.mergeArray(l.type,e,"mgt"),a.mergeArray(l.color,e,"mgc"))}}},{"../../lib":692}],1040:[function(e,t){"use strict";var a=e("../../components/fx/hovertemplate_attributes"),o=e("../../components/colorscale/attributes"),r=e("../../components/colorbar/attributes"),i=e("../../plots/font_attributes"),n=e("../../components/drawing/attributes").dash,l=e("../../components/drawing"),s=e("./constants"),d=e("../../lib/extend").extendFlat;t.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dy:{valType:"number",dflt:1,editType:"calc"},stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:a({},{keys:s.eventDataKeys}),line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:d({},n,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style"},marker:d({symbol:{valType:"enumerated",values:l.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style"},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc"},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},colorbar:r,line:d({width:{valType:"number",min:0,arrayOk:!0,editType:"style"},editType:"calc"},o("marker.line")),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},o("marker")),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:i({editType:"calc",colorEditType:"style",arrayOk:!0}),r:{valType:"data_array",editType:"calc"},t:{valType:"data_array",editType:"calc"}}},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../components/drawing":590,"../../components/drawing/attributes":589,"../../components/fx/hovertemplate_attributes":607,"../../lib/extend":682,"../../plots/font_attributes":767,"./constants":1044}],1041:[function(e,t){"use strict";function a(e,t,a,o,r,l,s){var d=t._length,p=e._fullLayout,g=a._id,h=o._id,m=p._firstScatter[i(t)]===t.uid,y=(n(t,p,a,o)||{}).orientation,f=t.fill;a._minDtick=0,o._minDtick=0;var x={padded:!0},b={padded:!0};s&&(x.ppad=b.ppad=s);var _=2>d||r[0]!==r[d-1]||l[0]!==l[d-1];_&&("tozerox"===f||"tonextx"===f&&(m||"h"===y))?x.tozero=!0:!(t.error_y||{}).visible&&("tonexty"===f||"tozeroy"===f||!u.hasMarkers(t)&&!u.hasText(t))&&(x.padded=!1,x.ppad=0),_&&("tozeroy"===f||"tonexty"===f&&(m||"v"===y))?b.tozero=!0:("tonextx"===f||"tozerox"===f)&&(b.padded=!1),g&&(t._extremes[g]=c.findExtremes(a,r,x)),h&&(t._extremes[h]=c.findExtremes(o,l,b))}function o(e,t){if(u.hasMarkers(e)){var a=e.marker,o=1.6*(e.marker.sizeref||1),r;if(r="area"===e.marker.sizemode?function(e){return va(re((e||0)/o),3)}:function(e){return va((e||0)/o,3)},d.isArrayOrTypedArray(a.size)){var n={type:"linear"};c.setConvert(n);for(var l=n.makeCalcdata(e.marker,"size"),s=Array(t),p=0;p<t;p++)s[p]=r(l[p]);return s}return r(a.size)}}function r(e,t){var a=i(t),o=e._firstScatter;o[a]||(o[a]=t.uid)}function i(e){var t=e.stackgroup;return e.xaxis+e.yaxis+e.type+(t?"-"+t:"")}function n(e,t,a,o){var r=e.stackgroup;if(r){var i=t._scatterStackOpts[a._id+o._id][r],n="v"===i.orientation?o:a;if("linear"===n.type||"log"===n.type)return i}}var l=e("fast-isnumeric"),d=e("../../lib"),c=e("../../plots/cartesian/axes"),p=e("../../constants/numerical").BADNUM,u=e("./subtypes"),g=e("./colorscale_calc"),h=e("./arrays_to_calcdata"),f=e("./calc_selection");t.exports={calc:function(e,t){var s=e._fullLayout,u=c.getFromId(e,t.xaxis||"x"),b=c.getFromId(e,t.yaxis||"y"),_=u.makeCalcdata(t,"x"),x=b.makeCalcdata(t,"y"),y=t._length,v=Array(y),w=t.ids,T=n(t,s,u,b),A=!1,S,C,L,E,z,I;r(s,t);var D="x",P="y",O;if(T)T.traceIndices.push(t.index),S="v"===T.orientation,S?(P="s",O="x"):(D="s",O="y"),z="interpolate"===T.stackgaps;else{var R=o(t,y);a(e,t,u,b,_,x,R)}for(C=0;C<y;C++){var M=v[C]={},B=l(_[C]),F=l(x[C]);B&&F?(M[D]=_[C],M[P]=x[C]):T&&(S?B:F)?(M[O]=S?_[C]:x[C],M.gap=!0,z?(M.s=p,A=!0):M.s=0):M[D]=M[P]=p,w&&(M.id=w[C]+"")}if(h(v,t),g(e,t),f(v,t),T){for(C=0;C<v.length;)v[C][O]===p?v.splice(C,1):C++;if(d.sort(v,function(e,t){return e[O]-t[O]||e.i-t.i}),A){for(C=0;C<v.length-1&&v[C].gap;)C++;for(I=v[C].s,I||(I=v[C].s=0),L=0;L<C;L++)v[L].s=I;for(E=v.length-1;E>C&&v[E].gap;)E--;for(I=v[E].s,L=v.length-1;L>E;L--)v[L].s=I;for(;C<E;)if(C++,v[C].gap){for(L=C+1;v[L].gap;)L++;for(var N=v[C-1][O],V=v[C-1].s,U=(v[L].s-V)/(v[L][O]-N);C<L;)v[C].s=V+(v[C][O]-N)*U,C++}}}return v},calcMarkerSize:o,calcAxisExpansion:a,setFirstScatter:r,getStackOpts:n}},{"../../constants/numerical":669,"../../lib":692,"../../plots/cartesian/axes":740,"./arrays_to_calcdata":1039,"./calc_selection":1042,"./colorscale_calc":1043,"./subtypes":1064,"fast-isnumeric":214}],1042:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t){a.isArrayOrTypedArray(t.selectedpoints)&&a.tagSelected(e,t)}},{"../../lib":692}],1043:[function(e,t){"use strict";var a=e("../../components/colorscale/helpers").hasColorscale,o=e("../../components/colorscale/calc"),r=e("./subtypes");t.exports=function(e,t){r.hasLines(t)&&a(t,"line")&&o(e,t,{vals:t.line.color,containerStr:"line",cLetter:"c"}),r.hasMarkers(t)&&(a(t,"marker")&&o(e,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"}),a(t,"marker.line")&&o(e,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":577,"../../components/colorscale/helpers":580,"./subtypes":1064}],1044:[function(e,t){"use strict";t.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],1045:[function(e,t){"use strict";function a(e,t,a,r,i,n,l){i[r]=!0;var s={i:null,gap:!0,s:0};if(s[l]=a,e.splice(t,0,s),t&&a===e[t-1][l]){var d=e[t-1];s.s=d.s,s.i=d.i,s.gap=d.gap}else n&&(s.s=o(e,t,a,l));t||(e[0].t=e[1].t,e[0].trace=e[1].trace,delete e[1].t,delete e[1].trace)}function o(e,t,a,o){var r=e[t-1],i=e[t+1];return i?r?r.s+(i.s-r.s)*(a-r[o])/(i[o]-r[o]):i.s:r.s}var r=e("./calc");t.exports=function(e,t){var o=t.xaxis,n=t.yaxis,l=o._id+n._id,s=e._fullLayout._scatterStackOpts[l];if(s){var d=e.calcdata,c,p,u,g,h,m,f,b,_,v,w,T,A,S,C;for(var L in s){v=s[L];var E=v.traceIndices;if(E.length){for(w="interpolate"===v.stackgaps,T=v.groupnorm,"v"===v.orientation?(A="x",S="y"):(A="y",S="x"),C=Array(E.length),c=0;c<C.length;c++)C[c]=!1;m=d[E[0]];var z=Array(m.length);for(c=0;c<m.length;c++)z[c]=m[c][A];for(c=1;c<E.length;c++){for(h=d[E[c]],p=u=0;p<h.length;p++){for(f=h[p][A];f>z[u]&&u<z.length;u++)a(h,p,z[u],c,C,w,A),p++;if(f!==z[u]){for(g=0;g<c;g++)a(d[E[g]],u,f,g,C,w,A);z.splice(u,0,f)}u++}for(;u<z.length;u++)a(h,p,z[u],c,C,w,A),p++}var I=z.length;for(p=0;p<m.length;p++){for(b=m[p][S]=m[p].s,c=1;c<E.length;c++)h=d[E[c]],h[0].trace._rawLength=h[0].trace._length,h[0].trace._length=I,b+=h[p].s,h[p][S]=b;if(T)for(_=("fraction"===T?b:b/100)||1,c=0;c<E.length;c++){var D=d[E[c]][p];D[S]/=_,D.sNorm=D.s/_}}for(c=0;c<E.length;c++){h=d[E[c]];var P=h[0].trace,O=r.calcMarkerSize(P,P._rawLength),R=Array.isArray(O);if(O&&C[c]||R){var M=O;for(O=Array(I),p=0;p<I;p++)O[p]=h[p].gap?0:R?M[h[p].i]:M}var B=Array(I),x=Array(I);for(p=0;p<I;p++)B[p]=h[p].x,x[p]=h[p].y;r.calcAxisExpansion(e,P,o,n,B,x,O),h[0].t.orientation=v.orientation}}}}}},{"./calc":1041}],1046:[function(e,t){"use strict";t.exports=function(e){for(var t=0,a;t<e.length;t++)if(a=e[t],"scatter"===a.type){var o=a.fill;if("none"!==o&&"toself"!==o&&(a.opacity=void 0,"tonexty"===o||"tonextx"===o))for(var r=t-1,n;0<=r;r--)if(n=e[r],"scatter"===n.type&&n.xaxis===a.xaxis&&n.yaxis===a.yaxis){n.opacity=void 0;break}}}},{}],1047:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../registry"),r=e("./attributes"),i=e("./constants"),n=e("./subtypes"),l=e("./xy_defaults"),s=e("./stack_defaults"),d=e("./marker_defaults"),c=e("./line_defaults"),p=e("./line_shape_defaults"),u=e("./text_defaults"),g=e("./fillcolor_defaults");t.exports=function(e,t,h,m){function y(o,i){return a.coerce(e,t,r,o,i)}var f=l(e,t,m,y);if(f||(t.visible=!1),!!t.visible){var x=s(e,t,m,y),b=!x&&f<i.PTS_LINESONLY?"lines+markers":"lines";y("text"),y("hovertext"),y("mode",b),n.hasLines(t)&&(c(e,t,h,m,y),p(e,t,y),y("connectgaps"),y("line.simplify")),n.hasMarkers(t)&&d(e,t,h,m,y,{gradient:!0}),n.hasText(t)&&u(e,t,m,y);var _=[];(n.hasMarkers(t)||n.hasText(t))&&(y("cliponaxis"),y("marker.maxdisplayed"),_.push("points")),y("fill",x?x.fillDflt:"none"),"none"!==t.fill&&(g(e,t,h,y),!n.hasLines(t)&&p(e,t,y)),("tonext"===t.fill||"toself"===t.fill)&&_.push("fills"),y("hoveron",_.join("+")||"points"),"fills"!==t.hoveron&&y("hovertemplate");var v=o.getComponentMethod("errorbars","supplyDefaults");v(e,t,h,{axis:"y"}),v(e,t,h,{axis:"x",inherit:"y"}),a.coerceSelectionMarkerOpacity(t,y)}}},{"../../lib":692,"../../registry":823,"./attributes":1040,"./constants":1044,"./fillcolor_defaults":1049,"./line_defaults":1053,"./line_shape_defaults":1055,"./marker_defaults":1059,"./stack_defaults":1062,"./subtypes":1064,"./text_defaults":1065,"./xy_defaults":1066}],1048:[function(e,t){"use strict";function a(e){return e||0===e}var o=e("../../lib");t.exports=function(e,t,r){var i=Array.isArray(r)?function(e){r.push(e)}:function(e){r.text=e},n=o.extractOption(e,t,"htx","hovertext");if(a(n))return i(n);var l=o.extractOption(e,t,"tx","text");if(a(l))return i(l)}},{"../../lib":692}],1049:[function(e,t){"use strict";var a=e("../../components/color"),o=e("../../lib").isArrayOrTypedArray;t.exports=function(e,t,r,i){var n=!1;if(t.marker){var l=t.marker.color,s=(t.marker.line||{}).color;l&&!o(l)?n=l:s&&!o(s)&&(n=s)}i("fillcolor",a.addOpacity((t.line||{}).color||n||r,.5))}},{"../../components/color":569,"../../lib":692}],1050:[function(e,t){"use strict";var a=e("../../components/color"),o=e("./subtypes");t.exports=function(e,t){var r,i;if("lines"===e.mode)return r=e.line.color,r&&a.opacity(r)?r:e.fillcolor;if("none"===e.mode)return e.fill?e.fillcolor:"";var n=t.mcc||(e.marker||{}).color,l=t.mlcc||((e.marker||{}).line||{}).color;return i=n&&a.opacity(n)?n:l&&a.opacity(l)&&(t.mlw||((e.marker||{}).line||{}).width)?l:"",i?.3>a.opacity(i)?a.addOpacity(i,.3):i:(r=(e.line||{}).color,r&&a.opacity(r)&&o.hasLines(e)&&e.line.width?r:e.fillcolor)}},{"../../components/color":569,"./subtypes":1064}],1051:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../components/fx"),r=e("../../registry"),i=e("./get_trace_color"),n=e("../../components/color"),l=e("./fill_hover_text");t.exports=function(e,t,s,d){var c=e.cd,p=c[0].trace,u=e.xa,g=e.ya,h=u.c2p(t),m=g.c2p(s),y=[h,m],f=p.hoveron||"",x=-1===p.mode.indexOf("markers")?.5:3;if(-1!==f.indexOf("points")){var b=function(e){var t=va(3,e.mrc||0),a=1-1/t,o=wa(u.c2p(e.x)-h),r=o<t?a*o/t:o-t+a;return r},_=function(e){var t=va(3,e.mrc||0),a=1-1/t,o=wa(g.c2p(e.y)-m);return o<t?a*o/t:o-t+a},v=function(e){var t=va(x,e.mrc||0),a=u.c2p(e.x)-h,o=g.c2p(e.y)-m;return va(re(a*a+o*o)-t,1-x/t)},w=o.getDistanceFunction(d,b,_,v);if(o.getClosest(c,w,e),!1!==e.index){var k=c[e.index],T=u.c2p(k.x,!0),A=g.c2p(k.y,!0),S=k.mrc||1;e.index=k.i;var C=c[0].t.orientation,L=C&&(k.sNorm||k.s),E="h"===C?L:k.x,z="v"===C?L:k.y;return a.extendFlat(e,{color:i(p,k),x0:T-S,x1:T+S,xLabelVal:E,y0:A-S,y1:A+S,yLabelVal:z,spikeDistance:v(k),hovertemplate:p.hovertemplate}),l(k,p,e),r.getComponentMethod("errorbars","hoverInfo")(k,p,e),[e]}}if(-1!==f.indexOf("fills")&&p._polygons){var I=p._polygons,D=[],P=!1,O=1/0,R=-Infinity,M=1/0,B=-Infinity,F,N,V,U,H,G,Y,q,W;for(F=0;F<I.length;F++)V=I[F],V.contains(y)&&(P=!P,D.push(V),M=ie(M,V.ymin),B=va(B,V.ymax));if(P){M=va(M,0),B=ie(B,g._length);var X=(M+B)/2;for(F=0;F<D.length;F++)for(U=D[F].pts,N=1;N<U.length;N++)q=U[N-1][1],W=U[N][1],q>X!=W>=X&&(G=U[N-1][0],Y=U[N][0],W-q&&(H=G+(Y-G)*(X-q)/(W-q),O=ie(O,H),R=va(R,H)));O=va(O,0),R=ie(R,u._length);var Z=n.defaultLine;return n.opacity(p.fillcolor)?Z=p.fillcolor:n.opacity((p.line||{}).color)&&(Z=p.line.color),a.extendFlat(e,{distance:e.maxHoverDistance,x0:O,x1:R,y0:X,y1:X,color:Z,hovertemplate:"%{name}"}),delete e.index,e.text=p.text&&!Array.isArray(p.text)?p.text+"":p.name,[e]}}}},{"../../components/color":569,"../../components/fx":608,"../../lib":692,"../../registry":823,"./fill_hover_text":1048,"./get_trace_color":1050}],1052:[function(e,t){"use strict";var a={},o=e("./subtypes");a.hasLines=o.hasLines,a.hasMarkers=o.hasMarkers,a.hasText=o.hasText,a.isBubble=o.isBubble,a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.crossTraceDefaults=e("./cross_trace_defaults"),a.calc=e("./calc").calc,a.crossTraceCalc=e("./cross_trace_calc"),a.arraysToCalcdata=e("./arrays_to_calcdata"),a.plot=e("./plot"),a.colorbar=e("./marker_colorbar"),a.style=e("./style").style,a.styleOnSelect=e("./style").styleOnSelect,a.hoverPoints=e("./hover"),a.selectPoints=e("./select"),a.animatable=!0,a.moduleType="trace",a.name="scatter",a.basePlotModule=e("../../plots/cartesian"),a.categories=["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],a.meta={},t.exports=a},{"../../plots/cartesian":752,"./arrays_to_calcdata":1039,"./attributes":1040,"./calc":1041,"./cross_trace_calc":1045,"./cross_trace_defaults":1046,"./defaults":1047,"./hover":1051,"./marker_colorbar":1058,"./plot":1060,"./select":1061,"./style":1063,"./subtypes":1064}],1053:[function(e,t){"use strict";var a=e("../../lib").isArrayOrTypedArray,o=e("../../components/colorscale/helpers").hasColorscale,r=e("../../components/colorscale/defaults");t.exports=function(e,t,i,n,l,s){var d=(e.marker||{}).color;if(l("line.color",i),o(e,"line"))r(e,t,n,l,{prefix:"line.",cLetter:"c",noScale:!0});else{var c=!a(d)&&d||i;l("line.color",c)}l("line.width"),(s||{}).noDash||l("line.dash")}},{"../../components/colorscale/defaults":579,"../../components/colorscale/helpers":580,"../../lib":692}],1054:[function(e,t){"use strict";var a=e("../../constants/numerical"),o=a.BADNUM,r=a.LOG_CLIP,i=r+.5,n=r-.5,l=e("../../lib"),s=l.segmentsIntersect,d=l.constrain,c=e("./constants");t.exports=function(e,t){function a(t){var a=e[t];if(!a)return!1;var r=w.c2p(a.x),l=k.c2p(a.y);if(r===o){if(T&&(r=w.c2p(a.x,!0)),r===o)return!1;A&&l===o&&(r*=wa(w._m*C*(0<w._m?i:n)/(k._m*S*(0<k._m?i:n)))),r*=1e3}if(l===o){if(A&&(l=k.c2p(a.y,!0)),l===o)return!1;l*=1e3}return[r,l]}function r(e,t,a,o){var r=a-e,i=o-t,n=.5-e,l=.5-t,s=r*r+i*i,d=r*n+i*l;if(0<d&&d<s){var c=n*i-l*r;if(c*c<s)return!0}}function p(e,t){var a=e[0]/S,o=e[1]/C,i=va(0,-a,a-1,-o,o-1);return i&&void 0!==oe&&r(a,o,oe,ne)&&(i=0),i&&t&&r(a,o,t[0]/S,t[1]/C)&&(i=0),(1+c.toleranceGrowth*i)*E}function u(e,t){var a=e[0]-t[0],o=e[1]-t[1];return re(a*a+o*o)}function g(e,t){for(var a=[],o=0,r=0;4>r;r++){var n=N[r],l=s(e[0],e[1],t[0],t[1],n[0],n[1],n[2],n[3]);l&&(!o||1<wa(l.x-a[0][0])||1<wa(l.y-a[0][1]))&&(l=[l.x,l.y],o&&u(l,e)<u(a[0],e)?a.unshift(l):a.push(l),o++)}return a}function h(e){if(e[0]<M||e[0]>j||e[1]<B||e[1]>F)return[d(e[0],M,j),d(e[1],B,F)]}function m(e,t){return!(e[0]!==t[0]||e[0]!==M&&e[0]!==j)||!(e[1]!==t[1]||e[1]!==B&&e[1]!==F)||void 0}function y(e,t){var a=[],o=h(e),r=h(t);return o&&r&&m(o,r)?a:(o&&a.push(o),r&&a.push(r),a)}function f(e,t,a){return function(o,r){var i=h(o),n=h(r),s=[];if(i&&n&&m(i,n))return s;i&&s.push(i),n&&s.push(n);var d=2*l.constrain((o[e]+r[e])/2,t,a)-((i||o)[e]+(n||r)[e]);if(d){var c;c=i&&n?0<d==i[e]>n[e]?i:n:i||n,c[e]+=d}return s}}function x(e,t){var a=t[0]-e[0],o=(t[1]-e[1])/a,r=(e[1]*t[0]-t[1]*e[0])/a;return 0<r?[0<o?M:j,F]:[0<o?j:M,B]}function b(e){var t=e[0],a=e[1],o=t===P[O-1][0],r=a===P[O-1][1];if(!(o&&r))if(1<O){var i=t===P[O-2][0],n=a===P[O-2][1];o&&(t===M||t===j)&&i?n?O--:P[O-1]=e:r&&(a===B||a===F)&&n?i?O--:P[O-1]=e:P[O++]=e}else P[O++]=e}function _(e){P[O-1][0]!==e[0]&&P[O-1][1]!==e[1]&&b([de,ce]),b(e),pe=null,de=ce=0}function v(e){if(oe=e[0]/S,ne=e[1]/C,le=e[0]<M?M:e[0]>j?j:0,se=e[1]<B?B:e[1]>F?F:0,le||se){if(!O)P[O++]=[le||e[0],se||e[1]];else if(pe){var t=ge(pe,e);1<t.length&&(_(t[0]),P[O++]=t[1])}else ue=ge(P[O-1],e)[0],P[O++]=ue;var a=P[O-1];le&&se&&(a[0]!==le||a[1]!==se)?(pe&&(de!==le&&ce!==se?de&&ce?b(x(pe,e)):b([de||le,ce||se]):de&&ce&&b([de,ce])),b([le,se])):de-le&&ce-se&&b([le||de,se||ce]),pe=e,de=le,ce=se}else pe&&_(ge(pe,e)[0]),P[O++]=e}var w=t.xaxis,k=t.yaxis,T="log"===w.type,A="log"===k.type,S=w._length,C=k._length,L=t.connectGaps,E=t.baseTolerance,z=t.shape,I=[],D=c.minTolerance,P=Array(e.length),O=0,R=c.maxScreensAway,M=-S*R,j=S*(1+R),B=-C*R,F=C*(1+R),N=[[M,B,j,B],[j,B,j,F],[j,F,M,F],[M,F,M,B]],V,U,H,G,Y,q,W,X,Z,$,J,K,Q,ee,te,ae,oe,ne,le,se,de,ce,pe,ue,ge;for("linear"===z||"spline"===z?ge=g:"hv"===z||"vh"===z?ge=y:"hvh"===z?ge=f(0,M,j):"vhv"===z&&(ge=f(1,B,F)),V=0;V<e.length;V++)if(U=a(V),U){for(O=0,pe=null,v(U),V++;V<e.length;V++){if(G=a(V),!G)if(L)continue;else break;if(!("linear"===z)||!t.simplify){v(G);continue}var he=a(V+1);if($=u(G,U),!($<p(G,he)*D)){for(X=[(G[0]-U[0])/$,(G[1]-U[1])/$],Y=U,J=$,K=ee=te=0,W=!1,H=G,V++;V<e.length;V++){if(q=he,he=a(V+1),!q)if(L)continue;else break;if(Z=[q[0]-U[0],q[1]-U[1]],ae=Z[0]*X[1]-Z[1]*X[0],ee=ie(ee,ae),te=va(te,ae),te-ee>p(q,he))break;H=q,Q=Z[0]*X[0]+Z[1]*X[1],Q>J?(J=Q,G=q,W=!1):Q<K&&(K=Q,Y=q,W=!0)}if(W?(v(G),H!==Y&&v(Y)):(Y!==U&&v(Y),H!==G&&v(G)),v(H),V>=e.length||!q)break;v(q),U=q}}pe&&b([de||pe[0],ce||pe[1]]),I.push(P.slice(0,O))}return I}},{"../../constants/numerical":669,"../../lib":692,"./constants":1044}],1055:[function(e,t){"use strict";t.exports=function(e,t,a){var o=a("line.shape");"spline"===o&&a("line.smoothing")}},{}],1056:[function(e,t){"use strict";var a={tonextx:1,tonexty:1,tonext:1};t.exports=function(e,t,o){var r={},n=!1,l=-1,s=0,d=-1,c,p,u,g,h;for(p=0;p<o.length;p++)c=o[p][0].trace,u=c.stackgroup||"",u?u in r?h=r[u]:(h=r[u]=s,s++):c.fill in a&&0<=d?h=d:(h=d=s,s++),h<l&&(n=!0),c._groupIndex=l=h;var m=o.slice();n&&m.sort(function(e,t){var a=e[0].trace,o=t[0].trace;return a._groupIndex-o._groupIndex||a.index-o.index});var y={};for(p=0;p<m.length;p++)c=m[p][0].trace,u=c.stackgroup||"",!0===c.visible?(c._nexttrace=null,c.fill in a&&(g=y[u],c._prevtrace=g||null,g&&(g._nexttrace=c)),c._ownfill=c.fill&&("tozero"===c.fill.substr(0,6)||"toself"===c.fill||"to"===c.fill.substr(0,2)&&!c._prevtrace),y[u]=c):c._prevtrace=c._nexttrace=c._ownfill=null;return m}},{}],1057:[function(e,t){"use strict";var a=e("fast-isnumeric");t.exports=function(e){var t=e.marker,o=t.sizeref||1,r=t.sizemin||0,i="area"===t.sizemode?function(e){return re(e/o)}:function(e){return e/o};return function(e){var t=i(e/2);return a(t)&&0<t?va(t,r):0}}},{"fast-isnumeric":214}],1058:[function(e,t){"use strict";t.exports={container:"marker",min:"cmin",max:"cmax"}},{}],1059:[function(e,t){"use strict";var a=e("../../components/color"),o=e("../../components/colorscale/helpers").hasColorscale,r=e("../../components/colorscale/defaults"),i=e("./subtypes");t.exports=function(e,t,n,l,s,d){var c=i.isBubble(e),p=(e.line||{}).color,u;if(d=d||{},p&&(n=p),s("marker.symbol"),s("marker.opacity",c?.7:1),s("marker.size"),s("marker.color",n),o(e,"marker")&&r(e,t,l,s,{prefix:"marker.",cLetter:"c"}),d.noSelect||(s("selected.marker.color"),s("unselected.marker.color"),s("selected.marker.size"),s("unselected.marker.size")),d.noLine||(u=p&&!Array.isArray(p)&&t.marker.color!==p?p:c?a.background:a.defaultLine,s("marker.line.color",u),o(e,"marker.line")&&r(e,t,l,s,{prefix:"marker.line.",cLetter:"c"}),s("marker.line.width",c?1:0)),c&&(s("marker.sizeref"),s("marker.sizemin"),s("marker.sizemode")),d.gradient){var g=s("marker.gradient.type");"none"!==g&&s("marker.gradient.color")}}},{"../../components/color":569,"../../components/colorscale/defaults":579,"../../components/colorscale/helpers":580,"./subtypes":1064}],1060:[function(e,t){"use strict";function a(e,t,a){t.each(function(t){var o=c(n.select(this),"g","fills");u.setClipUrl(o,a.layerClipId,e);var r=t[0].trace,i=[];r._ownfill&&i.push("_ownFill"),r._nexttrace&&i.push("_nextFill");var l=o.selectAll("g").data(i,p);l.enter().append("g"),l.exit().each(function(e){r[e]=null}).remove(),l.order().each(function(e){r[e]=c(n.select(this),"path","js-fill")})})}function o(e,t,a,o,d,m,f){function b(e){return x?e.transition():e}function _(e){b(e).attr("d","M0,0Z")}function v(e){return e.filter(function(e){return!e.gap&&e.vis})}function w(e){return e.filter(function(e){return e.vis})}function k(e){return e.filter(function(e){return!e.gap})}function T(e){return e.id}function A(e){if(e.ids)return T}function S(){return!1}function C(t,o,r){var i=r[0].trace,l=g.hasMarkers(i),s=g.hasText(i),d=A(i),c=S,h=S,m,y,f;if(l||s){var _=p,T=i.stackgroup,C=T&&"infer zero"===e._fullLayout._scatterStackOpts[E._id+z._id][T].stackgaps;i.marker.maxdisplayed||i._needsCull?_=C?w:v:T&&!C&&(_=k),l&&(c=_),s&&(h=_)}y=t.selectAll("path.point"),m=y.data(c,d);var L=m.enter().append("path").classed("point",!0);x&&L.call(u.pointStyle,i,e).call(u.translatePoints,E,z).style("opacity",0).transition().style("opacity",1),m.order();var I;l&&(I=u.makePointStyleFns(i)),m.each(function(t){var o=n.select(this),r=b(o);f=u.translatePoint(t,r,E,z),f?(u.singlePointStyle(t,r,i,I,e),a.layerClipId&&u.hideOutsideRangePoint(t,r,E,z,i.xcalendar,i.ycalendar),i.customdata&&o.classed("plotly-customdata",null!==t.data&&void 0!==t.data)):r.remove()}),x?m.exit().transition().style("opacity",0).remove():m.exit().remove(),y=o.selectAll("g"),m=y.data(h,d),m.enter().append("g").classed("textpoint",!0).append("text"),m.order(),m.each(function(e){var t=n.select(this),o=b(t.select("text"));f=u.translatePoint(e,o,E,z),f?a.layerClipId&&u.hideOutsideRangePoint(e,t,E,z,i.xcalendar,i.ycalendar):t.remove()}),m.selectAll("text").call(u.textPointStyle,i,e).each(function(e){var t=E.c2p(e.x),a=z.c2p(e.y);n.select(this).selectAll("tspan.line").each(function(){b(n.select(this)).attr({x:t,y:a})})}),m.exit().remove()}var L;r(e,t,a,o,d);var x=!!f&&0<f.duration,E=a.xaxis,z=a.yaxis,I=o[0].trace,D=I.line,P=n.select(m),O=c(P,"g","errorbars"),R=c(P,"g","lines"),M=c(P,"g","points"),j=c(P,"g","text");if(l.getComponentMethod("errorbars","plot")(e,O,a,f),!0===I.visible){b(P).style("opacity",I.opacity);var B=I.fill.charAt(I.fill.length-1),F,N;"x"!==B&&"y"!==B&&(B=""),a.isRangePlot||(o[0].node3=P);var V="",U=[],H=I._prevtrace;H&&(V=H._prevRevpath||"",N=H._nextFill,U=H._polygons);var G="",Y="",q=[],W=s.noop,X,Z,$,J,K,Q,ee,te,ae;if(F=I._ownFill,g.hasLines(I)||"none"!==I.fill){for(N&&N.datum(o),-1===["hv","vh","hvh","vhv"].indexOf(D.shape)?"spline"===D.shape?$=J=function(e){var t=e[e.length-1];return 1<e.length&&e[0][0]===t[0]&&e[0][1]===t[1]?u.smoothclosed(e.slice(1),D.smoothing):u.smoothopen(e,D.smoothing)}:$=J=function(e){return"M"+e.join("L")}:($=u.steps(D.shape),J=u.steps(D.shape.split("").reverse().join(""))),K=function(e){return J(e.reverse())},q=h(o,{xaxis:E,yaxis:z,connectGaps:I.connectgaps,baseTolerance:va(D.width||1,3)/4,shape:D.shape,simplify:D.simplify}),ae=I._polygons=Array(q.length),L=0;L<q.length;L++)I._polygons[L]=y(q[L]);q.length&&(Q=q[0][0],ee=q[q.length-1],te=ee[ee.length-1]),W=function(e){return function(t){if(X=$(t),Z=K(t),G?B?(G+="L"+X.substr(1),Y=Z+("L"+Y.substr(1))):(G+="Z"+X,Y=Z+"Z"+Y):(G=X,Y=Z),g.hasLines(I)&&1<t.length){var a=n.select(this);if(a.datum(o),e)b(a.style("opacity",0).attr("d",X).call(u.lineGroupStyle)).style("opacity",1);else{var r=b(a);r.attr("d",X),u.singleLineStyle(o,r)}}}}}var oe=R.selectAll(".js-line").data(q);b(oe.exit()).style("opacity",0).remove(),oe.each(W(!1)),oe.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(u.lineGroupStyle).each(W(!0)),u.setClipUrl(oe,a.layerClipId,e),q.length?(F?(F.datum(o),Q&&te&&(B?("y"===B?Q[1]=te[1]=z.c2p(0,!0):"x"===B&&(Q[0]=te[0]=E.c2p(0,!0)),b(F).attr("d","M"+te+"L"+Q+"L"+G.substr(1)).call(u.singleFillStyle)):b(F).attr("d",G+"Z").call(u.singleFillStyle))):N&&("tonext"===I.fill.substr(0,6)&&G&&V?("tonext"===I.fill?b(N).attr("d",G+"Z"+V+"Z").call(u.singleFillStyle):b(N).attr("d",G+"L"+V.substr(1)+"Z").call(u.singleFillStyle),I._polygons=I._polygons.concat(U)):(_(N),I._polygons=null)),I._prevRevpath=Y,I._prevPolygons=ae):(F?_(F):N&&_(N),I._polygons=I._prevRevpath=I._prevPolygons=null),M.datum(o),j.datum(o),C(M,j,o);var re=!1===I.cliponaxis,ie=re?null:a.layerClipId;u.setClipUrl(M,ie,e),u.setClipUrl(j,ie,e)}}function r(e,t,a,o,r){var i=a.xaxis,l=a.yaxis,d=n.extent(s.simpleMap(i.range,i.r2c)),c=n.extent(s.simpleMap(l.range,l.r2c)),p=o[0].trace;if(g.hasMarkers(p)){var u=p.marker.maxdisplayed;if(0!==u){var h=o.filter(function(e){return e.x>=d[0]&&e.x<=d[1]&&e.y>=c[0]&&e.y<=c[1]}),m=ae(h.length/u),y=0;r.forEach(function(e,a){var o=e[0].trace;g.hasMarkers(o)&&0<o.marker.maxdisplayed&&a<t&&y++});var f=R(y*m/3+ea(y/3)*m/7.1);o.forEach(function(e){delete e.vis}),h.forEach(function(e,t){0===R((t+f)%m)&&(e.vis=!0)})}}}var n=e("d3"),l=e("../../registry"),s=e("../../lib"),c=s.ensureSingle,p=s.identity,u=e("../../components/drawing"),g=e("./subtypes"),h=e("./line_points"),m=e("./link_traces"),y=e("../../lib/polygon").tester;t.exports=function(e,t,r,i,l,s){var d=!!l&&0<l.duration,c=m(e,t,r),p,u;if(p=i.selectAll("g.trace").data(c,function(e){return e[0].trace.uid}),p.enter().append("g").attr("class",function(e){return"trace scatter trace"+e[0].trace.uid}).style("stroke-miterlimit",2),p.order(),a(e,p,t),d){s&&(u=s());var g=n.transition().duration(l.duration).ease(l.easing).each("end",function(){u&&u()}).each("interrupt",function(){u&&u()});g.each(function(){i.selectAll("g.trace").each(function(a,r){o(e,r,t,a,c,this,l)})})}else p.each(function(a,r){o(e,r,t,a,c,this,l)});!l&&p.exit().remove(),i.selectAll("path:not([d])").remove()}},{"../../components/drawing":590,"../../lib":692,"../../lib/polygon":704,"../../registry":823,"./line_points":1054,"./link_traces":1056,"./subtypes":1064,d3:148}],1061:[function(e,t){"use strict";var a=e("./subtypes");t.exports=function(e,t){var o=e.cd,r=e.xaxis,n=e.yaxis,l=[],s=o[0].trace,d=!a.hasMarkers(s)&&!a.hasText(s),c,p,u,g;if(d)return[];if(!1===t)for(c=0;c<o.length;c++)o[c].selected=0;else for(c=0;c<o.length;c++)p=o[c],u=r.c2p(p.x),g=n.c2p(p.y),null!==p.i&&t.contains([u,g],!1,c,e)?(l.push({pointNumber:p.i,x:r.c2d(p.x),y:n.c2d(p.y)}),p.selected=1):p.selected=0;return l}},{"./subtypes":1064}],1062:[function(e,t){"use strict";var a=["orientation","groupnorm","stackgaps"];t.exports=function(e,t,o,r){var n=o._scatterStackOpts,l=r("stackgroup");if(l){var s=t.xaxis+t.yaxis,d=n[s];d||(d=n[s]={});var c=d[l],p=!1;c?c.traces.push(t):(c=d[l]={traceIndices:[],traces:[t]},p=!0);for(var u={orientation:t.x&&!t.y?"h":"v"},g=0;g<a.length;g++){var h=a[g],m=h+"Found";if(!c[m]){var y=e[h]!==void 0,f="orientation"===h;if((y||p)&&(c[h]=r(h,u[h]),f&&(c.fillDflt="h"===c[h]?"tonextx":"tonexty"),y&&(c[m]=!0,!p&&(delete c.traces[0][h],f))))for(var x=0,b;x<c.traces.length-1;x++)b=c.traces[x],b._input.fill!==b.fill&&(b.fill=c.fillDflt)}}return c}}},{}],1063:[function(e,t){"use strict";function a(e,t,a){i.pointStyle(e.selectAll("path.point"),t,a)}function o(e,t,a){i.textPointStyle(e.selectAll("text"),t,a)}var r=e("d3"),i=e("../../components/drawing"),n=e("../../registry");t.exports={style:function(e,t){var l=t?t[0].node3:r.select(e).selectAll("g.trace.scatter");l.style("opacity",function(e){return e[0].trace.opacity}),l.selectAll("g.points").each(function(t){var o=r.select(this),i=t.trace||t[0].trace;a(o,i,e)}),l.selectAll("g.text").each(function(t){var a=r.select(this),i=t.trace||t[0].trace;o(a,i,e)}),l.selectAll("g.trace path.js-line").call(i.lineGroupStyle),l.selectAll("g.trace path.js-fill").call(i.fillGroupStyle),n.getComponentMethod("errorbars","style")(l)},stylePoints:a,styleText:o,styleOnSelect:function(e,t){var r=t[0].node3,n=t[0].trace;n.selectedpoints?(i.selectedPointStyle(r.selectAll("path.point"),n),i.selectedTextStyle(r.selectAll("text"),n)):(a(r,n,e),o(r,n,e))}}},{"../../components/drawing":590,"../../registry":823,d3:148}],1064:[function(e,t){"use strict";var a=e("../../lib");t.exports={hasLines:function(e){return e.visible&&e.mode&&-1!==e.mode.indexOf("lines")},hasMarkers:function(e){return e.visible&&(e.mode&&-1!==e.mode.indexOf("markers")||"splom"===e.type)},hasText:function(e){return e.visible&&e.mode&&-1!==e.mode.indexOf("text")},isBubble:function(e){return a.isPlainObject(e.marker)&&a.isArrayOrTypedArray(e.marker.size)}}},{"../../lib":692}],1065:[function(e,t){"use strict";var a=e("../../lib");t.exports=function(e,t,o,r,i){i=i||{},r("textposition"),a.coerceFont(r,"textfont",o.font),i.noSelect||(r("selected.textfont.color"),r("unselected.textfont.color"))}},{"../../lib":692}],1066:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../registry");t.exports=function(e,t,r,i){var n=i("x"),l=i("y"),s=o.getComponentMethod("calendars","handleTraceDefaults"),d;if(s(e,t,["x","y"],r),n){var c=a.minRowLength(n);l?d=ie(c,a.minRowLength(l)):(d=c,i("y0"),i("dy"))}else{if(!l)return 0;d=a.minRowLength(l),i("x0"),i("dx")}return t._length=d,d}},{"../../lib":692,"../../registry":823}],1067:[function(e,t){"use strict";function a(){return{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var o=e("../scatter/attributes"),r=e("../../components/colorscale/attributes"),i=e("../../plots/attributes"),n=e("../../constants/gl3d_dashes"),l=e("../../constants/gl3d_markers"),s=e("../../lib/extend").extendFlat,d=e("../../plot_api/edit_types").overrideAll,c=o.line,p=o.marker,u=p.line,g=s({width:c.width,dash:{valType:"enumerated",values:Object.keys(n),dflt:"solid"}},r("line"));delete g.showscale,delete g.colorbar;var h=t.exports=d({x:o.x,y:o.y,z:{valType:"data_array"},text:s({},o.text,{}),hovertext:s({},o.hovertext,{}),mode:s({},o.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:a("x"),y:a("y"),z:a("z")},connectgaps:o.connectgaps,line:g,marker:s({symbol:{valType:"enumerated",values:Object.keys(l),dflt:"circle",arrayOk:!0},size:s({},p.size,{dflt:8}),sizeref:p.sizeref,sizemin:p.sizemin,sizemode:p.sizemode,opacity:s({},p.opacity,{arrayOk:!1}),colorbar:p.colorbar,line:s({width:s({},u.width,{arrayOk:!1})},r("marker.line"))},r("marker")),textposition:s({},o.textposition,{dflt:"top center"}),textfont:{color:o.textfont.color,size:o.textfont.size,family:s({},o.textfont.family,{arrayOk:!1})},hoverinfo:s({},i.hoverinfo)},"calc","nested");h.x.editType=h.y.editType=h.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":576,"../../constants/gl3d_dashes":666,"../../constants/gl3d_markers":667,"../../lib/extend":682,"../../plot_api/edit_types":723,"../../plots/attributes":737,"../scatter/attributes":1040}],1068:[function(e,t){"use strict";var a=e("../scatter/arrays_to_calcdata"),o=e("../scatter/colorscale_calc");t.exports=function(e,t){var r=[{x:!1,y:!1,trace:t,t:{}}];return a(r,t),o(e,t),r}},{"../scatter/arrays_to_calcdata":1039,"../scatter/colorscale_calc":1043}],1069:[function(e,t){"use strict";function a(e,t,a,o){if(!t||!t.visible)return null;for(var n=r.getComponentMethod("errorbars","makeComputeError")(t),l=Array(e.length),s=0,d;s<e.length;s++)if(d=n(+e[s],s),"log"===o.type){var c=o.c2l(e[s]),p=e[s]-d[0],u=e[s]+d[1];if(l[s]=[(o.c2l(p,!0)-c)*a,(o.c2l(u,!0)-c)*a],0<p){var g=o.c2l(p);o._lowerLogErrorBound||(o._lowerLogErrorBound=g),o._lowerErrorBound=ie(o._lowerLogErrorBound,g)}}else l[s]=[-d[0]*a,d[1]*a];return l}function o(e){for(var t=0;t<e.length;t++)if(e[t])return e[t].length;return 0}var r=e("../../registry");t.exports=function(e,t,r){var l=[a(e.x,e.error_x,t[0],r.xaxis),a(e.y,e.error_y,t[1],r.yaxis),a(e.z,e.error_z,t[2],r.zaxis)],s=o(l);if(0===s)return null;for(var n=Array(s),d=0,c;d<s;d++){c=[[0,0,0],[0,0,0]];for(var p=0;3>p;p++)if(l[p])for(var u=0;2>u;u++)c[u][p]=l[p][d][u];n[d]=c}return n}},{"../../registry":823}],1070:[function(e,t){"use strict";function a(e,t){this.scene=e,this.uid=t,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-Infinity,-Infinity,-Infinity],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}function o(e,t,a){var o=(a+1)%3,r=(a+2)%3,n=[],l=[],s;for(s=0;s<e.length;++s){var d=e[s];!isNaN(d[o])&&isFinite(d[o])&&!isNaN(d[r])&&isFinite(d[r])&&(n.push([d[o],d[r]]),l.push(s))}var p=x(n);for(s=0;s<p.length;++s)for(var u=p[s],c=0;c<u.length;++c)u[c]=l[u[c]];return{positions:e,cells:p,meshColor:t}}function r(t){for(var a=[0,0,0],o=[[0,0,0],[0,0,0],[0,0,0]],r=[1,1,1],n=0,l;3>n;n++)l=t[n],l&&!1!==l.copy_zstyle&&!1!==t[2].visible&&(l=t[2]),!l||!l.visible||(a[n]=l.width/2,o[n]=_(l.color),r[n]=l.thickness);return{capSize:a,color:o,lineWidth:r}}function n(e){return null===e||void 0===e?0:-1<e.indexOf("left")?-1:-1<e.indexOf("right")?1:0}function l(e){return null===e||void 0===e?0:-1<e.indexOf("top")?-1:-1<e.indexOf("bottom")?1:0}function s(e){var t=0,a=[0,t];if(Array.isArray(e))for(var o=0;o<e.length;o++)a[o]=[0,t],e[o]&&(a[o][0]=n(e[o]),a[o][1]=l(e[o]));else a[0]=n(e),a[1]=l(e);return a}function d(e,t){return t(4*e)}function c(e){return T[e]}function p(e,t,a,o,r){var n=null;if(b.isArrayOrTypedArray(e)){n=[];for(var l=0;l<t;l++)n[l]=void 0===e[l]?o:a(e[l],r)}else n=a(e,b.identity);return n}function u(e,t){var a=[],o=e.fullSceneLayout,n=e.dataScale,l=o.xaxis,u=o.yaxis,g=o.zaxis,h=t.marker,m=t.line,f=t.x||[],x=t.y||[],y=t.z||[],k=f.length,T=t.xcalendar,S=t.ycalendar,C=t.zcalendar,L,E,z,I,D,P;for(E=0;E<k;E++)z=l.d2l(f[E],0,T)*n[0],I=u.d2l(x[E],0,S)*n[1],D=g.d2l(y[E],0,C)*n[2],a[E]=[z,I,D];if(Array.isArray(t.text))P=t.text;else if(void 0!==t.text)for(P=Array(k),E=0;E<k;E++)P[E]=t.text;if(L={position:a,mode:t.mode,text:P},"line"in t&&(L.lineColor=v(m,1,k),L.lineWidth=m.width,L.lineDashes=m.dash),"marker"in t){var O=w(t);L.scatterColor=v(h,1,k),L.scatterSize=p(h.size,k,d,20,O),L.scatterMarker=p(h.symbol,k,c,"\u25CF"),L.scatterLineWidth=h.line.width,L.scatterLineColor=v(h.line,1,k),L.scatterAngle=0}"textposition"in t&&(L.textOffset=s(t.textposition),L.textColor=v(t.textfont,1,k),L.textSize=p(t.textfont.size,k,b.identity,12),L.textFont=t.textfont.family,L.textAngle=0);var R=["x","y","z"];for(L.project=[!1,!1,!1],L.projectScale=[1,1,1],L.projectOpacity=[1,1,1],E=0;3>E;++E){var M=t.projection[R[E]];(L.project[E]=M.show)&&(L.projectOpacity[E]=M.opacity,L.projectScale[E]=M.scale)}L.errorBounds=A(t,n,o);var j=r([t.error_x,t.error_y,t.error_z]);return L.errorColor=j.color,L.errorLineWidth=j.lineWidth,L.errorCapSize=j.capSize,L.delaunayAxis=t.surfaceaxis,L.delaunayColor=_(t.surfacecolor),L}function g(e){if(Array.isArray(e)){var t=e[0];return Array.isArray(t)&&(e=t),"rgb("+e.slice(0,3).map(function(e){return R(255*e)})+")"}return null}var h=e("gl-line3d"),m=e("gl-scatter3d"),y=e("gl-error3d"),f=e("gl-mesh3d"),x=e("delaunay-triangulate"),b=e("../../lib"),_=e("../../lib/str2rgbarray"),v=e("../../lib/gl_format_color").formatColor,w=e("../scatter/make_bubble_size_func"),k=e("../../constants/gl3d_dashes"),T=e("../../constants/gl3d_markers"),A=e("./calc_errors"),S=a.prototype;S.handlePick=function(e){if(e.object&&(e.object===this.linePlot||e.object===this.delaunayMesh||e.object===this.textMarkers||e.object===this.scatterPlot)){var t=e.index=e.data.index;return e.object.highlight&&e.object.highlight(null),this.scatterPlot&&(e.object=this.scatterPlot,this.scatterPlot.highlight(e.data)),e.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[t]||0===this.textLabels[t])&&(e.textLabel=this.textLabels[t]):e.textLabel=this.textLabels),e.traceCoordinate=[this.data.x[t],this.data.y[t],this.data.z[t]],!0}},S.update=function(e){var t=this.scene.glplot.gl,a=k.solid,r,i,n,l;this.data=e;var s=u(this.scene,e);"mode"in s&&(this.mode=s.mode),"lineDashes"in s&&s.lineDashes in k&&(a=k[s.lineDashes]),this.color=g(s.scatterColor)||g(s.lineColor),this.dataPoints=s.position,r={gl:t,position:s.position,color:s.lineColor,lineWidth:s.lineWidth||1,dashes:a[0],dashScale:a[1],opacity:e.opacity,connectGaps:e.connectgaps},-1===this.mode.indexOf("lines")?this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null):this.linePlot?this.linePlot.update(r):(this.linePlot=h(r),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot));var d=e.opacity;if(e.marker&&e.marker.opacity&&(d*=e.marker.opacity),i={gl:t,position:s.position,color:s.scatterColor,size:s.scatterSize,glyph:s.scatterMarker,opacity:d,orthographic:!0,lineWidth:s.scatterLineWidth,lineColor:s.scatterLineColor,project:s.project,projectScale:s.projectScale,projectOpacity:s.projectOpacity},-1===this.mode.indexOf("markers")?this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null):this.scatterPlot?this.scatterPlot.update(i):(this.scatterPlot=m(i),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)),l={gl:t,position:s.position,glyph:s.text,color:s.textColor,size:s.textSize,angle:s.textAngle,alignment:s.textOffset,font:s.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:e.opacity},this.textLabels=e.hovertext||e.text,-1===this.mode.indexOf("text")?this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null):this.textMarkers?this.textMarkers.update(l):(this.textMarkers=m(l),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)),n={gl:t,position:s.position,color:s.errorColor,error:s.errorBounds,lineWidth:s.errorLineWidth,capSize:s.errorCapSize,opacity:e.opacity},this.errorBars?s.errorBounds?this.errorBars.update(n):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):s.errorBounds&&(this.errorBars=y(n),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),0<=s.delaunayAxis){var c=o(s.position,s.delaunayColor,s.delaunayAxis);c.opacity=e.opacity,this.delaunayMesh?this.delaunayMesh.update(c):(c.gl=t,this.delaunayMesh=f(c),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},S.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},t.exports=function(e,t){var o=new a(e,t.uid);return o.update(t),o}},{"../../constants/gl3d_dashes":666,"../../constants/gl3d_markers":667,"../../lib":692,"../../lib/gl_format_color":689,"../../lib/str2rgbarray":715,"../scatter/make_bubble_size_func":1057,"./calc_errors":1069,"delaunay-triangulate":150,"gl-error3d":237,"gl-line3d":245,"gl-mesh3d":268,"gl-scatter3d":284}],1071:[function(e,t){"use strict";function a(e,t,a,r){var i=0,n=a("x"),l=a("y"),s=a("z"),d=o.getComponentMethod("calendars","handleTraceDefaults");return d(e,t,["x","y","z"],r),n&&l&&s&&(i=ie(n.length,l.length,s.length),t._length=t._xlength=t._ylength=t._zlength=i),i}var o=e("../../registry"),r=e("../../lib"),n=e("../scatter/subtypes"),l=e("../scatter/marker_defaults"),s=e("../scatter/line_defaults"),d=e("../scatter/text_defaults"),c=e("./attributes");t.exports=function(e,t,p,u){function g(a,o){return r.coerce(e,t,c,a,o)}var h=a(e,t,g,u);if(!h)return void(t.visible=!1);g("text"),g("hovertext"),g("mode"),n.hasLines(t)&&(g("connectgaps"),s(e,t,p,u,g)),n.hasMarkers(t)&&l(e,t,p,u,g,{noSelect:!0}),n.hasText(t)&&d(e,t,u,g,{noSelect:!0});var m=(t.line||{}).color,y=(t.marker||{}).color;0<=g("surfaceaxis")&&g("surfacecolor",m||y);for(var f=["x","y","z"],x=0,b;3>x;++x)b="projection."+f[x],g(b+".show")&&(g(b+".opacity"),g(b+".scale"));var _=o.getComponentMethod("errorbars","supplyDefaults");_(e,t,p,{axis:"z"}),_(e,t,p,{axis:"y",inherit:"z"}),_(e,t,p,{axis:"x",inherit:"z"})}},{"../../lib":692,"../../registry":823,"../scatter/line_defaults":1053,"../scatter/marker_defaults":1059,"../scatter/subtypes":1064,"../scatter/text_defaults":1065,"./attributes":1067}],1072:[function(e,t){"use strict";var a={};a.plot=e("./convert"),a.attributes=e("./attributes"),a.markerSymbols=e("../../constants/gl3d_markers"),a.supplyDefaults=e("./defaults"),a.colorbar=e("../scatter/marker_colorbar"),a.calc=e("./calc"),a.moduleType="trace",a.name="scatter3d",a.basePlotModule=e("../../plots/gl3d"),a.categories=["gl3d","symbols","showLegend"],a.meta={},t.exports=a},{"../../constants/gl3d_markers":667,"../../plots/gl3d":783,"../scatter/marker_colorbar":1058,"./attributes":1067,"./calc":1068,"./convert":1070,"./defaults":1071}],1073:[function(e,t){"use strict";var a=e("../scatter/attributes"),o=e("../../plots/attributes"),r=e("../../components/colorscale/attributes"),i=e("../../components/colorbar/attributes"),n=e("../../lib/extend").extendFlat,l=a.marker,s=a.line,d=l.line;t.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:n({},a.mode,{dflt:"markers"}),text:n({},a.text,{}),line:{color:s.color,width:s.width,dash:s.dash,shape:n({},s.shape,{values:["linear","spline"]}),smoothing:s.smoothing,editType:"calc"},connectgaps:a.connectgaps,fill:n({},a.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:a.fillcolor,marker:n({symbol:l.symbol,opacity:l.opacity,maxdisplayed:l.maxdisplayed,size:l.size,sizeref:l.sizeref,sizemin:l.sizemin,sizemode:l.sizemode,line:n({width:d.width,editType:"calc"},r("marker.line")),gradient:l.gradient,editType:"calc"},r("marker"),{colorbar:i}),textfont:a.textfont,textposition:a.textposition,selected:a.selected,unselected:a.unselected,hoverinfo:n({},o.hoverinfo,{flags:["a","b","text","name"]}),hoveron:a.hoveron}},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../lib/extend":682,"../../plots/attributes":737,"../scatter/attributes":1040}],1074:[function(e,t){"use strict";var o=e("fast-isnumeric"),r=e("../scatter/colorscale_calc"),n=e("../scatter/arrays_to_calcdata"),l=e("../scatter/calc_selection"),s=e("../scatter/calc").calcMarkerSize,d=e("../carpet/lookup_carpetid");t.exports=function(e,t){var c=t._carpetTrace=d(e,t);if(c&&c.visible&&"legendonly"!==c.visible){var p;t.xaxis=c.xaxis,t.yaxis=c.yaxis;var u=t._length,g=Array(u),h=!1,m,y;for(p=0;p<u;p++)if(m=t.a[p],y=t.b[p],o(m)&&o(y)){var f=c.ab2xy(+m,+y,!0),x=c.isVisible(+m,+y);x||(h=!0),g[p]={x:f[0],y:f[1],a:m,b:y,vis:x}}else g[p]={x:!1,y:!1};return t._needsCull=h,g[0].carpet=c,g[0].trace=t,s(t,u),r(e,t),n(g,t),l(g,t),g}}},{"../carpet/lookup_carpetid":891,"../scatter/arrays_to_calcdata":1039,"../scatter/calc":1041,"../scatter/calc_selection":1042,"../scatter/colorscale_calc":1043,"fast-isnumeric":214}],1075:[function(e,t){"use strict";var o=e("../../lib"),r=e("../scatter/constants"),i=e("../scatter/subtypes"),n=e("../scatter/marker_defaults"),l=e("../scatter/line_defaults"),s=e("../scatter/line_shape_defaults"),d=e("../scatter/text_defaults"),c=e("../scatter/fillcolor_defaults"),p=e("./attributes");t.exports=function(e,t,u,g){function h(a,r){return o.coerce(e,t,p,a,r)}h("carpet"),t.xaxis="x",t.yaxis="y";var m=h("a"),a=h("b"),y=ie(m.length,a.length);if(!y)return void(t.visible=!1);t._length=y,h("text");var f=y<r.PTS_LINESONLY?"lines+markers":"lines";h("mode",f),i.hasLines(t)&&(l(e,t,u,g,h),s(e,t,h),h("connectgaps")),i.hasMarkers(t)&&n(e,t,u,g,h,{gradient:!0}),i.hasText(t)&&d(e,t,g,h);var x=[];(i.hasMarkers(t)||i.hasText(t))&&(h("marker.maxdisplayed"),x.push("points")),h("fill"),"none"!==t.fill&&(c(e,t,u,h),!i.hasLines(t)&&s(e,t,h)),("tonext"===t.fill||"toself"===t.fill)&&x.push("fills"),h("hoveron",x.join("+")||"points"),o.coerceSelectionMarkerOpacity(t,h)}},{"../../lib":692,"../scatter/constants":1044,"../scatter/fillcolor_defaults":1049,"../scatter/line_defaults":1053,"../scatter/line_shape_defaults":1055,"../scatter/marker_defaults":1059,"../scatter/subtypes":1064,"../scatter/text_defaults":1065,"./attributes":1073}],1076:[function(e,t){"use strict";t.exports=function(e,t,a,o,r){var i=o[r];return e.a=i.a,e.b=i.b,e}},{}],1077:[function(e,t){"use strict";var a=e("../scatter/hover");t.exports=function(e,t,o,r){function i(e,t){var a;a=e.labelprefix&&0<e.labelprefix.length?e.labelprefix.replace(/ = $/,""):e._hovertitle,f.push(a+": "+t.toFixed(3)+e.labelsuffix)}var n=a(e,t,o,r);if(n&&!1!==n[0].index){var l=n[0];if(void 0===l.index){var s=1-l.y0/e.ya._length,d=e.xa._length,c=d*s/2,p=d-c;return l.x0=va(ie(l.x0,p),c),l.x1=va(ie(l.x1,p),c),n}var u=l.cd[l.index];l.a=u.a,l.b=u.b,l.xLabelVal=void 0,l.yLabelVal=void 0;var g=l.trace,h=g._carpet,m=u.hi||g.hoverinfo,y=m.split("+"),f=[];-1!==y.indexOf("all")&&(y=["a","b"]),-1!==y.indexOf("a")&&i(h.aaxis,u.a),-1!==y.indexOf("b")&&i(h.baxis,u.b);var x=h.ab2ij([u.a,u.b]),b=ea(x[0]),_=x[0]-b,v=ea(x[1]),w=x[1]-v,k=h.evalxy([],b,v,_,w);return f.push("y: "+k[1].toFixed(3)),l.extraText=f.join("<br>"),n}}},{"../scatter/hover":1051}],1078:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.colorbar=e("../scatter/marker_colorbar"),a.calc=e("./calc"),a.plot=e("./plot"),a.style=e("../scatter/style").style,a.styleOnSelect=e("../scatter/style").styleOnSelect,a.hoverPoints=e("./hover"),a.selectPoints=e("../scatter/select"),a.eventData=e("./event_data"),a.moduleType="trace",a.name="scattercarpet",a.basePlotModule=e("../../plots/cartesian"),a.categories=["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],a.meta={},t.exports=a},{"../../plots/cartesian":752,"../scatter/marker_colorbar":1058,"../scatter/select":1061,"../scatter/style":1063,"./attributes":1073,"./calc":1074,"./defaults":1075,"./event_data":1076,"./hover":1077,"./plot":1079}],1079:[function(e,t){"use strict";var a=e("../scatter/plot"),o=e("../../plots/cartesian/axes"),r=e("../../components/drawing");t.exports=function(e,t,n,l){var s=n[0][0].carpet,d={xaxis:o.getFromId(e,s.xaxis||"x"),yaxis:o.getFromId(e,s.yaxis||"y"),plot:t.plot},c,p,u;for(a(e,d,n,l),c=0;c<n.length;c++)p=n[c][0].trace,u=l.selectAll("g.trace"+p.uid+" .js-line"),r.setClipUrl(u,s._clipPathId,e)}},{"../../components/drawing":590,"../../plots/cartesian/axes":740,"../scatter/plot":1060}],1080:[function(e,t){"use strict";var a=e("../scatter/attributes"),o=e("../../plots/attributes"),r=e("../../components/colorscale/attributes"),i=e("../../components/drawing/attributes").dash,n=e("../../lib/extend").extendFlat,l=e("../../plot_api/edit_types").overrideAll,s=a.marker,d=a.line,c=s.line;t.exports=l({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names"],dflt:"ISO-3"},mode:n({},a.mode,{dflt:"markers"}),text:n({},a.text,{}),hovertext:n({},a.hovertext,{}),textfont:a.textfont,textposition:a.textposition,line:{color:d.color,width:d.width,dash:i},connectgaps:a.connectgaps,marker:n({symbol:s.symbol,opacity:s.opacity,size:s.size,sizeref:s.sizeref,sizemin:s.sizemin,sizemode:s.sizemode,colorbar:s.colorbar,line:n({width:c.width},r("marker.line")),gradient:s.gradient},r("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:a.fillcolor,selected:a.selected,unselected:a.unselected,hoverinfo:n({},o.hoverinfo,{flags:["lon","lat","location","text","name"]})},"calc","nested")},{"../../components/colorscale/attributes":576,"../../components/drawing/attributes":589,"../../lib/extend":682,"../../plot_api/edit_types":723,"../../plots/attributes":737,"../scatter/attributes":1040}],1081:[function(e,t){"use strict";var a=e("fast-isnumeric"),o=e("../../constants/numerical").BADNUM,r=e("../scatter/colorscale_calc"),n=e("../scatter/arrays_to_calcdata"),l=e("../scatter/calc_selection"),s=e("../../lib")._;t.exports=function(e,t){for(var d=Array.isArray(t.locations),c=d?t.locations.length:t._length,p=Array(c),u=0,g;u<c;u++)if(g=p[u]={},d){var h=t.locations[u];g.loc="string"==typeof h?h:null}else{var m=t.lon[u],y=t.lat[u];g.lonlat=a(m)&&a(y)?[+m,+y]:[o,o]}return n(p,t),r(e,t),l(p,t),c&&(p[0].t={labels:{lat:s(e,"lat:")+" ",lon:s(e,"lon:")+" "}}),p}},{"../../constants/numerical":669,"../../lib":692,"../scatter/arrays_to_calcdata":1039,"../scatter/calc_selection":1042,"../scatter/colorscale_calc":1043,"fast-isnumeric":214}],1082:[function(e,t){"use strict";function a(e,t,a){var o=0,r=a("locations"),i,n;return r?(a("locationmode"),o=r.length,o):(i=a("lon")||[],n=a("lat")||[],o=ie(i.length,n.length),t._length=o,o)}var o=e("../../lib"),r=e("../scatter/subtypes"),i=e("../scatter/marker_defaults"),n=e("../scatter/line_defaults"),l=e("../scatter/text_defaults"),s=e("../scatter/fillcolor_defaults"),d=e("./attributes");t.exports=function(e,t,c,p){function u(a,r){return o.coerce(e,t,d,a,r)}var g=a(e,t,u);return g?void(u("text"),u("hovertext"),u("mode"),r.hasLines(t)&&(n(e,t,c,p,u),u("connectgaps")),r.hasMarkers(t)&&i(e,t,c,p,u,{gradient:!0}),r.hasText(t)&&l(e,t,p,u),u("fill"),"none"!==t.fill&&s(e,t,c,u),o.coerceSelectionMarkerOpacity(t,u)):void(t.visible=!1)}},{"../../lib":692,"../scatter/fillcolor_defaults":1049,"../scatter/line_defaults":1053,"../scatter/marker_defaults":1059,"../scatter/subtypes":1064,"../scatter/text_defaults":1065,"./attributes":1080}],1083:[function(e,t){"use strict";t.exports=function(e,t){return e.lon=t.lon,e.lat=t.lat,e.location=t.loc?t.loc:null,e}},{}],1084:[function(e,t){"use strict";function a(e,t,a,o){function i(e){return r.tickText(a,a.c2l(e),"hover").text+"\xB0"}var n=t.hi||e.hoverinfo,d="all"===n?s.hoverinfo.flags:n.split("+"),c=-1!==d.indexOf("location")&&Array.isArray(e.locations),p=-1!==d.indexOf("lon"),u=-1!==d.indexOf("lat"),g=-1!==d.indexOf("text"),h=[];return c?h.push(t.loc):p&&u?h.push("("+i(t.lonlat[0])+", "+i(t.lonlat[1])+")"):p?h.push(o.lon+i(t.lonlat[0])):u&&h.push(o.lat+i(t.lonlat[1])),g&&l(t,e,h),h.join("<br>")}var o=e("../../components/fx"),r=e("../../plots/cartesian/axes"),i=e("../../constants/numerical").BADNUM,n=e("../scatter/get_trace_color"),l=e("../scatter/fill_hover_text"),s=e("./attributes");t.exports=function(e,t,r){var l=e.cd,s=l[0].trace,d=e.xa,c=e.ya,p=e.subplot,u=p.projection.isLonLatOverEdges,g=p.project;if(o.getClosest(l,function(e){var a=e.lonlat;if(a[0]===i)return 1/0;if(u(a))return 1/0;var o=g(a),n=g([t,r]),l=wa(o[0]-n[0]),s=wa(o[1]-n[1]),d=va(3,e.mrc||0);return va(re(l*l+s*s)-d,1-3/d)},e),!1!==e.index){var h=l[e.index],m=h.lonlat,y=[d.c2p(m),c.c2p(m)],f=h.mrc||1;return e.x0=y[0]-f,e.x1=y[0]+f,e.y0=y[1]-f,e.y1=y[1]+f,e.loc=h.loc,e.lon=m[0],e.lat=m[1],e.color=n(s,h),e.extraText=a(s,h,p.mockAxis,l[0].t.labels),[e]}}},{"../../components/fx":608,"../../constants/numerical":669,"../../plots/cartesian/axes":740,"../scatter/fill_hover_text":1048,"../scatter/get_trace_color":1050,"./attributes":1080}],1085:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.colorbar=e("../scatter/marker_colorbar"),a.calc=e("./calc"),a.plot=e("./plot"),a.style=e("./style"),a.styleOnSelect=e("../scatter/style").styleOnSelect,a.hoverPoints=e("./hover"),a.eventData=e("./event_data"),a.selectPoints=e("./select"),a.moduleType="trace",a.name="scattergeo",a.basePlotModule=e("../../plots/geo"),a.categories=["geo","symbols","showLegend","scatter-like"],a.meta={},t.exports=a},{"../../plots/geo":771,"../scatter/marker_colorbar":1058,"../scatter/style":1063,"./attributes":1080,"./calc":1081,"./defaults":1082,"./event_data":1083,"./hover":1084,"./plot":1086,"./select":1087,"./style":1088}],1086:[function(e,t){"use strict";function a(e,t){var a=e[0].trace;if(Array.isArray(a.locations))for(var o=l(a,t),r=a.locationmode,d=0;d<e.length;d++){var c=e[d],p=s(r,c.loc,o);c.lonlat=p?p.properties.ct:[n,n]}}var o=e("d3"),r=e("../../lib"),n=e("../../constants/numerical").BADNUM,l=e("../../lib/topojson_utils").getTopojsonFeatures,s=e("../../lib/geo_location_utils").locationToFeature,d=e("../../lib/geojson_utils"),c=e("../scatter/subtypes"),p=e("./style");t.exports=function(e,t,l){function s(e,t){e.lonlat[0]===n&&o.select(t).remove()}for(var u=0;u<l.length;u++)a(l[u],t.topojson);var g=t.layers.frontplot.select(".scatterlayer"),h=r.makeTraceGroups(g,l,"trace scattergeo");h.selectAll("*").remove(),h.each(function(t){var a=t[0].node3=o.select(this),i=t[0].trace;if(c.hasLines(i)||"none"!==i.fill){var n=d.calcTraceToLineCoords(t),l="none"===i.fill?d.makeLine(n):d.makePolygon(n);a.selectAll("path.js-line").data([{geojson:l,trace:i}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}c.hasMarkers(i)&&a.selectAll("path.point").data(r.identity).enter().append("path").classed("point",!0).each(function(e){s(e,this)}),c.hasText(i)&&a.selectAll("g").data(r.identity).enter().append("g").append("text").each(function(e){s(e,this)}),p(e,t)})}},{"../../constants/numerical":669,"../../lib":692,"../../lib/geo_location_utils":685,"../../lib/geojson_utils":686,"../../lib/topojson_utils":719,"../scatter/subtypes":1064,"./style":1088,d3:148}],1087:[function(e,t){"use strict";var a=e("../scatter/subtypes"),o=e("../../constants/numerical").BADNUM;t.exports=function(e,t){var r=e.cd,n=e.xaxis,l=e.yaxis,s=[],d=r[0].trace,c=!a.hasMarkers(d)&&!a.hasText(d),p,u,g,h,m;if(c)return[];if(!1===t)for(m=0;m<r.length;m++)r[m].selected=0;else for(m=0;m<r.length;m++)p=r[m],u=p.lonlat,u[0]===o||(g=n.c2p(u),h=l.c2p(u),t.contains([g,h],null,m,e)?(s.push({pointNumber:m,lon:u[0],lat:u[1]}),p.selected=1):p.selected=0);return s}},{"../../constants/numerical":669,"../scatter/subtypes":1064}],1088:[function(e,t){"use strict";function a(e,t){var a=t[0].trace,n=t[0].node3;n.style("opacity",t[0].trace.opacity),l(n,a,e),d(n,a,e),n.selectAll("path.js-line").style("fill","none").each(function(e){var t=o.select(this),a=e.trace,n=a.line||{};t.call(i.stroke,n.color).call(r.dashLine,n.dash||"",n.width||0),"none"!==a.fill&&t.call(i.fill,a.fillcolor)})}var o=e("d3"),r=e("../../components/drawing"),i=e("../../components/color"),n=e("../scatter/style"),l=n.stylePoints,d=n.styleText;t.exports=function(e,t){t&&a(e,t)}},{"../../components/color":569,"../../components/drawing":590,"../scatter/style":1063,d3:148}],1089:[function(e,t){"use strict";var a=e("../../plots/attributes"),o=e("../scatter/attributes"),r=e("../../components/colorscale/attributes"),i=e("../../lib/extend").extendFlat,n=e("../../plot_api/edit_types").overrideAll,l=e("./constants").DASHES,s=o.line,d=o.marker,c=d.line,p=t.exports=n({x:o.x,x0:o.x0,dx:o.dx,y:o.y,y0:o.y0,dy:o.dy,text:o.text,hovertext:o.hovertext,textposition:o.textposition,textfont:o.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:s.color,width:s.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:Object.keys(l),dflt:"solid"}},marker:i({},r("marker"),{symbol:d.symbol,size:d.size,sizeref:d.sizeref,sizemin:d.sizemin,sizemode:d.sizemode,opacity:d.opacity,colorbar:d.colorbar,line:i({},r("marker.line"),{width:c.width})}),connectgaps:o.connectgaps,fill:i({},o.fill,{dflt:"none"}),fillcolor:o.fillcolor,selected:{marker:o.selected.marker,textfont:o.selected.textfont},unselected:{marker:o.unselected.marker,textfont:o.unselected.textfont},opacity:a.opacity},"calc","nested");p.x.editType=p.y.editType=p.x0.editType=p.y0.editType="calc+clearAxisTypes",p.hovertemplate=o.hovertemplate},{"../../components/colorscale/attributes":576,"../../lib/extend":682,"../../plot_api/edit_types":723,"../../plots/attributes":737,"../scatter/attributes":1040,"./constants":1090}],1090:[function(e,t){"use strict";t.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],1091:[function(e,t){"use strict";function a(e){var t=e._length,a=e.textfont,o=e.textposition,r=Array.isArray(o)?o:[o],n=a.color,l=a.size,s=a.family,d={},p;for(d.text=e.text,d.opacity=e.opacity,d.font={},d.align=[],d.baseline=[],p=0;p<r.length;p++){var u=r[p].split(/\s+/);switch(u[1]){case"left":d.align.push("right");break;case"right":d.align.push("left");break;default:d.align.push(u[1]);}switch(u[0]){case"top":d.baseline.push("bottom");break;case"bottom":d.baseline.push("top");break;default:d.baseline.push(u[0]);}}if(Array.isArray(n))for(d.color=Array(t),p=0;p<t;p++)d.color[p]=n[p];else d.color=n;if(Array.isArray(l)||Array.isArray(s))for(d.font=Array(t),p=0;p<t;p++){var g=d.font[p]={};g.size=Array.isArray(l)?c(l[p])?l[p]:0:l,g.family=Array.isArray(s)?s[p]:s}else d.font={size:l,family:s};return d}function o(e){var t=e._length,a=e.marker,o={},r=Array.isArray(a.symbol),n=h.isArrayOrTypedArray(a.color),l=h.isArrayOrTypedArray(a.line.color),c=h.isArrayOrTypedArray(a.opacity),p=h.isArrayOrTypedArray(a.size),g=h.isArrayOrTypedArray(a.line.width),m,y;if(r||(y=w.OPEN_RE.test(a.symbol)),r||n||l||c){o.colors=Array(t),o.borderColors=Array(t);var f=x(a,a.opacity,t),b=x(a.line,a.opacity,t);if(!Array.isArray(b[0])){var _=b;for(b=Array(t),m=0;m<t;m++)b[m]=_}if(!Array.isArray(f[0])){var k=f;for(f=Array(t),m=0;m<t;m++)f[m]=k}for(o.colors=f,o.borderColors=b,m=0;m<t;m++){if(r){var T=a.symbol[m];y=w.OPEN_RE.test(T)}y&&(b[m]=f[m].slice(),f[m]=f[m].slice(),f[m][3]=0)}o.opacity=e.opacity}else y?(o.color=u(a.color,"uint8"),o.color[3]=0,o.borderColor=u(a.color,"uint8")):(o.color=u(a.color,"uint8"),o.borderColor=u(a.line.color,"uint8")),o.opacity=e.opacity*a.opacity;if(r)for(o.markers=Array(t),m=0;m<t;m++)o.markers[m]=d(a.symbol[m]);else o.marker=d(a.symbol);var A=v(e),S;if(p||g){var C=o.sizes=Array(t),L=o.borderSizes=Array(t),E=0,z;if(p){for(m=0;m<t;m++)C[m]=A(a.size[m]),E+=C[m];z=E/t}else for(S=A(a.size),m=0;m<t;m++)C[m]=S;if(g)for(m=0;m<t;m++)L[m]=a.line.width[m]/2;else for(S=a.line.width/2,m=0;m<t;m++)L[m]=S;o.sizeAvg=z}else o.size=A(a&&a.size||10),o.borderSizes=A(a.line.width);return o}function r(e,t){var a=e.marker,r={};return t?(t.marker&&t.marker.symbol?r=o(h.extendFlat({},a,t.marker)):t.marker&&(t.marker.size&&(r.size=t.marker.size/2),t.marker.color&&(r.colors=t.marker.color),void 0!==t.marker.opacity&&(r.opacity=t.marker.opacity)),r):r}function n(e,t){var o={};if(!t)return o;if(t.textfont){var r={opacity:1,text:e.text,textposition:e.textposition,textfont:h.extendFlat({},e.textfont)};t.textfont&&h.extendFlat(r.textfont,t.textfont),o=a(r)}return o}function l(e,t){var a={capSize:2*t.width,lineWidth:t.thickness,color:t.color};return t.copy_ystyle&&(a=e.error_y),a}function d(e){if("circle"===e)return null;var t=m.symbolNumber(e),a=m.symbolFuncs[t%100],o=!!m.symbolNoDot[t%100],r=!!m.symbolNoFill[t%100],i=w.DOT_RE.test(e),n,l;return L[e]?L[e]:(n=i&&!o?a(1.1*S)+E:a(S),l=p(n,{w:A,h:A,viewBox:[-S,-S,S,S],stroke:r?C:-C}),L[e]=l,l||null)}var c=e("fast-isnumeric"),p=e("svg-path-sdf"),u=e("color-normalize"),g=e("../../registry"),h=e("../../lib"),m=e("../../components/drawing"),f=e("../../plots/cartesian/axis_ids"),x=e("../../lib/gl_format_color").formatColor,_=e("../scatter/subtypes"),v=e("../scatter/make_bubble_size_func"),w=e("./constants"),k=e("../../constants/interactions").DESELECTDIM,T={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},A=w.SYMBOL_SDF_SIZE,S=w.SYMBOL_SIZE,C=w.SYMBOL_STROKE,L={},E=m.symbolFuncs[0](.05*S);t.exports={style:function(e,t){var s={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},d;if(!0!==t.visible)return s;if(_.hasText(t)&&(s.text=a(t),s.textSel=n(t,t.selected),s.textUnsel=n(t,t.unselected)),_.hasMarkers(t)&&(s.marker=o(t),s.markerSel=r(t,t.selected),s.markerUnsel=r(t,t.unselected),!t.unselected&&Array.isArray(t.marker.opacity))){var c=t.marker.opacity;for(s.markerUnsel.opacity=Array(c.length),d=0;d<c.length;d++)s.markerUnsel.opacity[d]=k*c[d]}if(_.hasLines(t)){s.line={overlay:!0,thickness:t.line.width,color:t.line.color,opacity:t.opacity};var p=(w.DASHES[t.line.dash]||[1]).slice();for(d=0;d<p.length;++d)p[d]*=t.line.width;s.line.dashes=p}return t.error_x&&t.error_x.visible&&(s.errorX=l(t,t.error_x)),t.error_y&&t.error_y.visible&&(s.errorY=l(t,t.error_y)),!t.fill||"none"===t.fill||(s.fill={closed:!0,fill:t.fillcolor,thickness:0}),s},markerStyle:o,markerSelection:r,linePositions:function(e,t,a){var o=a.length,r=o/2,n,l;if(_.hasLines(t)&&r)if("hv"===t.line.shape){for(n=[],l=0;l<r-1;l++)isNaN(a[2*l])||isNaN(a[2*l+1])?n.push(NaN,NaN,NaN,NaN):(n.push(a[2*l],a[2*l+1]),isNaN(a[2*l+2])||isNaN(a[2*l+3])?n.push(NaN,NaN):n.push(a[2*l+2],a[2*l+1]));n.push(a[o-2],a[o-1])}else if("hvh"===t.line.shape){for(n=[],l=0;l<r-1;l++)if(isNaN(a[2*l])||isNaN(a[2*l+1])||isNaN(a[2*l+2])||isNaN(a[2*l+3]))isNaN(a[2*l])||isNaN(a[2*l+1])?n.push(NaN,NaN):n.push(a[2*l],a[2*l+1]),n.push(NaN,NaN);else{var s=(a[2*l]+a[2*l+2])/2;n.push(a[2*l],a[2*l+1],s,a[2*l+1],s,a[2*l+3])}n.push(a[o-2],a[o-1])}else if("vhv"===t.line.shape){for(n=[],l=0;l<r-1;l++)if(isNaN(a[2*l])||isNaN(a[2*l+1])||isNaN(a[2*l+2])||isNaN(a[2*l+3]))isNaN(a[2*l])||isNaN(a[2*l+1])?n.push(NaN,NaN):n.push(a[2*l],a[2*l+1]),n.push(NaN,NaN);else{var d=(a[2*l+1]+a[2*l+3])/2;n.push(a[2*l],a[2*l+1],a[2*l],d,a[2*l+2],d)}n.push(a[o-2],a[o-1])}else if("vh"===t.line.shape){for(n=[],l=0;l<r-1;l++)isNaN(a[2*l])||isNaN(a[2*l+1])?n.push(NaN,NaN,NaN,NaN):(n.push(a[2*l],a[2*l+1]),isNaN(a[2*l+2])||isNaN(a[2*l+3])?n.push(NaN,NaN):n.push(a[2*l],a[2*l+3]));n.push(a[o-2],a[o-1])}else n=a;var c=!1;for(l=0;l<n.length;l++)if(isNaN(n[l])){c=!0;break}var p=c||n.length>w.TOO_MANY_POINTS?"rect":_.hasMarkers(t)?"rect":"round";if(c&&t.connectgaps){var u=n[0],g=n[1];for(l=0;l<n.length;l+=2)isNaN(n[l])||isNaN(n[l+1])?(n[l]=u,n[l+1]=g):(u=n[l],g=n[l+1])}return{join:p,positions:n}},errorBarPositions:function(e,t,a,o,r){function i(e,o){var r=o._id.charAt(0),l=t["error_"+r];if(l&&l.visible&&("linear"===o.type||"log"===o.type)){for(var s=n(l),u={x:0,y:1}[r],g={x:[0,1,2,3],y:[2,3,0,1]}[r],h=new Float64Array(4*d),m=1/0,y=-Infinity,f=0,x=0,b;f<d;f++,x+=4)if(b=e[f],c(b)){var _=a[2*f+u],v=s(b,f),w=v[0],k=v[1];if(c(w)&&c(k)){var T=b-w,A=b+k;h[x+g[0]]=_-o.c2l(T),h[x+g[1]]=o.c2l(A)-_,h[x+g[2]]=0,h[x+g[3]]=0,m=ie(m,b-w),y=va(y,b+k)}}p[r]={positions:a,errors:h,_bnds:[m,y]}}}var n=g.getComponentMethod("errorbars","makeComputeError"),l=f.getFromId(e,t.xaxis),s=f.getFromId(e,t.yaxis),d=a.length/2,p={};return i(o,l),i(r,s),p},textPosition:function(e,t,o,r){var n=t._length,l={},s;if(_.hasMarkers(t)){var d=o.font,c=o.align,p=o.baseline;for(l.offset=Array(n),s=0;s<n;s++){var u=r.sizes?r.sizes[s]:r.size,g=Array.isArray(d)?d[s].size:d.size,h=Array.isArray(c)?1<c.length?c[s]:c[0]:c,a=Array.isArray(p)?1<p.length?p[s]:p[0]:p,m=T[h],y=T[a],f=u?u/.8+1:0;l.offset[s]=[m*f/g,(-y*f-.5*y)/g]}}return l}}},{"../../components/drawing":590,"../../constants/interactions":668,"../../lib":692,"../../lib/gl_format_color":689,"../../plots/cartesian/axis_ids":743,"../../registry":823,"../scatter/make_bubble_size_func":1057,"../scatter/subtypes":1064,"./constants":1090,"color-normalize":108,"fast-isnumeric":214,"svg-path-sdf":511}],1092:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../registry"),r=e("./attributes"),i=e("../scatter/constants"),n=e("../scatter/subtypes"),l=e("../scatter/xy_defaults"),s=e("../scatter/marker_defaults"),d=e("../scatter/line_defaults"),c=e("../scatter/fillcolor_defaults"),p=e("../scatter/text_defaults");t.exports=function(e,t,u,g){function h(o,i){return a.coerce(e,t,r,o,i)}var m=!!e.marker&&/-open/.test(e.marker.symbol),y=n.isBubble(e),f=l(e,t,g,h);if(!f)return void(t.visible=!1);var x=f<i.PTS_LINESONLY?"lines+markers":"lines";h("text"),h("hovertext"),h("hovertemplate"),h("mode",x),n.hasLines(t)&&(h("connectgaps"),d(e,t,u,g,h),h("line.shape")),n.hasMarkers(t)&&(s(e,t,u,g,h),h("marker.line.width",m||y?1:0)),n.hasText(t)&&p(e,t,g,h),h("fill"),"none"!==t.fill&&c(e,t,u,h);var b=o.getComponentMethod("errorbars","supplyDefaults");b(e,t,u,{axis:"y"}),b(e,t,u,{axis:"x",inherit:"y"}),a.coerceSelectionMarkerOpacity(t,h)}},{"../../lib":692,"../../registry":823,"../scatter/constants":1044,"../scatter/fillcolor_defaults":1049,"../scatter/line_defaults":1053,"../scatter/marker_defaults":1059,"../scatter/subtypes":1064,"../scatter/text_defaults":1065,"../scatter/xy_defaults":1066,"./attributes":1089}],1093:[function(e,t){"use strict";function a(e,t,a){var o=e._extremes[t._id],r=v(t,a._bnds,{padded:!0});o.min=o.min.concat(r.min),o.max=o.max.concat(r.max)}function o(e,t,a,o,r,i){var n=D.style(e,a);if(n.marker&&(n.marker.positions=o),n.line&&1<o.length&&f.extendFlat(n.line,D.linePositions(e,a,o)),n.errorX||n.errorY){var l=D.errorBarPositions(e,a,o,r,i);n.errorX&&f.extendFlat(n.errorX,l.x),n.errorY&&f.extendFlat(n.errorY,l.y)}return n.text&&(f.extendFlat(n.text,{positions:o},D.textPosition(e,a,n.text,n.marker)),f.extendFlat(n.textSel,{positions:o},D.textPosition(e,a,n.text,n.markerSel)),f.extendFlat(n.textUnsel,{positions:o},D.textPosition(e,a,n.text,n.markerUnsel))),n}function r(e,t){var a=t._scene,o={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[]},r={selectBatch:null,unselectBatch:null,fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:null};return t._scene||(a=t._scene={},a.init=function(){f.extendFlat(a,r,o)},a.init(),a.update=function(e){var t=f.repeat(e,a.count);if(a.fill2d&&a.fill2d.update(t),a.scatter2d&&a.scatter2d.update(t),a.line2d&&a.line2d.update(t),a.error2d&&a.error2d.update(t.concat(t)),a.select2d&&a.select2d.update(t),a.glText)for(var o=0;o<a.count;o++)a.glText[o].update(e)},a.draw=function(){for(var e=a.count,t=a.fill2d,o=a.error2d,r=a.line2d,n=a.scatter2d,l=a.glText,s=a.select2d,d=a.selectBatch,c=a.unselectBatch,p=0;p<e;p++)t&&a.fillOrder[p]&&t.draw(a.fillOrder[p]),r&&a.lineOptions[p]&&r.draw(p),o&&(a.errorXOptions[p]&&o.draw(p),a.errorYOptions[p]&&o.draw(p+e)),n&&a.markerOptions[p]&&(!d||!d[p])&&n.draw(p),l[p]&&a.textOptions[p]&&l[p].render();n&&s&&d&&(s.draw(d),n.draw(c)),a.dirty=!1},a.destroy=function(){a.fill2d&&a.fill2d.destroy&&a.fill2d.destroy(),a.scatter2d&&a.scatter2d.destroy&&a.scatter2d.destroy(),a.error2d&&a.error2d.destroy&&a.error2d.destroy(),a.line2d&&a.line2d.destroy&&a.line2d.destroy(),a.select2d&&a.select2d.destroy&&a.select2d.destroy(),a.glText&&a.glText.forEach(function(e){e.destroy&&e.destroy()}),a.lineOptions=null,a.fillOptions=null,a.markerOptions=null,a.markerSelectedOptions=null,a.markerUnselectedOptions=null,a.errorXOptions=null,a.errorYOptions=null,a.textOptions=null,a.textSelectedOptions=null,a.textUnselectedOptions=null,a.selectBatch=null,a.unselectBatch=null,t._scene=null}),a.dirty||f.extendFlat(a,o),a}function n(e,t,a){var o=e._size,r=e.width,i=e.height;return[o.l+t.domain[0]*o.w,o.b+a.domain[0]*o.h,r-o.r-(1-t.domain[1])*o.w,i-o.t-(1-a.domain[1])*o.h]}function l(e,t,a,o){var r=e.xa,i=e.ya,n=e.distance,l=e.dxy,s=e.index,d={pointNumber:s,x:t[s],y:a[s]};d.tx=Array.isArray(o.text)?o.text[s]:o.text,d.htx=Array.isArray(o.hovertext)?o.hovertext[s]:o.hovertext,d.data=Array.isArray(o.customdata)?o.customdata[s]:o.customdata,d.tp=Array.isArray(o.textposition)?o.textposition[s]:o.textposition;var c=o.textfont;c&&(d.ts=Array.isArray(c.size)?c.size[s]:c.size,d.tc=Array.isArray(c.color)?c.color[s]:c.color,d.tf=Array.isArray(c.family)?c.family[s]:c.family);var p=o.marker;p&&(d.ms=f.isArrayOrTypedArray(p.size)?p.size[s]:p.size,d.mo=f.isArrayOrTypedArray(p.opacity)?p.opacity[s]:p.opacity,d.mx=Array.isArray(p.symbol)?p.symbol[s]:p.symbol,d.mc=f.isArrayOrTypedArray(p.color)?p.color[s]:p.color);var u=p&&p.line;u&&(d.mlc=Array.isArray(u.color)?u.color[s]:u.color,d.mlw=f.isArrayOrTypedArray(u.width)?u.width[s]:u.width);var g=p&&p.gradient;g&&"none"!==g.type&&(d.mgt=Array.isArray(g.type)?g.type[s]:g.type,d.mgc=Array.isArray(g.color)?g.color[s]:g.color);var h=r.c2p(d.x,!0),y=i.c2p(d.y,!0),x=d.mrc||1,b=o.hoverlabel;b&&(d.hbg=Array.isArray(b.bgcolor)?b.bgcolor[s]:b.bgcolor,d.hbc=Array.isArray(b.bordercolor)?b.bordercolor[s]:b.bordercolor,d.hts=Array.isArray(b.font.size)?b.font.size[s]:b.font.size,d.htc=Array.isArray(b.font.color)?b.font.color[s]:b.font.color,d.htf=Array.isArray(b.font.family)?b.font.family[s]:b.font.family,d.hnl=Array.isArray(b.namelength)?b.namelength[s]:b.namelength);var _=o.hoverinfo;_&&(d.hi=Array.isArray(_)?_[s]:_);var v=o.hovertemplate;v&&(d.ht=Array.isArray(v)?v[s]:v);var w={};return w[e.index]=d,f.extendFlat(e,{color:z(o,d),x0:h-x,x1:h+x,xLabelVal:d.x,y0:y-x,y1:y+x,yLabelVal:d.y,cd:w,distance:n,spikeDistance:l,hovertemplate:d.ht}),d.htx?e.text=d.htx:d.tx?e.text=d.tx:o.text&&(e.text=o.text),I(d,o,e),m.getComponentMethod("errorbars","hoverInfo")(d,o,e),e}function s(e){var t=e[0],a=t.trace,o=t.t,r=o._scene,n=o.index,l=r.selectBatch[n],s=r.unselectBatch[n],d=r.textOptions[n],c=r.textSelectedOptions[n]||{},p=r.textUnselectedOptions[n]||{},u=f.extendFlat({},d),g,h;if(l&&s){var m=c.color,y=p.color,x=d.color,b=Array.isArray(x);for(u.color=Array(a._length),g=0;g<l.length;g++)h=l[g],u.color[h]=m||(b?x[h]:x);for(g=0;g<s.length;g++){h=s[g];var _=b?x[h]:x;u.color[h]=y?y:m?_:w.addOpacity(_,R)}}r.glText[n].update(u)}var d=e("regl-scatter2d"),c=e("regl-line2d"),p=e("regl-error2d"),u=e("point-cluster"),g=e("array-range"),h=e("gl-text"),m=e("../../registry"),f=e("../../lib"),b=e("../../lib/prepare_regl"),_=e("../../plots/cartesian/axis_ids"),v=e("../../plots/cartesian/autorange").findExtremes,w=e("../../components/color"),k=e("../scatter/subtypes"),T=e("../scatter/calc"),A=T.calcMarkerSize,S=T.calcAxisExpansion,C=T.setFirstScatter,L=e("../scatter/colorscale_calc"),E=e("../scatter/link_traces"),z=e("../scatter/get_trace_color"),I=e("../scatter/fill_hover_text"),D=e("./convert"),P=e("../../constants/numerical").BADNUM,O=e("./constants").TOO_MANY_POINTS,R=e("../../constants/interactions").DESELECTDIM;t.exports={moduleType:"trace",name:"scattergl",basePlotModule:e("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),crossTraceDefaults:e("../scatter/cross_trace_defaults"),colorbar:e("../scatter/marker_colorbar"),calc:function(e,t){var n=e._fullLayout,l=_.getFromId(e,t.xaxis),s=_.getFromId(e,t.yaxis),d=n._plots[t.xaxis+t.yaxis],c=t._length,p=2*c,g={},h=l.makeCalcdata(t,"x"),m=s.makeCalcdata(t,"y"),y=Array(p),f,x,b;for(f=0;f<c;f++)x=h[f],b=m[f],y[2*f]=x===P?NaN:x,y[2*f+1]=b===P?NaN:b;if("log"===l.type)for(f=0;f<p;f+=2)y[f]=l.c2l(y[f]);if("log"===s.type)for(f=1;f<p;f+=2)y[f]=s.c2l(y[f]);if("log"!==l.type&&"log"!==s.type)g.tree=u(y);else{var v=g.ids=Array(c);for(f=0;f<c;f++)v[f]=f}L(e,t);var w=o(e,d,t,y,h,m),k=r(e,d);C(n,t);var T;return c<O?T=A(t,c):w.marker&&(T=2*(w.marker.sizeAvg||va(w.marker.size,3))),S(e,t,l,s,h,m,T),w.errorX&&a(t,l,w.errorX),w.errorY&&a(t,s,w.errorY),w.fill&&!k.fill2d&&(k.fill2d=!0),w.marker&&!k.scatter2d&&(k.scatter2d=!0),w.line&&!k.line2d&&(k.line2d=!0),(w.errorX||w.errorY)&&!k.error2d&&(k.error2d=!0),w.text&&!k.glText&&(k.glText=!0),w.marker&&c>=O&&(w.marker.cluster=g.tree),k.lineOptions.push(w.line),k.errorXOptions.push(w.errorX),k.errorYOptions.push(w.errorY),k.fillOptions.push(w.fill),k.markerOptions.push(w.marker),k.markerSelectedOptions.push(w.markerSel),k.markerUnselectedOptions.push(w.markerUnsel),k.textOptions.push(w.text),k.textSelectedOptions.push(w.textSel),k.textUnselectedOptions.push(w.textUnsel),g._scene=k,g.index=k.count,g.x=h,g.y=m,g.positions=y,k.count++,[{x:!1,y:!1,t:g,trace:t}]},plot:function(e,t,a){if(a.length){var o=e._fullLayout,r=t._scene,l=t.xaxis,u=t.yaxis,g,m;if(r){var _=b(e,["ANGLE_instanced_arrays","OES_element_index_uint"]);if(!_)return void r.init();var v=o._glcanvas.data()[0].regl;if(E(e,t,a),r.dirty){if(!0===r.error2d&&(r.error2d=p(v)),!0===r.line2d&&(r.line2d=c(v)),!0===r.scatter2d&&(r.scatter2d=d(v)),!0===r.fill2d&&(r.fill2d=c(v)),!0===r.glText)for(r.glText=Array(r.count),g=0;g<r.count;g++)r.glText[g]=new h(v);if(r.glText)for(g=0;g<r.count;g++)r.glText[g].update(r.textOptions[g]);if(r.line2d&&(r.line2d.update(r.lineOptions),r.lineOptions=r.lineOptions.map(function(e){if(e&&e.positions){for(var t=e.positions,a=0;a<t.length&&(isNaN(t[a])||isNaN(t[a+1]));)a+=2;for(var o=t.length-2;o>a&&(isNaN(t[o])||isNaN(t[o+1]));)o-=2;e.positions=t.slice(a,o+2)}return e}),r.line2d.update(r.lineOptions)),r.error2d){var w=(r.errorXOptions||[]).concat(r.errorYOptions||[]);r.error2d.update(w)}r.scatter2d&&r.scatter2d.update(r.markerOptions),r.fillOrder=f.repeat(null,r.count),r.fill2d&&(r.fillOptions=r.fillOptions.map(function(e,t){var o=a[t];if(e&&o&&o[0]&&o[0].trace){var n=o[0],l=n.trace,s=n.t,d=r.lineOptions[t],c=[],p,u;l._ownfill&&c.push(t),l._nexttrace&&c.push(t+1),c.length&&(r.fillOrder[t]=c);var g=[],h=d&&d.positions||s.positions,m,y;if("tozeroy"===l.fill){for(m=0;m<h.length&&isNaN(h[m+1]);)m+=2;for(y=h.length-2;y>m&&isNaN(h[y+1]);)y-=2;0!==h[m+1]&&(g=[h[m],0]),g=g.concat(h.slice(m,y+2)),0!==h[y+1]&&(g=g.concat([h[y],0]))}else if("tozerox"===l.fill){for(m=0;m<h.length&&isNaN(h[m]);)m+=2;for(y=h.length-2;y>m&&isNaN(h[y]);)y-=2;0!==h[m]&&(g=[0,h[m+1]]),g=g.concat(h.slice(m,y+2)),0!==h[y]&&(g=g.concat([0,h[y+1]]))}else if("toself"===l.fill||"tonext"===l.fill){for(g=[],p=0,u=0;u<h.length;u+=2)(isNaN(h[u])||isNaN(h[u+1]))&&(g=g.concat(h.slice(p,u)),g.push(h[p],h[p+1]),p=u+2);g=g.concat(h.slice(p)),p&&g.push(h[p],h[p+1])}else{var f=l._nexttrace;if(f){var x=r.lineOptions[t+1];if(x){var b=x.positions;if("tonexty"===l.fill){for(g=h.slice(),t=ea(b.length/2);t--;){var _=b[2*t],v=b[2*t+1];isNaN(_)||isNaN(v)||g.push(_,v)}e.fill=f.fillcolor}}}}if(l._prevtrace&&"tonext"===l._prevtrace.fill){var w=r.lineOptions[t-1].positions,k=g.length/2;p=k;var T=[p];for(u=0;u<w.length;u+=2)(isNaN(w[u])||isNaN(w[u+1]))&&(T.push(u/2+k+1),p=u+2);g=g.concat(w),e.hole=T}return e.fillmode=l.fill,e.opacity=l.opacity,e.positions=g,e}}),r.fill2d.update(r.fillOptions))}r.selectBatch=null,r.unselectBatch=null;var k=o.dragmode,T="lasso"===k||"select"===k,A=-1<o.clickmode.indexOf("select");for(g=0;g<a.length;g++){var S=a[g][0],C=S.trace,L=S.t,z=L.index,I=C._length,D=L.x,x=L.y;if(C.selectedpoints||T||A){if(T||(T=!0),r.selectBatch||(r.selectBatch=[],r.unselectBatch=[]),C.selectedpoints){var y=r.selectBatch[z]=f.selIndices2selPoints(C),P={};for(m=0;m<y.length;m++)P[y[m]]=1;var O=[];for(m=0;m<I;m++)P[m]||O.push(m);r.unselectBatch[z]=O}var R=L.xpx=Array(I),M=L.ypx=Array(I);for(m=0;m<I;m++)R[m]=l.c2p(D[m]),M[m]=u.c2p(x[m])}else L.xpx=L.ypx=null}T?(!r.select2d&&(r.select2d=d(o._glcanvas.data()[1].regl)),r.scatter2d&&r.selectBatch&&r.selectBatch.length&&r.scatter2d.update(r.markerUnselectedOptions.map(function(e,t){return r.selectBatch[t]?e:null})),r.select2d&&(r.select2d.update(r.markerOptions),r.select2d.update(r.markerSelectedOptions)),r.glText&&a.forEach(function(e){e&&e[0]&&e[0].trace&&s(e)})):r.scatter2d&&r.scatter2d.update(r.markerOptions);var B={viewport:n(o,l,u),range:[(l._rl||l.range)[0],(u._rl||u.range)[0],(l._rl||l.range)[1],(u._rl||u.range)[1]]},F=f.repeat(B,r.count);r.fill2d&&r.fill2d.update(F),r.line2d&&r.line2d.update(F),r.error2d&&r.error2d.update(F.concat(F)),r.scatter2d&&r.scatter2d.update(F),r.select2d&&r.select2d.update(F),r.glText&&r.glText.forEach(function(e){e.update(B)})}}},hoverPoints:function(e,t,a,o){var r=e.cd,n=r[0].t,s=r[0].trace,d=e.xa,c=e.ya,p=n.x,u=n.y,g=d.c2p(t),h=c.c2p(a),m=e.distance,y;if(n.tree){var f=d.p2c(g-m),x=d.p2c(g+m),b=c.p2c(h-m),_=c.p2c(h+m);y="x"===o?n.tree.range(ie(f,x),ie(c._rl[0],c._rl[1]),va(f,x),va(c._rl[0],c._rl[1])):n.tree.range(ie(f,x),ie(b,_),va(f,x),va(b,_))}else if(n.ids)y=n.ids;else return[e];var v=m,w,k,T,A,S,C,L,E;if("x"===o)for(A=0;A<y.length;A++)k=p[y[A]],S=wa(d.c2p(k)-g),S<v&&(v=S,C=c.c2p(u[y[A]])-h,E=re(S*S+C*C),w=y[A]);else for(A=0;A<y.length;A++)k=p[y[A]],T=u[y[A]],S=d.c2p(k)-g,C=c.c2p(T)-h,L=re(S*S+C*C),L<v&&(v=E=L,w=y[A]);return(e.index=w,e.distance=v,e.dxy=E,void 0===w)?[e]:(l(e,p,u,s),[e])},selectPoints:function(e,t){var a=e.cd,o=[],r=a[0].trace,n=a[0].t,l=r._length,d=n.x,c=n.y,p=n._scene;if(!p)return o;var u=k.hasText(r),h=k.hasMarkers(r);if(!0!==r.visible||!h&&!u)return o;var m=null,y=null,f;if(!1!==t&&!t.degenerate)for(m=[],y=[],f=0;f<l;f++)t.contains([n.xpx[f],n.ypx[f]],!1,f,e)?(m.push(f),o.push({pointNumber:f,x:d[f],y:c[f]})):y.push(f);else y=g(l);if(p.selectBatch||(p.selectBatch=[],p.unselectBatch=[]),!p.selectBatch[n.index]){for(f=0;f<p.count;f++)p.selectBatch[f]=[],p.unselectBatch[f]=[];h&&p.scatter2d.update(p.markerUnselectedOptions)}return p.selectBatch[n.index]=m,p.unselectBatch[n.index]=y,u&&s(a),o},sceneUpdate:r,calcHover:l,meta:{}}},{"../../components/color":569,"../../constants/interactions":668,"../../constants/numerical":669,"../../lib":692,"../../lib/prepare_regl":705,"../../plots/cartesian":752,"../../plots/cartesian/autorange":739,"../../plots/cartesian/axis_ids":743,"../../registry":823,"../scatter/calc":1041,"../scatter/colorscale_calc":1043,"../scatter/cross_trace_defaults":1046,"../scatter/fill_hover_text":1048,"../scatter/get_trace_color":1050,"../scatter/link_traces":1056,"../scatter/marker_colorbar":1058,"../scatter/subtypes":1064,"./attributes":1089,"./constants":1090,"./convert":1091,"./defaults":1092,"array-range":55,"gl-text":304,"point-cluster":452,"regl-error2d":473,"regl-line2d":474,"regl-scatter2d":475}],1094:[function(e,t){"use strict";var a=e("../scattergeo/attributes"),o=e("../scatter/attributes"),r=e("../../plots/mapbox/layout_attributes"),i=e("../../plots/attributes"),n=e("../../components/colorbar/attributes"),l=e("../../lib/extend").extendFlat,s=e("../../plot_api/edit_types").overrideAll,d=a.line,c=a.marker;t.exports=s({lon:a.lon,lat:a.lat,mode:l({},o.mode,{dflt:"markers"}),text:l({},o.text,{}),hovertext:l({},o.hovertext,{}),line:{color:d.color,width:d.width},connectgaps:o.connectgaps,marker:{symbol:{valType:"string",dflt:"circle",arrayOk:!0},opacity:c.opacity,size:c.size,sizeref:c.sizeref,sizemin:c.sizemin,sizemode:c.sizemode,color:c.color,colorscale:c.colorscale,cauto:c.cauto,cmax:c.cmax,cmin:c.cmin,autocolorscale:c.autocolorscale,reversescale:c.reversescale,showscale:c.showscale,colorbar:n},fill:a.fill,fillcolor:o.fillcolor,textfont:r.layers.symbol.textfont,textposition:r.layers.symbol.textposition,selected:{marker:o.selected.marker},unselected:{marker:o.unselected.marker},hoverinfo:l({},i.hoverinfo,{flags:["lon","lat","text","name"]})},"calc","nested")},{"../../components/colorbar/attributes":570,"../../lib/extend":682,"../../plot_api/edit_types":723,"../../plots/attributes":737,"../../plots/mapbox/layout_attributes":800,"../scatter/attributes":1040,"../scattergeo/attributes":1080}],1095:[function(e,t){"use strict";function a(){return{geojson:u.makeBlank(),layout:{visibility:"none"},paint:{}}}function o(e){function t(e){return a.opacity*e}var a=e[0].trace,o=a.marker,r=a.selectedpoints,n=c.isArrayOrTypedArray(o.color),l=c.isArrayOrTypedArray(o.size),p=c.isArrayOrTypedArray(o.opacity),u,y;n&&(g.hasColorscale(a,"marker")?y=g.makeColorScaleFunc(g.extractScale(o,{cLetter:"c"})):y=c.identity);var f;l&&(f=m(a));var x;p&&(x=function(e){var a=d(e)?+c.constrain(e,0,1):0;return t(a)});var b=[];for(u=0;u<e.length;u++){var _=e[u],v=_.lonlat;if(!s(v)){var w={};y&&(w.mcc=_.mcc=y(_.mc)),f&&(w.mrc=_.mrc=f(_.ms)),x&&(w.mo=x(_.mo)),r&&(w.selected=_.selected||0),b.push({type:"Feature",geometry:{type:"Point",coordinates:v},properties:w})}}var k;if(r)for(k=h.makeSelectedPointStyleFns(a),u=0;u<b.length;u++){var T=b[u].properties;k.selectedOpacityFn&&(T.mo=t(k.selectedOpacityFn(T))),k.selectedColorFn&&(T.mcc=k.selectedColorFn(T)),k.selectedSizeFn&&(T.mrc=k.selectedSizeFn(T))}return{geojson:{type:"FeatureCollection",features:b},mcc:n||k&&k.selectedColorFn?{type:"identity",property:"mcc"}:o.color,mrc:l||k&&k.selectedSizeFn?{type:"identity",property:"mrc"}:function(e){return e/2}(o.size),mo:p||k&&k.selectedOpacityFn?{type:"identity",property:"mo"}:t(o.opacity)}}function r(e){for(var t=e[0].trace,a=t.marker||{},o=a.symbol,r=t.text,d="circle"===o?l:n(o),c=y.hasText(t)?n(r):l,p=[],u=0,g;u<e.length;u++)g=e[u],s(g.lonlat)||p.push({type:"Feature",geometry:{type:"Point",coordinates:g.lonlat},properties:{symbol:d(g.mx),text:c(g.tx)}});return{type:"FeatureCollection",features:p}}function n(e){return c.isArrayOrTypedArray(e)?function(e){return e}:e?function(){return e}:l}function l(){return""}function s(e){return e[0]===p}var d=e("fast-isnumeric"),c=e("../../lib"),p=e("../../constants/numerical").BADNUM,u=e("../../lib/geojson_utils"),g=e("../../components/colorscale"),h=e("../../components/drawing"),m=e("../scatter/make_bubble_size_func"),y=e("../scatter/subtypes"),f=e("../../plots/mapbox/convert_text_opts");t.exports=function(e){var t=e[0].trace,i=!0===t.visible,n="none"!==t.fill,l=y.hasLines(t),s=y.hasMarkers(t),d=y.hasText(t),p=s&&"circle"===t.marker.symbol,g=s&&"circle"!==t.marker.symbol,h=a(),m=a(),x=a(),b=a(),_={fill:h,line:m,circle:x,symbol:b};if(!i)return _;var v;if((n||l)&&(v=u.calcTraceToLineCoords(e)),n&&(h.geojson=u.makePolygon(v),h.layout.visibility="visible",c.extendFlat(h.paint,{"fill-color":t.fillcolor})),l&&(m.geojson=u.makeLine(v),m.layout.visibility="visible",c.extendFlat(m.paint,{"line-width":t.line.width,"line-color":t.line.color,"line-opacity":t.opacity})),p){var w=o(e);x.geojson=w.geojson,x.layout.visibility="visible",c.extendFlat(x.paint,{"circle-color":w.mcc,"circle-radius":w.mrc,"circle-opacity":w.mo})}if((g||d)&&(b.geojson=r(e),c.extendFlat(b.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),g&&(c.extendFlat(b.layout,{"icon-size":t.marker.size/10}),c.extendFlat(b.paint,{"icon-opacity":t.opacity*t.marker.opacity,"icon-color":t.marker.color})),d)){var k=(t.marker||{}).size,T=f(t.textposition,k);c.extendFlat(b.layout,{"text-size":t.textfont.size,"text-anchor":T.anchor,"text-offset":T.offset}),c.extendFlat(b.paint,{"text-color":t.textfont.color,"text-opacity":t.opacity})}return _}},{"../../components/colorscale":581,"../../components/drawing":590,"../../constants/numerical":669,"../../lib":692,"../../lib/geojson_utils":686,"../../plots/mapbox/convert_text_opts":797,"../scatter/make_bubble_size_func":1057,"../scatter/subtypes":1064,"fast-isnumeric":214}],1096:[function(e,t){"use strict";function a(e,t,a){var o=a("lon")||[],r=a("lat")||[],i=ie(o.length,r.length);return t._length=i,i}var o=e("../../lib"),r=e("../scatter/subtypes"),i=e("../scatter/marker_defaults"),n=e("../scatter/line_defaults"),l=e("../scatter/text_defaults"),s=e("../scatter/fillcolor_defaults"),d=e("./attributes");t.exports=function(e,t,c,p){function u(a,r){return o.coerce(e,t,d,a,r)}var g=a(e,t,u);if(!g)return void(t.visible=!1);if(u("text"),u("hovertext"),u("mode"),r.hasLines(t)&&(n(e,t,c,p,u,{noDash:!0}),u("connectgaps")),r.hasMarkers(t)){i(e,t,c,p,u,{noLine:!0});var h=t.marker;"circle"!==h.symbol&&(o.isArrayOrTypedArray(h.size)&&(h.size=h.size[0]),o.isArrayOrTypedArray(h.color)&&(h.color=h.color[0]))}r.hasText(t)&&l(e,t,p,u,{noSelect:!0}),u("fill"),"none"!==t.fill&&s(e,t,c,u),o.coerceSelectionMarkerOpacity(t,u)}},{"../../lib":692,"../scatter/fillcolor_defaults":1049,"../scatter/line_defaults":1053,"../scatter/marker_defaults":1059,"../scatter/subtypes":1064,"../scatter/text_defaults":1065,"./attributes":1094}],1097:[function(e,t){"use strict";t.exports=function(e,t){return e.lon=t.lon,e.lat=t.lat,e}},{}],1098:[function(e,t){"use strict";function a(e,t,a){function o(e){return e+"\xB0"}var r=t.hi||e.hoverinfo,i=r.split("+"),l=-1!==i.indexOf("all"),s=-1!==i.indexOf("lon"),d=-1!==i.indexOf("lat"),c=t.lonlat,p=[];return l||s&&d?p.push("("+o(c[0])+", "+o(c[1])+")"):s?p.push(a.lon+o(c[0])):d&&p.push(a.lat+o(c[1])),(l||-1!==i.indexOf("text"))&&n(t,e,p),p.join("<br>")}var o=e("../../components/fx"),r=e("../../lib"),i=e("../scatter/get_trace_color"),n=e("../scatter/fill_hover_text"),l=e("../../constants/numerical").BADNUM;t.exports=function(e,t,n){var s=e.cd,d=s[0].trace,c=e.xa,p=e.ya,u=e.subplot,g=0<=t?ea((t+180)/360):ae((t-180)/360),h=360*g;if(o.getClosest(s,function(e){var a=e.lonlat;if(a[0]===l)return 1/0;var o=r.modHalf(a[0],360),i=a[1],s=u.project([o,i]),d=s.x-c.c2p([t-h,i]),g=s.y-p.c2p([o,n]),m=va(3,e.mrc||0);return va(re(d*d+g*g)-m,1-3/m)},e),!1!==e.index){var m=s[e.index],y=m.lonlat,f=[r.modHalf(y[0],360)+h,y[1]],x=c.c2p(f),b=p.c2p(f),_=m.mrc||1;return e.x0=x-_,e.x1=x+_,e.y0=b-_,e.y1=b+_,e.color=i(d,m),e.extraText=a(d,m,s[0].t.labels),[e]}}},{"../../components/fx":608,"../../constants/numerical":669,"../../lib":692,"../scatter/fill_hover_text":1048,"../scatter/get_trace_color":1050}],1099:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.colorbar=e("../scatter/marker_colorbar"),a.calc=e("../scattergeo/calc"),a.plot=e("./plot"),a.hoverPoints=e("./hover"),a.eventData=e("./event_data"),a.selectPoints=e("./select"),a.style=function(e,t){if(t){var a=t[0].trace;a._glTrace.update(t)}},a.moduleType="trace",a.name="scattermapbox",a.basePlotModule=e("../../plots/mapbox"),a.categories=["mapbox","gl","symbols","showLegend","scatterlike"],a.meta={},t.exports=a},{"../../plots/mapbox":798,"../scatter/marker_colorbar":1058,"../scattergeo/calc":1081,"./attributes":1094,"./defaults":1096,"./event_data":1097,"./hover":1098,"./plot":1100,"./select":1101}],1100:[function(e,t){"use strict";function a(e,t){this.subplot=e,this.uid=t,this.sourceIds={fill:t+"-source-fill",line:t+"-source-line",circle:t+"-source-circle",symbol:t+"-source-symbol"},this.layerIds={fill:t+"-layer-fill",line:t+"-layer-line",circle:t+"-layer-circle",symbol:t+"-layer-symbol"},this.order=["fill","line","circle","symbol"]}var o=e("./convert"),r=a.prototype;r.addSource=function(e,t){this.subplot.map.addSource(this.sourceIds[e],{type:"geojson",data:t.geojson})},r.setSourceData=function(e,t){this.subplot.map.getSource(this.sourceIds[e]).setData(t.geojson)},r.addLayer=function(e,t){this.subplot.map.addLayer({type:e,id:this.layerIds[e],source:this.sourceIds[e],layout:t.layout,paint:t.paint})},r.update=function(e){for(var t=this.subplot,a=o(e),r=0;r<this.order.length;r++){var n=this.order[r],l=a[n];t.setOptions(this.layerIds[n],"setLayoutProperty",l.layout),"visible"===l.layout.visibility&&(this.setSourceData(n,l),t.setOptions(this.layerIds[n],"setPaintProperty",l.paint))}e[0].trace._glTrace=this},r.dispose=function(){for(var e=this.subplot.map,t=0,a;t<this.order.length;t++)a=this.order[t],e.removeLayer(this.layerIds[a]),e.removeSource(this.sourceIds[a])},t.exports=function(e,t){for(var r=t[0].trace,n=new a(e,r.uid),l=o(t),s=0;s<n.order.length;s++){var d=n.order[s],c=l[d];n.addSource(d,c),n.addLayer(d,c)}return t[0].trace._glTrace=n,n}},{"./convert":1095}],1101:[function(e,t){"use strict";var a=e("../../lib"),o=e("../scatter/subtypes"),r=e("../../constants/numerical").BADNUM;t.exports=function(e,t){var n=e.cd,l=e.xaxis,s=e.yaxis,d=[],c=n[0].trace,p;if(!o.hasMarkers(c))return[];if(!1===t)for(p=0;p<n.length;p++)n[p].selected=0;else for(p=0;p<n.length;p++){var u=n[p],g=u.lonlat;if(g[0]!==r){var h=[a.modHalf(g[0],360),g[1]],m=[l.c2p(h),s.c2p(h)];t.contains(m,null,p,e)?(d.push({pointNumber:p,lon:g[0],lat:g[1]}),u.selected=1):u.selected=0}}return d}},{"../../constants/numerical":669,"../../lib":692,"../scatter/subtypes":1064}],1102:[function(e,t){"use strict";var a=e("../../lib/extend").extendFlat,o=e("../scatter/attributes"),r=e("../../plots/attributes"),i=o.line;t.exports={mode:o.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:o.text,hovertext:o.hovertext,line:{color:i.color,width:i.width,dash:i.dash,shape:a({},i.shape,{values:["linear","spline"]}),smoothing:i.smoothing,editType:"calc"},connectgaps:o.connectgaps,marker:o.marker,cliponaxis:a({},o.cliponaxis,{dflt:!1}),textposition:o.textposition,textfont:o.textfont,fill:a({},o.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:o.fillcolor,hoverinfo:a({},r.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:o.hoveron,selected:o.selected,unselected:o.unselected}},{"../../lib/extend":682,"../../plots/attributes":737,"../scatter/attributes":1040}],1103:[function(e,t){"use strict";var a=e("fast-isnumeric"),o=e("../../constants/numerical").BADNUM,n=e("../../plots/cartesian/axes"),l=e("../scatter/colorscale_calc"),s=e("../scatter/arrays_to_calcdata"),d=e("../scatter/calc_selection"),c=e("../scatter/calc").calcMarkerSize;t.exports=function(e,t){for(var p=e._fullLayout,u=t.subplot,g=p[u].radialaxis,h=p[u].angularaxis,m=g.makeCalcdata(t,"r"),y=h.makeCalcdata(t,"theta"),f=t._length,x=Array(f),b=0;b<f;b++){var _=m[b],r=y[b],v=x[b]={};a(_)&&a(r)?(v.r=_,v.theta=r):v.r=o}var w=c(t,f);return t._extremes.x=n.findExtremes(g,m,{ppad:w}),l(e,t),s(x,t),d(x,t),x}},{"../../constants/numerical":669,"../../plots/cartesian/axes":740,"../scatter/arrays_to_calcdata":1039,"../scatter/calc":1041,"../scatter/calc_selection":1042,"../scatter/colorscale_calc":1043,"fast-isnumeric":214}],1104:[function(e,t){"use strict";function a(e,t,a,o){var i=o("r"),r=o("theta"),n;if(i)r?n=ie(i.length,r.length):(n=i.length,o("theta0"),o("dtheta"));else{if(!r)return 0;n=t.theta.length,o("r0"),o("dr")}return t._length=n,n}var o=e("../../lib"),r=e("../scatter/subtypes"),i=e("../scatter/marker_defaults"),n=e("../scatter/line_defaults"),l=e("../scatter/line_shape_defaults"),s=e("../scatter/text_defaults"),d=e("../scatter/fillcolor_defaults"),c=e("../scatter/constants").PTS_LINESONLY,p=e("./attributes");t.exports={handleRThetaDefaults:a,supplyDefaults:function(e,t,u,g){function h(a,r){return o.coerce(e,t,p,a,r)}var m=a(e,t,g,h);if(!m)return void(t.visible=!1);h("thetaunit"),h("mode",m<c?"lines+markers":"lines"),h("text"),h("hovertext"),r.hasLines(t)&&(n(e,t,u,g,h),l(e,t,h),h("connectgaps")),r.hasMarkers(t)&&i(e,t,u,g,h,{gradient:!0}),r.hasText(t)&&s(e,t,g,h);var y=[];(r.hasMarkers(t)||r.hasText(t))&&(h("cliponaxis"),h("marker.maxdisplayed"),y.push("points")),h("fill"),"none"!==t.fill&&(d(e,t,u,h),!r.hasLines(t)&&l(e,t,h)),("tonext"===t.fill||"toself"===t.fill)&&y.push("fills"),h("hoveron",y.join("+")||"points"),o.coerceSelectionMarkerOpacity(t,h)}}},{"../../lib":692,"../scatter/constants":1044,"../scatter/fillcolor_defaults":1049,"../scatter/line_defaults":1053,"../scatter/line_shape_defaults":1055,"../scatter/marker_defaults":1059,"../scatter/subtypes":1064,"../scatter/text_defaults":1065,"./attributes":1102}],1105:[function(e,t){"use strict";function a(e,t,a,o){function n(e,t){p.push(e._hovertitle+": "+r.tickText(e,t,"hover").text)}var l=a.radialAxis,s=a.angularAxis,d=e.hi||t.hoverinfo,c=d.split("+"),p=[];if(l._hovertitle="r",s._hovertitle="\u03B8",-1!==c.indexOf("all")&&(c=["r","theta","text"]),-1!==c.indexOf("r")&&n(l,l.c2l(e.r)),-1!==c.indexOf("theta")){var u=e.theta;n(s,"degrees"===s.thetaunit?i.rad2deg(u):u)}-1!==c.indexOf("text")&&o.text&&(p.push(o.text),delete o.text),o.extraText=p.join("<br>")}var o=e("../scatter/hover"),r=e("../../plots/cartesian/axes"),i=e("../../lib");t.exports={hoverPoints:function(e,t,r,i){var n=o(e,t,r,i);if(n&&!1!==n[0].index){var l=n[0];if(void 0===l.index)return n;var s=e.subplot,d=l.cd[l.index],c=l.trace;if(s.isPtInside(d))return l.xLabelVal=void 0,l.yLabelVal=void 0,a(d,c,s,l),n}},makeHoverPointText:a}},{"../../lib":692,"../../plots/cartesian/axes":740,"../scatter/hover":1051}],1106:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:e("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults").supplyDefaults,colorbar:e("../scatter/marker_colorbar"),calc:e("./calc"),plot:e("./plot"),style:e("../scatter/style").style,hoverPoints:e("./hover").hoverPoints,selectPoints:e("../scatter/select"),meta:{}}},{"../../plots/polar":807,"../scatter/marker_colorbar":1058,"../scatter/select":1061,"../scatter/style":1063,"./attributes":1102,"./calc":1103,"./defaults":1104,"./hover":1105,"./plot":1107}],1107:[function(e,t){"use strict";var a=e("../scatter/plot"),o=e("../../constants/numerical").BADNUM;t.exports=function(e,t,n){for(var l=t.layers.frontplot.select("g.scatterlayer"),s={xaxis:t.xaxis,yaxis:t.yaxis,plot:t.framework,layerClipId:t._hasClipOnAxisFalse?t.clipIds.forTraces:null},d=t.radialAxis,c=t.angularAxis,p=0,u;p<n.length;p++){u=n[p];for(var g=0;g<u.length;g++){var h=u[g],m=h.r;if(m===o)h.x=h.y=o;else{var r=d.c2g(m),y=c.c2g(h.theta);h.x=r*te(y),h.y=r*M(y)}}}a(e,s,n,l)}},{"../../constants/numerical":669,"../scatter/plot":1060}],1108:[function(e,t){"use strict";var a=e("../scatterpolar/attributes"),o=e("../scattergl/attributes");t.exports={mode:a.mode,r:a.r,theta:a.theta,r0:a.r0,dr:a.dr,theta0:a.theta0,dtheta:a.dtheta,thetaunit:a.thetaunit,text:a.text,hovertext:a.hovertext,line:o.line,connectgaps:o.connectgaps,marker:o.marker,fill:o.fill,fillcolor:o.fillcolor,textposition:o.textposition,textfont:o.textfont,hoverinfo:a.hoverinfo,selected:a.selected,unselected:a.unselected}},{"../scattergl/attributes":1089,"../scatterpolar/attributes":1102}],1109:[function(e,t){"use strict";var a=e("../../lib"),o=e("../scatter/subtypes"),r=e("../scatterpolar/defaults").handleRThetaDefaults,i=e("../scatter/marker_defaults"),n=e("../scatter/line_defaults"),l=e("../scatter/text_defaults"),s=e("../scatter/fillcolor_defaults"),d=e("../scatter/constants").PTS_LINESONLY,c=e("./attributes");t.exports=function(e,t,p,u){function g(o,r){return a.coerce(e,t,c,o,r)}var h=r(e,t,u,g);return h?void(g("thetaunit"),g("mode",h<d?"lines+markers":"lines"),g("text"),g("hovertext"),o.hasLines(t)&&(n(e,t,p,u,g),g("connectgaps")),o.hasMarkers(t)&&i(e,t,p,u,g),o.hasText(t)&&l(e,t,u,g),g("fill"),"none"!==t.fill&&s(e,t,p,g),a.coerceSelectionMarkerOpacity(t,g)):void(t.visible=!1)}},{"../../lib":692,"../scatter/constants":1044,"../scatter/fillcolor_defaults":1049,"../scatter/line_defaults":1053,"../scatter/marker_defaults":1059,"../scatter/subtypes":1064,"../scatter/text_defaults":1065,"../scatterpolar/defaults":1104,"./attributes":1108}],1110:[function(e,t){"use strict";var a=e("point-cluster"),o=e("fast-isnumeric"),r=e("../scattergl"),i=e("../scatter/colorscale_calc"),n=e("../scatter/calc").calcMarkerSize,l=e("../scattergl/convert"),s=e("../../lib"),d=e("../../plots/cartesian/axes"),c=e("../scatterpolar/hover").makeHoverPointText,p=e("../scattergl/constants").TOO_MANY_POINTS;t.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:e("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),calc:function(e,t){var a=e._fullLayout,o=t.subplot,r=a[o].radialaxis,s=a[o].angularaxis,c=r.makeCalcdata(t,"r"),u=s.makeCalcdata(t,"theta"),g=t._length,h={};g<c.length&&(c=c.slice(0,g)),g<u.length&&(u=u.slice(0,g)),h.r=c,h.theta=u,i(e,t);var m=h.opts=l.style(e,t),y;return g<p?y=n(t,g):m.marker&&(y=2*(m.marker.sizeAvg||va(m.marker.size,3))),t._extremes.x=d.findExtremes(r,c,{ppad:y}),[{x:!1,y:!1,t:h,trace:t}]},plot:function(e,t,i){if(i.length){var n=t.radialAxis,d=t.angularAxis,c=r.sceneUpdate(e,t);return i.forEach(function(u){if(u&&u[0]&&u[0].trace){var g=u[0],h=g.trace,m=g.t,f=h._length,b=m.r,_=m.theta,v=m.opts,w=b.slice(),k=_.slice(),T;for(T=0;T<b.length;T++)t.isPtInside({r:b[T],theta:_[T]})||(w[T]=NaN,k[T]=NaN);var A=Array(2*f),S=Array(f),x=Array(f);for(T=0;T<f;T++){var y=w[T],r,C;if(o(y)){var L=n.c2g(y),E=d.c2g(k[T],h.thetaunit);r=L*te(E),C=L*M(E)}else r=C=NaN;S[T]=A[2*T]=r,x[T]=A[2*T+1]=C}m.tree=a(A),v.marker&&f>=p&&(v.marker.cluster=m.tree),v.marker&&(v.markerSel.positions=v.markerUnsel.positions=v.marker.positions=A),v.line&&1<A.length&&s.extendFlat(v.line,l.linePositions(e,h,A)),v.text&&(s.extendFlat(v.text,{positions:A},l.textPosition(e,h,v.text,v.marker)),s.extendFlat(v.textSel,{positions:A},l.textPosition(e,h,v.text,v.markerSel)),s.extendFlat(v.textUnsel,{positions:A},l.textPosition(e,h,v.text,v.markerUnsel))),v.fill&&!c.fill2d&&(c.fill2d=!0),v.marker&&!c.scatter2d&&(c.scatter2d=!0),v.line&&!c.line2d&&(c.line2d=!0),v.text&&!c.glText&&(c.glText=!0),c.lineOptions.push(v.line),c.fillOptions.push(v.fill),c.markerOptions.push(v.marker),c.markerSelectedOptions.push(v.markerSel),c.markerUnselectedOptions.push(v.markerUnsel),c.textOptions.push(v.text),c.textSelectedOptions.push(v.textSel),c.textUnselectedOptions.push(v.textUnsel),m.x=S,m.y=x,m.rawx=S,m.rawy=x,m.r=b,m.theta=_,m.positions=A,m._scene=c,m.index=c.count,c.count++}}),r.plot(e,t,i)}},hoverPoints:function(e,t,a,o){var i=e.cd,n=i[0].t,l=n.r,s=n.theta,d=r.hoverPoints(e,t,a,o);if(d&&!1!==d[0].index){var p=d[0];if(void 0===p.index)return d;var u=e.subplot,g=p.cd[p.index],h=p.trace;if(g.r=l[p.index],g.theta=s[p.index],!!u.isPtInside(g))return p.xLabelVal=void 0,p.yLabelVal=void 0,c(g,h,u,p),d}},selectPoints:r.selectPoints,meta:{}}},{"../../lib":692,"../../plots/cartesian/axes":740,"../../plots/polar":807,"../scatter/calc":1041,"../scatter/colorscale_calc":1043,"../scatter/marker_colorbar":1058,"../scattergl":1093,"../scattergl/constants":1090,"../scattergl/convert":1091,"../scatterpolar/hover":1105,"./attributes":1108,"./defaults":1109,"fast-isnumeric":214,"point-cluster":452}],1111:[function(e,t){"use strict";var a=e("../scatter/attributes"),o=e("../../plots/attributes"),r=e("../../components/colorscale/attributes"),i=e("../../components/colorbar/attributes"),n=e("../../components/drawing/attributes").dash,l=e("../../lib/extend").extendFlat,s=a.marker,d=a.line,c=s.line;t.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:l({},a.mode,{dflt:"markers"}),text:l({},a.text,{}),hovertext:l({},a.hovertext,{}),line:{color:d.color,width:d.width,dash:n,shape:l({},d.shape,{values:["linear","spline"]}),smoothing:d.smoothing,editType:"calc"},connectgaps:a.connectgaps,cliponaxis:a.cliponaxis,fill:l({},a.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:a.fillcolor,marker:l({symbol:s.symbol,opacity:s.opacity,maxdisplayed:s.maxdisplayed,size:s.size,sizeref:s.sizeref,sizemin:s.sizemin,sizemode:s.sizemode,line:l({width:c.width,editType:"calc"},r("marker.line")),gradient:s.gradient,editType:"calc"},r("marker"),{colorbar:i}),textfont:a.textfont,textposition:a.textposition,selected:a.selected,unselected:a.unselected,hoverinfo:l({},o.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:a.hoveron}},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../components/drawing/attributes":589,"../../lib/extend":682,"../../plots/attributes":737,"../scatter/attributes":1040}],1112:[function(e,t){"use strict";var o=e("fast-isnumeric"),r=e("../scatter/colorscale_calc"),n=e("../scatter/arrays_to_calcdata"),l=e("../scatter/calc_selection"),s=e("../scatter/calc").calcMarkerSize,d=["a","b","c"],c={a:["b","c"],b:["a","c"],c:["a","b"]};t.exports=function(e,t){var p=e._fullLayout[t.subplot],u=p.sum,g=t.sum||u,h={a:t.a,b:t.b,c:t.c},m,f,_,v,w,k;for(m=0;m<d.length;m++)if(_=d[m],!h[_]){for(w=h[c[_][0]],k=h[c[_][1]],v=Array(w.length),f=0;f<w.length;f++)v[f]=g-w[f]-k[f];h[_]=v}var T=t._length,A=Array(T),S,C,L,E,z,I;for(m=0;m<T;m++)S=h.a[m],C=h.b[m],L=h.c[m],o(S)&&o(C)&&o(L)?(S=+S,C=+C,L=+L,E=u/(S+C+L),1!==E&&(S*=E,C*=E,L*=E),I=S,z=L-C,A[m]={x:z,y:I,a:S,b:C,c:L}):A[m]={x:!1,y:!1};return s(t,T),r(e,t),n(A,t),l(A,t),A}},{"../scatter/arrays_to_calcdata":1039,"../scatter/calc":1041,"../scatter/calc_selection":1042,"../scatter/colorscale_calc":1043,"fast-isnumeric":214}],1113:[function(e,t){"use strict";var o=e("../../lib"),r=e("../scatter/constants"),i=e("../scatter/subtypes"),n=e("../scatter/marker_defaults"),l=e("../scatter/line_defaults"),s=e("../scatter/line_shape_defaults"),d=e("../scatter/text_defaults"),p=e("../scatter/fillcolor_defaults"),u=e("./attributes");t.exports=function(e,t,g,h){function m(a,r){return o.coerce(e,t,u,a,r)}var y=m("a"),a=m("b"),f=m("c"),c;if(y?(c=y.length,a?(c=ie(c,a.length),f&&(c=ie(c,f.length))):f?c=ie(c,f.length):c=0):a&&f&&(c=ie(a.length,f.length)),!c)return void(t.visible=!1);t._length=c,m("sum"),m("text"),m("hovertext");var x=c<r.PTS_LINESONLY?"lines+markers":"lines";m("mode",x),i.hasLines(t)&&(l(e,t,g,h,m),s(e,t,m),m("connectgaps")),i.hasMarkers(t)&&n(e,t,g,h,m,{gradient:!0}),i.hasText(t)&&d(e,t,h,m);var b=[];(i.hasMarkers(t)||i.hasText(t))&&(m("cliponaxis"),m("marker.maxdisplayed"),b.push("points")),m("fill"),"none"!==t.fill&&(p(e,t,g,m),!i.hasLines(t)&&s(e,t,m)),("tonext"===t.fill||"toself"===t.fill)&&b.push("fills"),m("hoveron",b.join("+")||"points"),o.coerceSelectionMarkerOpacity(t,m)}},{"../../lib":692,"../scatter/constants":1044,"../scatter/fillcolor_defaults":1049,"../scatter/line_defaults":1053,"../scatter/line_shape_defaults":1055,"../scatter/marker_defaults":1059,"../scatter/subtypes":1064,"../scatter/text_defaults":1065,"./attributes":1111}],1114:[function(e,t){"use strict";t.exports=function(e,t,a,o,r){if(t.xa&&(e.xaxis=t.xa),t.ya&&(e.yaxis=t.ya),o[r]){var i=o[r];e.a=i.a,e.b=i.b,e.c=i.c}else e.a=t.a,e.b=t.b,e.c=t.c;return e}},{}],1115:[function(e,t){"use strict";var a=e("../scatter/hover"),o=e("../../plots/cartesian/axes");t.exports=function(e,t,r,i){function n(e,t){x.push(e._hovertitle+": "+o.tickText(e,t,"hover").text)}var l=a(e,t,r,i);if(l&&!1!==l[0].index){var s=l[0];if(void 0===s.index){var d=1-s.y0/e.ya._length,c=e.xa._length,p=c*d/2,u=c-p;return s.x0=va(ie(s.x0,u),p),s.x1=va(ie(s.x1,u),p),l}var g=s.cd[s.index];s.a=g.a,s.b=g.b,s.c=g.c,s.xLabelVal=void 0,s.yLabelVal=void 0;var h=s.trace,m=s.subplot,y=g.hi||h.hoverinfo,f=y.split("+"),x=[];return-1!==f.indexOf("all")&&(f=["a","b","c"]),-1!==f.indexOf("a")&&n(m.aaxis,g.a),-1!==f.indexOf("b")&&n(m.baxis,g.b),-1!==f.indexOf("c")&&n(m.caxis,g.c),s.extraText=x.join("<br>"),l}}},{"../../plots/cartesian/axes":740,"../scatter/hover":1051}],1116:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.colorbar=e("../scatter/marker_colorbar"),a.calc=e("./calc"),a.plot=e("./plot"),a.style=e("../scatter/style").style,a.styleOnSelect=e("../scatter/style").styleOnSelect,a.hoverPoints=e("./hover"),a.selectPoints=e("../scatter/select"),a.eventData=e("./event_data"),a.moduleType="trace",a.name="scatterternary",a.basePlotModule=e("../../plots/ternary"),a.categories=["ternary","symbols","showLegend","scatter-like"],a.meta={},t.exports=a},{"../../plots/ternary":819,"../scatter/marker_colorbar":1058,"../scatter/select":1061,"../scatter/style":1063,"./attributes":1111,"./calc":1112,"./defaults":1113,"./event_data":1114,"./hover":1115,"./plot":1117}],1117:[function(e,t){"use strict";var a=e("../scatter/plot");t.exports=function(e,t,o){var r=t.plotContainer;r.select(".scatterlayer").selectAll("*").remove();var i={xaxis:t.xaxis,yaxis:t.yaxis,plot:r,layerClipId:t._hasClipOnAxisFalse?t.clipIdRelative:null},n=t.layers.frontplot.select("g.scatterlayer");a(e,i,o,n)}},{"../scatter/plot":1060}],1118:[function(e,t){"use strict";function a(e){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:n[e],editType:"plot"}}}var o=e("../scatter/attributes"),r=e("../../components/colorscale/attributes"),i=e("../scattergl/attributes"),n=e("../../plots/cartesian/constants").idRegex,l=e("../../plot_api/plot_template").templatedArray,s=e("../../lib/extend").extendFlat,d=o.marker,c=d.line,p=s(r("marker.line",{editTypeOverride:"calc"}),{width:s({},c.width,{editType:"calc"}),editType:"calc"}),u=s(r("marker"),{symbol:d.symbol,size:s({},d.size,{editType:"markerSize"}),sizeref:d.sizeref,sizemin:d.sizemin,sizemode:d.sizemode,opacity:d.opacity,colorbar:d.colorbar,line:p,editType:"calc"});u.color.editType=u.cmin.editType=u.cmax.editType="style",t.exports={dimensions:l("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:s({},i.text,{}),marker:u,xaxes:a("x"),yaxes:a("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:i.selected.marker,editType:"calc"},unselected:{marker:i.unselected.marker,editType:"calc"},opacity:i.opacity}},{"../../components/colorscale/attributes":576,"../../lib/extend":682,"../../plot_api/plot_template":730,"../../plots/cartesian/constants":746,"../scatter/attributes":1040,"../scattergl/attributes":1089}],1119:[function(e,t){"use strict";function a(e,t,a){for(var o=a.matrixOptions.data.length,r=t._visibleDims,n=a.viewOpts.ranges=Array(o),l=0;l<r.length;l++){var s=r[l],i=n[l]=[,,,,],d=c(e,t._diag[s][0]);d&&(i[0]=d.r2l(d.range[0]),i[2]=d.r2l(d.range[1]));var p=c(e,t._diag[s][1]);p&&(i[1]=p.r2l(p.range[0]),i[3]=p.r2l(p.range[1]))}a.selectBatch?a.matrix.update({ranges:n},{ranges:n}):a.matrix.update({ranges:n})}function o(e){var t=e._fullLayout,a=t._glcanvas.data()[0].regl,o=t._splomGrid;o||(o=t._splomGrid=i(a)),o.update(r(e))}function r(e){function t(e,t,a,o,n,l){var s=t[e+"color"],d=t[e+"width"],c=s+d+"";c in i?i[c].data.push(NaN,NaN,a,o,n,l):i[c]={data:[a,o,n,l],join:"rect",thickness:d,color:s,viewport:r,range:r,overlay:!1}}var a=e._fullLayout,o=a._size,r=[0,0,a.width,a.height],i={},n;for(n in a._splomSubplots){var l=a._plots[n],s=l.xaxis,d=l.yaxis,c=s._vals,u=d._vals,g=o.b+d.domain[0]*o.h,h=-d._m,m=-h*d.r2l(d.range[0],d.calendar),f,b;if(s.showgrid)for(n=0;n<c.length;n++)f=s._offset+s.l2p(c[n].x),t("grid",s,f,g,f,g+d._length);if(d.showgrid)for(n=0;n<u.length;n++)b=g+m+h*u[n].x,t("grid",d,s._offset,b,s._offset+s._length,b);p(e,s,d)&&(f=s._offset+s.l2p(0),t("zeroline",s,f,g,f,g+d._length)),p(e,d,s)&&(b=g+m+0,t("zeroline",d,s._offset,b,s._offset+s._length,b))}var _=[];for(n in i)_.push(i[n]);return _}var i=e("regl-line2d"),n=e("../../registry"),l=e("../../lib/prepare_regl"),s=e("../../plots/get_data").getModuleCalcData,d=e("../../plots/cartesian"),c=e("../../plots/cartesian/axis_ids").getFromId,p=e("../../plots/cartesian/axes").shouldShowZeroLine;t.exports={name:"splom",attr:d.attr,attrRegex:d.attrRegex,layoutAttributes:d.layoutAttributes,supplyLayoutDefaults:d.supplyLayoutDefaults,drawFramework:d.drawFramework,plot:function(e){var t=e._fullLayout,a=n.getModule("splom"),r=s(e.calcdata,a)[0],i=l(e,["ANGLE_instanced_arrays","OES_element_index_uint"]);i&&(t._hasOnlyLargeSploms&&o(e),a.plot(e,{},r))},drag:function(e){var t=e.calcdata,r=e._fullLayout;r._hasOnlyLargeSploms&&o(e);for(var n=0;n<t.length;n++){var l=t[n][0],s=l.trace,d=r._splomScenes[s.uid];"splom"===s.type&&d&&d.matrix&&a(e,s,d)}},updateGrid:o,clean:function(e,t,a,o){var r={},n;if(o._splomScenes){for(n=0;n<e.length;n++){var l=e[n];"splom"===l.type&&(r[l.uid]=1)}for(n=0;n<a.length;n++){var s=a[n];if(!r[s.uid]){var c=o._splomScenes[s.uid];c&&c.destroy&&c.destroy(),o._splomScenes[s.uid]=null,delete o._splomScenes[s.uid]}}}0===Object.keys(o._splomScenes||{}).length&&delete o._splomScenes,o._splomGrid&&!t._hasOnlyLargeSploms&&o._hasOnlyLargeSploms&&(o._splomGrid.destroy(),o._splomGrid=null,delete o._splomGrid),d.clean(e,t,a,o)},updateFx:function(e){d.updateFx(e);var t=e._fullLayout,a=t.dragmode;if("zoom"===a||"pan"===a)for(var o=e.calcdata,r=0;r<o.length;r++){var n=o[r][0],l=n.trace;if("splom"===l.type){var s=t._splomScenes[l.uid];null===s.selectBatch&&s.matrix.update(s.matrixOptions,null)}}},toSVG:d.toSVG}},{"../../lib/prepare_regl":705,"../../plots/cartesian":752,"../../plots/cartesian/axes":740,"../../plots/cartesian/axis_ids":743,"../../plots/get_data":777,"../../registry":823,"regl-line2d":474}],1120:[function(e,t){"use strict";function a(e,t){function a(a,o){return r.coerce(e,t,n.dimensions,a,o)}a("label");var o=a("values");o&&o.length?a("visible"):t.visible=!1,a("axis.type")}function o(e,t,a,o){function r(e,o,r){if(e){var i=e.charAt(0),n=a._splomAxes[i];if(t["_"+i+"axes"][e]=1,r.push(e),!(e in n)){var l=n[e]={};o&&(l.label=o.label||"",o.visible&&o.axis&&(l.type=o.axis.type))}}}var n=t.dimensions,l=n.length,s=t.showupperhalf,d=t.showlowerhalf,c=t.diagonal.visible,p=Array(l),u=Array(l),g,h;for(g=0;g<l;g++){var m=g?g+1:"";p[g]="x"+m,u[g]="y"+m}var y=o("xaxes",p),f=o("yaxes",u),x=t._diag=Array(l);t._xaxes={},t._yaxes={};var b=[],_=[],v=!c&&!d,w=!c&&!s;for(g=0;g<l;g++){var k=n[g],T=0===g,A=g===l-1,S=T&&v||A&&w?void 0:y[g],C=T&&w||A&&v?void 0:f[g];r(S,k,b),r(C,k,_),x[g]=[S,C]}for(g=0;g<b.length;g++)for(h=0;h<_.length;h++){var L=b[g]+_[h];g>h&&s?a._splomSubplots[L]=1:g<h&&d?a._splomSubplots[L]=1:g===h&&(c||!d||!s)&&(a._splomSubplots[L]=1)}(!d||!c&&s&&d)&&(a._splomGridDflt.xside="bottom",a._splomGridDflt.yside="left")}var r=e("../../lib"),i=e("../../plots/array_container_defaults"),n=e("./attributes"),l=e("../scatter/subtypes"),s=e("../scatter/marker_defaults"),d=e("../parcoords/merge_length"),c=/-open/;t.exports=function(e,t,p,u){function g(a,o){return r.coerce(e,t,n,a,o)}var h=i(e,t,{name:"dimensions",handleItemDefaults:a}),m=g("diagonal.visible"),y=g("showupperhalf"),f=g("showlowerhalf"),x=d(t,h,"values");if(!x||!m&&!y&&!f)return void(t.visible=!1);g("text"),s(e,t,p,u,g);var b=c.test(t.marker.symbol),_=l.isBubble(t);g("marker.line.width",b||_?1:0),o(e,t,u,g),r.coerceSelectionMarkerOpacity(t,g)}},{"../../lib":692,"../../plots/array_container_defaults":736,"../parcoords/merge_length":1012,"../scatter/marker_defaults":1059,"../scatter/subtypes":1064,"./attributes":1118}],1121:[function(e,t){"use strict";function a(e,t){var a=e._fullLayout,o=t.uid,r=a._splomScenes;r||(r=a._splomScenes={});var i={dirty:!0},n=r[t.uid];return n||(n=r[o]=c.extendFlat({},i,{selectBatch:null,unselectBatch:null,matrix:!1,select:null}),n.draw=function(){n.matrix&&n.matrix.draw&&(n.selectBatch?n.matrix.draw(n.unselectBatch,n.selectBatch):n.matrix.draw()),n.dirty=!1},n.destroy=function(){n.matrix&&n.matrix.destroy&&n.matrix.destroy(),n.matrixOptions=null,n.selectBatch=null,n.unselectBatch=null,n=null}),n.dirty||c.extendFlat(n,i),n}function o(e,t){var a=e._fullLayout,o=a._size,r=t.trace,l=t.t,s=a._splomScenes[r.uid],d=s.matrixOptions,u=d.cdata,g=a._glcanvas.data()[0].regl,h=a.dragmode,m,y,f,x,b;if(0!==u.length){d.lower=r.showupperhalf,d.upper=r.showlowerhalf,d.diagonal=r.diagonal.visible;var _=r._visibleDims,v=u.length,w=s.viewOpts={};for(w.ranges=Array(v),w.domains=Array(v),b=0;b<_.length;b++){f=_[b];var T=w.ranges[b]=[,,,,],A=w.domains[b]=[,,,,];m=p.getFromId(e,r._diag[f][0]),m&&(T[0]=m._rl[0],T[2]=m._rl[1],A[0]=m.domain[0],A[2]=m.domain[1]),y=p.getFromId(e,r._diag[f][1]),y&&(T[1]=y._rl[0],T[3]=y._rl[1],A[1]=y.domain[0],A[3]=y.domain[1])}w.viewport=[o.l,o.b,o.w+o.l,o.h+o.b],!0===s.matrix&&(s.matrix=n(g));var S=-1<a.clickmode.indexOf("select"),C="lasso"===h||"select"===h||!!r.selectedpoints||S;if(s.selectBatch=null,s.unselectBatch=null,C){var L=r._length;if(s.selectBatch||(s.selectBatch=[],s.unselectBatch=[]),r.selectedpoints){s.selectBatch=r.selectedpoints;var E=r.selectedpoints,z={};for(f=0;f<E.length;f++)z[E[f]]=!0;var I=[];for(f=0;f<L;f++)z[f]||I.push(f);s.unselectBatch=I}var D=l.xpx=Array(v),P=l.ypx=Array(v);for(b=0;b<_.length;b++){if(f=_[b],m=p.getFromId(e,r._diag[f][0]),m)for(D[b]=Array(L),x=0;x<L;x++)D[b][x]=m.c2p(u[b][x]);if(y=p.getFromId(e,r._diag[f][1]),y)for(P[b]=Array(L),x=0;x<L;x++)P[b][x]=y.c2p(u[b][x])}s.selectBatch?(s.matrix.update(d,d),s.matrix.update(s.unselectedOptions,s.selectedOptions),s.matrix.update(w,w)):s.matrix.update(w,null)}else{var O=c.extendFlat({},d,w);s.matrix.update(O,null),l.xpx=l.ypx=null}}}function r(e,t){for(var a=t._id,o=a.charAt(0),r={x:0,y:1}[o],n=e._visibleDims,l=0,s;l<n.length;l++)if(s=n[l],e._diag[s][r]===a)return l;return!1}var n=e("regl-splom"),l=e("array-range"),s=e("../../registry"),d=e("../../components/grid"),c=e("../../lib"),p=e("../../plots/cartesian/axis_ids"),u=e("../scatter/subtypes"),g=e("../scatter/calc").calcMarkerSize,h=e("../scatter/calc").calcAxisExpansion,m=e("../scatter/colorscale_calc"),y=e("../scattergl/convert").markerSelection,f=e("../scattergl/convert").markerStyle,b=e("../scattergl").calcHover,_=e("../../constants/numerical").BADNUM,v=e("../scattergl/constants").TOO_MANY_POINTS;t.exports={moduleType:"trace",name:"splom",basePlotModule:e("./base_plot"),categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:e("../scatter/marker_colorbar"),calc:function(e,t){function o(e,a){for(var o=e.makeCalcdata({v:a.values,vcalendar:t.calendar},"v"),r=0;r<o.length;r++)o[r]=o[r]===_?NaN:o[r];s.push(o),d.push("log"===e.type?c.simpleMap(o,e.c2l):o)}var r=t.dimensions,n=t._length,l={},s=l.cdata=[],d=l.data=[],u=t._visibleDims=[],x,b,w,T,A;for(x=0;x<r.length;x++)if(w=r[x],w.visible){if(T=p.getFromId(e,t._diag[x][0]),A=p.getFromId(e,t._diag[x][1]),T&&A&&T.type!==A.type){c.log("Skipping splom dimension "+x+" with conflicting axis types");continue}T?(o(T,w),A&&"category"===A.type&&(A._categories=T._categories.slice())):o(A,w),u.push(x)}m(e,t),c.extendFlat(l,f(t));var S=s.length,C;for(C=S*n>v?2*(l.sizeAvg||va(l.size,3)):g(t,n),b=0;b<u.length;b++)x=u[b],w=r[x],T=p.getFromId(e,t._diag[x][0])||{},A=p.getFromId(e,t._diag[x][1])||{},h(e,t,T,A,s[b],s[b],C);var L=a(e,t);return L.matrix||(L.matrix=!0),L.matrixOptions=l,L.selectedOptions=y(t,t.selected),L.unselectedOptions=y(t,t.unselected),[{x:!1,y:!1,t:{},trace:t}]},plot:function(e,t,a){if(a.length)for(var r=0;r<a.length;r++)o(e,a[r][0])},hoverPoints:function(e,t,a){var o=e.cd,n=o[0].trace,l=e.scene,s=l.matrixOptions.cdata,d=e.xa,c=e.ya,p=d.c2p(t),u=c.c2p(a),g=e.distance,h=r(n,d),m=r(n,c);if(!1===h||!1===m)return[e];for(var f=s[h],x=s[m],y=g,_=0,v,w;_<f.length;_++){var k=f[_],T=x[_],A=d.c2p(k)-p,S=c.c2p(T)-u,C=re(A*A+S*S);C<y&&(y=w=C,v=_)}return(e.index=v,e.distance=y,e.dxy=w,void 0===v)?[e]:(b(e,f,x,n),[e])},selectPoints:function(e,t){var a=e.cd,o=a[0].trace,n=a[0].t,s=e.scene,d=s.matrixOptions.cdata,c=e.xaxis,p=e.yaxis,g=[],h;if(!s)return g;var m=!u.hasMarkers(o)&&!u.hasText(o);if(!0!==o.visible||m)return g;var f=r(o,c),b=r(o,p);if(!1===f||!1===b)return g;var _=n.xpx[f],v=n.ypx[b],w=d[f],x=d[b],y=null,k=null;if(!1!==t&&!t.degenerate)for(y=[],k=[],h=0;h<w.length;h++)t.contains([_[h],v[h]],null,h,e)?(y.push(h),g.push({pointNumber:h,x:w[h],y:x[h]})):k.push(h);else k=l(n.count);if(s.selectBatch||(s.selectBatch=[],s.unselectBatch=[]),!s.selectBatch){for(h=0;h<s.count;h++)s.selectBatch=[],s.unselectBatch=[];s.matrix.update(s.unselectedOptions,s.selectedOptions)}return s.selectBatch=y,s.unselectBatch=k,g},editStyle:function(e,t){var a=t.trace,o=e._fullLayout._splomScenes[a.uid];if(o){m(e,a),c.extendFlat(o.matrixOptions,f(a));var r=c.extendFlat({},o.matrixOptions,o.viewOpts);o.matrix.update(r,null)}},meta:{}},s.register(d)},{"../../components/grid":612,"../../constants/numerical":669,"../../lib":692,"../../plots/cartesian/axis_ids":743,"../../registry":823,"../scatter/calc":1041,"../scatter/colorscale_calc":1043,"../scatter/marker_colorbar":1058,"../scatter/subtypes":1064,"../scattergl":1093,"../scattergl/constants":1090,"../scattergl/convert":1091,"./attributes":1118,"./base_plot":1119,"./defaults":1120,"array-range":55,"regl-splom":477}],1122:[function(e,t){"use strict";var a=e("../../components/colorscale/attributes"),o=e("../../components/colorbar/attributes"),r=e("../mesh3d/attributes"),i=e("../../plots/attributes"),n=e("../../lib/extend").extendFlat,l={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"}};n(l,a("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:o});["opacity","lightposition","lighting"].forEach(function(e){l[e]=r[e]}),l.hoverinfo=n({},i.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),l.transforms=void 0,t.exports=l},{"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../lib/extend":682,"../../plots/attributes":737,"../mesh3d/attributes":983}],1123:[function(e,t){"use strict";var a=e("../../components/colorscale/calc");t.exports=function(e,t){var o=t.u,r=t.v,n=t.w,l=t.x,s=t.y,d=t.z,c=ie(l.length,s.length,d.length,o.length,r.length,n.length),p=0,u,g,h,m;t.starts&&(g=t.starts.x||[],h=t.starts.y||[],m=t.starts.z||[],p=ie(g.length,h.length,m.length));var y=0,f=1/0;for(u=0;u<c;u++){var x=o[u],b=r[u],_=n[u],v=re(x*x+b*b+_*_);y=va(y,v),f=ie(f,v)}a(e,t,{vals:[f,y],containerStr:"",cLetter:"c"});var w=-Infinity,k=1/0,T=-Infinity,A=1/0,S=-Infinity,C=1/0;for(u=0;u<c;u++){var L=l[u];w=va(w,L),k=ie(k,L);var E=s[u];T=va(T,E),A=ie(A,E);var z=d[u];S=va(S,z),C=ie(C,z)}for(u=0;u<p;u++){var I=g[u];w=va(w,I),k=ie(k,I);var D=h[u];T=va(T,D),A=ie(A,D);var P=m[u];S=va(S,P),C=ie(C,P)}t._len=c,t._slen=p,t._normMax=y,t._xbnds=[k,w],t._ybnds=[A,T],t._zbnds=[C,S]}},{"../../components/colorscale/calc":577}],1124:[function(e,t){"use strict";function a(e,t){this.scene=e,this.uid=t,this.mesh=null,this.data=null}function o(e){return c.distinctVals(e).vals}function r(e){var t=e.length,a;return a=2<t?e.slice(1,t-1):2===t?[(e[0]+e[1])/2]:e,a}function n(e){var t=e.length;return 1===t?[.5,.5]:[e[1]-e[0],e[t-1]-e[t-2]]}function l(e,t){function a(e,t){var a=l[t],o=d[g[t]];return c.simpleMap(e,function(e){return a.d2l(e)*o})}var l=e.fullSceneLayout,d=e.dataScale,h=t._len,y={};y.vectors=u(a(t.u,"xaxis"),a(t.v,"yaxis"),a(t.w,"zaxis"),h);var f=o(t.x.slice(0,h)),x=o(t.y.slice(0,h)),b=o(t.z.slice(0,h));if(f.length*x.length*b.length>h)return{positions:[],cells:[]};var _=a(f,"xaxis"),v=a(x,"yaxis"),w=a(b,"zaxis");if(y.meshgrid=[_,v,w],t.starts){var T=t._slen;y.startingPositions=u(a(t.starts.x.slice(0,T),"xaxis"),a(t.starts.y.slice(0,T),"yaxis"),a(t.starts.z.slice(0,T),"zaxis"))}else{for(var A=v[0],S=r(_),C=r(w),L=Array(S.length*C.length),E=0,z=0;z<S.length;z++)for(var I=0;I<C.length;I++)L[E++]=[S[z],A,C[I]];y.startingPositions=L}y.colormap=p(t.colorscale),y.tubeSize=t.sizeref,y.maxLength=t.maxdisplayed;var D=a(t._xbnds,"xaxis"),P=a(t._ybnds,"yaxis"),O=a(t._zbnds,"zaxis"),R=n(_),M=n(v),j=n(w),B=[[D[0]-R[0],P[0]-M[0],O[0]-j[0]],[D[1]+R[1],P[1]+M[1],O[1]+j[1]]],F=s(y,B);F.vertexIntensityBounds=[t.cmin/t._normMax,t.cmax/t._normMax];var N=t.lightposition;return F.lightPosition=[N.x,N.y,N.z],F.ambient=t.lighting.ambient,F.diffuse=t.lighting.diffuse,F.specular=t.lighting.specular,F.roughness=t.lighting.roughness,F.fresnel=t.lighting.fresnel,F.opacity=t.opacity,t._pad=2*(F.tubeScale*t.sizeref),F}var s=e("gl-streamtube3d"),d=s.createTubeMesh,c=e("../../lib"),p=e("../../lib/gl_format_color").parseColorScale,u=e("../../plots/gl3d/zip3"),g={xaxis:0,yaxis:1,zaxis:2},h=a.prototype;h.handlePick=function(e){function t(e,t){var r=a[t],i=o[g[t]];return r.l2c(e)/i}var a=this.scene.fullSceneLayout,o=this.scene.dataScale;if(e.object===this.mesh){var r=e.data.position,i=e.data.velocity;return e.traceCoordinate=[t(r[0],"xaxis"),t(r[1],"yaxis"),t(r[2],"zaxis"),t(i[0],"xaxis"),t(i[1],"yaxis"),t(i[2],"zaxis"),e.data.intensity*this.data._normMax,e.data.divergence],e.textLabel=this.data.text,!0}},h.update=function(e){this.data=e;var t=l(this.scene,e);this.mesh.update(t)},h.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},t.exports=function(e,t){var o=e.glplot.gl,r=l(e,t),i=d(o,r),n=new a(e,t.uid);return n.mesh=i,n.data=t,i._trace=n,e.glplot.add(i),n}},{"../../lib":692,"../../lib/gl_format_color":689,"../../plots/gl3d/zip3":794,"gl-streamtube3d":301}],1125:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../components/colorscale/defaults"),r=e("./attributes");t.exports=function(e,t,i,n){function l(o,i){return a.coerce(e,t,r,o,i)}var s=l("u"),d=l("v"),c=l("w"),p=l("x"),u=l("y"),g=l("z");return s&&s.length&&d&&d.length&&c&&c.length&&p&&p.length&&u&&u.length&&g&&g.length?void(l("starts.x"),l("starts.y"),l("starts.z"),l("maxdisplayed"),l("sizeref"),l("lighting.ambient"),l("lighting.diffuse"),l("lighting.specular"),l("lighting.roughness"),l("lighting.fresnel"),l("lightposition.x"),l("lightposition.y"),l("lightposition.z"),o(e,t,n,l,{prefix:"",cLetter:"c"}),l("text"),t._length=null):void(t.visible=!1)}},{"../../components/colorscale/defaults":579,"../../lib":692,"./attributes":1122}],1126:[function(e,t){"use strict";t.exports={moduleType:"trace",name:"streamtube",basePlotModule:e("../../plots/gl3d"),categories:["gl3d"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:e("./calc"),plot:e("./convert"),eventData:function(e,t){return e.tubex=e.x,e.tubey=e.y,e.tubez=e.z,e.tubeu=t.traceCoordinate[3],e.tubev=t.traceCoordinate[4],e.tubew=t.traceCoordinate[5],e.norm=t.traceCoordinate[6],e.divergence=t.traceCoordinate[7],delete e.x,delete e.y,delete e.z,e},meta:{}}},{"../../plots/gl3d":783,"./attributes":1122,"./calc":1123,"./convert":1124,"./defaults":1125}],1127:[function(e,t){"use strict";function a(){return{valType:"boolean",dflt:!1}}function o(){return{show:{valType:"boolean",dflt:!1},project:{x:a("x"),y:a("y"),z:a("z")},color:{valType:"color",dflt:r.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:r.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var r=e("../../components/color"),i=e("../../components/colorscale/attributes"),n=e("../../components/colorbar/attributes"),l=e("../../plots/attributes"),s=e("../../lib/extend").extendFlat,d=e("../../plot_api/edit_types").overrideAll,c=t.exports=d(s({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},surfacecolor:{valType:"data_array"}},i("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{colorbar:n,contours:{x:o("x"),y:o("y"),z:o("z")},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},_deprecated:{zauto:s({},i.zauto,{}),zmin:s({},i.zmin,{}),zmax:s({},i.zmax,{})},hoverinfo:s({},l.hoverinfo)}),"calc","nested");c.x.editType=c.y.editType=c.z.editType="calc+clearAxisTypes",c.transforms=void 0},{"../../components/color":569,"../../components/colorbar/attributes":570,"../../components/colorscale/attributes":576,"../../lib/extend":682,"../../plot_api/edit_types":723,"../../plots/attributes":737}],1128:[function(e,t){"use strict";var a=e("../../components/colorscale/calc");t.exports=function(e,t){t.surfacecolor?a(e,t,{vals:t.surfacecolor,containerStr:"",cLetter:"c"}):a(e,t,{vals:t.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":577}],1129:[function(e,t){"use strict";function a(e,t,a){this.scene=e,this.uid=a,this.surface=t,this.data=null,this.showContour=[!1,!1,!1],this.minValues=[1/0,1/0,1/0],this.maxValues=[-Infinity,-Infinity,-Infinity],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0}function o(e){var t=e[0].rgb,a=e[e.length-1].rgb;return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]}function r(e,t){if(e<t)return 0;for(var o=0;0===ea(e%t);)e/=t,o++;return o}function n(e){for(var t=[],a=0,o;a<x.length;a++)o=x[a],t.push(r(e,o));return t}function l(e){for(var t=n(e),a=e,o=0;o<x.length;o++)if(0<t[o]){a=x[o];break}return a}function s(e,t){if(!(1>e||1>t)){for(var a=n(e),o=n(t),r=1,l=0;l<x.length;l++)r*=_a(x[l],va(a[l],o[l]));return r}}function d(e){if(0!==e.length){for(var t=1,a=0;a<e.length;a++)t=s(t,e[a]);return t}}var c=e("gl-surface3d"),p=e("ndarray"),u=e("ndarray-homography"),g=e("ndarray-fill"),h=e("../../lib").isArrayOrTypedArray,m=e("../../lib/gl_format_color").parseColorScale,y=e("../../lib/str2rgbarray"),f=a.prototype;f.getXat=function(e,t,a,o){var r=h(this.data.x)?h(this.data.x[0])?this.data.x[t][e]:this.data.x[e]:e;return a===void 0?r:o.d2l(r,0,a)},f.getYat=function(e,t,a,o){var r=h(this.data.y)?h(this.data.y[0])?this.data.y[t][e]:this.data.y[t]:t;return a===void 0?r:o.d2l(r,0,a)},f.getZat=function(e,t,a,o){var r=this.data.z[t][e];return a===void 0?r:o.d2l(r,0,a)},f.handlePick=function(e){if(e.object===this.surface){var t=(e.data.index[0]-1)/this.dataScaleX-1,a=(e.data.index[1]-1)/this.dataScaleY-1,o=va(ie(R(t),this.data.z[0].length-1),0),r=va(ie(R(a),this.data._ylength-1),0);e.index=[o,r],e.traceCoordinate=[this.getXat(o,r),this.getYat(o,r),this.getZat(o,r)],e.dataCoordinate=[this.getXat(o,r,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(o,r,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(o,r,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var n=0,l;3>n;n++)l=e.dataCoordinate[n],null!==l&&void 0!==l&&(e.dataCoordinate[n]*=this.scene.dataScale[n]);var s=this.data.text;return e.textLabel=Array.isArray(s)&&s[r]&&void 0!==s[r][o]?s[r][o]:s?s:"",e.data.dataCoordinate=e.dataCoordinate.slice(),this.surface.highlight(e.data),this.scene.glplot.spikes.position=e.dataCoordinate,!0}};var x=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];f.calcXnums=function(e){var t=[],o;for(o=1;o<e;o++){var r=this.getXat(o-1,0),a=this.getXat(o,0);t[o-1]=a!==r&&void 0!==r&&null!==r&&void 0!==a&&null!==a?wa(a-r):0}var n=0;for(o=1;o<e;o++)n+=t[o-1];for(o=1;o<e;o++)t[o-1]=0===t[o-1]?1:R(n/t[o-1]);return t},f.calcYnums=function(e){var t=[],o;for(o=1;o<e;o++){var r=this.getYat(0,o-1),a=this.getYat(0,o);t[o-1]=a!==r&&void 0!==r&&null!==r&&void 0!==a&&null!==a?wa(a-r):0}var n=0;for(o=1;o<e;o++)n+=t[o-1];for(o=1;o<e;o++)t[o-1]=0===t[o-1]?1:R(n/t[o-1]);return t};var b=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],_=b[9],w=b[13];f.estimateScale=function(e,t){for(var a=0===t?this.calcXnums(e):this.calcYnums(e),o=1+d(a);o<_;)o*=2;for(;o>w;)o--,o/=l(o),o++,o<_&&(o=w);var r=R(o/e);return 1<r?r:1},f.refineCoords=function(e){for(var t=this.dataScaleX,a=this.dataScaleY,o=e[0].shape[0],r=e[0].shape[1],n=0|ea(e[0].shape[0]*t+1),l=0|ea(e[0].shape[1]*a+1),s=1+o+1,d=1+r+1,c=p(new Float32Array(s*d),[s,d]),g=0;g<e.length;++g){this.surface.padField(c,e[g]);var h=p(new Float32Array(n*l),[n,l]);u(h,c,[t,0,0,0,a,0,0,0,1]),e[g]=h}},f.setContourLevels=function(){for(var e=[[],[],[]],t=!1,a=0;3>a;++a)this.showContour[a]&&(t=!0,e[a]=this.scene.contourLevels[a]);t&&this.surface.update({levels:e})},f.update=function(e){var t=this.scene,a=t.fullSceneLayout,r=this.surface,n=e.opacity,l=m(e.colorscale,n),s=t.dataScale,d=e.z[0].length,c=e._ylength,u=t.contourLevels;this.data=e;var h=[],f,x,b,_;for(f=0;3>f;f++)for(h[f]=[],x=0;x<d;x++)h[f][x]=[];for(x=0;x<d;x++)for(b=0;b<c;b++)h[0][x][b]=this.getXat(x,b,e.xcalendar,a.xaxis),h[1][x][b]=this.getYat(x,b,e.ycalendar,a.yaxis),h[2][x][b]=this.getZat(x,b,e.zcalendar,a.zaxis);for(f=0;3>f;f++)for(x=0;x<d;x++)for(b=0;b<c;b++)_=h[f][x][b],null===_||void 0===_?h[f][x][b]=NaN:_=h[f][x][b]*=s[f];for(f=0;3>f;f++)for(x=0;x<d;x++)for(b=0;b<c;b++)_=h[f][x][b],null!==_&&void 0!==_&&(this.minValues[f]>_&&(this.minValues[f]=_),this.maxValues[f]<_&&(this.maxValues[f]=_));for(f=0;3>f;f++)e._objectOffset[f]=.5*(this.minValues[f]+this.maxValues[f]);for(f=0;3>f;f++)for(x=0;x<d;x++)for(b=0;b<c;b++)_=h[f][x][b],null!==_&&void 0!==_&&(h[f][x][b]-=e._objectOffset[f]);var T=[p(new Float32Array(d*c),[d,c]),p(new Float32Array(d*c),[d,c]),p(new Float32Array(d*c),[d,c])];g(T[0],function(e,t){return h[0][e][t]}),g(T[1],function(e,t){return h[1][e][t]}),g(T[2],function(e,t){return h[2][e][t]}),h=[];var A={colormap:l,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!e.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacity:e.opacity,intensityBounds:[e.cmin,e.cmax]};if(e.surfacecolor){var S=p(new Float32Array(d*c),[d,c]);g(S,function(t,a){return e.surfacecolor[a][t]}),T.push(S)}else A.intensityBounds[0]*=s[2],A.intensityBounds[1]*=s[2];(w<T[0].shape[0]||w<T[0].shape[1])&&(this.refineData=!1),!0===this.refineData&&(this.dataScaleX=this.estimateScale(T[0].shape[0],0),this.dataScaleY=this.estimateScale(T[0].shape[1],1),(1!==this.dataScaleX||1!==this.dataScaleY)&&this.refineCoords(T)),e.surfacecolor&&(A.intensity=T.pop());var C=[!0,!0,!0],L=["x","y","z"];for(f=0;3>f;++f){var E=e.contours[L[f]];C[f]=E.highlight,A.showContour[f]=E.show||E.highlight,A.showContour[f]&&(A.contourProject[f]=[E.project.x,E.project.y,E.project.z],E.show?(this.showContour[f]=!0,A.levels[f]=u[f],r.highlightColor[f]=A.contourColor[f]=y(E.color),r.highlightTint[f]=E.usecolormap?A.contourTint[f]=0:A.contourTint[f]=1,A.contourWidth[f]=E.width):this.showContour[f]=!1,E.highlight&&(A.dynamicColor[f]=y(E.highlightcolor),A.dynamicWidth[f]=E.highlightwidth))}o(l)&&(A.vertexColor=!0),A.objectOffset=[e._objectOffset[0],e._objectOffset[1],e._objectOffset[2]],A.coords=T,r.update(A),r.visible=e.visible,r.enableDynamic=C,r.enableHighlight=C,r.snapToData=!0,"lighting"in e&&(r.ambientLight=e.lighting.ambient,r.diffuseLight=e.lighting.diffuse,r.specularLight=e.lighting.specular,r.roughness=e.lighting.roughness,r.fresnel=e.lighting.fresnel),"lightposition"in e&&(r.lightPosition=[e.lightposition.x,e.lightposition.y,e.lightposition.z]),n&&1>n&&(r.supportsTransparency=!0)},f.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},t.exports=function(e,t){var o=e.glplot.gl,r=c({gl:o}),i=new a(e,r,t.uid);return r._trace=i,i.update(t),e.glplot.add(r),i}},{"../../lib":692,"../../lib/gl_format_color":689,"../../lib/str2rgbarray":715,"gl-surface3d":303,ndarray:433,"ndarray-fill":423,"ndarray-homography":425}],1130:[function(e,t){"use strict";function a(e,t,a){t in e&&!(a in e)&&(e[a]=e[t])}var o=e("../../registry"),r=e("../../lib"),n=e("../../components/colorscale/defaults"),l=e("./attributes");t.exports=function(e,t,s,d){function c(a,o){return r.coerce(e,t,l,a,o)}var p=c("z"),u,g;if(!p)return void(t.visible=!1);var h=c("x");c("y"),t._xlength=Array.isArray(h)&&r.isArrayOrTypedArray(h[0])?p.length:p[0].length,t._ylength=p.length,t._objectOffset=[0,0,0];var m=o.getComponentMethod("calendars","handleTraceDefaults");m(e,t,["x","y","z"],d),c("text"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","opacity"].forEach(function(e){c(e)});var y=c("surfacecolor");c("colorscale");var f=["x","y","z"];for(u=0;3>u;++u){var x="contours."+f[u],b=c(x+".show"),_=c(x+".highlight");if(b||_)for(g=0;3>g;++g)c(x+".project."+f[g]);b&&(c(x+".color"),c(x+".width"),c(x+".usecolormap")),_&&(c(x+".highlightcolor"),c(x+".highlightwidth"))}y||(a(e,"zmin","cmin"),a(e,"zmax","cmax"),a(e,"zauto","cauto")),n(e,t,d,c,{prefix:"",cLetter:"c"}),t._length=null}},{"../../components/colorscale/defaults":579,"../../lib":692,"../../registry":823,"./attributes":1127}],1131:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.colorbar={min:"cmin",max:"cmax"},a.calc=e("./calc"),a.plot=e("./convert"),a.moduleType="trace",a.name="surface",a.basePlotModule=e("../../plots/gl3d"),a.categories=["gl3d","2dMap","noOpacity"],a.meta={},t.exports=a},{"../../plots/gl3d":783,"./attributes":1127,"./calc":1128,"./convert":1129,"./defaults":1130}],1132:[function(e,t){"use strict";var a=e("../../components/annotations/attributes"),o=e("../../lib/extend").extendFlat,r=e("../../plot_api/edit_types").overrideAll,i=e("../../plots/font_attributes"),n=e("../../plots/domain").attributes,l=t.exports=r({domain:n({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:o({},a.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:o({},i({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:o({},a.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:o({},i({arrayOk:!0}))}},"calc","from-root");l.transforms=void 0},{"../../components/annotations/attributes":552,"../../lib/extend":682,"../../plot_api/edit_types":723,"../../plots/domain":766,"../../plots/font_attributes":767}],1133:[function(e,t,a){"use strict";var o=e("../../plots/get_data").getModuleCalcData,r=e("./plot"),i="table";a.name=i,a.plot=function(e){var t=o(e.calcdata,i)[0];t.length&&r(e,t)},a.clean=function(e,t,a,o){var r=o._has&&o._has(i),n=t._has&&t._has(i);r&&!n&&o._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":777,"./plot":1140}],1134:[function(e,t){"use strict";var a=e("../../lib/gup").wrap;t.exports=function(){return a({})}},{"../../lib/gup":690}],1135:[function(e,t){"use strict";t.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1136:[function(e,t){"use strict";function a(e){if(Array.isArray(e)){for(var t=0,o=0;o<e.length;o++)t=va(t,a(e[o]));return t}return e}function o(e,t){return e+t}function r(e){var t=e.slice(),a=1/0,o=0,r;for(r=0;r<t.length;r++)Array.isArray(t[r])||(t[r]=[t[r]]),a=ie(a,t[r].length),o=va(o,t[r].length);if(a!==o)for(r=0;r<t.length;r++){var l=o-t[r].length;l&&(t[r]=t[r].concat(n(l)))}return t}function n(e){for(var t=Array(e),a=0;a<e;a++)t[a]="";return t}function l(e){return e.calcdata.columns.reduce(function(t,a){return a.xIndex<e.xIndex?t+a.columnWidth:t},0)}function s(e,t){var a=Object.keys(e);return a.map(function(a){return i({},e[a],{auxiliaryBlocks:t})})}function d(e,t){for(var a={},o=0,r=0,n=p(),l=0,s=0,d=0,c;d<e.length;d++)c=e[d],n.rows.push({rowIndex:d,rowHeight:c}),r+=c,(r>=t||d==e.length-1)&&(a[o]=n,n.key=s++,n.firstRowIndex=l,n.lastRowIndex=d,n=p(),o+=r,l=d+1,r=0);return a}function p(){return{firstRowIndex:null,lastRowIndex:null,rows:[]}}var u=e("./constants"),i=e("../../lib/extend").extendFlat,c=e("fast-isnumeric");t.exports=function(e,t){var p=r(t.cells.values),g=function(e){return e.slice(t.header.values.length,e.length)},h=r(t.header.values);h.length&&!h[0].length&&(h[0]=[""],h=r(h));var m=h.concat(g(p).map(function(){return n((h[0]||[""]).length)})),y=t.domain,f=ea(e._fullLayout._size.w*(y.x[1]-y.x[0])),x=ea(e._fullLayout._size.h*(y.y[1]-y.y[0])),b=t.header.values.length?m[0].map(function(){return t.header.height}):[u.emptyHeaderHeight],_=p.length?p[0].map(function(){return t.cells.height}):[],v=b.reduce(o,0),w=x-v+u.uplift,k=d(_,w),T=d(b,v),A=s(T,[]),S=s(k,A),C={},L=t._fullInput.columnorder.concat(g(p.map(function(e,t){return t}))),E=m.map(function(e,a){var o=Array.isArray(t.columnwidth)?t.columnwidth[ie(a,t.columnwidth.length-1)]:t.columnwidth;return c(o)?+o:1}),z=E.reduce(o,0);E=E.map(function(e){return e/z*f});var I=va(a(t.header.line.width),a(t.cells.line.width)),D={key:t.uid+e._context.staticPlot,translateX:y.x[0]*e._fullLayout._size.w,translateY:e._fullLayout._size.h*(1-y.y[1]),size:e._fullLayout._size,width:f,maxLineWidth:I,height:x,columnOrder:L,groupHeight:x,rowBlocks:S,headerRowBlocks:A,scrollY:0,cells:i({},t.cells,{values:p}),headerCells:i({},t.header,{values:m}),gdColumns:m.map(function(e){return e[0]}),gdColumnsOriginalOrder:m.map(function(e){return e[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:m.map(function(e,t){var a=C[e];C[e]=(a||0)+1;var o=e+"__"+C[e];return{key:o,label:e,specIndex:t,xIndex:L[t],xScale:l,x:void 0,calcdata:void 0,columnWidth:E[t]}})};return D.columns.forEach(function(e){e.calcdata=D,e.x=l(e)}),D}},{"../../lib/extend":682,"./constants":1135,"fast-isnumeric":214}],1137:[function(e,t,a){"use strict";function o(e){var t=e.rowBlocks[e.page],a=t?t.rows[0].rowIndex:0,o=t?a+t.rows.length:0;return[a,o]}var r=e("../../lib/extend").extendFlat;a.splitToPanels=function(e){var t=[0,0],a=r({},e,{key:"header",type:"header",page:0,prevPages:t,currentRepaint:[null,null],dragHandle:!0,values:e.calcdata.headerCells.values[e.specIndex],rowBlocks:e.calcdata.headerRowBlocks,calcdata:r({},e.calcdata,{cells:e.calcdata.headerCells})}),o=r({},e,{key:"cells1",type:"cells",page:0,prevPages:t,currentRepaint:[null,null],dragHandle:!1,values:e.calcdata.cells.values[e.specIndex],rowBlocks:e.calcdata.rowBlocks}),i=r({},e,{key:"cells2",type:"cells",page:1,prevPages:t,currentRepaint:[null,null],dragHandle:!1,values:e.calcdata.cells.values[e.specIndex],rowBlocks:e.calcdata.rowBlocks});return[o,i,a]},a.splitToCells=function(e){var t=o(e);return(e.values||[]).slice(t[0],t[1]).map(function(a,o){var r="string"==typeof a&&a.match(/[<$&> ]/)?"_keybuster_"+Math.random():"";return{keyWithinBlock:o+r,key:t[0]+o,column:e,calcdata:e.calcdata,page:e.page,rowBlocks:e.rowBlocks,value:a}})}},{"../../lib/extend":682}],1138:[function(e,t){"use strict";function a(e,t){for(var a=e.columnorder||[],o=e.header.values.length,r=a.slice(0,o),n=r.slice().sort(function(e,t){return e-t}),l=r.map(function(e){return n.indexOf(e)}),s=l.length;s<o;s++)l.push(s);t("columnorder",l)}var o=e("../../lib"),r=e("./attributes"),i=e("../../plots/domain").defaults;t.exports=function(e,t,n,l){function s(a,i){return o.coerce(e,t,r,a,i)}i(t,l,s),s("columnwidth"),s("header.values"),s("header.format"),s("header.align"),s("header.prefix"),s("header.suffix"),s("header.height"),s("header.line.width"),s("header.line.color"),s("header.fill.color"),o.coerceFont(s,"header.font",o.extendFlat({},l.font)),a(t,s),s("cells.values"),s("cells.format"),s("cells.align"),s("cells.prefix"),s("cells.suffix"),s("cells.height"),s("cells.line.width"),s("cells.line.color"),s("cells.fill.color"),o.coerceFont(s,"cells.font",o.extendFlat({},l.font)),t._length=null}},{"../../lib":692,"../../plots/domain":766,"./attributes":1132}],1139:[function(e,t){"use strict";var a={};a.attributes=e("./attributes"),a.supplyDefaults=e("./defaults"),a.calc=e("./calc"),a.plot=e("./plot"),a.moduleType="trace",a.name="table",a.basePlotModule=e("./base_plot"),a.categories=["noOpacity"],a.meta={},t.exports=a},{"./attributes":1132,"./base_plot":1133,"./calc":1134,"./defaults":1138,"./plot":1140}],1140:[function(e,t){"use strict";function a(e){return ae(e.calcdata.maxLineWidth/2)}function o(e,t){return"clip"+e._fullLayout._uid+"_scrollAreaBottomClip_"+t.key}function r(e,t){return"clip"+e._fullLayout._uid+"_columnBoundaryClippath_"+t.calcdata.key+"_"+t.specIndex}function i(e){return[].concat.apply([],e.map(function(e){return e})).map(function(e){return e.__data__})}function n(e,t,a){function o(e){var t=e.rowBlocks;return O(t,t.length-1)+(t.length?R(t[t.length-1],1/0):1)}var r=e.selectAll("."+F.cn.scrollbarKit).data(N.repeat,N.keyFun);r.enter().append("g").classed(F.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),r.each(function(e){var t=e.scrollbarState;t.totalHeight=o(e),t.scrollableAreaHeight=e.groupHeight-A(e),t.currentlyVisibleHeight=ie(t.totalHeight,t.scrollableAreaHeight),t.ratio=t.currentlyVisibleHeight/t.totalHeight,t.barLength=va(t.ratio*t.currentlyVisibleHeight,F.goldenRatio*F.scrollbarWidth),t.barWiggleRoom=t.currentlyVisibleHeight-t.barLength,t.wiggleRoom=va(0,t.totalHeight-t.scrollableAreaHeight),t.topY=0===t.barWiggleRoom?0:e.scrollY/t.wiggleRoom*t.barWiggleRoom,t.bottomY=t.topY+t.barLength,t.dragMultiplier=t.wiggleRoom/t.barWiggleRoom}).attr("transform",function(e){var t=e.width+F.scrollbarWidth/2+F.scrollbarOffset;return"translate("+t+" "+A(e)+")"});var i=r.selectAll("."+F.cn.scrollbar).data(N.repeat,N.keyFun);i.enter().append("g").classed(F.cn.scrollbar,!0);var n=i.selectAll("."+F.cn.scrollbarSlider).data(N.repeat,N.keyFun);n.enter().append("g").classed(F.cn.scrollbarSlider,!0),n.attr("transform",function(e){return"translate(0 "+(e.scrollbarState.topY||0)+")"});var l=n.selectAll("."+F.cn.scrollbarGlyph).data(N.repeat,N.keyFun);l.enter().append("line").classed(F.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",F.scrollbarWidth).attr("stroke-linecap","round").attr("y1",F.scrollbarWidth/2),l.attr("y2",function(e){return e.scrollbarState.barLength-F.scrollbarWidth/2}).attr("stroke-opacity",function(e){return e.columnDragInProgress||!e.scrollbarState.barWiggleRoom||a?0:.4}),l.transition().delay(0).duration(0),l.transition().delay(F.scrollbarHideDelay).duration(F.scrollbarHideDuration).attr("stroke-opacity",0);var s=i.selectAll("."+F.cn.scrollbarCaptureZone).data(N.repeat,N.keyFun);s.enter().append("line").classed(F.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",F.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(a){var o=c.event.y,r=this.getBoundingClientRect(),i=a.scrollbarState,n=o-r.top,l=c.scale.linear().domain([0,i.scrollableAreaHeight]).range([0,i.totalHeight]).clamp(!0);i.topY<=n&&n<=i.bottomY||L(t,e,null,l(n-i.barLength/2))(a)}).call(c.behavior.drag().origin(function(e){return c.event.stopPropagation(),e.scrollbarState.scrollbarScrollInProgress=!0,e}).on("drag",L(t,e)).on("dragend",function(){})),s.attr("y2",function(e){return e.scrollbarState.scrollableAreaHeight}),t._context.staticPlot&&(l.remove(),s.remove())}function l(e,t,a,o){var r=s(a),i=d(r);h(i);var n=p(i);y(n);var l=g(i),c=u(l);m(c),f(c,t,o,e),P(i)}function s(e){var t=e.selectAll("."+F.cn.columnCells).data(N.repeat,N.keyFun);return t.enter().append("g").classed(F.cn.columnCells,!0),t.exit().remove(),t}function d(e){var t=e.selectAll("."+F.cn.columnCell).data(q.splitToCells,function(e){return e.keyWithinBlock});return t.enter().append("g").classed(F.cn.columnCell,!0),t.exit().remove(),t}function p(e){var t=e.selectAll("."+F.cn.cellRect).data(N.repeat,function(e){return e.keyWithinBlock});return t.enter().append("rect").classed(F.cn.cellRect,!0),t}function u(e){var t=e.selectAll("."+F.cn.cellText).data(N.repeat,function(e){return e.keyWithinBlock});return t.enter().append("text").classed(F.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){c.event.stopPropagation()}),t}function g(e){var t=e.selectAll("."+F.cn.cellTextHolder).data(N.repeat,function(e){return e.keyWithinBlock});return t.enter().append("g").classed(F.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),t}function h(e){e.each(function(e,t){var a=e.calcdata.cells.font,o=e.column.specIndex,r={size:v(a.size,o,t),color:v(a.color,o,t),family:v(a.family,o,t)};e.rowNumber=e.key,e.align=v(e.calcdata.cells.align,o,t),e.cellBorderWidth=v(e.calcdata.cells.line.width,o,t),e.font=r})}function m(e){e.each(function(e){V.font(c.select(this),e.font)})}function y(e){e.attr("width",function(e){return e.column.columnWidth}).attr("stroke-width",function(e){return e.cellBorderWidth}).each(function(e){var t=c.select(this);W.stroke(t,v(e.calcdata.cells.line.color,e.column.specIndex,e.rowNumber)),W.fill(t,v(e.calcdata.cells.fill.color,e.column.specIndex,e.rowNumber))})}function f(e,t,a,o){e.text(function(e){var t=e.column.specIndex,a=e.rowNumber,o=e.value,r="string"==typeof o,i=r&&o.match(/<br>/i);e.mayHaveMarkup=r&&o.match(/[<&>]/);var n=x(o);e.latex=n;var l=n?"":v(e.calcdata.cells.prefix,t,a)||"",s=n?"":v(e.calcdata.cells.suffix,t,a)||"",d=n?null:v(e.calcdata.cells.format,t,a)||null,p=l+(d?c.format(d)(e.value):e.value)+s,u;e.wrappingNeeded=!e.wrapped&&!(!r||i)&&!n&&(u=b(p)),e.cellHeightMayIncrease=i||n||e.mayHaveMarkup||(void 0===u?b(p):u),e.needsConvertToTspans=e.mayHaveMarkup||e.wrappingNeeded||e.latex;var g;if(e.wrappingNeeded){var h=" "===F.wrapSplitCharacter?p.replace(/<a href=/ig,"<a_href="):p,m=h.split(F.wrapSplitCharacter),y=" "===F.wrapSplitCharacter?m.map(function(e){return e.replace(/<a_href=/ig,"<a href=")}):m;e.fragments=y.map(function(e){return{text:e,width:null}}),e.fragments.push({fragment:F.wrapSpacer,width:null}),g=y.join(F.lineBreaker)+F.lineBreaker+F.wrapSpacer}else delete e.fragments,g=p;return g}).attr("dy",function(e){return e.needsConvertToTspans?0:"0.75em"}).each(function(e){var r=this,i=c.select(r),n=e.wrappingNeeded?z:I;e.needsConvertToTspans?U.convertToTspans(i,o,n(a,r,t,o,e)):c.select(r.parentNode).attr("transform",function(e){return"translate("+D(e)+" "+F.cellPad+")"}).attr("text-anchor",function(e){return{left:"start",center:"middle",right:"end"}[e.align]})})}function x(e){return"string"==typeof e&&e.match(F.latexCheck)}function b(e){return-1!==e.indexOf(F.wrapSplitCharacter)}function _(e,t,r){var i=t.gdColumnsOriginalOrder;t.gdColumns.sort(function(e,t){return r[i.indexOf(e)]-r[i.indexOf(t)]}),t.columnorder=r,e.emit("plotly_restyle")}function v(e,t,a){if(Array.isArray(e)){var o=e[ie(t,e.length-1)];return Array.isArray(o)?o[ie(a,o.length-1)]:o}return e}function w(e,t,a){e.transition().ease(F.releaseTransitionEase).duration(F.releaseTransitionDuration).attr("transform","translate("+t.x+" "+a+")")}function k(e){return"cells"===e.type}function T(e){return"header"===e.type}function A(e){var t=e.rowBlocks.length?e.rowBlocks[0].auxiliaryBlocks:[];return t.reduce(function(e,t){return e+R(t,1/0)},0)}function S(e,t,a){for(var o=[],r=0,n=0;n<e.length;n++){for(var l=e[n],s=l.rows,d=0,c=0;c<s.length;c++)d+=s[c].rowHeight;l.allRowsHeight=d;var p=r+d,u=t;u<p&&u+a>r&&o.push(n),r+=d}return o}function C(e,t,a){var o=i(t)[0];if(void 0!==o){var r=o.rowBlocks,l=o.calcdata,s=O(r,r.length),d=o.calcdata.groupHeight-A(o),c=l.scrollY=va(0,ie(s-d,l.scrollY)),p=S(r,c,d);1===p.length&&(p[0]===r.length-1?p.unshift(p[0]-1):p.push(p[0]+1)),p[0]%2&&p.reverse(),t.each(function(e,t){e.page=p[t],e.scrollY=c}),t.attr("transform",function(e){var t=O(e.rowBlocks,e.page)-e.scrollY;return"translate(0 "+t+")"}),e&&(E(e,a,t,p,o.prevPages,o,0),E(e,a,t,p,o.prevPages,o,1),n(a,e))}}function L(e,t,a,o){return function(r){var i=r.calcdata?r.calcdata:r,n=t.filter(function(e){return i.key===e.key}),l=a||i.scrollbarState.dragMultiplier,s=i.scrollY;i.scrollY=void 0===o?i.scrollY+l*c.event.dy:o;var d=n.selectAll("."+F.cn.yColumn).selectAll("."+F.cn.columnBlock).filter(k);return C(e,d,n),i.scrollY===s}}function E(e,t,a,o,r,i,n){var s=o[n]!==r[n];s&&(clearTimeout(i.currentRepaint[n]),i.currentRepaint[n]=setTimeout(function(){var i=a.filter(function(e,t){return t===n&&o[t]!==r[t]});l(e,t,i,a),r[n]=o[n]}))}function z(e,t,a,o){return function(){var r=c.select(t.parentNode);r.each(function(e){var t=e.fragments;r.selectAll("tspan.line").each(function(e,a){t[a].width=this.getComputedTextLength()});var a=t[t.length-1].width,o=t.slice(0,-1),i=[],n=0,l=e.column.columnWidth-2*F.cellPad,s,d;for(e.value="";o.length;)s=o.shift(),d=s.width+a,n+d>l&&(e.value+=i.join(F.wrapSpacer)+F.lineBreaker,i=[],n=0),i.push(s.text),n+=d;n&&(e.value+=i.join(F.wrapSpacer)),e.wrapped=!0}),r.selectAll("tspan.line").remove(),f(r.select("."+F.cn.cellText),a,e,o),c.select(t.parentNode.parentNode).call(P)}}function I(e,t,a,o,r){return function(){if(!r.settledY){var i=c.select(t.parentNode),s=j(r),l=r.key-s.firstRowIndex,d=s.rows[l].rowHeight,p=r.cellHeightMayIncrease?t.parentNode.getBoundingClientRect().height+2*F.cellPad:d,u=va(p,d),g=u-s.rows[l].rowHeight;g&&(s.rows[l].rowHeight=u,e.selectAll("."+F.cn.columnCell).call(P),C(null,e.filter(k),0),n(a,o,!0)),i.attr("transform",function(){var e=this,t=e.parentNode,a=t.getBoundingClientRect(),o=c.select(e.parentNode).select("."+F.cn.cellRect).node().getBoundingClientRect(),i=e.transform.baseVal.consolidate(),n=o.top-a.top+(i?i.matrix.f:F.cellPad);return"translate("+D(r,c.select(e.parentNode).select("."+F.cn.cellTextHolder).node().getBoundingClientRect().width)+" "+n+")"}),r.settledY=!0}}}function D(e,t){switch(e.align){case"left":return F.cellPad;case"right":return e.column.columnWidth-(t||0)-F.cellPad;case"center":return(e.column.columnWidth-(t||0))/2;default:return F.cellPad;}}function P(e){e.attr("transform",function(e){var t=e.rowBlocks[0].auxiliaryBlocks.reduce(function(e,t){return e+R(t,1/0)},0),a=j(e),o=R(a,e.key);return"translate(0 "+(o+t)+")"}).selectAll("."+F.cn.cellRect).attr("height",function(e){return B(j(e),e.key).rowHeight})}function O(e,t){for(var a=0,o=t-1;0<=o;o--)a+=M(e[o]);return a}function R(e,t){for(var a=0,o=0;o<e.rows.length&&e.rows[o].rowIndex<t;o++)a+=e.rows[o].rowHeight;return a}function M(e){var t=e.allRowsHeight;if(void 0!==t)return t;for(var a=0,o=0;o<e.rows.length;o++)a+=e.rows[o].rowHeight;return e.allRowsHeight=a,a}function j(e){return e.rowBlocks[e.page]}function B(e,t){return e.rows[t-e.firstRowIndex]}var F=e("./constants"),c=e("d3"),N=e("../../lib/gup"),V=e("../../components/drawing"),U=e("../../lib/svg_text_utils"),H=e("../../lib").raiseToTop,G=e("../../lib").cancelTransition,Y=e("./data_preparation_helper"),q=e("./data_split_helpers"),W=e("../../components/color");t.exports=function(e,t){var s=!e._context.staticPlot,d=e._fullLayout._paper.selectAll("."+F.cn.table).data(t.map(function(t){var a=N.unwrap(t),o=a.trace;return Y(e,o)}),N.keyFun);d.exit().remove(),d.enter().append("g").classed(F.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),d.attr("width",function(e){return e.width+e.size.l+e.size.r}).attr("height",function(e){return e.height+e.size.t+e.size.b}).attr("transform",function(e){return"translate("+e.translateX+","+e.translateY+")"});var p=d.selectAll("."+F.cn.tableControlView).data(N.repeat,N.keyFun),u=p.enter().append("g").classed(F.cn.tableControlView,!0).style("box-sizing","content-box");s&&u.on("mousemove",function(t){p.filter(function(e){return t===e}).call(n,e)}).on("mousewheel",function(t){if(!t.scrollbarState.wheeling){t.scrollbarState.wheeling=!0;var a=t.scrollY+c.event.deltaY,o=L(e,p,null,a)(t);o||(c.event.stopPropagation(),c.event.preventDefault()),t.scrollbarState.wheeling=!1}}).call(n,e,!0),p.attr("transform",function(e){return"translate("+e.size.l+" "+e.size.t+")"});var g=p.selectAll("."+F.cn.scrollBackground).data(N.repeat,N.keyFun);g.enter().append("rect").classed(F.cn.scrollBackground,!0).attr("fill","none"),g.attr("width",function(e){return e.width}).attr("height",function(e){return e.height}),p.each(function(t){V.setClipUrl(c.select(this),o(e,t),e)});var h=p.selectAll("."+F.cn.yColumn).data(function(e){return e.columns},N.keyFun);h.enter().append("g").classed(F.cn.yColumn,!0),h.exit().remove(),h.attr("transform",function(e){return"translate("+e.x+" 0)"}),s&&h.call(c.behavior.drag().origin(function(t){var a=c.select(this);return w(a,t,-F.uplift),H(this),t.calcdata.columnDragInProgress=!0,n(p.filter(function(e){return t.calcdata.key===e.key}),e),t}).on("drag",function(e){var t=c.select(this),o=function(t){return(e===t?c.event.x:t.x)+t.columnWidth/2};e.x=va(-F.overdrag,ie(e.calcdata.width+F.overdrag-e.columnWidth,c.event.x));var r=i(h).filter(function(t){return t.calcdata.key===e.calcdata.key}),n=r.sort(function(e,t){return o(e)-o(t)});n.forEach(function(t,a){t.xIndex=a,t.x=e===t?t.x:t.xScale(t)}),h.filter(function(t){return e!==t}).transition().ease(F.transitionEase).duration(F.transitionDuration).attr("transform",function(e){return"translate("+e.x+" 0)"}),t.call(G).attr("transform","translate("+e.x+" -"+F.uplift+" )")}).on("dragend",function(t){var a=c.select(this),o=t.calcdata;t.x=t.xScale(t),t.calcdata.columnDragInProgress=!1,w(a,t,0),_(e,o,o.columns.map(function(e){return e.xIndex}))})),h.each(function(t){V.setClipUrl(c.select(this),r(e,t),e)});var m=h.selectAll("."+F.cn.columnBlock).data(q.splitToPanels,N.keyFun);m.enter().append("g").classed(F.cn.columnBlock,!0).attr("id",function(e){return e.key}),m.style("cursor",function(e){return e.dragHandle?"ew-resize":e.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var y=m.filter(T),f=m.filter(k);s&&f.call(c.behavior.drag().origin(function(e){return c.event.stopPropagation(),e}).on("drag",L(e,p,-1)).on("dragend",function(){})),l(e,p,y,m),l(e,p,f,m);var x=p.selectAll("."+F.cn.scrollAreaClip).data(N.repeat,N.keyFun);x.enter().append("clipPath").classed(F.cn.scrollAreaClip,!0).attr("id",function(t){return o(e,t)});var b=x.selectAll("."+F.cn.scrollAreaClipRect).data(N.repeat,N.keyFun);b.enter().append("rect").classed(F.cn.scrollAreaClipRect,!0).attr("x",-F.overdrag).attr("y",-F.uplift).attr("fill","none"),b.attr("width",function(e){return e.width+2*F.overdrag}).attr("height",function(e){return e.height+F.uplift});var v=h.selectAll("."+F.cn.columnBoundary).data(N.repeat,N.keyFun);v.enter().append("g").classed(F.cn.columnBoundary,!0);var A=h.selectAll("."+F.cn.columnBoundaryClippath).data(N.repeat,N.keyFun);A.enter().append("clipPath").classed(F.cn.columnBoundaryClippath,!0),A.attr("id",function(t){return r(e,t)});var S=A.selectAll("."+F.cn.columnBoundaryRect).data(N.repeat,N.keyFun);S.enter().append("rect").classed(F.cn.columnBoundaryRect,!0).attr("fill","none"),S.attr("width",function(e){return e.columnWidth+2*a(e)}).attr("height",function(e){return e.calcdata.height+2*a(e)+F.uplift}).attr("x",function(e){return-a(e)}).attr("y",function(e){return-a(e)}),C(null,f,p)}},{"../../components/color":569,"../../components/drawing":590,"../../lib":692,"../../lib/gup":690,"../../lib/svg_text_utils":716,"./constants":1135,"./data_preparation_helper":1136,"./data_split_helpers":1137,d3:148}],1141:[function(e,t){"use strict";var a=e("../box/attributes"),o=e("../../lib/extend").extendFlat;t.exports={y:a.y,x:a.x,x0:a.x0,y0:a.y0,name:a.name,orientation:o({},a.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:a.fillcolor,points:o({},a.boxpoints,{}),jitter:o({},a.jitter,{}),pointpos:o({},a.pointpos,{}),marker:a.marker,text:a.text,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"plot"},selected:a.selected,unselected:a.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":682,"../box/attributes":856}],1142:[function(e,t){"use strict";function a(e,t,o){var r=ie(t,o/1.349);return 1.059*r*_a(e,-.2)}function o(e,t,o){var r=t.max-t.min;if(!r)return 1;if(e.bandwidth)return va(e.bandwidth,r/1e4);var i=o.length,n=l.stdev(o,i-1,t.mean);return va(a(i,n,t.q3-t.q1),r/100)}function r(e,t,a,o){function r(o){var r=n[o],i="multicategory"===a.type?a.r2c(r):a.d2c(r,0,e[t.valLetter+"calendar"]);return i===p?d[o]:i}var i=e.spanmode,n=e.span||[],l=[t.min,t.max],d=[t.min-2*o,t.max+2*o],c;c="soft"===i?d:"hard"===i?l:[r(0),r(1)];var u={type:"linear",range:c};return s.setConvert(u),u.cleanRange(),c}var l=e("../../lib"),s=e("../../plots/cartesian/axes"),d=e("../box/calc"),c=e("./helpers"),p=e("../../constants/numerical").BADNUM;t.exports=function(e,a){var p=d(e,a);if(p[0].t.empty)return p;var u=e._fullLayout,g=s.getFromId(e,a["h"===a.orientation?"xaxis":"yaxis"]),h=u._violinScaleGroupStats,m=a.scalegroup,y=h[m];y||(y=h[m]={maxWidth:0,maxCount:0});for(var f=1/0,x=-Infinity,b=0;b<p.length;b++){var _=p[b],w=_.pts.map(c.extractVal),T=_.bandwidth=o(a,_,w),A=_.span=r(a,_,g,T),S=A[1]-A[0],C=ae(S/(T/3)),n=S/C;if(!isFinite(n)||!isFinite(C))return l.error("Something went wrong with computing the violin span"),p[0].t.empty=!0,p;var L=c.makeKDE(_,a,w);_.density=Array(C);for(var E=0,z=A[0],I;z<A[1]+n/2;E++,z+=n)I=L(z),y.maxWidth=va(y.maxWidth,I),_.density[E]={v:I,t:z};y.maxCount=va(y.maxCount,w.length),f=ie(f,A[0]),x=va(x,A[1])}var D=s.findExtremes(g,[f,x],{padded:!0});return a._extremes[g._id]=D,p[0].t.labels.kde=l._(e,"kde:"),p}},{"../../constants/numerical":669,"../../lib":692,"../../plots/cartesian/axes":740,"../box/calc":857,"./helpers":1145}],1143:[function(e,t){"use strict";var a=e("../box/cross_trace_calc").setPositionOffset,o=["v","h"];t.exports=function(e,r){for(var n=e.calcdata,l=r.xaxis,s=r.yaxis,d=0;d<o.length;d++){for(var c=o[d],p="h"===c?s:l,u=[],g=0,h=0,m=0;m<n.length;m++){var y=n[m],f=y[0].t,t=y[0].trace;!0!==t.visible||"violin"!==t.type||f.empty||t.orientation!==c||t.xaxis!==l._id||t.yaxis!==s._id||(u.push(m),!1!==t.points&&(g=va(g,t.jitter-t.pointpos-1),h=va(h,t.jitter+t.pointpos-1)))}a("violin",e,u,p,[g,h])}}},{"../box/cross_trace_calc":858}],1144:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../components/color"),r=e("../box/defaults"),i=e("./attributes");t.exports=function(e,t,n,l){function s(o,r){return a.coerce(e,t,i,o,r)}function d(o,r){return a.coerce2(e,t,i,o,r)}if(r.handleSampleDefaults(e,t,s,l),!1!==t.visible){s("bandwidth"),s("scalegroup",t.name),s("scalemode"),s("side");var c=s("span"),p;Array.isArray(c)&&(p="manual"),s("spanmode",p);var u=s("line.color",(e.marker||{}).color||n),g=s("line.width"),h=s("fillcolor",o.addOpacity(t.line.color,.5));r.handlePointsDefaults(e,t,s,{prefix:""});var m=d("box.width"),y=d("box.fillcolor",h),f=d("box.line.color",u),x=d("box.line.width",g),b=s("box.visible",!!(m||y||f||x));b||(t.box={visible:!1});var _=d("meanline.color",u),v=d("meanline.width",g),w=s("meanline.visible",!!(_||v));w||(t.meanline={visible:!1})}}},{"../../components/color":569,"../../lib":692,"../box/defaults":859,"./attributes":1141}],1145:[function(e,t,a){"use strict";var o=e("../../lib"),r={gaussian:function(e){return 1/re(2*Sa)*ka(-.5*e*e)}};a.makeKDE=function(e,t,a){var o=a.length,n=r.gaussian,l=e.bandwidth;return function(e){for(var t=0,r=0;r<o;r++)t+=n((e-a[r])/l);return 1/(o*l)*t}},a.getPositionOnKdePath=function(e,t,a){var r,i;"h"===t.orientation?(r="y",i="x"):(r="x",i="y");var n=o.findPointOnPath(e.path,a,i,{pathLength:e.pathLength}),l=e.posCenterPx,s=n[r],d="both"===t.side?2*l-s:l;return[s,d]},a.getKdeValue=function(e,t,o){var r=e.pts.map(a.extractVal),i=a.makeKDE(e,t,r);return i(o)/e.posDensityScale},a.extractVal=function(e){return e.v}},{"../../lib":692}],1146:[function(e,t){"use strict";var a=e("../../lib"),o=e("../../plots/cartesian/axes"),r=e("../box/hover"),i=e("./helpers");t.exports=function(e,t,n,l,s){var d=e.cd,c=d[0].trace,p=c.hoveron,u=-1!==p.indexOf("violins"),g=-1!==p.indexOf("kde"),h=[],m,y;if(u||g){var f=r.hoverOnBoxes(e,t,n,l);if(u&&(h=h.concat(f)),g&&0<f.length){var x=e.xa,b=e.ya,_,v,w,k,T;"h"===c.orientation?(T=t,_="y",w=b,v="x",k=x):(T=n,_="x",w=x,v="y",k=b);var A=d[e.index];if(T>=A.span[0]&&T<=A.span[1]){var S=a.extendFlat({},e),C=k.c2p(T,!0),L=i.getKdeValue(A,c,T),E=i.getPositionOnKdePath(A,c,C),z=w._offset,I=w._length;S[_+"0"]=E[0],S[_+"1"]=E[1],S[v+"0"]=S[v+"1"]=C,S[v+"Label"]=v+": "+o.hoverLabelText(k,T)+", "+d[0].t.labels.kde+" "+L.toFixed(3),S.spikeDistance=f[0].spikeDistance;var D=_+"Spike";S[D]=f[0][D],f[0].spikeDistance=void 0,f[0][D]=void 0,h.push(S),y={stroke:e.color},y[_+"1"]=a.constrain(z+E[0],z,z+I),y[_+"2"]=a.constrain(z+E[1],z,z+I),y[v+"1"]=y[v+"2"]=k._offset+C}}}-1!==p.indexOf("points")&&(m=r.hoverOnPoints(e,t,n));var P=s.selectAll(".violinline-"+c.uid).data(y?[0]:[]);return P.enter().append("line").classed("violinline-"+c.uid,!0).attr("stroke-width",1.5),P.exit().remove(),P.attr(y),"closest"===l?m?[m]:h:m?(h.push(m),h):h}},{"../../lib":692,"../../plots/cartesian/axes":740,"../box/hover":861,"./helpers":1145}],1147:[function(e,t){"use strict";t.exports={attributes:e("./attributes"),layoutAttributes:e("./layout_attributes"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),crossTraceCalc:e("./cross_trace_calc"),plot:e("./plot"),style:e("./style"),styleOnSelect:e("../scatter/style").styleOnSelect,hoverPoints:e("./hover"),selectPoints:e("../box/select"),moduleType:"trace",name:"violin",basePlotModule:e("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":752,"../box/select":866,"../scatter/style":1063,"./attributes":1141,"./calc":1142,"./cross_trace_calc":1143,"./defaults":1144,"./hover":1146,"./layout_attributes":1148,"./layout_defaults":1149,"./plot":1150,"./style":1151}],1148:[function(e,t){"use strict";var a=e("../box/layout_attributes"),o=e("../../lib").extendFlat;t.exports={violinmode:o({},a.boxmode,{}),violingap:o({},a.boxgap,{}),violingroupgap:o({},a.boxgroupgap,{})}},{"../../lib":692,"../box/layout_attributes":863}],1149:[function(e,t){"use strict";var a=e("../../lib"),o=e("./layout_attributes"),r=e("../box/layout_defaults");t.exports=function(e,t,i){r._supply(e,t,i,function(r,i){return a.coerce(e,t,o,r,i)},"violin")}},{"../../lib":692,"../box/layout_defaults":864,"./layout_attributes":1148}],1150:[function(e,t){"use strict";var a=e("d3"),o=e("../../lib"),r=e("../../components/drawing"),i=e("../box/plot"),n=e("../scatter/line_points"),l=e("./helpers");t.exports=function(e,s,d,c){function p(e){var t=n(e,{xaxis:g,yaxis:h,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0});return r.smoothopen(t[0],1)}var u=e._fullLayout,g=s.xaxis,h=s.yaxis;o.makeTraceGroups(c,d,"trace violins").each(function(e){var r=a.select(this),n=e[0],d=n.t,t=n.trace;s.isRangePlot||(n.node3=r);var c=u._numViolins,m="group"===u.violinmode&&1<c,y=1-u.violingap,f=d.bdPos=d.dPos*y*(1-u.violingroupgap)/(m?c:1),x=d.bPos=m?2*d.dPos*(-.5+(d.num+.5)/c)*y:0;if(d.wHover=d.dPos*(m?y/c:1),!0!==t.visible||d.empty)return void r.remove();var b=s[d.valLetter+"axis"],_=s[d.posLetter+"axis"],v="both"===t.side,w=v||"positive"===t.side,T=v||"negative"===t.side,A=u._violinScaleGroupStats[t.scalegroup],S=r.selectAll("path.violin").data(o.identity);S.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),S.exit().remove(),S.each(function(e){var o=a.select(this),r=e.density,n=r.length,l=e.pos+x,s=_.c2p(l),c;switch(t.scalemode){case"width":c=A.maxWidth/f;break;case"count":c=A.maxWidth/f*(A.maxCount/e.pts.length);}var u,g,h,m,y,S,C;if(w){for(S=Array(n),m=0;m<n;m++)C=S[m]={},C[d.posLetter]=l+r[m].v/c,C[d.valLetter]=r[m].t;u=p(S)}if(T){for(S=Array(n),y=0,m=n-1;y<n;y++,m--)C=S[y]={},C[d.posLetter]=l-r[m].v/c,C[d.valLetter]=r[m].t;g=p(S)}if(v)h=u+"L"+g.substr(1)+"Z";else{var L=[s,b.c2p(r[0].t)],E=[s,b.c2p(r[n-1].t)];"h"===t.orientation&&(L.reverse(),E.reverse()),h=w?"M"+L+"L"+u.substr(1)+"L"+E:"M"+E+"L"+g.substr(1)+"L"+L}o.attr("d",h),e.posCenterPx=s,e.posDensityScale=c*f,e.path=o.node(),e.pathLength=e.path.getTotalLength()/(v?2:1)});var C=t.box,L=C.width,E=(C.line||{}).width,z,I;v?(z=f*L,I=0):w?(z=[0,f*L/2],I=-E):(z=[f*L/2,0],I=E),i.plotBoxAndWhiskers(r,{pos:_,val:b},t,{bPos:x,bdPos:z,bPosPxOffset:I}),i.plotBoxMean(r,{pos:_,val:b},t,{bPos:x,bdPos:z,bPosPxOffset:I});var D;!t.box.visible&&t.meanline.visible&&(D=o.identity);var k=r.selectAll("path.meanline").data(D||[]);k.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),k.exit().remove(),k.each(function(e){var o=b.c2p(e.mean,!0),r=l.getPositionOnKdePath(e,t,o);a.select(this).attr("d","h"===t.orientation?"M"+o+","+r[0]+"V"+r[1]:"M"+r[0]+","+o+"H"+r[1])}),i.plotPoints(r,{x:g,y:h},t,d)})}},{"../../components/drawing":590,"../../lib":692,"../box/plot":865,"../scatter/line_points":1054,"./helpers":1145,d3:148}],1151:[function(e,t){"use strict";var a=e("d3"),o=e("../../components/color"),r=e("../scatter/style").stylePoints;t.exports=function(e,t){var i=t?t[0].node3:a.select(e).selectAll("g.trace.violins");i.style("opacity",function(e){return e[0].trace.opacity}),i.each(function(t){var i=t[0].trace,n=a.select(this),l=i.box||{},s=l.line||{},d=i.meanline||{},c=d.width;n.selectAll("path.violin").style("stroke-width",i.line.width+"px").call(o.stroke,i.line.color).call(o.fill,i.fillcolor),n.selectAll("path.box").style("stroke-width",s.width+"px").call(o.stroke,s.color).call(o.fill,l.fillcolor);var p={"stroke-width":c+"px","stroke-dasharray":2*c+"px,"+c+"px"};n.selectAll("path.mean").style(p).call(o.stroke,d.color),n.selectAll("path.meanline").style(p).call(o.stroke,d.color),r(n,i,e)})}},{"../../components/color":569,"../scatter/style":1063,d3:148}],1152:[function(e,t,a){"use strict";function o(e,t,a,o){if(o.enabled){for(var n=o.target,l=d.nestedProperty(t,n),c=l.get(),p=s.getDataConversions(e,t,n,c),u=r(o,p),g=Array(a.length),h=0;h<a.length;h++)g[h]=u(c,a[h]);l.set(g),"count"===o.func&&d.pushUnique(t._arrayAttrs,n)}}function r(e,t){var a=e.func,o=t.d2c,r=t.c2d;return"count"===a?i:"first"===a?n:"last"===a?l:"sum"===a?function(e,t){for(var a=0,n=0,l;n<t.length;n++)l=o(e[t[n]]),l!==u&&(a+=l);return r(a)}:"avg"===a?function(e,t){for(var a=0,n=0,l=0,s;l<t.length;l++)s=o(e[t[l]]),s!==u&&(a+=s,n++);return n?r(a/n):u}:"min"===a?function(e,t){for(var a=1/0,n=0,l;n<t.length;n++)l=o(e[t[n]]),l!==u&&(a=ie(a,l));return a===1/0?u:r(a)}:"max"===a?function(e,t){for(var a=-Infinity,n=0,l;n<t.length;n++)l=o(e[t[n]]),l!==u&&(a=va(a,l));return a===-Infinity?u:r(a)}:"range"===a?function(e,t){for(var a=1/0,n=-Infinity,l=0,s;l<t.length;l++)s=o(e[t[l]]),s!==u&&(a=ie(a,s),n=va(n,s));return n===-Infinity||a===1/0?u:r(n-a)}:"change"===a?function(e,t){var a=o(e[t[0]]),i=o(e[t[t.length-1]]);return a===u||i===u?u:r(i-a)}:"median"===a?function(e,t){for(var a=[],n=0,l;n<t.length;n++)l=o(e[t[n]]),l!==u&&a.push(l);if(!a.length)return u;a.sort();var s=(a.length-1)/2;return r((a[ea(s)]+a[ae(s)])/2)}:"mode"===a?function(e,t){for(var a={},n=0,l=u,s=0,d;s<t.length;s++)if(d=o(e[t[s]]),d!==u){var c=a[d]=(a[d]||0)+1;c>n&&(n=c,l=d)}return n?r(l):u}:"rms"===a?function(e,t){for(var a=0,n=0,l=0,s;l<t.length;l++)s=o(e[t[l]]),s!==u&&(a+=s*s,n++);return n?r(re(a/n)):u}:"stddev"===a?function(t,a){var r=0,n=0,l=1,s=u,d;for(d=0;d<a.length&&s===u;d++)s=o(t[a[d]]);if(s===u)return u;for(;d<a.length;d++){var c=o(t[a[d]]);if(c!==u){var p=c-s;r+=p,n+=p*p,l++}}var g="sample"===e.funcmode?l-1:l;return g?re((n-r*r/l)/g):0}:void 0}function i(e,t){return t.length}function n(e,t){return e[t[0]]}function l(e,t){return e[t[t.length-1]]}var s=e("../plots/cartesian/axes"),d=e("../lib"),c=e("../plot_api/plot_schema"),p=e("./helpers").pointsAccessorFunction,u=e("../constants/numerical").BADNUM;a.moduleType="transform",a.name="aggregate";var g=a.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},h=g.aggregations;a.supplyDefaults=function(e,t){function a(t,a){return d.coerce(e,r,g,t,a)}function o(e,t){return d.coerce(m[l],f,h,e,t)}var r={},n=a("enabled"),l;if(!n)return r;var s=c.findArrayAttributes(t),p={};for(l=0;l<s.length;l++)p[s[l]]=1;var u=a("groups");if(!Array.isArray(u)){if(!p[u])return r.enabled=!1,r;p[u]=0}var m=e.aggregations||[],y=r.aggregations=Array(m.length),f;for(l=0;l<m.length;l++){f={_index:l};var x=o("target"),b=o("func"),_=o("enabled");_&&x&&(p[x]||"count"===b&&p[x]===void 0)?("stddev"===b&&o("funcmode"),p[x]=0,y[l]=f):y[l]={enabled:!1,_index:l}}for(l=0;l<s.length;l++)p[s[l]]&&y.push({target:s[l],func:h.func.dflt,enabled:!0,_index:-1});return r},a.calcTransform=function(e,t,a){if(a.enabled){var r=a.groups,n=d.getTargetArray(t,{target:r});if(n){var l={},s={},c=[],u=p(t.transforms,a),g=n.length,h,m,y,f;for(t._length&&(g=ie(g,t._length)),h=0;h<g;h++)m=n[h],y=l[m],void 0===y?(l[m]=c.length,f=[h],c.push(f),s[l[m]]=u(h)):(c[y].push(h),s[l[m]]=(s[l[m]]||[]).concat(u(h)));a._indexToPoints=s;var x=a.aggregations;for(h=0;h<x.length;h++)o(e,t,c,x[h]);"string"==typeof r&&o(e,t,c,{target:r,func:"first",enabled:!0}),t._length=c.length}}}},{"../constants/numerical":669,"../lib":692,"../plot_api/plot_schema":729,"../plots/cartesian/axes":740,"./helpers":1155}],1153:[function(e,t,a){"use strict";function o(e,t,a){function o(e){return-1!==e.indexOf(r)}var r=e.operation,i=e.value,n=Array.isArray(i),l=function(a){return t(a,0,e.valuecalendar)},s=function(e){return t(e,0,a)},u;return o(d)?u=n?l(i[0]):l(i):o(c)?u=n?[l(i[0]),l(i[1])]:[l(i),l(i)]:o(p)&&(u=n?i.map(l):[l(i)]),"="===r?function(e){return s(e)===u}:"!="===r?function(e){return s(e)!==u}:"<"===r?function(e){return s(e)<u}:"<="===r?function(e){return s(e)<=u}:">"===r?function(e){return s(e)>u}:">="===r?function(e){return s(e)>=u}:"[]"===r?function(e){var t=s(e);return t>=u[0]&&t<=u[1]}:"()"===r?function(e){var t=s(e);return t>u[0]&&t<u[1]}:"[)"===r?function(e){var t=s(e);return t>=u[0]&&t<u[1]}:"(]"===r?function(e){var t=s(e);return t>u[0]&&t<=u[1]}:"]["===r?function(e){var t=s(e);return t<=u[0]||t>=u[1]}:")("===r?function(e){var t=s(e);return t<u[0]||t>u[1]}:"]("===r?function(e){var t=s(e);return t<=u[0]||t>u[1]}:")["===r?function(e){var t=s(e);return t<u[0]||t>=u[1]}:"{}"===r?function(e){return-1!==u.indexOf(s(e))}:"}{"===r?function(e){return-1===u.indexOf(s(e))}:void 0}var r=e("../lib"),i=e("../registry"),n=e("../plots/cartesian/axes"),l=e("./helpers").pointsAccessorFunction,s=e("../constants/filter_ops"),d=s.COMPARISON_OPS,c=s.INTERVAL_OPS,p=s.SET_OPS;a.moduleType="transform",a.name="filter",a.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(d).concat(c).concat(p),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},a.supplyDefaults=function(e){function t(t,i){return r.coerce(e,o,a.attributes,t,i)}var o={},n=t("enabled");if(n){t("preservegaps"),t("operation"),t("value"),t("target");var l=i.getComponentMethod("calendars","handleDefaults");l(e,o,"valuecalendar",null),l(e,o,"targetcalendar",null)}return o},a.calcTransform=function(e,t,a){function s(e,a){for(var o=0,i;o<g.length;o++)i=r.nestedProperty(t,g[o]),e(i,a)}if(a.enabled){var d=r.getTargetArray(t,a);if(d){var c=a.target,p=d.length;t._length&&(p=ie(p,t._length));var u=a.targetcalendar,g=t._arrayAttrs,h=a.preservegaps;if("string"==typeof c){var m=r.nestedProperty(t,c+"calendar").get();m&&(u=m)}var y=n.getDataToCoordFunc(e,t,c,d),f=o(a,y,u),x={},b={},_=0,v,w;h?(v=function(e){x[e.astr]=r.extendDeep([],e.get()),e.set(Array(p))},w=function(e,t){var a=x[e.astr][t];e.get()[t]=a}):(v=function(e){x[e.astr]=r.extendDeep([],e.get()),e.set([])},w=function(e,t){var a=x[e.astr][t];e.get().push(a)}),s(v);for(var k=l(t.transforms,a),T=0,A;T<p;T++)A=f(d[T]),A?(s(w,T),b[_++]=k(T)):h&&_++;a._indexToPoints=b,t._length=_}}}},{"../constants/filter_ops":665,"../lib":692,"../plots/cartesian/axes":740,"../registry":823,"./helpers":1155}],1154:[function(e,t,a){"use strict";function o(e,t){var a=t.transform,o=t.transformIndex,d=e.transforms[o].groups,c=s(e.transforms,a),p,u,g,h,m,y,f,x,b,_;if(!Array.isArray(d)||0===d.length)return[e];var v=r.filterUnique(d),w=Array(v.length),T=d.length,A=n.findArrayAttributes(e),S=a.styles||[],C={};for(p=0;p<S.length;p++)C[S[p].target]=S[p].value;a.styles&&(_=r.keyedContainer(a,"styles","target","value.name"));var L={},E={};for(p=0;p<v.length;p++){y=v[p],L[y]=p,E[y]=0,f=w[p]=r.extendDeepNoArrays({},e),f._group=y,f.transforms[o]._indexToPoints={};var z=null;for(_&&(z=_.get(y)),f.name=z||""===z?z:r.templateString(a.nameformat,{trace:e.name,group:y}),x=f.transforms,f.transforms=[],u=0;u<x.length;u++)f.transforms[u]=r.extendDeepNoArrays({},x[u]);for(u=0;u<A.length;u++)r.nestedProperty(f,A[u]).set([])}for(g=0;g<A.length;g++){for(h=A[g],u=0,b=[];u<v.length;u++)b[u]=r.nestedProperty(w[u],h).get();for(m=r.nestedProperty(e,h).get(),u=0;u<T;u++)b[L[d[u]]].push(m[u])}for(u=0;u<T;u++){f=w[L[d[u]]];var I=f.transforms[o]._indexToPoints;I[E[d[u]]]=c(u),E[d[u]]++}for(p=0;p<v.length;p++)y=v[p],f=w[p],l.clearExpandedTraceDefaultColors(f),f=r.extendDeepNoArrays(f,C[y]||{});return w}var r=e("../lib"),n=e("../plot_api/plot_schema"),l=e("../plots/plots"),s=e("./helpers").pointsAccessorFunction;a.moduleType="transform",a.name="groupby",a.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},a.supplyDefaults=function(e,t,o){function n(t,o){return r.coerce(e,l,a.attributes,t,o)}var l={},s=n("enabled"),d;if(!s)return l;n("groups"),n("nameformat",1<o._dataLength?"%{group} (%{trace})":"%{group}");var c=e.styles,p=l.styles=[];if(c)for(d=0;d<c.length;d++){var u=p[d]={};r.coerce(c[d],p[d],a.attributes.styles,"target");var g=r.coerce(c[d],p[d],a.attributes.styles,"value");r.isPlainObject(g)?u.value=r.extendDeep({},g):g&&delete u.value}return l},a.transform=function(e,t){var a=[],r,n,l;for(n=0;n<e.length;n++)for(r=o(e[n],t),l=0;l<r.length;l++)a.push(r[l]);return a}},{"../lib":692,"../plot_api/plot_schema":729,"../plots/plots":804,"./helpers":1155}],1155:[function(e,t,a){"use strict";a.pointsAccessorFunction=function(e,t){for(var a=0,o,r;a<e.length&&(o=e[a],o!==t);a++)!o._indexToPoints||!1===o.enabled||(r=o._indexToPoints);var n=r?function(e){return r[e]}:function(e){return[e]};return n}},{}],1156:[function(e,t,a){"use strict";function o(e,t,a,o){var n=Array(o),l=Array(o),s;for(s=0;s<o;s++)n[s]={v:t[s],i:s};for(n.sort(r(e,a)),s=0;s<o;s++)l[s]=n[s].i;return l}function r(e,t){switch(e.order){case"ascending":return function(e,a){return t(e.v)-t(a.v)};case"descending":return function(e,a){return t(a.v)-t(e.v)};}}var n=e("../lib"),l=e("../plots/cartesian/axes"),s=e("./helpers").pointsAccessorFunction;a.moduleType="transform",a.name="sort",a.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},a.supplyDefaults=function(e){function t(t,r){return n.coerce(e,o,a.attributes,t,r)}var o={},r=t("enabled");return r&&(t("target"),t("order")),o},a.calcTransform=function(e,t,a){if(a.enabled){var r=n.getTargetArray(t,a);if(r){var d=a.target,c=r.length;t._length&&(c=ie(c,t._length));var p=t._arrayAttrs,u=l.getDataToCoordFunc(e,t,d,r),g=o(a,r,u,c),h=s(t.transforms,a),m={},y,f;for(y=0;y<p.length;y++){var x=n.nestedProperty(t,p[y]),b=x.get(),_=Array(c);for(f=0;f<c;f++)_[f]=b[g[f]];x.set(_)}for(f=0;f<c;f++)m[f]=h(g[f]);a._indexToPoints=m,t._length=c}}}},{"../lib":692,"../plots/cartesian/axes":740,"./helpers":1155}]},{},[22])(22)});